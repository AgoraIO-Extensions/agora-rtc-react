---
title: Hooks
---

## useConnectionState

用于获取客户端连接状态。

#### 参数

| 参数名   | 类型                                    | 是否必选 | 描述                                                                                                                                          |
| -------- | --------------------------------------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| `client` | `IAgoraRTCClient` &VerticalLine; `null` | 可选     | [IAgoraRTCClient](https://docportal.shengwang.cn/cn/live-streaming-premium-4.x/API%20Reference/web_ng/interfaces/iagorartcclient.html) 对象。 |

#### 返回值

| 类型              | 描述                                                                                                                                                                 |
| ----------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `ConnectionState` | 客户端与服务器的连接状态。详见 [ConnectionState](https://docportal.shengwang.cn/cn/live-streaming-premium-4.x/API%20Reference/web_ng/globals.html#connectionstate)。 |

#### 使用示例

```jsx
import { useConnectionState } from "agora-rtc-react";

function App() {
  const connectionState = useConnectionState();

  return <div>{connectionState}</div>;
}
```

## useIsConnected

用于获取客户端是否连接到服务器。

#### 参数

| 参数名   | 类型                                    | 是否必选 | 描述                     |
| -------- | --------------------------------------- | -------- | ------------------------ |
| `client` | `IAgoraRTCClient` &VerticalLine; `null` | 可选     | `IAgoraRTCClient` 对象。 |

#### 返回值

| 类型      | 描述                                                                              |
| --------- | --------------------------------------------------------------------------------- |
| `boolean` | <li>`true`：客户端已连接到服务器。</li><li>`false`：客户端没有连接到服务器。</li> |

#### 使用示例

```jsx
import { useIsConnected } from "agora-rtc-react";

function App() {
  const isConnected = useIsConnected();

  return <div>{isConnected}</div>;
}
```

## useCurrentUID

用于获取当前用户 UID 。

#### 参数

| 参数名   | 类型                                    | 是否必选 | 描述                                                                                                                                          |
| -------- | --------------------------------------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| `client` | `IAgoraRTCClient` &VerticalLine; `null` | 可选     | [IAgoraRTCClient](https://docportal.shengwang.cn/cn/live-streaming-premium-4.x/API%20Reference/web_ng/interfaces/iagorartcclient.html) 对象。 |

#### 返回值

| 类型                             | 描述                                                               |
| -------------------------------- | ------------------------------------------------------------------ |
| `UID` &VerticalLine; `undefined` | 当前用户的 UID。如果当前用户没有加入任何频道，则返回 `undefined`。 |

#### 使用示例

```jsx
import { useCurrentUID } from "agora-rtc-react";

function App() {
  const uid = useCurrentUID();

  return <div>{uid}</div>;
}
```

## useNetworkQuality

用于获取本地用户网络质量。

#### 参数

| 参数名   | 类型                                    | 是否必选 | 描述                                                                                                                                          |
| -------- | --------------------------------------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| `client` | `IAgoraRTCClient` &VerticalLine; `null` | 可选     | [IAgoraRTCClient](https://docportal.shengwang.cn/cn/live-streaming-premium-4.x/API%20Reference/web_ng/interfaces/iagorartcclient.html) 对象。 |

#### 返回值

| 类型             | 描述                                                                         |
| ---------------- | ---------------------------------------------------------------------------- |
| `NetworkQuality` | 本地用户的网络质量信息。详见 [NetworkQuality](./interfaces#networkquality)。 |

#### 使用示例

```jsx
import { useNetworkQuality } from "agora-rtc-react";

function App() {
  const networkQuality = useNetworkQuality();

  return <div>{networkQuality}</div>;
}
```

## useVolumeLevel

用于自动获取音频轨道音量级别，自动获取的频率为每秒一次。

#### 参数

| 参数名       | 类型                                                                             | 是否必选 | 描述                                             |
| ------------ | -------------------------------------------------------------------------------- | -------- | ------------------------------------------------ |
| `audioTrack` | `IRemoteAudioTrack` &VerticalLine; `ILocalAudioTrack` &VerticalLine; `undefined` | 可选     | 本地或远端音频轨道。如果未定义，则音量级别为 0。 |

#### 返回值

| 类型     | 描述                                                                                           |
| -------- | ---------------------------------------------------------------------------------------------- |
| `number` | 音频轨道的音量级别。取值范围 [0, 1]，1 代表理论最大音量。通常该值大于 0.6 代表用户在持续说话。 |

#### 使用示例

```jsx
import { useVolumeLevel, useLocalMicrophoneTrack } from "agora-rtc-react";

function App() {
  const audioTrack = useLocalMicrophoneTrack();
  const volumeLevel = useVolumeLevel(audioTrack);

  return <div>{volumeLevel}</div>;
}
```

## useRTCClient

用于获取 `IAgoraRTCClient` 对象。

#### 参数

| 参数名   | 类型                                    | 是否必选 | 描述                                                                                                                                                              |
| -------- | --------------------------------------- | -------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `client` | `IAgoraRTCClient` &VerticalLine; `null` | 可选     | 如果传入该参数，则使用传入的 `IAgoraRTCClient` 对象；如果不传入该参数，则使用从[父组件的 Context](./components#agorartcprovider)中获取的 `IAgoraRTCClient` 对象。 |

#### 返回值

| 类型              | 描述                     |
| ----------------- | ------------------------ |
| `IAgoraRTCClient` | `IAgoraRTCClient` 对象。 |

#### 使用示例

```jsx
import { useRTCClient } from "agora-rtc-react";

function App() {
  const client = useRTCClient();

  return <></>;
}
```

## useJoin

用于加入频道。当组件准备好时加入频道，当组件卸载时自动离开频道。

你可以通过 `fetchArgs` 自定义加入频道所需的条件，例如在加入频道前执行获取 Token 等异步操作。

#### 参数

| 参数名      | 类型                                                        | 是否必选 | 描述                                                                                                                                          |
| ----------- | ----------------------------------------------------------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| `fetchArgs` | `joinOptions` &VerticalLine; `(() => Promise<joinOptions>)` | 必选     | 加入频道所需参数或异步函数。详见 [joinOptions](./interfaces#joinoptions)。                                                                    |
| `ready`     | `boolean`                                                   | 可选     | 是否准备好加入频道。默认为 `true`。                                                                                                           |
| `client`    | `IAgoraRTCClient`                                           | 可选     | [IAgoraRTCClient](https://docportal.shengwang.cn/cn/live-streaming-premium-4.x/API%20Reference/web_ng/interfaces/iagorartcclient.html) 对象。 |

#### 返回值

返回一个包含以下属性的对象：
| 属性 | 类型 | 描述 |
| ----------------------| ---------------------- | ------------------------ |
| `data` | `UID` | 成功加入频道的用户 ID。如果你在传入 `  fetchArgs` 时没有指定 `uid`，则返回默认值 `0`。|
| `isLoading` | `boolean` |<li>`true`：正在执行加入频道相关操作。</li><li>`false`：已经执行加入频道相关操作，但不代表成功加入频道。</li> |
| `isConnected` | `boolean` | <li>`true`：客户端已连接到服务器。即加入频道成功。</li><li>`false`：客户端没有连接到服务器。</li> |
| `error` | `AgoraRtcReactError` &VerticalLine; `null` | 加入频道成功则返回 `null`，加入频道失败则抛出错误。错误详见 [AgoraRtcReactError](./interfaces#agorartcreacterror)。 |

#### 使用示例

```jsx
import { useJoin } from "agora-rtc-react";

function App() {
  // you can use useJoin like this by passing a function as first argument.
  // useJoin(async () => {
  //   you can do some actions like fetching token before calling join.
  //   const getData = await getToken();
  //   return getData;  The data type of getData must be fetchArgs
  // }, calling);

  useJoin(
    {
      appid: YOUR_APPID,
      channel: YOUR_CHANNEL,
      token: YOUR_TOKEN,
    },
    ready,
  );

  return <></>;
}
```

## usePublish

用于发布本地轨道。当组件准备好时发布，当组件卸载时取消发布。

#### 参数

| 参数名           | 类型                                    | 是否必选 | 描述                                                                                                                                          |
| ---------------- | --------------------------------------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| `tracks`         | `(ILocalTrack` &VerticalLine; `null)[]` | 必选     | 本地轨道列表。                                                                                                                                |
| `readyToPublish` | `boolean`                               | 可选     | 是否准备好进行发布。默认为 `true`。                                                                                                           |
| `client`         | `IAgoraRTCClient`                       | 可选     | [IAgoraRTCClient](https://docportal.shengwang.cn/cn/live-streaming-premium-4.x/API%20Reference/web_ng/interfaces/iagorartcclient.html) 对象。 |

#### 返回值

返回一个包含以下属性的对象：
| 属性 | 类型 | 描述 |
| ----------------------| ---------------------- | ------------------------ |
| `isLoading` | `boolean` |<li>`true`：正在执行发布相关操作。</li><li>`false`：已经执行发布相关操作，但不代表成功发布。</li> |
| `error` | `AgoraRtcReactError` &VerticalLine; `null` | 发布成功则返回 `null`，发布失败则抛出错误。错误详见 [AgoraRtcReactError](./interfaces#agorartcreacterror)。 |

#### 使用示例

```jsx
import { useLocalMicrophoneTrack, useLocalCameraTrack, usePublish } from "agora-rtc-react";

function App() {
  //get audioTrack and videoTrack before publish
  const audioTrack = useLocalMicrophoneTrack();
  const videoTrack = useLocalCameraTrack();
  usePublish([audioTrack, videoTrack]);

  return <></>;
}
```

## useLocalMicrophoneTrack

用于创建本地麦克风音频轨道。

- 在组件被销毁之前，该 Hook 只会创建一次音频轨道。
- 组件卸载后，该 Hook 创建的音频轨道会停止发布。

#### 参数

| 参数名             | 类型                             | 是否必选 | 描述                                                                                                                                                                                                                                       |
| ------------------ | -------------------------------- | -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `ready`            | `boolean`                        | 可选     | 是否准备好创建轨道，默认为 `true`。                                                                                                                                                                                                        |
| `audioTrackConfig` | `MicrophoneAudioTrackInitConfig` | 可选     | 麦克风音频轨道的初始化配置，默认为 `{ ANS: true, AEC: true }`。详见 [MicrophoneAudioTrackInitConfig](https://docportal.shengwang.cn/cn/live-streaming-premium-4.x/API%20Reference/web_ng/interfaces/microphoneaudiotrackinitconfig.html)。 |
| `client`           | `IAgoraRTCClient`                | 可选     | [IAgoraRTCClient](https://docportal.shengwang.cn/cn/live-streaming-premium-4.x/API%20Reference/web_ng/interfaces/iagorartcclient.html) 对象。                                                                                              |

#### 返回值

返回一个包含以下属性的对象：
| 属性 | 类型 | 描述 |
| ----------------------| ---------------------- | ------------------------ |
| `localMicrophoneTrack` | `IMicrophoneAudioTrack` &VerticalLine; `null` | 创建的本地麦克风音频轨道对象。 |
| `isLoading` | `boolean` |<li>`true`：正在执行创建轨道相关操作。</li><li>`false`：已经执行创建轨道相关操作，但不代表成功创建轨道。</li> |
| `error` | `AgoraRtcReactError` &VerticalLine; `null` | 创建轨道成功则返回 `null`，创建轨道失败则抛出错误。错误详见 [AgoraRtcReactError](./interfaces#agorartcreacterror)。 |

#### 使用示例

```jsx
import { useLocalMicrophoneTrack } from "agora-rtc-react";

function App() {
  const audioTrack = useLocalMicrophoneTrack(true, { ANS: true, AEC: true });

  return <></>;
}
```

## useLocalCameraTrack

用于创建本地摄像头视频轨道。

- 在组件被销毁之前，该 Hook 只会创建一次视频轨道。
- 组件卸载后，该 Hook 创建的视频轨道会停止发布。

#### 参数

| 参数名   | 类型              | 是否必选 | 描述                                                                                                                                          |
| -------- | ----------------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| `ready`  | `boolean`         | 可选     | 是否准备好创建轨道，默认为 `true`。                                                                                                           |
| `client` | `IAgoraRTCClient` | 可选     | [IAgoraRTCClient](https://docportal.shengwang.cn/cn/live-streaming-premium-4.x/API%20Reference/web_ng/interfaces/iagorartcclient.html) 对象。 |

#### 返回值

返回一个包含以下属性的对象：
| 属性 | 类型 | 描述 |
| ----------------------| ---------------------- | ------------------------ |
| `localCameraTrack` | `ICameraVideoTrack` &VerticalLine; `null` | 创建的摄像头视频轨道对象。 |
| `isLoading` | `boolean` |<li>`true`：正在执行创建轨道相关操作。</li><li>`false`：已经执行创建轨道相关操作，但不代表成功创建轨道。</li> |
| `error` | `AgoraRtcReactError` &VerticalLine; `null` | 创建轨道成功则返回 `null`，创建轨道失败则抛出错误。错误详见 [AgoraRtcReactError](./interfaces#agorartcreacterror)。 |

#### 使用示例

```jsx
import { useLocalCameraTrack } from "agora-rtc-react";

function App() {
  const audioTrack = useLocalCameraTrack();

  return <></>;
}
```

## useRemoteVideoTracks

用于自动订阅和获取远端用户视频轨道。

- 当组件卸载时，该 Hook 会停止订阅 `users` 参数对应的远端用户视频轨道。
- 当传入的 `users` 发生改变时，该 Hook 会更新订阅的视频轨道。

#### 参数

| 参数名   | 类型                                               | 是否必选 | 描述                                                                                                                                          |
| -------- | -------------------------------------------------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| `users`  | `IAgoraRTCRemoteUser[]` &VerticalLine; `undefined` | 必选     | 远端用户列表。                                                                                                                                |
| `client` | `IAgoraRTCClient` &VerticalLine; `null`            | 可选     | [IAgoraRTCClient](https://docportal.shengwang.cn/cn/live-streaming-premium-4.x/API%20Reference/web_ng/interfaces/iagorartcclient.html) 对象。 |

#### 返回值

返回一个包含以下属性的对象：
| 属性 | 类型 | 描述 |
| ----------------------| ---------------------- | ------------------------ |
| `videoTracks` | `IRemoteVideoTrack[]` | 已订阅的远端用户视频轨道列表。 |
| `isLoading` | `boolean` |<li>`true`：正在执行订阅相关操作。</li><li>`false`：已经执行订阅相关操作，但不代表成功订阅。</li> |
| `error` | `AgoraRtcReactError` &VerticalLine; `null` | 订阅成功则返回 `null`，订阅失败则抛出错误。错误详见 [AgoraRtcReactError](./interfaces#agorartcreacterror)。 |

#### 使用示例

```jsx
import { useRemoteUsers, useRemoteVideoTracks } from "agora-rtc-react";

function App() {
  const remoteUsers = useRemoteUsers();
  const videoTracks = useRemoteVideoTracks(remoteUsers);

  return <></>;
}
```

## useRemoteAudioTracks

用于自动订阅和获取远端用户音频轨道。

- 当组件卸载时，该 Hook 会停止订阅 `users` 参数对应的远端用户音频轨道。
- 当传入的 `users` 发生改变时，该 Hook 会更新订阅的音频轨道。

#### 参数

| 参数名   | 类型                                               | 是否必选 | 描述                                                                                                                                          |
| -------- | -------------------------------------------------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| `users`  | `IAgoraRTCRemoteUser[]` &VerticalLine; `undefined` | 必选     | 远端用户列表。                                                                                                                                |
| `client` | `IAgoraRTCClient` &VerticalLine; `null`            | 可选     | [IAgoraRTCClient](https://docportal.shengwang.cn/cn/live-streaming-premium-4.x/API%20Reference/web_ng/interfaces/iagorartcclient.html) 对象。 |

#### 返回值

返回一个包含以下属性的对象：
| 属性 | 类型 | 描述 |
| ----------------------| ---------------------- | ------------------------ |
| `audioTracks` | `IRemoteAudioTrack[]` | 已订阅的远端用户音频轨道列表。 |
| `isLoading` | `boolean` |<li>`true`：正在执行订阅相关操作。</li><li>`false`：已经执行订阅相关操作，但不代表成功订阅。</li> |
| `error` | `AgoraRtcReactError` &VerticalLine; `null` | 订阅成功则返回 `null`，订阅失败则抛出错误。错误详见 [AgoraRtcReactError](./interfaces#agorartcreacterror)。 |

#### 使用示例

```jsx
import { useRemoteUsers, useRemoteVideoTracks } from "agora-rtc-react";

function App() {
  //get remote user list
  const remoteUsers = useRemoteUsers();
  const videoTracks = useRemoteVideoTracks(remoteUsers);

  return <></>;
}
```

## useRemoteUserTrack

用于获取远端用户音视频轨道。

#### 参数

| 参数名      | 类型                                             | 是否必选 | 描述                                                                                                                                          |
| ----------- | ------------------------------------------------ | -------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| `user`      | `IAgoraRTCRemoteUser` &VerticalLine; `undefined` | 必选     | 远端用户对象。                                                                                                                                |
| `mediaType` | `"video"` &VerticalLine; `"audio"`               | 必选     | 媒体类型，支持 `"video"` 和 `"audio"`。                                                                                                       |
| `client`    | `IAgoraRTCClient` &VerticalLine; `null`          | 可选     | [IAgoraRTCClient](https://docportal.shengwang.cn/cn/live-streaming-premium-4.x/API%20Reference/web_ng/interfaces/iagorartcclient.html) 对象。 |

#### 返回值

返回一个包含以下属性的对象：
| 属性 | 类型 | 描述 |
| ----------------------| ---------------------- | ------------------------ |
| `track` | `IRemoteVideoTrack` &VerticalLine; `IRemoteAudioTrack` &VerticalLine; `undefined` | 远端用户的音频和视频轨道。如果远端用户或音频、视频轨道不存在，则返回 `undefined`。 |
| `isLoading` | `boolean` |<li>`true`：正在执行获取轨道相关操作。</li><li>`false`：已经执行获取轨道相关操作，但不代表成功获取轨道。</li> |
| `error` | `AgoraRtcReactError` &VerticalLine; `null` | 获取轨道成功则返回 `null`，获取轨道失败则抛出错误。错误详见 [AgoraRtcReactError](./interfaces#agorartcreacterror)。 |

#### 使用示例

```jsx
import { useRemoteUsers, useRemoteUserTrack } from "agora-rtc-react";

function App() {
  const remoteUsers = useRemoteUsers();

  const videoTrack = useRemoteUserTrack(remoteUsers[0], "video");
  const audioTrack = useRemoteUserTrack(remoteUsers[0], "audio");

  return <></>;
}
```

## useRemoteUsers

用于获取远端用户列表。

发生以下情况时，该 Hook 的返回值会更新：

- 远端用户加入或离开频道。
- 远端用户的角色改变（比如从主播变为观众）。
- 远端用户发布或取消发布音频或视频轨道。

#### 参数

| 参数名   | 类型                                    | 是否必选 | 描述                                                                                                                                          |
| -------- | --------------------------------------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| `client` | `IAgoraRTCClient` &VerticalLine; `null` | 可选     | [IAgoraRTCClient](https://docportal.shengwang.cn/cn/live-streaming-premium-4.x/API%20Reference/web_ng/interfaces/iagorartcclient.html) 对象。 |

#### 返回值

| 类型                    | 描述           |
| ----------------------- | -------------- |
| `IAgoraRTCRemoteUser[]` | 远端用户列表。 |

#### 使用示例

```jsx
import { useRemoteUsers } from "agora-rtc-react";

function App() {
  const remoteUsers = useRemoteUsers();

  return <></>;
}
```

## useAutoPlayVideoTrack

用于控制本地或远端视频轨道。

- 当组件挂载时，该 Hook 会根据传入的 `play` 判断是否自动播放。
- 当组件卸载时，该 Hook 会停止播放 `track` 对应的视频轨道。

#### 参数

| 参数名  | 类型                                                  | 是否必选 | 描述                                                                                                   |
| ------- | ----------------------------------------------------- | -------- | ------------------------------------------------------------------------------------------------------ |
| `track` | `IRemoteVideoTrack` &VerticalLine; `ILocalVideoTrack` | 必选     | 远端视频轨道对象或本地视频轨道对象。                                                                   |
| `play`  | `boolean`                                             | 可选     | <li>`true`：播放该轨道。</li><li>`false`：停止播放该轨道。</li>                                        |
| `div`   | `HTMLElement` &VerticalLine; `null`                   | 可选     | 用于渲染视频的 HTML 元素。如果提供了该参数，视频将在该元素中自动播放。如果未提供，则不会自动播放视频。 |

#### 返回值

无。

#### 使用示例

```jsx
import { useAutoPlayVideoTrack, useLocalCameraTrack } from "agora-rtc-react";

function App() {
  const videoTrack = useLocalCameraTrack();
  useAutoPlayVideoTrack(track, play, div);

  return <></>;
}
```

## useAutoPlayAudioTrack

用于控制本地或远端音频轨道。

- 当组件挂载时，该 Hook 会根据传入的 `play` 判断是否自动播放。
- 当组件卸载时，该 Hook 会停止播放 `track` 对应的音频轨道。

#### 参数

| 参数名  | 类型                                                   | 是否必选 | 描述                                                            |
| ------- | ------------------------------------------------------ | -------- | --------------------------------------------------------------- |
| `track` | `IRemoteAudioTrack` &VerticalLine; `ILocalAudioTrack>` | 必选     | 远端音频轨道对象或本地音频轨道对象。                            |
| `play`  | `boolean`                                              | 可选     | <li>`true`：播放该轨道。</li><li>`false`：停止播放该轨道。</li> |

#### 返回值

无。

#### 使用示例

```jsx
import { useAutoPlayAudioTrack, useLocalMicrophoneTrack } from "agora-rtc-react";

function App() {
  const audioTrack = useLocalMicrophoneTrack();
  useAutoPlayAudioTrack(track, play);

  return <></>;
}
```

var A=Object.defineProperty;var I=(t,e,o)=>e in t?A(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var T=(t,e,o)=>(I(t,typeof e!="symbol"?e+"":e,o),o);import{j as p}from"./jsx-runtime-94f6e698.js";import{u as N,F as D,a as q}from"./styles-8e94b0fb.js";import{R as P}from"./RemoteAudioTrack-5ba36913.js";import{R as M}from"./RemoteVideoTrack-a3eec6cb.js";import{u as E,U as O}from"./useRTCClient-c3e6f1e0.js";import{r as u}from"./index-8db94870.js";import{j as S,t as L,l as _}from"./TrackBoundary-b755f9d3.js";function v(t,e,o){return t.on(e,o),()=>t.off(e,o)}function V(t){const e=E(t),[o,r]=u.useState(e?e.connectionState==="CONNECTED":!1);return u.useEffect(()=>{if(e){r(e.connectionState==="CONNECTED");let s;return S([v(e,"connection-state-change",d=>{s==null||s(),s=L(()=>r(d==="CONNECTED"),0)}),()=>s==null?void 0:s()])}else r(!1)},[e]),o}class x extends Error{constructor(o,r){var e=(...args)=>{super(...args);T(this,"rtcMethod");T(this,"rtcError");T(this,"name","AgoraRTCReactException")};e(typeof r=="string"?r:r.message),this.rtcMethod=o,this.rtcError=r}log(o){console[o](this)}}function U(t,e,o){const r=E(o),s=e==="audio"?"audioTrack":"videoTrack",[d,m]=u.useState(t&&t[s]),h=V(),f=u.useRef(),[k,l]=u.useState(!1),[y,R]=u.useState(null);return u.useEffect(()=>{if(!t||!h)return;let a=!1;a||R(null);const w=e==="audio"?"hasAudio":"hasVideo",b=t.uid,j=async(n,c)=>{if(n[s]&&r.remoteUsers.some(({uid:i})=>n.uid===i))try{a||l(!0),await r.unsubscribe(n,c)}catch(i){a||R(new x("IAgoraRTCClient.unsubscribe",i)),console.error(i)}a||(m(void 0),l(!1))},C=async(n,c)=>{try{!n[s]&&r.remoteUsers.some(({uid:i})=>n.uid===i)&&(a||l(!0),await r.subscribe(n,c)),a||m(n[s])}catch(i){a||R(new x("IAgoraRTCClient.subscribe",i)),console.error(i)}a||l(!1)},g=f.current||(f.current=_());return!t[s]&&t[w]?g.run(()=>C(t,e)):m(t[s]),S([()=>{a=!0,g.dispose()},v(r,"user-published",(n,c)=>{n.uid===b&&c===e&&g.run(()=>C(n,e))}),v(r,"user-unpublished",(n,c)=>{n.uid===b&&c===e&&g.run(()=>j(n,e))})])},[h,r,t,e,s]),{track:d,isLoading:k,error:y}}function F({user:t,playVideo:e,playAudio:o,playbackDeviceId:r,volume:s,cover:d,style:m,children:h,...f}){const k=N(q,m),{track:l}=U(t,"video"),{track:y}=U(t,"audio");return e=e??(t==null?void 0:t.hasVideo),o=o??(t==null?void 0:t.hasAudio),p.jsxs("div",{...f,style:k,children:[p.jsx(M,{play:e,track:l}),p.jsx(P,{play:o,playbackDeviceId:r,track:y,volume:s}),d&&!e&&p.jsx(O,{cover:d}),p.jsx("div",{style:D,children:h})]})}F.__docgenInfo={description:`This component plays the video and audio tracks of a remote user and supports specifying the audio device to use. Specifying the video playback device is not supported.
@example
\`\`\`jsx
import { RemoteUser, useRemoteUsers } from "agora-rtc-react";

function App() {
  const remoteUsers = useRemoteUsers();

  return (
    <>
      {remoteUsers.map(user => (
        <RemoteUser key={user.uid} user={user} />
      ))}
    </>
  );
}
\`\`\``,methods:[],displayName:"RemoteUser",props:{user:{required:!1,tsType:{name:"IAgoraRTCRemoteUser"},description:"The remote user object."},playVideo:{required:!1,tsType:{name:"boolean"},description:"`true`: Play the video track of the remote user.`false`: Stop playing the video track of the remote user."},playAudio:{required:!1,tsType:{name:"boolean"},description:"`true`: Play the audio track of the remote user.`false`: Stop playing the audio track of the remote user."},playbackDeviceId:{required:!1,tsType:{name:"string"},description:"The ID of the playback device, such as a speaker. The device ID can be obtained using [`IAgoraRTC.getPlaybackDevices`](https://docportal.shengwang.cn/cn/live-streaming-premium-4.x/API%20Reference/web_ng/interfaces/iagorartc.html#getplaybackdevices). This property is only supported in the desktop version of the Chrome browser. Modifying the value of this property in other browsers throws a `NOT_SUPPORTED` error."},volume:{required:!1,tsType:{name:"number"},description:"The volume. The value ranges from 0 (mute) to 100 (the original volume)."},cover:{required:!1,tsType:{name:"union",raw:"string | (() => ReactNode)",elements:[{name:"string"},{name:"unknown"}]},description:"The cover image or custom component to be displayed when `playVideo` is `false`, replacing the video frame. You can pass the URL of an online image or the relative path of a local image."},children:{required:!1,tsType:{name:"ReactNode"},description:"The React nodes to be rendered."}},composes:["HTMLProps"]};export{F as R};
//# sourceMappingURL=RemoteUser-eb211966.js.map

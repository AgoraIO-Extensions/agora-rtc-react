{"version":3,"file":"RemoteVideoPlayer.stories-acbcd0c4.js","sources":["../../src/components/RemoteVideoPlayer.tsx","../../src/components/RemoteVideoPlayer.stories.tsx"],"sourcesContent":["import type { IAgoraRTCClient, IRemoteVideoTrack } from \"agora-rtc-sdk-ng\";\nimport type { HTMLProps, ReactNode } from \"react\";\n\nimport { useRTCClient } from \"../hooks\";\n\nimport { RemoteVideoTrack } from \"./RemoteVideoTrack\";\nimport { UserCover } from \"./UserCover\";\nimport { FloatBoxStyle, VideoTrackWrapperStyle, useMergedStyle } from \"./styles\";\n\nexport interface RemoteVideoPlayerProps extends HTMLProps<HTMLDivElement> {\n  /**\n   * A remote track\n   */\n  readonly track?: IRemoteVideoTrack;\n  /**\n   * Whether to play the remote user's video track. Default follows `user.hasVideo`.\n   */\n  readonly playVideo?: boolean;\n  /**\n   * Render cover image if playVideo is off.\n   */\n  readonly cover?: string | (() => ReactNode);\n  /**\n   * Children is rendered on top of the video canvas.\n   */\n  readonly children?: ReactNode;\n  /**\n   * client instance\n   */\n  readonly client?: IAgoraRTCClient | null;\n}\n\n/**\n * Subscribe and play remote user video track.\n * An `IRemoteVideoTrack` can only be own by one `RemoteVideoPlayer`.\n */\nexport function RemoteVideoPlayer({\n  track,\n  playVideo,\n  cover,\n  client,\n  style,\n  children,\n  ...props\n}: RemoteVideoPlayerProps) {\n  const mergedStyle = useMergedStyle(VideoTrackWrapperStyle, style);\n  const resolvedClient = useRTCClient(client);\n  const hasVideo = resolvedClient.remoteUsers?.find(\n    user => user.uid === track?.getUserId(),\n  )?.hasVideo;\n  playVideo = playVideo ?? hasVideo;\n  return (\n    <div {...props} style={mergedStyle}>\n      <RemoteVideoTrack play={playVideo} track={track} />\n      {cover && !playVideo && <UserCover cover={cover} />}\n      <div style={FloatBoxStyle}>{children}</div>\n    </div>\n  );\n}\n","import type { Meta, StoryObj } from \"@storybook/react\";\nimport { FakeRTCClient, FakeRemoteVideoTrack } from \"fake-agora-rtc\";\nimport { useState } from \"react\";\nimport { AgoraRTCProvider } from \"../hooks/context\";\nimport type { RemoteVideoPlayerProps } from \"./RemoteVideoPlayer\";\nimport { RemoteVideoPlayer } from \"./RemoteVideoPlayer\";\nconst meta: Meta<RemoteVideoPlayerProps> = {\n  title: \"Video/RemoteVideoPlayer\",\n  component: RemoteVideoPlayer,\n  tags: [\"autodocs\"],\n  argTypes: {\n    track: {\n      control: {\n        type: null\n      }\n    },\n    client: {\n      control: {\n        type: null\n      }\n    }\n  },\n  parameters: {\n    backgrounds: {\n      default: \"light\"\n    }\n  },\n  decorators: [Story => {\n    const [client] = useState(() => FakeRTCClient.create());\n    return <AgoraRTCProvider client={client}>{Story()}</AgoraRTCProvider>;\n  }]\n};\nexport default meta;\nfunction RenderRemoteVideoPlayer(args: RemoteVideoPlayerProps) {\n  const {\n    track\n  } = args;\n  const [_track] = useState(() => track ? FakeRemoteVideoTrack.create() : undefined);\n  return <RemoteVideoPlayer {...args} track={_track} />;\n}\nexport const Overview: StoryObj<RemoteVideoPlayerProps> = {\n  parameters: {\n    docs: {\n      description: {\n        story: \"Show cover image if `playVideo` is `false`.\"\n      }\n    }\n  },\n  args: {\n    playVideo: true,\n    track: FakeRemoteVideoTrack.create(),\n    style: {\n      width: 288,\n      height: 216\n    }\n  },\n  render: RenderRemoteVideoPlayer\n};\nexport const WithCover: StoryObj<RemoteVideoPlayerProps> = {\n  parameters: {\n    docs: {\n      description: {\n        story: \"Show cover image if `playVideo` is `false`.\"\n      }\n    }\n  },\n  args: {\n    playVideo: false,\n    track: FakeRemoteVideoTrack.create(),\n    cover: \"https://www.agora.io/en/wp-content/uploads/2022/10/3d-spatial-audio-icon.svg\",\n    style: {\n      width: 288,\n      height: 216\n    }\n  },\n  render: RenderRemoteVideoPlayer\n};\nOverview.parameters = {\n  ...Overview.parameters,\n  docs: {\n    ...Overview.parameters?.docs,\n    source: {\n      originalSource: \"{\\n  parameters: {\\n    docs: {\\n      description: {\\n        story: \\\"Show cover image if `playVideo` is `false`.\\\"\\n      }\\n    }\\n  },\\n  args: {\\n    playVideo: true,\\n    track: FakeRemoteVideoTrack.create(),\\n    style: {\\n      width: 288,\\n      height: 216\\n    }\\n  },\\n  render: RenderRemoteVideoPlayer\\n}\",\n      ...Overview.parameters?.docs?.source\n    }\n  }\n};\nWithCover.parameters = {\n  ...WithCover.parameters,\n  docs: {\n    ...WithCover.parameters?.docs,\n    source: {\n      originalSource: \"{\\n  parameters: {\\n    docs: {\\n      description: {\\n        story: \\\"Show cover image if `playVideo` is `false`.\\\"\\n      }\\n    }\\n  },\\n  args: {\\n    playVideo: false,\\n    track: FakeRemoteVideoTrack.create(),\\n    cover: \\\"https://www.agora.io/en/wp-content/uploads/2022/10/3d-spatial-audio-icon.svg\\\",\\n    style: {\\n      width: 288,\\n      height: 216\\n    }\\n  },\\n  render: RenderRemoteVideoPlayer\\n}\",\n      ...WithCover.parameters?.docs?.source\n    }\n  }\n};"],"names":["RemoteVideoPlayer","track","playVideo","cover","client","style","children","props","mergedStyle","useMergedStyle","VideoTrackWrapperStyle","hasVideo","_b","_a","useRTCClient","user","jsxs","jsx","RemoteVideoTrack","UserCover","FloatBoxStyle","meta","Story","useState","FakeRTCClient","AgoraRTCProvider","RenderRemoteVideoPlayer","args","_track","FakeRemoteVideoTrack","Overview","WithCover","_c"],"mappings":"ofAoCA,SAAAA,EAAA,CACA,MAAAC,EACA,UAAAC,EACA,MAAAC,EACA,OAAAC,EACA,MAAAC,EACA,SAAAC,EACA,GAAAC,CACA,EAAA,SACA,MAAAC,EAAAC,EAAAC,EAAAL,CAAA,EAEAM,GAAAC,GAAAC,EADAC,EAAAV,CAAA,EACA,cAAA,YAAAS,EAAA,KACAE,GAAAA,EAAA,OAAAd,GAAA,YAAAA,EAAA,gBADA,YAAAW,EAEA,SACA,OAAAV,EAAAA,GAAAS,EAEAK,EAAA,MAAA,CAAA,GAAAT,EAAA,MAAAC,EACA,SAAA,CAAAS,EAAAC,EAAA,CAAA,KAAAhB,EAAA,MAAAD,CAAA,CAAA,EACAE,GAAA,CAAAD,GAAAe,EAAAE,GAAA,MAAAhB,CAAA,CAAA,EACAc,EAAA,MAAA,CAAA,MAAAG,EAAA,SAAAd,CAAA,CAAA,CACA,CAAA,CAAA,CAEA,g3BCpDA,MAAMe,EAAqC,CACzC,MAAO,0BACP,UAAWrB,EACX,KAAM,CAAC,UAAU,EACjB,SAAU,CACR,MAAO,CACL,QAAS,CACP,KAAM,IACR,CACF,EACA,OAAQ,CACN,QAAS,CACP,KAAM,IACR,CACF,CACF,EACA,WAAY,CACV,YAAa,CACX,QAAS,OACX,CACF,EACA,WAAY,CAAUsB,GAAA,CACpB,KAAM,CAAClB,CAAM,EAAImB,EAAAA,SAAS,IAAMC,EAAc,QAAQ,EACtD,OAAQP,EAAAQ,EAAA,CAAiB,OAAArB,EAAiB,SAAAkB,EAAQ,CAAA,CAAA,CAAA,CACnD,CACH,EAEA,SAASI,EAAwBC,EAA8B,CACvD,KAAA,CACJ,MAAA1B,CACE,EAAA0B,EACE,CAACC,CAAM,EAAIL,EAAAA,SAAS,IAAMtB,EAAQ4B,EAAqB,OAAO,EAAI,MAAS,EACjF,OAAQZ,EAAAjB,EAAA,CAAmB,GAAG2B,EAAM,MAAOC,CAAQ,CAAA,CACrD,CACO,MAAME,EAA6C,CACxD,WAAY,CACV,KAAM,CACJ,YAAa,CACX,MAAO,6CACT,CACF,CACF,EACA,KAAM,CACJ,UAAW,GACX,MAAOD,EAAqB,OAAO,EACnC,MAAO,CACL,MAAO,IACP,OAAQ,GACV,CACF,EACA,OAAQH,CACV,EACaK,EAA8C,CACzD,WAAY,CACV,KAAM,CACJ,YAAa,CACX,MAAO,6CACT,CACF,CACF,EACA,KAAM,CACJ,UAAW,GACX,MAAOF,EAAqB,OAAO,EACnC,MAAO,+EACP,MAAO,CACL,MAAO,IACP,OAAQ,GACV,CACF,EACA,OAAQH,CACV,YACAI,EAAS,WAAa,CACpB,GAAGA,EAAS,WACZ,KAAM,CACJ,IAAGjB,EAAAiB,EAAS,aAAT,YAAAjB,EAAqB,KACxB,OAAQ,CACN,eAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAChB,IAAGmB,GAAApB,EAAAkB,EAAS,aAAT,YAAAlB,EAAqB,OAArB,YAAAoB,EAA2B,MAChC,CACF,CACF,YACAD,EAAU,WAAa,CACrB,GAAGA,EAAU,WACb,KAAM,CACJ,IAAGlB,EAAAkB,EAAU,aAAV,YAAAlB,EAAsB,KACzB,OAAQ,CACN,eAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAChB,IAAGmB,GAAApB,EAAAmB,EAAU,aAAV,YAAAnB,EAAsB,OAAtB,YAAAoB,EAA4B,MACjC,CACF,CACF"}
var N=Object.defineProperty;var A=(t,e,o)=>e in t?N(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var T=(t,e,o)=>(A(t,typeof e!="symbol"?e+"":e,o),o);import{j as p}from"./jsx-runtime-94f6e698.js";import{u as I,F as D,a as q}from"./styles-8e94b0fb.js";import{R as P}from"./RemoteAudioTrack-36ec51d7.js";import{R as M}from"./RemoteVideoTrack-2f52d62e.js";import{u as E,U as O}from"./useRTCClient-baec1e01.js";import{r as u}from"./index-8db94870.js";import{j as S,t as L,l as V}from"./TrackBoundary-2c41e911.js";function R(t,e,o){return t.on(e,o),()=>t.off(e,o)}function _(t){const e=E(t),[o,r]=u.useState(e?e.connectionState==="CONNECTED":!1);return u.useEffect(()=>{if(e){r(e.connectionState==="CONNECTED");let s;return S([R(e,"connection-state-change",d=>{s==null||s(),s=L(()=>r(d==="CONNECTED"),0)}),()=>s==null?void 0:s()])}else r(!1)},[e]),o}class x extends Error{constructor(o,r){var e=(...args)=>{super(...args);T(this,"rtcMethod");T(this,"rtcError");T(this,"name","AgoraRTCReactException")};e(typeof r=="string"?r:r.message),this.rtcMethod=o,this.rtcError=r}log(o){console[o](this)}}function U(t,e,o){const r=E(o),s=e==="audio"?"audioTrack":"videoTrack",[d,f]=u.useState(t&&t[s]),h=_(),m=u.useRef(),[k,l]=u.useState(!1),[y,v]=u.useState(null);return u.useEffect(()=>{if(!t||!h)return;let a=!1;a||v(null);const j=e==="audio"?"hasAudio":"hasVideo",b=t.uid,w=async(n,c)=>{if(n[s]&&r.remoteUsers.some(({uid:i})=>n.uid===i))try{a||l(!0),await r.unsubscribe(n,c)}catch(i){a||v(new x("IAgoraRTCClient.unsubscribe",i)),console.error(i)}a||(f(void 0),l(!1))},C=async(n,c)=>{try{!n[s]&&r.remoteUsers.some(({uid:i})=>n.uid===i)&&(a||l(!0),await r.subscribe(n,c)),a||f(n[s])}catch(i){a||v(new x("IAgoraRTCClient.subscribe",i)),console.error(i)}a||l(!1)},g=m.current||(m.current=V());return!t[s]&&t[j]?g.run(()=>C(t,e)):f(t[s]),S([()=>{a=!0,g.dispose()},R(r,"user-published",(n,c)=>{n.uid===b&&c===e&&g.run(()=>C(n,e))}),R(r,"user-unpublished",(n,c)=>{n.uid===b&&c===e&&g.run(()=>w(n,e))})])},[h,r,t,e,s]),{track:d,isLoading:k,error:y}}function F({user:t,playVideo:e,playAudio:o,playbackDeviceId:r,volume:s,cover:d,style:f,children:h,...m}){const k=I(q,f),{track:l}=U(t,"video"),{track:y}=U(t,"audio");return e=e??(t==null?void 0:t.hasVideo),o=o??(t==null?void 0:t.hasAudio),p.jsxs("div",{...m,style:k,children:[p.jsx(M,{play:e,track:l}),p.jsx(P,{play:o,playbackDeviceId:r,track:y,volume:s}),d&&!e&&p.jsx(O,{cover:d}),p.jsx("div",{style:D,children:h})]})}F.__docgenInfo={description:`This component plays the video and audio tracks of a remote user and supports specifying the audio device to use. Specifying the video playback device is not supported.
@example
\`\`\`jsx
import { RemoteUser, useRemoteUsers } from "agora-rtc-react";

function App() {
  const remoteUsers = useRemoteUsers();

  return (
    <>
      {remoteUsers.map(user => (
        <RemoteUser key={user.uid} user={user} />
      ))}
    </>
  );
}
\`\`\``,methods:[],displayName:"RemoteUser",props:{user:{required:!1,tsType:{name:"IAgoraRTCRemoteUser"},description:"The remote user object."},playVideo:{required:!1,tsType:{name:"boolean"},description:"`true`: Play the video track of the remote user.`false`: Stop playing the video track of the remote user."},playAudio:{required:!1,tsType:{name:"boolean"},description:"`true`: Play the audio track of the remote user.`false`: Stop playing the audio track of the remote user."},playbackDeviceId:{required:!1,tsType:{name:"string"},description:"The ID of the playback device, such as a speaker. The device ID can be obtained using [`IAgoraRTC.getPlaybackDevices`](https://api-ref.agora.io/en/video-sdk/web/4.x/interfaces/iagorartc.html#getplaybackdevices). This property is only supported in the desktop version of the Chrome browser. Modifying the value of this property in other browsers throws a `NOT_SUPPORTED` error."},volume:{required:!1,tsType:{name:"number"},description:"The volume. The value ranges from 0 (mute) to 100 (the original volume)."},cover:{required:!1,tsType:{name:"union",raw:"string | (() => ReactNode)",elements:[{name:"string"},{name:"unknown"}]},description:"The cover image or custom component to be displayed when `playVideo` is `false`, replacing the video frame. You can pass the URL of an online image or the relative path of a local image."},children:{required:!1,tsType:{name:"ReactNode"},description:"The React nodes to be rendered."}},composes:["HTMLProps"]};export{F as R};
//# sourceMappingURL=RemoteUser-4964849d.js.map

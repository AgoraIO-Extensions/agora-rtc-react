var bre=Object.defineProperty;var Tre=(e,r,o)=>r in e?bre(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o;var OE=(e,r,o)=>(Tre(e,typeof r!="symbol"?r+"":r,o),o);function C8(e,r){for(var o=0;o<r.length;o++){const s=r[o];if(typeof s!="string"&&!Array.isArray(s)){for(const c in s)if(c!=="default"&&!(c in e)){const d=Object.getOwnPropertyDescriptor(s,c);d&&Object.defineProperty(e,c,d.get?d:{enumerable:!0,get:()=>s[c]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))s(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&s(f)}).observe(document,{childList:!0,subtree:!0});function o(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function s(c){if(c.ep)return;c.ep=!0;const d=o(c);fetch(c.href,d)}})();var Ft=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ol(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Rre(e){if(e.__esModule)return e;var r=e.default;if(typeof r=="function"){var o=function s(){return this instanceof s?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};o.prototype=r.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var c=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(o,s,c.get?c:{enumerable:!0,get:function(){return e[s]}})}),o}var b8={exports:{}},$y={},T8={exports:{}},Tn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ig=Symbol.for("react.element"),wre=Symbol.for("react.portal"),Ire=Symbol.for("react.fragment"),Are=Symbol.for("react.strict_mode"),Ore=Symbol.for("react.profiler"),xre=Symbol.for("react.provider"),Nre=Symbol.for("react.context"),Pre=Symbol.for("react.forward_ref"),Dre=Symbol.for("react.suspense"),kre=Symbol.for("react.memo"),Lre=Symbol.for("react.lazy"),M4=Symbol.iterator;function Mre(e){return e===null||typeof e!="object"?null:(e=M4&&e[M4]||e["@@iterator"],typeof e=="function"?e:null)}var R8={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w8=Object.assign,I8={};function df(e,r,o){this.props=e,this.context=r,this.refs=I8,this.updater=o||R8}df.prototype.isReactComponent={};df.prototype.setState=function(e,r){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,r,"setState")};df.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function A8(){}A8.prototype=df.prototype;function ZA(e,r,o){this.props=e,this.context=r,this.refs=I8,this.updater=o||R8}var eO=ZA.prototype=new A8;eO.constructor=ZA;w8(eO,df.prototype);eO.isPureReactComponent=!0;var F4=Array.isArray,O8=Object.prototype.hasOwnProperty,tO={current:null},x8={key:!0,ref:!0,__self:!0,__source:!0};function N8(e,r,o){var s,c={},d=null,f=null;if(r!=null)for(s in r.ref!==void 0&&(f=r.ref),r.key!==void 0&&(d=""+r.key),r)O8.call(r,s)&&!x8.hasOwnProperty(s)&&(c[s]=r[s]);var m=arguments.length-2;if(m===1)c.children=o;else if(1<m){for(var g=Array(m),_=0;_<m;_++)g[_]=arguments[_+2];c.children=g}if(e&&e.defaultProps)for(s in m=e.defaultProps,m)c[s]===void 0&&(c[s]=m[s]);return{$$typeof:ig,type:e,key:d,ref:f,props:c,_owner:tO.current}}function Fre(e,r){return{$$typeof:ig,type:e.type,key:r,ref:e.ref,props:e.props,_owner:e._owner}}function nO(e){return typeof e=="object"&&e!==null&&e.$$typeof===ig}function Ure(e){var r={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(o){return r[o]})}var U4=/\/+/g;function QR(e,r){return typeof e=="object"&&e!==null&&e.key!=null?Ure(""+e.key):r.toString(36)}function v_(e,r,o,s,c){var d=typeof e;(d==="undefined"||d==="boolean")&&(e=null);var f=!1;if(e===null)f=!0;else switch(d){case"string":case"number":f=!0;break;case"object":switch(e.$$typeof){case ig:case wre:f=!0}}if(f)return f=e,c=c(f),e=s===""?"."+QR(f,0):s,F4(c)?(o="",e!=null&&(o=e.replace(U4,"$&/")+"/"),v_(c,r,o,"",function(_){return _})):c!=null&&(nO(c)&&(c=Fre(c,o+(!c.key||f&&f.key===c.key?"":(""+c.key).replace(U4,"$&/")+"/")+e)),r.push(c)),1;if(f=0,s=s===""?".":s+":",F4(e))for(var m=0;m<e.length;m++){d=e[m];var g=s+QR(d,m);f+=v_(d,r,o,g,c)}else if(g=Mre(e),typeof g=="function")for(e=g.call(e),m=0;!(d=e.next()).done;)d=d.value,g=s+QR(d,m++),f+=v_(d,r,o,g,c);else if(d==="object")throw r=String(e),Error("Objects are not valid as a React child (found: "+(r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return f}function xE(e,r,o){if(e==null)return e;var s=[],c=0;return v_(e,s,"","",function(d){return r.call(o,d,c++)}),s}function Bre(e){if(e._status===-1){var r=e._result;r=r(),r.then(function(o){(e._status===0||e._status===-1)&&(e._status=1,e._result=o)},function(o){(e._status===0||e._status===-1)&&(e._status=2,e._result=o)}),e._status===-1&&(e._status=0,e._result=r)}if(e._status===1)return e._result.default;throw e._result}var Vo={current:null},E_={transition:null},jre={ReactCurrentDispatcher:Vo,ReactCurrentBatchConfig:E_,ReactCurrentOwner:tO};Tn.Children={map:xE,forEach:function(e,r,o){xE(e,function(){r.apply(this,arguments)},o)},count:function(e){var r=0;return xE(e,function(){r++}),r},toArray:function(e){return xE(e,function(r){return r})||[]},only:function(e){if(!nO(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Tn.Component=df;Tn.Fragment=Ire;Tn.Profiler=Ore;Tn.PureComponent=ZA;Tn.StrictMode=Are;Tn.Suspense=Dre;Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jre;Tn.cloneElement=function(e,r,o){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=w8({},e.props),c=e.key,d=e.ref,f=e._owner;if(r!=null){if(r.ref!==void 0&&(d=r.ref,f=tO.current),r.key!==void 0&&(c=""+r.key),e.type&&e.type.defaultProps)var m=e.type.defaultProps;for(g in r)O8.call(r,g)&&!x8.hasOwnProperty(g)&&(s[g]=r[g]===void 0&&m!==void 0?m[g]:r[g])}var g=arguments.length-2;if(g===1)s.children=o;else if(1<g){m=Array(g);for(var _=0;_<g;_++)m[_]=arguments[_+2];s.children=m}return{$$typeof:ig,type:e.type,key:c,ref:d,props:s,_owner:f}};Tn.createContext=function(e){return e={$$typeof:Nre,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:xre,_context:e},e.Consumer=e};Tn.createElement=N8;Tn.createFactory=function(e){var r=N8.bind(null,e);return r.type=e,r};Tn.createRef=function(){return{current:null}};Tn.forwardRef=function(e){return{$$typeof:Pre,render:e}};Tn.isValidElement=nO;Tn.lazy=function(e){return{$$typeof:Lre,_payload:{_status:-1,_result:e},_init:Bre}};Tn.memo=function(e,r){return{$$typeof:kre,type:e,compare:r===void 0?null:r}};Tn.startTransition=function(e){var r=E_.transition;E_.transition={};try{e()}finally{E_.transition=r}};Tn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Tn.useCallback=function(e,r){return Vo.current.useCallback(e,r)};Tn.useContext=function(e){return Vo.current.useContext(e)};Tn.useDebugValue=function(){};Tn.useDeferredValue=function(e){return Vo.current.useDeferredValue(e)};Tn.useEffect=function(e,r){return Vo.current.useEffect(e,r)};Tn.useId=function(){return Vo.current.useId()};Tn.useImperativeHandle=function(e,r,o){return Vo.current.useImperativeHandle(e,r,o)};Tn.useInsertionEffect=function(e,r){return Vo.current.useInsertionEffect(e,r)};Tn.useLayoutEffect=function(e,r){return Vo.current.useLayoutEffect(e,r)};Tn.useMemo=function(e,r){return Vo.current.useMemo(e,r)};Tn.useReducer=function(e,r,o){return Vo.current.useReducer(e,r,o)};Tn.useRef=function(e){return Vo.current.useRef(e)};Tn.useState=function(e){return Vo.current.useState(e)};Tn.useSyncExternalStore=function(e,r,o){return Vo.current.useSyncExternalStore(e,r,o)};Tn.useTransition=function(){return Vo.current.useTransition()};Tn.version="18.2.0";T8.exports=Tn;var b=T8.exports;const St=Ol(b),Yd=C8({__proto__:null,default:St},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vre=b,$re=Symbol.for("react.element"),Hre=Symbol.for("react.fragment"),Wre=Object.prototype.hasOwnProperty,Gre=Vre.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zre={key:!0,ref:!0,__self:!0,__source:!0};function P8(e,r,o){var s,c={},d=null,f=null;o!==void 0&&(d=""+o),r.key!==void 0&&(d=""+r.key),r.ref!==void 0&&(f=r.ref);for(s in r)Wre.call(r,s)&&!zre.hasOwnProperty(s)&&(c[s]=r[s]);if(e&&e.defaultProps)for(s in r=e.defaultProps,r)c[s]===void 0&&(c[s]=r[s]);return{$$typeof:$re,type:e,key:d,ref:f,props:c,_owner:Gre.current}}$y.Fragment=Hre;$y.jsx=P8;$y.jsxs=P8;b8.exports=$y;var ne=b8.exports;var D8={exports:{}};(function(e,r){(function(o,s){e.exports=s()})(Ft,function(){function o(i,t){return t.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(a){if(a!=="default"&&!(a in i)){var l=Object.getOwnPropertyDescriptor(n,a);Object.defineProperty(i,a,l.get?l:{enumerable:!0,get:function(){return n[a]}})}})}),Object.freeze(i)}var s=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Ft<"u"?Ft:typeof self<"u"?self:{};function c(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var d=function(i){try{return!!i()}catch{return!0}},f=!d(function(){var i=(function(){}).bind();return typeof i!="function"||i.hasOwnProperty("prototype")}),m=f,g=Function.prototype,_=g.call,S=m&&g.bind.bind(_,_),T=m?S:function(i){return function(){return _.apply(i,arguments)}},R=T({}.isPrototypeOf),N=function(i){return i&&i.Math==Math&&i},A=N(typeof globalThis=="object"&&globalThis)||N(typeof window=="object"&&window)||N(typeof self=="object"&&self)||N(typeof s=="object"&&s)||function(){return this}()||s||Function("return this")(),O=f,M=Function.prototype,x=M.apply,P=M.call,D=typeof Reflect=="object"&&Reflect.apply||(O?P.bind(x):function(){return P.apply(x,arguments)}),F=T,$=F({}.toString),V=F("".slice),W=function(i){return V($(i),8,-1)},K=W,Q=T,Y=function(i){if(K(i)==="Function")return Q(i)},ee=typeof document=="object"&&document.all,te={all:ee,IS_HTMLDDA:ee===void 0&&ee!==void 0},ie=te.all,le=te.IS_HTMLDDA?function(i){return typeof i=="function"||i===ie}:function(i){return typeof i=="function"},me={},ce=!d(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),se=f,ae=Function.prototype.call,ge=se?ae.bind(ae):function(){return ae.apply(ae,arguments)},Se={},de={}.propertyIsEnumerable,he=Object.getOwnPropertyDescriptor,be=he&&!de.call({1:2},1);Se.f=be?function(i){var t=he(this,i);return!!t&&t.enumerable}:de;var ve,ke,Le=function(i,t){return{enumerable:!(1&i),configurable:!(2&i),writable:!(4&i),value:t}},$e=d,Ve=W,ut=Object,ht=T("".split),Ct=$e(function(){return!ut("z").propertyIsEnumerable(0)})?function(i){return Ve(i)=="String"?ht(i,""):ut(i)}:ut,gt=function(i){return i==null},kt=gt,It=TypeError,Lt=function(i){if(kt(i))throw It("Can't call method on "+i);return i},Yt=Ct,jt=Lt,He=function(i){return Yt(jt(i))},dt=le,rt=te.all,et=te.IS_HTMLDDA?function(i){return typeof i=="object"?i!==null:dt(i)||i===rt}:function(i){return typeof i=="object"?i!==null:dt(i)},lt={},Dt=lt,Ht=A,En=le,Vt=function(i){return En(i)?i:void 0},vn=function(i,t){return arguments.length<2?Vt(Dt[i])||Vt(Ht[i]):Dt[i]&&Dt[i][t]||Ht[i]&&Ht[i][t]},Un=typeof navigator<"u"&&String(navigator.userAgent)||"",xn=A,Dr=Un,ln=xn.process,Wr=xn.Deno,Gn=ln&&ln.versions||Wr&&Wr.version,zn=Gn&&Gn.v8;zn&&(ke=(ve=zn.split("."))[0]>0&&ve[0]<4?1:+(ve[0]+ve[1])),!ke&&Dr&&(!(ve=Dr.match(/Edge\/(\d+)/))||ve[1]>=74)&&(ve=Dr.match(/Chrome\/(\d+)/))&&(ke=+ve[1]);var on=ke,Ai=on,va=d,kr=A.String,Zn=!!Object.getOwnPropertySymbols&&!va(function(){var i=Symbol();return!kr(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&Ai&&Ai<41}),tt=Zn&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Tt=vn,Rn=le,Jt=R,Qt=Object,fr=tt?function(i){return typeof i=="symbol"}:function(i){var t=Tt("Symbol");return Rn(t)&&Jt(t.prototype,Qt(i))},Kn=String,Mt=function(i){try{return Kn(i)}catch{return"Object"}},dn=le,kn=Mt,er=TypeError,Yn=function(i){if(dn(i))return i;throw er(kn(i)+" is not a function")},Qr=Yn,Oi=gt,Ji=function(i,t){var n=i[t];return Oi(n)?void 0:Qr(n)},Ka=ge,Ea=le,ri=et,Ya=TypeError,_a={exports:{}},qa=A,cc=Object.defineProperty,Dl=function(i,t){try{cc(qa,i,{value:t,configurable:!0,writable:!0})}catch{qa[i]=t}return t},Oo="__core-js_shared__",lc=A[Oo]||Dl(Oo,{}),Ui=lc;(_a.exports=function(i,t){return Ui[i]||(Ui[i]=t!==void 0?t:{})})("versions",[]).push({version:"3.31.1",mode:"pure",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"});var uo=_a.exports,kl=Lt,Ll=Object,xi=function(i){return Ll(kl(i))},uc=xi,Is=T({}.hasOwnProperty),Gr=Object.hasOwn||function(i,t){return Is(uc(i),t)},Xu=T,Xa=0,Ho=Math.random(),Vc=Xu(1 .toString),ya=function(i){return"Symbol("+(i===void 0?"":i)+")_"+Vc(++Xa+Ho,36)},Ja=uo,Wo=Gr,As=ya,dc=Zn,hc=tt,Bi=A.Symbol,$c=Ja("wks"),tr=hc?Bi.for||Bi:Bi&&Bi.withoutSetter||As,Pt=function(i){return Wo($c,i)||($c[i]=dc&&Wo(Bi,i)?Bi[i]:tr("Symbol."+i)),$c[i]},Bn=ge,ii=et,mi=fr,Sa=Ji,Qa=function(i,t){var n,a;if(t==="string"&&Ea(n=i.toString)&&!ri(a=Ka(n,i))||Ea(n=i.valueOf)&&!ri(a=Ka(n,i))||t!=="string"&&Ea(n=i.toString)&&!ri(a=Ka(n,i)))return a;throw Ya("Can't convert object to primitive value")},Ju=TypeError,Nf=Pt("toPrimitive"),hh=function(i,t){if(!ii(i)||mi(i))return i;var n,a=Sa(i,Nf);if(a){if(t===void 0&&(t="default"),n=Bn(a,i,t),!ii(n)||mi(n))return n;throw Ju("Can't convert object to primitive value")}return t===void 0&&(t="number"),Qa(i,t)},Pf=fr,Ml=function(i){var t=hh(i,"string");return Pf(t)?t:t+""},Df=et,Os=A.document,xo=Df(Os)&&Df(Os.createElement),Hc=function(i){return xo?Os.createElement(i):{}},Fl=Hc,xs=!ce&&!d(function(){return Object.defineProperty(Fl("div"),"a",{get:function(){return 7}}).a!=7}),pc=ce,Qu=ge,ph=Se,kf=Le,Lf=He,Mf=Ml,vt=Gr,Zt=xs,mr=Object.getOwnPropertyDescriptor;me.f=pc?mr:function(i,t){if(i=Lf(i),t=Mf(t),Zt)try{return mr(i,t)}catch{}if(vt(i,t))return kf(!Qu(ph.f,i,t),i[t])};var oi=d,Lr=le,fh=/#|\.prototype\./,Wc=function(i,t){var n=mh[wg(i)];return n==qW||n!=YW&&(Lr(t)?oi(t):!!t)},wg=Wc.normalize=function(i){return String(i).replace(fh,".").toLowerCase()},mh=Wc.data={},YW=Wc.NATIVE="N",qW=Wc.POLYFILL="P",gN=Wc,XW=Yn,JW=f,QW=Y(Y.bind),Ff=function(i,t){return XW(i),t===void 0?i:JW?QW(i,t):function(){return i.apply(t,arguments)}},Za={},vN=ce&&d(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),ZW=et,eG=String,tG=TypeError,Ns=function(i){if(ZW(i))return i;throw tG(eG(i)+" is not an object")},nG=ce,rG=xs,iG=vN,Ig=Ns,EN=Ml,oG=TypeError,cC=Object.defineProperty,aG=Object.getOwnPropertyDescriptor,lC="enumerable",uC="configurable",dC="writable";Za.f=nG?iG?function(i,t,n){if(Ig(i),t=EN(t),Ig(n),typeof i=="function"&&t==="prototype"&&"value"in n&&dC in n&&!n[dC]){var a=aG(i,t);a&&a[dC]&&(i[t]=n.value,n={configurable:uC in n?n[uC]:a[uC],enumerable:lC in n?n[lC]:a[lC],writable:!1})}return cC(i,t,n)}:cC:function(i,t,n){if(Ig(i),t=EN(t),Ig(n),rG)try{return cC(i,t,n)}catch{}if("get"in n||"set"in n)throw oG("Accessors not supported");return"value"in n&&(i[t]=n.value),i};var sG=Za,cG=Le,Ul=ce?function(i,t,n){return sG.f(i,t,cG(1,n))}:function(i,t,n){return i[t]=n,i},Ag=A,lG=D,uG=Y,dG=le,hG=me.f,pG=gN,gh=lt,fG=Ff,vh=Ul,_N=Gr,mG=function(i){var t=function(n,a,l){if(this instanceof t){switch(arguments.length){case 0:return new i;case 1:return new i(n);case 2:return new i(n,a)}return new i(n,a,l)}return lG(i,this,arguments)};return t.prototype=i.prototype,t},jn=function(i,t){var n,a,l,u,h,p,v,E,y,C=i.target,I=i.global,k=i.stat,G=i.proto,B=I?Ag:k?Ag[C]:(Ag[C]||{}).prototype,j=I?gh:gh[C]||vh(gh,C,{})[C],q=j.prototype;for(u in t)a=!(n=pG(I?u:C+(k?".":"#")+u,i.forced))&&B&&_N(B,u),p=j[u],a&&(v=i.dontCallGetSet?(y=hG(B,u))&&y.value:B[u]),h=a&&v?v:t[u],a&&typeof p==typeof h||(E=i.bind&&a?fG(h,Ag):i.wrap&&a?mG(h):G&&dG(h)?uG(h):h,(i.sham||h&&h.sham||p&&p.sham)&&vh(E,"sham",!0),vh(j,u,E),G&&(_N(gh,l=C+"Prototype")||vh(gh,l,{}),vh(gh[l],u,h),i.real&&q&&(n||!q[u])&&vh(q,u,h)))},gG=Math.ceil,vG=Math.floor,EG=Math.trunc||function(i){var t=+i;return(t>0?vG:gG)(t)},hC=function(i){var t=+i;return t!=t||t===0?0:EG(t)},_G=hC,yG=Math.max,SG=Math.min,yN=function(i,t){var n=_G(i);return n<0?yG(n+t,0):SG(n,t)},CG=hC,bG=Math.min,TG=function(i){return i>0?bG(CG(i),9007199254740991):0},Zu=function(i){return TG(i.length)},RG=He,wG=yN,IG=Zu,SN=function(i){return function(t,n,a){var l,u=RG(t),h=IG(u),p=wG(a,h);if(i&&n!=n){for(;h>p;)if((l=u[p++])!=l)return!0}else for(;h>p;p++)if((i||p in u)&&u[p]===n)return i||p||0;return!i&&-1}},pC={includes:SN(!0),indexOf:SN(!1)},AG=pC.includes;jn({target:"Array",proto:!0,forced:d(function(){return!Array(1).includes()})},{includes:function(i){return AG(this,i,arguments.length>1?arguments[1]:void 0)}});var OG=lt,Bl=function(i){return OG[i+"Prototype"]},xG=Bl("Array").includes,NG=et,PG=W,DG=Pt("match"),kG=function(i){var t;return NG(i)&&((t=i[DG])!==void 0?!!t:PG(i)=="RegExp")},LG=TypeError,CN={};CN[Pt("toStringTag")]="z";var fC=String(CN)==="[object z]",MG=fC,FG=le,Og=W,UG=Pt("toStringTag"),BG=Object,jG=Og(function(){return arguments}())=="Arguments",ed=MG?Og:function(i){var t,n,a;return i===void 0?"Undefined":i===null?"Null":typeof(n=function(l,u){try{return l[u]}catch{}}(t=BG(i),UG))=="string"?n:jG?Og(t):(a=Og(t))=="Object"&&FG(t.callee)?"Arguments":a},VG=ed,$G=String,Gc=function(i){if(VG(i)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return $G(i)},HG=Pt("match"),WG=jn,GG=function(i){if(kG(i))throw LG("The method doesn't accept regular expressions");return i},zG=Lt,bN=Gc,KG=function(i){var t=/./;try{"/./"[i](t)}catch{try{return t[HG]=!1,"/./"[i](t)}catch{}}return!1},YG=T("".indexOf);WG({target:"String",proto:!0,forced:!KG("includes")},{includes:function(i){return!!~YG(bN(zG(this)),bN(GG(i)),arguments.length>1?arguments[1]:void 0)}});var qG=Bl("String").includes,TN=R,XG=xG,JG=qG,mC=Array.prototype,gC=String.prototype,Be=c(function(i){var t=i.includes;return i===mC||TN(mC,i)&&t===mC.includes?XG:typeof i=="string"||i===gC||TN(gC,i)&&t===gC.includes?JG:t});let RN=!0,wN=!0;function xg(i,t,n){const a=i.match(t);return a&&a.length>=n&&parseInt(a[n],10)}function td(i,t,n){if(!i.RTCPeerConnection)return;const a=i.RTCPeerConnection.prototype,l=a.addEventListener;a.addEventListener=function(h,p){if(h!==t)return l.apply(this,arguments);const v=E=>{const y=n(E);y&&(p.handleEvent?p.handleEvent(y):p(y))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(p,v),l.apply(this,[h,v])};const u=a.removeEventListener;a.removeEventListener=function(h,p){if(h!==t||!this._eventMap||!this._eventMap[t])return u.apply(this,arguments);if(!this._eventMap[t].has(p))return u.apply(this,arguments);const v=this._eventMap[t].get(p);return this._eventMap[t].delete(p),this._eventMap[t].size===0&&delete this._eventMap[t],Object.keys(this._eventMap).length===0&&delete this._eventMap,u.apply(this,[h,v])},Object.defineProperty(a,"on"+t,{get(){return this["_on"+t]},set(h){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),h&&this.addEventListener(t,this["_on"+t]=h)},enumerable:!0,configurable:!0})}function QG(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):(RN=i,i?"adapter.js logging disabled":"adapter.js logging enabled")}function ZG(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):(wN=!i,"adapter.js deprecation warnings "+(i?"disabled":"enabled"))}function IN(){if(typeof window=="object"){if(RN)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function vC(i,t){wN&&console.warn(i+" is deprecated, please use "+t+" instead.")}function AN(i){return Object.prototype.toString.call(i)==="[object Object]"}function ON(i){return AN(i)?Object.keys(i).reduce(function(t,n){const a=AN(i[n]),l=a?ON(i[n]):i[n],u=a&&!Object.keys(l).length;return l===void 0||u?t:Object.assign(t,{[n]:l})},{}):i}function EC(i,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach(a=>{a.endsWith("Id")?EC(i,i.get(t[a]),n):a.endsWith("Ids")&&t[a].forEach(l=>{EC(i,i.get(l),n)})}))}function xN(i,t,n){const a=n?"outbound-rtp":"inbound-rtp",l=new Map;if(t===null)return l;const u=[];return i.forEach(h=>{h.type==="track"&&h.trackIdentifier===t.id&&u.push(h)}),u.forEach(h=>{i.forEach(p=>{p.type===a&&p.trackId===h.id&&EC(i,p,l)})}),l}const NN=IN;function PN(i,t){const n=i&&i.navigator;if(!n.mediaDevices)return;const a=function(h){if(typeof h!="object"||h.mandatory||h.optional)return h;const p={};return Object.keys(h).forEach(v=>{if(v==="require"||v==="advanced"||v==="mediaSource")return;const E=typeof h[v]=="object"?h[v]:{ideal:h[v]};E.exact!==void 0&&typeof E.exact=="number"&&(E.min=E.max=E.exact);const y=function(C,I){return C?C+I.charAt(0).toUpperCase()+I.slice(1):I==="deviceId"?"sourceId":I};if(E.ideal!==void 0){p.optional=p.optional||[];let C={};typeof E.ideal=="number"?(C[y("min",v)]=E.ideal,p.optional.push(C),C={},C[y("max",v)]=E.ideal,p.optional.push(C)):(C[y("",v)]=E.ideal,p.optional.push(C))}E.exact!==void 0&&typeof E.exact!="number"?(p.mandatory=p.mandatory||{},p.mandatory[y("",v)]=E.exact):["min","max"].forEach(C=>{E[C]!==void 0&&(p.mandatory=p.mandatory||{},p.mandatory[y(C,v)]=E[C])})}),h.advanced&&(p.optional=(p.optional||[]).concat(h.advanced)),p},l=function(h,p){if(t.version>=61)return p(h);if((h=JSON.parse(JSON.stringify(h)))&&typeof h.audio=="object"){const v=function(E,y,C){y in E&&!(C in E)&&(E[C]=E[y],delete E[y])};v((h=JSON.parse(JSON.stringify(h))).audio,"autoGainControl","googAutoGainControl"),v(h.audio,"noiseSuppression","googNoiseSuppression"),h.audio=a(h.audio)}if(h&&typeof h.video=="object"){let v=h.video.facingMode;v=v&&(typeof v=="object"?v:{ideal:v});const E=t.version<66;if(v&&(v.exact==="user"||v.exact==="environment"||v.ideal==="user"||v.ideal==="environment")&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||E)){let y;if(delete h.video.facingMode,v.exact==="environment"||v.ideal==="environment"?y=["back","rear"]:v.exact!=="user"&&v.ideal!=="user"||(y=["front"]),y)return n.mediaDevices.enumerateDevices().then(C=>{let I=(C=C.filter(k=>k.kind==="videoinput")).find(k=>y.some(G=>k.label.toLowerCase().includes(G)));return!I&&C.length&&y.includes("back")&&(I=C[C.length-1]),I&&(h.video.deviceId=v.exact?{exact:I.deviceId}:{ideal:I.deviceId}),h.video=a(h.video),NN("chrome: "+JSON.stringify(h)),p(h)})}h.video=a(h.video)}return NN("chrome: "+JSON.stringify(h)),p(h)},u=function(h){return t.version>=64?h:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[h.name]||h.name,message:h.message,constraint:h.constraint||h.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=(function(h,p,v){l(h,E=>{n.webkitGetUserMedia(E,p,y=>{v&&v(u(y))})})}).bind(n),n.mediaDevices.getUserMedia){const h=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(p){return l(p,v=>h(v).then(E=>{if(v.audio&&!E.getAudioTracks().length||v.video&&!E.getVideoTracks().length)throw E.getTracks().forEach(y=>{y.stop()}),new DOMException("","NotFoundError");return E},E=>Promise.reject(u(E))))}}}function DN(i){i.MediaStream=i.MediaStream||i.webkitMediaStream}function kN(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("ontrack"in i.RTCPeerConnection.prototype)){Object.defineProperty(i.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const t=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=n=>{n.stream.addEventListener("addtrack",a=>{let l;l=i.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(h=>h.track&&h.track.id===a.track.id):{track:a.track};const u=new Event("track");u.track=a.track,u.receiver=l,u.transceiver={receiver:l},u.streams=[n.stream],this.dispatchEvent(u)}),n.stream.getTracks().forEach(a=>{let l;l=i.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(h=>h.track&&h.track.id===a.id):{track:a};const u=new Event("track");u.track=a,u.receiver=l,u.transceiver={receiver:l},u.streams=[n.stream],this.dispatchEvent(u)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else td(i,"track",t=>(t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t))}function LN(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("getSenders"in i.RTCPeerConnection.prototype)&&"createDTMFSender"in i.RTCPeerConnection.prototype){const t=function(l,u){return{track:u,get dtmf(){return this._dtmf===void 0&&(u.kind==="audio"?this._dtmf=l.createDTMFSender(u):this._dtmf=null),this._dtmf},_pc:l}};if(!i.RTCPeerConnection.prototype.getSenders){i.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const l=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(h,p){let v=l.apply(this,arguments);return v||(v=t(this,h),this._senders.push(v)),v};const u=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(h){u.apply(this,arguments);const p=this._senders.indexOf(h);p!==-1&&this._senders.splice(p,1)}}const n=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(l){this._senders=this._senders||[],n.apply(this,[l]),l.getTracks().forEach(u=>{this._senders.push(t(this,u))})};const a=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(l){this._senders=this._senders||[],a.apply(this,[l]),l.getTracks().forEach(u=>{const h=this._senders.find(p=>p.track===u);h&&this._senders.splice(this._senders.indexOf(h),1)})}}else if(typeof i=="object"&&i.RTCPeerConnection&&"getSenders"in i.RTCPeerConnection.prototype&&"createDTMFSender"in i.RTCPeerConnection.prototype&&i.RTCRtpSender&&!("dtmf"in i.RTCRtpSender.prototype)){const t=i.RTCPeerConnection.prototype.getSenders;i.RTCPeerConnection.prototype.getSenders=function(){const n=t.apply(this,[]);return n.forEach(a=>a._pc=this),n},Object.defineProperty(i.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function MN(i){if(!i.RTCPeerConnection)return;const t=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){const[n,a,l]=arguments;if(arguments.length>0&&typeof n=="function")return t.apply(this,arguments);if(t.length===0&&(arguments.length===0||typeof n!="function"))return t.apply(this,[]);const u=function(p){const v={};return p.result().forEach(E=>{const y={id:E.id,timestamp:E.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[E.type]||E.type};E.names().forEach(C=>{y[C]=E.stat(C)}),v[y.id]=y}),v},h=function(p){return new Map(Object.keys(p).map(v=>[v,p[v]]))};if(arguments.length>=2){const p=function(v){a(h(u(v)))};return t.apply(this,[p,n])}return new Promise((p,v)=>{t.apply(this,[function(E){p(h(u(E)))},v])}).then(a,l)}}function FN(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender&&i.RTCRtpReceiver))return;if(!("getStats"in i.RTCRtpSender.prototype)){const n=i.RTCPeerConnection.prototype.getSenders;n&&(i.RTCPeerConnection.prototype.getSenders=function(){const l=n.apply(this,[]);return l.forEach(u=>u._pc=this),l});const a=i.RTCPeerConnection.prototype.addTrack;a&&(i.RTCPeerConnection.prototype.addTrack=function(){const l=a.apply(this,arguments);return l._pc=this,l}),i.RTCRtpSender.prototype.getStats=function(){const l=this;return this._pc.getStats().then(u=>xN(u,l.track,!0))}}if(!("getStats"in i.RTCRtpReceiver.prototype)){const n=i.RTCPeerConnection.prototype.getReceivers;n&&(i.RTCPeerConnection.prototype.getReceivers=function(){const a=n.apply(this,[]);return a.forEach(l=>l._pc=this),a}),td(i,"track",a=>(a.receiver._pc=a.srcElement,a)),i.RTCRtpReceiver.prototype.getStats=function(){const a=this;return this._pc.getStats().then(l=>xN(l,a.track,!1))}}if(!("getStats"in i.RTCRtpSender.prototype)||!("getStats"in i.RTCRtpReceiver.prototype))return;const t=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof i.MediaStreamTrack){const n=arguments[0];let a,l,u;return this.getSenders().forEach(h=>{h.track===n&&(a?u=!0:a=h)}),this.getReceivers().forEach(h=>(h.track===n&&(l?u=!0:l=h),h.track===n)),u||a&&l?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):a?a.getStats():l?l.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function UN(i){i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(u=>this._shimmedLocalStreams[u][0])};const t=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(u,h){if(!h)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const p=t.apply(this,arguments);return this._shimmedLocalStreams[h.id]?this._shimmedLocalStreams[h.id].indexOf(p)===-1&&this._shimmedLocalStreams[h.id].push(p):this._shimmedLocalStreams[h.id]=[h,p],p};const n=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(u){this._shimmedLocalStreams=this._shimmedLocalStreams||{},u.getTracks().forEach(v=>{if(this.getSenders().find(E=>E.track===v))throw new DOMException("Track already exists.","InvalidAccessError")});const h=this.getSenders();n.apply(this,arguments);const p=this.getSenders().filter(v=>h.indexOf(v)===-1);this._shimmedLocalStreams[u.id]=[u].concat(p)};const a=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[u.id],a.apply(this,arguments)};const l=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},u&&Object.keys(this._shimmedLocalStreams).forEach(h=>{const p=this._shimmedLocalStreams[h].indexOf(u);p!==-1&&this._shimmedLocalStreams[h].splice(p,1),this._shimmedLocalStreams[h].length===1&&delete this._shimmedLocalStreams[h]}),l.apply(this,arguments)}}function BN(i,t){if(!i.RTCPeerConnection)return;if(i.RTCPeerConnection.prototype.addTrack&&t.version>=65)return UN(i);const n=i.RTCPeerConnection.prototype.getLocalStreams;i.RTCPeerConnection.prototype.getLocalStreams=function(){const v=n.apply(this);return this._reverseStreams=this._reverseStreams||{},v.map(E=>this._reverseStreams[E.id])};const a=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(v){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},v.getTracks().forEach(E=>{if(this.getSenders().find(y=>y.track===E))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[v.id]){const E=new i.MediaStream(v.getTracks());this._streams[v.id]=E,this._reverseStreams[E.id]=v,v=E}a.apply(this,[v])};const l=i.RTCPeerConnection.prototype.removeStream;function u(v,E){let y=E.sdp;return Object.keys(v._reverseStreams||[]).forEach(C=>{const I=v._reverseStreams[C],k=v._streams[I.id];y=y.replace(new RegExp(k.id,"g"),I.id)}),new RTCSessionDescription({type:E.type,sdp:y})}i.RTCPeerConnection.prototype.removeStream=function(v){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},l.apply(this,[this._streams[v.id]||v]),delete this._reverseStreams[this._streams[v.id]?this._streams[v.id].id:v.id],delete this._streams[v.id]},i.RTCPeerConnection.prototype.addTrack=function(v,E){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const y=[].slice.call(arguments,1);if(y.length!==1||!y[0].getTracks().find(I=>I===v))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(I=>I.track===v))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const C=this._streams[E.id];if(C)C.addTrack(v),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const I=new i.MediaStream([v]);this._streams[E.id]=I,this._reverseStreams[I.id]=E,this.addStream(I)}return this.getSenders().find(I=>I.track===v)},["createOffer","createAnswer"].forEach(function(v){const E=i.RTCPeerConnection.prototype[v],y={[v](){const C=arguments;return arguments.length&&typeof arguments[0]=="function"?E.apply(this,[I=>{const k=u(this,I);C[0].apply(null,[k])},I=>{C[1]&&C[1].apply(null,I)},arguments[2]]):E.apply(this,arguments).then(I=>u(this,I))}};i.RTCPeerConnection.prototype[v]=y[v]});const h=i.RTCPeerConnection.prototype.setLocalDescription;i.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(v,E){let y=E.sdp;return Object.keys(v._reverseStreams||[]).forEach(C=>{const I=v._reverseStreams[C],k=v._streams[I.id];y=y.replace(new RegExp(I.id,"g"),k.id)}),new RTCSessionDescription({type:E.type,sdp:y})}(this,arguments[0]),h.apply(this,arguments)):h.apply(this,arguments)};const p=Object.getOwnPropertyDescriptor(i.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(i.RTCPeerConnection.prototype,"localDescription",{get(){const v=p.get.apply(this);return v.type===""?v:u(this,v)}}),i.RTCPeerConnection.prototype.removeTrack=function(v){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!v._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(v._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let E;this._streams=this._streams||{},Object.keys(this._streams).forEach(y=>{this._streams[y].getTracks().find(C=>v.track===C)&&(E=this._streams[y])}),E&&(E.getTracks().length===1?this.removeStream(this._reverseStreams[E.id]):E.removeTrack(v.track),this.dispatchEvent(new Event("negotiationneeded")))}}function _C(i,t){!i.RTCPeerConnection&&i.webkitRTCPeerConnection&&(i.RTCPeerConnection=i.webkitRTCPeerConnection),i.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const a=i.RTCPeerConnection.prototype[n],l={[n](){return arguments[0]=new(n==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),a.apply(this,arguments)}};i.RTCPeerConnection.prototype[n]=l[n]})}function jN(i,t){td(i,"negotiationneeded",n=>{const a=n.target;if(!(t.version<72||a.getConfiguration&&a.getConfiguration().sdpSemantics==="plan-b")||a.signalingState==="stable")return n})}var VN=Object.freeze({__proto__:null,fixNegotiationNeeded:jN,shimAddTrackRemoveTrack:BN,shimAddTrackRemoveTrackWithNative:UN,shimGetDisplayMedia:function(i,t){i.navigator.mediaDevices&&"getDisplayMedia"in i.navigator.mediaDevices||i.navigator.mediaDevices&&(typeof t=="function"?i.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then(a=>{const l=n.video&&n.video.width,u=n.video&&n.video.height,h=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:a,maxFrameRate:h||3}},l&&(n.video.mandatory.maxWidth=l),u&&(n.video.mandatory.maxHeight=u),i.navigator.mediaDevices.getUserMedia(n)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:LN,shimGetStats:MN,shimGetUserMedia:PN,shimMediaStream:DN,shimOnTrack:kN,shimPeerConnection:_C,shimSenderReceiverGetStats:FN});function $N(i,t){const n=i&&i.navigator,a=i&&i.MediaStreamTrack;if(n.getUserMedia=function(l,u,h){vC("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(l).then(u,h)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const l=function(h,p,v){p in h&&!(v in h)&&(h[v]=h[p],delete h[p])},u=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(h){return typeof h=="object"&&typeof h.audio=="object"&&(h=JSON.parse(JSON.stringify(h)),l(h.audio,"autoGainControl","mozAutoGainControl"),l(h.audio,"noiseSuppression","mozNoiseSuppression")),u(h)},a&&a.prototype.getSettings){const h=a.prototype.getSettings;a.prototype.getSettings=function(){const p=h.apply(this,arguments);return l(p,"mozAutoGainControl","autoGainControl"),l(p,"mozNoiseSuppression","noiseSuppression"),p}}if(a&&a.prototype.applyConstraints){const h=a.prototype.applyConstraints;a.prototype.applyConstraints=function(p){return this.kind==="audio"&&typeof p=="object"&&(p=JSON.parse(JSON.stringify(p)),l(p,"autoGainControl","mozAutoGainControl"),l(p,"noiseSuppression","mozNoiseSuppression")),h.apply(this,[p])}}}}function HN(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function yC(i,t){if(typeof i!="object"||!i.RTCPeerConnection&&!i.mozRTCPeerConnection)return;!i.RTCPeerConnection&&i.mozRTCPeerConnection&&(i.RTCPeerConnection=i.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(l){const u=i.RTCPeerConnection.prototype[l],h={[l](){return arguments[0]=new(l==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),u.apply(this,arguments)}};i.RTCPeerConnection.prototype[l]=h[l]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},a=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){const[l,u,h]=arguments;return a.apply(this,[l||null]).then(p=>{if(t.version<53&&!u)try{p.forEach(v=>{v.type=n[v.type]||v.type})}catch(v){if(v.name!=="TypeError")throw v;p.forEach((E,y)=>{p.set(y,Object.assign({},E,{type:n[E.type]||E.type}))})}return p}).then(u,h)}}function WN(i){if(typeof i!="object"||!i.RTCPeerConnection||!i.RTCRtpSender||i.RTCRtpSender&&"getStats"in i.RTCRtpSender.prototype)return;const t=i.RTCPeerConnection.prototype.getSenders;t&&(i.RTCPeerConnection.prototype.getSenders=function(){const a=t.apply(this,[]);return a.forEach(l=>l._pc=this),a});const n=i.RTCPeerConnection.prototype.addTrack;n&&(i.RTCPeerConnection.prototype.addTrack=function(){const a=n.apply(this,arguments);return a._pc=this,a}),i.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function GN(i){if(typeof i!="object"||!i.RTCPeerConnection||!i.RTCRtpSender||i.RTCRtpSender&&"getStats"in i.RTCRtpReceiver.prototype)return;const t=i.RTCPeerConnection.prototype.getReceivers;t&&(i.RTCPeerConnection.prototype.getReceivers=function(){const n=t.apply(this,[]);return n.forEach(a=>a._pc=this),n}),td(i,"track",n=>(n.receiver._pc=n.srcElement,n)),i.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function zN(i){i.RTCPeerConnection&&!("removeStream"in i.RTCPeerConnection.prototype)&&(i.RTCPeerConnection.prototype.removeStream=function(t){vC("removeStream","removeTrack"),this.getSenders().forEach(n=>{n.track&&t.getTracks().includes(n.track)&&this.removeTrack(n)})})}function KN(i){i.DataChannel&&!i.RTCDataChannel&&(i.RTCDataChannel=i.DataChannel)}function YN(i){if(typeof i!="object"||!i.RTCPeerConnection)return;const t=i.RTCPeerConnection.prototype.addTransceiver;t&&(i.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let n=arguments[1]&&arguments[1].sendEncodings;n===void 0&&(n=[]),n=[...n];const a=n.length>0;a&&n.forEach(u=>{if("rid"in u&&!/^[a-z0-9]{0,16}$/i.test(u.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in u&&!(parseFloat(u.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in u&&!(parseFloat(u.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const l=t.apply(this,arguments);if(a){const{sender:u}=l,h=u.getParameters();(!("encodings"in h)||h.encodings.length===1&&Object.keys(h.encodings[0]).length===0)&&(h.encodings=n,u.sendEncodings=n,this.setParametersPromises.push(u.setParameters(h).then(()=>{delete u.sendEncodings}).catch(()=>{delete u.sendEncodings})))}return l})}function qN(i){if(typeof i!="object"||!i.RTCRtpSender)return;const t=i.RTCRtpSender.prototype.getParameters;t&&(i.RTCRtpSender.prototype.getParameters=function(){const n=t.apply(this,arguments);return"encodings"in n||(n.encodings=[].concat(this.sendEncodings||[{}])),n})}function XN(i){if(typeof i!="object"||!i.RTCPeerConnection)return;const t=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function JN(i){if(typeof i!="object"||!i.RTCPeerConnection)return;const t=i.RTCPeerConnection.prototype.createAnswer;i.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var QN=Object.freeze({__proto__:null,shimAddTransceiver:YN,shimCreateAnswer:JN,shimCreateOffer:XN,shimGetDisplayMedia:function(i,t){i.navigator.mediaDevices&&"getDisplayMedia"in i.navigator.mediaDevices||i.navigator.mediaDevices&&(i.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const a=new DOMException("getDisplayMedia without video constraints is undefined");return a.name="NotFoundError",a.code=8,Promise.reject(a)}return n.video===!0?n.video={mediaSource:t}:n.video.mediaSource=t,i.navigator.mediaDevices.getUserMedia(n)})},shimGetParameters:qN,shimGetUserMedia:$N,shimOnTrack:HN,shimPeerConnection:yC,shimRTCDataChannel:KN,shimReceiverGetStats:GN,shimRemoveStream:zN,shimSenderGetStats:WN});function ZN(i){if(typeof i=="object"&&i.RTCPeerConnection){if("getLocalStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in i.RTCPeerConnection.prototype)){const t=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addStream=function(n){this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach(a=>t.call(this,a,n)),n.getVideoTracks().forEach(a=>t.call(this,a,n))},i.RTCPeerConnection.prototype.addTrack=function(n,...a){return a&&a.forEach(l=>{this._localStreams?this._localStreams.includes(l)||this._localStreams.push(l):this._localStreams=[l]}),t.apply(this,arguments)}}"removeStream"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const n=this._localStreams.indexOf(t);if(n===-1)return;this._localStreams.splice(n,1);const a=t.getTracks();this.getSenders().forEach(l=>{a.includes(l.track)&&this.removeTrack(l)})})}}function eP(i){if(typeof i=="object"&&i.RTCPeerConnection&&("getRemoteStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in i.RTCPeerConnection.prototype))){Object.defineProperty(i.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=a=>{a.streams.forEach(l=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(l))return;this._remoteStreams.push(l);const u=new Event("addstream");u.stream=l,this.dispatchEvent(u)})})}});const t=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){const n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(l=>{if(n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.indexOf(l)>=0)return;n._remoteStreams.push(l);const u=new Event("addstream");u.stream=l,n.dispatchEvent(u)})}),t.apply(n,arguments)}}}function tP(i){if(typeof i!="object"||!i.RTCPeerConnection)return;const t=i.RTCPeerConnection.prototype,n=t.createOffer,a=t.createAnswer,l=t.setLocalDescription,u=t.setRemoteDescription,h=t.addIceCandidate;t.createOffer=function(v,E){const y=arguments.length>=2?arguments[2]:arguments[0],C=n.apply(this,[y]);return E?(C.then(v,E),Promise.resolve()):C},t.createAnswer=function(v,E){const y=arguments.length>=2?arguments[2]:arguments[0],C=a.apply(this,[y]);return E?(C.then(v,E),Promise.resolve()):C};let p=function(v,E,y){const C=l.apply(this,[v]);return y?(C.then(E,y),Promise.resolve()):C};t.setLocalDescription=p,p=function(v,E,y){const C=u.apply(this,[v]);return y?(C.then(E,y),Promise.resolve()):C},t.setRemoteDescription=p,p=function(v,E,y){const C=h.apply(this,[v]);return y?(C.then(E,y),Promise.resolve()):C},t.addIceCandidate=p}function nP(i){const t=i&&i.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const n=t.mediaDevices,a=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=l=>a(rP(l))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=(function(n,a,l){t.mediaDevices.getUserMedia(n).then(a,l)}).bind(t))}function rP(i){return i&&i.video!==void 0?Object.assign({},i,{video:ON(i.video)}):i}function iP(i){if(!i.RTCPeerConnection)return;const t=i.RTCPeerConnection;i.RTCPeerConnection=function(n,a){if(n&&n.iceServers){const l=[];for(let u=0;u<n.iceServers.length;u++){let h=n.iceServers[u];!h.hasOwnProperty("urls")&&h.hasOwnProperty("url")?(vC("RTCIceServer.url","RTCIceServer.urls"),h=JSON.parse(JSON.stringify(h)),h.urls=h.url,delete h.url,l.push(h)):l.push(n.iceServers[u])}n.iceServers=l}return new t(n,a)},i.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(i.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function oP(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function aP(i){const t=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(n){if(n){n.offerToReceiveAudio!==void 0&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);const a=this.getTransceivers().find(u=>u.receiver.track.kind==="audio");n.offerToReceiveAudio===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):n.offerToReceiveAudio!==!0||a||this.addTransceiver("audio",{direction:"recvonly"}),n.offerToReceiveVideo!==void 0&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);const l=this.getTransceivers().find(u=>u.receiver.track.kind==="video");n.offerToReceiveVideo===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):n.offerToReceiveVideo!==!0||l||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function sP(i){typeof i!="object"||i.AudioContext||(i.AudioContext=i.webkitAudioContext)}var cP=Object.freeze({__proto__:null,shimAudioContext:sP,shimCallbacksAPI:tP,shimConstraints:rP,shimCreateOfferLegacy:aP,shimGetUserMedia:nP,shimLocalStreamsAPI:ZN,shimRTCIceServerUrls:iP,shimRemoteStreamsAPI:eP,shimTrackEventTransceiver:oP}),lP={exports:{}};(function(i){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(n){return n.trim().split(`
`).map(a=>a.trim())},t.splitSections=function(n){return n.split(`
m=`).map((a,l)=>(l>0?"m="+a:a).trim()+`\r
`)},t.getDescription=function(n){const a=t.splitSections(n);return a&&a[0]},t.getMediaSections=function(n){const a=t.splitSections(n);return a.shift(),a},t.matchPrefix=function(n,a){return t.splitLines(n).filter(l=>l.indexOf(a)===0)},t.parseCandidate=function(n){let a;a=n.indexOf("a=candidate:")===0?n.substring(12).split(" "):n.substring(10).split(" ");const l={foundation:a[0],component:{1:"rtp",2:"rtcp"}[a[1]]||a[1],protocol:a[2].toLowerCase(),priority:parseInt(a[3],10),ip:a[4],address:a[4],port:parseInt(a[5],10),type:a[7]};for(let u=8;u<a.length;u+=2)switch(a[u]){case"raddr":l.relatedAddress=a[u+1];break;case"rport":l.relatedPort=parseInt(a[u+1],10);break;case"tcptype":l.tcpType=a[u+1];break;case"ufrag":l.ufrag=a[u+1],l.usernameFragment=a[u+1];break;default:l[a[u]]===void 0&&(l[a[u]]=a[u+1])}return l},t.writeCandidate=function(n){const a=[];a.push(n.foundation);const l=n.component;l==="rtp"?a.push(1):l==="rtcp"?a.push(2):a.push(l),a.push(n.protocol.toUpperCase()),a.push(n.priority),a.push(n.address||n.ip),a.push(n.port);const u=n.type;return a.push("typ"),a.push(u),u!=="host"&&n.relatedAddress&&n.relatedPort&&(a.push("raddr"),a.push(n.relatedAddress),a.push("rport"),a.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(a.push("tcptype"),a.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(a.push("ufrag"),a.push(n.usernameFragment||n.ufrag)),"candidate:"+a.join(" ")},t.parseIceOptions=function(n){return n.substring(14).split(" ")},t.parseRtpMap=function(n){let a=n.substring(9).split(" ");const l={payloadType:parseInt(a.shift(),10)};return a=a[0].split("/"),l.name=a[0],l.clockRate=parseInt(a[1],10),l.channels=a.length===3?parseInt(a[2],10):1,l.numChannels=l.channels,l},t.writeRtpMap=function(n){let a=n.payloadType;n.preferredPayloadType!==void 0&&(a=n.preferredPayloadType);const l=n.channels||n.numChannels||1;return"a=rtpmap:"+a+" "+n.name+"/"+n.clockRate+(l!==1?"/"+l:"")+`\r
`},t.parseExtmap=function(n){const a=n.substring(9).split(" ");return{id:parseInt(a[0],10),direction:a[0].indexOf("/")>0?a[0].split("/")[1]:"sendrecv",uri:a[1],attributes:a.slice(2).join(" ")}},t.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},t.parseFmtp=function(n){const a={};let l;const u=n.substring(n.indexOf(" ")+1).split(";");for(let h=0;h<u.length;h++)l=u[h].trim().split("="),a[l[0].trim()]=l[1];return a},t.writeFmtp=function(n){let a="",l=n.payloadType;if(n.preferredPayloadType!==void 0&&(l=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const u=[];Object.keys(n.parameters).forEach(h=>{n.parameters[h]!==void 0?u.push(h+"="+n.parameters[h]):u.push(h)}),a+="a=fmtp:"+l+" "+u.join(";")+`\r
`}return a},t.parseRtcpFb=function(n){const a=n.substring(n.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}},t.writeRtcpFb=function(n){let a="",l=n.payloadType;return n.preferredPayloadType!==void 0&&(l=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(u=>{a+="a=rtcp-fb:"+l+" "+u.type+(u.parameter&&u.parameter.length?" "+u.parameter:"")+`\r
`}),a},t.parseSsrcMedia=function(n){const a=n.indexOf(" "),l={ssrc:parseInt(n.substring(7,a),10)},u=n.indexOf(":",a);return u>-1?(l.attribute=n.substring(a+1,u),l.value=n.substring(u+1)):l.attribute=n.substring(a+1),l},t.parseSsrcGroup=function(n){const a=n.substring(13).split(" ");return{semantics:a.shift(),ssrcs:a.map(l=>parseInt(l,10))}},t.getMid=function(n){const a=t.matchPrefix(n,"a=mid:")[0];if(a)return a.substring(6)},t.parseFingerprint=function(n){const a=n.substring(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1].toUpperCase()}},t.getDtlsParameters=function(n,a){return{role:"auto",fingerprints:t.matchPrefix(n+a,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(n,a){let l="a=setup:"+a+`\r
`;return n.fingerprints.forEach(u=>{l+="a=fingerprint:"+u.algorithm+" "+u.value+`\r
`}),l},t.parseCryptoLine=function(n){const a=n.substring(9).split(" ");return{tag:parseInt(a[0],10),cryptoSuite:a[1],keyParams:a[2],sessionParams:a.slice(3)}},t.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?t.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},t.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const a=n.substring(7).split("|");return{keyMethod:"inline",keySalt:a[0],lifeTime:a[1],mkiValue:a[2]?a[2].split(":")[0]:void 0,mkiLength:a[2]?a[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},t.getCryptoParameters=function(n,a){return t.matchPrefix(n+a,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(n,a){const l=t.matchPrefix(n+a,"a=ice-ufrag:")[0],u=t.matchPrefix(n+a,"a=ice-pwd:")[0];return l&&u?{usernameFragment:l.substring(12),password:u.substring(10)}:null},t.writeIceParameters=function(n){let a="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(a+=`a=ice-lite\r
`),a},t.parseRtpParameters=function(n){const a={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},l=t.splitLines(n)[0].split(" ");a.profile=l[2];for(let h=3;h<l.length;h++){const p=l[h],v=t.matchPrefix(n,"a=rtpmap:"+p+" ")[0];if(v){const E=t.parseRtpMap(v),y=t.matchPrefix(n,"a=fmtp:"+p+" ");switch(E.parameters=y.length?t.parseFmtp(y[0]):{},E.rtcpFeedback=t.matchPrefix(n,"a=rtcp-fb:"+p+" ").map(t.parseRtcpFb),a.codecs.push(E),E.name.toUpperCase()){case"RED":case"ULPFEC":a.fecMechanisms.push(E.name.toUpperCase())}}}t.matchPrefix(n,"a=extmap:").forEach(h=>{a.headerExtensions.push(t.parseExtmap(h))});const u=t.matchPrefix(n,"a=rtcp-fb:* ").map(t.parseRtcpFb);return a.codecs.forEach(h=>{u.forEach(p=>{h.rtcpFeedback.find(v=>v.type===p.type&&v.parameter===p.parameter)||h.rtcpFeedback.push(p)})}),a},t.writeRtpDescription=function(n,a){let l="";l+="m="+n+" ",l+=a.codecs.length>0?"9":"0",l+=" "+(a.profile||"UDP/TLS/RTP/SAVPF")+" ",l+=a.codecs.map(h=>h.preferredPayloadType!==void 0?h.preferredPayloadType:h.payloadType).join(" ")+`\r
`,l+=`c=IN IP4 0.0.0.0\r
`,l+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,a.codecs.forEach(h=>{l+=t.writeRtpMap(h),l+=t.writeFmtp(h),l+=t.writeRtcpFb(h)});let u=0;return a.codecs.forEach(h=>{h.maxptime>u&&(u=h.maxptime)}),u>0&&(l+="a=maxptime:"+u+`\r
`),a.headerExtensions&&a.headerExtensions.forEach(h=>{l+=t.writeExtmap(h)}),l},t.parseRtpEncodingParameters=function(n){const a=[],l=t.parseRtpParameters(n),u=l.fecMechanisms.indexOf("RED")!==-1,h=l.fecMechanisms.indexOf("ULPFEC")!==-1,p=t.matchPrefix(n,"a=ssrc:").map(I=>t.parseSsrcMedia(I)).filter(I=>I.attribute==="cname"),v=p.length>0&&p[0].ssrc;let E;const y=t.matchPrefix(n,"a=ssrc-group:FID").map(I=>I.substring(17).split(" ").map(k=>parseInt(k,10)));y.length>0&&y[0].length>1&&y[0][0]===v&&(E=y[0][1]),l.codecs.forEach(I=>{if(I.name.toUpperCase()==="RTX"&&I.parameters.apt){let k={ssrc:v,codecPayloadType:parseInt(I.parameters.apt,10)};v&&E&&(k.rtx={ssrc:E}),a.push(k),u&&(k=JSON.parse(JSON.stringify(k)),k.fec={ssrc:v,mechanism:h?"red+ulpfec":"red"},a.push(k))}}),a.length===0&&v&&a.push({ssrc:v});let C=t.matchPrefix(n,"b=");return C.length&&(C=C[0].indexOf("b=TIAS:")===0?parseInt(C[0].substring(7),10):C[0].indexOf("b=AS:")===0?1e3*parseInt(C[0].substring(5),10)*.95-16e3:void 0,a.forEach(I=>{I.maxBitrate=C})),a},t.parseRtcpParameters=function(n){const a={},l=t.matchPrefix(n,"a=ssrc:").map(p=>t.parseSsrcMedia(p)).filter(p=>p.attribute==="cname")[0];l&&(a.cname=l.value,a.ssrc=l.ssrc);const u=t.matchPrefix(n,"a=rtcp-rsize");a.reducedSize=u.length>0,a.compound=u.length===0;const h=t.matchPrefix(n,"a=rtcp-mux");return a.mux=h.length>0,a},t.writeRtcpParameters=function(n){let a="";return n.reducedSize&&(a+=`a=rtcp-rsize\r
`),n.mux&&(a+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(a+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),a},t.parseMsid=function(n){let a;const l=t.matchPrefix(n,"a=msid:");if(l.length===1)return a=l[0].substring(7).split(" "),{stream:a[0],track:a[1]};const u=t.matchPrefix(n,"a=ssrc:").map(h=>t.parseSsrcMedia(h)).filter(h=>h.attribute==="msid");return u.length>0?(a=u[0].value.split(" "),{stream:a[0],track:a[1]}):void 0},t.parseSctpDescription=function(n){const a=t.parseMLine(n),l=t.matchPrefix(n,"a=max-message-size:");let u;l.length>0&&(u=parseInt(l[0].substring(19),10)),isNaN(u)&&(u=65536);const h=t.matchPrefix(n,"a=sctp-port:");if(h.length>0)return{port:parseInt(h[0].substring(12),10),protocol:a.fmt,maxMessageSize:u};const p=t.matchPrefix(n,"a=sctpmap:");if(p.length>0){const v=p[0].substring(10).split(" ");return{port:parseInt(v[0],10),protocol:v[1],maxMessageSize:u}}},t.writeSctpDescription=function(n,a){let l=[];return l=n.protocol!=="DTLS/SCTP"?["m="+n.kind+" 9 "+n.protocol+" "+a.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+a.port+`\r
`]:["m="+n.kind+" 9 "+n.protocol+" "+a.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+a.port+" "+a.protocol+` 65535\r
`],a.maxMessageSize!==void 0&&l.push("a=max-message-size:"+a.maxMessageSize+`\r
`),l.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(n,a,l){let u;const h=a!==void 0?a:2;return u=n||t.generateSessionId(),`v=0\r
o=`+(l||"thisisadapterortc")+" "+u+" "+h+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},t.getDirection=function(n,a){const l=t.splitLines(n);for(let u=0;u<l.length;u++)switch(l[u]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return l[u].substring(2)}return a?t.getDirection(a):"sendrecv"},t.getKind=function(n){return t.splitLines(n)[0].split(" ")[0].substring(2)},t.isRejected=function(n){return n.split(" ",2)[1]==="0"},t.parseMLine=function(n){const a=t.splitLines(n)[0].substring(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}},t.parseOLine=function(n){const a=t.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}},t.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const a=t.splitLines(n);for(let l=0;l<a.length;l++)if(a[l].length<2||a[l].charAt(1)!=="=")return!1;return!0},i.exports=t})(lP);var uP=lP.exports,Eh=c(uP),ez=o({__proto__:null,default:Eh},[uP]);function Ng(i){if(!i.RTCIceCandidate||i.RTCIceCandidate&&"foundation"in i.RTCIceCandidate.prototype)return;const t=i.RTCIceCandidate;i.RTCIceCandidate=function(n){if(typeof n=="object"&&n.candidate&&n.candidate.indexOf("a=")===0&&((n=JSON.parse(JSON.stringify(n))).candidate=n.candidate.substr(2)),n.candidate&&n.candidate.length){const a=new t(n),l=Eh.parseCandidate(n.candidate),u=Object.assign(a,l);return u.toJSON=function(){return{candidate:u.candidate,sdpMid:u.sdpMid,sdpMLineIndex:u.sdpMLineIndex,usernameFragment:u.usernameFragment}},u}return new t(n)},i.RTCIceCandidate.prototype=t.prototype,td(i,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new i.RTCIceCandidate(n.candidate),writable:"false"}),n))}function SC(i){!i.RTCIceCandidate||i.RTCIceCandidate&&"relayProtocol"in i.RTCIceCandidate.prototype||td(i,"icecandidate",t=>{if(t.candidate){const n=Eh.parseCandidate(t.candidate.candidate);n.type==="relay"&&(t.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return t})}function Pg(i,t){if(!i.RTCPeerConnection)return;"sctp"in i.RTCPeerConnection.prototype||Object.defineProperty(i.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const n=function(p){if(!p||!p.sdp)return!1;const v=Eh.splitSections(p.sdp);return v.shift(),v.some(E=>{const y=Eh.parseMLine(E);return y&&y.kind==="application"&&y.protocol.indexOf("SCTP")!==-1})},a=function(p){const v=p.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(v===null||v.length<2)return-1;const E=parseInt(v[1],10);return E!=E?-1:E},l=function(p){let v=65536;return t.browser==="firefox"&&(v=t.version<57?p===-1?16384:2147483637:t.version<60?t.version===57?65535:65536:2147483637),v},u=function(p,v){let E=65536;t.browser==="firefox"&&t.version===57&&(E=65535);const y=Eh.matchPrefix(p.sdp,"a=max-message-size:");return y.length>0?E=parseInt(y[0].substr(19),10):t.browser==="firefox"&&v!==-1&&(E=2147483637),E},h=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,t.browser==="chrome"&&t.version>=76){const{sdpSemantics:p}=this.getConfiguration();p==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const p=a(arguments[0]),v=l(p),E=u(arguments[0],p);let y;y=v===0&&E===0?Number.POSITIVE_INFINITY:v===0||E===0?Math.max(v,E):Math.min(v,E);const C={};Object.defineProperty(C,"maxMessageSize",{get:()=>y}),this._sctp=C}return h.apply(this,arguments)}}function Dg(i){if(!i.RTCPeerConnection||!("createDataChannel"in i.RTCPeerConnection.prototype))return;function t(a,l){const u=a.send;a.send=function(){const h=arguments[0],p=h.length||h.size||h.byteLength;if(a.readyState==="open"&&l.sctp&&p>l.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+l.sctp.maxMessageSize+" bytes)");return u.apply(a,arguments)}}const n=i.RTCPeerConnection.prototype.createDataChannel;i.RTCPeerConnection.prototype.createDataChannel=function(){const a=n.apply(this,arguments);return t(a,this),a},td(i,"datachannel",a=>(t(a.channel,a.target),a))}function CC(i){if(!i.RTCPeerConnection||"connectionState"in i.RTCPeerConnection.prototype)return;const t=i.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const a=t[n];t[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=l=>{const u=l.target;if(u._lastConnectionState!==u.connectionState){u._lastConnectionState=u.connectionState;const h=new Event("connectionstatechange",l);u.dispatchEvent(h)}return l},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),a.apply(this,arguments)}})}function bC(i,t){if(!i.RTCPeerConnection||t.browser==="chrome"&&t.version>=71||t.browser==="safari"&&t.version>=605)return;const n=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(a){if(a&&a.sdp&&a.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const l=a.sdp.split(`
`).filter(u=>u.trim()!=="a=extmap-allow-mixed").join(`
`);i.RTCSessionDescription&&a instanceof i.RTCSessionDescription?arguments[0]=new i.RTCSessionDescription({type:a.type,sdp:l}):a.sdp=l}return n.apply(this,arguments)}}function kg(i,t){if(!i.RTCPeerConnection||!i.RTCPeerConnection.prototype)return;const n=i.RTCPeerConnection.prototype.addIceCandidate;n&&n.length!==0&&(i.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(t.browser==="chrome"&&t.version<78||t.browser==="firefox"&&t.version<68||t.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Lg(i,t){if(!i.RTCPeerConnection||!i.RTCPeerConnection.prototype)return;const n=i.RTCPeerConnection.prototype.setLocalDescription;n&&n.length!==0&&(i.RTCPeerConnection.prototype.setLocalDescription=function(){let a=arguments[0]||{};if(typeof a!="object"||a.type&&a.sdp)return n.apply(this,arguments);if(a={type:a.type,sdp:a.sdp},!a.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":a.type="offer";break;default:a.type="answer"}return a.sdp||a.type!=="offer"&&a.type!=="answer"?n.apply(this,[a]):(a.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(l=>n.apply(this,[l]))})}var tz=Object.freeze({__proto__:null,removeExtmapAllowMixed:bC,shimAddIceCandidateNullOrEmpty:kg,shimConnectionState:CC,shimMaxMessageSize:Pg,shimParameterlessSetLocalDescription:Lg,shimRTCIceCandidate:Ng,shimRTCIceCandidateRelayProtocol:SC,shimSendThrowTypeError:Dg});(function({window:i}={},t={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const n=IN,a=function(u){const h={browser:null,version:null};if(u===void 0||!u.navigator)return h.browser="Not a browser.",h;const{navigator:p}=u;if(p.mozGetUserMedia)h.browser="firefox",h.version=xg(p.userAgent,/Firefox\/(\d+)\./,1);else if(p.webkitGetUserMedia||u.isSecureContext===!1&&u.webkitRTCPeerConnection)h.browser="chrome",h.version=xg(p.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!u.RTCPeerConnection||!p.userAgent.match(/AppleWebKit\/(\d+)\./))return h.browser="Not a supported browser.",h;h.browser="safari",h.version=xg(p.userAgent,/AppleWebKit\/(\d+)\./,1),h.supportsUnifiedPlan=u.RTCRtpTransceiver&&"currentDirection"in u.RTCRtpTransceiver.prototype}return h}(i),l={browserDetails:a,commonShim:tz,extractVersion:xg,disableLog:QG,disableWarnings:ZG,sdp:ez};switch(a.browser){case"chrome":if(!VN||!_C||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),l;if(a.version===null)return n("Chrome shim can not determine version, not shimming."),l;n("adapter.js shimming chrome."),l.browserShim=VN,kg(i,a),Lg(i),PN(i,a),DN(i),_C(i,a),kN(i),BN(i,a),LN(i),MN(i),FN(i),jN(i,a),Ng(i),SC(i),CC(i),Pg(i,a),Dg(i),bC(i,a);break;case"firefox":if(!QN||!yC||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),l;n("adapter.js shimming firefox."),l.browserShim=QN,kg(i,a),Lg(i),$N(i,a),yC(i,a),HN(i),zN(i),WN(i),GN(i),KN(i),YN(i),qN(i),XN(i),JN(i),Ng(i),CC(i),Pg(i,a),Dg(i);break;case"safari":if(!cP||!t.shimSafari)return n("Safari shim is not included in this adapter release."),l;n("adapter.js shimming safari."),l.browserShim=cP,kg(i,a),Lg(i),iP(i),aP(i),tP(i),ZN(i),eP(i),oP(i),nP(i),sP(i),Ng(i),SC(i),Pg(i,a),Dg(i),bC(i,a);break;default:n("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var dP={exports:{}},nz=jn,rz=ce,hP=Za.f;nz({target:"Object",stat:!0,forced:Object.defineProperty!==hP,sham:!rz},{defineProperty:hP});var pP=lt.Object,iz=dP.exports=function(i,t,n){return pP.defineProperty(i,t,n)};pP.defineProperty.sham&&(iz.sham=!0);var oz=c(dP.exports),az=W,TC=Array.isArray||function(i){return az(i)=="Array"},sz=TypeError,cz=Ml,lz=Za,uz=Le,fP=function(i,t,n){var a=cz(t);a in i?lz.f(i,a,uz(0,n)):i[a]=n},dz=le,RC=lc,hz=T(Function.toString);dz(RC.inspectSource)||(RC.inspectSource=function(i){return hz(i)});var mP=RC.inspectSource,pz=T,fz=d,gP=le,mz=ed,gz=mP,vP=function(){},vz=[],EP=vn("Reflect","construct"),wC=/^\s*(?:class|function)\b/,Ez=pz(wC.exec),_z=!wC.exec(vP),Uf=function(i){if(!gP(i))return!1;try{return EP(vP,vz,i),!0}catch{return!1}},_P=function(i){if(!gP(i))return!1;switch(mz(i)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return _z||!!Ez(wC,gz(i))}catch{return!0}};_P.sham=!0;var yP=!EP||fz(function(){var i;return Uf(Uf.call)||!Uf(Object)||!Uf(function(){i=!0})||i})?_P:Uf,SP=TC,yz=yP,Sz=et,Cz=Pt("species"),CP=Array,bz=function(i){var t;return SP(i)&&(t=i.constructor,(yz(t)&&(t===CP||SP(t.prototype))||Sz(t)&&(t=t[Cz])===null)&&(t=void 0)),t===void 0?CP:t},bP=function(i,t){return new(bz(i))(t===0?0:t)},Tz=d,Rz=on,wz=Pt("species"),Iz=jn,Az=d,Oz=TC,xz=et,Nz=xi,Pz=Zu,TP=function(i){if(i>9007199254740991)throw sz("Maximum allowed index exceeded");return i},RP=fP,Dz=bP,kz=function(i){return Rz>=51||!Tz(function(){var t=[];return(t.constructor={})[wz]=function(){return{foo:1}},t[i](Boolean).foo!==1})},Lz=on,wP=Pt("isConcatSpreadable"),Mz=Lz>=51||!Az(function(){var i=[];return i[wP]=!1,i.concat()[0]!==i}),Fz=function(i){if(!xz(i))return!1;var t=i[wP];return t!==void 0?!!t:Oz(i)};Iz({target:"Array",proto:!0,arity:1,forced:!Mz||!kz("concat")},{concat:function(i){var t,n,a,l,u,h=Nz(this),p=Dz(h,0),v=0;for(t=-1,a=arguments.length;t<a;t++)if(Fz(u=t===-1?h:arguments[t]))for(l=Pz(u),TP(v+l),n=0;n<l;n++,v++)n in u&&RP(p,v,u[n]);else TP(v+1),RP(p,v++,u);return p.length=v,p}});var IC={},Mg={},AC=Gr,Uz=He,Bz=pC.indexOf,jz=Mg,IP=T([].push),AP=function(i,t){var n,a=Uz(i),l=0,u=[];for(n in a)!AC(jz,n)&&AC(a,n)&&IP(u,n);for(;t.length>l;)AC(a,n=t[l++])&&(~Bz(u,n)||IP(u,n));return u},OC=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Vz=AP,$z=OC,xC=Object.keys||function(i){return Vz(i,$z)},Hz=ce,Wz=vN,Gz=Za,zz=Ns,Kz=He,Yz=xC;IC.f=Hz&&!Wz?Object.defineProperties:function(i,t){zz(i);for(var n,a=Kz(t),l=Yz(t),u=l.length,h=0;u>h;)Gz.f(i,n=l[h++],a[n]);return i};var Fg,OP=vn("document","documentElement"),qz=ya,xP=uo("keys"),Ug=function(i){return xP[i]||(xP[i]=qz(i))},Xz=Ns,Jz=IC,NP=OC,Qz=Mg,Zz=OP,eK=Hc,NC="prototype",PC="script",PP=Ug("IE_PROTO"),DC=function(){},DP=function(i){return"<"+PC+">"+i+"</"+PC+">"},kP=function(i){i.write(DP("")),i.close();var t=i.parentWindow.Object;return i=null,t},Bg=function(){try{Fg=new ActiveXObject("htmlfile")}catch{}var i,t,n;Bg=typeof document<"u"?document.domain&&Fg?kP(Fg):(t=eK("iframe"),n="java"+PC+":",t.style.display="none",Zz.appendChild(t),t.src=String(n),(i=t.contentWindow.document).open(),i.write(DP("document.F=Object")),i.close(),i.F):kP(Fg);for(var a=NP.length;a--;)delete Bg[NC][NP[a]];return Bg()};Qz[PP]=!0;var jg=Object.create||function(i,t){var n;return i!==null?(DC[NC]=Xz(i),n=new DC,DC[NC]=null,n[PP]=i):n=Bg(),t===void 0?n:Jz.f(n,t)},Vg={},tK=AP,nK=OC.concat("length","prototype");Vg.f=Object.getOwnPropertyNames||function(i){return tK(i,nK)};var LP={},MP=yN,rK=Zu,iK=fP,oK=Array,aK=Math.max,FP=function(i,t,n){for(var a=rK(i),l=MP(t,a),u=MP(n===void 0?a:n,a),h=oK(aK(u-l,0)),p=0;l<u;l++,p++)iK(h,p,i[l]);return h.length=p,h},sK=W,cK=He,UP=Vg.f,lK=FP,BP=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];LP.f=function(i){return BP&&sK(i)=="Window"?function(t){try{return UP(t)}catch{return lK(BP)}}(i):UP(cK(i))};var $g={};$g.f=Object.getOwnPropertySymbols;var uK=Ul,Bf=function(i,t,n,a){return a&&a.enumerable?i[t]=n:uK(i,t,n),i},dK=Za,jP=function(i,t,n){return dK.f(i,t,n)},_h={},hK=Pt;_h.f=hK;var Hg,jf,Wg,VP=lt,pK=Gr,fK=_h,mK=Za.f,Zr=function(i){var t=VP.Symbol||(VP.Symbol={});pK(t,i)||mK(t,i,{value:fK.f(i)})},gK=ge,vK=vn,EK=Pt,_K=Bf,$P=function(){var i=vK("Symbol"),t=i&&i.prototype,n=t&&t.valueOf,a=EK("toPrimitive");t&&!t[a]&&_K(t,a,function(l){return gK(n,this)},{arity:1})},yK=ed,SK=fC?{}.toString:function(){return"[object "+yK(this)+"]"},CK=fC,bK=Za.f,TK=Ul,RK=Gr,wK=SK,HP=Pt("toStringTag"),yh=function(i,t,n,a){if(i){var l=n?i:i.prototype;RK(l,HP)||bK(l,HP,{configurable:!0,value:t}),a&&!CK&&TK(l,"toString",wK)}},IK=le,WP=A.WeakMap,AK=IK(WP)&&/native code/.test(String(WP)),GP=A,OK=et,xK=Ul,kC=Gr,LC=lc,NK=Ug,PK=Mg,zP="Object already initialized",MC=GP.TypeError,DK=GP.WeakMap;if(AK||LC.state){var fc=LC.state||(LC.state=new DK);fc.get=fc.get,fc.has=fc.has,fc.set=fc.set,Hg=function(i,t){if(fc.has(i))throw MC(zP);return t.facade=i,fc.set(i,t),t},jf=function(i){return fc.get(i)||{}},Wg=function(i){return fc.has(i)}}else{var Sh=NK("state");PK[Sh]=!0,Hg=function(i,t){if(kC(i,Sh))throw MC(zP);return t.facade=i,xK(i,Sh,t),t},jf=function(i){return kC(i,Sh)?i[Sh]:{}},Wg=function(i){return kC(i,Sh)}}var Gg={set:Hg,get:jf,has:Wg,enforce:function(i){return Wg(i)?jf(i):Hg(i,{})},getterFor:function(i){return function(t){var n;if(!OK(t)||(n=jf(t)).type!==i)throw MC("Incompatible receiver, "+i+" required");return n}}},kK=Ff,LK=Ct,MK=xi,FK=Zu,UK=bP,KP=T([].push),jl=function(i){var t=i==1,n=i==2,a=i==3,l=i==4,u=i==6,h=i==7,p=i==5||u;return function(v,E,y,C){for(var I,k,G=MK(v),B=LK(G),j=kK(E,y),q=FK(B),Z=0,re=C||UK,Ce=t?re(v,q):n||h?re(v,0):void 0;q>Z;Z++)if((p||Z in B)&&(k=j(I=B[Z],Z,G),i))if(t)Ce[Z]=k;else if(k)switch(i){case 3:return!0;case 5:return I;case 6:return Z;case 2:KP(Ce,I)}else switch(i){case 4:return!1;case 7:KP(Ce,I)}return u?-1:a||l?l:Ce}},BK={forEach:jl(0),map:jl(1),filter:jl(2),some:jl(3),every:jl(4),find:jl(5),findIndex:jl(6),filterReject:jl(7)},zg=jn,FC=A,UC=ge,jK=T,Ch=ce,bh=Zn,VK=d,ji=Gr,$K=R,BC=Ns,Kg=He,jC=Ml,HK=Gc,VC=Le,Vf=jg,YP=xC,WK=Vg,qP=LP,GK=$g,XP=me,JP=Za,zK=IC,QP=Se,ZP=Bf,KK=jP,$C=uo,eD=Mg,tD=ya,YK=Pt,qK=_h,XK=Zr,JK=$P,QK=yh,nD=Gg,Yg=BK.forEach,Go=Ug("hidden"),qg="Symbol",$f="prototype",ZK=nD.set,rD=nD.getterFor(qg),Ps=Object[$f],nd=FC.Symbol,Xg=nd&&nd[$f],eY=FC.TypeError,HC=FC.QObject,iD=XP.f,rd=JP.f,oD=qP.f,tY=QP.f,aD=jK([].push),zc=$C("symbols"),Hf=$C("op-symbols"),nY=$C("wks"),WC=!HC||!HC[$f]||!HC[$f].findChild,GC=Ch&&VK(function(){return Vf(rd({},"a",{get:function(){return rd(this,"a",{value:7}).a}})).a!=7})?function(i,t,n){var a=iD(Ps,t);a&&delete Ps[t],rd(i,t,n),a&&i!==Ps&&rd(Ps,t,a)}:rd,zC=function(i,t){var n=zc[i]=Vf(Xg);return ZK(n,{type:qg,tag:i,description:t}),Ch||(n.description=t),n},Jg=function(i,t,n){i===Ps&&Jg(Hf,t,n),BC(i);var a=jC(t);return BC(n),ji(zc,a)?(n.enumerable?(ji(i,Go)&&i[Go][a]&&(i[Go][a]=!1),n=Vf(n,{enumerable:VC(0,!1)})):(ji(i,Go)||rd(i,Go,VC(1,{})),i[Go][a]=!0),GC(i,a,n)):rd(i,a,n)},KC=function(i,t){BC(i);var n=Kg(t),a=YP(n).concat(uD(n));return Yg(a,function(l){Ch&&!UC(sD,n,l)||Jg(i,l,n[l])}),i},sD=function(i){var t=jC(i),n=UC(tY,this,t);return!(this===Ps&&ji(zc,t)&&!ji(Hf,t))&&(!(n||!ji(this,t)||!ji(zc,t)||ji(this,Go)&&this[Go][t])||n)},cD=function(i,t){var n=Kg(i),a=jC(t);if(n!==Ps||!ji(zc,a)||ji(Hf,a)){var l=iD(n,a);return!l||!ji(zc,a)||ji(n,Go)&&n[Go][a]||(l.enumerable=!0),l}},lD=function(i){var t=oD(Kg(i)),n=[];return Yg(t,function(a){ji(zc,a)||ji(eD,a)||aD(n,a)}),n},uD=function(i){var t=i===Ps,n=oD(t?Hf:Kg(i)),a=[];return Yg(n,function(l){!ji(zc,l)||t&&!ji(Ps,l)||aD(a,zc[l])}),a};bh||(nd=function(){if($K(Xg,this))throw eY("Symbol is not a constructor");var i=arguments.length&&arguments[0]!==void 0?HK(arguments[0]):void 0,t=tD(i),n=function(a){this===Ps&&UC(n,Hf,a),ji(this,Go)&&ji(this[Go],t)&&(this[Go][t]=!1),GC(this,t,VC(1,a))};return Ch&&WC&&GC(Ps,t,{configurable:!0,set:n}),zC(t,i)},ZP(Xg=nd[$f],"toString",function(){return rD(this).tag}),ZP(nd,"withoutSetter",function(i){return zC(tD(i),i)}),QP.f=sD,JP.f=Jg,zK.f=KC,XP.f=cD,WK.f=qP.f=lD,GK.f=uD,qK.f=function(i){return zC(YK(i),i)},Ch&&KK(Xg,"description",{configurable:!0,get:function(){return rD(this).description}})),zg({global:!0,constructor:!0,wrap:!0,forced:!bh,sham:!bh},{Symbol:nd}),Yg(YP(nY),function(i){XK(i)}),zg({target:qg,stat:!0,forced:!bh},{useSetter:function(){WC=!0},useSimple:function(){WC=!1}}),zg({target:"Object",stat:!0,forced:!bh,sham:!Ch},{create:function(i,t){return t===void 0?Vf(i):KC(Vf(i),t)},defineProperty:Jg,defineProperties:KC,getOwnPropertyDescriptor:cD}),zg({target:"Object",stat:!0,forced:!bh},{getOwnPropertyNames:lD}),JK(),QK(nd,qg),eD[Go]=!0;var dD=Zn&&!!Symbol.for&&!!Symbol.keyFor,rY=jn,iY=vn,oY=Gr,aY=Gc,hD=uo,sY=dD,YC=hD("string-to-symbol-registry"),cY=hD("symbol-to-string-registry");rY({target:"Symbol",stat:!0,forced:!sY},{for:function(i){var t=aY(i);if(oY(YC,t))return YC[t];var n=iY("Symbol")(t);return YC[t]=n,cY[n]=t,n}});var lY=jn,uY=Gr,dY=fr,hY=Mt,pY=dD,pD=uo("symbol-to-string-registry");lY({target:"Symbol",stat:!0,forced:!pY},{keyFor:function(i){if(!dY(i))throw TypeError(hY(i)+" is not a symbol");if(uY(pD,i))return pD[i]}});var fD=T([].slice),mD=TC,fY=le,gD=W,mY=Gc,vD=T([].push),gY=jn,ED=vn,_D=D,vY=ge,Wf=T,yD=d,SD=le,CD=fr,bD=fD,EY=function(i){if(fY(i))return i;if(mD(i)){for(var t=i.length,n=[],a=0;a<t;a++){var l=i[a];typeof l=="string"?vD(n,l):typeof l!="number"&&gD(l)!="Number"&&gD(l)!="String"||vD(n,mY(l))}var u=n.length,h=!0;return function(p,v){if(h)return h=!1,v;if(mD(this))return v;for(var E=0;E<u;E++)if(n[E]===p)return v}}},_Y=Zn,yY=String,Vl=ED("JSON","stringify"),Qg=Wf(/./.exec),TD=Wf("".charAt),SY=Wf("".charCodeAt),CY=Wf("".replace),bY=Wf(1 .toString),TY=/[\uD800-\uDFFF]/g,RD=/^[\uD800-\uDBFF]$/,wD=/^[\uDC00-\uDFFF]$/,ID=!_Y||yD(function(){var i=ED("Symbol")();return Vl([i])!="[null]"||Vl({a:i})!="{}"||Vl(Object(i))!="{}"}),AD=yD(function(){return Vl("\uDF06\uD834")!=='"\\udf06\\ud834"'||Vl("\uDEAD")!=='"\\udead"'}),RY=function(i,t){var n=bD(arguments),a=EY(t);if(SD(a)||i!==void 0&&!CD(i))return n[1]=function(l,u){if(SD(a)&&(u=vY(a,this,yY(l),u)),!CD(u))return u},_D(Vl,null,n)},wY=function(i,t,n){var a=TD(n,t-1),l=TD(n,t+1);return Qg(RD,i)&&!Qg(wD,l)||Qg(wD,i)&&!Qg(RD,a)?"\\u"+bY(SY(i,0),16):i};Vl&&gY({target:"JSON",stat:!0,arity:3,forced:ID||AD},{stringify:function(i,t,n){var a=bD(arguments),l=_D(ID?RY:Vl,null,a);return AD&&typeof l=="string"?CY(l,TY,wY):l}});var OD=$g,IY=xi;jn({target:"Object",stat:!0,forced:!Zn||d(function(){OD.f(1)})},{getOwnPropertySymbols:function(i){var t=OD.f;return t?t(IY(i)):[]}}),Zr("asyncIterator"),Zr("hasInstance"),Zr("isConcatSpreadable"),Zr("iterator"),Zr("match"),Zr("matchAll"),Zr("replace"),Zr("search"),Zr("species"),Zr("split");var AY=$P;Zr("toPrimitive"),AY();var OY=vn,xY=yh;Zr("toStringTag"),xY(OY("Symbol"),"Symbol"),Zr("unscopables"),yh(A.JSON,"JSON",!0);var id,xD,ND,NY=lt.Symbol,Th={},qC=ce,PY=Gr,PD=Function.prototype,DY=qC&&Object.getOwnPropertyDescriptor,XC=PY(PD,"name"),DD={EXISTS:XC,PROPER:XC&&(function(){}).name==="something",CONFIGURABLE:XC&&(!qC||qC&&DY(PD,"name").configurable)},kY=!d(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype}),LY=Gr,MY=le,FY=xi,UY=kY,kD=Ug("IE_PROTO"),JC=Object,BY=JC.prototype,QC=UY?JC.getPrototypeOf:function(i){var t=FY(i);if(LY(t,kD))return t[kD];var n=t.constructor;return MY(n)&&t instanceof n?n.prototype:t instanceof JC?BY:null},jY=d,VY=le,$Y=et,HY=jg,LD=QC,WY=Bf,ZC=Pt("iterator"),MD=!1;[].keys&&("next"in(ND=[].keys())?(xD=LD(LD(ND)))!==Object.prototype&&(id=xD):MD=!0);var GY=!$Y(id)||jY(function(){var i={};return id[ZC].call(i)!==i});VY((id=GY?{}:HY(id))[ZC])||WY(id,ZC,function(){return this});var FD={IteratorPrototype:id,BUGGY_SAFARI_ITERATORS:MD},zY=FD.IteratorPrototype,KY=jg,YY=Le,qY=yh,XY=Th,JY=function(){return this},QY=T,ZY=Yn,eq=le,tq=String,nq=TypeError,rq=function(i,t,n){try{return QY(ZY(Object.getOwnPropertyDescriptor(i,t)[n]))}catch{}},iq=Ns,oq=function(i){if(typeof i=="object"||eq(i))return i;throw nq("Can't set "+tq(i)+" as a prototype")},aq=Object.setPrototypeOf||("__proto__"in{}?function(){var i,t=!1,n={};try{(i=rq(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch{}return function(a,l){return iq(a),oq(l),t?i(a,l):a.__proto__=l,a}}():void 0),sq=jn,cq=ge,lq=DD,uq=function(i,t,n,a){var l=t+" Iterator";return i.prototype=KY(zY,{next:YY(+!a,n)}),qY(i,l,!1,!0),XY[l]=JY,i},dq=QC,hq=yh,UD=Bf,BD=Th,pq=FD,fq=lq.PROPER,Zg=pq.BUGGY_SAFARI_ITERATORS,eb=Pt("iterator"),jD="keys",ev="values",VD="entries",mq=function(){return this},$D=function(i,t,n,a,l,u,h){uq(n,t,a);var p,v,E,y=function(q){if(q===l&&B)return B;if(!Zg&&q in k)return k[q];switch(q){case jD:case ev:case VD:return function(){return new n(this,q)}}return function(){return new n(this)}},C=t+" Iterator",I=!1,k=i.prototype,G=k[eb]||k["@@iterator"]||l&&k[l],B=!Zg&&G||y(l),j=t=="Array"&&k.entries||G;if(j&&(p=dq(j.call(new i)))!==Object.prototype&&p.next&&(hq(p,C,!0,!0),BD[C]=mq),fq&&l==ev&&G&&G.name!==ev&&(I=!0,B=function(){return cq(G,this)}),l)if(v={values:y(ev),keys:u?B:y(jD),entries:y(VD)},h)for(E in v)(Zg||I||!(E in k))&&UD(k,E,v[E]);else sq({target:t,proto:!0,forced:Zg||I},v);return h&&k[eb]!==B&&UD(k,eb,B,{name:l}),BD[t]=B,v},HD=function(i,t){return{value:i,done:t}},gq=He,WD=Th,GD=Gg;Za.f;var vq=$D,zD=HD,KD="Array Iterator",Eq=GD.set,_q=GD.getterFor(KD);vq(Array,"Array",function(i,t){Eq(this,{type:KD,target:gq(i),index:0,kind:t})},function(){var i=_q(this),t=i.target,n=i.kind,a=i.index++;return!t||a>=t.length?(i.target=void 0,zD(void 0,!0)):zD(n=="keys"?a:n=="values"?t[a]:[a,t[a]],!1)},"values"),WD.Arguments=WD.Array;var yq={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Sq=A,Cq=ed,bq=Ul,YD=Th,qD=Pt("toStringTag");for(var tb in yq){var XD=Sq[tb],nb=XD&&XD.prototype;nb&&Cq(nb)!==qD&&bq(nb,qD,tb),YD[tb]=YD.Array}var Tq=NY,Rq=Pt,wq=Za.f,JD=Rq("metadata"),QD=Function.prototype;QD[JD]===void 0&&wq(QD,JD,{value:null}),Zr("dispose"),Zr("metadata");var Iq=Tq;Zr("asyncDispose");var Aq=T,rb=vn("Symbol"),Oq=rb.keyFor,xq=Aq(rb.prototype.valueOf),ZD=rb.isRegisteredSymbol||function(i){try{return Oq(xq(i))!==void 0}catch{return!1}};jn({target:"Symbol",stat:!0},{isRegisteredSymbol:ZD});for(var Nq=uo,e2=vn,Pq=T,Dq=fr,kq=Pt,tv=e2("Symbol"),t2=tv.isWellKnownSymbol,n2=e2("Object","getOwnPropertyNames"),Lq=Pq(tv.prototype.valueOf),r2=Nq("wks"),ib=0,i2=n2(tv),Mq=i2.length;ib<Mq;ib++)try{var o2=i2[ib];Dq(tv[o2])&&kq(o2)}catch{}var a2=function(i){if(t2&&t2(i))return!0;try{for(var t=Lq(i),n=0,a=n2(r2),l=a.length;n<l;n++)if(r2[a[n]]==t)return!0}catch{}return!1};jn({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:a2}),Zr("matcher"),Zr("observable"),jn({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:ZD}),jn({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:a2}),Zr("metadataKey"),Zr("patternMatch"),Zr("replaceAll");var Rh=c(Iq),ob=T,Fq=hC,Uq=Gc,Bq=Lt,jq=ob("".charAt),s2=ob("".charCodeAt),Vq=ob("".slice),c2=function(i){return function(t,n){var a,l,u=Uq(Bq(t)),h=Fq(n),p=u.length;return h<0||h>=p?i?"":void 0:(a=s2(u,h))<55296||a>56319||h+1===p||(l=s2(u,h+1))<56320||l>57343?i?jq(u,h):a:i?Vq(u,h,h+2):l-56320+(a-55296<<10)+65536}},$q={codeAt:c2(!1),charAt:c2(!0)}.charAt,Hq=Gc,l2=Gg,Wq=$D,u2=HD,d2="String Iterator",Gq=l2.set,zq=l2.getterFor(d2);Wq(String,"String",function(i){Gq(this,{type:d2,string:Hq(i),index:0})},function(){var i,t=zq(this),n=t.string,a=t.index;return a>=n.length?u2(void 0,!0):(i=$q(n,a),t.index+=i.length,u2(i,!1))});var h2=c(_h.f("iterator"));function Gf(i){return Gf=typeof Rh=="function"&&typeof h2=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Rh=="function"&&t.constructor===Rh&&t!==Rh.prototype?"symbol":typeof t},Gf(i)}var Kq=c(_h.f("toPrimitive"));function Yq(i){var t=function(n,a){if(Gf(n)!=="object"||n===null)return n;var l=n[Kq];if(l!==void 0){var u=l.call(n,a||"default");if(Gf(u)!=="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(n)}(i,"string");return Gf(t)==="symbol"?t:String(t)}function w(i,t,n){return(t=Yq(t))in i?oz(i,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[t]=n,i}var qq=Bl("Array").keys,Xq=ed,Jq=Gr,Qq=R,Zq=qq,ab=Array.prototype,eX={DOMTokenList:!0,NodeList:!0},zo=c(function(i){var t=i.keys;return i===ab||Qq(ab,i)&&t===ab.keys||Jq(eX,Xq(i))?Zq:t}),p2=Mt,tX=TypeError,f2=FP,nX=Math.floor,sb=function(i,t){var n=i.length,a=nX(n/2);return n<8?rX(i,t):iX(i,sb(f2(i,0,a),t),sb(f2(i,a),t),t)},rX=function(i,t){for(var n,a,l=i.length,u=1;u<l;){for(a=u,n=i[u];a&&t(i[a-1],n)>0;)i[a]=i[--a];a!==u++&&(i[a]=n)}return i},iX=function(i,t,n,a){for(var l=t.length,u=n.length,h=0,p=0;h<l||p<u;)i[h+p]=h<l&&p<u?a(t[h],n[p])<=0?t[h++]:n[p++]:h<l?t[h++]:n[p++];return i},oX=sb,aX=d,cb=function(i,t){var n=[][i];return!!n&&aX(function(){n.call(null,t||function(){return 1},1)})},m2=Un.match(/firefox\/(\d+)/i),sX=!!m2&&+m2[1],cX=/MSIE|Trident/.test(Un),g2=Un.match(/AppleWebKit\/(\d+)\./),lX=!!g2&&+g2[1],uX=jn,v2=T,dX=Yn,hX=xi,E2=Zu,pX=function(i,t){if(!delete i[t])throw tX("Cannot delete property "+p2(t)+" of "+p2(i))},_2=Gc,lb=d,fX=oX,mX=cb,y2=sX,gX=cX,S2=on,C2=lX,$l=[],b2=v2($l.sort),vX=v2($l.push),EX=lb(function(){$l.sort(void 0)}),_X=lb(function(){$l.sort(null)}),yX=mX("sort"),T2=!lb(function(){if(S2)return S2<70;if(!(y2&&y2>3)){if(gX)return!0;if(C2)return C2<603;var i,t,n,a,l="";for(i=65;i<76;i++){switch(t=String.fromCharCode(i),i){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(a=0;a<47;a++)$l.push({k:t+a,v:n})}for($l.sort(function(u,h){return h.v-u.v}),a=0;a<$l.length;a++)t=$l[a].k.charAt(0),l.charAt(l.length-1)!==t&&(l+=t);return l!=="DGBEFHACIJK"}});uX({target:"Array",proto:!0,forced:EX||!_X||!yX||!T2},{sort:function(i){i!==void 0&&dX(i);var t=hX(this);if(T2)return i===void 0?b2(t):b2(t,i);var n,a,l=[],u=E2(t);for(a=0;a<u;a++)a in t&&vX(l,t[a]);for(fX(l,function(h){return function(p,v){return v===void 0?-1:p===void 0?1:h!==void 0?+h(p,v)||0:_2(p)>_2(v)?1:-1}}(i)),n=E2(l),a=0;a<n;)t[a]=l[a++];for(;a<u;)pX(t,a++);return t}});var SX=Bl("Array").sort,CX=R,bX=SX,ub=Array.prototype,zf=c(function(i){var t=i.sort;return i===ub||CX(ub,i)&&t===ub.sort?bX:t}),TX=vn,RX=Vg,wX=$g,IX=Ns,AX=T([].concat),OX=TX("Reflect","ownKeys")||function(i){var t=RX.f(IX(i)),n=wX.f;return n?AX(t,n(i)):t},R2=Gr,xX=OX,NX=me,PX=Za,DX=et,kX=Ul,w2=Error,LX=T("".replace),MX=String(w2("zxcasd").stack),I2=/\n\s*at [^:]*:[^\n]*/,FX=I2.test(MX),UX=Le,BX=!d(function(){var i=Error("a");return!("stack"in i)||(Object.defineProperty(i,"stack",UX(1,7)),i.stack!==7)}),jX=Ul,VX=function(i,t){if(FX&&typeof i=="string"&&!w2.prepareStackTrace)for(;t--;)i=LX(i,I2,"");return i},$X=BX,A2=Error.captureStackTrace,HX=Th,WX=Pt("iterator"),GX=Array.prototype,zX=ed,O2=Ji,KX=gt,YX=Th,qX=Pt("iterator"),x2=function(i){if(!KX(i))return O2(i,qX)||O2(i,"@@iterator")||YX[zX(i)]},XX=ge,JX=Yn,QX=Ns,ZX=Mt,eJ=x2,tJ=TypeError,nJ=ge,N2=Ns,rJ=Ji,iJ=Ff,oJ=ge,aJ=Ns,sJ=Mt,cJ=function(i){return i!==void 0&&(HX.Array===i||GX[WX]===i)},lJ=Zu,P2=R,uJ=function(i,t){var n=arguments.length<2?eJ(i):t;if(JX(n))return QX(XX(n,i));throw tJ(ZX(i)+" is not iterable")},dJ=x2,D2=function(i,t,n){var a,l;N2(i);try{if(!(a=rJ(i,"return"))){if(t==="throw")throw n;return n}a=nJ(a,i)}catch(u){l=!0,a=u}if(t==="throw")throw n;if(l)throw a;return N2(a),n},hJ=TypeError,nv=function(i,t){this.stopped=i,this.result=t},k2=nv.prototype,Kf=function(i,t,n){var a,l,u,h,p,v,E,y=n&&n.that,C=!(!n||!n.AS_ENTRIES),I=!(!n||!n.IS_RECORD),k=!(!n||!n.IS_ITERATOR),G=!(!n||!n.INTERRUPTED),B=iJ(t,y),j=function(Z){return a&&D2(a,"normal",Z),new nv(!0,Z)},q=function(Z){return C?(aJ(Z),G?B(Z[0],Z[1],j):B(Z[0],Z[1])):G?B(Z,j):B(Z)};if(I)a=i.iterator;else if(k)a=i;else{if(!(l=dJ(i)))throw hJ(sJ(i)+" is not iterable");if(cJ(l)){for(u=0,h=lJ(i);h>u;u++)if((p=q(i[u]))&&P2(k2,p))return p;return new nv(!1)}a=uJ(i,l)}for(v=I?i.next:a.next;!(E=oJ(v,a)).done;){try{p=q(E.value)}catch(Z){D2(a,"throw",Z)}if(typeof p=="object"&&p&&P2(k2,p))return p}return new nv(!1)},pJ=Gc,fJ=jn,mJ=R,gJ=QC,rv=aq,vJ=function(i,t,n){for(var a=xX(t),l=PX.f,u=NX.f,h=0;h<a.length;h++){var p=a[h];R2(i,p)||n&&R2(n,p)||l(i,p,u(t,p))}},L2=jg,db=Ul,hb=Le,EJ=function(i,t){DX(t)&&"cause"in t&&kX(i,"cause",t.cause)},_J=function(i,t,n,a){$X&&(A2?A2(i,t):jX(i,"stack",VX(n,a)))},yJ=Kf,SJ=function(i,t){return i===void 0?arguments.length<2?"":t:pJ(i)},CJ=Pt("toStringTag"),iv=Error,bJ=[].push,wh=function(i,t){var n,a=mJ(pb,this);rv?n=rv(iv(),a?gJ(this):pb):(n=a?this:L2(pb),db(n,CJ,"Error")),t!==void 0&&db(n,"message",SJ(t)),_J(n,wh,n.stack,1),arguments.length>2&&EJ(n,arguments[2]);var l=[];return yJ(i,bJ,{that:l}),db(n,"errors",l),n};rv?rv(wh,iv):vJ(wh,iv,{name:!0});var pb=wh.prototype=L2(iv.prototype,{constructor:hb(1,wh),message:hb(1,""),name:hb(1,"AggregateError")});fJ({global:!0,constructor:!0,arity:2},{AggregateError:wh});var Yf,Ih,M2,fb,qf=typeof process<"u"&&W(process)=="process",TJ=vn,RJ=jP,wJ=ce,F2=Pt("species"),IJ=R,AJ=TypeError,OJ=yP,xJ=Mt,NJ=TypeError,U2=Ns,PJ=function(i){if(OJ(i))return i;throw NJ(xJ(i)+" is not a constructor")},DJ=gt,kJ=Pt("species"),B2=function(i,t){var n,a=U2(i).constructor;return a===void 0||DJ(n=U2(a)[kJ])?t:PJ(n)},LJ=TypeError,j2=/(?:ipad|iphone|ipod).*applewebkit/i.test(Un),Ca=A,MJ=D,FJ=Ff,V2=le,UJ=Gr,$2=d,H2=OP,BJ=fD,W2=Hc,jJ=function(i,t){if(i<t)throw LJ("Not enough arguments");return i},VJ=j2,$J=qf,mb=Ca.setImmediate,gb=Ca.clearImmediate,HJ=Ca.process,vb=Ca.Dispatch,WJ=Ca.Function,G2=Ca.MessageChannel,GJ=Ca.String,Eb=0,Xf={},z2="onreadystatechange";$2(function(){Yf=Ca.location});var _b=function(i){if(UJ(Xf,i)){var t=Xf[i];delete Xf[i],t()}},yb=function(i){return function(){_b(i)}},K2=function(i){_b(i.data)},Y2=function(i){Ca.postMessage(GJ(i),Yf.protocol+"//"+Yf.host)};mb&&gb||(mb=function(i){jJ(arguments.length,1);var t=V2(i)?i:WJ(i),n=BJ(arguments,1);return Xf[++Eb]=function(){MJ(t,void 0,n)},Ih(Eb),Eb},gb=function(i){delete Xf[i]},$J?Ih=function(i){HJ.nextTick(yb(i))}:vb&&vb.now?Ih=function(i){vb.now(yb(i))}:G2&&!VJ?(fb=(M2=new G2).port2,M2.port1.onmessage=K2,Ih=FJ(fb.postMessage,fb)):Ca.addEventListener&&V2(Ca.postMessage)&&!Ca.importScripts&&Yf&&Yf.protocol!=="file:"&&!$2(Y2)?(Ih=Y2,Ca.addEventListener("message",K2,!1)):Ih=z2 in W2("script")?function(i){H2.appendChild(W2("script"))[z2]=function(){H2.removeChild(this),_b(i)}}:function(i){setTimeout(yb(i),0)});var q2={set:mb,clear:gb},X2=function(){this.head=null,this.tail=null};X2.prototype={add:function(i){var t={item:i,next:null},n=this.tail;n?n.next=t:this.head=t,this.tail=t},get:function(){var i=this.head;if(i)return(this.head=i.next)===null&&(this.tail=null),i.item}};var Ah,Sb,Cb,bb,J2,Q2=X2,zJ=/ipad|iphone|ipod/i.test(Un)&&typeof Pebble<"u",KJ=/web0s(?!.*chrome)/i.test(Un),od=A,Z2=Ff,YJ=me.f,Tb=q2.set,qJ=Q2,XJ=j2,JJ=zJ,QJ=KJ,Rb=qf,ek=od.MutationObserver||od.WebKitMutationObserver,tk=od.document,nk=od.process,ov=od.Promise,rk=YJ(od,"queueMicrotask"),wb=rk&&rk.value;if(!wb){var av=new qJ,sv=function(){var i,t;for(Rb&&(i=nk.domain)&&i.exit();t=av.get();)try{t()}catch(n){throw av.head&&Ah(),n}i&&i.enter()};XJ||Rb||QJ||!ek||!tk?!JJ&&ov&&ov.resolve?((bb=ov.resolve(void 0)).constructor=ov,J2=Z2(bb.then,bb),Ah=function(){J2(sv)}):Rb?Ah=function(){nk.nextTick(sv)}:(Tb=Z2(Tb,od),Ah=function(){Tb(sv)}):(Sb=!0,Cb=tk.createTextNode(""),new ek(sv).observe(Cb,{characterData:!0}),Ah=function(){Cb.data=Sb=!Sb}),wb=function(i){av.head||Ah(),av.add(i)}}var ZJ=wb,Oh=function(i){try{return{error:!1,value:i()}}catch(t){return{error:!0,value:t}}},ad=A.Promise,ik=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",eQ=!ik&&!qf&&typeof window=="object"&&typeof document=="object",tQ=A,Jf=ad,nQ=le,rQ=gN,iQ=mP,oQ=Pt,aQ=eQ,sQ=ik,Ib=on,ok=Jf&&Jf.prototype,cQ=oQ("species"),ak=!1,sk=nQ(tQ.PromiseRejectionEvent),lQ=rQ("Promise",function(){var i=iQ(Jf),t=i!==String(Jf);if(!t&&Ib===66||!ok.catch||!ok.finally)return!0;if(!Ib||Ib<51||!/native code/.test(i)){var n=new Jf(function(l){l(1)}),a=function(l){l(function(){},function(){})};if((n.constructor={})[cQ]=a,!(ak=n.then(function(){})instanceof a))return!0}return!t&&(aQ||sQ)&&!sk}),Qf={CONSTRUCTOR:lQ,REJECTION_EVENT:sk,SUBCLASSING:ak},mc={},ck=Yn,uQ=TypeError,dQ=function(i){var t,n;this.promise=new i(function(a,l){if(t!==void 0||n!==void 0)throw uQ("Bad Promise constructor");t=a,n=l}),this.resolve=ck(t),this.reject=ck(n)};mc.f=function(i){return new dQ(i)};var Ab,lk,hQ=jn,cv=qf,Hl=A,Zf=ge,pQ=Bf,fQ=yh,mQ=function(i){var t=TJ(i);wJ&&t&&!t[F2]&&RJ(t,F2,{configurable:!0,get:function(){return this}})},gQ=Yn,Ob=le,vQ=et,EQ=function(i,t){if(IJ(t,i))return i;throw AJ("Incorrect invocation")},_Q=B2,uk=q2.set,xb=ZJ,yQ=function(i,t){try{arguments.length==1?console.error(i):console.error(i,t)}catch{}},SQ=Oh,CQ=Q2,dk=Gg,Nb=ad,hk=Qf,pk=mc,lv="Promise",fk=hk.CONSTRUCTOR,bQ=hk.REJECTION_EVENT,Pb=dk.getterFor(lv),TQ=dk.set,RQ=Nb&&Nb.prototype,e0=Nb,Db=RQ,mk=Hl.TypeError,kb=Hl.document,Lb=Hl.process,Mb=pk.f,wQ=Mb,IQ=!!(kb&&kb.createEvent&&Hl.dispatchEvent),gk="unhandledrejection",vk=function(i){var t;return!(!vQ(i)||!Ob(t=i.then))&&t},Ek=function(i,t){var n,a,l,u=t.value,h=t.state==1,p=h?i.ok:i.fail,v=i.resolve,E=i.reject,y=i.domain;try{p?(h||(t.rejection===2&&OQ(t),t.rejection=1),p===!0?n=u:(y&&y.enter(),n=p(u),y&&(y.exit(),l=!0)),n===i.promise?E(mk("Promise-chain cycle")):(a=vk(n))?Zf(a,n,v,E):v(n)):E(u)}catch(C){y&&!l&&y.exit(),E(C)}},_k=function(i,t){i.notified||(i.notified=!0,xb(function(){for(var n,a=i.reactions;n=a.get();)Ek(n,i);i.notified=!1,t&&!i.rejection&&AQ(i)}))},yk=function(i,t,n){var a,l;IQ?((a=kb.createEvent("Event")).promise=t,a.reason=n,a.initEvent(i,!1,!0),Hl.dispatchEvent(a)):a={promise:t,reason:n},!bQ&&(l=Hl["on"+i])?l(a):i===gk&&yQ("Unhandled promise rejection",n)},AQ=function(i){Zf(uk,Hl,function(){var t,n=i.facade,a=i.value;if(Sk(i)&&(t=SQ(function(){cv?Lb.emit("unhandledRejection",a,n):yk(gk,n,a)}),i.rejection=cv||Sk(i)?2:1,t.error))throw t.value})},Sk=function(i){return i.rejection!==1&&!i.parent},OQ=function(i){Zf(uk,Hl,function(){var t=i.facade;cv?Lb.emit("rejectionHandled",t):yk("rejectionhandled",t,i.value)})},xh=function(i,t,n){return function(a){i(t,a,n)}},Nh=function(i,t,n){i.done||(i.done=!0,n&&(i=n),i.value=t,i.state=2,_k(i,!0))},Fb=function(i,t,n){if(!i.done){i.done=!0,n&&(i=n);try{if(i.facade===t)throw mk("Promise can't be resolved itself");var a=vk(t);a?xb(function(){var l={done:!1};try{Zf(a,t,xh(Fb,l,i),xh(Nh,l,i))}catch(u){Nh(l,u,i)}}):(i.value=t,i.state=1,_k(i,!1))}catch(l){Nh({done:!1},l,i)}}};fk&&(Db=(e0=function(i){EQ(this,Db),gQ(i),Zf(Ab,this);var t=Pb(this);try{i(xh(Fb,t),xh(Nh,t))}catch(n){Nh(t,n)}}).prototype,(Ab=function(i){TQ(this,{type:lv,done:!1,notified:!1,parent:!1,reactions:new CQ,rejection:!1,state:0,value:void 0})}).prototype=pQ(Db,"then",function(i,t){var n=Pb(this),a=Mb(_Q(this,e0));return n.parent=!0,a.ok=!Ob(i)||i,a.fail=Ob(t)&&t,a.domain=cv?Lb.domain:void 0,n.state==0?n.reactions.add(a):xb(function(){Ek(a,n)}),a.promise}),lk=function(){var i=new Ab,t=Pb(i);this.promise=i,this.resolve=xh(Fb,t),this.reject=xh(Nh,t)},pk.f=Mb=function(i){return i===e0||i===void 0?new lk(i):wQ(i)}),hQ({global:!0,constructor:!0,wrap:!0,forced:fk},{Promise:e0}),fQ(e0,lv,!1,!0),mQ(lv);var Ck=Pt("iterator"),bk=!1;try{var xQ=0,Tk={next:function(){return{done:!!xQ++}},return:function(){bk=!0}};Tk[Ck]=function(){return this},Array.from(Tk,function(){throw 2})}catch{}var NQ=ad,PQ=function(i,t){if(!t&&!bk)return!1;var n=!1;try{var a={};a[Ck]=function(){return{next:function(){return{done:n=!0}}}},i(a)}catch{}return n},uv=Qf.CONSTRUCTOR||!PQ(function(i){NQ.all(i).then(void 0,function(){})}),DQ=ge,kQ=Yn,LQ=mc,MQ=Oh,FQ=Kf;jn({target:"Promise",stat:!0,forced:uv},{all:function(i){var t=this,n=LQ.f(t),a=n.resolve,l=n.reject,u=MQ(function(){var h=kQ(t.resolve),p=[],v=0,E=1;FQ(i,function(y){var C=v++,I=!1;E++,DQ(h,t,y).then(function(k){I||(I=!0,p[C]=k,--E||a(p))},l)}),--E||a(p)});return u.error&&l(u.value),n.promise}});var UQ=jn,BQ=Qf.CONSTRUCTOR;ad&&ad.prototype,UQ({target:"Promise",proto:!0,forced:BQ,real:!0},{catch:function(i){return this.then(void 0,i)}});var jQ=ge,VQ=Yn,$Q=mc,HQ=Oh,WQ=Kf;jn({target:"Promise",stat:!0,forced:uv},{race:function(i){var t=this,n=$Q.f(t),a=n.reject,l=HQ(function(){var u=VQ(t.resolve);WQ(i,function(h){jQ(u,t,h).then(n.resolve,a)})});return l.error&&a(l.value),n.promise}});var GQ=ge,zQ=mc;jn({target:"Promise",stat:!0,forced:Qf.CONSTRUCTOR},{reject:function(i){var t=zQ.f(this);return GQ(t.reject,void 0,i),t.promise}});var KQ=Ns,YQ=et,qQ=mc,Rk=function(i,t){if(KQ(i),YQ(t)&&t.constructor===i)return t;var n=qQ.f(i);return(0,n.resolve)(t),n.promise},XQ=jn,JQ=ad,QQ=Qf.CONSTRUCTOR,ZQ=Rk,eZ=vn("Promise"),tZ=!QQ;XQ({target:"Promise",stat:!0,forced:!0},{resolve:function(i){return ZQ(tZ&&this===eZ?JQ:this,i)}});var nZ=ge,rZ=Yn,iZ=mc,oZ=Oh,aZ=Kf;jn({target:"Promise",stat:!0,forced:uv},{allSettled:function(i){var t=this,n=iZ.f(t),a=n.resolve,l=n.reject,u=oZ(function(){var h=rZ(t.resolve),p=[],v=0,E=1;aZ(i,function(y){var C=v++,I=!1;E++,nZ(h,t,y).then(function(k){I||(I=!0,p[C]={status:"fulfilled",value:k},--E||a(p))},function(k){I||(I=!0,p[C]={status:"rejected",reason:k},--E||a(p))})}),--E||a(p)});return u.error&&l(u.value),n.promise}});var sZ=ge,cZ=Yn,lZ=vn,uZ=mc,dZ=Oh,hZ=Kf,wk="No one promise resolved";jn({target:"Promise",stat:!0,forced:uv},{any:function(i){var t=this,n=lZ("AggregateError"),a=uZ.f(t),l=a.resolve,u=a.reject,h=dZ(function(){var p=cZ(t.resolve),v=[],E=0,y=1,C=!1;hZ(i,function(I){var k=E++,G=!1;y++,sZ(p,t,I).then(function(B){G||C||(C=!0,l(B))},function(B){G||C||(G=!0,v[k]=B,--y||u(new n(v,wk)))})}),--y||u(new n(v,wk))});return h.error&&u(h.value),a.promise}});var pZ=jn,Ub=ad,fZ=d,mZ=vn,gZ=le,vZ=B2,Ik=Rk,EZ=Ub&&Ub.prototype;pZ({target:"Promise",proto:!0,real:!0,forced:!!Ub&&fZ(function(){EZ.finally.call({then:function(){}},function(){})})},{finally:function(i){var t=vZ(this,mZ("Promise")),n=gZ(i);return this.then(n?function(a){return Ik(t,i()).then(function(){return a})}:i,n?function(a){return Ik(t,i()).then(function(){throw a})}:i)}});var Ak=lt.Promise,_e=c(Ak);const _Z=()=>{};function t0(){const i={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:_Z};return i.promise=new _e((t,n)=>{i.resolve=a=>{i.isFinished||(i.isResolved=!0,i.isFinished=!0,t(a),i.value=a)},i.reject=a=>{i.isFinished||(i.isRejected=!0,i.isFinished=!0,n(a))}}),i}const dv=new Map,hv=new Map,gc=new Map;var yr,qt;(function(i){i.WIN_10="Windows 10",i.WIN_81="Windows 8.1",i.WIN_8="Windows 8",i.WIN_7="Windows 7",i.WIN_VISTA="Windows Vista",i.WIN_SERVER_2003="Windows Server 2003",i.WIN_XP="Windows XP",i.WIN_2000="Windows 2000",i.ANDROID="Android",i.HARMONY_OS="HarmonyOS",i.OPEN_BSD="Open BSD",i.SUN_OS="Sun OS",i.LINUX="Linux",i.IOS="iOS",i.MAC_OS="Mac OS",i.CHROMIUM_OS="Chromium OS",i.QNX="QNX",i.UNIX="UNIX",i.BEOS="BeOS",i.OS_2="OS/2",i.SEARCH_BOT="Search Bot"})(yr||(yr={})),function(i){i.CHROME="Chrome",i.SAFARI="Safari",i.EDGE="Edge",i.FIREFOX="Firefox",i.OPERA="OPR",i.QQ="QQBrowser",i.WECHAT="MicroMessenger"}(qt||(qt={}));var Bb={exports:{}};(function(i,t){(function(n,a){var l="function",u="undefined",h="object",p="string",v="major",E="model",y="name",C="type",I="vendor",k="version",G="architecture",B="console",j="mobile",q="tablet",Z="smarttv",re="wearable",Ce="embedded",pe="Amazon",fe="Apple",ye="ASUS",Ee="BlackBerry",Ae="Browser",Ne="Chrome",it="Firefox",yt="Google",gn="Huawei",Er="LG",Sn="Microsoft",Lo="Motorola",we="Opera",Pe="Samsung",Ue="Sharp",st="Sony",Gt="Xiaomi",De="Zebra",U="Facebook",X="Chromium OS",oe="Mac OS",xe=function(Jn){for(var _r={},Cn=0;Cn<Jn.length;Cn++)_r[Jn[Cn].toUpperCase()]=Jn[Cn];return _r},ft=function(Jn,_r){return typeof Jn===p&&_n(_r).indexOf(_n(Jn))!==-1},_n=function(Jn){return Jn.toLowerCase()},hi=function(Jn,_r){if(typeof Jn===p)return Jn=Jn.replace(/^\s\s*/,""),typeof _r===u?Jn:Jn.substring(0,350)},Mo=function(Jn,_r){for(var Cn,Fo,xc,Qn,zt,yo,_u=0;_u<_r.length&&!zt;){var js=_r[_u],L4=_r[_u+1];for(Cn=Fo=0;Cn<js.length&&!zt&&js[Cn];)if(zt=js[Cn++].exec(Jn))for(xc=0;xc<L4.length;xc++)yo=zt[++Fo],typeof(Qn=L4[xc])===h&&Qn.length>0?Qn.length===2?typeof Qn[1]==l?this[Qn[0]]=Qn[1].call(this,yo):this[Qn[0]]=Qn[1]:Qn.length===3?typeof Qn[1]!==l||Qn[1].exec&&Qn[1].test?this[Qn[0]]=yo?yo.replace(Qn[1],Qn[2]):a:this[Qn[0]]=yo?Qn[1].call(this,yo,Qn[2]):a:Qn.length===4&&(this[Qn[0]]=yo?Qn[3].call(this,yo.replace(Qn[1],Qn[2])):a):this[Qn]=yo||a;_u+=2}},cl=function(Jn,_r){for(var Cn in _r)if(typeof _r[Cn]===h&&_r[Cn].length>0){for(var Fo=0;Fo<_r[Cn].length;Fo++)if(ft(_r[Cn][Fo],Jn))return Cn==="?"?a:Cn}else if(ft(_r[Cn],Jn))return Cn==="?"?a:Cn;return Jn},IE={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},AE={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[k,[y,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[k,[y,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[y,k],[/opios[\/ ]+([\w\.]+)/i],[k,[y,we+" Mini"]],[/\bopr\/([\w\.]+)/i],[k,[y,we]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[y,k],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[k,[y,"UC"+Ae]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[k,[y,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[k,[y,"WeChat"]],[/konqueror\/([\w\.]+)/i],[k,[y,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[k,[y,"IE"]],[/yabrowser\/([\w\.]+)/i],[k,[y,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[y,/(.+)/,"$1 Secure "+Ae],k],[/\bfocus\/([\w\.]+)/i],[k,[y,it+" Focus"]],[/\bopt\/([\w\.]+)/i],[k,[y,we+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[k,[y,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[k,[y,"Dolphin"]],[/coast\/([\w\.]+)/i],[k,[y,we+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[k,[y,"MIUI "+Ae]],[/fxios\/([-\w\.]+)/i],[k,[y,it]],[/\bqihu|(qi?ho?o?|360)browser/i],[[y,"360 "+Ae]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[y,/(.+)/,"$1 "+Ae],k],[/(comodo_dragon)\/([\w\.]+)/i],[[y,/_/g," "],k],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[y,k],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[y],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[y,U],k],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[y,k],[/\bgsa\/([\w\.]+) .*safari\//i],[k,[y,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[k,[y,Ne+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[y,Ne+" WebView"],k],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[k,[y,"Android "+Ae]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[y,k],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[k,[y,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[k,y],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[y,[k,cl,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[y,k],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[y,"Netscape"],k],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[k,[y,it+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[y,k],[/(cobalt)\/([\w\.]+)/i],[y,[k,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[G,"amd64"]],[/(ia32(?=;))/i],[[G,_n]],[/((?:i[346]|x)86)[;\)]/i],[[G,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[G,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[G,"armhf"]],[/windows (ce|mobile); ppc;/i],[[G,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[G,/ower/,"",_n]],[/(sun4\w)[;\)]/i],[[G,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[G,_n]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[E,[I,Pe],[C,q]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[E,[I,Pe],[C,j]],[/\((ip(?:hone|od)[\w ]*);/i],[E,[I,fe],[C,j]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[E,[I,fe],[C,q]],[/(macintosh);/i],[E,[I,fe]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[E,[I,Ue],[C,j]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[E,[I,gn],[C,q]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[E,[I,gn],[C,j]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[E,/_/g," "],[I,Gt],[C,j]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[E,/_/g," "],[I,Gt],[C,q]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[E,[I,"OPPO"],[C,j]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[E,[I,"Vivo"],[C,j]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[E,[I,"Realme"],[C,j]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[E,[I,Lo],[C,j]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[E,[I,Lo],[C,q]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[E,[I,Er],[C,q]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[E,[I,Er],[C,j]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[E,[I,"Lenovo"],[C,q]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[E,/_/g," "],[I,"Nokia"],[C,j]],[/(pixel c)\b/i],[E,[I,yt],[C,q]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[E,[I,yt],[C,j]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[E,[I,st],[C,j]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[E,"Xperia Tablet"],[I,st],[C,q]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[E,[I,"OnePlus"],[C,j]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[E,[I,pe],[C,q]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[E,/(.+)/g,"Fire Phone $1"],[I,pe],[C,j]],[/(playbook);[-\w\),; ]+(rim)/i],[E,I,[C,q]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[E,[I,Ee],[C,j]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[E,[I,ye],[C,q]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[E,[I,ye],[C,j]],[/(nexus 9)/i],[E,[I,"HTC"],[C,q]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[I,[E,/_/g," "],[C,j]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[E,[I,"Acer"],[C,q]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[E,[I,"Meizu"],[C,j]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[I,E,[C,j]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[I,E,[C,q]],[/(surface duo)/i],[E,[I,Sn],[C,q]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[E,[I,"Fairphone"],[C,j]],[/(u304aa)/i],[E,[I,"AT&T"],[C,j]],[/\bsie-(\w*)/i],[E,[I,"Siemens"],[C,j]],[/\b(rct\w+) b/i],[E,[I,"RCA"],[C,q]],[/\b(venue[\d ]{2,7}) b/i],[E,[I,"Dell"],[C,q]],[/\b(q(?:mv|ta)\w+) b/i],[E,[I,"Verizon"],[C,q]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[E,[I,"Barnes & Noble"],[C,q]],[/\b(tm\d{3}\w+) b/i],[E,[I,"NuVision"],[C,q]],[/\b(k88) b/i],[E,[I,"ZTE"],[C,q]],[/\b(nx\d{3}j) b/i],[E,[I,"ZTE"],[C,j]],[/\b(gen\d{3}) b.+49h/i],[E,[I,"Swiss"],[C,j]],[/\b(zur\d{3}) b/i],[E,[I,"Swiss"],[C,q]],[/\b((zeki)?tb.*\b) b/i],[E,[I,"Zeki"],[C,q]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[I,"Dragon Touch"],E,[C,q]],[/\b(ns-?\w{0,9}) b/i],[E,[I,"Insignia"],[C,q]],[/\b((nxa|next)-?\w{0,9}) b/i],[E,[I,"NextBook"],[C,q]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[I,"Voice"],E,[C,j]],[/\b(lvtel\-)?(v1[12]) b/i],[[I,"LvTel"],E,[C,j]],[/\b(ph-1) /i],[E,[I,"Essential"],[C,j]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[E,[I,"Envizen"],[C,q]],[/\b(trio[-\w\. ]+) b/i],[E,[I,"MachSpeed"],[C,q]],[/\btu_(1491) b/i],[E,[I,"Rotor"],[C,q]],[/(shield[\w ]+) b/i],[E,[I,"Nvidia"],[C,q]],[/(sprint) (\w+)/i],[I,E,[C,j]],[/(kin\.[onetw]{3})/i],[[E,/\./g," "],[I,Sn],[C,j]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[E,[I,De],[C,q]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[E,[I,De],[C,j]],[/smart-tv.+(samsung)/i],[I,[C,Z]],[/hbbtv.+maple;(\d+)/i],[[E,/^/,"SmartTV"],[I,Pe],[C,Z]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[I,Er],[C,Z]],[/(apple) ?tv/i],[I,[E,fe+" TV"],[C,Z]],[/crkey/i],[[E,Ne+"cast"],[I,yt],[C,Z]],[/droid.+aft(\w)( bui|\))/i],[E,[I,pe],[C,Z]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[E,[I,Ue],[C,Z]],[/(bravia[\w ]+)( bui|\))/i],[E,[I,st],[C,Z]],[/(mitv-\w{5}) bui/i],[E,[I,Gt],[C,Z]],[/Hbbtv.*(technisat) (.*);/i],[I,E,[C,Z]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[I,hi],[E,hi],[C,Z]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[C,Z]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[I,E,[C,B]],[/droid.+; (shield) bui/i],[E,[I,"Nvidia"],[C,B]],[/(playstation [345portablevi]+)/i],[E,[I,st],[C,B]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[E,[I,Sn],[C,B]],[/((pebble))app/i],[I,E,[C,re]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[E,[I,fe],[C,re]],[/droid.+; (glass) \d/i],[E,[I,yt],[C,re]],[/droid.+; (wt63?0{2,3})\)/i],[E,[I,De],[C,re]],[/(quest( 2| pro)?)/i],[E,[I,U],[C,re]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[I,[C,Ce]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[E,[C,j]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[E,[C,q]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[C,q]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[C,j]],[/(android[-\w\. ]{0,9});.+buil/i],[E,[I,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[k,[y,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[k,[y,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[y,k],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[k,y]],os:[[/microsoft (windows) (vista|xp)/i],[y,k],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[y,[k,cl,IE]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[y,"Windows"],[k,cl,IE]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[k,/_/g,"."],[y,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[y,oe],[k,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[k,y],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[y,k],[/\(bb(10);/i],[k,[y,Ee]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[k,[y,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[k,[y,it+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[k,[y,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[k,[y,"watchOS"]],[/crkey\/([\d\.]+)/i],[k,[y,Ne+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[y,X],k],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[y,k],[/(sunos) ?([\w\.\d]*)/i],[[y,"Solaris"],k],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[y,k]]},Da=function(Jn,_r){if(typeof Jn===h&&(_r=Jn,Jn=a),!(this instanceof Da))return new Da(Jn,_r).getResult();var Cn=typeof n!==u&&n.navigator?n.navigator:a,Fo=Jn||(Cn&&Cn.userAgent?Cn.userAgent:""),xc=Cn&&Cn.userAgentData?Cn.userAgentData:a,Qn=_r?function(zt,yo){var _u={};for(var js in zt)yo[js]&&yo[js].length%2==0?_u[js]=yo[js].concat(zt[js]):_u[js]=zt[js];return _u}(AE,_r):AE;return this.getBrowser=function(){var zt={};return zt[y]=a,zt[k]=a,Mo.call(zt,Fo,Qn.browser),zt[v]=function(yo){return typeof yo===p?yo.replace(/[^\d\.]/g,"").split(".")[0]:a}(zt[k]),Cn&&Cn.brave&&typeof Cn.brave.isBrave==l&&(zt[y]="Brave"),zt},this.getCPU=function(){var zt={};return zt[G]=a,Mo.call(zt,Fo,Qn.cpu),zt},this.getDevice=function(){var zt={};return zt[I]=a,zt[E]=a,zt[C]=a,Mo.call(zt,Fo,Qn.device),!zt[C]&&xc&&xc.mobile&&(zt[C]=j),zt[E]=="Macintosh"&&Cn&&typeof Cn.standalone!==u&&Cn.maxTouchPoints&&Cn.maxTouchPoints>2&&(zt[E]="iPad",zt[C]=q),zt},this.getEngine=function(){var zt={};return zt[y]=a,zt[k]=a,Mo.call(zt,Fo,Qn.engine),zt},this.getOS=function(){var zt={};return zt[y]=a,zt[k]=a,Mo.call(zt,Fo,Qn.os),!zt[y]&&xc&&xc.platform!="Unknown"&&(zt[y]=xc.platform.replace(/chrome os/i,X).replace(/macos/i,oe)),zt},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return Fo},this.setUA=function(zt){return Fo=typeof zt===p&&zt.length>350?hi(zt,350):zt,this},this.setUA(Fo),this};Da.VERSION="0.7.34",Da.BROWSER=xe([y,k,v]),Da.CPU=xe([G]),Da.DEVICE=xe([E,I,C,B,j,Z,q,re,Ce]),Da.ENGINE=Da.OS=xe([y,k]),i.exports&&(t=i.exports=Da),t.UAParser=Da;var Eu=typeof n!==u&&(n.jQuery||n.Zepto);if(Eu&&!Eu.ua){var hp=new Da;Eu.ua=hp.getResult(),Eu.ua.get=function(){return hp.getUA()},Eu.ua.set=function(Jn){hp.setUA(Jn);var _r=hp.getResult();for(var Cn in _r)Eu.ua[Cn]=_r[Cn]}}})(typeof window=="object"?window:s)})(Bb,Bb.exports);const jb=new(c(Bb.exports));let Kc=jb.getResult(),Vb=null;function Wt(i){if(!Vb){i&&jb.setUA(i),Kc=jb.getResult();const t=function(u){if(u.engine.name==="Blink"&&u.browser.name!=="WeChat")return qt.CHROME;switch(u.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return qt.CHROME;case"Safari":case"Mobile Safari":return qt.SAFARI;case"Edge":return qt.EDGE;case"Firefox":return qt.FIREFOX;case"QQBrowser":return qt.QQ;case"Opera":return qt.OPERA;case"WeChat":return qt.WECHAT;default:return u.browser.name||""}}(Kc),n=function(u){let h;return h=u.engine.name==="Blink"?u.engine.version||"":u.browser.version||"",h.split(".")[0]}(Kc),a=function(u){return u.os.name==="Windows"?u.os.version?u.os.name+" "+u.os.version:u.os.name:u.os.name||""}(Kc),l=Kc.os.version;if(!(t&&n&&a&&l))return{name:t,version:n,os:a,osVersion:l};Vb={name:t,version:n,os:a,osVersion:l}}return Vb}function pv(){return Wt().os}function Ok(){const i=Wt();return"".concat(i.os," ").concat(i.osVersion)}function fv(){const i=Wt();return!!(Kc.engine.name==="WebKit"&&i.os===yr.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&i.name!==qt.SAFARI||Pi()&&i.name!==qt.SAFARI)}function yZ(){const i=Wt();if(fv()){if(i.os===yr.MAC_OS)return!0;if(i.os===yr.IOS){const t=Kc.os.version&&Kc.os.version.split(".");if(t&&Number(t[0])===14&&t[1]&&Number(t[1])>=3||t&&Number(t[0])>14)return!0}}return!1}function SZ(){return Kc.engine.name==="WebKit"}function n0(){return Wt().name===qt.CHROME}function Ni(){return Wt().name===qt.SAFARI}function un(){return Wt().name===qt.FIREFOX}function Pi(){return Wt().os===yr.IOS}function $b(i){const t=Wt();return!(t.name!==qt.CHROME||!t.osVersion)&&Number(t.version)>=i}function xk(i){const t=Wt();return!(t.name!==qt.EDGE||!t.osVersion)&&Number(t.version)>=i}function Nk(i){const t=Wt();return!(t.name!==qt.OPERA||!t.osVersion)&&Number(t.version)>=i}function Pk(){const i=Wt();return!(i.name!==qt.CHROME||!i.osVersion)&&Number(i.version)<=90}function Dk(){const i=Wt();if(i.os!==yr.IOS||!i.osVersion)return!1;const t=i.osVersion.split(".");return Number(t[0])<14||Number(t[0])===14&&Number(t[1])<=6}function Ph(){const i=Wt();if(i.os!==yr.IOS||!i.osVersion)return!1;const t=i.osVersion.split(".");return Number(t[0])===15}function Hb(){const i=Wt();if(i.os!==yr.IOS||!i.osVersion)return!1;const t=i.osVersion.split(".");return Number(t[0])===16}function kk(){const i=Wt();if(i.os!==yr.IOS||!i.osVersion)return!1;const t=i.osVersion.split(".");return Number(t[0])===15&&Number(t[1])>=1}function vc(){return Ni()&&navigator.maxTouchPoints>0}function Lk(){return Wt().name===qt.WECHAT}function Mk(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function Wl(){const i=Wt();return i.name===qt.EDGE||i.name===qt.SAFARI?!1:!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function mv(){return pv()===yr.ANDROID}function r0(){const i=Wt();return mv()&&(i.name===qt.CHROME||i.name===qt.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}var z;(function(i){i.UNEXPECTED_ERROR="UNEXPECTED_ERROR",i.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",i.TIMEOUT="TIMEOUT",i.INVALID_PARAMS="INVALID_PARAMS",i.NOT_READABLE="NOT_READABLE",i.NOT_SUPPORTED="NOT_SUPPORTED",i.INVALID_OPERATION="INVALID_OPERATION",i.OPERATION_ABORTED="OPERATION_ABORTED",i.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",i.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",i.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",i.DATACHANNEL_FAILED="DATACHANNEL_FAILED",i.NETWORK_ERROR="NETWORK_ERROR",i.NETWORK_TIMEOUT="NETWORK_TIMEOUT",i.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",i.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",i.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",i.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",i.ELECTRON_IS_NULL="ELECTRON_IS_NULL",i.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",i.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",i.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",i.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",i.PERMISSION_DENIED="PERMISSION_DENIED",i.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",i.TRACK_IS_DISABLED="TRACK_IS_DISABLED",i.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",i.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",i.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",i.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",i.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",i.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",i.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",i.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",i.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",i.UID_CONFLICT="UID_CONFLICT",i.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",i.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",i.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",i.INVALID_TRACK="INVALID_TRACK",i.SENDER_NOT_FOUND="SENDER_NOT_FOUND",i.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",i.SET_ANSWER_FAILED="SET_ANSWER_FAILED",i.ICE_FAILED="ICE_FAILED",i.PC_CLOSED="PC_CLOSED",i.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",i.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",i.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",i.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",i.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",i.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",i.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",i.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",i.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",i.INVALID_REMOTE_USER="INVALID_REMOTE_USER",i.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",i.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",i.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",i.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",i.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",i.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",i.WS_ABORT="WS_ABORT",i.WS_DISCONNECT="WS_DISCONNECT",i.WS_ERR="WS_ERR",i.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",i.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",i.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",i.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",i.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",i.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",i.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",i.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",i.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",i.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",i.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",i.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",i.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",i.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",i.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",i.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",i.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",i.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",i.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",i.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",i.INVALID_PLUGIN="INVALID_PLUGIN",i.DISCONNECT_P2P="DISCONNECT_P2P",i.INIT_WEBSOCKET_TIMEOUT="INIT_WEBSOCKET_TIMEOUT",i.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",i.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",i.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",i.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",i.PROHIBITED_OPERATION="PROHIBITED_OPERATION",i.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",i.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED"})(z||(z={}));let Te=class extends Error{constructor(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;super(t),w(this,"code",void 0),w(this,"message",void 0),w(this,"data",void 0),w(this,"name","AgoraRTCException"),this.code=i,this.message="AgoraRTCError ".concat(this.code,": ").concat(t),this.data=n}toString(){return this.data?"data: ".concat(JSON.stringify(this.data),`
`).concat(this.stack):"".concat(this.stack)}print(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error",t=arguments.length>1?arguments[1]:void 0;return i==="error"&&(t||console).error(this.toString()),i==="warning"&&(t||console).warn(this.toString()),this}throw(i){throw this.print("error",i),this}};function Gl(i,t){if(typeof i!="boolean")throw new Te(z.INVALID_PARAMS,"Invalid ".concat(t,": The value is of the boolean type."))}function Sr(i,t,n){if(!Be(n).call(n,i))throw new Te(z.INVALID_PARAMS,"".concat(t," can only be set as ").concat(JSON.stringify(n)))}function an(i,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4;if(i<n||i>a||(!(arguments.length>4&&arguments[4]!==void 0)||arguments[4])&&!function(l){return typeof l=="number"&&l%1==0}(i))throw new Te(z.INVALID_PARAMS,"invalid ".concat(t,": the value range is [").concat(n,", ").concat(a,"]. integer only"))}function Wb(i,t){if(typeof i!="number"){if(!(i.min||i.max||i.ideal||i.exact))throw new Te(z.INVALID_PARAMS,"".concat(t," is not a valid ConstrainLong"));i.min!==void 0&&an(i.min,"".concat(t,".min"),0,1/0),i.max!==void 0&&an(i.max,"".concat(t,".max"),1,1/0),i.exact!==void 0&&an(i.exact,"".concat(t,".exact"),1,1/0),i.ideal!==void 0&&an(i.ideal,"".concat(t,".ideal"),1,1/0)}else an(i,t,1,1/0)}function ai(i,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,l=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(i==null)throw new Te(z.INVALID_PARAMS,"".concat(t||"param"," cannot be empty"));if(!Fk(i,n,a,l))throw new Te(z.INVALID_PARAMS,"Invalid ".concat(t||"string param",": Length of the string: [").concat(n,",").concat(a,"].").concat(l?" ASCII characters only.":""))}function Yc(i,t){if(!Array.isArray(i))throw new Te(z.INVALID_PARAMS,"".concat(t," should be an array"))}function Nn(i){return i==null}function Fk(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,a=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof i=="string"&&i.length<=n&&i.length>=t&&(!a||function(l){if(typeof l!="string")return!1;for(let u=0;u<l.length;u+=1){const h=l.charCodeAt(u);if(h<0||h>255)return!1}return!0}(i))}function Uk(i,t,n){if("getBigUint64"in DataView.prototype)return i.getBigUint64(t,n);const a=i.getUint32(t,n),l=i.getUint32(t+4,n),u=+!!n,h=+!n;return BigInt(a*h+l*u)<<BigInt(32)|BigInt(a*u+l*h)}function Bk(i,t,n,a){if("setBigUint64"in DataView.prototype)return i.setBigUint64(t,n,a);const l=Number(n>>BigInt(32)),u=Number(n&BigInt(4294967295));a?(i.setUint32(t+4,l,a),i.setUint32(t,u,a)):(i.setUint32(t,l,a),i.setUint32(t+4,u,a))}var Dh,gv;(function(i){i.COVERED="COVERED",i.POSITION="POSITION",i.SIZE="SIZE",i.STYLE="STYLE"})(Dh||(Dh={})),function(i){i.UNMOUNTED="UNMOUNTED",i.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT"}(gv||(gv={}));const jk=new class{constructor(){w(this,"_clientSize",null),w(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),w(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),w(this,"getStyle",i=>window.getComputedStyle(i,null)),w(this,"checkCssVisibleProperty",i=>{var t;let n=!0;const a=this.getStyle(i),{display:l,visibility:u,opacity:h,filter:p}=a;return(l==="none"||Be(t=["hidden","collapse"]).call(t,u)||Number(h)<.1)&&(n=!1),n?(p&&p.split(" ").filter(v=>{var E;const y=v.split("(")[0];return Be(E=["brightness","blur","opacity"]).call(E,y)}).map(v=>{const[E,y]=v.split(/\(|\)/);return[E,Number(y.match(/^[0-9\.]+/))]}).forEach(v=>{const[E,y]=v;switch(E){case"brightness":(y<.1||y>3)&&(n=!1);break;case"blur":y>3&&(n=!1);break;case"opacity":y<.1&&(n=!1)}}),n):!1}),w(this,"checkPropertyUpToAllParentNodes",(i,t)=>{let n=!0,a=!0;const l=h=>t(h);let u=i;for(;u&&a;)l(u)||(n=!1,a=!1),u=u.parentElement,u||(a=!1);return n}),w(this,"checkActualCssVisibleIncludeInherit",i=>this.checkPropertyUpToAllParentNodes(i,this.checkCssVisibleProperty)),w(this,"getSizeAboutClient",i=>{const{width:t,height:n,left:a,right:l,top:u,bottom:h}=i.getBoundingClientRect(),p=this.getClientWidth(),v=this.getClientHeight();return{width:t,height:n,left:a,right:l,top:u,bottom:h,clientWidth:p,clientHeight:v,clientMin:Math.min(p,v)}}),w(this,"checkActualSize",()=>{const{width:i,height:t,clientMin:n}=this._clientSize;return this.checkSizeIsVisible(i,t,n)}),w(this,"elementFromPoint",(i,t)=>document.elementFromPoint?document.elementFromPoint(i,t):null),w(this,"checkCoverForAPoint",(i,t,n)=>{const a=this.elementFromPoint(i,t);return a!==null&&a!==n}),w(this,"getPointPositionList",()=>{const{width:i,height:t,left:n,top:a}=this._clientSize,l=i/6,u=t/6,h=[],p=10**6;for(let v=0;v<5;v++)for(let E=0;E<5;E++){const y=(n*p+(v===0?.1:v===4?(l*v*p-1e5)/p:l*v)*p)/p,C=(a*p+(E===0?.1:E===4?(u*E*p-1e5)/p:u*E)*p)/p;h.push({x:y,y:C})}return[...h]}),w(this,"checkElementCover",i=>this.getPointPositionList().map(t=>this.checkCoverForAPoint(t.x,t.y,i)).filter(t=>!!t).length>6),w(this,"checkSizeIsVisible",(i,t,n)=>(i>50||n/i<=10)&&(t>50||n/t<=10)),w(this,"checkSizeOfPartInClient",()=>{const{left:i,right:t,top:n,bottom:a,clientHeight:l,clientWidth:u,clientMin:h}=this._clientSize;let p,v,E,y;if(i<0)p=0;else{if(!(i<u))return!1;p=i}if(t<0)return!1;if(v=t<u?t:u,n<0)E=0;else{if(!(n<l))return!1;E=n}if(a<0)return!1;y=a<l?a:l;const C=v-p,I=y-E;return this.checkSizeIsVisible(C,I,h)}),w(this,"returnHiddenResult",i=>(this._clientSize=null,{visible:!1,reason:i})),w(this,"checkOneElementVisible",i=>{if(i instanceof HTMLElement){if(this.checkElementIsMountedOnDom(i)){if(this.checkActualCssVisibleIncludeInherit(i)){if(this._clientSize=this.getSizeAboutClient(i),this.checkElementCover(i))return this.returnHiddenResult(Dh.COVERED);{const t=this.checkActualSize(),n=this.checkSizeOfPartInClient();return t&&!n?this.returnHiddenResult(Dh.POSITION):t?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(Dh.SIZE)}}return this.returnHiddenResult(Dh.STYLE)}return this.returnHiddenResult(gv.UNMOUNTED)}return this.returnHiddenResult(gv.INVALID_HTML_ELEMENT)}),w(this,"checkElementIsMountedOnDom",i=>this.checkPropertyUpToAllParentNodes(i,t=>t.nodeName.toUpperCase()!=="HTML"?t.parentElement!==null:!!document.documentElement))}};function Gb(i){return new TextEncoder().encode(i)}const Vk=function(i,t){const n=new Uint8Array(i.byteLength+t.byteLength);return n.set(new Uint8Array(i),0),n.set(new Uint8Array(t),i.byteLength),n},CZ=async i=>{const t=function(u){const h=window.atob(u),p=new Uint8Array(new ArrayBuffer(h.length));for(let v=0;v<h.length;v+=1)p[v]=h.charCodeAt(v);return p}(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),n=await window.crypto.subtle.importKey("spki",t,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),a=Gb(i),l=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},n,a);return function(u){let h="";for(let p=0;p<u.length;p+=1)h+=String.fromCharCode(u[p]);return window.btoa(h)}(new Uint8Array(l))},zb=async i=>function(t,n){let a="";return new Uint8Array(t).forEach(l=>{a+=l.toString(n).padStart(2,"0")}),a}(await crypto.subtle.digest("SHA-256",Gb(i)),16);class wn{constructor(){w(this,"_events",{}),w(this,"addListener",this.on)}getListeners(t){return this._events[t]?this._events[t].map(n=>n.listener):[]}on(t,n){this._events[t]||(this._events[t]=[]);const a=this._events[t];this._indexOfListener(a,n)===-1&&a.push({listener:n,once:!1})}once(t,n){this._events[t]||(this._events[t]=[]);const a=this._events[t];this._indexOfListener(a,n)===-1&&a.push({listener:n,once:!0})}off(t,n){if(!this._events[t])return;const a=this._events[t],l=this._indexOfListener(a,n);l!==-1&&a.splice(l,1),this._events[t].length===0&&delete this._events[t]}removeAllListeners(t){t?delete this._events[t]:this._events={}}emit(t){this._events[t]||(this._events[t]=[]);const n=this._events[t].map(h=>h);for(var a=arguments.length,l=new Array(a>1?a-1:0),u=1;u<a;u++)l[u-1]=arguments[u];for(let h=0;h<n.length;h+=1){const p=n[h];p.once&&this.off(t,p.listener),p.listener.apply(this,l||[])}}safeEmit(t){for(var n=arguments.length,a=new Array(n>1?n-1:0),l=1;l<n;l++)a[l-1]=arguments[l];[...this._events[t]||[]].forEach(u=>{u.once&&this.off(t,u.listener);try{u.listener.apply(this,a)}catch(h){console.error("safeEmit event:".concat(t," error ").concat(h==null?void 0:h.toString()))}})}_indexOfListener(t,n){let a=t.length;for(;a--;)if(t[a].listener===n)return a;return-1}}let i0=null;function $k(){if(i0)return i0;if(window.electron)return i0=window.electron;if(!window.require)return null;try{return i0=window.require("electron"),i0}catch{return null}}var gr,Pn,Kb,xt,Nt,Mr,Di,qc;function Hk(i){return an(i.timeout,"config.timeout",0,1e5),an(i.timeoutFactor,"config.timeoutFactor",0,100,!1),an(i.maxRetryCount,"config.maxRetryConfig",0,1/0),an(i.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}function kh(i){if(!Array.isArray(i)||i.length<1)return!1;try{i.forEach(t=>{if(!t.urls)throw Error()})}catch{return!1}return!0}function Wk(i){return ai(i.turnServerURL,"turnServerURL"),ai(i.username,"username"),ai(i.password,"password"),i.udpport&&an(i.udpport,"udpport",1,99999,!0),i.forceturn&&Gl(i.forceturn,"forceturn"),i.security&&Gl(i.security,"security"),i.tcpport&&an(i.tcpport,"tcpport",1,99999,!0),!0}function Gk(i){return i.level!==void 0&&Sr(i.level,"level",[1,2,3]),i.delay!==void 0&&an(i.delay,"delay",0,3e3,!0),!0}function cr(i,t){for(var n=arguments.length,a=new Array(n>2?n-2:0),l=2;l<n;l++)a[l-2]=arguments[l];return i.getListeners(t).length===0?_e.reject(new Te(z.UNEXPECTED_ERROR,"can not emit promise")):new _e((u,h)=>{i.emit(t,...a,u,h)})}function hn(i,t){if(i.getListeners(t).length===0)return _e.resolve();for(var n=arguments.length,a=new Array(n>2?n-2:0),l=2;l<n;l++)a[l-2]=arguments[l];return cr(i,t,...a)}function No(i,t){if(i.getListeners(t).length===0)return null;for(var n=arguments.length,a=new Array(n>2?n-2:0),l=2;l<n;l++)a[l-2]=arguments[l];return sd(i,t,...a)}function sd(i,t){let n=null,a=null;for(var l=arguments.length,u=new Array(l>2?l-2:0),h=2;h<l;h++)u[h-2]=arguments[h];if(i.emit(t,...u,p=>{n=p},p=>{a=p}),a!==null)throw a;if(n===null)throw new Te(z.UNEXPECTED_ERROR,"handler is not sync");return n}(function(i){i.CREATE_CLIENT="createClient",i.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",i.SET_AREA="setArea",i.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",i.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",i.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",i.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",i.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",i.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",i.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",i.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",i.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",i.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",i.START_PROXY_SERVER="Client.startProxyServer",i.STOP_PROXY_SERVER="Client.stopProxyServer",i.SET_PROXY_SERVER="Client.setProxyServer",i.SET_TURN_SERVER="Client.setTurnServer",i.SET_CLIENT_ROLE="Client.setClientRole",i.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",i.ENABLE_DUAL_STREAM="Client.enableDualStream",i.DISABLE_DUAL_STREAM="Client.disableDualStream",i.JOIN="Client.join",i.LEAVE="Client.leave",i.PUBLISH="Client.publish",i.UNPUBLISH="Client.unpublish",i.SUBSCRIBE="Client.subscribe",i.MASS_SUBSCRIBE="Client.massSubscribe",i.MASS_UNSUBSCRIBE="Client.massUnsubscribe",i.UNSUBSCRIBE="Client.unsubscribe",i.RENEW_TOKEN="Client.renewToken",i.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",i.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",i.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",i.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",i.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",i.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",i.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",i.DATACHANNEL_FAILBACK="Client._datachannelFailback",i.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",i.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",i.START_LIVE_STREAMING="Client.startLiveStreaming",i.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",i.STOP_LIVE_STREAMING="Client.stopLiveStreaming",i.ADD_INJECT_STREAM_URL="Client.addInjectStreamUrl",i.REMOVE_INJECT_STREAM_URL="Client.removeInjectStreamUrl",i.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",i.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",i.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",i.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",i.SET_CONFIG_DISTRIBUTE="_configDistribute",i.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",i.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",i.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",i.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",i.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",i.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",i.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",i.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",i.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",i.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",i.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",i.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",i.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",i.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",i.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",i.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",i.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",i.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",i.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",i.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",i.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",i.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",i.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",i.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",i.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",i.STREAM_TYPE_CHANGE="streamTypeChange",i.CONNECTION_STATE_CHANGE="connectionStateChange",i.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",i.IMAGE_MODERATION_UPLOAD="imageModerationUpload"})(gr||(gr={})),function(i){i.TRACER="tracer"}(Pn||(Pn={})),function(i){i[i.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",i[i.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",i[i.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY"}(Kb||(Kb={})),function(i){i.LEAVE="LEAVE",i.NETWORK_ERROR="NETWORK_ERROR",i.SERVER_ERROR="SERVER_ERROR",i.UID_BANNED="UID_BANNED",i.IP_BANNED="IP_BANNED",i.CHANNEL_BANNED="CHANNEL_BANNED",i.FALLBACK="FALLBACK",i.LICENSE_MISSING="LICENSE_MISSING",i.LICENSE_EXPIRED="LICENSE_EXPIRED",i.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",i.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",i.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",i.LICENSE_ILLEGAL="LICENSE_ILLEGAL",i.TOKEN_EXPIRE="TOKEN_EXPIRE"}(xt||(xt={})),function(i){i.CONNECTION_STATE_CHANGE="connection-state-change",i.MEDIA_RECONNECT_START="media-reconnect-start",i.MEDIA_RECONNECT_END="media-reconnect-end",i.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",i.USER_JOINED="user-joined",i.USER_LEAVED="user-left",i.USER_PUBLISHED="user-published",i.USER_UNPUBLISHED="user-unpublished",i.USER_INFO_UPDATED="user-info-updated",i.CLIENT_BANNED="client-banned",i.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",i.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",i.VOLUME_INDICATOR="volume-indicator",i.CRYPT_ERROR="crypt-error",i.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",i.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",i.NETWORK_QUALITY="network-quality",i.STREAM_TYPE_CHANGED="stream-type-changed",i.STREAM_FALLBACK="stream-fallback",i.RECEIVE_METADATA="receive-metadata",i.STREAM_MESSAGE="stream-message",i.LIVE_STREAMING_ERROR="live-streaming-error",i.LIVE_STREAMING_WARNING="live-streaming-warning",i.INJECT_STREAM_STATUS="stream-inject-status",i.EXCEPTION="exception",i.ERROR="error",i.P2P_LOST="p2p_lost",i.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",i.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",i.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",i.PUBLISHED_USER_LIST="published-user-list",i.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",i.CONTENT_INSPECT_ERROR="content-inspect-error",i.CONTENT_INSPECT_RESULT="content-inspect-result",i.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change"}(Nt||(Nt={})),function(i){i.NETWORK_ERROR="NETWORK_ERROR",i.SERVER_ERROR="SERVER_ERROR",i.MULTI_IP="MULTI_IP",i.TIMEOUT="TIMEOUT",i.OFFLINE="OFFLINE",i.LEAVE="LEAVE",i.P2P_FAILED="P2P_FAILED",i.FALLBACK="FALLBACK"}(Mr||(Mr={})),function(i){i.ONLINE="ONLINE",i.OFFLINE="OFFLINE"}(Di||(Di={})),function(i){i.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",i.ONLINE="ONLINE",i.OFFLINE="OFFLINE"}(qc||(qc={}));const lr=new class extends wn{set networkState(i){this.emit(qc.NETWORK_STATE_CHANGE,i,this._networkState),i===Di.ONLINE?this.emit(qc.ONLINE):i===Di.OFFLINE&&(this.onlineWaiter=new _e(t=>{this.once(qc.ONLINE,()=>{this.onlineWaiter=void 0,t(Di.ONLINE)})}),this.emit(qc.OFFLINE)),this._networkState=i}get networkState(){return this._networkState}get isOnline(){return this._networkState===Di.ONLINE}constructor(){super(),w(this,"_moduleName","network-indicator"),w(this,"_networkState",Di.ONLINE),w(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=Di.ONLINE}),window.addEventListener("offline",()=>{this.networkState=Di.OFFLINE})}};function zk(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function cd(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zk(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):zk(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}function vv(i,t){const n=i.indexOf(t);n!==-1&&i.splice(n,1)}function Lh(i){const t=[];return i.forEach(n=>{t.indexOf(n)===-1&&t.push(n)}),t}function Ev(i){_e!==void 0?_e.resolve().then(i):setTimeout(i,0)}function fn(i){return JSON.parse(JSON.stringify(i))}function ld(i){try{return fn(i)}catch{return i}}const Kk={};function o0(i,t){Kk[t]||(Kk[t]=!0,i())}function _v(i){const t=window.atob(i),n=new Uint8Array(new ArrayBuffer(t.length));for(let a=0;a<t.length;a+=1)n[a]=t.charCodeAt(a);return n}function Mh(i){let t="";for(let n=0;n<i.length;n+=1)t+=String.fromCharCode(i[n]);return window.btoa(t)}function Ec(i){return window.TextEncoder?new TextEncoder().encode(i).length:i.length}function Yk(i){let t=0;return/DingTalk/i.test(navigator.userAgent)&&i.realFormData&&(i=i.realFormData),i.forEach(n=>{t+=typeof n=="string"?Ec(n):n.size}),t+138}function bZ(i){const t=new Te(z.TIMEOUT,"timeout");return new _e((n,a)=>{window.setTimeout(()=>a(t),i)})}function Fr(i){return new _e(t=>{window.setTimeout(t,i)})}function pn(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,t=arguments.length>1?arguments[1]:void 0;const n=Math.random().toString(16).substr(2,i).toLowerCase();return n.length===i?"".concat(t).concat(n):"".concat(t).concat(n)+pn(i-n.length,"")}function Yb(){return pn(32,"").toUpperCase()}const yv=()=>{},qk=new class{constructor(){w(this,"fnMap",new Map)}throttleByKey(i,t,n,a){for(var l=arguments.length,u=new Array(l>4?l-4:0),h=4;h<l;h++)u[h-4]=arguments[h];if(this.fnMap.has(t)){const p=this.fnMap.get(t);if(p.threshold!==n){p.fn(...p.args),clearTimeout(p.timer);const v=window.setTimeout(()=>{const E=this.fnMap.get(t);E&&E.fn(...E.args),this.fnMap.delete(t)},n);this.fnMap.set(t,{fn:i,threshold:n,timer:v,args:u,skipFn:a})}else p.skipFn&&p.skipFn(...p.args),this.fnMap.set(t,cd(cd({},p),{},{fn:i,args:u,skipFn:a}))}else{const p=window.setTimeout(()=>{const v=this.fnMap.get(t);v&&v.fn(...v.args),this.fnMap.delete(t)},n);this.fnMap.set(t,{fn:i,threshold:n,timer:p,args:u,skipFn:a})}}},Xk=qk.throttleByKey.bind(qk);function Jk(i){return typeof i=="object"&&i!==null&&!(i instanceof RegExp)}function qb(i,t){if(!Jk(i)||!Jk(t)||Array.isArray(i)&&!Array.isArray(t)||!Array.isArray(i)&&Array.isArray(t))return t;if(Array.isArray(t)&&Array.isArray(i)){const n=[...i];for(let a=0;a<t.length;a++)n[a]=qb(i[a],t[a]);return n}{const n=cd({},i);for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&(Object.prototype.hasOwnProperty.call(i,a)?n[a]=qb(i[a],t[a]):n[a]=t[a]);return n}}let TZ=1,Sv=console;class Ur{static setLogger(t){Sv=t}constructor(t){w(this,"lockingPromise",_e.resolve()),w(this,"locks",0),w(this,"name",""),w(this,"lockId",void 0),this.lockId=TZ++,t&&(this.name=t),Sv.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock(t){let n;this.locks+=1,Sv.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is locked, current queue ").concat(this.locks,". ").concat(typeof t=="string"?t:""));const a=new _e(u=>{n=()=>{this.locks-=1,Sv.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is not locked, current queue ").concat(this.locks,". ").concat(typeof t=="string"?t:"")),u()}}),l=this.lockingPromise.then(()=>n);return this.lockingPromise=this.lockingPromise.then(()=>a),l}}function Fh(i,t){return function(n,a,l){const u=l.value;if(typeof u!="function")throw new Error("Cannot use mutex on object property.");return l.value=async function(){const h=this[t];if(!h)throw new Error("mutex property key ".concat(t," doesn't exist on ").concat(i));const p=await h.lock("From ".concat(i,".").concat(a));try{for(var v=arguments.length,E=new Array(v),y=0;y<v;y++)E[y]=arguments[y];return await u.apply(this,E)}finally{p()}},l}}const ur={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function Cv(i,t){const n=Math.floor(t.timeout*Math.pow(t.timeoutFactor,i));return Math.min(t.maxRetryTimeout,n)}function Ds(i,t,n,a){const l=Object.assign({},ur,a);let u=l.timeout;const h=async()=>{await function(E){return new _e(y=>{window.setTimeout(y,E)})}(u),u*=l.timeoutFactor,u=Math.min(l.maxRetryTimeout,u)};let p=!1;const v=new _e(async(E,y)=>{t=t||(()=>!1),n=n||(()=>!0);for(let C=0;C<l.maxRetryCount;C+=1){if(p)return y(new Te(z.OPERATION_ABORTED));try{const I=await i();if(!t(I,C)||C+1===l.maxRetryCount)return E(I);await h()}catch(I){if(!n(I,C)||C+1===l.maxRetryCount)return y(I);await h()}}});return v.cancel=()=>p=!0,v}var RZ=Yn,wZ=xi,IZ=Ct,AZ=Zu,OZ=TypeError,Qk=function(i){return function(t,n,a,l){RZ(n);var u=wZ(t),h=IZ(u),p=AZ(u),v=i?p-1:0,E=i?-1:1;if(a<2)for(;;){if(v in h){l=h[v],v+=E;break}if(v+=E,i?v<0:p<=v)throw OZ("Reduce of empty array with no initial value")}for(;i?v>=0:p>v;v+=E)v in h&&(l=n(l,h[v],v,u));return l}},xZ={left:Qk(!1),right:Qk(!0)}.left;jn({target:"Array",proto:!0,forced:!qf&&on>79&&on<83||!cb("reduce")},{reduce:function(i){var t=arguments.length;return xZ(this,i,t,t>1?arguments[1]:void 0)}});var NZ=Bl("Array").reduce,PZ=R,DZ=NZ,Xb=Array.prototype,ud=c(function(i){var t=i.reduce;return i===Xb||PZ(Xb,i)&&t===Xb.reduce?DZ:t});let Jb=class{constructor(i){w(this,"input",[]),w(this,"size",void 0),this.size=i}add(i){this.input.push(i),this.input.length>this.size&&this.input.splice(0,1)}mean(){var i;return this.input.length===0?0:ud(i=this.input).call(i,(t,n)=>t+n)/this.input.length}};var Qb,Zb={exports:{}},Zk=function(i,t){return function(){for(var n=new Array(arguments.length),a=0;a<n.length;a++)n[a]=arguments[a];return i.apply(t,n)}},kZ=Zk,eT=Object.prototype.toString,tT=(Qb=Object.create(null),function(i){var t=eT.call(i);return Qb[t]||(Qb[t]=t.slice(8,-1).toLowerCase())});function dd(i){return i=i.toLowerCase(),function(t){return tT(t)===i}}function nT(i){return Array.isArray(i)}function bv(i){return i===void 0}var eL=dd("ArrayBuffer");function tL(i){return i!==null&&typeof i=="object"}function Tv(i){if(tT(i)!=="object")return!1;var t=Object.getPrototypeOf(i);return t===null||t===Object.prototype}var LZ=dd("Date"),MZ=dd("File"),FZ=dd("Blob"),UZ=dd("FileList");function rT(i){return eT.call(i)==="[object Function]"}var BZ=dd("URLSearchParams");function iT(i,t){if(i!=null)if(typeof i!="object"&&(i=[i]),nT(i))for(var n=0,a=i.length;n<a;n++)t.call(null,i[n],n,i);else for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&t.call(null,i[l],l,i)}var oT,jZ=(oT=typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array),function(i){return oT&&i instanceof oT}),Qi={isArray:nT,isArrayBuffer:eL,isBuffer:function(i){return i!==null&&!bv(i)&&i.constructor!==null&&!bv(i.constructor)&&typeof i.constructor.isBuffer=="function"&&i.constructor.isBuffer(i)},isFormData:function(i){var t="[object FormData]";return i&&(typeof FormData=="function"&&i instanceof FormData||eT.call(i)===t||rT(i.toString)&&i.toString()===t)},isArrayBufferView:function(i){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(i):i&&i.buffer&&eL(i.buffer)},isString:function(i){return typeof i=="string"},isNumber:function(i){return typeof i=="number"},isObject:tL,isPlainObject:Tv,isUndefined:bv,isDate:LZ,isFile:MZ,isBlob:FZ,isFunction:rT,isStream:function(i){return tL(i)&&rT(i.pipe)},isURLSearchParams:BZ,isStandardBrowserEnv:function(){return(typeof navigator>"u"||navigator.product!=="ReactNative"&&navigator.product!=="NativeScript"&&navigator.product!=="NS")&&typeof window<"u"&&typeof document<"u"},forEach:iT,merge:function i(){var t={};function n(u,h){Tv(t[h])&&Tv(u)?t[h]=i(t[h],u):Tv(u)?t[h]=i({},u):nT(u)?t[h]=u.slice():t[h]=u}for(var a=0,l=arguments.length;a<l;a++)iT(arguments[a],n);return t},extend:function(i,t,n){return iT(t,function(a,l){i[l]=n&&typeof a=="function"?kZ(a,n):a}),i},trim:function(i){return i.trim?i.trim():i.replace(/^\s+|\s+$/g,"")},stripBOM:function(i){return i.charCodeAt(0)===65279&&(i=i.slice(1)),i},inherits:function(i,t,n,a){i.prototype=Object.create(t.prototype,a),i.prototype.constructor=i,n&&Object.assign(i.prototype,n)},toFlatObject:function(i,t,n){var a,l,u,h={};t=t||{};do{for(l=(a=Object.getOwnPropertyNames(i)).length;l-- >0;)h[u=a[l]]||(t[u]=i[u],h[u]=!0);i=Object.getPrototypeOf(i)}while(i&&(!n||n(i,t))&&i!==Object.prototype);return t},kindOf:tT,kindOfTest:dd,endsWith:function(i,t,n){i=String(i),(n===void 0||n>i.length)&&(n=i.length),n-=t.length;var a=i.indexOf(t,n);return a!==-1&&a===n},toArray:function(i){if(!i)return null;var t=i.length;if(bv(t))return null;for(var n=new Array(t);t-- >0;)n[t]=i[t];return n},isTypedArray:jZ,isFileList:UZ},Uh=Qi;function nL(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var rL=function(i,t,n){if(!t)return i;var a;if(n)a=n(t);else if(Uh.isURLSearchParams(t))a=t.toString();else{var l=[];Uh.forEach(t,function(h,p){h!=null&&(Uh.isArray(h)?p+="[]":h=[h],Uh.forEach(h,function(v){Uh.isDate(v)?v=v.toISOString():Uh.isObject(v)&&(v=JSON.stringify(v)),l.push(nL(p)+"="+nL(v))}))}),a=l.join("&")}if(a){var u=i.indexOf("#");u!==-1&&(i=i.slice(0,u)),i+=(i.indexOf("?")===-1?"?":"&")+a}return i},VZ=Qi;function Rv(){this.handlers=[]}Rv.prototype.use=function(i,t,n){return this.handlers.push({fulfilled:i,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},Rv.prototype.eject=function(i){this.handlers[i]&&(this.handlers[i]=null)},Rv.prototype.forEach=function(i){VZ.forEach(this.handlers,function(t){t!==null&&i(t)})};var iL,oL,$Z=Rv,HZ=Qi;function Bh(){if(oL)return iL;oL=1;var i=Qi;function t(l,u,h,p,v){Error.call(this),this.message=l,this.name="AxiosError",u&&(this.code=u),h&&(this.config=h),p&&(this.request=p),v&&(this.response=v)}i.inherits(t,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var n=t.prototype,a={};return["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(l){a[l]={value:l}}),Object.defineProperties(t,a),Object.defineProperty(n,"isAxiosError",{value:!0}),t.from=function(l,u,h,p,v,E){var y=Object.create(n);return i.toFlatObject(l,y,function(C){return C!==Error.prototype}),t.call(y,l.message,u,h,p,v),y.name=l.name,E&&Object.assign(y,E),y},iL=t}var aT,aL,sL,cL,sT,lL,uL={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};function dL(){if(aL)return aT;aL=1;var i=Qi;return aT=function(t,n){n=n||new FormData;var a=[];function l(u){return u===null?"":i.isDate(u)?u.toISOString():i.isArrayBuffer(u)||i.isTypedArray(u)?typeof Blob=="function"?new Blob([u]):Buffer.from(u):u}return function u(h,p){if(i.isPlainObject(h)||i.isArray(h)){if(a.indexOf(h)!==-1)throw Error("Circular reference detected in "+p);a.push(h),i.forEach(h,function(v,E){if(!i.isUndefined(v)){var y,C=p?p+"."+E:E;if(v&&!p&&typeof v=="object"){if(i.endsWith(E,"{}"))v=JSON.stringify(v);else if(i.endsWith(E,"[]")&&(y=i.toArray(v)))return void y.forEach(function(I){!i.isUndefined(I)&&n.append(C,l(I))})}u(v,C)}}),a.pop()}else n.append(p,l(h))}(t),n},aT}function WZ(){if(cL)return sL;cL=1;var i=Bh();return sL=function(t,n,a){var l=a.config.validateStatus;a.status&&l&&!l(a.status)?n(new i("Request failed with status code "+a.status,[i.ERR_BAD_REQUEST,i.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a)):t(a)}}function GZ(){if(lL)return sT;lL=1;var i=Qi;return sT=i.isStandardBrowserEnv()?{write:function(t,n,a,l,u,h){var p=[];p.push(t+"="+encodeURIComponent(n)),i.isNumber(a)&&p.push("expires="+new Date(a).toGMTString()),i.isString(l)&&p.push("path="+l),i.isString(u)&&p.push("domain="+u),h===!0&&p.push("secure"),document.cookie=p.join("; ")},read:function(t){var n=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},sT}var cT,hL,pL,fL,mL,gL,vL,EL,lT,_L,yL,SL,zZ=function(i){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(i)},KZ=function(i,t){return t?i.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):i},CL=function(i,t){return i&&!zZ(t)?KZ(i,t):t};function YZ(){if(hL)return cT;hL=1;var i=Qi,t=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return cT=function(n){var a,l,u,h={};return n&&i.forEach(n.split(`
`),function(p){if(u=p.indexOf(":"),a=i.trim(p.substr(0,u)).toLowerCase(),l=i.trim(p.substr(u+1)),a){if(h[a]&&t.indexOf(a)>=0)return;h[a]=a==="set-cookie"?(h[a]?h[a]:[]).concat([l]):h[a]?h[a]+", "+l:l}}),h},cT}function qZ(){if(fL)return pL;fL=1;var i=Qi;return pL=i.isStandardBrowserEnv()?function(){var t,n=/(msie|trident)/i.test(navigator.userAgent),a=document.createElement("a");function l(u){var h=u;return n&&(a.setAttribute("href",h),h=a.href),a.setAttribute("href",h),{href:a.href,protocol:a.protocol?a.protocol.replace(/:$/,""):"",host:a.host,search:a.search?a.search.replace(/^\?/,""):"",hash:a.hash?a.hash.replace(/^#/,""):"",hostname:a.hostname,port:a.port,pathname:a.pathname.charAt(0)==="/"?a.pathname:"/"+a.pathname}}return t=l(window.location.href),function(u){var h=i.isString(u)?l(u):u;return h.protocol===t.protocol&&h.host===t.host}}():function(){return!0}}function wv(){if(gL)return mL;gL=1;var i=Bh();function t(n){i.call(this,n??"canceled",i.ERR_CANCELED),this.name="CanceledError"}return Qi.inherits(t,i,{__CANCEL__:!0}),mL=t}function XZ(){return EL||(EL=1,vL=function(i){var t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(i);return t&&t[1]||""}),vL}function JZ(){if(_L)return lT;_L=1;var i=Qi,t=WZ(),n=GZ(),a=rL,l=CL,u=YZ(),h=qZ(),p=uL,v=Bh(),E=wv(),y=XZ();return lT=function(C){return new Promise(function(I,k){var G,B=C.data,j=C.headers,q=C.responseType;function Z(){C.cancelToken&&C.cancelToken.unsubscribe(G),C.signal&&C.signal.removeEventListener("abort",G)}i.isFormData(B)&&i.isStandardBrowserEnv()&&delete j["Content-Type"];var re=new XMLHttpRequest;if(C.auth){var Ce=C.auth.username||"",pe=C.auth.password?unescape(encodeURIComponent(C.auth.password)):"";j.Authorization="Basic "+btoa(Ce+":"+pe)}var fe=l(C.baseURL,C.url);function ye(){if(re){var Ne="getAllResponseHeaders"in re?u(re.getAllResponseHeaders()):null,it={data:q&&q!=="text"&&q!=="json"?re.response:re.responseText,status:re.status,statusText:re.statusText,headers:Ne,config:C,request:re};t(function(yt){I(yt),Z()},function(yt){k(yt),Z()},it),re=null}}if(re.open(C.method.toUpperCase(),a(fe,C.params,C.paramsSerializer),!0),re.timeout=C.timeout,"onloadend"in re?re.onloadend=ye:re.onreadystatechange=function(){re&&re.readyState===4&&(re.status!==0||re.responseURL&&re.responseURL.indexOf("file:")===0)&&setTimeout(ye)},re.onabort=function(){re&&(k(new v("Request aborted",v.ECONNABORTED,C,re)),re=null)},re.onerror=function(){k(new v("Network Error",v.ERR_NETWORK,C,re,re)),re=null},re.ontimeout=function(){var Ne=C.timeout?"timeout of "+C.timeout+"ms exceeded":"timeout exceeded",it=C.transitional||p;C.timeoutErrorMessage&&(Ne=C.timeoutErrorMessage),k(new v(Ne,it.clarifyTimeoutError?v.ETIMEDOUT:v.ECONNABORTED,C,re)),re=null},i.isStandardBrowserEnv()){var Ee=(C.withCredentials||h(fe))&&C.xsrfCookieName?n.read(C.xsrfCookieName):void 0;Ee&&(j[C.xsrfHeaderName]=Ee)}"setRequestHeader"in re&&i.forEach(j,function(Ne,it){B===void 0&&it.toLowerCase()==="content-type"?delete j[it]:re.setRequestHeader(it,Ne)}),i.isUndefined(C.withCredentials)||(re.withCredentials=!!C.withCredentials),q&&q!=="json"&&(re.responseType=C.responseType),typeof C.onDownloadProgress=="function"&&re.addEventListener("progress",C.onDownloadProgress),typeof C.onUploadProgress=="function"&&re.upload&&re.upload.addEventListener("progress",C.onUploadProgress),(C.cancelToken||C.signal)&&(G=function(Ne){re&&(k(!Ne||Ne&&Ne.type?new E:Ne),re.abort(),re=null)},C.cancelToken&&C.cancelToken.subscribe(G),C.signal&&(C.signal.aborted?G():C.signal.addEventListener("abort",G))),B||(B=null);var Ae=y(fe);Ae&&["http","https","file"].indexOf(Ae)===-1?k(new v("Unsupported protocol "+Ae+":",v.ERR_BAD_REQUEST,C)):re.send(B)})},lT}var Vi=Qi,bL=function(i,t){HZ.forEach(i,function(n,a){a!==t&&a.toUpperCase()===t.toUpperCase()&&(i[t]=n,delete i[a])})},TL=Bh(),QZ=uL,ZZ=dL(),eee={"Content-Type":"application/x-www-form-urlencoded"};function RL(i,t){!Vi.isUndefined(i)&&Vi.isUndefined(i["Content-Type"])&&(i["Content-Type"]=t)}var wL,Iv={transitional:QZ,adapter:((typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(wL=JZ()),wL),transformRequest:[function(i,t){if(bL(t,"Accept"),bL(t,"Content-Type"),Vi.isFormData(i)||Vi.isArrayBuffer(i)||Vi.isBuffer(i)||Vi.isStream(i)||Vi.isFile(i)||Vi.isBlob(i))return i;if(Vi.isArrayBufferView(i))return i.buffer;if(Vi.isURLSearchParams(i))return RL(t,"application/x-www-form-urlencoded;charset=utf-8"),i.toString();var n,a=Vi.isObject(i),l=t&&t["Content-Type"];if((n=Vi.isFileList(i))||a&&l==="multipart/form-data"){var u=this.env&&this.env.FormData;return ZZ(n?{"files[]":i}:i,u&&new u)}return a||l==="application/json"?(RL(t,"application/json"),function(h,p,v){if(Vi.isString(h))try{return(p||JSON.parse)(h),Vi.trim(h)}catch(E){if(E.name!=="SyntaxError")throw E}return(v||JSON.stringify)(h)}(i)):i}],transformResponse:[function(i){var t=this.transitional||Iv.transitional,n=t&&t.silentJSONParsing,a=t&&t.forcedJSONParsing,l=!n&&this.responseType==="json";if(l||a&&Vi.isString(i)&&i.length)try{return JSON.parse(i)}catch(u){if(l)throw u.name==="SyntaxError"?TL.from(u,TL.ERR_BAD_RESPONSE,this,null,this.response):u}return i}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:SL?yL:(SL=1,yL=null)},validateStatus:function(i){return i>=200&&i<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Vi.forEach(["delete","get","head"],function(i){Iv.headers[i]={}}),Vi.forEach(["post","put","patch"],function(i){Iv.headers[i]=Vi.merge(eee)});var IL,AL,uT=Iv,tee=Qi,nee=uT;function OL(){return AL?IL:(AL=1,IL=function(i){return!(!i||!i.__CANCEL__)})}var xL=Qi,dT=function(i,t,n){var a=this||nee;return tee.forEach(n,function(l){i=l.call(a,i,t)}),i},ree=OL(),iee=uT,oee=wv();function hT(i){if(i.cancelToken&&i.cancelToken.throwIfRequested(),i.signal&&i.signal.aborted)throw new oee}var NL,PL,ba=Qi,DL=function(i,t){t=t||{};var n={};function a(E,y){return ba.isPlainObject(E)&&ba.isPlainObject(y)?ba.merge(E,y):ba.isPlainObject(y)?ba.merge({},y):ba.isArray(y)?y.slice():y}function l(E){return ba.isUndefined(t[E])?ba.isUndefined(i[E])?void 0:a(void 0,i[E]):a(i[E],t[E])}function u(E){if(!ba.isUndefined(t[E]))return a(void 0,t[E])}function h(E){return ba.isUndefined(t[E])?ba.isUndefined(i[E])?void 0:a(void 0,i[E]):a(void 0,t[E])}function p(E){return E in t?a(i[E],t[E]):E in i?a(void 0,i[E]):void 0}var v={url:u,method:u,data:u,baseURL:h,transformRequest:h,transformResponse:h,paramsSerializer:h,timeout:h,timeoutMessage:h,withCredentials:h,adapter:h,responseType:h,xsrfCookieName:h,xsrfHeaderName:h,onUploadProgress:h,onDownloadProgress:h,decompress:h,maxContentLength:h,maxBodyLength:h,beforeRedirect:h,transport:h,httpAgent:h,httpsAgent:h,cancelToken:h,socketPath:h,responseEncoding:h,validateStatus:p};return ba.forEach(Object.keys(i).concat(Object.keys(t)),function(E){var y=v[E]||l,C=y(E);ba.isUndefined(C)&&y!==p||(n[E]=C)}),n};function kL(){return PL?NL:(PL=1,NL={version:"0.27.2"})}var aee=kL().version,zl=Bh(),pT={};["object","boolean","number","function","string","symbol"].forEach(function(i,t){pT[i]=function(n){return typeof n===i||"a"+(t<1?"n ":" ")+i}});var LL={};pT.transitional=function(i,t,n){function a(l,u){return"[Axios v"+aee+"] Transitional option '"+l+"'"+u+(n?". "+n:"")}return function(l,u,h){if(i===!1)throw new zl(a(u," has been removed"+(t?" in "+t:"")),zl.ERR_DEPRECATED);return t&&!LL[u]&&(LL[u]=!0,console.warn(a(u," has been deprecated since v"+t+" and will be removed in the near future"))),!i||i(l,u,h)}};var ML,FL,UL,BL,jL,VL,see={assertOptions:function(i,t,n){if(typeof i!="object")throw new zl("options must be an object",zl.ERR_BAD_OPTION_VALUE);for(var a=Object.keys(i),l=a.length;l-- >0;){var u=a[l],h=t[u];if(h){var p=i[u],v=p===void 0||h(p,u,i);if(v!==!0)throw new zl("option "+u+" must be "+v,zl.ERR_BAD_OPTION_VALUE)}else if(n!==!0)throw new zl("Unknown option "+u,zl.ERR_BAD_OPTION)}},validators:pT},$L=Qi,cee=rL,HL=$Z,WL=function(i){return hT(i),i.headers=i.headers||{},i.data=dT.call(i,i.data,i.headers,i.transformRequest),i.headers=xL.merge(i.headers.common||{},i.headers[i.method]||{},i.headers),xL.forEach(["delete","get","head","post","put","patch","common"],function(t){delete i.headers[t]}),(i.adapter||iee.adapter)(i).then(function(t){return hT(i),t.data=dT.call(i,t.data,t.headers,i.transformResponse),t},function(t){return ree(t)||(hT(i),t&&t.response&&(t.response.data=dT.call(i,t.response.data,t.response.headers,i.transformResponse))),Promise.reject(t)})},Av=DL,lee=CL,GL=see,jh=GL.validators;function Vh(i){this.defaults=i,this.interceptors={request:new HL,response:new HL}}Vh.prototype.request=function(i,t){typeof i=="string"?(t=t||{}).url=i:t=i||{},(t=Av(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var n=t.transitional;n!==void 0&&GL.assertOptions(n,{silentJSONParsing:jh.transitional(jh.boolean),forcedJSONParsing:jh.transitional(jh.boolean),clarifyTimeoutError:jh.transitional(jh.boolean)},!1);var a=[],l=!0;this.interceptors.request.forEach(function(C){typeof C.runWhen=="function"&&C.runWhen(t)===!1||(l=l&&C.synchronous,a.unshift(C.fulfilled,C.rejected))});var u,h=[];if(this.interceptors.response.forEach(function(C){h.push(C.fulfilled,C.rejected)}),!l){var p=[WL,void 0];for(Array.prototype.unshift.apply(p,a),p=p.concat(h),u=Promise.resolve(t);p.length;)u=u.then(p.shift(),p.shift());return u}for(var v=t;a.length;){var E=a.shift(),y=a.shift();try{v=E(v)}catch(C){y(C);break}}try{u=WL(v)}catch(C){return Promise.reject(C)}for(;h.length;)u=u.then(h.shift(),h.shift());return u},Vh.prototype.getUri=function(i){i=Av(this.defaults,i);var t=lee(i.baseURL,i.url);return cee(t,i.params,i.paramsSerializer)},$L.forEach(["delete","get","head","options"],function(i){Vh.prototype[i]=function(t,n){return this.request(Av(n||{},{method:i,url:t,data:(n||{}).data}))}}),$L.forEach(["post","put","patch"],function(i){function t(n){return function(a,l,u){return this.request(Av(u||{},{method:i,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}Vh.prototype[i]=t(),Vh.prototype[i+"Form"]=t(!0)});var zL=Qi,uee=Zk,Ov=Vh,dee=DL,Ko=function i(t){var n=new Ov(t),a=uee(Ov.prototype.request,n);return zL.extend(a,Ov.prototype,n),zL.extend(a,n),a.create=function(l){return i(dee(t,l))},a}(uT);Ko.Axios=Ov,Ko.CanceledError=wv(),Ko.CancelToken=function(){if(FL)return ML;FL=1;var i=wv();function t(n){if(typeof n!="function")throw new TypeError("executor must be a function.");var a;this.promise=new Promise(function(u){a=u});var l=this;this.promise.then(function(u){if(l._listeners){var h,p=l._listeners.length;for(h=0;h<p;h++)l._listeners[h](u);l._listeners=null}}),this.promise.then=function(u){var h,p=new Promise(function(v){l.subscribe(v),h=v}).then(u);return p.cancel=function(){l.unsubscribe(h)},p},n(function(u){l.reason||(l.reason=new i(u),a(l.reason))})}return t.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},t.prototype.subscribe=function(n){this.reason?n(this.reason):this._listeners?this._listeners.push(n):this._listeners=[n]},t.prototype.unsubscribe=function(n){if(this._listeners){var a=this._listeners.indexOf(n);a!==-1&&this._listeners.splice(a,1)}},t.source=function(){var n;return{token:new t(function(a){n=a}),cancel:n}},ML=t}(),Ko.isCancel=OL(),Ko.VERSION=kL().version,Ko.toFormData=dL(),Ko.AxiosError=Bh(),Ko.Cancel=Ko.CanceledError,Ko.all=function(i){return Promise.all(i)},Ko.spread=BL?UL:(BL=1,UL=function(i){return function(t){return i.apply(null,t)}}),Ko.isAxiosError=function(){if(VL)return jL;VL=1;var i=Qi;return jL=function(t){return i.isObject(t)&&t.isAxiosError===!0}}(),Zb.exports=Ko,Zb.exports.default=Ko;var ho=c(Zb.exports);function KL(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function YL(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?KL(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):KL(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}let xv,Nv=0,fT=0;function mT(i,t,n,a){return new _e((l,u)=>{t.responseType=t.responseType||"json",t.data&&!n?(t.data=JSON.stringify(t.data),Nv+=Ec(t.data)):n&&(t.data.size?Nv+=t.data.size:t.data instanceof FormData?Nv+=Yk(t.data):Nv+=Ec(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=i,ho.request(t).then(h=>{typeof h.data=="string"?fT+=Ec(h.data):h.data instanceof ArrayBuffer||h.data instanceof Uint8Array?fT+=h.data.byteLength:fT+=Ec(JSON.stringify(h.data)),a&&l({data:h.data,headers:h.headers}),l(h.data)}).catch(h=>{ho.isCancel(h)?u(new Te(z.OPERATION_ABORTED,"cancel token canceled")):h.code==="ECONNABORTED"?u(new Te(z.NETWORK_TIMEOUT,h.message)):h.response?u(new Te(z.NETWORK_RESPONSE_ERROR,h.response.status)):u(new Te(z.NETWORK_ERROR,h.message))})})}async function hee(i,t){const n=new Blob([t.data],{type:"buffer"});return await mT(i,YL(YL({},t),{},{data:n,headers:{"Content-Type":"application/octet-stream"}}),!0)}const pee=()=>(xv||xv||(xv=(window.location.protocol.split(":")[0]||"").toUpperCase(),xv))==="HTTPS",qL=()=>window.isSecureContext!==void 0,Ta=function(i){if(i.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return i;const t=i.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(t&&t[1]&&t[2]){const a=t[1],l=t[2];return"".concat(a,".").concat(l)}const n=i.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/);if(n&&n[1]&&n[2]){const a=n[1],l=n[2];return"".concat(a,".").concat(100*(Number(l)+1))}return"4.0.0.999"}("4.20.0"),gT=function(){try{return JSON.parse("true")===!0}catch{return!0}}();var Xc;(function(i){i.Default="default",i.Auto="auto",i.Relay="relay",i.SdRtn="sd-rtn"})(Xc||(Xc={}));const vT="v4.20.0-0-g334e514b-dirty(12/8/2023, 3:48:29 PM)",$i={PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",ENABLE_EVENT_REPORT:!0,GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],SUBSCRIBE_TWCC:!1,PUBLISH_TWCC:!1,PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,USE_PUB_RTX:!1,USE_SUB_RTX:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:100,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!0,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,DISABLE_FEC:void 0,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,ICE_RESTART_INTERVAL:1e4,NEW_ICE_RESTART:!1,ENABLE_USER_LICENSE_CHECK:!0,SIGNAL_CHANNEL:0,TRANSMITTER_INITIAL_RTT:30,TRANSMITTER_INITIAL_RTO:30,TRANSMITTER_MAX_BATCH_ACK_COUNT:2,TRANSMITTER_MAX_RTO:500,DATACHANNEL_COMPRESS:!1,FINGERPRINT:null,DC_JOIN_WITH_FAILBACK:5e3,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,AP_AREA:!0,SVC:[],ENABLE_ENCODED_TRANSFORM:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,ENABLE_DATASTREAM_2:!1,DATASTREAM_MAX_RETRANSMITS:10,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_INSTANT_VIDEO:!1,ENABLE_NTP_REPORT:!1,USE_XR:!1,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],PLUGIN_INFO:[]};function sn(i,t,n){var a,l;Be(a=Object.keys($i)).call(a,i)&&(!n&&Be(l=Object.keys(Kl)).call(l,i)||($i[i]=t))}function J(i){return $i[i]}const Kl={};function XL(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function ze(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?XL(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):XL(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}var At;(function(i){i.SET_SESSION_ID="SET_SESSION_ID",i.SET_P2P_ID="SET_P2P_id",i.SET_DC_ID="SET_DC_id",i.SET_UID="SET_UID",i.SET_INT_UID="SET_INT_UID",i.SET_PUB_ID="SET_PUB_ID",i.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",i.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",i.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",i.AVOID_JOIN_START="AVOID_JOIN_START",i.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",i.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",i.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",i.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",i.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",i.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",i.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",i.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",i.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",i.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",i.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",i.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",i.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",i.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",i.RESET_KEY_METRICS="RESET_KEY_METRICS",i.SET_USE_DATACHANNEL="SET_USE_DATACHANNEL",i.SET_USE_P2P="SET_USE_P2P",i.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE"})(At||(At={}));class fee{constructor(t,n,a,l){w(this,"state",void 0),this.state={codec:t,audioCodec:n,mode:a,clientId:l,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useDataChannel:!1,useP2P:!1,p2pTransport:Xc.Default}}dispatch(t){this.state=function(n,a){switch(a.type){case At.SET_SESSION_ID:return ze(ze({},n),{},{sessionId:a.sessionId});case At.SET_P2P_ID:return ze(ze({},n),{},{p2pId:a.p2pId});case At.SET_UID:return ze(ze({},n),{},{uid:a.uid});case At.SET_INT_UID:return ze(ze({},n),{},{intUid:a.intUid});case At.SET_PUB_ID:return ze(ze({},n),{},{pubId:a.pubId});case At.KEY_METRIC_CLIENT_CREATED:return ze(ze({},n),{},{keyMetrics:ze(ze({},n.keyMetrics),{},{clientCreated:a.metric})});case At.KEY_METRIC_JOIN_START:return ze(ze({},n),{},{keyMetrics:ze(ze({},n.keyMetrics),{},{joinStart:a.metric})});case At.AVOID_JOIN_START:return ze(ze({},n),{},{avoidJoinStart:a.avoidJoinStart});case At.KEY_METRIC_JOIN_END:return ze(ze({},n),{},{keyMetrics:ze(ze({},n.keyMetrics),{},{joinEnd:a.metric})});case At.KEY_METRIC_REQUEST_AP_START:return ze(ze({},n),{},{keyMetrics:ze(ze({},n.keyMetrics),{},{requestAPStart:a.metric})});case At.KEY_METRIC_REQUEST_AP_END:return ze(ze({},n),{},{keyMetrics:ze(ze({},n.keyMetrics),{},{requestAPEnd:a.metric})});case At.KEY_METRIC_JOIN_GATEWAY_START:return ze(ze({},n),{},{keyMetrics:ze(ze({},n.keyMetrics),{},{joinGatewayStart:a.metric})});case At.KEY_METRIC_JOIN_GATEWAY_END:return ze(ze({},n),{},{keyMetrics:ze(ze({},n.keyMetrics),{},{joinGatewayEnd:a.metric})});case At.KEY_METRIC_PEER_CONNECTION_START:return ze(ze({},n),{},{keyMetrics:ze(ze({},n.keyMetrics),{},{peerConnectionStart:a.metric})});case At.KEY_METRIC_PEER_CONNECTION_END:return ze(ze({},n),{},{keyMetrics:ze(ze({},n.keyMetrics),{},{peerConnectionEnd:a.metric})});case At.KEY_METRIC_DESCRIPTION_START:return ze(ze({},n),{},{keyMetrics:ze(ze({},n.keyMetrics),{},{descriptionStart:a.metric})});case At.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return ze(ze({},n),{},{keyMetrics:ze(ze({},n.keyMetrics),{},{signalChannelOpen:a.metric})});case At.KEY_METRIC_ICE_CONNECTION_END:return ze(ze({},n),{},{keyMetrics:ze(ze({},n.keyMetrics),{},{iceConnectionEnd:a.metric})});case At.KEY_METRIC_PUBLISH:{const l=n.keyMetrics.publish,u=l.findIndex(h=>h.trackId===a.metric.trackId);return u!==-1?(l[u]=ze(ze({},l[u]),a.metric),ze(ze({},n),{},{keyMetrics:ze(ze({},n.keyMetrics),{},{publish:[...l]})})):ze(ze({},n),{},{keyMetrics:ze(ze({},n.keyMetrics),{},{publish:[...n.keyMetrics.publish,a.metric]})})}case At.KEY_METRIC_SUBSCRIBE:{const l=n.keyMetrics.subscribe,u=l.findIndex(h=>h.userId===a.metric.userId&&h.type===a.metric.type);return u!==-1?(l[u]=ze(ze({},l[u]),a.metric),ze(ze({},n),{},{keyMetrics:ze(ze({},n.keyMetrics),{},{subscribe:[...l]})})):ze(ze({},n),{},{keyMetrics:ze(ze({},n.keyMetrics),{},{subscribe:[...n.keyMetrics.subscribe,a.metric]})})}case At.SET_CLOUD_PROXY_SERVER_MODE:return n.cloudProxyServerMode=a.mode,n;case At.RECORD_JOIN_CHANNEL_SERVICE:return typeof a.index!="number"?n.joinChannelServiceRecords=[...n.joinChannelServiceRecords,a.record]:(n.joinChannelServiceRecords[a.index]=ze(ze({},n.joinChannelServiceRecords[a.index]),a.record),n.joinChannelServiceRecords=[...n.joinChannelServiceRecords]),n;case At.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return n.joinChannelServiceRecords=[],n;case At.RESET_KEY_METRICS:return n.keyMetrics={publish:[],subscribe:[]},n;case At.SET_USE_DATACHANNEL:return ze(ze({},n),{},{useDataChannel:a.val});case At.SET_USE_P2P:return ze(ze({},n),{},{useP2P:a.val});case At.SET_TRANSPORT_TYPE:return ze(ze({},n),{},{p2pTransport:a.val});default:return n}}(this.state,t)}set sessionId(t){this.dispatch({type:At.SET_SESSION_ID,sessionId:t})}get sessionId(){return this.state.sessionId}set codec(t){this.state.codec=t}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(t){this.dispatch({type:At.SET_P2P_ID,p2pId:t})}get p2pId(){return this.state.p2pId}set dcId(t){this.dispatch({type:At.SET_DC_ID,dcId:t})}get dcId(){return this.state.dcId}set uid(t){this.dispatch({type:At.SET_UID,uid:t})}get uid(){return this.state.uid}set intUid(t){this.dispatch({type:At.SET_INT_UID,intUid:t})}get intUid(){return this.state.intUid}set pubId(t){this.dispatch({type:At.SET_PUB_ID,pubId:t})}get pubId(){return this.state.pubId}set cloudProxyServerMode(t){this.dispatch({type:At.SET_CLOUD_PROXY_SERVER_MODE,mode:t})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useDataChannel(t){this.dispatch({type:At.SET_USE_DATACHANNEL,val:t})}get useDataChannel(){return this.state.useDataChannel}set useP2P(t){this.dispatch({type:At.SET_USE_P2P,val:t})}get useP2P(){return this.state.useP2P}set p2pTransport(t){this.dispatch({type:At.SET_TRANSPORT_TYPE,val:t})}get p2pTransport(){return this.state.p2pTransport}clientCreated(){this.dispatch({type:At.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:At.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:At.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:At.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:At.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:At.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:At.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:At.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:At.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:At.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:At.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:At.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(t,n,a,l){this.dispatch({type:At.KEY_METRIC_PUBLISH,metric:ze(ze({trackId:t,type:n},a&&{publishStart:a}),l&&{publishEnd:l})})}subscribe(t,n,a,l,u,h,p){this.dispatch({type:At.KEY_METRIC_SUBSCRIBE,metric:ze(ze(ze(ze(ze({userId:t,type:n},a&&{subscribeStart:a}),l&&{subscribeEnd:l}),u&&{firstFrame:u}),h&&{streamAdded:h}),p&&{firstDecoded:p})})}massSubscribe(t,n,a,l){t.forEach(u=>{this.dispatch({type:At.KEY_METRIC_SUBSCRIBE,metric:ze(ze(ze({userId:u.userId,type:u.type},n&&{subscribeStart:n}),a&&{subscribeEnd:a}),l&&{firstFrame:l})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(t,n){t.service==="gateway"&&Array.isArray(t.urls)&&(t.urls=t.urls.map(a=>a.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof n!="number"?(this.dispatch({type:At.RECORD_JOIN_CHANNEL_SERVICE,record:ze(ze({},t),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(n<0||n>=this.state.joinChannelServiceRecords.length||this.dispatch({type:At.RECORD_JOIN_CHANNEL_SERVICE,record:t,index:n}),n)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:At.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:At.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}get avoidJoinStart(){return this.state.avoidJoinStart}set avoidJoinStart(t){this.dispatch({type:At.AVOID_JOIN_START,avoidJoinStart:t})}}var Yl,JL;(function(i){i.h264="h264",i.h265="h265",i.vp8="vp8",i.vp9="vp9",i.av1="av1"})(Yl||(Yl={})),function(i){i.opus="opus",i.pcma="pcma",i.pcmu="pcmu",i.g722="g722"}(JL||(JL={}));const Pv=new class extends wn{reportLogUploadError(i){this.emit("REPORT_LOG_UPLOAD",i)}};class mee{constructor(t){w(this,"logger",void 0),w(this,"prefixLists",[]),this.logger=t}debug(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];this.logger.debug(...this.prefixLists,...n)}info(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];this.logger.info(...this.prefixLists,...n)}warning(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];this.logger.warning(...this.prefixLists,...n)}error(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];this.logger.error(...this.prefixLists,...n)}prefix(t){return this.prefixLists.push(t),this}popPrefix(){return this.prefixLists.pop(),this}}function ET(){const i=new Date;return i.toTimeString().split(" ")[0]+":"+i.getMilliseconds()}function QL(){const i=new Date,t=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return t?(t==null?void 0:t[0])+":"+i.getUTCMilliseconds():i.toTimeString().split(" ")[0]+":"+i.getMilliseconds()}const Ra={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},Dv=Date.now(),a0=i=>{for(const t in Ra)if(Object.prototype.hasOwnProperty.call(Ra,t)&&Ra[t]===i)return t;return"DEFAULT"},L=new class{constructor(){w(this,"proxyServerURL",void 0),w(this,"logLevel",Ra.DEBUG),w(this,"uploadState","collecting"),w(this,"uploadLogWaitingList",[]),w(this,"uploadLogUploadingList",[]),w(this,"uploadErrorCount",0),w(this,"currentLogID",0),w(this,"url",void 0),w(this,"extLog",(i,t)=>{this.appendLogToWaitingList(i,...t)})}debug(){for(var i=arguments.length,t=new Array(i),n=0;n<i;n++)t[n]=arguments[n];const a=[Ra.DEBUG].concat(t);this.log.apply(this,a)}info(){for(var i=arguments.length,t=new Array(i),n=0;n<i;n++)t[n]=arguments[n];const a=[Ra.INFO].concat(t);this.log.apply(this,a)}warning(){for(var i=arguments.length,t=new Array(i),n=0;n<i;n++)t[n]=arguments[n];const a=[Ra.WARNING].concat(t);this.log.apply(this,a)}warn(){this.warning(...arguments)}error(){for(var i=arguments.length,t=new Array(i),n=0;n<i;n++)t[n]=arguments[n];const a=[Ra.ERROR].concat(t);this.log.apply(this,a)}upload(){for(var i=arguments.length,t=new Array(i),n=0;n<i;n++)t[n]=arguments[n];const a=[Ra.DEBUG].concat(t);this.uploadLog.apply(this,a)}setLogLevel(i){i=Math.min(Math.max(0,i),4),this.logLevel=i}enableLogUpload(){sn("UPLOAD_LOG",!0)}disableLogUpload(){sn("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(i){this.proxyServerURL=i}prefix(i){return new mee(this).prefix(i)}log(){for(var i=arguments.length,t=new Array(i),n=0;n<i;n++)t[n]=arguments[n];if(Date.now()-Dv<100)return void setTimeout(()=>{this.log(...t)},Date.now()-Dv);const a=Math.max(0,Math.min(4,t[0]));if(t[0]=ET()+" Agora-SDK [".concat(a0(a),"]:"),this.appendLogToWaitingList(a,...t),a<this.logLevel)return;const l=ET()+" %cAgora-SDK [".concat(a0(a),"]:");let u=[];if(!J("USE_NEW_LOG"))switch(a){case Ra.DEBUG:u=[l,"color: #64B5F6;"].concat(t.slice(1)),console.log.apply(console,u);break;case Ra.INFO:u=[l,"color: #1E88E5; font-weight: bold;"].concat(t.slice(1)),console.log.apply(console,u);break;case Ra.WARNING:u=[l,"color: #FB8C00; font-weight: bold;"].concat(t.slice(1)),console.warn.apply(console,u);break;case Ra.ERROR:u=[l,"color: #B00020; font-weight: bold;"].concat(t.slice(1)),console.error.apply(console,u)}}uploadLog(){for(var i=arguments.length,t=new Array(i),n=0;n<i;n++)t[n]=arguments[n];if(Date.now()-Dv<100)return void setTimeout(()=>{this.uploadLog(...t)},Date.now()-Dv);const a=Math.max(0,Math.min(4,t[0]));t[0]=ET()+" Agora-SDK [".concat(a0(a),"]:"),this.appendLogToWaitingList(a,...t)}appendLogToWaitingList(i){if(!J("UPLOAD_LOG"))return;for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];Array.isArray(n[0])?n[0][0]=QL()+" Agora-SDK [".concat(a0(i),"]:"):n[0]=QL()+" Agora-SDK [".concat(a0(i),"]:");let l="";n.forEach(u=>{typeof u=="object"&&(u=JSON.stringify(u)),l+="".concat(u," ")}),this.uploadLogWaitingList.push({payload_str:l,log_level:i,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const i=this.uploadLogUploadingList,t={sdk_version:Ta,process_id:J("PROCESS_ID"),payload:JSON.stringify(i)};return Ds(async()=>{const n=await ho.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(J("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(J("LOG_UPLOAD_SERVER"),"/upload/v1")),t,{responseType:"text"});if(n.data!=="OK"){const a=new Error("unexpected upload log response");throw a.response=n,a}},()=>(this.uploadLogUploadingList=[],!1),n=>(n.response?Pv.reportLogUploadError({status:n.response.status,data:n.response.data,headers:n.response.headers,message:n.message}):n.request?Pv.reportLogUploadError({status:n.request.status,message:n.message}):Pv.reportLogUploadError({status:-1,message:n.message}),!0),{timeout:J("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:J("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,J("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),J("UPLOAD_LOG_INTERVAL"))}).catch(i=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),J("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),J("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}};var ZL,eM;function gee(i){return ai(i.reportId,"params.reportId",0,100,!1),ai(i.category,"params.category",0,100,!1),ai(i.event,"params.event",0,100,!1),ai(i.label,"params.label",0,100,!1),an(i.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(function(i){i.FREE="free",i.UPLOADING="uploading"})(ZL||(ZL={})),function(i){i[i.MISC=0]="MISC",i[i.INTERNAL_EVENT=1]="INTERNAL_EVENT",i[i.PUBLIC_EVENT=2]="PUBLIC_EVENT",i[i.WEB_EVENT=3]="WEB_EVENT",i[i.INTERNAL_API=4]="INTERNAL_API",i[i.WEB_API=5]="WEB_API",i[i.PUBLIC_API=6]="PUBLIC_API"}(eM||(eM={}));const vee={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};var Cr,yn,tM,nM;function rM(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function Et(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?rM(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):rM(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}(function(i){i.PUBLISH="publish",i.SUBSCRIBE="subscribe",i.WS_COMPRESSOR_INIT="ws_compressor_init",i.SESSION_INIT="session_init",i.JOIN_CHOOSE_SERVER="join_choose_server",i.REQ_USER_ACCOUNT="req_user_account",i.JOIN_GATEWAY="join_gateway",i.REJOIN_GATEWAY="rejoin_gateway",i.STREAM_SWITCH="stream_switch",i.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",i.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",i.FIRST_VIDEO_RECEIVED="first_video_received",i.FIRST_AUDIO_RECEIVED="first_audio_received",i.FIRST_VIDEO_DECODE="first_video_decode",i.FIRST_AUDIO_DECODE="first_audio_decode",i.ON_ADD_AUDIO_STREAM="on_add_audio_stream",i.ON_ADD_VIDEO_STREAM="on_add_video_stream",i.ON_UPDATE_STREAM="on_update_stream",i.ON_REMOVE_STREAM="on_remove_stream",i.USER_ANALYTICS="req_user_analytics",i.PC_STATS="pc_stats",i.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities"})(Cr||(Cr={})),function(i){i.SESSION="io.agora.pb.Wrtc.Session",i.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",i.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",i.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",i.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",i.PUBLISH="io.agora.pb.Wrtc.Publish",i.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",i.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",i.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",i.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",i.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",i.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",i.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",i.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",i.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",i.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",i.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",i.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",i.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",i.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",i.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",i.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",i.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",i.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",i.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",i.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",i.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",i.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",i.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",i.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",i.PC_STATS="io.agora.pb.Wrtc.PCStats",i.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities"}(yn||(yn={})),function(i){i[i.WORKER_EVENT=156]="WORKER_EVENT",i[i.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}(tM||(tM={})),function(i){i[i.SESSION=26]="SESSION",i[i.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",i[i.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",i[i.JOIN_GATEWAY=28]="JOIN_GATEWAY",i[i.PUBLISH=30]="PUBLISH",i[i.SUBSCRIBE=29]="SUBSCRIBE",i[i.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",i[i.STREAM_SWITCH=32]="STREAM_SWITCH",i[i.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",i[i.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",i[i.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",i[i.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",i[i.API_INVOKE=41]="API_INVOKE",i[i.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",i[i.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",i[i.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",i[i.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",i[i.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",i[i.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",i[i.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",i[i.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",i[i.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",i[i.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",i[i.WORKER_EVENT=156]="WORKER_EVENT",i[i.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",i[i.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",i[i.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",i[i.USER_ANALYTICS=1e4]="USER_ANALYTICS",i[i.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED"}(nM||(nM={}));class s0{constructor(){w(this,"baseInfoMap",new Map),w(this,"proxyServer",void 0),w(this,"eventUploadTimer",void 0),w(this,"setSessionIdTimer",void 0),w(this,"url",void 0),w(this,"backupUrl",void 0),w(this,"_appId",void 0),w(this,"keyEventUploadPendingItems",[]),w(this,"normalEventUploadPendingItems",[]),w(this,"apiInvokeUploadPendingItems",[]),w(this,"apiInvokeCount",0),w(this,"ltsList",[]),w(this,"lastSendNormalEventTime",Date.now()),w(this,"customReportCounterTimer",void 0),w(this,"customReportCount",0),w(this,"extApiInvoke",async t=>{for(const n of t){const a=Et(Et({},n),{},{sid:null,invokeId:++this.apiInvokeCount,tag:Pn.TRACER});this.sendApiInvoke(a)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),J("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),J("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(t){return this.baseInfoMap.get(t)}adjustSessionStartTime(t){if(!this.baseInfoMap.has(t)&&!this.baseInfoMap.get(t))return void L.error("adjust session ".concat(t," start time, sid is not exist or info is undefined"));const n=this.baseInfoMap.get(t),a=Date.now(),l=n.startTime;n.startTime=a,L.debug("rewrite session ".concat(t," startTime: ").concat(a," , ").concat(a-l,"ms")),this.baseInfoMap.set(t,n)}setAppId(t){this._appId=t}reportApiInvoke(t,n,a){n.timeout=n.timeout||6e4,n.reportResult=n.reportResult===void 0||n.reportResult;const l=Date.now();this.apiInvokeCount+=1;const u=this.apiInvokeCount,h=()=>({tag:n.tag,invokeId:u,sid:t,name:n.name,apiInvokeTime:l,options:n.options,states:n.states||null}),p=!!J("SHOW_REPORT_INVOKER_LOG");p&&L.info("".concat(n.name," start"),n.options);let v=!1;Fr(n.timeout).then(()=>{v||(this.sendApiInvoke(Et(Et({},h()),{},{error:z.API_INVOKE_TIMEOUT,success:!1})),L.debug("".concat(n.name," timeout")))});const E=new Te(z.UNEXPECTED_ERROR,"".concat(n.name,": this api invoke is end"));return{onSuccess:y=>{const C=()=>{if(v)throw E;return v=!0,this.sendApiInvoke(Et(Et({},h()),{},{success:!0},n.reportResult&&{result:y})),p&&L.info("".concat(n.name," onSuccess")),y};return a?Xk(C,n.name+"Success",a,()=>v=!0):C()},onError:y=>{const C=()=>{if(v)throw y;v=!0,this.sendApiInvoke(Et(Et({},h()),{},{success:!1,error:y})),p&&L.info("".concat(n.name," onFailure"),y.toString())};return a?Xk(C,n.name+"Error",a,()=>v=!0):C()}}}sessionInit(t,n){if(this.baseInfoMap.has(t))return;const a=Date.now(),l=this.createBaseInfo(t,a);l.cname=n.cname;const u=Object.assign({},{willUploadConsoleLog:J("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:gT?"global":"oversea",areas:J("AREAS")&&J("AREAS").join(",")},n.extend),{stringUid:h,channelProfile:p,channelMode:v,isABTestSuccess:E,lsid:y,clientRole:C}=n,I=Date.now(),k=Et(Et({},l),{},{eventType:Cr.SESSION_INIT,appid:n.appid,browser:navigator.userAgent,build:vT,lts:I,elapse:I-a,extend:JSON.stringify(u),mode:n.mode,process:J("PROCESS_ID"),appType:J("APP_TYPE"),success:!0,version:Ta,stringUid:h,channelProfile:p,channelMode:v,isABTestSuccess:E,lsid:y,clientType:20,clientRole:C,serviceId:J("PROCESS_ID"),extensionID:J("PLUGIN_INFO").join(",")||""});this.send({type:yn.SESSION,data:k},!0)}joinChooseServer(t,n){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Et(Et({},l),{},{eventType:Cr.JOIN_CHOOSE_SERVER,lts:u,eventElapse:u-n.lts,chooseServerAddr:n.csAddr,errorCode:n.ec,elapse:u-a.startTime,success:n.succ,chooseServerAddrList:JSON.stringify(n.serverList),uid:n.uid?parseInt(n.uid):null,cid:n.cid?parseInt(n.cid):null,chooseServerIp:n.csIp||"",opid:n.opid,unilbsServerIds:n.unilbsServerIds,extend:n.extend||void 0,isHttp3:n.isHttp3});this.send({type:yn.JOIN_CHOOSE_SERVER,data:h},!0)}reqUserAccount(t,n){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Et(Et({},l),{},{eventType:Cr.REQ_USER_ACCOUNT,lts:u,success:n.success,serverAddress:n.serverAddr,stringUid:n.stringUid,uid:n.uid,errorCode:n.errorCode,elapse:u-a.startTime,eventElapse:u-n.lts,extend:JSON.stringify(n.extend)});this.send({type:yn.REQ_USER_ACCOUNT,data:h},!0)}joinGateway(t,n){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info;n.vid&&(l.vid=n.vid),l.uid=n.uid,l.cid=n.cid;const u=Date.now(),{firstSuccess:h,avoidJoinStartTime:p,isProxy:v,addr:E}=n,y=u-(h&&p?p:a.startTime),C=Et(Et({},l),{},{eventType:Cr.JOIN_GATEWAY,lts:u,gatewayAddr:n.addr,success:n.succ,errorCode:n.ec,elapse:y,eventElapse:u-n.lts,firstSuccess:h,signalChannel:n.signalChannel}),I=C.success?1:0;if(n.succ&&(a.lastJoinSuccessTime=u),h)this.send({type:yn.JOIN_GATEWAY,data:C},!0);else{let k;if(E)if(v){const B=E.match(/h=(\d{1,3}-){3}\d{1,3}/g),j=E.match(/p=[0-9]{1,6}/g);k={isSuccess:I,gatewayIp:B&&B.length?B[0].split("=")[1].replace(/-/g,"."):"",port:j&&j.length?j[0].split("=")[1]:"",isProxy:v?1:0}}else{const B=E.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),j=E.match(/(:|p=)[0-9]{1,6}/g);k={isSuccess:I,gatewayIp:B&&B.length?B[0].split("//")[1].replace(/-/g,"."):"",port:j&&j.length?j[0].split(/:|p=/g)[1]:"",isProxy:v?1:0}}else k={isSuccess:I,gatewayIp:"",port:"",isProxy:v?1:0};delete C.success,delete C.eventType,delete C.firstSuccess,C.vid=Number(C.vid);const G=Object.assign({},C,k,{eventType:Cr.REJOIN_GATEWAY});this.send({type:yn.RE_JOIN_GATEWAY,data:G},!0)}}joinChannelTimeout(t,n){const a=this.baseInfoMap.get(t);if(!a)return;const l=Date.now(),u=Et(Et({},a.info),{},{lts:l,timeout:n,elapse:l-a.startTime});this.send({type:yn.JOIN_CHANNEL_TIMEOUT,data:u},!0)}publish(t,n){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Et(Et({},l),{},{eventType:Cr.PUBLISH,lts:u,eventElapse:n.eventElapse,elapse:u-a.startTime,success:n.succ,errorCode:n.ec,videoName:n.videoName,audioName:n.audioName,screenName:n.screenName,screenshare:n.screenshare,audio:n.audio,video:n.video,p2pid:n.p2pid,publishRequestid:n.publishRequestid});this.send({type:yn.PUBLISH,data:h},!0)}subscribe(t,n,a){const l=this.baseInfoMap.get(t);if(!l)return;const u=l.info,h=Date.now(),p=Et(Et({},u),{},{eventType:Cr.SUBSCRIBE,lts:h,eventElapse:n.eventElapse,elapse:h-l.startTime,success:n.succ,errorCode:n.ec,video:n.video,audio:n.audio,subscribeRequestid:n.subscribeRequestid,p2pid:n.p2pid},a&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof n.peerid=="string"?p.peerSuid=n.peerid:p.peer=n.peerid,this.send({type:yn.SUBSCRIBE,data:p},!0)}wsCompressorInit(t){var n;const a=[...zo(n=this.baseInfoMap).call(n)],l=a.length?a[0]:"UnableToGetSid",u=this.baseInfoMap.get(l);if(!u)return;const h=u.info,p=Date.now(),v=Et(Et({},h),{},{eventType:Cr.WS_COMPRESSOR_INIT,lts:p,eventElapse:t.eventElapse,elapse:p-u.startTime,status:t.status?1:2});this.send({type:yn.WS_COMPRESSOR_INIT,data:v},!0)}firstRemoteVideoDecode(t,n,a,l){const u=this.baseInfoMap.get(t);if(!u)return;const h=u.info,p=Date.now(),v=Et(Et(Et({},h),l),{},{elapse:p-u.startTime,eventType:n,lts:p,firstDecodeFrame:Math.max(p-u.startTime,0),apEnd:Math.max(l.apEnd-u.startTime,0),apStart:Math.max(l.apStart-u.startTime,0),joinGwEnd:Math.max(l.joinGwEnd-u.startTime,0),joinGwStart:Math.max(l.joinGwStart-u.startTime,0),pcEnd:Math.max(l.pcEnd-u.startTime,0),pcStart:Math.max(l.pcStart-u.startTime,0),subscriberEnd:Math.max(l.subscriberEnd-u.startTime,0),subscriberStart:Math.max(l.subscriberStart-u.startTime,0),videoAddNotify:Math.max(l.videoAddNotify-u.startTime,0)});this.send({type:a,data:v},!0)}firstRemoteFrame(t,n,a,l){const u=this.baseInfoMap.get(t);if(!u)return;const h=u.info,p=Date.now(),v=Et(Et(Et({},h),l),{},{elapse:p-u.startTime,eventType:n,lts:p});this.send({type:a,data:v},!0)}pcStats(t,n){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Et(Et(Et({},l),n),{},{vid:l.vid===void 0?0:Number(l.vid),elapse:u-a.startTime,eventType:Cr.PC_STATS,lts:u});this.send({type:yn.PC_STATS,data:h},!0)}updateRemoteRTPCapabilities(t,n){if(t){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Et(Et(Et({},l),n),{},{vid:l.vid===void 0?0:Number(l.vid),eventType:Cr.UPDATE_REMOTE_RTPCAPABILITIES,lts:u});this.send({type:yn.UPDATE_REMOTE_RTPCAPABILITIES,data:h},!0)}}onGatewayStream(t,n,a,l){const u=this.baseInfoMap.get(t);if(!u)return;const h=u.info,p=Date.now(),v=Et(Et(Et({},h),l),{},{eventType:n,lts:p});this.send({type:a,data:v},!0)}streamSwitch(t,n){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Et(Et({},l),{},{eventType:Cr.STREAM_SWITCH,lts:u,isDual:n.isdual,elapse:u-a.startTime,success:n.succ});this.send({type:yn.STREAM_SWITCH,data:h},!0)}requestProxyAppCenter(t,n){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Et(Et({},l),{},{eventType:Cr.REQUEST_PROXY_APPCENTER,lts:u,eventElapse:u-n.lts,elapse:u-a.startTime,APAddr:n.APAddr,workerManagerList:n.workerManagerList,response:n.response,errorCode:n.ec,success:n.succ});this.send({type:yn.REQUEST_PROXY_APPCENTER,data:h},!0)}requestProxyWorkerManager(t,n){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Et(Et({},l),{},{eventType:Cr.REQUEST_PROXY_WORKER_MANAGER,lts:u,eventElapse:u-n.lts,elapse:u-a.startTime,workerManagerAddr:n.workerManagerAddr,response:n.response,errorCode:n.ec,success:n.succ});this.send({type:yn.REQUEST_PROXY_WORKER_MANAGER,data:h},!0)}setProxyServer(t){this.proxyServer=t,t?L.debug("reportProxyServerurl: ".concat(t)):L.debug("disable reportProxyServerurl: ".concat(t))}peerPublishStatus(t,n){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Et(Et({},l),{},{subscribeElapse:n.subscribeElapse,peer:n.peer,peerPublishDuration:Math.max(n.audioPublishDuration,n.videoPublishDuration),audiotag:n.audioPublishDuration>0?1:-1,videotag:n.videoPublishDuration>0?1:-1,lts:u,elapse:u-a.startTime,joinChannelSuccessElapse:u-(a.lastJoinSuccessTime||u),peerPublishDurationVideo:n.videoPublishDuration,peerPublishDurationAudio:n.audioPublishDuration});this.send({type:yn.PEER_PUBLISH_STATUS,data:h},!0)}workerEvent(t,n){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now();(function(p,v,E){const y=p[v];if(!y||typeof y!="string")return[p];p[v]="";const C=Ec(JSON.stringify(p));let I=0;const k=[];let G=0;for(let B=0;B<y.length;B++)G+=y.charCodeAt(B)<=127?1:3,G<=E-C||(k[k.length]=cd(cd({},p),{},{[v]:y.substring(I,B)}),I=B,G=y.charCodeAt(B)<=127?1:3);return I!==y.length-1&&(k[k.length]=cd(cd({},p),{},{[v]:y.substring(I)})),k})(Et(Et(Et({},l),n),{},{elapse:u-a.startTime,lts:u,productType:"WebRTC"}),"payload",1300).forEach(p=>this.send({type:yn.WORKER_EVENT,data:p},!0))}apworkerEvent(t,n){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Et(Et(Et({},l),n),{},{elapse:u-a.startTime,lts:u});this.send({type:yn.AP_WORKER_EVENT,data:h},!0)}joinWebProxyAP(t,n){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Et(Et(Et({},l),n),{},{elapse:u-a.startTime,lts:u,extend:n.extend||void 0});this.send({type:yn.JOIN_WEB_PROXY_AP,data:h},!0)}WebSocketQuit(t,n){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Et(Et(Et({},l),n),{},{elapse:u-a.startTime,lts:u});this.send({type:yn.WEBSOCKET_QUIT,data:h},!0)}async sendCustomReportMessage(t,n){if(this.customReportCount+=n.length,this.customReportCount>J("CUSTOM_REPORT_LIMIT"))throw new Te(z.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const a=Date.now(),l=n.map(u=>({type:yn.USER_ANALYTICS,data:Et(Et({sid:t},u),{},{lts:a})}));try{J("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(l):await this.postDataToStatsCollector(l)}catch(u){throw L.error("send custom report message failed",u.toString()),new Te(z.CUSTOM_REPORT_SEND_FAILED,u.message)}}sendApiInvoke(t){const n=J("NOT_REPORT_EVENT");if(t.tag&&Be(n)&&Be(n).call(n,t.tag))return!1;if(t.sid===null)return this.apiInvokeUploadPendingItems.push(t),!1;const a=this.baseInfoMap.get(t.sid);if(!a)return this.apiInvokeUploadPendingItems.push(t),!1;const{cname:l,uid:u,cid:h}=a.info;let p;if(t.lts=t.lts||Date.now(),t.error)if(t.error instanceof Te){const{code:E,message:y}=t.error;p=E||y||t.error.toString()}else p=t.error.toString();const v={invokeId:t.invokeId,sid:t.sid,cname:l,cid:h,uid:u,lts:t.lts,success:t.success,elapse:t.lts-a.startTime,execElapse:t.lts-t.apiInvokeTime,apiName:t.name,options:t.options?JSON.stringify(t.options):void 0,execStates:t.states?JSON.stringify(t.states):void 0,execResult:t.result?JSON.stringify(t.result):void 0,errorCode:t.error?p:void 0,errorMsg:t.error?JSON.stringify(t.error):void 0};return this.send({type:yn.API_INVOKE,data:v},!1),!0}appendSessionId(){s0.__CLIENT_LIST__.forEach(t=>{if(t._sessionId){const n=this.apiInvokeUploadPendingItems.length;for(let a=0;a<n;a++){const l=this.apiInvokeUploadPendingItems.shift();l&&(l.sid=t._sessionId,this.sendApiInvoke(Object.assign({},l)))}}})}send(t,n){if(n)return this.keyEventUploadPendingItems.push(t),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(t),this.normalEventUploadPendingItems.length>J("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(t,n){const a=[],l=[];for(;t.length;){const h=t.shift();a.length<20?a.push(h):l.push(h)}t.push(...l);for(const h of[...a]){var u;this.ltsList.indexOf(h.data.lts)!==-1?(h.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(h.data.lts)):(this.ltsList.push(h.data.lts),zf(u=this.ltsList).call(u,(p,v)=>p-v))}return n||(this.lastSendNormalEventTime=Date.now()),J("ENABLE_EVENT_REPORT")&&a.length&&(J("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(a):this.postDataToStatsCollector(a)).catch((h=>p=>{J("EVENT_REPORT_RETRY")&&(n?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(h):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(h),this.normalEventUploadPendingItems.length>J("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-J("NORMAL_EVENT_QUEUE_CAPACITY")),L.warning("report: drop normal events"))))})(a)),t}async postDataToStatsCollector2(t){lr.networkState===Di.OFFLINE&&await _e.race([lr.onlineWaiter,Fr(2*ur.maxRetryTimeout)]);const n=u=>{let h=new Uint8Array;return u.forEach(p=>{const v=Gb(JSON.stringify(p.data)),E=new ArrayBuffer(5),y=(I=>{let k=0;return Object.entries(yn).forEach(G=>{let[B,j]=G;j===I.type&&(k=EventNameToID[B])}),k})(p),C=new DataView(E);C.setUint16(0,v.byteLength,!0),C.setUint8(2,255&y),C.setUint8(3,y>>>8&255),C.setUint8(4,y>>>16&255),h=Vk(h,new Uint8Array(E)),h=Vk(h,v)}),h},a="event";let l=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(J("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(a):"https://".concat(J("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(a);for(let u=0;u<2;u+=1){u===1&&(l=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(J("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(a):"https://".concat(J("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(a));try{await mT(l,{timeout:1e4,data:n(t),headers:Et(Et({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(h){if(u===1)throw h;continue}return}}async postDataToStatsCollector(t){let n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const a={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:t.map(h=>JSON.stringify(h)),vid:(h=>{const p=h&&h.data.sid&&this.baseInfoMap.get(h.data.sid);return p&&p.info.vid&&+p.info.vid||0})(t[0])};lr.networkState===Di.OFFLINE&&await _e.race([lr.onlineWaiter,Fr(2*ur.maxRetryTimeout)]);const l=n?"/events/proto-raws":"/events/messages";let u=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(J("EVENT_REPORT_DOMAIN"),"&p=").concat(J("STATS_COLLECTOR_PORT"),"&d=").concat(l):"https://".concat(J("EVENT_REPORT_DOMAIN"),":").concat(J("STATS_COLLECTOR_PORT")).concat(l));for(let h=0;h<2;h+=1){h===1&&(u=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(J("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(J("STATS_COLLECTOR_PORT"),"&d=").concat(l):"https://".concat(J("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(J("STATS_COLLECTOR_PORT")).concat(l)));try{n?await hee(u,{timeout:1e4,data:a}):await mT(u,{timeout:1e4,data:a})}catch(p){if(h===1)throw p;continue}return}}createBaseInfo(t,n){const a=Object.assign({},vee);return a.sid=t,this.baseInfoMap.set(t,{info:a,startTime:n}),a}reportResourceTiming(t,n){const a=performance.getEntriesByName(t),l=a[a.length-1];l&&this.reportApiInvoke(n,{name:"Client.resourceTiming",options:l,tag:Pn.TRACER}).onSuccess()}}function Je(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(t,n,a){const l=a.value;if(typeof l=="function"){const u=i.className||t.__className__||(t.constructor.name==="AgoraRTCClient"?"Client":t.constructor.name);a.value=function(){for(var h=arguments.length,p=new Array(h),v=0;v<h;v++)p[v]=arguments[v];let E=p;if(i.argsMap)try{E=i.argsMap(this,...p)}catch(C){L.warning(C),E=[]}try{JSON.stringify(E)}catch{L.warning("arguments for method ".concat(u,".").concat(String(n)," not serializable for apiInvoke.")),E=[]}const y=(i.report||We).reportApiInvoke(this._sessionId||null,{name:"".concat(u,".").concat(String(n)),options:E,tag:Pn.TRACER,reportResult:i.reportResult},i.throttleTime);try{const C=l.apply(this,p);return C instanceof _e?C.then(I=>(y.onSuccess(i.reportResult&&I),I)).catch(I=>{throw y.onError(I),I}):(y.onSuccess(i.reportResult&&C),C)}catch(C){throw y.onError(C),C}}}return a}}w(s0,"__CLIENT_LIST__",[]);const We=new s0;Pv.on("REPORT_LOG_UPLOAD",i=>{i.networkState=lr.networkState,We.reportApiInvoke(null,{name:"logUploadError",options:i,tag:Pn.TRACER})});const Eee=["CHINA","GLOBAL"],Hi=function(){const i="us".concat("erna","me"),t="pa".concat("sswo","rd"),n=["t","s","t"];n.splice(1,0,"e");const a=n.join(""),l=[];for(let p=0;p<6;p++)l.push("1");const u=l.join(""),h={};return h[i]=a,h[t]=u,Object.assign(h,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=Hi,gT||($i.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],$i.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],$i.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],$i.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],$i.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],$i.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],$i.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",$i.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",$i.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",$i.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",$i.AREAS=["NORTH_AMERICA","OVERSEA"]);const iM=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],ql=[];function hd(i,t){return!!t&&ql.some(n=>n.uid===i&&n.channelName===t)}s0.__CLIENT_LIST__=ql;var _T,po,$h,c0,Yo,gi,qe,wt,Me,Ke,Jc,ot,oM,vi,nt,br,Xl,_ee=Bl("Array").values,yee=ed,See=Gr,Cee=R,bee=_ee,yT=Array.prototype,Tee={DOMTokenList:!0,NodeList:!0},ks=c(function(i){var t=i.values;return i===yT||Cee(yT,i)&&t===yT.values||See(Tee,yee(i))?bee:t});function Re(i,t,n,a){var l,u=arguments.length,h=u<3?t:a===null?a=Object.getOwnPropertyDescriptor(t,n):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(i,t,n,a);else for(var p=i.length-1;p>=0;p--)(l=i[p])&&(h=(u<3?l(h):u>3?l(t,n,h):l(t,n))||h);return u>3&&h&&Object.defineProperty(t,n,h),h}function H(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)}(function(i){i.L1T1="L1T1",i.L1T2="L1T2",i.L1T3="L1T3",i.L2T1_KEY="L2T1_KEY",i.L2T2_KEY="L2T2_KEY",i.L2T3_KEY="L2T3_KEY",i.L3T1_KEY="L3T1_KEY",i.L3T2_KEY="L3T2_KEY",i.L3T3_KEY="L3T3_KEY"})(_T||(_T={})),function(i){i.CERTIFICATE="certificate",i.CODEC="codec",i.CANDIDATE_PAIR="candidate-pair",i.LOCAL_CANDIDATE="local-candidate",i.REMOTE_CANDIDATE="remote-candidate",i.INBOUND="inbound-rtp",i.TRACK="track",i.OUTBOUND="outbound-rtp",i.PC="peer-connection",i.REMOTE_INBOUND="remote-inbound-rtp",i.REMOTE_OUTBOUND="remote-outbound-rtp",i.TRANSPORT="transport",i.CSRC="csrc",i.DATA_CHANNEL="data-channel",i.STREAM="stream",i.SENDER="sender",i.RECEIVER="receiver"}(po||(po={})),function(i){i[i.ACCESS_POINT=101]="ACCESS_POINT",i[i.UNILBS=201]="UNILBS",i[i.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR"}($h||($h={})),function(i){i[i.IIIEGAL_APPID=1]="IIIEGAL_APPID",i[i.IIIEGAL_UID=2]="IIIEGAL_UID",i[i.INTERNAL_ERROR=3]="INTERNAL_ERROR"}(c0||(c0={})),function(i){i[i.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",i[i.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",i[i.INTERNAL_ERROR=8]="INTERNAL_ERROR",i[i.NO_AUTHORIZED=9]="NO_AUTHORIZED",i[i.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",i[i.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",i[i.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",i[i.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",i[i.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",i[i.USER_OVERLOAD=16]="USER_OVERLOAD",i[i.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",i[i.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND"}(Yo||(Yo={})),function(i){i[i.NO_FLAG_SET=100]="NO_FLAG_SET",i[i.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",i[i.INVALID_FALG_SET=102]="INVALID_FALG_SET",i[i.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",i[i.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",i[i.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",i[i.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",i[i.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",i[i.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",i[i.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",i[i.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",i[i.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",i[i.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",i[i.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",i[i.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",i[i.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",i[i.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",i[i.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",i[i.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV"}(gi||(gi={})),function(i){i[i.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",i[i.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",i[i.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",i[i.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",i[i.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",i[i.K_TICKET_INVALID=7]="K_TICKET_INVALID",i[i.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",i[i.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",i[i.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",i[i.K_UID_BANNED=14]="K_UID_BANNED",i[i.K_IP_BANNED=15]="K_IP_BANNED",i[i.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",i[i.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",i[i.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",i[i.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",i[i.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",i[i.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",i[i.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",i[i.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",i[i.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",i[i.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",i[i.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",i[i.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",i[i.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",i[i.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",i[i.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",i[i.ERR_INVALID_UID=117]="ERR_INVALID_UID",i[i.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",i[i.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",i[i.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",i[i.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",i[i.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",i[i.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",i[i.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",i[i.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",i[i.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",i[i.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",i[i.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",i[i.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",i[i.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",i[i.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",i[i.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",i[i.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",i[i.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",i[i.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",i[i.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",i[i.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",i[i.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",i[i.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",i[i.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",i[i.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",i[i.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",i[i.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",i[i.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",i[i.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",i[i.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",i[i.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",i[i.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",i[i.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",i[i.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",i[i.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",i[i.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",i[i.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",i[i.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY"}(qe||(qe={})),function(i){i.CONNECTING="connecting",i.CONNECTED="connected",i.RECONNECTING="reconnecting",i.CLOSED="closed"}(wt||(wt={})),function(i){i.WS_CONNECTED="ws_connected",i.WS_RECONNECTING="ws_reconnecting",i.WS_CLOSED="ws_closed",i.WS_RECONNECT_WAITTING_FINISH="ws_reconnect_waitting_finish",i.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",i.ON_BINARY_DATA="on_binary_data",i.REQUEST_RECOVER="request_recover",i.REQUEST_JOIN_INFO="request_join_info",i.REQUEST_REJOIN_INFO="req_rejoin_info",i.IS_P2P_DISCONNECTED="is_p2p_dis",i.DISCONNECT_P2P="dis_p2p",i.ABORT_P2P_EXECUTION="abort_p2p_execution",i.NEED_RENEW_SESSION="need-sid",i.REPORT_JOIN_GATEWAY="report_join_gateway",i.REQUEST_TIMEOUT="request_timeout",i.REQUEST_SUCCESS="request_success",i.JOIN_RESPONSE="join_response",i.DATACHANNEL_PRECONNECT="datachannel_preconnect",i.DATACHANNEL_CONNECTING="datachannel_connecting",i.DATACHANNEL_FAILBACK="datachannel_failback",i.P2P_CONNECTION="p2p_connection",i.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",i.P2P_SUBSCRIBE="p2p_subscribe",i.P2P_UNSUBSCRIBE="p2p_unsubscribe",i.P2P_EXCHANGE_SDP="p2p_exchange_sdp",i.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",i.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream"}(Me||(Me={})),function(i){i.PING="ping",i.PING_BACK="ping_back",i.JOIN="join_v3",i.REJOIN="rejoin_v3",i.LEAVE="leave",i.SET_CLIENT_ROLE="set_client_role",i.PUBLISH="publish",i.PUBLISH_DATASTREAM="publish_datastream",i.UNPUBLISH="unpublish",i.UNPUBLISH_DATASTREAM="unpublish_datastream",i.SUBSCRIBE="subscribe",i.PRE_SUBSCRIBE="pre_subscribe",i.SUBSCRIBE_DATASTREAM="subscribe_datastream",i.SUBSCRIBE_STREAMS="subscribe_streams",i.UNSUBSCRIBE="unsubscribe",i.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",i.UNSUBSCRIBE_STREAMS="unsubscribe_streams",i.SUBSCRIBE_CHANGE="subscribe_change",i.TRAFFIC_STATS="traffic_stats",i.RENEW_TOKEN="renew_token",i.SWITCH_VIDEO_STREAM="switch_video_stream",i.DEFAULT_VIDEO_STREAM="default_video_stream",i.SET_FALLBACK_OPTION="set_fallback_option",i.GATEWAY_INFO="gateway_info",i.CONTROL="control",i.SEND_METADATA="send_metadata",i.DATA_STREAM="data_stream",i.PICK_SVC_LAYER="pick_svc_layer",i.RESTART_ICE="restart_ice",i.CONNECT_PC="connect_pc",i.SET_VIDEO_PROFILE="set_video_profile",i.SET_PARAMETER="set_parameter",i.SET_RTM2_FLAG="set_rtm2_flag"}(Ke||(Ke={})),function(i){i.WRTC_STATS="wrtc_stats",i.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",i.DENOISER_STATS="denoiser_stats",i.EXTENSION_USAGE_STATS="extension_usage_stats"}(Jc||(Jc={})),function(i){i.ON_USER_ONLINE="on_user_online",i.ON_USER_OFFLINE="on_user_offline",i.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",i.ON_PUBLISH_STREAM="on_publish_stream",i.ON_UPLINK_STATS="on_uplink_stats",i.ON_P2P_LOST="on_p2p_lost",i.ON_REMOVE_STREAM="on_remove_stream",i.ON_ADD_AUDIO_STREAM="on_add_audio_stream",i.ON_ADD_VIDEO_STREAM="on_add_video_stream",i.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",i.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",i.ON_USER_BANNED="on_user_banned",i.ON_USER_LICENSE_BANNED="on_user_license_banned",i.ON_NOTIFICATION="on_notification",i.ON_CRYPT_ERROR="on_crypt_error",i.MUTE_AUDIO="mute_audio",i.MUTE_VIDEO="mute_video",i.UNMUTE_AUDIO="unmute_audio",i.UNMUTE_VIDEO="unmute_video",i.ON_P2P_OK="on_p2p_ok",i.RECEIVE_METADATA="receive_metadata",i.ON_DATA_STREAM="on_data_stream",i.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",i.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",i.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",i.ENABLE_LOCAL_VIDEO="enable_local_video",i.DISABLE_LOCAL_VIDEO="disable_local_video",i.ENABLE_LOCAL_AUDIO="enable_local_audio",i.DISABLE_LOCAL_AUDIO="disable_local_audio",i.ON_PUBLISHED_USER_LIST="on_published_user_list"}(ot||(ot={})),function(i){i.CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",i.NEED_ANSWER="NEED_ANSWER",i.NEED_RENEGOTIATE="NEED_RENEGOTIATE",i.P2P_LOST="P2P_LOST",i.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",i.NEED_UNPUB="NEED_UNPUB",i.NEED_UNSUB="NEED_UNSUB",i.NEED_UPLOAD="NEED_UPLOAD",i.NEED_CONTROL="NEED_CONTROL",i.START_RECONNECT="START_RECONNECT",i.END_RECONNECT="END_RECONNECT",i.NEED_SIGNAL_RTT="NEED_SIGNAL_RTT"}(oM||(oM={})),function(i){i.SEND_ONLY="SEND_ONLY",i.RECEIVE_ONLY="RECEIVE_ONLY"}(vi||(vi={})),function(i){i.CONNECTED="websocket:connected",i.RECONNECTING="websocket:reconnecting",i.WILL_RECONNECT="websocket:will_reconnect",i.CLOSED="websocket:closed",i.FAILED="websocket:failed",i.ON_MESSAGE="websocket:on_message",i.REQUEST_NEW_URLS="websocket:request_new_urls",i.RECONNECT_WAITTING_FINISH="websocket:reconnect_waitting_finish",i.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",i.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire"}(nt||(nt={}));class ue extends Te{constructor(t){super(t,arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",arguments.length>2?arguments[2]:void 0),w(this,"name","AgoraRTCException")}print(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return super.print(t,L)}throw(){super.throw(L)}}function ST(i){if(typeof i!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(i))throw L.error("Invalid Channel Name ".concat(i)),new ue(z.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function CT(i){if(t=i,!(typeof t=="number"&&Math.floor(t)===t&&0<=t&&t<=4294967295||Fk(i,1,255)))throw new ue(z.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var t;typeof i=="string"&&L.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}(function(i){i.TRANSCODE="mix_streaming",i.RAW="raw_streaming",i.INJECT="inject_streaming"})(br||(br={})),function(i){i[i.INJECT_STREAM_STATUS_START_SUCCESS=0]="INJECT_STREAM_STATUS_START_SUCCESS",i[i.INJECT_STREAM_STATUS_START_ALREADY_EXISTS=1]="INJECT_STREAM_STATUS_START_ALREADY_EXISTS",i[i.INJECT_STREAM_STATUS_START_UNAUTHORIZED=2]="INJECT_STREAM_STATUS_START_UNAUTHORIZED",i[i.INJECT_STREAM_STATUS_START_TIMEOUT=3]="INJECT_STREAM_STATUS_START_TIMEOUT",i[i.INJECT_STREAM_STATUS_START_FAILED=4]="INJECT_STREAM_STATUS_START_FAILED",i[i.INJECT_STREAM_STATUS_STOP_SUCCESS=5]="INJECT_STREAM_STATUS_STOP_SUCCESS",i[i.INJECT_STREAM_STATUS_STOP_NOT_FOUND=6]="INJECT_STREAM_STATUS_STOP_NOT_FOUND",i[i.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED=7]="INJECT_STREAM_STATUS_STOP_UNAUTHORIZED",i[i.INJECT_STREAM_STATUS_STOP_TIMEOUT=8]="INJECT_STREAM_STATUS_STOP_TIMEOUT",i[i.INJECT_STREAM_STATUS_STOP_FAILED=9]="INJECT_STREAM_STATUS_STOP_FAILED",i[i.INJECT_STREAM_STATUS_BROKEN=10]="INJECT_STREAM_STATUS_BROKEN"}(Xl||(Xl={}));const Ree={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},bT={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function TT(i,t){ai(i.url,"".concat(t,".url"),1,1e3,!1),Nn(i.x)||an(i.x,"".concat(t,".x"),0,1e4),Nn(i.y)||an(i.y,"".concat(t,".y"),0,1e4),Nn(i.width)||an(i.width,"".concat(t,".width"),0,1e4),Nn(i.height)||an(i.height,"".concat(t,".height"),0,1e4),Nn(i.zOrder)||an(i.zOrder,"".concat(t,".zOrder"),0,255),Nn(i.alpha)||an(i.alpha,"".concat(t,".alpha"),0,1,!1)}const wee={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},Iee={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30};var es,Hh,nr,aM,Ei,Ls,Wi,Jl,Kt,Ln,pd,vr,kv,$t;function sM(i){if(!i.channelName)throw new ue(z.INVALID_PARAMS,"invalid channelName in info");if(typeof i.uid!="number")throw new ue(z.INVALID_PARAMS,"invalid uid in info, uid must be a number");return i.token&&ai(i.token,"info.token",1,2047),CT(i.uid),ST(i.channelName),!0}(function(i){i.WARNING="@live_uap-warning",i.ERROR="@line_uap-error",i.PUBLISH_STREAM_STATUS="@live_uap-publish-status",i.INJECT_STREAM_STATUS="@live_uap-inject-status",i.WORKER_STATUS="@live_uap-worker-status",i.REQUEST_NEW_ADDRESS="@live_uap-request-address"})(es||(es={})),function(i){i.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(Hh||(Hh={})),function(i){i[i.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",i[i.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",i[i.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",i[i.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",i[i.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",i[i.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",i[i.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",i[i.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",i[i.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",i[i.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",i[i.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",i[i.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",i[i.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",i[i.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",i[i.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",i[i.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",i[i.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",i[i.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",i[i.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",i[i.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",i[i.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(nr||(nr={})),function(i){i.CONNECT_FAILED="connect failed",i.CONNECT_TIMEOUT="connect timeout",i.WS_DISCONNECTED="websocket disconnected",i.REQUEST_TIMEOUT="request timeout",i.REQUEST_FAILED="request failed",i.WAIT_STATUS_TIMEOUT="wait status timeout",i.WAIT_STATUS_ERROR="wait status error",i.BAD_STATE="bad state",i.WS_ABORT="ws abort",i.AP_REQUEST_TIMEOUT="AP request timeout",i.AP_JSON_PARSE_ERROR="AP json parse error",i.AP_REQUEST_ERROR="AP request error",i.AP_REQUEST_ABORT="AP request abort"}(aM||(aM={})),function(i){i[i.SetSdkProfile=0]="SetSdkProfile",i[i.SetSourceChannel=1]="SetSourceChannel",i[i.SetSourceUserId=2]="SetSourceUserId",i[i.SetDestChannel=3]="SetDestChannel",i[i.StartPacketTransfer=4]="StartPacketTransfer",i[i.StopPacketTransfer=5]="StopPacketTransfer",i[i.UpdateDestChannel=6]="UpdateDestChannel",i[i.Reconnect=7]="Reconnect",i[i.SetVideoProfile=8]="SetVideoProfile"}(Ei||(Ei={})),function(i){i.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",i.NETWORK_CONNECTED="NETWORK_CONNECTED",i.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",i.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",i.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",i.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",i.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",i.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",i.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",i.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}(Ls||(Ls={})),function(i){i.RELAY_STATE_IDLE="RELAY_STATE_IDLE",i.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",i.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",i.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE"}(Wi||(Wi={})),function(i){i.RELAY_OK="RELAY_OK",i.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",i.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",i.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED"}(Jl||(Jl={})),function(i){i.High="high",i.Low="low",i.Audio="audio",i.Screen="screen",i.ScreenLow="screen_low"}(Kt||(Kt={})),function(i){i.DISCONNECT="disconnect",i.CONNECTION_STATE_CHANGE="connection-state-change",i.NETWORK_QUALITY="network-quality",i.STREAM_TYPE_CHANGE="stream-type-change",i.IS_P2P_DISCONNECTED="is-p2p-dis",i.DISCONNECT_P2P="dis-p2p",i.REQUEST_NEW_GATEWAY_LIST="req-gate-url",i.NEED_RENEW_SESSION="need-sid",i.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",i.JOIN_RESPONSE="join-response",i.REQUEST_DC_CONNECTION_PARAMS="request-dc-connection-params",i.RESET_CONNECTION_EVENTS="reset-connection-events",i.DATACHANNEL_PRECONNECT="datachannel_preconnect",i.DATACHANNEL_FAILBACK="datachannel_failback",i.RESET_SIGNAL="reset-signal"}(Ln||(Ln={})),function(i){i.P2P_DISCONNECTED="P2P_DISCONNECTED",i.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",i.TIMEOUT="TIMEOUT",i.UNKNOWN_REASON="UNKNOWN_REASON"}(pd||(pd={})),function(i){i[i.Nothing=0]="Nothing",i[i.Audio=1]="Audio",i[i.LwoVideo=2]="LwoVideo",i[i.Video=4]="Video",i[i.Data=8]="Data",i[i.DataStream0=256]="DataStream0",i[i.DataStream1=512]="DataStream1",i[i.DataStream2=1024]="DataStream2",i[i.DataStream3=2048]="DataStream3",i[i.DataStream4=4096]="DataStream4",i[i.DataStream5=8192]="DataStream5",i[i.DataStream6=16384]="DataStream6",i[i.DataStream7=32768]="DataStream7"}(vr||(vr={})),function(i){i[i.websocket=0]="websocket",i[i.datachannel=1]="datachannel"}(kv||(kv={})),function(i){i.CHINA="CHINA",i.ASIA="ASIA",i.NORTH_AMERICA="NORTH_AMERICA",i.EUROPE="EUROPE",i.JAPAN="JAPAN",i.INDIA="INDIA",i.KOREA="KOREA",i.HKMC="HKMC",i.US="US",i.OCEANIA="OCEANIA",i.SOUTH_AMERICA="SOUTH_AMERICA",i.AFRICA="AFRICA",i.OVERSEA="OVERSEA",i.GLOBAL="GLOBAL",i.EXTENSIONS="EXTENSIONS"}($t||($t={}));const cM=[$t.AFRICA,$t.ASIA,$t.CHINA,$t.EUROPE,$t.GLOBAL,$t.INDIA,$t.JAPAN,$t.NORTH_AMERICA,$t.OCEANIA,$t.OVERSEA,$t.SOUTH_AMERICA];var zr;(function(i){i.CHINA="CN",i.ASIA="AS",i.NORTH_AMERICA="NA",i.EUROPE="EU",i.JAPAN="JP",i.INDIA="IN",i.KOREA="KR",i.HKMC="HK",i.US="US",i.OCEANIA="OC",i.SOUTH_AMERICA="SA",i.AFRICA="AF",i.OVERSEA="OVERSEA",i.GLOBAL="GLOBAL",i.EXTENSIONS="GLOBAL"})(zr||(zr={}));const Lv={CHINA:{},ASIA:{CODE:zr.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:zr.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:zr.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:zr.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:zr.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:zr.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:zr.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:zr.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:zr.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:zr.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:zr.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:zr.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:zr.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};var l0,lM,je,si,Ms,Ie,tn,Qe,uM,qo,Xo,Tr,_c,qn,ts,dM,Po,wa,Ql,Mn,Zl,yc,hM,RT;gT&&(Lv.CHINA={CODE:zr.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),function(i){i.UPDATE_BITRATE_LIMIT="update_bitrate_limit"}(l0||(l0={}));class pM extends wn{constructor(t,n){super(),w(this,"onICEConnectionStateChange",void 0),w(this,"onConnectionStateChange",void 0),w(this,"onDTLSTransportStateChange",void 0),w(this,"onDTLSTransportError",void 0),w(this,"onICETransportStateChange",void 0),w(this,"onFirstAudioReceived",void 0),w(this,"onFirstVideoReceived",void 0),w(this,"onFirstAudioDecoded",void 0),w(this,"onFirstVideoDecoded",void 0),w(this,"onFirstVideoDecodedTimeout",void 0),w(this,"onSelectedLocalCandidateChanged",void 0),w(this,"onSelectedRemoteCandidateChanged",void 0)}}class Mv extends pM{constructor(t,n){super(t,n)}}(function(i){i.SEND="sendonly",i.RECV="recvonly",i.SENDRECV="sendrecv",i.INACTIVE="inactive"})(lM||(lM={})),function(i){i.VIDEO="video",i.AUDIO="audio"}(je||(je={})),function(i){i[i.UDP=0]="UDP",i[i.TCP=1]="TCP",i[i.RELAY=2]="RELAY"}(si||(si={})),function(i){i[i.FIRST_CONNECTION=0]="FIRST_CONNECTION",i[i.TCP_RESTART=1]="TCP_RESTART",i[i.RELAY_RESTART=2]="RELAY_RESTART",i[i.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",i[i.OLD_RESTART=11]="OLD_RESTART",i[i.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED"}(Ms||(Ms={})),function(i){i.LocalVideoTrack="videoTrack",i.LocalAudioTrack="audioTrack",i.LocalVideoLowTrack="videoLowTrack"}(Ie||(Ie={})),function(i){i.New="new",i.Connected="connected",i.Reconnecting="reconnecting",i.Disconnected="disconnected"}(tn||(tn={})),function(i){i.StateChange="stateChange",i.IceConnectionStateChange="iceConnectionStateChange",i.RequestMuteLocal="requestMuteLocal",i.RequestUnmuteLocal="requestUnmuteLocal",i.RequestRePublish="requestRePublish",i.RequestRePublishDataChannel="requestRePublishDataChannel",i.RequestReSubscribe="requestReSubscribe",i.RequestUploadStats="requestUploadStats",i.RequestUpload="requestUpload",i.MediaReconnectStart="MediaReconnectStart",i.MediaReconnectEnd="MediaReconnectEnd",i.NeedSignalRTT="NeedSignalRTT",i.RequestRestartICE="RequestRestartIce",i.PeerConnectionStateChange="PeerConnectionStateChange",i.RequestReconnect="RequestReconnect",i.RequestReconnectPC="RequestReconnectPC",i.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",i.P2PLost="P2PLost",i.UpdateVideoEncoder="UpdateVideoEncoder",i.ConnectionTypeChange="ConnectionTypeChange",i.RequestLowStreamParameter="RequestLowStreamParameter",i.QueryClientConnectionState="QueryClientConnectionState",i.LocalCandidate="LocalCandidate",i.RequestP2PMuteLocal="requestP2PMuteLocal",i.RequestP2PUnPublish="RequestP2PUnPublish",i.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",i.RequestP2PMuteRemote="RequestP2PMuteRemote",i.RequestP2PRestartICE="RequestP2PRestartICE"}(Qe||(Qe={})),function(i){i.MUTE_LOCAL_VIDEO="mute_local_video",i.MUTE_LOCAL_AUDIO="mute_local_audio",i.UNMUTE_LOCAL_VIDEO="unmute_local_video",i.UNMUTE_LOCAL_AUDIO="unmute_local_audio",i.MUTE_REMOTE_VIDEO="mute_remote_video",i.MUTE_REMOTE_AUDIO="mute_remote_audio",i.UNMUTE_REMOTE_VIDEO="unmute_remote_video",i.UNMUTE_REMOTE_AUDIO="unmute_remote_audio"}(uM||(uM={})),function(i){i.CONNECTING="CONNECTING",i.RECONNECTING="RECONNECTING",i.CONNECTED="CONNECTED",i.CLOSED="CLOSED"}(qo||(qo={})),function(i){i[i.CONNECT_AP=0]="CONNECT_AP",i[i.AP_CONNECTED=1]="AP_CONNECTED",i[i.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",i[i.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",i[i.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",i[i.CONNECT_WORKER=5]="CONNECT_WORKER",i[i.WORKER_CONNECTED=6]="WORKER_CONNECTED",i[i.CLOSED=7]="CLOSED"}(Xo||(Xo={})),function(i){i.CONNECTION_STATE_CHANGE="connection-state-change",i.STATE_CHANGE="state-change",i.INSPECT_RESULT="inspect-result",i.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",i.REQUEST_NEW_WORKER_URL="request-new-worker-url"}(Tr||(Tr={})),function(i){i.NETWORK_ERROR="NETWORK_ERROR",i.SERVER_ERROR="SERVER_ERROR",i.MULTI_IP="MULTI_IP",i.TIMEOUT="TIMEOUT",i.OFFLINE="OFFLINE",i.LEAVE="LEAVE",i.P2P_FAILED="P2P_FAILED",i.FALLBACK="FALLBACK"}(_c||(_c={})),function(i){i.CONNECTED="transmitter:connected",i.RECONNECTING="transmitter:reconnecting",i.WILL_RECONNECT="transmitter:will_reconnect",i.CLOSED="transmitter:closed",i.FAILED="transmitter:failed",i.ON_MESSAGE="transmitter:on_message",i.REQUEST_NEW_URLS="transmitter:request_new_urls",i.RECONNECT_WAITTING_FINISH="transmitter:reconnect_waitting_finish",i.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",i.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",i.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",i.FAILBACK="transmitter:failback"}(qn||(qn={})),function(i){i.CAMERA_CHANGED="camera-changed",i.MICROPHONE_CHANGED="microphone-changed",i.PLAYBACK_DEVICE_CHANGED="playback-device-changed",i.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",i.AUTOPLAY_FAILED="autoplay-failed",i.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",i.SECURITY_POLICY_VIOLATION="security-policy-violation"}(ts||(ts={})),function(i){i[i.APP_TYPE_INVALID_VALUE=-1]="APP_TYPE_INVALID_VALUE",i[i.APP_TYPE_NATIVE=0]="APP_TYPE_NATIVE",i[i.APP_TYPE_NATIVE_COCOS=1]="APP_TYPE_NATIVE_COCOS",i[i.APP_TYPE_NATIVE_UNITY=2]="APP_TYPE_NATIVE_UNITY",i[i.APP_TYPE_NATIVE_ELECTRON=3]="APP_TYPE_NATIVE_ELECTRON",i[i.APP_TYPE_NATIVE_FLUTTER=4]="APP_TYPE_NATIVE_FLUTTER",i[i.APP_TYPE_NATIVE_UNREAL=5]="APP_TYPE_NATIVE_UNREAL",i[i.APP_TYPE_NATIVE_XAMARIN=6]="APP_TYPE_NATIVE_XAMARIN",i[i.APP_TYPE_NATIVE_API_CLOUD=7]="APP_TYPE_NATIVE_API_CLOUD",i[i.APP_TYPE_NATIVE_REACT_NATIVE=8]="APP_TYPE_NATIVE_REACT_NATIVE",i[i.APP_TYPE_NATIVE_PYTHON=9]="APP_TYPE_NATIVE_PYTHON",i[i.APP_TYPE_NATIVE_COCOS_CREATOR=10]="APP_TYPE_NATIVE_COCOS_CREATOR",i[i.APP_TYPE_NATIVE_RUST=11]="APP_TYPE_NATIVE_RUST",i[i.APP_TYPE_NATIVE_C_SHARP=12]="APP_TYPE_NATIVE_C_SHARP",i[i.APP_TYPE_NATIVE_CEF=13]="APP_TYPE_NATIVE_CEF",i[i.APP_TYPE_NATIVE_UNI_APP=14]="APP_TYPE_NATIVE_UNI_APP",i[i.APP_TYPE_WEBRTC=1e3]="APP_TYPE_WEBRTC",i[i.APP_TYPE_WEBRTC_REACT=1001]="APP_TYPE_WEBRTC_REACT",i[i.APP_TYPE_WEBRTC_VUE=1002]="APP_TYPE_WEBRTC_VUE",i[i.APP_TYPE_WEBRTC_ANGULAR=1003]="APP_TYPE_WEBRTC_ANGULAR"}(dM||(dM={})),function(i){i.CONNECTING="CONNECTING",i.RECONNECTING="RECONNECTING",i.CONNECTED="CONNECTED",i.CLOSED="CLOSED"}(Po||(Po={})),function(i){i.CONNECTION_STATE_CHANGE="connection-state-change",i.STATE_CHANGE="state-change",i.INSPECT_RESULT="inspect-result",i.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",i.REQUEST_NEW_WORKER_URL="request-new-worker-url"}(wa||(wa={})),function(i){i[i.CONNECT_AP=0]="CONNECT_AP",i[i.AP_CONNECTED=1]="AP_CONNECTED",i[i.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",i[i.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",i[i.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",i[i.CONNECT_WORKER=5]="CONNECT_WORKER",i[i.WORKER_CONNECTED=6]="WORKER_CONNECTED",i[i.CLOSED=7]="CLOSED"}(Ql||(Ql={})),function(i){i.CALL="call",i.CANDIDATE="candidate",i.PUBLISH="publish",i.UNPUBLISH="unpublish",i.CONTROL="control",i.RESTART_ICE="restart_ice",i.ACK="ack",i.RESPONSE="response",i.JOIN="join",i.CHECK="check"}(Mn||(Mn={})),function(i){i.ABORT="abort"}(Zl||(Zl={})),function(i){i.MUTE_LOCAL_AUDIO="mute_local_audio",i.MUTE_LOCAL_VIDEO="mute_local_video",i.UNMUTE_LOCAL_AUDIO="unmute_local_audio",i.UNMUTE_LOCAL_VIDEO="unmute_local_video"}(yc||(yc={})),function(i){i[i.SUCCESS=1]="SUCCESS",i[i.FAILED=0]="FAILED"}(hM||(hM={})),function(i){i.P2P_TOKEN_TIMEOUT="p2p_token_timeout",i.P2P_TOKEN_CHANGED="p2p_token_changed"}(RT||(RT={}));const Aee={[$h.ACCESS_POINT]:{[gi.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[gi.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[gi.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[gi.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[gi.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[gi.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[gi.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[gi.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[gi.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[gi.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[gi.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[gi.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[gi.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[gi.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[gi.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[gi.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[gi.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[gi.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[$h.UNILBS]:{[Yo.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[Yo.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[Yo.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[Yo.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[Yo.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[Yo.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[Yo.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[Yo.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[Yo.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[Yo.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[Yo.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[Yo.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[$h.STRING_UID_ALLOCATOR]:{[c0.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[c0.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[c0.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function Fv(i){const t=Aee[Math.floor(i/1e4)];if(!t)return{desc:"unkonw error",retry:!1};const n=t[i%1e4];if(!n){if(Math.floor(i/1e4)===$h.ACCESS_POINT){const a=i%1e4;if(a.toString()[0]==="1")return{desc:i.toString(),retry:!1};if(a.toString()[0]==="2")return{desc:i.toString(),retry:!0}}return{desc:"unkonw error",retry:!1}}return n}const Oee={[qe.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[qe.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[qe.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[qe.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[qe.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[qe.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[qe.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[qe.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[qe.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[qe.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[qe.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[qe.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[qe.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[qe.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[qe.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[qe.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[qe.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[qe.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[qe.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[qe.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[qe.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[qe.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[qe.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[qe.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[qe.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[qe.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[qe.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[qe.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[qe.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[qe.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[qe.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[qe.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[qe.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[qe.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[qe.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[qe.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[qe.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[qe.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[qe.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[qe.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[qe.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[qe.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[qe.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[qe.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[qe.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[qe.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[qe.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[qe.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[qe.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[qe.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[qe.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[qe.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[qe.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[qe.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[qe.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[qe.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[qe.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[qe.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[qe.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[qe.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[qe.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[qe.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[qe.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function fd(i){return Oee[i]||{desc:"UNKNOW_ERROR_".concat(i),action:"failed"}}function fM(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function wT(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fM(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):fM(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}function mM(i){return i.every(t=>t.readyState===WebSocket.CLOSED||t.readyState===WebSocket.CLOSING)}function gM(i,t){if(typeof i=="string")return i;const{proxy:n,host:a,port:l}=i;if(t){const u=J("JOIN_GATEWAY_FALLBACK_PORT")||443;return u===443?"wss://".concat(a,"/ws/?p=").concat(Number(l)+150):"wss://".concat(a,":").concat(u,"/ws/?p=").concat(Number(l)+150)}return n?"wss://".concat(n,"/ws/?h=").concat(a,"&p=").concat(l):"wss://".concat(a,":").concat(l)}const xee=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,Nee=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,Pee=/wss:\/\/(.+):([0-9]+)\/?/,Dee=/wss:\/\/(.[^\/]+)\/?/;let kee=0;class Lee{constructor(t,n){w(this,"id",0),w(this,"store",void 0),w(this,"recordIndex",void 0),w(this,"websockets",[]),w(this,"try443PortDuration",2e3),w(this,"forceCloseWSDuration",5e3),w(this,"try443PortTimeout",null),w(this,"forceCloseTimeout",null),w(this,"isTry443PortFailed",!1),w(this,"isNormalPortFailed",!1),w(this,"useDoubleDomain",!1),w(this,"useProxy",!1),w(this,"startTime",Date.now()),this.id=++kee,this.try443PortDuration=J("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=t||5e3,this.store=n}closeAllWebsockets(){this.websockets.forEach(t=>{t.onopen=null,t.onclose=null,t.onmessage=null,t.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout)}logger(){var t;const n=Date.now()-this.startTime;for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];L.debug("[choose-best-ws ".concat((t=this.store)===null||t===void 0?void 0:t.clientId," ").concat(this.id,"] ").concat(n,"ms:"),...l)}createWebSocket(t,n,a){this.logger("createWebSocket:",t,{isTry443Port:n,hasTimeoutDetection:a});const l=J("GATEWAY_DOMAINS"),u=Date.now(),h=[],p=l.find(y=>{var C;return Be(C=t.host).call(C,y)});p||(this.useDoubleDomain=!1);const v=[];if(this.useDoubleDomain)l.forEach(y=>{v.push(gM(wT(wT({},t),{},{host:t.host.replace(p,y)}),n))});else{const y=wT({},t);if(n&&p){const C=l.find(I=>I!==p);C&&(y.host=y.host.replace(p,C))}v.push(gM(y,n))}try{v.forEach(y=>{const C=new WebSocket(y);C.binaryType="arraybuffer",h.push(C),this.logger("ws is connecting:",C.url)})}catch(y){if(this.logger("ws create failed"),h.forEach(C=>C.close()),h.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(t,n,a);if(!n&&Number(t.port)!==443)return this.createWebSocket(t,!0,a);throw new ue(z.WS_ERR,"init websocket failed! Error: ".concat(y.toString()))}const E=t0();return this.store&&this.store.recordJoinChannelService({urls:h.map(y=>y.url),service:"gateway"},this.recordIndex),h.forEach(y=>{y.onopen=()=>{this.logger("onopen: ws ".concat(y.url," open cost ").concat(Date.now()-u,"ms")),this.websockets.forEach(C=>{C!==y&&(C.onopen=null,C.onclose=null,C.onmessage=null,C.close(),this.logger("close backup websocket: ".concat(C.url)))}),this.websockets.length=0,E.resolve(y)},y.onclose=C=>{this.logger("onclose: ws ".concat(y.url," closed cost ").concat(Date.now()-u,"ms state: ").concat(y.readyState)),n?this.isTry443PortFailed=mM(h):this.isNormalPortFailed=mM(h),this.logger("443: ".concat(this.useProxy?"not try":this.isTry443PortFailed?"failed":"trying"," 47xx: ").concat(this.isNormalPortFailed?"failed":"trying")),(n&&this.isTry443PortFailed||!n&&(this.isTry443PortFailed||this.useProxy)&&this.isNormalPortFailed)&&(this.logger("onclose: all websocket is closed, ".concat(C.reason)),E.reject({code:C.code,reason:pd.A_ROUND_WS_FAILED}))},y.onmessage=C=>this.logger("".concat(y.url," onmessage: ").concat(C.data))}),this.websockets.push(...h),a||(()=>{const y=()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",E.isResolved),this.websockets.forEach(C=>C.readyState!==WebSocket.OPEN&&C.close())};if(n||this.useProxy)return this.logger("add 5s timeout at ".concat(n?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(y,this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{if(this.logger("2s timeout, isWebsocket created: ",E.isResolved),E.isResolved)return y();Wt().os===yr.MAC_OS&&un()&&y(),this.createWebSocket(t,!0,!0).then(C=>E.resolve(C)).catch(C=>{this.isNormalPortFailed&&E.reject(C),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(y,this.forceCloseWSDuration)},this.try443PortDuration)})(),E.promise}chooseBestWebsocket(t,n,a,l){return this.useDoubleDomain=!!n,typeof t=="string"&&(t=function(u){let h,p,v;return[,h,p,v]=u.match(xee)||[],h||([,p,v]=u.match(Nee)||[]),p&&v||([,p,v]=u.match(Pee)||[]),p&&v||([,p]=u.match(Dee)||[]),p||L.warning("un-destructible url: ",u),{proxy:h,host:p,port:v||"443"}}(t)),this.recordIndex=l,this.useProxy=!!t.proxy,a&&this.useProxy&&(L.warn("cannot use 443 only when use proxy"),a=!1),this.createWebSocket(t,!!a,!1).finally(()=>this.clearTimeout())}}function vM(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}class EM extends wn{get url(){return this.websocket&&this.websocket.url||null}get reconnectMode(){return this._reconnectMode}set reconnectMode(t){var n;Be(n=["tryNext","recover"]).call(n,t)&&this.resetReconnectCount(t),this._reconnectMode=t}get state(){return this._state}set state(t){t!==this._state&&(this._state=t,this._state==="reconnecting"?this.emit(nt.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(nt.CONNECTED):this._state==="closed"?this.emit(nt.CLOSED):this._state==="failed"&&this.emit(nt.FAILED))}resetReconnectCount(t){L.debug("websocket reset reconnect count, reason: "+t),this.reconnectCount=0}constructor(t,n){let a=arguments.length>2&&arguments[2]!==void 0&&arguments[2],l=arguments.length>3&&arguments[3]!==void 0&&arguments[3],u=arguments.length>4&&arguments[4]!==void 0&&arguments[4],h=arguments.length>5?arguments[5]:void 0;super(),w(this,"connectionID",0),w(this,"currentURLIndex",0),w(this,"urls",[]),w(this,"_reconnectMode","tryNext"),w(this,"reconnectReason",void 0),w(this,"_initMutex",new Ur("websocket")),w(this,"name",void 0),w(this,"_state","closed"),w(this,"reconnectInterrupter",void 0),w(this,"websocket",void 0),w(this,"retryConfig",void 0),w(this,"reconnectCount",0),w(this,"forceCloseTimeout",5e3),w(this,"onlineReconnectListener",void 0),w(this,"useCompress",void 0),w(this,"tryDoubleDomain",!1),w(this,"use443PortOnly",!1),w(this,"wsInflateLength",0),w(this,"wsDeflateLength",0),w(this,"closeEstablishingWs",()=>{}),w(this,"store",void 0),w(this,"joinGatewayRecordIndex",void 0),this.store=h,this.name=t,this.retryConfig=function(C){for(var I=1;I<arguments.length;I++){var k=arguments[I]!=null?arguments[I]:{};I%2?vM(Object(k),!0).forEach(function(G){w(C,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(k)):vM(Object(k)).forEach(function(G){Object.defineProperty(C,G,Object.getOwnPropertyDescriptor(k,G))})}return C}({},n),this.useCompress=a,this.tryDoubleDomain=l,this.use443PortOnly=u;const{timeout:p,timeoutFactor:v}=n,E=Math.max(300,Math.floor(3*p/5)),y=Math.max(1.2,Math.floor(8*v)/10);Di.ONLINE&&(this.retryConfig.timeout=E,this.retryConfig.timeoutFactor=y),lr.on(qc.NETWORK_STATE_CHANGE,(C,I)=>{C!==I&&(this.resetReconnectCount("network state change: ".concat(I," -> ").concat(C)),C===Di.ONLINE?(this.retryConfig.timeout=E,this.retryConfig.timeoutFactor=y):(this.retryConfig.timeout=p,this.retryConfig.timeoutFactor=v))})}getConnection(){return this.websocket||void 0}async init(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const a=await this._initMutex.lock();this.forceCloseTimeout=n,this.urls=t,this.state="connecting";try{const l=t0(),u=this.urls[this.currentURLIndex];this.createWebSocketConnection(u).then(l.resolve).catch(l.reject),this.once(nt.CLOSED,()=>{l.reject(new Te(z.WS_DISCONNECT))}),this.once(nt.CONNECTED,l.resolve),await l.promise}catch{}finally{a()}}close(t,n){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const a=this.websocket;n?setTimeout(()=>a.close(),500):a.close(),this.websocket=void 0}this.state=t?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(t,n){if(!this.websocket)return void L.warning("[".concat(this.name,"] can not reconnect, no websocket"));t!==void 0&&(this.reconnectMode=t),L.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinGatewayRecordIndex=="number"&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(n)]},this.joinGatewayRecordIndex);const a=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),a&&a.bind(this.websocket)({code:9999,reason:n})}sendMessage(t){let n=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new Te(z.WS_ABORT,"websocket is not ready");try{n||(t=JSON.stringify(t)),this.websocket.send(t)}catch(a){throw new Te(z.WS_ERR,"send websocket message error"+a.toString())}}setWsInflateData(t){this.wsDeflateLength=this.wsDeflateLength+t.originLength,this.wsInflateLength=this.wsInflateLength+t.compressedLength}getWsInflateData(){const t=this.wsInflateLength,n=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:t,wsDeflateLength:n}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(t){var n;const a=t0();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const l=y=>{var C;(C=this.store)===null||C===void 0||C.signalChannelOpen(),L.debug("[".concat(this.name,"] websocket opened:"),y),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),a.resolve()},u=async y=>{var C;if(L.debug("[".concat(this.name,"] websocket close ").concat((C=this.websocket)===null||C===void 0?void 0:C.url,", code: ").concat(y.code,", reason: ").concat(y.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)a.reject(new Te(z.WS_DISCONNECT,"websocket close: ".concat(y.code))),this.close();else{this.state==="connected"&&(this.reconnectReason=y.reason,this.state="reconnecting");const I=No(this,nt.WILL_RECONNECT,this.reconnectMode,y.reason)||this.reconnectMode,k=await this.reconnectWithAction(I);if(this.state==="closed")return void L.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!k)return a.reject(new Te(z.WS_DISCONNECT,"websocket reconnect failed: ".concat(y.code))),this.close(!0);a.resolve()}},h=y=>{this.emit(nt.ON_MESSAGE,y)},p=y=>{L.warn("[".concat(this.connectionID,"] ws open error ").concat(y))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),J("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(t=J("GATEWAY_WSS_ADDRESS")),L.debug("[".concat(this.name,"] start connect, url:"),t);const v=(n=this.store)===null||n===void 0?void 0:n.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var E;const y=await this.chooseBestWebsocketConnection(t);this.websocket=y,l&&l(this.websocket.url),this.websocket.onclose=u,this.websocket.onmessage=h,this.websocket.onerror=p,(E=this.store)===null||E===void 0||E.recordJoinChannelService({endTs:Date.now(),status:"success"},v),this.joinGatewayRecordIndex=v}catch(y){const C=this.state==="closed",I=y instanceof Te,k=I&&y.code===z.WS_ABORT,G=I&&y.code===z.WS_ERR,B=I?y.message:y&&(y.reason||y.toString());L.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(B)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:k?"aborted":"error",errors:[y]},v),C||G?(a.reject(C?new Te(z.WS_DISCONNECT,"websocket is closed: ".concat(B)):new Te(z.WS_ERR,"init websocket failed: ".concat(B))),G&&L.error("[".concat(this.name,"] init websocket failed: ").concat(B))):u&&u(y)}return a.promise}async reconnectWithAction(t){let n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||this.urls.length===0||this.state==="closed")return!1;L.warning("[choose-best-ws] action: =>",t),this.onlineReconnectListener||lr.isOnline||!lr.onlineWaiter||(this.onlineReconnectListener=lr.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let a=!0;if(this.reconnectInterrupter=()=>a=!1,n){const h=Cv(this.reconnectCount,this.retryConfig);L.debug("[".concat(this.name,"] wait ").concat(h,"ms to reconnect websocket, mode: ").concat(t)),await _e.race([Fr(h),this.onlineReconnectListener||new _e(()=>{})])}if(this._state==="closed"||!a)return!1;this.reconnectCount+=1;const l=async(h,p)=>{this.emit(nt.RECONNECT_CREATE_CONNECTION,p),await this.createWebSocketConnection(h)};try{if(t==="retry")this.emit(nt.RECONNECT_WAITTING_FINISH,t),await l(this.urls[this.currentURLIndex],t);else if(t==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);L.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),this.emit(nt.RECONNECT_WAITTING_FINISH,t),await l(this.urls[this.currentURLIndex],t)}else t==="recover"&&(L.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.emit(nt.RECONNECT_WAITTING_FINISH,t),this.urls=await cr(this,nt.REQUEST_NEW_URLS),this.currentURLIndex=0,await l(this.urls[this.currentURLIndex],t))}catch(h){var u;L.error("[".concat(this.name,"] reconnect failed ").concat(h&&h.toString()));const p=h==null||(u=h.data)===null||u===void 0?void 0:u.desc;return Array.isArray(p)&&Be(p).call(p,"dynamic key expired")?(this.emit(nt.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(t,n)}return!0}}class u0 extends EM{constructor(t,n){super(t,n,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(t,n){const a=t0(),l=function(h,p){return new Lee(h,p)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{L.debug("[choose-best-ws] close establishing websockets"),l.closeAllWebsockets(),a.reject(new Te(z.WS_ABORT,"choose best websocket aborted"))};const u=J("GATEWAY_DOMAINS");return L.debug("[choose-best-ws] currentDomain: ",t,", domains: ",u,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),l.chooseBestWebsocket(t,this.tryDoubleDomain,this.use443PortOnly,n).then(a.resolve).catch(a.reject),a.promise.finally(()=>{this.closeEstablishingWs=void 0})}}class d0 extends EM{constructor(t,n){super(t,n,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(t,n){return new _e((a,l)=>{let u=!1;const h=[];this.closeEstablishingWs=()=>{L.debug("[choose-best-ws] close establishing websockets"),h.forEach(G=>{G.onclose=null,G.onopen=null,G.onmessage=null,G.close()}),l(new Te(z.WS_ABORT,"choose best websocket aborted"))};const p=J("GATEWAY_DOMAINS");let v;const E=t.indexOf("?h="),y=p.find(G=>E!==-1?Be(t).call(t,G,E):Be(t).call(t,G));L.debug("[choose-best-ws] currentDomain: ",y,", domains: ",p);let C=!this.tryDoubleDomain||!y;if(!C&&y){var I;const G=Date.now();try{p.forEach(B=>{const j=E===-1?t.replace(y,B):t.substr(0,E)+t.substr(E).replace(y,B),q=new WebSocket(j);q.binaryType="arraybuffer",h.push(q),L.debug("[choose-best-ws] ws is connecting:",q.url)})}catch{for(L.debug("[choose-best-ws] ws create failed, fallback to single url"),h.forEach(j=>j.close());h.length;)h.pop();C=!0}(I=this.store)===null||I===void 0||I.recordJoinChannelService({urls:h.map(B=>B.url),service:"gateway"},n),h.forEach(B=>{B.onopen=()=>{if(u)return;const j=Date.now()-G;L.debug("[choose-best-ws] ws open cost ".concat(j,"ms")),h.filter(q=>q!==B).forEach(q=>{L.debug("[choose-best-ws]close backup websocket: ".concat(q.url)),q.close()}),u=!0,a(B)},B.onclose=j=>{v=j,!u&&(h.find(q=>!(q.readyState===WebSocket.CLOSED||q.readyState===WebSocket.CLOSING))||(L.debug("[choose-best-ws] all websocket is closed"),u=!0,l(v)))},B.onmessage=j=>{L.debug("[choose-best-ws]".concat(B.url," onmessage: ").concat(j.data))}}),Fr(this.forceCloseTimeout).then(()=>{h.forEach(B=>{B.readyState!==WebSocket.OPEN&&B.close()})})}if(C){var k;let G;L.debug("[choose-best-ws] use single url: ",t),(k=this.store)===null||k===void 0||k.recordJoinChannelService({urls:[t],service:"gateway"},n);try{G=new WebSocket(t),h.push(G),G.binaryType="arraybuffer"}catch(B){const j=new Te(z.WS_ERR,"init websocket failed! Error: ".concat(B.toString()));return L.error("[".concat(this.name,"]").concat(j)),void l(j)}G.onopen=()=>{a(G)},G.onclose=B=>{l(B)},G.onmessage=B=>{L.debug("[choose-best-ws]".concat(G.url," onmessage: ").concat(B.data))},Fr(this.forceCloseTimeout).then(()=>{G&&G.readyState!==WebSocket.OPEN&&G.close()})}}).then(a=>(this.closeEstablishingWs=void 0,a)).catch(a=>{throw this.closeEstablishingWs=void 0,a})}}class _M extends wn{get connectionState(){return this._connectionState}set connectionState(t){t!==this._connectionState&&(this._connectionState=t,t===wt.CONNECTED?this.emit(Me.WS_CONNECTED):t===wt.RECONNECTING?this.emit(Me.WS_RECONNECTING,this._websocketReconnectReason):t===wt.CLOSED&&this.emit(Me.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(t,n){super(),w(this,"_disconnectedReason",void 0),w(this,"_websocketReconnectReason",void 0),w(this,"_connectionState",wt.CLOSED),w(this,"reconnectToken",void 0),w(this,"websocket",void 0),w(this,"openConnectionTime",void 0),w(this,"clientId",void 0),w(this,"lastMsgTime",Date.now()),w(this,"uploadCache",[]),w(this,"uploadCacheInterval",void 0),w(this,"rttRolling",new Jb(5)),w(this,"pingpongTimer",void 0),w(this,"wsInflateDataTimer",void 0),w(this,"pingpongTimeoutCount",0),w(this,"joinResponse",void 0),w(this,"multiIpOption",void 0),w(this,"initError",void 0),w(this,"spec",void 0),w(this,"store",void 0),w(this,"onWebsocketMessage",a=>{if(a.data instanceof ArrayBuffer)return void this.emit(Me.ON_BINARY_DATA,a.data);const l=JSON.parse(a.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(l,"_id")){const u="res-@".concat(l._id);this.emit(u,l._result,l._message)}else if(Object.prototype.hasOwnProperty.call(l,"_type")){if(this.emit(l._type,l._message),l._type===ot.ON_NOTIFICATION&&this.handleNotification(l._message),l._type===ot.ON_USER_BANNED)switch(l._message.error_code){case 14:this.close(xt.UID_BANNED);break;case 15:this.close(xt.IP_BANNED);break;case 16:this.close(xt.CHANNEL_BANNED)}if(l._type===ot.ON_USER_LICENSE_BANNED)switch(l._message.error_code){case qe.ERR_LICENSE_MISSING:this.close(xt.LICENSE_MISSING);break;case qe.ERR_LICENSE_EXPIRED:this.close(xt.LICENSE_EXPIRED);break;case qe.ERR_LICENSE_MINUTES_EXCEEDED:this.close(xt.LICENSE_MINUTES_EXCEEDED);break;case qe.ERR_LICENSE_PERIOD_INVALID:this.close(xt.LICENSE_PERIOD_INVALID);break;case qe.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(xt.LICENSE_MULTIPLE_SDK_SERVICE);break;case qe.ERR_LICENSE_ILLEGAL:this.close(xt.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=t.clientId,this.spec=t,this.store=n,this.websocket=new u0("gateway-".concat(this.clientId),this.spec.retryConfig,!0,J("JOIN_GATEWAY_USE_DUAL_DOMAIN"),J("JOIN_GATEWAY_USE_443PORT_ONLY"),n),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===wt.CONNECTED&&this.reconnect("retry",Mr.OFFLINE)})}async request(t,n,a,l){const u=pn(6,""),h={_id:u,_type:t,_message:n},p=this.websocket.connectionID,v=()=>new _e((G,B)=>{if(this.connectionState===wt.CONNECTED)return G();const j=()=>{this.off(Me.WS_CLOSED,q),G()},q=()=>{this.off(Me.WS_CONNECTED,j),B(new ue(z.WS_ABORT))};this.once(Me.WS_CONNECTED,j),this.once(Me.WS_CLOSED,q),t!==Ke.PUBLISH&&t!==Ke.SUBSCRIBE&&t!==Ke.UNSUBSCRIBE&&t!==Ke.UNPUBLISH&&t!==Ke.CONTROL&&t!==Ke.RESTART_ICE||this.once(Me.DISCONNECT_P2P,()=>{B(new ue(z.DISCONNECT_P2P))}),t!==Ke.PUBLISH&&t!==Ke.RESTART_ICE||this.once(Me.ABORT_P2P_EXECUTION,()=>{B(new ue(z.DISCONNECT_P2P))})});if(this.connectionState!==wt.CONNECTING&&this.connectionState!==wt.RECONNECTING||t===Ke.JOIN||t===Ke.REJOIN||await v(),this.websocket.sendMessage(h,!0),l)return;const E=new _e((G,B)=>{let j=!1;const q=(re,Ce)=>{j=!0,G({isSuccess:re==="success",message:Ce||{}}),this.off(Me.WS_CLOSED,Z),this.off(Me.WS_RECONNECTING,Z),this.emit(Me.REQUEST_SUCCESS,t,n)};this.once("res-@".concat(u),q);const Z=()=>{B(new ue(z.WS_ABORT,"type: ".concat(t))),this.off(Me.WS_CLOSED,Z),this.off(Me.WS_RECONNECTING,Z),this.off("res-@".concat(u),q)};this.once(Me.WS_CLOSED,Z),this.once(Me.WS_RECONNECTING,Z),Fr(J("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==p||j||(L.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(t)),this.emit(Me.REQUEST_TIMEOUT,t,n))})});let y=null;try{y=await E}catch(G){if(this.connectionState===wt.CLOSED||t===Ke.LEAVE)throw new ue(z.WS_ABORT);return!this.spec.forceWaitGatewayResponse||a?G.throw():t===Ke.JOIN||t===Ke.REJOIN?null:(await v(),await this.request(t,n))}if(y.isSuccess)return y.message;const C=Number(y.message.error_code||y.message.code),I=fd(C),k=new ue(z.UNEXPECTED_RESPONSE,"".concat(I.desc,": ").concat(y.message.error_str),{code:C,data:y.message});return I.action==="success"?y.message:(L.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(t,", error_code: ").concat(C,", message: ").concat(I.desc,", action: ").concat(I.action)),C===qe.ERR_TOO_MANY_BROADCASTERS?((t===Ke.JOIN||t===Ke.REJOIN)&&(this.initError=k,this.close()),k.throw()):I.action==="failed"?k.throw():I.action==="quit"?(this.initError=k,this.close(),k.throw()):(C===qe.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=y.message.option,L.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Mr.MULTI_IP)):this.reconnect(I.action,Mr.SERVER_ERROR),t===Ke.JOIN||t===Ke.REJOIN?null:await this.request(t,n)))}waitMessage(t,n){return new _e(a=>{const l=u=>{(!n||n(u))&&(this.off(t,l),a(u))};this.on(t,l)})}uploadWRTCStats(t){if(!this.store.sessionId)return void L.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const n={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:t};this.upload(Jc.WRTC_STATS,n)}upload(t,n){const a={_type:t,_message:n};try{this.websocket.sendMessage(a)}catch{const u=J("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(a),this.uploadCache.length>u&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==wt.CONNECTED)return;const h=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(h._type,h._message)},J("UPLOAD_CACHE_INTERVAL")||2e3))}}send(t,n){const a={_type:t,_message:n};this.websocket.sendMessage(a)}init(t,n){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new _e((a,l)=>{this.once(Me.WS_CONNECTED,()=>a(this.joinResponse)),this.once(Me.WS_CLOSED,()=>l(this.initError||new ue(z.WS_ABORT))),this.connectionState=wt.CONNECTING,this.websocket.init(t).catch(l),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=t||xt.LEAVE,this.connectionState=wt.CLOSED,L.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),t===xt.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new u0("gateway-".concat(this.clientId),this.spec.retryConfig,!0,J("JOIN_GATEWAY_USE_DUAL_DOMAIN"),J("JOIN_GATEWAY_USE_443PORT_ONLY"),this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(Me.ABORT_P2P_EXECUTION);const t=await cr(this,Me.REQUEST_JOIN_INFO),n=await this.request(Ke.JOIN,t);if(!n)return this.emit(Me.REPORT_JOIN_GATEWAY,pd.TIMEOUT,this.url||""),!1;this.joinResponse=n,this.emit(Me.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=wt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new ue(z.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const t=sd(this,Me.REQUEST_REJOIN_INFO);t.token=this.reconnectToken;const n=await this.request(Ke.REJOIN,t);return!!n&&(this.connectionState=wt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),n.peers&&n.peers.forEach(a=>{this.emit(ot.ON_USER_ONLINE,{uid:a.uid}),a.audio&&this.emit(ot.ON_ADD_AUDIO_STREAM,{uid:a.uid,uint_id:a.uint_id,audio:!0,ssrcId:a.audio_ssrc}),a.video&&this.emit(ot.ON_ADD_VIDEO_STREAM,{uid:a.uid,uint_id:a.uint_id,video:!0,ssrcId:a.video_ssrc}),a.audio_mute?this.emit(ot.MUTE_AUDIO,{uid:a.uid}):this.emit(ot.UNMUTE_AUDIO,{uid:a.uid}),a.video_mute?this.emit(ot.MUTE_VIDEO,{uid:a.uid}):this.emit(ot.UNMUTE_VIDEO,{uid:a.uid}),a.audio_enable_local?this.emit(ot.ENABLE_LOCAL_AUDIO,{uid:a.uid}):this.emit(ot.DISABLE_LOCAL_AUDIO,{uid:a.uid}),a.video_enable_local?this.emit(ot.ENABLE_LOCAL_VIDEO,{uid:a.uid}):this.emit(ot.DISABLE_LOCAL_VIDEO,{uid:a.uid}),a.audio||a.video||this.emit(ot.ON_REMOVE_STREAM,{uid:a.uid,uint_id:a.uint_id})}),!0)}reconnect(t,n){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(t,n)}handleNotification(t){L.debug("[".concat(this.clientId,"] receive notification: "),t);const n=fd(t.code);if(n.action!=="success"){if(n.action!=="failed")return n.action==="quit"?(n.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(xt.UID_BANNED),void this.close()):void this.reconnect(n.action,Mr.SERVER_ERROR);L.error("[".concat(this.clientId,"] ignore error: "),n.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const t=J("PING_PONG_TIME_OUT"),n=Date.now();this.pingpongTimeoutCount>=t&&(L.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(n-this.lastMsgTime,"ms")),n-this.lastMsgTime>J("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Mr.TIMEOUT):this.request(Ke.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const a=Date.now()-n;this.rttRolling.add(a),J("REPORT_STATS")&&this.send(Ke.PING_BACK,{pingpongElapse:a})}).catch(a=>{})}handleWsInflateData(){const{wsInflateLength:t,wsDeflateLength:n}=this.websocket.getWsInflateData();t!==0&&n!==0&&this.upload(Jc.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:n,ws_inflate_length:t})}handleWebsocketEvents(){this.websocket.on(nt.RECONNECT_WAITTING_FINISH,t=>{this.emit(Me.WS_RECONNECT_WAITTING_FINISH,t)}),this.websocket.on(nt.RECONNECT_CREATE_CONNECTION,t=>{this.emit(Me.WS_RECONNECT_CREATE_CONNECTION,t)}),this.websocket.on(nt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(nt.CLOSED,()=>{this.connectionState=wt.CLOSED}),this.websocket.on(nt.FAILED,()=>{this._disconnectedReason=xt.NETWORK_ERROR,this.connectionState=wt.CLOSED}),this.websocket.on(nt.RECONNECTING,t=>{this._websocketReconnectReason=t,this.joinResponse=void 0,this.connectionState===wt.CONNECTED?this.connectionState=wt.RECONNECTING:this.connectionState=wt.CONNECTING}),this.websocket.on(nt.WILL_RECONNECT,(t,n,a)=>{const l=sd(this,Me.IS_P2P_DISCONNECTED),u=l||t!=="retry";l&&t==="retry"&&(L.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),t="tryNext",n=pd.P2P_DISCONNECTED),u&&(L.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(t)),this.emit(Me.REPORT_JOIN_GATEWAY,n||pd.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(Me.NEED_RENEW_SESSION),this.emit(Me.DISCONNECT_P2P)),a(t)}),this.websocket.on(nt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(t=>{L.warning("[".concat(this.clientId,"] rejoin failed ").concat(t)),this.reconnect("tryNext",Mr.SERVER_ERROR)}):this.join().catch(t=>{if(this.emit(Me.REPORT_JOIN_GATEWAY,t.message||t.code||pd.UNKNOWN_REASON,this.url||""),t instanceof ue&&t.code===z.UNEXPECTED_RESPONSE&&t.data.code===qe.ERR_NO_AUTHORIZED)return L.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",Mr.SERVER_ERROR);L.error("[".concat(this.clientId,"] join gateway request failed"),t.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Mr.SERVER_ERROR):(this.initError=t,this.close())})}),this.websocket.on(nt.REQUEST_NEW_URLS,(t,n)=>{cr(this,Me.REQUEST_RECOVER,this.multiIpOption).then(t).catch(n)}),this.websocket.on(nt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(ot.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}var yM=`	
\v\f\r Â áââââââââââââ¯âã\u2028\u2029\uFEFF`,Mee=Lt,Fee=Gc,IT=yM,SM=T("".replace),Uee=RegExp("^["+IT+"]+"),Bee=RegExp("(^|[^"+IT+"])["+IT+"]+$"),AT=function(i){return function(t){var n=Fee(Mee(t));return 1&i&&(n=SM(n,Uee,"")),2&i&&(n=SM(n,Bee,"$1")),n}},jee={start:AT(1),end:AT(2),trim:AT(3)},Vee=DD.PROPER,$ee=d,CM=yM,Hee=jee.trim;jn({target:"String",proto:!0,forced:function(i){return $ee(function(){return!!CM[i]()||"âÂá "[i]()!=="âÂá "||Vee&&CM[i].name!==i})}("trim")},{trim:function(){return Hee(this)}});var Br,Ia,Wee=Bl("String").trim,Gee=R,zee=Wee,OT=String.prototype,xT=c(function(i){var t=i.trim;return typeof i=="string"||i===OT||Gee(OT,i)&&t===OT.trim?zee:t});function bM(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function Uv(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?bM(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):bM(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}function eu(i){return i.match(/^[\.\:\d]+$/)?"".concat(i.replace(/[^\d]/g,"-"),".").concat(J("TURN_DOMAIN")):(L.info("Unidentified as ip: ".concat(i,", use as host")),i)}function TM(i,t){i.addresses||(i.addresses=[]);const n=function(u,h){if(J("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return u.map(E=>{let{ip:y,port:C}=E;return{address:"".concat(y,":").concat(C)}});const p=J("GATEWAY_DOMAINS");let v=p[1]&&Be(h).call(h,p[1])?1:0;return u.map(E=>{let{domain_prefix:y,port:C,ip:I}=E;if(y)return{address:"".concat(y,".").concat(p[v++%p.length],":").concat(C)};const k=/^[\.\:\d]+$/.test(I),G=k?"".concat(I.replace(/[^\d]/g,"-"),".").concat(p[v++%p.length],":").concat(C):"".concat(I,":").concat(C);return k||L.info("Unidentified as ip: ".concat(I,", use as host")),{ip:I,port:C,address:G}})}(i.addresses,t),a=Array.isArray(i.detail)&&i.detail[18];if(a&&typeof a=="string"){const u=a.split(";");for(let h=0;h<u.length;h++){var l;const p=xT(l=u[h]).call(l);n[h]&&p&&(n[h].ip6=p)}}return{gatewayAddrs:n,uid:i.uid,cid:i.cid,cert:i.cert,vid:i.detail&&i.detail[8],uni_lbs_ip:i.detail&&i.detail[1],res:i,csIp:i.detail&&i.detail[502]}}function Jo(i){return typeof i=="number"?i:i.exact||i.ideal||i.max||i.min||0}function RM(i){const t=i._encoderConfig;if(!t)return{};const n={resolution:t.width&&t.height?"".concat(Jo(t.width),"x").concat(Jo(t.height)):void 0,maxVideoBW:t.bitrateMax,minVideoBW:t.bitrateMin};return typeof t.frameRate=="number"?(n.maxFrameRate=t.frameRate,n.minFrameRate=t.frameRate):t.frameRate&&(n.maxFrameRate=t.frameRate.max||t.frameRate.ideal||t.frameRate.exact||t.frameRate.min,n.minFrameRate=t.frameRate.min||t.frameRate.ideal||t.frameRate.exact||t.frameRate.max),n}function wM(i){return i>=0&&i<.17?1:i>=.17&&i<.36?2:i>=.36&&i<.59?3:i>=.59&&i<=1?4:i>1?5:0}function NT(i,t){let n,a,l;switch(t){case Br.CHOOSE_SERVER:a=4096,l="choose server";break;case Br.CLOUD_PROXY:a=1048576,l="proxy";break;case Br.CLOUD_PROXY_5:a=4194304,l="proxy5";break;case Br.CLOUD_PROXY_FALLBACK:a=4194310,l="proxy fallback";break;default:throw new ue(z.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:i.detail&&i.detail[502],retry:!1})}if(i.response_body.forEach(u=>{u.buffer&&u.buffer.flag===a&&(n={code:u.buffer.code,addresses:(u.buffer.edges_services||[]).map(h=>Uv(Uv({},h),{},{ticket:u.buffer.cert})),server_ts:i.enter_ts,uid:u.buffer.uid,cid:u.buffer.cid,cname:u.buffer.cname,detail:Uv(Uv({},u.buffer.detail),i.detail),flag:u.buffer.flag,opid:i.opid,cert:u.buffer.cert})}),!n)throw new ue(z.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(l," from multi unilbs response"),{csIp:i.detail&&i.detail[502]});return n}async function Kee(i,t){return await _e.all(i.addresses.map(async n=>({address:eu(n.ip),tcpport:n.port,udpport:n.port,username:t&&J("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?t.toString():Hi.username,password:t&&J("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await zb(t.toString()):Hi.password})))}function PT(i,t){const n=t._videoHeight||t.getMediaStreamTrack(!0).getSettings().height;return n?Math.max(n/Jo(i.height),1):(L.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function tu(i){let{candidateType:t,relayProtocol:n,type:a,address:l,port:u,protocol:h}=i;return a==="local-candidate"?{candidateType:t,relayProtocol:n,protocol:h}:{candidateType:t,relayProtocol:n,address:l,port:u,protocol:h}}function IM(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}(function(i){i[i.CHOOSE_SERVER=11]="CHOOSE_SERVER",i[i.CLOUD_PROXY=18]="CLOUD_PROXY",i[i.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",i[i.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK"})(Br||(Br={}));class Yee extends wn{get url(){return this._url?this._url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(t){var n;Be(n=["tryNext","recover"]).call(n,t)&&this.resetReconnectCount(t),this._reconnectMode=t}get state(){return this._state}set state(t){t!==this._state&&(this._state=t,this._state==="reconnecting"?this.emit(qn.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(qn.CONNECTED):this._state==="closed"?this.emit(qn.CLOSED):this._state==="failed"&&this.emit(qn.FAILED))}constructor(t,n,a,l){super(),w(this,"connectionID",0),w(this,"currentURLIndex",0),w(this,"reconnectReason",void 0),w(this,"_reconnectMode","tryNext"),w(this,"_name",void 0),w(this,"_state","closed"),w(this,"_retryConfig",void 0),w(this,"_reconnectCount",0),w(this,"_forceCloseTimeout",5e3),w(this,"_onlineReconnectListener",void 0),w(this,"_closeEstablishingTransmitter",()=>{}),w(this,"_store",void 0),w(this,"_joinChannelServiceRecordIndex",void 0),w(this,"_useCompress",void 0),w(this,"_inflateLength",0),w(this,"_deflateLength",0),this._store=l,this._name=t,this._retryConfig=function(u){for(var h=1;h<arguments.length;h++){var p=arguments[h]!=null?arguments[h]:{};h%2?IM(Object(p),!0).forEach(function(v){w(u,v,p[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(p)):IM(Object(p)).forEach(function(v){Object.defineProperty(u,v,Object.getOwnPropertyDescriptor(p,v))})}return u}({},n),this._useCompress=a}resetReconnectCount(t){L.debug("".concat(this._name," reset reconnect count, reason: ").concat(t)),this._reconnectCount=0}close(t,n){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this._reconnectInterrupter&&this._reconnectInterrupter(),this._transmitter){this._transmitter.onclose=null,this._transmitter.onopen=null,this._transmitter.onmessage=null;const a=this._transmitter;n?setTimeout(()=>a.close(),500):a.close(),this._transmitter=void 0}this.state=t?"failed":"closed",this._closeEstablishingTransmitter&&this._closeEstablishingTransmitter()}reconnect(t,n){if(!this._transmitter)return void L.warning("[".concat(this._name,"] can not reconnect, no websocket"));var a;t!==void 0&&(this.reconnectMode=t),L.debug("[".concat(this._name,"] reconnect is triggered initiative")),typeof this._joinChannelServiceRecordIndex=="number"&&((a=this._store)===null||a===void 0||a.recordJoinChannelService({status:"error",errors:[new Error(n)]},this._joinChannelServiceRecordIndex));const l=this._transmitter.onclose;this._transmitter.onclose=null,this._transmitter.close(),l&&l.bind(this._transmitter)({code:9999,reason:n})}getInflateData(){const t=this._inflateLength,n=this._deflateLength;return this.clearInflateData(),{inflateLength:t,deflateLength:n}}setInflateData(t){this._deflateLength=this._deflateLength+t.originLength,this._inflateLength=this._inflateLength+t.compressedLength}clearInflateData(){this._inflateLength=0,this._deflateLength=0}}(function(i){i[i.Default=0]="Default",i[i.Ack=1]="Ack"})(Ia||(Ia={}));class qee{constructor(t,n,a){w(this,"version",1),w(this,"initialRTO",void 0),w(this,"maxBatchAckCount",void 0),w(this,"maxRTO",void 0),w(this,"initialRTT",void 0),w(this,"ID",void 0),w(this,"rtt",void 0),w(this,"packetNumber",1),w(this,"rtoRatioMap",new Map),w(this,"timeoutMap",new Map),w(this,"unorderedPacketQueue",[]),w(this,"batchAckPacketQueue",[]),w(this,"lastOrderedPacketNumber",0),w(this,"batchAckTimer",void 0),w(this,"sendImpl",void 0),w(this,"receiveImpl",void 0),this.sendImpl=t,this.receiveImpl=n,this.ID=pn(7,"transmitter-"),this.initialRTO=(a==null?void 0:a.initialRTO)!==void 0?a.initialRTO:J("TRANSMITTER_INITIAL_RTO"),this.initialRTT=(a==null?void 0:a.initialRTT)!==void 0?a.initialRTT:J("TRANSMITTER_INITIAL_RTT"),this.rtt=(a==null?void 0:a.initialRTT)!==void 0?a.initialRTT:J("TRANSMITTER_INITIAL_RTT"),this.maxBatchAckCount=(a==null?void 0:a.maxBatchAckCount)!==void 0?a.maxBatchAckCount:J("TRANSMITTER_MAX_BATCH_ACK_COUNT"),this.maxRTO=(a==null?void 0:a.maxRTO)!==void 0?a.maxRTO:J("TRANSMITTER_MAX_RTO")}packetize(t,n){return{type:Ia.Default,version:this.version,packetNumber:n,payload:t}}serialize(t){switch(t.type){case Ia.Default:{let n;typeof t.payload=="string"?n=new TextEncoder().encode(t.payload):n=t.payload;const a=new ArrayBuffer(n.length+15),l=new DataView(a);return l.setUint16(0,t.version),l.setUint8(2,t.type),l.setUint32(3,t.packetNumber),Bk(l,7,BigInt(t.sendTs)),new Uint8Array(l.buffer).set(n,15),a}case Ia.Ack:{const n=new ArrayBuffer(16),a=new DataView(n);return a.setUint16(0,t.version),a.setUint8(2,t.type),a.setUint32(3,t.maxAckPacketNumber),a.setUint8(7,t.shift),Bk(a,8,BigInt(t.ackSendTs)),n}}}deserialize(t){const n=new DataView(t),a=n.getUint16(0),l=n.getUint8(2);switch(l){case Ia.Default:{const u=n.getUint32(3),h=Uk(n,7),p=t.slice(15),v=new TextDecoder().decode(p);return{version:a,type:l,packetNumber:u,sendTs:Number(h),payload:v}}case Ia.Ack:{const u=n.getUint32(3),h=n.getUint8(7),p=Uk(n,8);return{version:a,type:l,maxAckPacketNumber:u,shift:h,ackSendTs:Number(p)}}default:throw L.error("[".concat(this.ID,"] Unrecognized packet type ").concat(l)),new Error("Unrecognized packet type ".concat(l))}}sendMessage(t){const n=this.packetize(t,this.packetNumber);this.packetNumber=this.packetNumber===4294967295?1:this.packetNumber+1;const a=this.calculateRTO(n),l=window.setTimeout(()=>{this.resendMessage(n)},a);this.timeoutMap.set(n.packetNumber,l),this.sendPacket(n)}onData(t){const n=this.deserialize(t);n.type===Ia.Default?this.ack(n):n.type===Ia.Ack&&(this.updateRTT(n,Math.round(performance.now())),this.clearRTO(n))}close(){this.rtt=this.initialRTT,this.packetNumber=1,Array.from(this.timeoutMap.entries()).forEach(t=>{let[n,a]=t;window.clearTimeout(a)}),this.timeoutMap=new Map,this.rtoRatioMap=new Map,this.unorderedPacketQueue=[],this.batchAckPacketQueue=[],this.lastOrderedPacketNumber=0,this.batchAckTimer!==void 0&&window.clearTimeout(this.batchAckTimer)}resendMessage(t){const n=this.calculateRTO(t),a=window.setTimeout(()=>{this.resendMessage(t)},n);this.timeoutMap.set(t.packetNumber,a),this.sendPacket(t)}calculateRTO(t){const n=this.rtoRatioMap.get(t.packetNumber);if(n===void 0)return this.rtoRatioMap.set(t.packetNumber,1),this.initialRTO;{const a=9*this.rtt/8*n;return this.rtoRatioMap.set(t.packetNumber,n+1),a>this.maxRTO?this.maxRTO:a}}updateRTT(t,n){const a=t.ackSendTs;this.rtt=this.rtt*(7/8)+(n-a-this.rtt)/8}ack(t){if(t.packetNumber===this.lastOrderedPacketNumber+1)for(this.batchAckPacketQueue.length>=this.maxBatchAckCount&&this.batchAck(),this.batchAckTimer?this.batchAckPacketQueue.push(t):(this.batchAckPacketQueue.push(t),this.batchAckTimer=window.setTimeout(()=>{this.batchAck()},this.rtt/8)),this.lastOrderedPacketNumber+=1,this.receiveImpl(t.payload);;){const n=this.unorderedPacketQueue[0];if(!n){this.unorderedPacketQueue.shift();break}this.batchAckTimer&&this.batchAck(),this.receiveImpl(n.payload),this.unorderedPacketQueue.shift(),this.lastOrderedPacketNumber+=1}else if(t.packetNumber<=this.lastOrderedPacketNumber){const n={ackSendTs:t.sendTs,maxAckPacketNumber:t.packetNumber,shift:0,type:Ia.Ack,version:this.version};this.sendPacket(n)}else if(t.packetNumber>this.lastOrderedPacketNumber){this.unorderedPacketQueue[t.packetNumber-this.lastOrderedPacketNumber-2]=t;const n={ackSendTs:t.sendTs,maxAckPacketNumber:t.packetNumber,shift:0,type:Ia.Ack,version:this.version};this.sendPacket(n)}}batchAck(){window.clearTimeout(this.batchAckTimer),this.batchAckTimer=void 0;const t={ackSendTs:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].sendTs,maxAckPacketNumber:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].packetNumber,shift:this.batchAckPacketQueue.length-1,type:Ia.Ack,version:this.version};this.sendPacket(t),this.batchAckPacketQueue=[]}sendPacket(t){t.type===Ia.Default&&(t.sendTs=Math.round(performance.now()));const n=this.serialize(t);this.sendImpl(n)}clearRTO(t){for(let n=t.maxAckPacketNumber-t.shift;n<=t.maxAckPacketNumber;n++){const a=this.timeoutMap.get(n);a!==void 0&&window.clearTimeout(a),this.timeoutMap.delete(n),this.rtoRatioMap.delete(n)}}}class AM extends Yee{constructor(t,n){super(t,n,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3?arguments[3]:void 0),w(this,"_initMutex",void 0),w(this,"_reconnectInterrupter",void 0),w(this,"_url",void 0),w(this,"_transmitter",void 0),w(this,"_addresses",void 0),w(this,"_reliableTransmission",void 0),this._initMutex=new Ur("datachannel");const{timeout:a,timeoutFactor:l}=n,u=Math.max(300,Math.floor(3*a/5)),h=Math.max(1.2,Math.floor(8*l)/10);Di.ONLINE&&(this._retryConfig.timeout=u,this._retryConfig.timeoutFactor=h),lr.on(qc.NETWORK_STATE_CHANGE,(p,v)=>{p!==v&&(this.resetReconnectCount("network state change: ".concat(v," -> ").concat(p)),p===Di.ONLINE?(this._retryConfig.timeout=u,this._retryConfig.timeoutFactor=h):(this._retryConfig.timeout=a,this._retryConfig.timeoutFactor=l))})}getConnection(){if(this._reliableTransmission)return this._reliableTransmission}async init(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;this._forceCloseTimeout=n;const a=(l,u)=>{this._addresses=t,this.currentURLIndex=this._addresses.findIndex(p=>p.fingerprint||J("FINGERPRINT"));const h=this._addresses[this.currentURLIndex];this.state="connecting",this.createTransmitterConnection(h).then(l).catch(u),this.once(qn.CLOSED,()=>u(new ue(z.WS_DISCONNECT))),this.once(qn.CONNECTED,()=>l())};return this._initMutex.lock().then(l=>new _e((u,h)=>{a(u,h)}).then(()=>{l()}).catch(()=>{l()}))}sendMessage(t){let n=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this._transmitter||!this._reliableTransmission)throw new ue(z.WS_ABORT,"datachannel is not ready");try{n||(t=JSON.stringify(t)),this._reliableTransmission.sendMessage(t)}catch(a){throw new ue(z.WS_ERR,"send datachannel signal message error"+a.toString())}}unbindDcCloseEventListener(){this._transmitter&&(this._transmitter.onclose=null)}sendMessageWithJSON(t){const n=JSON.stringify(t);return{compressed:n,compressedLength:n.length,origin:t}}sendMessageWithUint8Array(t){return{compressed:t,compressedLength:t.byteLength,origin:t}}createTransmitterConnection(t){return this.connectionID+=1,this._joinChannelServiceRecordIndex=void 0,this._url="dc://".concat(t.ip,":").concat(t.port),new _e((n,a)=>{var l;const u=()=>{L.debug("[".concat(this._name,"] datachannel opened:"),this._url),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),n()},h=async y=>{var C;if((C=this._closeEstablishingTransmitter)===null||C===void 0||C.call(this),L.debug("[".concat(this._name,"] datachannel close ").concat(this._url,", code: ").concat(y.code,", reason: ").concat(y.reason,", current mode: ").concat(this.reconnectMode)),this._reconnectCount<this._retryConfig.maxRetryCount){this.state==="connected"&&(this.reconnectReason=y.reason,this.state="reconnecting");const I=No(this,qn.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,k=await this.reconnectWithAction(I);if(this.state==="closed")return void L.debug("[".concat(this.connectionID,"] dc is closed, no need to reconnect"));if(!k)return a(new ue(z.WS_DISCONNECT,"datachannel reconnect failed: ".concat(y.code))),void this.close(!0);n()}else a(new ue(z.WS_DISCONNECT,"datachannel close: ".concat(y.code))),this.close()},p=y=>{var C;(C=this._reliableTransmission)===null||C===void 0||C.onData(y.data)};this._transmitter&&(this._transmitter.onclose=null,this._transmitter.close()),this._reliableTransmission&&(this._reliableTransmission.close(),this._reliableTransmission=void 0),L.debug("[".concat(this._name,"] start connect, address: ").concat(JSON.stringify(t)));const v=(l=this._store)===null||l===void 0?void 0:l.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"}),E=Date.now();cr(this,qn.TO_CONNECT_DATACHANNEL,t).then(y=>{var C,I;if(!y)throw new Error("transmissonInfo not exist yet");const{transmitter:k,close:G}=y;this._transmitter=k,(C=this._store)===null||C===void 0||C.signalChannelOpen();const B=Date.now()-E;L.debug("[choose dc] dc open cost ".concat(B,"ms")),this._reliableTransmission=new qee(j=>{var q;this._transmitter&&this._transmitter.readyState==="open"&&((q=this._transmitter)===null||q===void 0||q.send(j))},j=>{typeof j=="string"&&this.emit(qn.ON_MESSAGE,j)}),this._closeEstablishingTransmitter=()=>{var j;(j=this._reliableTransmission)===null||j===void 0||j.close(),this._reliableTransmission=void 0,G()},u&&u(),k.onclose=h,k.onmessage=p,(I=this._store)===null||I===void 0||I.recordJoinChannelService({endTs:Date.now(),status:"success"},v),this._joinChannelServiceRecordIndex=v}).catch(y=>{var C;if((C=this._store)===null||C===void 0||C.recordJoinChannelService({endTs:Date.now(),status:y instanceof ue&&y.code===z.WS_ABORT?"aborted":"error",errors:[y]},v),this.state!=="closed"){if(y instanceof ue&&y.code===z.WS_ERR){const I=new ue(z.WS_ERR,"init datachannel failed! Error: ".concat(y.toString()));return L.error("[".concat(this._name,"]").concat(I)),void a(I)}h&&h(y)}else a(new ue(z.WS_DISCONNECT,"datachannel is closed: ".concat(y.toString())))})})}async reconnectWithAction(t){let n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this._reconnectCount>=this._retryConfig.maxRetryCount||!this._addresses||this.state==="closed")return!1;this._onlineReconnectListener||lr.networkState!==Di.OFFLINE||(this._onlineReconnectListener=lr.onlineWaiter&&lr.onlineWaiter.then(()=>{this._onlineReconnectListener=void 0}));let a=!0;if(this._reconnectInterrupter=()=>{a=!1},n){const p=Cv(this._reconnectCount,this._retryConfig);L.debug("[".concat(this._name,"] wait ").concat(p,"ms to reconnect datachannel, mode: ").concat(t)),await _e.race([Fr(p),this._onlineReconnectListener||new _e(()=>{})])}if(this.state==="closed"||!a)return!1;this._reconnectCount+=1;const l=async(p,v)=>{this.emit(qn.RECONNECT_CREATE_CONNECTION,v),await this.createTransmitterConnection(p)};try{if(t==="retry"){const p=this._addresses[this.currentURLIndex];this.emit(qn.RECONNECT_WAITTING_FINISH,t),await l(p,t)}else if(t==="tryNext"){this.currentURLIndex+=1;for(let v=this.currentURLIndex;v<this._addresses.length;v++){if(this._addresses[v].fingerprint||J("FINGERPRINT")){this.currentURLIndex=v;break}this.currentURLIndex+=1}if(this.currentURLIndex>=this._addresses.length)return L.debug("[".concat(this._name,"] the available addresses are exhausted, change to recover")),await this.reconnectWithAction("recover",!1);L.debug("[".concat(this._name,"] datachannel url length: ").concat(this._addresses.length," current index: ").concat(this.currentURLIndex));const p=this._addresses[this.currentURLIndex];this.emit(qn.RECONNECT_WAITTING_FINISH,t),await l(p,t)}else t==="recover"&&(L.debug("[".concat(this._name,"] start to failback to websocket")),this.resetReconnectCount("recover mode"),this.emit(qn.RECONNECT_WAITTING_FINISH,t),this.emit(qn.FAILBACK));return!0}catch(p){var u,h;return L.error("[".concat(this._name,"] reconnect failed"),p.toString()),p!=null&&(u=p.data)!==null&&u!==void 0&&u.desc&&Array.isArray(p.data.desc)&&p.data.desc.length&&Be(h=p.data.desc).call(h,"dynamic key expired")?(this.emit(qn.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):await this.reconnectWithAction(t,n)}}}class Qc extends wn{get connectionState(){return this._connectionState}set connectionState(t){t!==this._connectionState&&(this._connectionState=t,t===wt.CONNECTED?this.emit(Me.WS_CONNECTED):t===wt.RECONNECTING?this.emit(Me.WS_RECONNECTING,this._websocketReconnectReason):t===wt.CLOSED&&this.emit(Me.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}constructor(t,n){super(),w(this,"_disconnectedReason",void 0),w(this,"_websocketReconnectReason",void 0),w(this,"_connectionState",wt.CLOSED),w(this,"reconnectToken",void 0),w(this,"websocket",void 0),w(this,"openConnectionTime",void 0),w(this,"clientId",void 0),w(this,"lastMsgTime",Date.now()),w(this,"uploadCache",[]),w(this,"uploadCacheInterval",void 0),w(this,"rttRolling",new Jb(5)),w(this,"pingpongTimer",void 0),w(this,"inflateDataTimer",void 0),w(this,"pingpongTimeoutCount",0),w(this,"joinResponse",void 0),w(this,"multiIpOption",void 0),w(this,"initError",void 0),w(this,"spec",void 0),w(this,"store",void 0),w(this,"onWebsocketMessage",a=>{if(a instanceof ArrayBuffer)return void this.emit(Me.ON_BINARY_DATA,a);const l=JSON.parse(a);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(l,"_id")){const u="res-@".concat(l._id);this.emit(u,l._result,l._message)}else if(Object.prototype.hasOwnProperty.call(l,"_type")&&(this.emit(l._type,l._message),l._type===ot.ON_NOTIFICATION&&this.handleNotification(l._message),l._type===ot.ON_USER_BANNED))switch(l._message.error_code){case 14:this.close(xt.UID_BANNED);break;case 15:this.close(xt.IP_BANNED);break;case 16:this.close(xt.CHANNEL_BANNED)}}),this.clientId=t.clientId,this.spec=t,this.store=n,this.websocket=new AM("gateway-".concat(this.clientId),this.spec.retryConfig,!0,n),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===wt.CONNECTED&&this.reconnect("retry",_c.OFFLINE)})}async request(t,n,a,l){const u=pn(6,""),h={_id:u,_type:t,_message:n},p=this.websocket.connectionID,v=()=>new _e((G,B)=>{if(this.connectionState===wt.CONNECTED)return G();const j=()=>{this.off(Me.WS_CLOSED,q),G()},q=()=>{this.off(Me.WS_CONNECTED,j),B(new ue(z.WS_ABORT))};this.once(Me.WS_CONNECTED,j),this.once(Me.WS_CLOSED,q),t!==Ke.PUBLISH&&t!==Ke.SUBSCRIBE&&t!==Ke.UNSUBSCRIBE&&t!==Ke.UNPUBLISH&&t!==Ke.CONTROL&&t!==Ke.RESTART_ICE||this.once(Me.DISCONNECT_P2P,()=>{B(new ue(z.DISCONNECT_P2P))}),t!==Ke.PUBLISH&&t!==Ke.RESTART_ICE||this.once(Me.ABORT_P2P_EXECUTION,()=>{B(new ue(z.DISCONNECT_P2P))})});if(this.connectionState!==wt.CONNECTING&&this.connectionState!==wt.RECONNECTING||t===Ke.JOIN||t===Ke.REJOIN||await v(),t===Ke.LEAVE&&(this.websocket.unbindDcCloseEventListener(),l=!0),this.websocket.sendMessage(h,!0,!1),l)return;const E=new _e((G,B)=>{let j=!1;const q=(re,Ce)=>{j=!0,G({isSuccess:re==="success",message:Ce||{}}),this.off(Me.WS_CLOSED,Z),this.off(Me.WS_RECONNECTING,Z),this.emit(Me.REQUEST_SUCCESS,t,n)};this.once("res-@".concat(u),q);const Z=()=>{B(new ue(z.WS_ABORT,"type: ".concat(t))),this.off(Me.WS_CLOSED,Z),this.off(Me.WS_RECONNECTING,Z),this.off("res-@".concat(u),q)};this.once(Me.WS_CLOSED,Z),this.once(Me.WS_RECONNECTING,Z),Fr(J("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==p||j||(L.warning("dc request timeout, type: ".concat(t)),this.emit(Me.REQUEST_TIMEOUT,t,n))})});let y=null;try{y=await E}catch(G){if(this.connectionState===wt.CLOSED||t===Ke.LEAVE)throw new ue(z.WS_ABORT);return!this.spec.forceWaitGatewayResponse||a?G.throw():t===Ke.JOIN||t===Ke.REJOIN?null:(await v(),await this.request(t,n))}if(y.isSuccess)return y.message;const C=Number(y.message.error_code||y.message.code),I=fd(C),k=new ue(z.UNEXPECTED_RESPONSE,"".concat(I.desc,": ").concat(y.message.error_str),{code:C,data:y.message});return I.action==="success"?y.message:(L.warning("[".concat(this.websocket.connectionID,"] unexpected response from type ").concat(t,", error_code: ").concat(C,", message: ").concat(I.desc,", action: ").concat(I.action)),C===qe.ERR_TOO_MANY_BROADCASTERS?((t===Ke.JOIN||t===Ke.REJOIN)&&(this.initError=k,this.close()),k.throw()):I.action==="failed"?k.throw():I.action==="quit"?(this.initError=k,this.close(),k.throw()):(C===qe.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=y.message.option,L.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",_c.MULTI_IP)):this.reconnect(I.action,_c.SERVER_ERROR),t===Ke.JOIN||t===Ke.REJOIN?null:await this.request(t,n)))}waitMessage(t,n){return new _e(a=>{const l=u=>{(!n||n(u))&&(this.off(t,l),a(u))};this.on(t,l)})}uploadWRTCStats(t){if(!this.store.sessionId)return void L.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const n={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:t};this.upload(Jc.WRTC_STATS,n)}upload(t,n){const a={_type:t,_message:n};try{this.websocket.sendMessage(a)}catch{const u=J("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(a),this.uploadCache.length>u&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==wt.CONNECTED)return;const h=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(h._type,h._message)},J("UPLOAD_CACHE_INTERVAL")||2e3))}}send(t,n){const a={_type:t,_message:n};this.websocket.sendMessage(a)}init(t,n){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new _e((a,l)=>{this.once(Me.WS_CONNECTED,()=>a(this.joinResponse)),this.once(Me.WS_CLOSED,()=>l(this.initError||new ue(z.WS_ABORT))),this.connectionState=wt.CONNECTING,this.websocket.init(t).catch(l),this.websocket.once(qn.FAILBACK,()=>{this.openConnectionTime===void 0&&l(new ue(z.INIT_DATACHANNEL_TIMEOUT))}),this.inflateDataTimer&&window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=window.setInterval(()=>{this.handleInflateData()},2e4),setTimeout(()=>{n&&this.openConnectionTime===void 0&&(L.debug("[".concat(this.clientId,"] init datachannel timeout while join with failback to websocket")),l(new ue(z.INIT_DATACHANNEL_TIMEOUT)))},J("DC_JOIN_WITH_FAILBACK"))})}close(t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.inflateDataTimer&&(this.handleInflateData(),window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=t||xt.LEAVE,this.connectionState=wt.CLOSED,L.debug("[".concat(this.clientId,"] ")+"will close datachannel in signal"),this.websocket.close(),t===xt.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new AM("gateway-".concat(this.clientId),this.spec.retryConfig,!0,this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(Me.ABORT_P2P_EXECUTION);const t=await cr(this,Me.DATACHANNEL_CONNECTING),n=await this.request(Ke.JOIN,t);if(!n)return this.emit(Me.REPORT_JOIN_GATEWAY,z.TIMEOUT,this.url||""),!1;this.joinResponse=n,this.emit(Me.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=wt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new ue(z.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const t=sd(this,Me.REQUEST_REJOIN_INFO);t.token=this.reconnectToken;const n=await this.request(Ke.REJOIN,t);return!!n&&(this.connectionState=wt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),n.peers&&n.peers.forEach(a=>{this.emit(ot.ON_USER_ONLINE,{uid:a.uid}),a.audio&&this.emit(ot.ON_ADD_AUDIO_STREAM,{uid:a.uid,uint_id:a.uint_id,audio:!0,ssrcId:a.audio_ssrc}),a.video&&this.emit(ot.ON_ADD_VIDEO_STREAM,{uid:a.uid,uint_id:a.uint_id,video:!0,ssrcId:a.video_ssrc}),a.audio_mute?this.emit(ot.MUTE_AUDIO,{uid:a.uid}):this.emit(ot.UNMUTE_AUDIO,{uid:a.uid}),a.video_mute?this.emit(ot.MUTE_VIDEO,{uid:a.uid}):this.emit(ot.UNMUTE_VIDEO,{uid:a.uid}),a.audio_enable_local?this.emit(ot.ENABLE_LOCAL_AUDIO,{uid:a.uid}):this.emit(ot.DISABLE_LOCAL_AUDIO,{uid:a.uid}),a.video_enable_local?this.emit(ot.ENABLE_LOCAL_VIDEO,{uid:a.uid}):this.emit(ot.DISABLE_LOCAL_VIDEO,{uid:a.uid}),a.audio||a.video||this.emit(ot.ON_REMOVE_STREAM,{uid:a.uid,uint_id:a.uint_id})}),!0)}reconnect(t,n){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(t,n)}handleNotification(t){L.debug("[".concat(this.clientId,"] receive notification: "),t);const n=fd(t.code);if(n.action!=="success"){if(n.action!=="failed")return n.action==="quit"?(n.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(xt.UID_BANNED),void this.close()):void this.reconnect(n.action,_c.SERVER_ERROR);L.error("[".concat(this.clientId,"] ignore error: "),n.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const t=J("PING_PONG_TIME_OUT"),n=Date.now();this.pingpongTimeoutCount>=t&&(L.warning("PINGPONG Timeout. Last Socket Message: ".concat(n-this.lastMsgTime,"ms")),n-this.lastMsgTime>J("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",_c.TIMEOUT):this.request(Ke.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const a=Date.now()-n;this.rttRolling.add(a),J("REPORT_STATS")&&this.send(Ke.PING_BACK,{pingpongElapse:a})}).catch(a=>{})}handleInflateData(){const{inflateLength:t,deflateLength:n}=this.websocket.getInflateData();t!==0&&n!==0&&this.upload(Jc.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:n,ws_inflate_length:t})}handleWebsocketEvents(){this.websocket.on(qn.RECONNECT_WAITTING_FINISH,t=>{this.emit(Me.WS_RECONNECT_WAITTING_FINISH,t)}),this.websocket.on(qn.RECONNECT_CREATE_CONNECTION,t=>{this.emit(Me.WS_RECONNECT_CREATE_CONNECTION,t)}),this.websocket.on(qn.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(qn.CLOSED,()=>{this.connectionState=wt.CLOSED}),this.websocket.on(qn.FAILED,()=>{this._disconnectedReason=xt.NETWORK_ERROR,this.connectionState=wt.CLOSED}),this.websocket.on(qn.RECONNECTING,t=>{this._websocketReconnectReason=t,this.joinResponse=void 0,this.connectionState===wt.CONNECTED?this.connectionState=wt.RECONNECTING:this.connectionState=wt.CONNECTING}),this.websocket.on(qn.WILL_RECONNECT,(t,n)=>{if(sd(this,Me.IS_P2P_DISCONNECTED)&&t==="retry")return L.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(Me.NEED_RENEW_SESSION),this.emit(Me.DISCONNECT_P2P),n("tryNext");t!=="retry"&&(L.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(t)),this.reconnectToken=void 0,this.emit(Me.NEED_RENEW_SESSION),this.emit(Me.DISCONNECT_P2P)),n(t)}),this.websocket.on(qn.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(t=>{L.warning("[".concat(this.clientId,"] rejoin failed ").concat(t)),this.reconnect("tryNext",_c.SERVER_ERROR)}):this.join().catch(t=>{if(this.emit(Me.REPORT_JOIN_GATEWAY,t.message||t.code,this.url||""),t instanceof ue&&t.code===z.UNEXPECTED_RESPONSE&&t.data.code===qe.ERR_NO_AUTHORIZED)return L.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",_c.SERVER_ERROR);L.error("[".concat(this.clientId,"] join gateway request failed"),t.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",_c.SERVER_ERROR):(this.initError=t,this.close())})}),this.websocket.on(qn.REQUEST_NEW_URLS,(t,n)=>{cr(this,Me.REQUEST_RECOVER,this.multiIpOption).then(t).catch(n)}),this.websocket.on(qn.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(ot.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(qn.TO_CONNECT_DATACHANNEL,async(t,n,a)=>cr(this,Me.DATACHANNEL_PRECONNECT,t).then(n).catch(a)),this.websocket.on(qn.FAILBACK,()=>{this.openConnectionTime!==void 0&&this.emit(Me.DATACHANNEL_FAILBACK)})}}class md extends wn{constructor(t,n){super(),w(this,"signal",void 0),w(this,"token",void 0),w(this,"tokenTimeout",void 0),w(this,"tokenInterval",void 0),w(this,"_sequence",0),w(this,"userMap",new Map),w(this,"encoder",new TextEncoder),this.signal=t,this.token=n;const a=()=>{this.signal.connectionState===wt.CONNECTED&&this.check(),this.userMap.size===0?this.tokenInterval=window.setTimeout(a,1e3):this.tokenInterval=window.setTimeout(a,3*J("P2P_TOKEN_INTERVAL"))};a()}async send(t,n,a,l,u){var h,p,v;if(this.userMap.size===0)return;const E=Array.from(ks(h=this.userMap).call(h))[0].token;typeof n!="string"&&(n=JSON.stringify(n)),l=(p=l)!==null&&p!==void 0?p:pn(6,""),u=(v=u)!==null&&v!==void 0?v:this._sequence++;const y={_id:l,_type:t,_seq:u,_message:n,token:"".concat(this.token,"_").concat(E)};J("SHOW_P2P_LOG")&&L.debug("send message",y,"noNeedResponse : ".concat(a)),this.splitMessage(JSON.stringify(y)).forEach(I=>{this.signal.request(Ke.DATA_STREAM,{payload:Mh(this.encoder.encode(I))})});const C=new _e((I,k)=>{const G=window.setTimeout(()=>{this.off("res-@".concat(l,"_ack"),B),this.off("res-@".concat(l),q),this.off(Zl.ABORT,j),L.debug("[external-signal] request timeout, type: ".concat(t,", requestId: ").concat(l)),this.userMap.size===0?k(new Te(z.INVALID_REMOTE_USER)):k(new Te(z.TIMEOUT))},J("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),B=()=>{G&&window.clearTimeout(G),this.off(Zl.ABORT,j),a&&I()},j=()=>{G&&window.clearTimeout(G),this.off("res-@".concat(l,"_ack"),B),this.off("res-@".concat(l),q),k(new Te(z.EXTERNAL_SIGNAL_ABORT,"type: ".concat(t,", requestId: ").concat(l)))};this.once(Zl.ABORT,j),this.once("res-@".concat(l,"_ack"),B);const q=(re,Ce)=>{Z=!0,G&&window.clearTimeout(G),this.off("res-@".concat(l,"_ack"),B),this.off(Zl.ABORT,j),re==="success"?I(Ce):k(new Te(z.P2P_MESSAGE_FAILED,"request ".concat(t," failed, requestId: ").concat(l)))};let Z=!1;a||(this.once("res-@".concat(l),q),Fr(J("SIGNAL_REQUEST_TIMEOUT")).then(()=>{Z||L.warning("external_signal request timeout, type: ".concat(t,", requestId: ").concat(l,", ").concat(y))}))});try{return await C}catch(I){if(I.code===z.TIMEOUT)return await this.send(t,n,a,l,u);throw I}}onMessage(t){var n;const{_uid:a}=t;let l,u=this.userMap.get(a);if(u)l=u.splitMessageMap;else{if(this.userMap.size>0||!("_type"in t)||t._type!==Mn.CHECK)return;const{token:E}=t;l=new Map,u={uid:a,isStart:!0,token:E,splitMessageMap:l,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(a,u),this.signal.emit(ot.ON_USER_ONLINE,{uid:a}),this.handleUserOnline()}if("id"in t&&"total"in t){var h;const{id:E,total:y}=t,C=(h=l.get(E))!==null&&h!==void 0?h:[];if(C.push(t),l.has(E)||l.set(E,C),C.length!==y)return;{const I=zf(C).call(C,(k,G)=>k.index-G.index).map(k=>k.payload).join("");l.delete(E),(t=JSON.parse(I))._uid=a}}const{_type:p,token:v}=t;if(Be(n=[Mn.ACK,Mn.CHECK]).call(n,p))return p===Mn.CHECK&&this.handleCheckToken(u,v),void this.receiveMessage(t);v==="".concat(u.token,"_").concat(this.token)?this.handleReceivedMessage(t):L.debug('Receive unexpected message", '.concat(v,", cur_token: ").concat(u.token,"_").concat(this.token),t)}check(){const t={_id:pn(6,""),token:this.token,_type:Mn.CHECK};J("SHOW_P2P_LOG")&&L.debug("send message",t),this.signal.request(Ke.DATA_STREAM,{payload:Mh(this.encoder.encode(JSON.stringify(t)))})}ack(t){const n={_id:t,_type:Mn.ACK,token:this.token};J("SHOW_P2P_LOG")&&L.debug("send message",n),this.signal.request(Ke.DATA_STREAM,{payload:Mh(this.encoder.encode(JSON.stringify(n)))})}response(t,n,a){this.send(Mn.RESPONSE,JSON.stringify({success:!a,message:n}),!0,t)}handleReceivedMessage(t){const n=()=>{this.userMap.forEach(E=>{const{receivedMessagesMap:y,nextExpectedSequenceNumber:C}=E;for(;y.has(C);){const I=y.get(C);y.delete(C),this.receiveMessage(I),E.nextExpectedSequenceNumber++}})};if(!t)return void n();const{_uid:a,_seq:l}=t,u=this.userMap.get(a),{receivedMessagesMap:h,isStart:p,nextExpectedSequenceNumber:v}=u;if(l<v)return this.ack(t._id),void L.debug("[external-signal] receive old message, seq: ".concat(l,", ").concat(t._message));h.set(l,t),p&&l===v&&(this.receiveMessage(t),h.delete(v),u.nextExpectedSequenceNumber++,n())}receiveMessage(t){const{_id:n,_type:a,_message:l,_uid:u}=t;if(J("SHOW_P2P_LOG")&&L.debug("receive message",t),n){let h;switch(t._type!==Mn.ACK&&(l&&(h=JSON.parse(l)),this.ack(t._id)),t._type){case Mn.CANDIDATE:case Mn.CONTROL:this.signal.emit(a,h,u);break;case Mn.PUBLISH:case Mn.UNPUBLISH:case Mn.RESTART_ICE:case Mn.CALL:h.uid=u,cr(this.signal,a,h).then(p=>{this.response(t._id,p)}).catch(()=>{this.response(t._id,void 0,!0)});break;case Mn.ACK:this.getListeners("res-@".concat(n,"_ack")).length>0&&this.emit("res-@".concat(n,"_ack"));break;case Mn.RESPONSE:{const{success:p,message:v}=h;this.emit("res-@".concat(n),p?"success":"failed",v);break}}}}splitMessage(t){if(t.length<md.MAX_MESSAGE_SIZE)return[t];const n=[],{remoteToken:a}=JSON.parse(t),l=pn(6,"");let u=0,h=800;const p=Math.ceil(t.length/h);for(;t.length>0;){u++;const v={id:l,index:u,total:p,payload:t.slice(0,h),token:"".concat(this.token,"_").concat(a)};JSON.stringify(v).length>md.MAX_MESSAGE_SIZE?h-=50:(n.push(v),t=t.slice(h))}return n.map(v=>JSON.stringify(v))}handleCheckToken(t,n){return t.token!==n?(L.debug("token changed, from ".concat(t.token," to ").concat(n)),this.reset(t.uid,n),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout(()=>{L.debug("token timeout, ".concat(n)),this.reset(t.uid)},J("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){const t=await cr(this.signal,Mn.CALL,void 0),n=await this.send(Mn.CALL,t);this.signal.emit(Me.P2P_CONNECTION,n,!0)}async reset(t,n){const a=this.userMap.get(t);a&&(this.emit(Zl.ABORT),this.signal.emit(ot.ON_USER_OFFLINE,{uid:a.uid,reason:RT.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),n||(L.debug("change local token from ".concat(n," to ").concat(n)),this.token=pn(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(Zl.ABORT)}}w(md,"MAX_SIZE",1),w(md,"MAX_MESSAGE_SIZE",1024);class OM extends wn{get connectionState(){return this._connectionState}set connectionState(t){t!==this._connectionState&&(this._connectionState=t,t===wt.CONNECTED?this.emit(Me.WS_CONNECTED):t===wt.RECONNECTING?this.emit(Me.WS_RECONNECTING,this._websocketReconnectReason):t===wt.CLOSED&&this.emit(Me.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(t,n){super(),w(this,"_disconnectedReason",void 0),w(this,"_websocketReconnectReason",void 0),w(this,"_connectionState",wt.CLOSED),w(this,"reconnectToken",void 0),w(this,"p2pToken",void 0),w(this,"websocket",void 0),w(this,"openConnectionTime",void 0),w(this,"clientId",void 0),w(this,"lastMsgTime",Date.now()),w(this,"uploadCache",[]),w(this,"uploadCacheInterval",void 0),w(this,"rttRolling",new Jb(5)),w(this,"pingpongTimer",void 0),w(this,"pingpongTimeoutCount",0),w(this,"joinResponse",void 0),w(this,"multiIpOption",void 0),w(this,"initError",void 0),w(this,"spec",void 0),w(this,"store",void 0),w(this,"_external_signal",void 0),w(this,"onWebsocketMessage",a=>{if(a.data instanceof ArrayBuffer)return void this.emit(Me.ON_BINARY_DATA,a.data);const l=JSON.parse(a.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(l,"_id")){const u="res-@".concat(l._id);this.emit(u,l._result,l._message)}else if(Object.prototype.hasOwnProperty.call(l,"_type")){switch(l._type){case ot.ON_DATA_STREAM:return void this.handleDataStream(l._message);case ot.MUTE_AUDIO:case ot.MUTE_VIDEO:case ot.ON_P2P_LOST:case ot.ON_USER_ONLINE:return;case ot.ON_USER_OFFLINE:const{uid:u}=l._message;return L.debug("[".concat(this.clientId,"] user-offline uid: ").concat(u)),void this._external_signal.reset(u)}if(this.emit(l._type,l._message),l._type===ot.ON_NOTIFICATION&&this.handleNotification(l._message),l._type===ot.ON_USER_BANNED)switch(l._message.error_code){case 14:this.close(xt.UID_BANNED);break;case 15:this.close(xt.IP_BANNED);break;case 16:this.close(xt.CHANNEL_BANNED)}if(l._type===ot.ON_USER_LICENSE_BANNED)switch(l._message.error_code){case qe.ERR_LICENSE_MISSING:this.close(xt.LICENSE_MISSING);break;case qe.ERR_LICENSE_EXPIRED:this.close(xt.LICENSE_EXPIRED);break;case qe.ERR_LICENSE_MINUTES_EXCEEDED:this.close(xt.LICENSE_MINUTES_EXCEEDED);break;case qe.ERR_LICENSE_PERIOD_INVALID:this.close(xt.LICENSE_PERIOD_INVALID);break;case qe.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(xt.LICENSE_MULTIPLE_SDK_SERVICE);break;case qe.ERR_LICENSE_ILLEGAL:this.close(xt.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=t.clientId,this.spec=t,this.store=n,this.websocket=new u0("gateway-".concat(this.clientId),this.spec.retryConfig,!0,J("JOIN_GATEWAY_USE_DUAL_DOMAIN"),J("JOIN_GATEWAY_USE_443PORT_ONLY"),n),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===wt.CONNECTED&&this.reconnect("retry",Mr.OFFLINE)}),this.p2pToken=pn(6,""),this._external_signal=new md(this,this.p2pToken)}async request(t,n,a,l){const u=pn(6,""),h={_id:u,_type:t,_message:n},p=this.websocket.connectionID,v=()=>new _e((G,B)=>{if(this.connectionState===wt.CONNECTED)return G();const j=()=>{this.off(Me.WS_CLOSED,q),G()},q=()=>{this.off(Me.WS_CONNECTED,j),B(new Te(z.WS_ABORT))};this.once(Me.WS_CONNECTED,j),this.once(Me.WS_CLOSED,q)});if(this.connectionState!==wt.CONNECTING&&this.connectionState!==wt.RECONNECTING||t===Ke.JOIN||t===Ke.REJOIN||await v(),this.websocket.sendMessage(h,!0),l)return;const E=new _e((G,B)=>{let j=!1;const q=(re,Ce)=>{j=!0,G({isSuccess:re==="success",message:Ce||{}}),this.off(Me.WS_CLOSED,Z),this.off(Me.WS_RECONNECTING,Z),this.emit(Me.REQUEST_SUCCESS,t,n)};this.once("res-@".concat(u),q);const Z=()=>{B(new Te(z.WS_ABORT,"type: ".concat(t))),this.off(Me.WS_CLOSED,Z),this.off(Me.WS_RECONNECTING,Z),this.off("res-@".concat(u),q)};this.once(Me.WS_CLOSED,Z),this.once(Me.WS_RECONNECTING,Z),Fr(J("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==p||j||(L.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(t)),this.emit(Me.REQUEST_TIMEOUT,t,n))})});let y=null;try{y=await E}catch(G){if(this.connectionState===wt.CLOSED||t===Ke.LEAVE)throw new Te(z.WS_ABORT);return!this.spec.forceWaitGatewayResponse||a?G.throw():t===Ke.JOIN||t===Ke.REJOIN?null:(await v(),await this.request(t,n))}if(y.isSuccess)return y.message;const C=Number(y.message.error_code||y.message.code),I=fd(C),k=new Te(z.UNEXPECTED_RESPONSE,"".concat(I.desc,": ").concat(y.message.error_str),{code:C,data:y.message});return I.action==="success"?y.message:(L.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(t,", error_code: ").concat(C,", message: ").concat(I.desc,", action: ").concat(I.action)),C===qe.ERR_TOO_MANY_BROADCASTERS?((t===Ke.JOIN||t===Ke.REJOIN)&&(this.initError=k,this.close()),k.throw()):I.action==="failed"?k.throw():I.action==="quit"?(this.initError=k,this.close(),k.throw()):(C===qe.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=y.message.option,L.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Mr.MULTI_IP)):this.reconnect(I.action,Mr.SERVER_ERROR),t===Ke.JOIN||t===Ke.REJOIN?null:await this.request(t,n)))}waitMessage(t,n){return new _e(a=>{const l=u=>{(!n||n(u))&&(this.off(t,l),a(u))};this.on(t,l)})}uploadWRTCStats(t){if(!this.store.sessionId)return void L.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const n={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:t};this.upload(Jc.WRTC_STATS,n)}upload(t,n){const a={_type:t,_message:n};try{this.websocket.sendMessage(a)}catch{const u=J("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(a),this.uploadCache.length>u&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==wt.CONNECTED)return;const h=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(h._type,h._message)},J("UPLOAD_CACHE_INTERVAL")||2e3))}}send(t,n){const a={_type:t,_message:n};this.websocket.sendMessage(a)}async sendExtensionMessage(t,n,a){return await this._external_signal.send(t,n,a)}init(t){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new _e((n,a)=>{this.once(Me.WS_CONNECTED,()=>n(this.joinResponse)),this.once(Me.WS_CLOSED,()=>a(this.initError||new Te(z.WS_ABORT))),this.connectionState=wt.CONNECTING,this.websocket.init(t).catch(a)})}close(t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=t||xt.LEAVE,this.connectionState=wt.CLOSED,L.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),t===xt.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new u0("gateway-".concat(this.clientId),this.spec.retryConfig,!0,J("JOIN_GATEWAY_USE_DUAL_DOMAIN"),J("JOIN_GATEWAY_USE_443PORT_ONLY"),this.store),this.handleWebsocketEvents()),this.p2pToken=pn(6,""),this._external_signal.clear(),this._external_signal=new md(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(Me.ABORT_P2P_EXECUTION);const t=await cr(this,Me.REQUEST_JOIN_INFO),n=await this.request(Ke.JOIN,t);if(!n)return this.emit(Me.REPORT_JOIN_GATEWAY,z.TIMEOUT,this.url||""),!1;this.joinResponse=n,this.emit(Me.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=wt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(t,n){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(t,n)}handleDataStream(t){try{var n;const a=_v(t.payload),l=new TextDecoder().decode(a),u=JSON.parse(l);"total"in u&&"id"in u||Be(n=Object.values(Mn)).call(n,u._type)?(u._uid=t.uid,this._external_signal.onMessage(u)):this.emit(ot.ON_DATA_STREAM,t)}catch{this.emit(ot.ON_DATA_STREAM,t)}}handleNotification(t){L.debug("[".concat(this.clientId,"] receive notification: "),t);const n=fd(t.code);if(n.action!=="success"){if(n.action!=="failed")return n.action==="quit"?(n.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(xt.UID_BANNED),void this.close()):void this.reconnect(n.action,Mr.SERVER_ERROR);L.error("[".concat(this.clientId,"] ignore error: "),n.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const t=J("PING_PONG_TIME_OUT"),n=Date.now();this.pingpongTimeoutCount>=t&&(L.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(n-this.lastMsgTime,"ms")),n-this.lastMsgTime>J("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Mr.TIMEOUT):this.request(Ke.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const a=Date.now()-n;this.rttRolling.add(a),J("REPORT_STATS")&&this.send(Ke.PING_BACK,{pingpongElapse:a})}).catch(a=>{})}handleWebsocketEvents(){this.websocket.on(nt.RECONNECT_WAITTING_FINISH,t=>{this.emit(Me.WS_RECONNECT_WAITTING_FINISH,t)}),this.websocket.on(nt.RECONNECT_CREATE_CONNECTION,t=>{this.emit(Me.WS_RECONNECT_CREATE_CONNECTION,t)}),this.websocket.on(nt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(nt.CLOSED,()=>{this.connectionState=wt.CLOSED}),this.websocket.on(nt.FAILED,()=>{this._disconnectedReason=xt.NETWORK_ERROR,this.connectionState=wt.CLOSED}),this.websocket.on(nt.RECONNECTING,t=>{this._websocketReconnectReason=t,this.joinResponse=void 0,this.connectionState===wt.CONNECTED?this.connectionState=wt.RECONNECTING:this.connectionState=wt.CONNECTING}),this.websocket.on(nt.WILL_RECONNECT,(t,n,a)=>{t!=="retry"?(L.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(t)),this.reconnectToken=void 0,this.emit(Me.NEED_RENEW_SESSION)):L.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),a(t)}),this.websocket.on(nt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.join().catch(t=>{if(this.emit(Me.REPORT_JOIN_GATEWAY,t.message||t.code,this.url||""),t instanceof Te&&t.code===z.UNEXPECTED_RESPONSE&&t.data.code===qe.ERR_NO_AUTHORIZED)return L.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",Mr.SERVER_ERROR);L.error("[".concat(this.clientId,"] join gateway request failed"),t.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Mr.SERVER_ERROR):(this.initError=t,this.close())})}),this.websocket.on(nt.REQUEST_NEW_URLS,(t,n)=>{cr(this,Me.REQUEST_RECOVER,this.multiIpOption).then(t).catch(n)}),this.websocket.on(nt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(ot.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}function xM(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function ns(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xM(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):xM(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}const DT=new Map;class Xee extends wn{get state(){return this._state}set state(t){if(t===this._state)return;const n=this._state;this._state=t,t==="DISCONNECTED"&&this._disconnectedReason?this.emit(Ln.CONNECTION_STATE_CHANGE,t,n,this._disconnectedReason):this.emit(Ln.CONNECTION_STATE_CHANGE,t,n)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(t){L.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(t)),this._joinGatewayStartTime=t}constructor(t,n){super(),w(this,"store",void 0),w(this,"joinInfo",void 0),w(this,"key",void 0),w(this,"ntpOffset",0),w(this,"signal",void 0),w(this,"role",void 0),w(this,"inChannelInfo",{joinAt:null,duration:0}),w(this,"spec",void 0),w(this,"_state","DISCONNECTED"),w(this,"_statsCollector",void 0),w(this,"_disconnectedReason",void 0),w(this,"isSignalRecover",!1),w(this,"hasChangeBGPAddress",!1),w(this,"trafficStatsInterval",void 0),w(this,"networkQualityInterval",void 0),w(this,"_joinGatewayStartTime",0),w(this,"_signalTimeout",!1),w(this,"_clientRoleOptions",void 0),w(this,"_isProactiveJoin",!1),this.store=t,this.spec=n,this.signal=this.store.useP2P?new OM(ns(ns({},n),{},{retryConfig:n.websocketRetryConfig}),t):this.store.useDataChannel?new Qc(ns(ns({},n),{},{retryConfig:n.websocketRetryConfig}),t):new _M(ns(ns({},n),{},{retryConfig:n.websocketRetryConfig}),t),this._statsCollector=n.statsCollector,this.role=n.role||"audience",this._clientRoleOptions=n.clientRoleOptions,this.handleSignalEvents()}async join(t,n,a){if(this.signal instanceof Qc){let v=!1;t.cloudProxyServer!=="disabled"?(L.debug("[".concat(this.store.clientId,"] Dc is not supported, because cloudProxyServer are not supported (").concat(t.cloudProxyServer,")")),v=!0):"".concat(t.apResponse.cid,"_").concat(t.apResponse.cert).length>255||"".concat(t.apResponse.cid,"_").concat(t.apResponse.cert).length<22?(L.debug("[".concat(this.store.clientId,"] Dc is not supported, because ticket length is incorrect, it has to be between 22 and 255")),v=!0):t.apResponse.addresses.some(E=>E.fingerprint)||J("FINGERPRINT")||(L.debug("[".concat(this.store.clientId,"] Dc is not supported, because fingerprint does not exist")),v=!0),v&&this.resetSignal()}this.store.joinGatewayStart(),t.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const l=Date.now();let u=DT.get(t.cname);if(u||(u=new Map,DT.set(t.cname,u)),this._isProactiveJoin=!0,u.has(t.uid)){const v=new ue(z.UID_CONFLICT);throw We.joinGateway(t.sid,{lts:l,succ:!1,ec:v.message,addr:null,uid:t.uid,cid:t.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!t.proxyServer,signalChannel:this.signal instanceof Qc?"1":"0"}),this._isProactiveJoin=!1,v}u.set(t.uid,!0),this.joinInfo=t,this.key=n;let h=0;this.joinGatewayStartTime=l;const p=t.proxyServer;try{let v;if(L.debug("[".concat(this.store.clientId,"] use ").concat(this.signal instanceof Qc?"datachannel":"websocket"," join uid ").concat(h)),this.signal instanceof Qc)v=await this.signal.init(t.apResponse.addresses,a);else{const E=t.gatewayAddrs.map(y=>{let{address:C}=y;const[I,k]=C.split(":"),G={host:I,port:k};return t.proxyServer&&(G.proxy=t.proxyServer),G});v=await this.signal.init(E,a)}h=v.uid,L.debug("[".concat(this.store.clientId,"] ").concat(this.signal instanceof Qc?"datachannel":"websocket"," join uid ").concat(h," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(v){throw v&&v.code===z.INIT_WEBSOCKET_TIMEOUT?(L.warning("[".concat(this.store.clientId,"] User join failed"),v.toString()),v):v&&v.code===z.INIT_DATACHANNEL_TIMEOUT?(L.warning("[".concat(this.store.clientId,"] User join datachannel failed"),v.toString()),this.resetSignal(),v):(L.error("[".concat(this.store.clientId,"] User join failed"),v.toString()),We.joinGateway(t.sid,{lts:l,succ:!1,ec:v.message,addr:this.signal.url,uid:t.uid,cid:t.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!p,signalChannel:this.signal instanceof Qc?"1":"0"}),this._isProactiveJoin=!1,u.delete(t.uid),this.signal.close(),v)}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),L.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(v=>{L.warning("[".concat(this.store.clientId,"] get traffic stats error"),v.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(Ln.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(Ln.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(Ln.NETWORK_QUALITY,{uplinkNetworkQuality:wM(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:wM(this._statsCollector.trafficStats.B_dnq)}):this.emit(Ln.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),h}async leave(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],n=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){n!==xt.FALLBACK&&(this.state="DISCONNECTING");try{t||this.signal.connectionState!==wt.CONNECTED||await function(a,l){return l===1/0?a:_e.race([a,bZ(l)])}(this.signal.request(Ke.LEAVE,void 0,!0),3e3)}catch(a){L.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),a)}this.signal.close(n),n!==xt.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(t,n,a){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ue(z.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const l={state:"offer",p2p_id:this.store.p2pId,ortc:n,mode:this.spec.mode,extend:J("PUB_EXTEND"),twcc:!!J("PUBLISH_TWCC"),rtx:!!J("USE_PUB_RTX")};try{return(await this.signal.request(Ke.PUBLISH,l,!0))._message}catch(u){if(a&&u.data&&u.data.code===qe.ERR_PUBLISH_REQUEST_INVALID)return L.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),u.toString()),await this.tryUnpubBeforeRepub(t,n),this.publish(t,n,!1);throw u}}async publishDataChannel(t,n,a){var l;if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ue(z.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const u={stream_id:n.streamId,ordered:n.ordered?1:0,max_retrans_times:(l=n.maxRetransmits)!==null&&l!==void 0?l:10,channel_id:n.channelId,metadata:n.metadata};try{await this.signal.request(Ke.PUBLISH_DATASTREAM,u,!0)}catch(h){if(a&&h.data&&h.data.code===qe.ERR_PUBLISH_REQUEST_INVALID)return L.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),h.toString()),await this.tryUnpubDataChannelBeforeRepub(t,n),this.publishDataChannel(t,n,!1);throw h}}async unpublish(t,n){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ue(z.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(Ke.UNPUBLISH,{stream_id:n,ortc:t},!0)}catch(a){L.warning("[".concat(this.store.clientId,"] unpublish warning: "),a)}}async unpublishDataChannel(t){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ue(z.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await _e.all(t.map(n=>this.signal.request(Ke.UNPUBLISH_DATASTREAM,{channel_id:n},!0)))}catch(n){L.warning("unpublish datachannels warning: ",n)}}async presubscribe(t,n,a){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ue(z.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));const l={stream_id:t,stream_type:n,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!J("SUBSCRIBE_TWCC"),rtx:!!J("USE_SUB_RTX")||void 0,extend:J("SUB_EXTEND"),svc:Array.isArray(J("SVC"))&&J("SVC").length!==0?J("SVC"):void 0};try{return await this.signal.request(Ke.PRE_SUBSCRIBE,l,!0)}catch(u){if(a&&u.data&&u.data.code===qe.ERR_SUBSCRIBE_REQUEST_INVALID)return L.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),u.toString()),this.presubscribe(t,n,!1);throw u}}async subscribe(t,n,a){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ue(z.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const l={stream_id:t,stream_type:n.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!J("SUBSCRIBE_TWCC"),rtx:!!J("USE_SUB_RTX"),extend:J("SUB_EXTEND"),ssrcId:n.ssrcId,svc:Array.isArray(J("SVC"))&&J("SVC").length!==0?J("SVC"):void 0};try{return(await this.signal.request(Ke.SUBSCRIBE,l,!0))._message}catch(u){if(a&&u.data&&u.data.code===qe.ERR_SUBSCRIBE_REQUEST_INVALID)return L.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),u.toString()),await this.tryUnsubBeforeResub(t,n),await this.subscribe(t,n,!1);throw u}}async subscribeDataChannel(t,n,a){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ue(z.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const l={uid:t,stream_id:n.id,channel_id:n.datachannelId};try{return void await this.signal.request(Ke.SUBSCRIBE_DATASTREAM,l,!0)}catch(u){if(a&&u.data&&u.data.code===qe.ERR_SUBSCRIBE_REQUEST_INVALID)return L.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),u.toString()),await this.tryUnsubDataChannelBeforeResub(t,n),await this.subscribeDataChannel(t,n,!1);throw u}}async subscribeAll(t,n){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ue(z.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const a={p2p_id:this.store.p2pId,users:t,dtx:!1,rtx:!!J("USE_SUB_RTX")};try{return await this.signal.request(Ke.SUBSCRIBE_STREAMS,a,!0)}catch(l){if(n&&l.data&&l.data.code===qe.ERR_SUBSCRIBE_REQUEST_INVALID)return L.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),l.toString()),await this.tryMassUnsubBeforeResub(t),await this.subscribeAll(t,!1);throw l}}async setVideoProfile(t){const n=function(a){if(!(a.bitrateMax&&a.bitrateMin&&a.frameRate&&a.height&&a.width))return;let l=a.frameRate,u=a.width,h=a.height,p=!0;return typeof l!="number"&&(l=l.exact||l.ideal||l.max||l.min||0,l||(p=!1)),typeof u!="number"&&(u=u.exact||u.ideal||u.max||u.min||0,u||(p=!1)),typeof h!="number"&&(h=h.exact||h.ideal||h.max||h.min||0,l||(p=!1)),p?{stream_type:0,width:u,height:h,fps:l,start_bps:1e3*a.bitrateMax,min_bps:1e3*a.bitrateMin,target_bps:1e3*a.bitrateMax}:void 0}(t);if(n)return this.signal.request(Ke.SET_VIDEO_PROFILE,n);L.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(t,n){try{await this.signal.request(Ke.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:t,stream_id:n},!0)}catch(a){L.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),a)}}async unsubscribeDataChannel(t,n){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ue(z.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await _e.all(t.map(a=>this.signal.request(Ke.UNSUBSCRIBE_DATASTREAM,{stream_id:a,uid:n},!0)))}catch(a){L.warning("unsubscribeDataChannel warning: ",a)}}async massUnsubscribe(t){try{await this.signal.request(Ke.UNSUBSCRIBE_STREAMS,t,!0)}catch(n){L.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),n)}}async reconnectPC(t){const{iceParameters:n,dtlsParameters:a,rtpCapabilities:l}=t;return{gatewayEstablishParams:await this.signal.request(Ke.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:n,dtlsParameters:a,rtpCapabilities:l}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(Ke.GATEWAY_INFO)}async renewToken(t){await this.signal.request(Ke.RENEW_TOKEN,t),this.key=t.token}async setClientRole(t,n){if(n&&(this._clientRoleOptions=Object.assign({},n)),this.state!=="CONNECTED")return void(this.role=t);let a,l=0;t==="audience"?this._clientRoleOptions&&this._clientRoleOptions.delay?(a=this._clientRoleOptions.delay,l=1):l=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:l=0,await this.signal.request(Ke.SET_CLIENT_ROLE,{role:t,level:l,delay:a,client_ts:Date.now()}),this.role=t}async setRemoteVideoStreamType(t,n){await this.signal.request(Ke.SWITCH_VIDEO_STREAM,{stream_id:t,stream_type:n})}async setDefaultRemoteVideoStreamType(t){await this.signal.request(Ke.DEFAULT_VIDEO_STREAM,{stream_type:t})}async setStreamFallbackOption(t,n){await this.signal.request(Ke.SET_FALLBACK_OPTION,{stream_id:t,fallback_type:n})}async pickSVCLayer(t,n){await this.signal.request(Ke.PICK_SVC_LAYER,{stream_id:t,spatial_layer:n.spatialLayer,temporal_layer:n.temporalLayer})}async setRTM2Flag(t){await this.signal.request(Ke.SET_RTM2_FLAG,{rtm2_flag:t})}async sendExtensionMessage(t,n,a){if(this.signal instanceof OM)return this.signal.sendExtensionMessage(t,n,a)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),ns({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(Ke.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const t=DT.get(this.joinInfo.cname);t&&t.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const t=function(n){let a;return a=n.startsWith("dc")?n.match(/(dc\:\/\/)?([^:]+):(\d+)/):n.match(/(wss\:\/\/)?([^:]+):(\d+)/),a?{username:Hi.username,password:Hi.password,turnServerURL:a[2],tcpport:parseInt(a[3])+30,udpport:parseInt(a[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],t&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(ns(ns({},Hi),{},{turnServerURL:t.turnServerURL,tcpport:t.tcpport,udpport:t.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const t=await this.signal.request(Ke.TRAFFIC_STATS,void 0,!0);t.timestamp=Date.now(),t.ntp_offset!=null&&(this.ntpOffset=t.ntp_offset),t.peer_delay.forEach(n=>{const a=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(l=>l.peer_uid===n.peer_uid);a&&a.B_st!==n.B_st&&Ev(()=>{this.emit(Ln.STREAM_TYPE_CHANGE,n.peer_uid,n.B_st)})}),this._statsCollector.updateTrafficStats(t)}getJoinMessage(t){if(!this.joinInfo||!this.key)throw new ue(z.UNEXPECTED_ERROR,"can not generate join message, no join info");const n=Object.assign({},this.joinInfo.apResponse);let a=J("REPORT_APP_SCENARIO");if(typeof a!="string")try{a=JSON.stringify(a)}catch{a=void 0}a&&a.length>128&&(a=void 0);const l=ns({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:Ta,browser:navigator.userAgent,process_id:J("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:n,extend:J("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:a,attributes:{userAttributes:{enablePublishedUserList:J("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:J("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:typeof J("SUBSCRIBE_AUDIO_FILTER_TOPN")=="number"?J("SUBSCRIBE_AUDIO_FILTER_TOPN"):void 0,enablePublishAudioFilter:typeof J("ENABLE_PUBLISH_AUDIO_FILTER")=="boolean"?J("ENABLE_PUBLISH_AUDIO_FILTER"):void 0,enableUserLicenseCheck:typeof J("ENABLE_USER_LICENSE_CHECK")=="boolean"?J("ENABLE_USER_LICENSE_CHECK"):void 0,enableRTX:J("USE_PUB_RTX")===!0||J("USE_SUB_RTX")===!0||void 0,disableFEC:J("DISABLE_FEC"),enableNTPReport:!!J("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:!!J("ENABLE_INSTANT_VIDEO")||void 0,enableDataStream2:typeof J("ENABLE_DATASTREAM_2")=="boolean"?J("ENABLE_DATASTREAM_2"):void 0,rtm2Flag:typeof this.joinInfo.rtmFlag=="number"?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!J("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:typeof J("USE_XR")=="boolean"?J("USE_XR"):void 0}},join_ts:this.joinGatewayStartTime},t);return this.joinInfo.stringUid&&(l.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(l.aes_mode=this.joinInfo.aesmode,J("ENCRYPT_AES")?(l.aes_secret=this.joinInfo.aespassword,l.aes_encrypt=!0):l.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(l.aes_salt=this.joinInfo.aessalt)),n.addresses[this.signal.websocket.currentURLIndex]&&(l.ap_response.ticket=n.addresses[this.signal.websocket.currentURLIndex].ticket,delete n.addresses),this.joinInfo.defaultVideoStream!==void 0&&(l.default_video_stream=this.joinInfo.defaultVideoStream),l}getRejoinMessage(){if(!this.joinInfo)throw new ue(z.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(Me.WS_RECONNECT_WAITTING_FINISH,t=>{var n;Be(n=["tryNext","recover"]).call(n,t)&&this.joinInfo&&We.adjustSessionStartTime(this.joinInfo.sid)}),this.signal.on(Me.WS_RECONNECT_CREATE_CONNECTION,t=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(Me.WS_RECONNECTING,t=>{this.joinInfo&&We.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:t||Mr.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",We.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:this.spec.mode==="live"?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:this.role==="audience"?2:1}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(Me.WS_CLOSED,t=>{let n;switch(t){case xt.LEAVE:n=Mr.LEAVE;break;case xt.UID_BANNED:case xt.IP_BANNED:case xt.CHANNEL_BANNED:case xt.SERVER_ERROR:n=Mr.SERVER_ERROR;break;case xt.FALLBACK:n=Mr.FALLBACK;break;case xt.LICENSE_MISSING:case xt.LICENSE_EXPIRED:case xt.LICENSE_MINUTES_EXCEEDED:case xt.LICENSE_PERIOD_INVALID:case xt.LICENSE_MULTIPLE_SDK_SERVICE:case xt.LICENSE_ILLEGAL:case xt.TOKEN_EXPIRE:n=t;break;default:n=Mr.NETWORK_ERROR}L.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(n||"undefined -> "+Mr.NETWORK_ERROR)),this.joinInfo&&We.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:t===xt.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:n}),this._disconnectedReason=t,t!==xt.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(Me.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo&&(this.role==="audience"&&this._clientRoleOptions&&(this._clientRoleOptions.level||this._clientRoleOptions.delay)&&(L.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions.level,", delay: ").concat(this._clientRoleOptions.delay)),this.setClientRole(this.role,this._clientRoleOptions)),We.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof Qc?"1":"0"}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1)){const t=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!t)return void L.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(t));sn("EVENT_REPORT_DOMAIN",t[1]),sn("EVENT_REPORT_BACKUP_DOMAIN",t[1]),sn("LOG_UPLOAD_SERVER","".concat(t[1],":6444"))}}),this.signal.on(ot.ON_UPLINK_STATS,t=>{this._statsCollector.updateUplinkStats(t)}),this.signal.on(Me.REQUEST_RECOVER,(t,n,a)=>{if(!this.joinInfo)return a(new ue(z.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));t&&(this.joinInfo.multiIP=t,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,cr(this,Ln.REQUEST_NEW_GATEWAY_LIST).then(n).catch(a)}),this.signal.on(Me.REQUEST_JOIN_INFO,async t=>{var n;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void t(this.getJoinMessage({ortc:{}}));const{iceParameters:a,dtlsParameters:l,rtpCapabilities:u}=await cr(this,Ln.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:(n=this.joinInfo)===null||n===void 0?void 0:n.turnServer});t(this.getJoinMessage({ortc:{iceParameters:a,dtlsParameters:l,rtpCapabilities:u,version:"2"}}))}),this.signal.on(Me.REQUEST_REJOIN_INFO,t=>{t(this.getRejoinMessage())}),this.signal.on(Me.REPORT_JOIN_GATEWAY,(t,n)=>{this.joinInfo&&(We.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:t,addr:n,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof Qc?"1":"0"}),this._isProactiveJoin=!1)}),this.signal.on(Me.IS_P2P_DISCONNECTED,t=>{t(sd(this,Ln.IS_P2P_DISCONNECTED))}),this.signal.on(Me.DISCONNECT_P2P,()=>{this.emit(Ln.DISCONNECT_P2P)}),this.signal.on(Me.NEED_RENEW_SESSION,()=>{this.emit(Ln.NEED_RENEW_SESSION)}),this.signal.on(Me.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(Me.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(Me.JOIN_RESPONSE,t=>{const n=this.getCurrentGatewayAddress();this.emit(Ln.JOIN_RESPONSE,t,n)}),this.signal.on(Me.DATACHANNEL_PRECONNECT,async(t,n,a)=>{this.updateTurnConfigFromSignal();const l=this.getCurrentGatewayAddress();return cr(this,Ln.DATACHANNEL_PRECONNECT,t,l).then(n).catch(a)}),this.signal.on(Me.DATACHANNEL_CONNECTING,async t=>{const{iceParameters:n,dtlsParameters:a,rtpCapabilities:l}=await cr(this,Ln.REQUEST_DC_CONNECTION_PARAMS);t(this.getJoinMessage({ortc:{iceParameters:n,dtlsParameters:a,rtpCapabilities:l,version:"2"}}))}),this.signal.on(Me.DATACHANNEL_FAILBACK,()=>{L.warning("[".concat(this.store.clientId,"] User join datachannel failed")),this.reset(),this.resetSignal(),this.emit(Ln.DATACHANNEL_FAILBACK)})}async tryUnsubBeforeResub(t,n){try{await this.signal.request(Ke.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:t,ortc:[n]},!0)}catch(a){throw L.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),a),a}}async tryUnsubDataChannelBeforeResub(t,n){try{await this.signal.request(Ke.UNSUBSCRIBE,{stream_id:n.id},!0)}catch(a){throw L.warning("unsubscribe datachannel warning",a),a}}async tryUnpubBeforeRepub(t,n){try{await this.signal.request(Ke.UNPUBLISH,{stream_id:t,ortc:n},!0)}catch(a){throw L.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),a),a}}async tryUnpubDataChannelBeforeRepub(t,n){try{await this.signal.request(Ke.UNPUBLISH_DATASTREAM,{channnel_id:n.channelId},!0)}catch(a){throw L.warning("unpublish datastream warning: ",a),a}}async tryMassUnsubBeforeResub(t){const n={users:t.map(a=>({stream_id:a.stream_id,stream_type:a.stream_type}))};try{await this.signal.request(Ke.UNSUBSCRIBE_STREAMS,n,!0)}catch(a){throw L.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),a),a}}async muteLocal(t,n){const a={action:t.find(l=>l.stream_type===Kt.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:t,stream_id:n};try{await this.signal.request(Ke.CONTROL,a,!0,!0)}catch(l){throw L.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),l),l}}async unmuteLocal(t,n){const a={action:t.find(l=>l.stream_type===Kt.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:t,stream_id:n};try{await this.signal.request(Ke.CONTROL,a,!0,!0)}catch(l){throw L.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),l),l}}async muteRemote(t,n){const a={action:t===je.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:n};try{await this.signal.request(Ke.CONTROL,a,!0,!0)}catch(l){throw L.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),l),l}}async unmuteRemote(t,n){const a={action:t===je.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:n};try{await this.signal.request(Ke.CONTROL,a,!0,!0)}catch(l){throw L.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),l),l}}uploadWRTCStats(t){this.signal.uploadWRTCStats(t)}upload(t,n){this.signal.upload(t,n)}getSignalRTT(){return this.signal.rtt}async restartICE(t){const n={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:t};try{return await this.signal.request(Ke.RESTART_ICE,n,!0)}catch(a){throw L.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),a),a}}reconnect(){this.state==="CONNECTED"&&this.signal.reconnect(void 0,Mr.P2P_FAILED)}getCurrentGatewayAddress(){var t;if(!J("GATEWAY_WSS_ADDRESS"))return(t=this.joinInfo)!==null&&t!==void 0&&t.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(t){await this.signal.request(Ke.SET_PARAMETER,{enablePublishAudioFilter:t})}resetSignal(){this.signal&&(this.signal.removeAllListeners(),this.signal.close(xt.FALLBACK)),this.store.useDataChannel=!1,this.signal=new _M(ns(ns({},this.spec),{},{retryConfig:this.spec.websocketRetryConfig}),this.store),this.handleSignalEvents(),this.emit(Ln.RESET_SIGNAL,kv.websocket)}}let Bv=0,kT=0;function Zc(i,t,n,a){return new _e((l,u)=>{t.timeout=t.timeout||J("HTTP_CONNECT_TIMEOUT"),t.responseType=t.responseType||"json",t.data&&!n?(t.data=JSON.stringify(t.data),Bv+=Ec(t.data)):n&&(t.data.size?Bv+=t.data.size:t.data instanceof FormData?Bv+=Yk(t.data):Bv+=Ec(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=i,ho.request(t).then(h=>{typeof h.data=="string"?kT+=Ec(h.data):h.data instanceof ArrayBuffer||h.data instanceof Uint8Array?kT+=h.data.byteLength:kT+=Ec(JSON.stringify(h.data)),a&&l({data:h.data,headers:h.headers}),l(h.data)}).catch(h=>{ho.isCancel(h)?u(new ue(z.OPERATION_ABORTED,"cancel token canceled")):h.code==="ECONNABORTED"?u(new ue(z.NETWORK_TIMEOUT,h.message)):h.response?u(new ue(z.NETWORK_RESPONSE_ERROR,h.response.status)):u(new ue(z.NETWORK_ERROR,h.message))})})}/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */(function(){var i;function t(we){var Pe=0;return function(){return Pe<we.length?{done:!1,value:we[Pe++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(we,Pe,Ue){return we==Array.prototype||we==Object.prototype||(we[Pe]=Ue.value),we},a,l=function(we){we=[typeof globalThis=="object"&&globalThis,we,typeof window=="object"&&window,typeof self=="object"&&self,typeof s=="object"&&s];for(var Pe=0;Pe<we.length;++Pe){var Ue=we[Pe];if(Ue&&Ue.Math==Math)return Ue}throw Error("Cannot find global object")}(this);function u(we,Pe){if(Pe)e:{var Ue=l;we=we.split(".");for(var st=0;st<we.length-1;st++){var Gt=we[st];if(!(Gt in Ue))break e;Ue=Ue[Gt]}(Pe=Pe(st=Ue[we=we[we.length-1]]))!=st&&Pe!=null&&n(Ue,we,{configurable:!0,writable:!0,value:Pe})}}function h(we){return(we={next:we})[Symbol.iterator]=function(){return this},we}function p(we){var Pe=typeof Symbol<"u"&&Symbol.iterator&&we[Symbol.iterator];return Pe?Pe.call(we):{next:t(we)}}if(u("Symbol",function(we){function Pe(Gt,De){this.A=Gt,n(this,"description",{configurable:!0,writable:!0,value:De})}if(we)return we;Pe.prototype.toString=function(){return this.A};var Ue="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",st=0;return function Gt(De){if(this instanceof Gt)throw new TypeError("Symbol is not a constructor");return new Pe(Ue+(De||"")+"_"+st++,De)}}),u("Symbol.iterator",function(we){if(we)return we;we=Symbol("Symbol.iterator");for(var Pe="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Ue=0;Ue<Pe.length;Ue++){var st=l[Pe[Ue]];typeof st=="function"&&typeof st.prototype[we]!="function"&&n(st.prototype,we,{configurable:!0,writable:!0,value:function(){return h(t(this))}})}return we}),typeof Object.setPrototypeOf=="function")a=Object.setPrototypeOf;else{var v;e:{var E={};try{E.__proto__={a:!0},v=E.a;break e}catch{}v=!1}a=v?function(we,Pe){if(we.__proto__=Pe,we.__proto__!==Pe)throw new TypeError(we+" is not extensible");return we}:null}var y=a;function C(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function I(we){if(we.m)throw new TypeError("Generator is already running");we.m=!0}function k(we,Pe){return we.h=3,{value:Pe}}function G(we){this.g=new C,this.G=we}function B(we,Pe,Ue,st){try{var Gt=Pe.call(we.g.j,Ue);if(!(Gt instanceof Object))throw new TypeError("Iterator result "+Gt+" is not an object");if(!Gt.done)return we.g.m=!1,Gt;var De=Gt.value}catch(U){return we.g.j=null,we.g.s(U),j(we)}return we.g.j=null,st.call(we.g,De),j(we)}function j(we){for(;we.g.h;)try{var Pe=we.G(we.g);if(Pe)return we.g.m=!1,{value:Pe.value,done:!1}}catch(Ue){we.g.v=void 0,we.g.s(Ue)}if(we.g.m=!1,we.g.l){if(Pe=we.g.l,we.g.l=null,Pe.F)throw Pe.D;return{value:Pe.return,done:!0}}return{value:void 0,done:!0}}function q(we){this.next=function(Pe){return we.o(Pe)},this.throw=function(Pe){return we.s(Pe)},this.return=function(Pe){return function(Ue,st){I(Ue.g);var Gt=Ue.g.j;return Gt?B(Ue,"return"in Gt?Gt.return:function(De){return{value:De,done:!0}},st,Ue.g.return):(Ue.g.return(st),j(Ue))}(we,Pe)},this[Symbol.iterator]=function(){return this}}function Z(we,Pe){return Pe=new q(new G(Pe)),y&&we.prototype&&y(Pe,we.prototype),Pe}if(C.prototype.o=function(we){this.v=we},C.prototype.s=function(we){this.l={D:we,F:!0},this.h=this.C||this.u},C.prototype.return=function(we){this.l={return:we},this.h=this.u},G.prototype.o=function(we){return I(this.g),this.g.j?B(this,this.g.j.next,we,this.g.o):(this.g.o(we),j(this))},G.prototype.s=function(we){return I(this.g),this.g.j?B(this,this.g.j.throw,we,this.g.o):(this.g.s(we),j(this))},u("Array.prototype.entries",function(we){return we||function(){return function(Pe,Ue){Pe instanceof String&&(Pe+="");var st=0,Gt=!1,De={next:function(){if(!Gt&&st<Pe.length){var U=st++;return{value:Ue(U,Pe[U]),done:!1}}return Gt=!0,{done:!0,value:void 0}}};return De[Symbol.iterator]=function(){return De},De}(this,function(Pe,Ue){return[Pe,Ue]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var re=function(we,Pe){for(var Ue=0;Ue<we.length;Ue++)Pe(we[Ue])},Ce=function(we){return we.replace(/\r?\n|\r/g,`\r
`)},pe=function(we,Pe,Ue){return Pe instanceof Blob?(Ue=Ue!==void 0?Ue+"":typeof Pe.name=="string"?Pe.name:"blob",Pe.name===Ue&&Object.prototype.toString.call(Pe)!=="[object Blob]"||(Pe=new File([Pe],Ue)),[String(we),Pe]):[String(we),String(Pe)]},fe=function(we,Pe){if(we.length<Pe)throw new TypeError(Pe+" argument required, but only "+we.length+" present.")},ye=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,Ee=ye.FormData,Ae=ye.XMLHttpRequest&&ye.XMLHttpRequest.prototype.send,Ne=ye.Request&&ye.fetch,it=ye.navigator&&ye.navigator.sendBeacon,yt=ye.Element&&ye.Element.prototype,gn=ye.Symbol&&Symbol.toStringTag;gn&&(Blob.prototype[gn]||(Blob.prototype[gn]="Blob"),"File"in ye&&!File.prototype[gn]&&(File.prototype[gn]="File"));try{new File([],"")}catch{ye.File=function(Pe,Ue,st){return Pe=new Blob(Pe,st||{}),Object.defineProperties(Pe,{name:{value:Ue},lastModified:{value:+(st&&st.lastModified!==void 0?new Date(st.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),gn&&Object.defineProperty(Pe,gn,{value:"File"}),Pe}}var Er=function(we){return we.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},Sn=function(we){this.i=[];var Pe=this;we&&re(we.elements,function(Ue){if(Ue.name&&!Ue.disabled&&Ue.type!=="submit"&&Ue.type!=="button"&&!Ue.matches("form fieldset[disabled] *"))if(Ue.type==="file"){var st=Ue.files&&Ue.files.length?Ue.files:[new File([],"",{type:"application/octet-stream"})];re(st,function(Gt){Pe.append(Ue.name,Gt)})}else Ue.type==="select-multiple"||Ue.type==="select-one"?re(Ue.options,function(Gt){!Gt.disabled&&Gt.selected&&Pe.append(Ue.name,Gt.value)}):Ue.type==="checkbox"||Ue.type==="radio"?Ue.checked&&Pe.append(Ue.name,Ue.value):(st=Ue.type==="textarea"?Ce(Ue.value):Ue.value,Pe.append(Ue.name,st))})};if((i=Sn.prototype).append=function(we,Pe,Ue){fe(arguments,2),this.i.push(pe(we,Pe,Ue))},i.delete=function(we){fe(arguments,1);var Pe=[];we=String(we),re(this.i,function(Ue){Ue[0]!==we&&Pe.push(Ue)}),this.i=Pe},i.entries=function we(){var Pe,Ue=this;return Z(we,function(st){if(st.h==1&&(Pe=0),st.h!=3)return Pe<Ue.i.length?st=k(st,Ue.i[Pe]):(st.h=0,st=void 0),st;Pe++,st.h=2})},i.forEach=function(we,Pe){fe(arguments,1);for(var Ue=p(this),st=Ue.next();!st.done;st=Ue.next()){var Gt=p(st.value);st=Gt.next().value,Gt=Gt.next().value,we.call(Pe,Gt,st,this)}},i.get=function(we){fe(arguments,1);var Pe=this.i;we=String(we);for(var Ue=0;Ue<Pe.length;Ue++)if(Pe[Ue][0]===we)return Pe[Ue][1];return null},i.getAll=function(we){fe(arguments,1);var Pe=[];return we=String(we),re(this.i,function(Ue){Ue[0]===we&&Pe.push(Ue[1])}),Pe},i.has=function(we){fe(arguments,1),we=String(we);for(var Pe=0;Pe<this.i.length;Pe++)if(this.i[Pe][0]===we)return!0;return!1},i.keys=function we(){var Pe,Ue,st,Gt,De=this;return Z(we,function(U){if(U.h==1&&(Pe=p(De),Ue=Pe.next()),U.h!=3)return Ue.done?void(U.h=0):(st=Ue.value,Gt=p(st),k(U,Gt.next().value));Ue=Pe.next(),U.h=2})},i.set=function(we,Pe,Ue){fe(arguments,2),we=String(we);var st=[],Gt=pe(we,Pe,Ue),De=!0;re(this.i,function(U){U[0]===we?De&&(De=!st.push(Gt)):st.push(U)}),De&&st.push(Gt),this.i=st},i.values=function we(){var Pe,Ue,st,Gt,De=this;return Z(we,function(U){if(U.h==1&&(Pe=p(De),Ue=Pe.next()),U.h!=3)return Ue.done?void(U.h=0):(st=Ue.value,(Gt=p(st)).next(),k(U,Gt.next().value));Ue=Pe.next(),U.h=2})},Sn.prototype._asNative=function(){for(var we=new Ee,Pe=p(this),Ue=Pe.next();!Ue.done;Ue=Pe.next()){var st=p(Ue.value);Ue=st.next().value,st=st.next().value,we.append(Ue,st)}return we},Sn.prototype._blob=function(){var we="----formdata-polyfill-"+Math.random(),Pe=[],Ue="--"+we+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(st,Gt){return typeof st=="string"?Pe.push(Ue+Er(Ce(Gt))+`"\r
\r
`+Ce(st)+`\r
`):Pe.push(Ue+Er(Ce(Gt))+'"; filename="'+Er(st.name)+`"\r
Content-Type: `+(st.type||"application/octet-stream")+`\r
\r
`,st,`\r
`)}),Pe.push("--"+we+"--"),new Blob(Pe,{type:"multipart/form-data; boundary="+we})},Sn.prototype[Symbol.iterator]=function(){return this.entries()},Sn.prototype.toString=function(){return"[object FormData]"},yt&&!yt.matches&&(yt.matches=yt.matchesSelector||yt.mozMatchesSelector||yt.msMatchesSelector||yt.oMatchesSelector||yt.webkitMatchesSelector||function(we){for(var Pe=(we=(this.document||this.ownerDocument).querySelectorAll(we)).length;0<=--Pe&&we.item(Pe)!==this;);return-1<Pe}),gn&&(Sn.prototype[gn]="FormData"),Ae){var Lo=ye.XMLHttpRequest.prototype.setRequestHeader;ye.XMLHttpRequest.prototype.setRequestHeader=function(we,Pe){Lo.call(this,we,Pe),we.toLowerCase()==="content-type"&&(this.B=!0)},ye.XMLHttpRequest.prototype.send=function(we){we instanceof Sn?(we=we._blob(),this.B||this.setRequestHeader("Content-Type",we.type),Ae.call(this,we)):Ae.call(this,we)}}Ne&&(ye.fetch=function(we,Pe){return Pe&&Pe.body&&Pe.body instanceof Sn&&(Pe.body=Pe.body._blob()),Ne.call(this,we,Pe)}),it&&(ye.navigator.sendBeacon=function(we,Pe){return Pe instanceof Sn&&(Pe=Pe._asNative()),it.call(this,we,Pe)}),ye.FormData=Sn}})();const jv=()=>{const i=J("AREAS");return i.length===0&&i.push($t.GLOBAL),ud(i).call(i,(t,n,a)=>{const l=NM(n);return l?a===0?l:"".concat(t,",").concat(l):t},"")},NM=i=>i===$t.OVERSEA?"".concat(zr.ASIA,",").concat(zr.EUROPE,",").concat(zr.AFRICA,",").concat(zr.NORTH_AMERICA,",").concat(zr.SOUTH_AMERICA,",").concat(zr.OCEANIA):zr[i],Jee=i=>{const t={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return i.map(n=>{const a=Lv[n],l=Object.keys(a);l&&l.map(u=>{u!=="CODE"&&(t[u]=t[u].concat(a[u]))})}),t},Vv={GLOBAL:{ASIA:[$t.CHINA,$t.JAPAN,$t.INDIA,$t.KOREA,$t.HKMC],EUROPE:[],NORTH_AMERICA:[$t.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},$v=Object.keys(Vv[$t.GLOBAL]),LT=[$t.CHINA,$t.NORTH_AMERICA,$t.EUROPE,$t.ASIA,$t.JAPAN,$t.INDIA,$t.OCEANIA,$t.SOUTH_AMERICA,$t.AFRICA,$t.KOREA,$t.HKMC,$t.US],Qee=function(i,t){let n=[];if(Be(i).call(i,$t.GLOBAL)){const u=[$t.GLOBAL,$t.OVERSEA],h=Object.keys(Lv);if(t===$t.GLOBAL)throw new ue(z.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(t===$t.CHINA)n=[$t.OVERSEA];else if(l=t,Be($v).call($v,l)){const p=(a=t,Vv[$t.GLOBAL][a]||[]),v=[...u,t,...p];n=h.filter(E=>!Be(v).call(v,E))}else if(function(p){let v=!1;return $v.forEach(E=>{var y;Be(y=Vv[$t.GLOBAL][E]).call(y,p)&&(v=!0)}),v}(t)){const p=function(E){let y;return $v.forEach(C=>{var I;Be(I=Vv[$t.GLOBAL][C]).call(I,E)&&(y=C)}),y}(t),v=[...u,p,t];n=h.filter(E=>!Be(v).call(v,E))}else n=i;n=function(p){const v=[];return LT.forEach(E=>{Be(p).call(p,E)&&v.push(E)}),v.concat(p.filter(E=>!Be(LT).call(LT,E)))}(n)}else n=i;var a,l;return n};function PM(i){var t,n;if(!i&&Be(t=J("AREAS")).call(t,$t.EXTENSIONS))return L.debug("update area from ap : reset"),void MT(Eee,!0);if(!Be(n=J("AREAS")).call(n,$t.GLOBAL)||!i)return;let a=Lv.EXTENSIONS;a&&(a={CODE:NM($t.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(i,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(i,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(i,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(i,".agora.io"),"cds-ap-web-2-".concat(i,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(i,".agora.io"),"sua-ap-web-2-".concat(i,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(i,".agora.io"),"uap-ap-web-2-".concat(i,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(i,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(i,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(i,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(i,".agora.io")]},L.debug("update area from ap success: ".concat(i,",config is "),a),sn("AREAS",[$t.EXTENSIONS],!0),Object.keys(a).map(l=>{l==="LOG_UPLOAD_SERVER"||l==="EVENT_REPORT_DOMAIN"||l==="EVENT_REPORT_BACKUP_DOMAIN"||l==="PROXY_SERVER_TYPE3"?sn(l,a[l][0]):sn(l,a[l])}))}function MT(i){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const n=We.reportApiInvoke(null,{name:gr.SET_AREA,options:i,tag:Pn.TRACER});try{let a=[];if(typeof i=="string"&&(a=[i]),Array.isArray(i)&&(i.forEach(u=>{if(!Be(cM).call(cM,u))throw new ue(z.INVALID_PARAMS,"invalid area code")}),a=i),Object.prototype.toString.call(i)==="[object Object]"){const{areaCode:u,excludedArea:h}=i;if(!u)throw new ue(z.INVALID_PARAMS,"area code is needed");let p=u;typeof u=="string"&&(p=[u]),a=h?Qee(p,h):p}if(!t){if(Kl.AREAS){const u=new ue(z.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return n.onError(u),void L.warning("setArea is prohibited because of config-distribute")}if(Be(a).call(a,$t.GLOBAL)&&J("AREAS")===$t.EXTENSIONS){const u=new ue(z.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return n.onError(u),void L.warning("setArea is prohibited because of ap extensions")}}sn("AREAS",a,t);const l=Jee(a);Object.keys(l).map(u=>{u==="LOG_UPLOAD_SERVER"||u==="EVENT_REPORT_DOMAIN"||u==="EVENT_REPORT_BACKUP_DOMAIN"||u==="PROXY_SERVER_TYPE3"?sn(u,l[u][0]):sn(u,l[u])}),L.debug("set area success:",a.join(","))}catch(a){throw n.onError(a),a}n.onSuccess()}function DM(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function FT(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?DM(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):DM(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}let UT=1;function Zee(i,t,n,a,l){UT+=1;const u={sid:n.sid,command:"convergeAllocateEdge",uid:"666",appId:n.appId,ts:Math.floor(Date.now()/1e3),seq:UT,requestId:UT,version:Ta,cname:n.cname},h={service_name:t,json_body:JSON.stringify(u)};let p,v,E=i[0];return Ds(async()=>{p=Date.now();const y=await Zc(E,{data:h,cancelToken:a,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(v=Date.now()-p,y.code!==0){const k=new ue(z.UNEXPECTED_RESPONSE,"live streaming ap error, code"+y.code,{retry:!0,responseTime:v});throw L.error(k.toString()),k}const C=JSON.parse(y.json_body);if(C.code!==200){const k=new ue(z.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(C.code,", reason: ").concat(C.reason),{code:C.code,responseTime:v});throw L.error(k.toString()),k}if(!C.servers||C.servers.length===0){const k=new ue(z.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:C.code,responseTime:v});throw L.error(k.toString()),k}const I=function(k,G){return{addressList:k.servers.map(B=>"wss://".concat(B.address.replace(/\./g,"-"),".").concat(J("WORKER_DOMAIN"),":").concat(B.wss,"?serviceName=").concat(encodeURIComponent(G))),workerToken:k.workerToken,vid:k.vid}}(C,t);return J("LIVE_STREAMING_ADDRESS")&&(I.addressList=J("LIVE_STREAMING_ADDRESS")instanceof Array?J("LIVE_STREAMING_ADDRESS"):[J("LIVE_STREAMING_ADDRESS")]),FT(FT({},I),{},{responseTime:v})},(y,C)=>(We.apworkerEvent(n.sid,{success:!0,sc:200,serviceName:t,responseDetail:JSON.stringify(y.addressList),firstSuccess:C===0,responseTime:v,serverIp:i[C%i.length]}),!1),(y,C)=>(We.apworkerEvent(n.sid,{success:!1,sc:y.data&&y.data.code||200,serviceName:t,responseTime:v,serverIp:i[C%i.length]}),!!(y.code!==z.OPERATION_ABORTED&&y.code!==z.UNEXPECTED_RESPONSE||y.data&&y.data.retry)&&(E=i[(C+1)%i.length],!0)),l)}let BT=1;function kM(i,t,n,a){let{url:l,areaCode:u}=i;const h=Date.now();let p;const[v,E]=UM(t,u,[Br.CHOOSE_SERVER]);let y=lr.networkState;return Ds(async()=>{y&&lr.networkState===Di.OFFLINE&&lr.onlineWaiter&&await _e.race([lr.onlineWaiter,Fr(a&&a.maxRetryTimeout||ur.maxRetryTimeout)]),y=lr.networkState;const{data:C,headers:I}=await Zc(l,{data:v,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);p=I.http3==="1"?1:-1,We.reportResourceTiming(l,t.sid),MM(C,l,t,h,[Br.CHOOSE_SERVER],p);const k=NT(C,Br.CHOOSE_SERVER);return FM(k),TM(k,l)},C=>(C&&We.joinChooseServer(t.sid,{lts:h,succ:!0,csAddr:l,opid:E,serverList:C.gatewayAddrs.map(I=>I.address),ec:null,cid:C.cid.toString(),uid:C.uid.toString(),csIp:C.csIp,unilbsServerIds:[Br.CHOOSE_SERVER].toString(),isHttp3:p}),!1),C=>C.code!==z.OPERATION_ABORTED&&(C.code===z.CAN_NOT_GET_GATEWAY_SERVER?C.data.retry:(We.joinChooseServer(t.sid,{lts:h,succ:!1,csAddr:l,serverList:null,opid:E,ec:C.code,csIp:C.data&&C.data.csIp,unilbsServerIds:[Br.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:y}),isHttp3:p}),L.warning("[".concat(t.clientId,"] Choose server network error, retry"),C),!0)),a)}function LM(i,t,n,a){let l,{url:u,areaCode:h,serviceIds:p}=i;const v=Date.now(),[E,y]=UM(t,h,p);let C;return Ds(async()=>{C&&lr.networkState===Di.OFFLINE&&lr.onlineWaiter&&await _e.race([lr.onlineWaiter,Fr(a&&a.maxRetryTimeout||ur.maxRetryTimeout)]),C=lr.networkState;const{data:I,headers:k}=await Zc(u,{data:E,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);l=k.http3==="1"?1:-1,We.reportResourceTiming(u,t.sid),MM(I,u,t,v,p,l);const G=NT(I,Br.CHOOSE_SERVER),B=NT(I,t.cloudProxyServer==="proxy5"?Br.CLOUD_PROXY_5:t.cloudProxyServer==="proxy3"||t.cloudProxyServer==="proxy4"?Br.CLOUD_PROXY:Br.CLOUD_PROXY_FALLBACK);return FM(G),{gatewayInfo:TM(G,u),proxyInfo:B,url:u}},I=>(I.gatewayInfo&&We.joinChooseServer(t.sid,{lts:v,succ:!0,csAddr:u,serverList:I.gatewayInfo.gatewayAddrs.map(k=>k.address),ec:null,opid:y,cid:I.gatewayInfo.cid.toString(),uid:I.gatewayInfo.uid.toString(),csIp:I.gatewayInfo.csIp,unilbsServerIds:p.toString(),isHttp3:l}),I.proxyInfo&&We.joinWebProxyAP(t.sid,{lts:v,sucess:1,apServerAddr:u,turnServerAddrList:I.proxyInfo.addresses.map(k=>k.ip).join(","),errorCode:null,eventType:t.cloudProxyServer,unilbsServerIds:p.toString()}),!1),I=>I.code!==z.OPERATION_ABORTED&&(I.code===z.CAN_NOT_GET_GATEWAY_SERVER?I.data.retry:(We.joinWebProxyAP(t.sid,{lts:v,sucess:0,apServerAddr:u,turnServerAddrList:null,errorCode:I.code,eventType:t.cloudProxyServer,unilbsServerIds:p.toString(),extend:JSON.stringify({networkState:C})}),L.warning("[".concat(t.clientId,"] multi unilbs network error, retry"),I),!0)),a)}const MM=(i,t,n,a,l,u)=>{const h=[],p=v=>{v.flag===4096?We.joinChooseServer(n.sid,{lts:a,succ:!1,csAddr:t,opid:i.opid,serverList:null,ec:v.error.message,csIp:v.error.data&&v.error.data.csIp,unilbsServerIds:l.toString(),isHttp3:u}):v.flag!==1048576&&v.flag!==4194304&&v.flag!==4194310||We.joinWebProxyAP(n.sid,{lts:a,sucess:0,apServerAddr:t,turnServerAddrList:null,errorCode:v.error.code,eventType:n.cloudProxyServer,unilbsServerIds:l.toString()})};if(i.response_body.forEach(v=>{const E=v.buffer.code;if(v.uri===23&&E===0&&!v.buffer.edges_services)if(v.buffer.flag===4194310)L.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),v.buffer.edges_services=[];else{const y={error:new ue(z.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:i.detail[502]}),flag:v.buffer.flag};h.push(y),p(y)}if(E!==0){const y=Fv(E),C={error:new ue(z.CAN_NOT_GET_GATEWAY_SERVER,y.desc,{desc:y.desc,retry:y.retry,csIp:i.detail[502]}),flag:v.buffer.flag};v.buffer.flag===4194310?L.warning(C.error.toString()):h.push(C),p(C)}}),h.length)throw L.warning("[".concat(n.clientId,"] multi unilbs ").concat(t," failed, ").concat(h.map(v=>"flag: ".concat(v.flag,", message: ").concat(v.error.message,", retry: ").concat(v.error.data.retry)).join(" | "))),new ue(z.CAN_NOT_GET_GATEWAY_SERVER,h.map(v=>"flag: ".concat(v.flag,", message: ").concat(v.error.message)).join(" | "),{retry:!!h.find(v=>v.error.data.retry),csIp:i.detail[502],desc:[...new Set(h.map(v=>{var E;return v==null||(E=v.error)===null||E===void 0||(E=E.data)===null||E===void 0?void 0:E.desc}).filter(v=>!!v))]})},FM=i=>{var t,n,a,l;if(i.addresses&&i.addresses.length===0&&i.code===0)throw new ue(z.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:i.detail&&i.detail[502]});if(J("AP_AREA")&&((a=i.detail)!==null&&a!==void 0&&a[23]&&typeof((l=i.detail)===null||l===void 0?void 0:l[23])=="string"?PM(i.detail[23].toLowerCase()):PM()),(t=i.detail)!==null&&t!==void 0&&t[19]&&typeof((n=i.detail)===null||n===void 0?void 0:n[19])=="string"){const h=i.detail[19],p=h==null?void 0:h.split(";");for(let v=0;v<p.length;v++){var u;const E=xT(u=p[v]).call(u);i.addresses[v]&&p&&(i.addresses[v].fingerprint=E)}}if(J("GATEWAY_ADDRESS")&&J("GATEWAY_ADDRESS").length>0){L.debug("assign gateway address to",J("GATEWAY_ADDRESS"));const h=J("GATEWAY_ADDRESS").map(p=>{var v,E;const y=(v=(E=i.addresses.find(C=>C.ip===p.ip&&C.port===p.port))===null||E===void 0?void 0:E.fingerprint)!==null&&v!==void 0?v:"";return{ip:p.ip,port:p.port,ticket:i.addresses[0]&&i.addresses[0].ticket,fingerprint:y}});i.addresses=h}},ete=(i,t)=>{if(i.response_body&&i.response_body.length){const n=i.response_body[0];if(n.buffer.code!==0){const a=Fv(n.buffer.code);throw new ue(z.UPDATE_TICKET_FAILED,"[".concat(n.buffer.code,"]: ").concat(a.desc),{retry:a.retry})}return n.buffer.ticket}throw L.debug("update ticket request received ap response without response body:",t),new ue(z.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},UM=(i,t,n)=>{const a=Math.floor(Math.random()*1e12),l={appid:i.appId,client_ts:Date.now(),opid:a,sid:i.sid,request_bodies:[{uri:22,buffer:{cname:i.cname,detail:FT({6:i.stringUid,11:t,12:J("USE_NEW_TOKEN")?"1":void 0,22:t},i.apRTM?{26:"RTM2"}:{}),key:i.token,service_ids:n,uid:i.uid||0}}]};l.request_bodies.forEach(h=>{i.multiIP&&i.multiIP.gateway_ip&&(h.buffer.detail[5]=JSON.stringify({vocs_ip:[i.multiIP.uni_lbs_ip],vos_ip:[i.multiIP.gateway_ip]}))});const u=new FormData;return u.append("request",JSON.stringify(l)),[u,a]},tte=(i,t)=>{const n=Math.floor(Math.random()*1e12),a={appid:i.appId,client_ts:Date.now(),opid:n,sid:i.sid,request_bodies:[{uri:28,buffer:{cname:i.cname,detail:{1:"",6:i.stringUid,12:"1"},token:i.token,service_ids:t,uid:i.uid||0,edges_services:i.apResponse.addresses.map(u=>({ip:u.ip,port:u.port}))}}]},l=new FormData;return l.append("request",JSON.stringify(a)),[l,n]};let Wh=0;function Gh(i){return _e.all(i.map(t=>t.then(n=>{throw n},n=>n))).then(t=>{throw t},t=>t)}const h0=async i=>{let{fragementLength:t,referenceList:n,asyncMapHandler:a,allFailedhandler:l,promisesCollector:u}=i,h=0;const p=t;let v,E=0;const y=async()=>{const C=(()=>{const I=h*p,k=I+p;return n.slice(I,k).map(a)})();u&&u.push(...C);try{v=await Gh(C)}catch(I){if(E+=p,h++,!(E>=n.length))return void await y();l(I)}C.forEach(I=>I.cancel())};return await y(),v};async function jT(i,t,n,a){return{gatewayInfo:await async function(u,h,p,v){let E=null;const y=[],C=async()=>{const k=J("WEBCS_DOMAIN").slice(0,J("AJAX_REQUEST_CONCURRENT")).map(j=>({url:u.proxyServer?"https://".concat(u.proxyServer,"/ap/?url=").concat(j+"/api/v2/transpond/webrtc?v=2"):"https://".concat(j,"/api/v2/transpond/webrtc?v=2"),areaCode:jv()})),G=v.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:k.map(j=>j.url)}),B=await h0({fragementLength:J("FRAGEMENT_LENGTH"),referenceList:k,asyncMapHandler:j=>(L.debug("[".concat(u.clientId,"] Connect to choose_server:"),j.url),kM(j,u,h,p)),allFailedhandler:j=>{throw v.recordJoinChannelService({endTs:Date.now(),status:"error",errors:j},G),j[0]},promisesCollector:y});return v.recordJoinChannelService({endTs:Date.now(),status:"success"},G),B},I=async()=>{if(await Fr(1e3),E!==null)return E;const k=J("WEBCS_DOMAIN_BACKUP_LIST").map(j=>({url:u.proxyServer?"https://".concat(u.proxyServer,"/ap/?url=").concat(j+"/api/v2/transpond/webrtc?v=2"):"https://".concat(j,"/api/v2/transpond/webrtc?v=2"),areaCode:jv()})),G=v.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:k.map(j=>j.url)}),B=await h0({fragementLength:J("FRAGEMENT_LENGTH"),referenceList:k,asyncMapHandler:j=>(L.debug("[".concat(u.clientId,"] Connect to backup choose_server:"),j.url),kM(j,u,h,p)),allFailedhandler:j=>{throw v.recordJoinChannelService({endTs:Date.now(),status:"error",errors:j},G),j[0]},promisesCollector:y});return v.recordJoinChannelService({endTs:Date.now(),status:"success"},G),B};try{return E=await Gh([C(),I()]),y.length&&y.forEach(k=>k.cancel&&typeof k.cancel=="function"&&k.cancel()),E}catch(k){throw k[0]}}(i,t,n,a)}}async function BM(i,t,n,a,l){const u=i.cloudProxyServer;if(u==="disabled"){if(!a)return;if(i.useLocalAccessPoint)return await jT(i,t,n,l);if(J("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:I,proxyInfo:k}=await VM(i,t,n,l);if(i.turnServer&&i.turnServer.mode!=="auto")return{gatewayInfo:I};const G=k.map(B=>({turnServerURL:B.address,tcpport:B.tcpport||Hi.tcpport,udpport:B.udpport||Hi.udpport,username:B.username||Hi.username,password:B.password||Hi.password,forceturn:!1,security:!0}));if(l.useP2P){var h;const B=(h=i.uid)!==null&&h!==void 0?h:I.uid,j="glb:".concat(B.toString()),q=await zb(j),Z=k.map(re=>({turnServerURL:re.address,tcpport:re.tcpport||Hi.tcpport,udpport:re.udpport||Hi.udpport,username:j,password:q,forceturn:!1,security:!0}));G.push(...Z)}return i.turnServer={mode:"manual",servers:G},{gatewayInfo:I}}return await jT(i,t,n,l)}const{proxyInfo:p,gatewayInfo:v}=await VM(i,t,n,l),E={gatewayInfo:v},y=p.map(I=>({turnServerURL:I.address,tcpport:u==="proxy3"?void 0:I.tcpport?I.tcpport:Hi.tcpport,udpport:u==="proxy4"?void 0:I.udpport?I.udpport:Hi.udpport,username:I.username||Hi.username,password:I.password||Hi.password,forceturn:u!=="proxy4",security:u==="proxy5"}));if(l.useP2P){var C;const I=(C=i.uid)!==null&&C!==void 0?C:v.uid,k="glb:".concat(I.toString()),G=await zb(k),B=p.map(j=>({turnServerURL:j.address,tcpport:u==="proxy3"?void 0:j.tcpport||Hi.tcpport,udpport:u==="proxy4"?void 0:j.udpport||Hi.udpport,username:k,password:G,forceturn:u!=="proxy4",security:u==="proxy5"}));y.push(...B)}return i.turnServer={mode:"manual",servers:y},L.debug("[".concat(i.clientId,"] set proxy server: ").concat(i.proxyServer,", mode: ").concat(u)),E}async function jM(i,t,n,a,l){const u=J("ACCOUNT_REGISTER").slice(0,J("AJAX_REQUEST_CONCURRENT"));let h=[];h=t.proxyServer?u.map(v=>"https://".concat(t.proxyServer,"/ap/?url=").concat(v+"/api/v1")):u.map(v=>"https://".concat(v,"/api/v1"));const p=l==null?void 0:l.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:h});try{const v=await async function(E,y,C,I,k){const G=Date.now(),B={sid:C.sid,opid:10,appid:C.appId,string_uid:y};let j=E[0];const q=await Ds(()=>Zc(j+"".concat(j.indexOf("?")===-1?"?":"&","action=stringuid"),{data:B,cancelToken:I,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(Z,re)=>{if(Z.code===0){if(Z.uid<=0||Z.uid>=Math.pow(2,32))throw L.error("Invalid Uint Uid ".concat(y," => ").concat(Z.uid),Z),We.reqUserAccount(B.sid,{lts:G,success:!1,serverAddr:j,stringUid:B.string_uid,uid:Z.uid,errorCode:z.INVALID_UINT_UID_FROM_STRING_UID,extend:B}),new ue(z.INVALID_UINT_UID_FROM_STRING_UID);return We.reqUserAccount(B.sid,{lts:G,success:!0,serverAddr:j,stringUid:B.string_uid,uid:Z.uid,errorCode:null,extend:B}),!1}const Ce=Fv(Z.code);return Ce.retry&&(j=E[(re+1)%E.length]),We.reqUserAccount(B.sid,{lts:G,success:!1,serverAddr:j,stringUid:B.string_uid,uid:Z.uid,errorCode:Ce.desc,extend:B}),Ce.retry},(Z,re)=>Z.code!==z.OPERATION_ABORTED&&(We.reqUserAccount(B.sid,{lts:G,success:!1,serverAddr:j,stringUid:B.string_uid,uid:null,errorCode:Z.code,extend:B}),j=E[(re+1)%E.length],!0),k);if(q.code!==0){const Z=Fv(q.code);throw new ue(z.UNEXPECTED_RESPONSE,Z.desc)}return q}(h,i,t,n,a);return l==null||l.recordJoinChannelService({status:"success",endTs:Date.now()},p),v.uid}catch(v){throw l==null||l.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[v]},p),v}}async function nte(i,t,n){const a=J("CDS_AP").slice(0,J("AJAX_REQUEST_CONCURRENT")).map(p=>i.proxyServer?"https://".concat(i.proxyServer,"/ap/?url=").concat(p+"/api/v1"):"https://".concat(p,"/api/v1?action=config")).map(p=>function(v,E,y,C){const I=Wt(),k={flag:64,cipher_method:0,features:{device:I.name,system:I.os,system_general:navigator.userAgent,vendor:E.appId,version:Ta,cname:E.cname,sid:E.sid,session_id:E.sid,detail:"",proxyServer:E.proxyServer}};return Ds(()=>Zc(v,{data:k,timeout:1e3,cancelToken:y,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,G=>G.code!==z.OPERATION_ABORTED,C)}(p,i,t,n));let l=null,u=null,h={};try{l=await Gh(a)}catch(p){if(p.code===z.OPERATION_ABORTED)throw p;u=p}if(a.forEach(p=>p.cancel()),We.reportApiInvoke(i.sid,{name:gr.REQUEST_CONFIG_DISTRIBUTE,options:{error:u,res:l}}).onSuccess(),l&&l.test_tags)try{h=function(p){if(!p.test_tags)return{};const v=p.test_tags,E=Object.keys(v),y={};return E.forEach(C=>{var I;const k=xT(I=C.slice(4)).call(I),G=JSON.parse(v[C])[1];y[k]=G}),y}(l)}catch{}return h}async function VM(i,t,n,a){const l=J("PROXY_SERVER_TYPE3"),u=(k,G,B)=>{let j=B||l;return Array.isArray(j)&&(j=G%2==0?l[1]:l[0]),"https://".concat(j,"/ap/?url=").concat(k)};let h=null;const p=[],v=async()=>{const k=J("WEBCS_DOMAIN").slice(0,J("AJAX_REQUEST_CONCURRENT")).map((j,q)=>{let Z;return Z=i.cloudProxyServer==="disabled"&&i.proxyServer?u("".concat(j,"/api/v2/transpond/webrtc?v=2"),q,i.proxyServer):i.cloudProxyServer==="disabled"||i.cloudProxyServer==="fallback"?"https://".concat(j,"/api/v2/transpond/webrtc?v=2"):u("".concat(j,"/api/v2/transpond/webrtc?v=2"),q),{url:Z,areaCode:jv(),serviceIds:[Br.CHOOSE_SERVER,i.cloudProxyServer==="proxy5"?Br.CLOUD_PROXY_5:i.cloudProxyServer==="proxy3"||i.cloudProxyServer==="proxy4"?Br.CLOUD_PROXY:Br.CLOUD_PROXY_FALLBACK]}}),G=a.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:k.map(j=>j.url)}),B=await h0({fragementLength:J("FRAGEMENT_LENGTH"),referenceList:k,asyncMapHandler:j=>(L.debug("[".concat(i.clientId,"] Connect to choose_server:"),j.url),LM(j,i,t,n)),allFailedhandler:j=>{throw a.recordJoinChannelService({endTs:Date.now(),status:"error",errors:j},G),j[0]},promisesCollector:p});return a.recordJoinChannelService({endTs:Date.now(),status:"success"},G),B},E=async()=>{if(await Fr(1e3),h!==null)return h;const k=J("WEBCS_DOMAIN_BACKUP_LIST").map((j,q)=>{let Z;return Z=i.cloudProxyServer==="disabled"&&i.proxyServer?u("".concat(j,"/api/v2/transpond/webrtc?v=2"),q,i.proxyServer):i.cloudProxyServer==="disabled"||i.cloudProxyServer==="fallback"?"https://".concat(j,"/api/v2/transpond/webrtc?v=2"):u("".concat(j,"/api/v2/transpond/webrtc?v=2"),q),{url:Z,areaCode:jv(),serviceIds:[Br.CHOOSE_SERVER,i.cloudProxyServer==="proxy5"?Br.CLOUD_PROXY_5:i.cloudProxyServer==="proxy3"||i.cloudProxyServer==="proxy4"?Br.CLOUD_PROXY:Br.CLOUD_PROXY_FALLBACK]}}),G=a.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:k.map(j=>j.url)}),B=await h0({fragementLength:J("FRAGEMENT_LENGTH"),referenceList:k,asyncMapHandler:j=>(L.debug("[".concat(i.clientId,"] Connect to backup choose_server:"),j.url),LM(j,i,t,n)),allFailedhandler:j=>{throw a.recordJoinChannelService({endTs:Date.now(),status:"error",errors:j},G),j[0]},promisesCollector:p});return a.recordJoinChannelService({endTs:Date.now(),status:"success"},G),B};let y,C,I;try{({gatewayInfo:y,proxyInfo:C,url:I}=await Gh([v(),E()]))}catch(k){throw k[0]}if(p.length&&p.forEach(k=>k.cancel&&typeof k.cancel=="function"&&k.cancel()),!y||!C)throw new ue(z.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(i.apUrl=I,i.cloudProxyServer!=="disabled"&&Array.isArray(l)&&I){const k=/^https?:\/\/(.+?)(\/.*)?$/.exec(I)[1];Be(l).call(l,k)&&(i.proxyServer=k,L.setProxyServer(k),We.setProxyServer(k))}return h={gatewayInfo:y,proxyInfo:await Kee(C,y.uid)},h}async function $M(i,t,n,a){const l=J("UAP_AP").slice(0,J("AJAX_REQUEST_CONCURRENT")).map(u=>t.proxyServer?"https://".concat(t.proxyServer,"/ap/?url=").concat(u+"/api/v1?action=uap"):"https://".concat(u,"/api/v1?action=uap"));return await Zee(l,i,t,n,a)}async function rte(i,t,n){const a=J("UAP_AP").slice(0,J("AJAX_REQUEST_CONCURRENT")).map(l=>i.proxyServer?"https://".concat(i.proxyServer,"/ap/?url=").concat(l+"/api/v1?action=uap"):"https://".concat(l,"/api/v1?action=uap")).map(l=>function(u,h,p,v){const E={command:"convergeAllocateEdge",sid:h.sid,appId:h.appId,token:h.token,ts:Date.now(),version:Ta,cname:h.cname,uid:h.uid.toString(),requestId:BT,seq:BT};BT+=1;const y={service_name:"tele_channel",json_body:JSON.stringify(E)};return Ds(async()=>{const C=await Zc(u,{data:y,cancelToken:p,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(C.code!==0){const k=new ue(z.UNEXPECTED_RESPONSE,"cross channel ap error, code"+C.code,{retry:!0});throw L.error(k.toString()),k}const I=JSON.parse(C.json_body);if(I.code!==200){const k=new ue(z.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(I.code,", reason: ").concat(I.reason));throw L.error(k.toString()),k}if(!I.servers||I.servers.length===0){const k=new ue(z.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw L.error(k.toString()),k}return{vid:I.vid,workerToken:I.workerToken,addressList:(J("CHANNEL_MEDIA_RELAY_SERVERS")||I.servers).map(k=>"wss://".concat(k.address.replace(/\./g,"-"),".").concat(J("WORKER_DOMAIN"),":").concat(k.wss))}},void 0,C=>!!(C.code!==z.OPERATION_ABORTED&&C.code!==z.UNEXPECTED_RESPONSE||C.data&&C.data.retry),v)}(l,i,t,n));try{const l=await Gh(a);return a.forEach(u=>u.cancel()),l}catch(l){throw l[0]}}async function ite(i,t,n){let a=null;const l=[],u=async h=>{const p=J(h?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(v=>i.proxyServer?"https://".concat(i.proxyServer,"/ap/?url=").concat(v+"/api/v2/transpond/webrtc?v=2"):"https://".concat(v,"/api/v2/transpond/webrtc?v=2"));return h&&(await Fr(1e3),a!==null)?a:await h0({fragementLength:J("FRAGEMENT_LENGTH"),referenceList:p,asyncMapHandler:v=>(L.debug("[".concat(i.clientId,"] update ticket, Connect to ").concat(h?"backup":""," choose_server:"),v),function(E,y,C,I){const[k]=tte(y,[Br.CHOOSE_SERVER]);let G=lr.networkState;return Ds(async()=>{G&&lr.networkState===Di.OFFLINE&&lr.onlineWaiter&&await _e.race([lr.onlineWaiter,Fr(I&&I.maxRetryTimeout||ur.maxRetryTimeout)]),G=lr.networkState;const B=await Zc(E,{data:k,cancelToken:C,headers:{"Content-Type":"multipart/form-data;"}},!0);return ete(B,E)},()=>!1,B=>B.code!==z.OPERATION_ABORTED&&(B.code===z.UPDATE_TICKET_FAILED?B.data.retry:(L.warning("[".concat(y.clientId,"] update ticket network error, retry"),B),!0)),I)}(v,i,t,n)),allFailedhandler:v=>{throw v[0]},promisesCollector:l})};try{return a=await Gh([u(!1),u(!0)]),l.length&&l.forEach(h=>h.cancel&&typeof h.cancel=="function"&&h.cancel()),a}catch(h){throw h[0]}}function HM(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function WM(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?HM(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):HM(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}class ote extends wn{get isSuccess(){return!!this.configs}constructor(){super(),w(this,"configs",void 0),w(this,"joinInfo",void 0),w(this,"cancelToken",void 0),w(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),w(this,"interval",void 0),w(this,"mutex",new Ur("config-distribute")),w(this,"mutableParamsRead",!1)}startGetConfigDistribute(t,n){this.joinInfo=t,this.cancelToken=n,this.interval&&this.stopGetConfigDistribute(),J("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},J("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,We.reportApiInvoke(null,{options:void 0,name:gr.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:Pn.TRACER}).onSuccess(JSON.stringify(Kl))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void L.debug("[config-distribute] get config distribute interrupted have no joininfo");let t;const n=await this.mutex.lock();try{t=await nte(this.joinInfo,this.cancelToken,this.retryConfig),L.debug("[config-distribute] get config distribute",JSON.stringify(t)),t.limit_bitrate&&this.handleBitrateLimit(t.limit_bitrate),this.cacheGlobalParameterConfig(t),this.configs=t}catch(a){const l=new ue(z.NETWORK_RESPONSE_ERROR,a);L.warning("[config-distribute] ".concat(l.toString()))}finally{n()}}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(t){var n;(n=t)&&n.uplink&&n.id&&n.uplink.max_bitrate!==void 0&&n.uplink.min_bitrate!==void 0&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==t.id&&this.emit(l0.UPDATE_BITRATE_LIMIT,t):this.emit(l0.UPDATE_BITRATE_LIMIT,t))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&WM({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(t){var n;const a=zf(n=Object.keys(t).filter(u=>/^webrtc_ng_global_parameter/.test(u))).call(n);for(let u=0;u<a.length;u++)for(let h=a.length-1;h>u;h--){const p=a[h];if(typeof t[p].__priority=="number"){const v=t[p].__priority,E=a[h-1];if(typeof t[E].__priority=="number"){if(!(v>t[E].__priority))continue;{const y=p;a[h]=a[h-1],a[h-1]=y}}else{const y=p;a[h]=a[h-1],a[h-1]=y}}}const l={};a.forEach(u=>{const h=t[u],p=h.__expires;Object.keys(h).forEach(v=>{v==="__priority"||v==="__expires"||Object.prototype.hasOwnProperty.call(l,v)||(l[v]=WM({value:h[v]},p&&{expires:p}))})});try{(function(p){try{const v=Date.now();Object.keys(p).forEach(E=>{switch(E){case"ENABLE_EVENT_REPORT":case"UPLOAD_LOG":if(Object.prototype.hasOwnProperty.call($i,E)){const{value:y,expires:C}=p[E];if(C&&C<=v)return;Kl[E]=y,$i[E]=y,L.debug("Update global parameters from config distribute",E,y)}}})}catch(v){L.error("Error update config immediately: ".concat(p),v.message)}})(l);const u=JSON.stringify(l),h=window.btoa(u);window.localStorage.setItem("websdk_ng_global_parameter",h),L.debug("Caching global parameters ".concat(u))}catch(u){L.error("Error caching global parameters:",u.message)}}}const _i={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1};function cn(){return _i}var Ar;function zh(i,t,n){return{sampleRate:i,stereo:t,bitrate:n}}function Ut(i,t,n,a,l){return{width:i,height:t,frameRate:n,bitrateMin:a,bitrateMax:l}}function rs(i,t,n,a,l){return{width:{max:i},height:{max:t},frameRate:n,bitrateMin:a,bitrateMax:l}}function VT(i,t){return{numSpatialLayers:i,numTemporalLayers:t}}(function(i){i.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",i.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",i.IOS_INTERRUPTION_START="ios-interruption-start",i.IOS_INTERRUPTION_END="ios-interruption-end",i.STATE_CHANGE="state-change"})(Ar||(Ar={}));const ate={"90p":Ut(160,90),"90p_1":Ut(160,90),"120p":Ut(160,120,15,30,65),"120p_1":Ut(160,120,15,30,65),"120p_3":Ut(120,120,15,30,50),"120p_4":Ut(212,120),"180p":Ut(320,180,15,30,140),"180p_1":Ut(320,180,15,30,140),"180p_3":Ut(180,180,15,30,100),"180p_4":Ut(240,180,15,30,120),"240p":Ut(320,240,15,40,200),"240p_1":Ut(320,240,15,40,200),"240p_3":Ut(240,240,15,40,140),"240p_4":Ut(424,240,15,40,220),"360p":Ut(640,360,15,80,400),"360p_1":Ut(640,360,15,80,400),"360p_3":Ut(360,360,15,80,260),"360p_4":Ut(640,360,30,80,600),"360p_6":Ut(360,360,30,80,400),"360p_7":Ut(480,360,15,80,320),"360p_8":Ut(480,360,30,80,490),"360p_9":Ut(640,360,15,80,800),"360p_10":Ut(640,360,24,80,800),"360p_11":Ut(640,360,24,80,1e3),"480p":Ut(640,480,15,100,500),"480p_1":Ut(640,480,15,100,500),"480p_2":Ut(640,480,30,100,1e3),"480p_3":Ut(480,480,15,100,400),"480p_4":Ut(640,480,30,100,750),"480p_6":Ut(480,480,30,100,600),"480p_8":Ut(848,480,15,100,610),"480p_9":Ut(848,480,30,100,930),"480p_10":Ut(640,480,10,100,400),"720p":Ut(1280,720,15,120,1130),"720p_auto":Ut(1280,720,30,900,3e3),"720p_1":Ut(1280,720,15,120,1130),"720p_2":Ut(1280,720,30,120,2e3),"720p_3":Ut(1280,720,30,120,1710),"720p_5":Ut(960,720,15,120,910),"720p_6":Ut(960,720,30,120,1380),"1080p":Ut(1920,1080,15,120,2080),"1080p_1":Ut(1920,1080,15,120,2080),"1080p_2":Ut(1920,1080,30,120,3e3),"1080p_3":Ut(1920,1080,30,120,3150),"1080p_5":Ut(1920,1080,60,120,4780),"1440p":Ut(2560,1440,30,120,4850),"1440p_1":Ut(2560,1440,30,120,4850),"1440p_2":Ut(2560,1440,60,120,7350),"4k":Ut(3840,2160,30,120,8910),"4k_1":Ut(3840,2160,30,120,8910),"4k_3":Ut(3840,2160,60,120,13500)},Hv=[{scaleResolutionDownBy:2,width:1280,height:720,frameRate:30,bitrateMin:300,bitrateMax:900},{scaleResolutionDownBy:1.333333,width:1280,height:720,frameRate:30,bitrateMin:600,bitrateMax:2e3},{scaleResolutionDownBy:1,width:1280,height:720,frameRate:30,bitrateMin:900,bitrateMax:3e3}],ste={"480p":rs(640,480,5),"480p_1":rs(640,480,5),"480p_2":rs(640,480,30),"480p_3":rs(640,480,15),"720p":rs(1280,720,5),"720p_auto":Ut(1280,720,30,900,3e3),"720p_1":rs(1280,720,5),"720p_2":rs(1280,720,30),"720p_3":rs(1280,720,15),"1080p":rs(1920,1080,5),"1080p_1":rs(1920,1080,5),"1080p_2":rs(1920,1080,30),"1080p_3":rs(1920,1080,15)},cte={"1SL1TL":VT(1,1),"3SL3TL":VT(3,3),"2SL3TL":VT(2,3)};function Sc(i){return i||(i="480p_1"),typeof i=="string"?Object.assign({},ate[i]):i}function $T(i){return typeof i=="string"?Object.assign({},ste[i]):i}function Wv(i){return typeof i=="string"?Object.assign({},cte[i]):i}const lte={speech_low_quality:zh(16e3,!1),speech_standard:zh(32e3,!1,18),music_standard:zh(48e3,!1),standard_stereo:zh(48e3,!0,56),high_quality:zh(48e3,!1,128),high_quality_stereo:zh(48e3,!0,192)};function Gv(i){return typeof i=="string"?Object.assign({},lte[i]):i}const Kh=[];function GM(i){return Sr(i,"mediaSource",["screen","window","application"]),!0}var Fe,mn,nu,HT,WT,Yh,ru,gd,fo,zv;(function(i){i.NEED_RENEGOTIATE="@need_renegotiate",i.NEED_REPLACE_TRACK="@need_replace_track",i.NEED_CLOSE="@need_close",i.NEED_ENABLE_TRACK="@need_enable_track",i.NEED_DISABLE_TRACK="@need_disable_track",i.NEED_SESSION_ID="@need_sid",i.SET_OPTIMIZATION_MODE="@set_optimization_mode",i.GET_STATS="@get_stats",i.GET_RTC_STATS="@get_rtc_stats",i.GET_LOW_VIDEO_TRACK="@get_low_video_track",i.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",i.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",i.NEED_MUTE_TRACK="@need_mute_track",i.NEED_UNMUTE_TRACK="@need_unmute_track"})(Fe||(Fe={})),function(i){i.SCREEN_TRACK="screen_track",i.CUSTOM_TRACK="custome_track",i.LOW_STREAM="low_stream"}(mn||(mn={})),function(i){i[i.HIGH_STREAM=0]="HIGH_STREAM",i[i.LOW_STREAM=1]="LOW_STREAM"}(nu||(nu={})),function(i){i[i.HIGH_STREAM=0]="HIGH_STREAM",i[i.LOW_STREAM=1]="LOW_STREAM"}(HT||(HT={})),function(i){i[i.DISABLE=0]="DISABLE",i[i.LOW_STREAM=1]="LOW_STREAM",i[i.AUDIO_ONLY=2]="AUDIO_ONLY"}(WT||(WT={})),function(i){i.TRANSCEIVER_UPDATED="transceiver-updated"}(Yh||(Yh={})),function(i){i.SOURCE_STATE_CHANGE="source-state-change",i.TRACK_ENDED="track-ended",i.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",i.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",i.CLOSED="closed"}(ru||(ru={})),function(i){i.FIRST_FRAME_DECODED="first-frame-decoded",i.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status"}(gd||(gd={})),function(i){i.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",i.RECEIVE_TRACK_BUFFER="receive_track_buffer",i.ON_AUDIO_BUFFER="on_audio_buffer",i.UPDATE_SOURCE="update_source"}(fo||(fo={})),function(i){i.UPDATE_TRACK_SOURCE="update-track-source"}(zv||(zv={}));const GT={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},zT={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},zM={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},ute={uplinkNetworkQuality:0,downlinkNetworkQuality:0},KM={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};var yi,mo,vd,el,Si;(function(i){i.ON_TRACK="on_track",i.ON_NODE="on_node"})(yi||(yi={})),function(i){i.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",i.REQUEST_CONSTRAINTS="request_constraints"}(mo||(mo={})),function(i){i.IDLE="IDLE",i.INITING="INITING",i.INITEND="INITEND"}(vd||(vd={})),function(i){i.STATE_CHANGE="state_change",i.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",i.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",i.CAMERA_DEVICE_CHANGED="cameraDeviceChanged"}(el||(el={})),function(i){i.NONE="none",i.INIT="init",i.CANPLAY="canplay",i.PLAYING="playing",i.PAUSED="paused",i.SUSPEND="suspend",i.STALLED="stalled",i.WAITING="waiting",i.ERROR="error",i.DESTROYED="destroyed",i.ABORT="abort",i.ENDED="ended",i.EMPTIED="emptied",i.LOADEDDATA="loadeddata"}(Si||(Si={}));const KT={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};var qh;(function(i){i.OPEN="open",i.MESSAGE="message",i.CLOSE="close",i.CLOSING="closing",i.ERROR="error"})(qh||(qh={}));class YM extends wn{constructor(t,n){super(),w(this,"_ID",void 0),w(this,"_rtpTransceiver",void 0),w(this,"_lowRtpTransceiver",void 0),w(this,"_hints",[]),w(this,"_isClosed",!1),w(this,"_originMediaStreamTrack",void 0),w(this,"_mediaStreamTrack",void 0),w(this,"_external",{}),this._ID=n||pn(8,"track-"),this._originMediaStreamTrack=t,this._mediaStreamTrack=t,function(a){Be(Kh).call(Kh,a)||Kh.push(a)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(t){if(!t){const n=We.reportApiInvoke(null,{name:gr.GET_MEDIA_STREAM_TRACK,options:[],tag:Pn.TRACER});this._mediaStreamTrack&&typeof this._mediaStreamTrack.label=="string"?n.onSuccess(this._mediaStreamTrack.label):n.onSuccess("")}return this._mediaStreamTrack}getRTCRtpTransceiver(t){return t===nu.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(t){const n=Kh.indexOf(t);n!==-1&&Kh.splice(n,1)}(this),this.emit(ru.CLOSED)}_updateRtpTransceiver(t,n){if(n===nu.LOW_STREAM){if(this._lowRtpTransceiver===t)return;this._lowRtpTransceiver=t}else{if(this._rtpTransceiver===t)return;this._rtpTransceiver=t}this.emit(Yh.TRANSCEIVER_UPDATED,t,n)}}class ci extends YM{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}set processorContext(t){this._processorContext=t}constructor(t,n){super(t,n),w(this,"_enabled",!0),w(this,"_muted",!1),w(this,"_isExternalTrack",!1),w(this,"_isClosed",!1),w(this,"_enabledMutex",void 0),w(this,"processor",void 0),w(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new Ur("".concat(this.getTrackId())),t.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var t,n;return(t=(n=this._originMediaStreamTrack)===null||n===void 0?void 0:n.label)!==null&&t!==void 0?t:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,L.debug("[".concat(this.getTrackId(),"] close")),this.emit(Fe.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(t,n){let a=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this._isExternalTrack=a,t!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),n&&this._originMediaStreamTrack.stop()),t.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=t,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await hn(this,Fe.NEED_REPLACE_TRACK,this),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){L.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(ru.TRACK_ENDED)}stateCheck(t,n){if(L.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(t,": ").concat(n,"]")),Gl(n,t),this._enabled&&this._muted&&t==="enabled"&&n===!1)throw new Te(z.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",L);if(!this._enabled&&!this._muted&&t==="muted"&&n===!0)throw new Te(z.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",L)}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}function qM(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}const XM=window.AudioContext||window.webkitAudioContext;let Qo=null;const nn=new class extends wn{constructor(){super(...arguments),w(this,"prevState",void 0),w(this,"curState",void 0),w(this,"currentTime",void 0),w(this,"currentTimeStuckAt",void 0),w(this,"interruptDetectorTrack",void 0),w(this,"onLocalAudioTrackMute",()=>{L.info("ios15-interruption-start"),this.emit(Ar.IOS_15_16_INTERRUPTION_START)}),w(this,"onLocalAudioTrackUnmute",async()=>{L.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?L.info("ios15-interruption-end-canceled"):(Qo&&await Qo.suspend(),this.emit(Ar.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(i){L.debug("webaudio bindInterruptDetectorTrack ".concat(i.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=i,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(i){L.debug("webaudio unbindInterruptDetectorTrack ".concat(i.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===i&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function dte(){if(!XM)return void L.error("your browser is not support web audio");L.info("create audio context");const i=function(t){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?qM(Object(a),!0).forEach(function(l){w(t,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):qM(Object(a)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(a,l))})}return t}({},J("WEBAUDIO_INIT_OPTIONS"));L.debug("audio context init option:",JSON.stringify(i)),Qo=new XM(i),nn.curState=Qo.state,Qo.onstatechange=()=>{nn.prevState=nn.curState,nn.curState=Qo?Qo.state:void 0;const{prevState:t,curState:n}=nn,a=n==="running",l=n==="interrupted",u=t==="running",h=t==="suspended",p=t==="interrupted",v=Wt().osVersion;(Pi()||vc())&&u&&l&&(L.info("ios".concat(v,"-interruption-start")),nn.emit(Ar.IOS_INTERRUPTION_START)),(Pi()||vc())&&(h||p)&&a&&(L.info("ios".concat(v,"-interruption-end")),nn.emit(Ar.IOS_INTERRUPTION_END)),t!==n&&nn.emit(Ar.STATE_CHANGE,n,t)},setInterval(()=>{var t;const n=(t=Qo)===null||t===void 0?void 0:t.currentTime;nn.currentTime!==n?(nn.currentTimeStuckAt&&(L.debug("AudioContext current time resume at ".concat(n)),nn.currentTimeStuckAt=void 0),nn.currentTime=n):(n!==nn.currentTimeStuckAt&&(We.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:n},tag:Pn.TRACER}).onSuccess(),L.warning("AudioContext current time stuck at ".concat(n))),nn.currentTimeStuckAt=n)},5e3),async function(t){const n=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let a,l=!1,u=!1,h=!1;function p(j){t.state==="running"?v(!1):Pi()||vc()?t.state==="suspended"&&(v(!0),j&&t.resume().then(y,y)):t.state!=="closed"&&(v(!0),j&&t.resume().then(y,y))}function v(j){if(l!==j){l=j;for(let q=0,Z=n;q<Z.length;q+=1){const re=Z[q];j?window.addEventListener(re,C,{capture:!0,passive:!0}):window.removeEventListener(re,C,{capture:!0,passive:!0})}}}function E(){p(!0)}function y(){p(!1)}function C(){p(!0)}function I(j){if(!h)if(a.paused)if(j){let q;k(!1),h=!0;try{q=a.play(),q?q.then(G,G):(a.addEventListener("playing",G),a.addEventListener("abort",G),a.addEventListener("error",G))}catch{G()}}else k(!0);else k(!1)}function k(j){if(u!==j){u=j;for(let q=0,Z=n;q<Z.length;q++){const re=Z[q];j?window.addEventListener(re,B,{capture:!0,passive:!0}):window.removeEventListener(re,B,{capture:!0,passive:!0})}}}function G(){a.removeEventListener("playing",G),a.removeEventListener("abort",G),a.removeEventListener("error",G),h=!1,I(!1)}function B(){I(!0)}if(Pi()){const j=t.createMediaStreamDestination(),q=document.createElement("div");q.innerHTML="<audio x-webkit-airplay='deny'></audio>",a=q.children.item(0),a.controls=!1,a.disableRemotePlayback=!0,a.preload="auto",a.srcObject=j.stream,I(!0)}nn.on(Ar.STATE_CHANGE,E),p(!1)}(Qo)}function Xh(){if(!Qo){if(dte(),!Qo)throw new Te(z.NOT_SUPPORTED,"can not create audio context");return Qo}return Qo}function JM(){return!!Qo}function Ed(i){if(function(){if(YT!==null)return YT;const a=Xh(),l=a.createBufferSource(),u=a.createGain(),h=a.createGain();l.connect(u),l.connect(h),l.disconnect(u);let p=!1;try{l.disconnect(u)}catch{p=!0}return l.disconnect(),YT=p,p}())return;const t=i.connect,n=i.disconnect;i.connect=(a,l,u)=>{var h;return i._inputNodes||(i._inputNodes=[]),Be(h=i._inputNodes).call(h,a)||(a instanceof AudioNode?(i._inputNodes.push(a),t.call(i,a,l,u)):t.call(i,a,l)),i},i.disconnect=(a,l,u)=>{n.call(i),a?vv(i._inputNodes,a):i._inputNodes=[];for(const h of i._inputNodes)t.call(i,h)}}let YT=null;function qT(i,t){let n=!1;const a=1/t;if(J("DISABLE_WEBAUDIO")){const l=window.setInterval(()=>{n?window.clearInterval(l):i(performance.now()/1e3)},1e3*a)}else{const l=Xh();let u=l.createGain();u.gain.value=0,u.connect(l.destination);const h=()=>{if(n)return void(u=null);const p=l.createOscillator();p.onended=h,p.connect(u),p.start(0),p.stop(l.currentTime+a),i(l.currentTime)};h()}return()=>{n=!0}}class QM{constructor(){w(this,"context",void 0),w(this,"analyserNode",void 0),w(this,"sourceNode",void 0),this.context=Xh(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(t){if(t!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=t,t==null||t.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||Pi()||vc()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;const t=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(t);else{const a=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(a);for(let l=0;l<t.length;++l)t[l]=a[l]/128-1}const n=ud(t).call(t,(a,l)=>a+l*l,0)/t.length;return Math.max(10*Math.log10(n)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var t,n;(t=this.sourceNode)===null||t===void 0||t.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(n=this.sourceNode)===null||n===void 0||n.connect(this.analyserNode)}catch{L.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class ZM extends wn{get processSourceNode(){return this.sourceNode}set processedNode(t){var n;if(!this.isDestroyed&&this._processedNode!==t){try{var a;(a=this.sourceNode)===null||a===void 0||a.disconnect(this.outputNode)}catch{}(n=this._processedNode)===null||n===void 0||n.disconnect(),this._processedNode=t,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),w(this,"outputNode",void 0),w(this,"outputTrack",void 0),w(this,"isPlayed",!1),w(this,"context",void 0),w(this,"audioBufferNode",void 0),w(this,"destNode",void 0),w(this,"audioOutputLevel",0),w(this,"volumeLevelAnalyser",void 0),w(this,"_processedNode",void 0),w(this,"playNode",void 0),w(this,"isDestroyed",!1),w(this,"onNoAudioInput",void 0),w(this,"isNoAudioInput",!1),w(this,"_noAudioInputCount",0),this.context=Xh(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),Ed(this.outputNode),this.volumeLevelAnalyser=new QM}startGetAudioBuffer(t){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(t),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=n=>{this.emit(fo.ON_AUDIO_BUFFER,function(a){for(let l=0;l<a.outputBuffer.numberOfChannels;l+=1){const u=a.outputBuffer.getChannelData(l);for(let h=0;h<u.length;h+=1)u[h]=0}return a.inputBuffer}(n))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!cn().webAudioMediaStreamDest)throw new Te(z.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(t){this.context.state!=="running"&&Ev(()=>{nn.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=t||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(t>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;Pi()||vc()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();const n=this.volumeLevelAnalyser.getAnalyserNode();let a;n.getFloatTimeDomainData?(a=new Float32Array(n.fftSize),n.getFloatTimeDomainData(a)):(a=new Uint8Array(n.fftSize),n.getByteTimeDomainData(a));let l=!1;for(let u=0;u<a.length;u++)a[u]!==0&&(l=!0);return l?(this.isNoAudioInput=!1,!0):(await Fr(200),await this.checkHasAudioInput(t?t+1:1)&&l)}getAudioVolume(){return this.outputNode.gain.value}setVolume(t){this.outputNode.gain.setValueAtTime(t,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var t,n;(t=this.processedNode)===null||t===void 0||t.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var t;this.processedNode?(t=this.processedNode)===null||t===void 0||t.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class XT extends ZM{get isFreeze(){return!1}constructor(t,n,a){var l;if(super(),w(this,"sourceNode",void 0),w(this,"track",void 0),w(this,"clonedTrack",void 0),w(this,"audioElement",void 0),w(this,"isCurrentTrackCloned",!1),w(this,"isRemoteTrack",!1),w(this,"originVolumeLevelAnalyser",void 0),w(this,"rebuildWebAudio",async()=>{if(L.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void L.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>L.info("resume success")),L.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const p=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?p.stop():this.isCurrentTrackCloned=!0;const v=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(v),Ed(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const E=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(E,this.context.currentTime),Ed(this.outputNode),this.emit(fo.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=v,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),t.kind!=="audio")throw new Te(z.UNEXPECTED_ERROR);this.track=t;const u=new MediaStream([this.track]);if(this.isRemoteTrack=!!n,this.sourceNode=this.context.createMediaStreamSource(u),Ed(this.sourceNode),a){const p=a.clone();p.enabled=!0,this.clonedTrack=p,L.debug("create an unmuted track ".concat(p.id," from the original track ").concat(a.id," to get the volume"));const v=this.context.createMediaStreamSource(new MediaStream([p]));Ed(v),this.originVolumeLevelAnalyser=new QM,this.originVolumeLevelAnalyser.updateSource(v)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=u;const h=Wt();n&&h.os===yr.IOS&&Number((l=h.osVersion)===null||l===void 0?void 0:l.split(".")[0])<15&&(nn.on(Ar.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(p=>{p||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(t){this.sourceNode.disconnect(),this.track=t,this.isCurrentTrackCloned=!1;const n=new MediaStream([t]);this.sourceNode=this.context.createMediaStreamSource(n),Ed(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(fo.UPDATE_SOURCE),this.audioElement.srcObject=n}destroy(){var t;this.audioElement.srcObject=null,this.audioElement.remove(),nn.off("state-change",this.rebuildWebAudio),(t=this.originVolumeLevelAnalyser)===null||t===void 0||t.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(t){return this.context.createMediaStreamSource(new MediaStream([t]))}updateOriginTrack(t){const n=t.clone();n.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=n),L.debug("create an unmuted track ".concat(n.id," from the original track ").concat(t.id," to get the volume"));const a=this.context.createMediaStreamSource(new MediaStream([n]));Ed(a),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(a)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function eF(i,t,n){const a=(u,h)=>u?typeof u!="number"?u.max||u.exact||u.ideal||u.min||h:u:h,l={audio:!!n&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxHeight:a(t.height,1080),maxWidth:a(t.width,1920)}}};return t.frameRate&&typeof t.frameRate!="number"?(l.video.mandatory.maxFrameRate=t.frameRate.max,l.video.mandatory.minFrameRate=t.frameRate.min):typeof t.frameRate=="number"&&(l.video.mandatory.maxFrameRate=t.frameRate),await navigator.mediaDevices.getUserMedia(l)}async function hte(i,t){const n=await tF(i.mediaSource),{sourceId:a,audio:l}=await function(u){let h=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new _e((p,v)=>{const E=document.createElement("div");E.innerText="share screen",E.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const y=document.createElement("div");y.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const C=document.createElement("div");C.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",C.setAttribute("style","height: 12%;");const I=document.createElement("div");I.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const k=document.createElement("div");k.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const G=document.createElement("button");G.innerHTML="cancel",G.setAttribute("style","width: 85px;"),G.onclick=()=>{document.body.removeChild(q);const Z=new Error("NotAllowedError");Z.name="NotAllowedError",v(Z)};let B=h;const j=document.createElement("div");if(h){const Z=document.createElement("input");Z.setAttribute("type","checkbox");const re=document.createElement("span");Z.setAttribute("style","margin-right: 6px;"),re.innerText="Share audio",Z.checked=B,Z.onchange=()=>{B=Z.checked},j.appendChild(Z),j.appendChild(re)}k.appendChild(j),k.appendChild(G),y.appendChild(C),y.appendChild(I),y.appendChild(k);const q=document.createElement("div");q.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),q.appendChild(E),q.appendChild(y),document.body.appendChild(q),u.map(Z=>{if(Z.id){const re=document.createElement("div");re.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let Ce=Z.thumbnail;try{const{width:pe}=Ce.getSize();pe>1920&&(Ce=Ce.resize({width:1920}))}catch(pe){throw pe&&pe.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),pe}re.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+Ce.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+Z.name.replace(/[\u00A0-\u9999<>\&]/g,function(pe){return"&#"+pe.charCodeAt(0)+";"})+"</span>",re.onclick=()=>{document.body.removeChild(q),p({sourceId:Z.id,audio:B})},I.appendChild(re)}})})}(n,t);return await eF(a,i,l)}async function tF(i){let t=["window","screen"];i!=="application"&&i!=="window"||(t=["window"]),i==="screen"&&(t=["screen"]);const n=$k();if(!n)throw console.error("failed to fetch electron, please mount it to window"),new Te(z.ELECTRON_IS_NULL);let a=null;try{var l;a=((l=n.desktopCapturer)===null||l===void 0?void 0:l.getSources({types:t}))||n.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:t})}catch{a=null}a&&a.then||(a=new _e((u,h)=>{n.desktopCapturer.getSources({types:t},(p,v)=>{p?h(p):u(v)})}));try{return await a}catch(u){throw new Te(z.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,u.toString())}}function nF(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}const JT=new Ur("safari");let rF=!1,iF=!1;async function Zo(i,t){let n=0,a=null;for(;n<2;)try{a=await pte(i,t,n>0);break}catch(l){if(l instanceof Te)throw L.error("[".concat(t,"] ").concat(l.toString())),l;const u=Kv(l.name||l.code||l,l.message);if(u.code===z.MEDIA_OPTION_INVALID){L.debug("[".concat(t,"] detect media option invalid, retry")),n+=1,await Fr(500);continue}throw L.error("[".concat(t,"] ").concat(u.toString())),u}if(!a)throw new Te(z.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return a}async function pte(i,t,n){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Te(z.NOT_SUPPORTED,"can not find getUserMedia");n&&(i.video&&(delete i.video.width,delete i.video.height),i.screen&&(delete i.screen.width,delete i.screen.height));const a=cn(),l=new MediaStream;if(i.audioSource&&l.addTrack(i.audioSource),i.videoSource&&l.addTrack(i.videoSource),!i.audio&&!i.video&&!i.screen)return L.debug("Using Video Source/ Audio Source"),l;if(i.screen)if($k())i.screen.sourceId?Jh(l,await eF(i.screen.sourceId,i.screen,i.screenAudio)):Jh(l,await hte(i.screen,i.screenAudio));else if(n0()&&i.screen.extensionId&&i.screen.mandatory){if(!a.getStreamFromExtension)throw new Te(z.NOT_SUPPORTED,"This browser does not support screen sharing");L.debug("[".concat(t,'] Screen access on chrome stable, looking for extension"'));const I=await(h=i.screen.extensionId,p=t,new _e((k,G)=>{try{chrome.runtime.sendMessage(h,{getStream:!0},B=>{if(!B||!B.streamId)return L.error("[".concat(p,"] No response from Chrome Plugin. Plugin not installed properly"),B),void G(new Te(z.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));k(B.streamId)})}catch(B){L.error("[".concat(p,"] AgoraRTC screensharing plugin is not accessible(").concat(h,")"),B.toString()),G(new Te(z.CHROME_PLUGIN_NOT_INSTALL))}}));i.screen.mandatory.chromeMediaSourceId=I,Jh(l,await navigator.mediaDevices.getUserMedia({video:{mandatory:i.screen.mandatory}}))}else if(a.getDisplayMedia){var u;i.screen.mediaSource&&GM(i.screen.mediaSource);const I={width:i.screen.width,height:i.screen.height,frameRate:i.screen.frameRate,displaySurface:(u=i.screen.displaySurface)!==null&&u!==void 0?u:i.screen.mediaSource==="screen"?"monitor":i.screen.mediaSource},{selfBrowserSurface:k,surfaceSwitching:G,systemAudio:B}=i.screen,j={selfBrowserSurface:k,surfaceSwitching:G,systemAudio:B};!k&&delete j.selfBrowserSurface,!G&&delete j.surfaceSwitching,!B&&delete j.systemAudio,L.debug("[".concat(t,"] getDisplayMedia:"),JSON.stringify({video:I,audio:!!i.screenAudio,controls:j}));const q=await navigator.mediaDevices.getDisplayMedia(function(Z){for(var re=1;re<arguments.length;re++){var Ce=arguments[re]!=null?arguments[re]:{};re%2?nF(Object(Ce),!0).forEach(function(pe){w(Z,pe,Ce[pe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Z,Object.getOwnPropertyDescriptors(Ce)):nF(Object(Ce)).forEach(function(pe){Object.defineProperty(Z,pe,Object.getOwnPropertyDescriptor(Ce,pe))})}return Z}({video:I,audio:!!i.screenAudio},j));Jh(l,q)}else{if(!un())throw L.error("[".concat(t,"] This browser does not support screenSharing")),new Te(z.NOT_SUPPORTED,"This browser does not support screen sharing");{i.screen.mediaSource&&GM(i.screen.mediaSource);const I={video:{mediaSource:i.screen.mediaSource,width:i.screen.width,height:i.screen.height,frameRate:i.screen.frameRate}};L.debug("[".concat(t,"] getUserMedia: ").concat(JSON.stringify(I))),Jh(l,await navigator.mediaDevices.getUserMedia(I))}}var h,p;if(!i.video&&!i.audio)return l;let v={video:i.video,audio:i.audio},E=J("MEDIA_DEVICE_CONSTRAINTS");if(E)try{typeof E=="string"&&(E=JSON.parse(E)),v=qb(v,E)}catch{}L.debug("[".concat(t,"] GetUserMedia"),JSON.stringify(v)),Wt();let y,C=null;(Ni()||Pi()||fv())&&(C=await JT.lock());try{y=await navigator.mediaDevices.getUserMedia(v)}catch(I){throw C&&C(),I}return v.audio&&(rF=!0),v.video&&(iF=!0),Jh(l,y),C&&C(),l}function Kv(i,t){switch(i){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new Te(z.MEDIA_OPTION_INVALID,"".concat(i,": ").concat(t));case"NotFoundError":case"DevicesNotFoundError":return new Te(z.DEVICE_NOT_FOUND,"".concat(i,": ").concat(t));case"NotSupportedError":return new Te(z.NOT_SUPPORTED,"".concat(i,": ").concat(t));case"NotReadableError":return new Te(z.NOT_READABLE,"".concat(i,": ").concat(t));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new Te(z.PERMISSION_DENIED,"".concat(i,": ").concat(t));case"ConstraintNotSatisfiedError":return new Te(z.CONSTRAINT_NOT_SATISFIED,"".concat(i,": ").concat(t));default:return L.error("getUserMedia unexpected error",i),new Te(z.UNEXPECTED_ERROR,"".concat(i,": ").concat(t))}}function Jh(i,t){const n=i.getVideoTracks()[0],a=i.getAudioTracks()[0],l=t.getVideoTracks()[0],u=t.getAudioTracks()[0];u&&(a&&i.removeTrack(a),i.addTrack(u)),l&&(n&&i.removeTrack(n),i.addTrack(l))}const ea=new class extends wn{get state(){return this._state}set state(i){i!==this._state&&(this.emit(el.STATE_CHANGE,i),this._state=i)}constructor(){super(),w(this,"_state",vd.IDLE),w(this,"isAccessMicrophonePermission",!1),w(this,"isAccessCameraPermission",!1),w(this,"lastAccessMicrophonePermission",!1),w(this,"lastAccessCameraPermission",!1),w(this,"checkdeviceMatched",!1),w(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(J("ENUMERATE_DEVICES_INTERVAL")||(mv()||pv()===yr.HARMONY_OS)&&Wl())&&this.updateDevicesInfo()},J("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(i=>L.error(i.toString()))}async enumerateDevices(i,t){let n=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new Te(z.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const a=await navigator.mediaDevices.enumerateDevices(),l=this.checkMediaDeviceInfoIsOk(a);let u=!this.isAccessMicrophonePermission&&i,h=!this.isAccessCameraPermission&&t;l.audio&&(u=!1),l.video&&(h=!1);let p=null,v=null,E=null;if(!n&&(u||h)){if(JT.isLocked&&(L.debug("[device manager] wait GUM lock"),(await JT.lock())(),L.debug("[device manager] GUM unlock")),rF&&(u=!1,this.isAccessMicrophonePermission=!0),iF&&(h=!1,this.isAccessCameraPermission=!0),L.debug("[device manager] check media device permissions",i,t,u,h),u&&h){try{E=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(y){const C=Kv(y.name||y.code||y,y.message);if(C.code===z.PERMISSION_DENIED)throw C;L.warning("getUserMedia failed in getDevices",C)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(u){try{p=await navigator.mediaDevices.getUserMedia({audio:i})}catch(y){const C=Kv(y.name||y.code||y,y.message);if(C.code===z.PERMISSION_DENIED)throw C;L.warning("getUserMedia failed in getDevices",C)}this.isAccessMicrophonePermission=!0}else if(h){try{v=await navigator.mediaDevices.getUserMedia({video:t})}catch(y){const C=Kv(y.name||y.code||y,y.message);if(C.code===z.PERMISSION_DENIED)throw C;L.warning("getUserMedia failed in getDevices",C)}this.isAccessCameraPermission=!0}L.debug("[device manager] mic permission",i,"cam permission",t)}try{const y=await navigator.mediaDevices.enumerateDevices();return p&&p.getTracks().forEach(C=>C.stop()),v&&v.getTracks().forEach(C=>C.stop()),E&&E.getTracks().forEach(C=>C.stop()),p=null,v=null,E=null,y}catch(y){return p&&p.getTracks().forEach(C=>C.stop()),v&&v.getTracks().forEach(C=>C.stop()),E&&E.getTracks().forEach(C=>C.stop()),p=null,v=null,E=null,new Te(z.ENUMERATE_DEVICES_FAILED,y.toString()).throw()}}async getRecordingDevices(){let i=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,i)).filter(t=>t.kind==="audioinput")}async getCamerasDevices(){let i=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,i)).filter(t=>t.kind==="videoinput")}async getSpeakers(){let i=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,i)).filter(t=>t.kind==="audiooutput")}searchDeviceIdByName(i){let t=null;return this.deviceInfoMap.forEach(n=>{n.device.label===i&&(t=n.device.deviceId)}),t}async getDeviceById(i){const t=(await this.enumerateDevices(!0,!0,!0)).find(n=>n.deviceId===i);if(!t)throw new Te(z.DEVICE_NOT_FOUND,"deviceId: ".concat(i));return t}async init(){this.state=vd.INITING;try{await this.updateDevicesInfo(),this.state=vd.INITEND}catch(i){throw L.warning("Device Detection functionality cannot start properly.",i.toString()),this.state=vd.IDLE,!(typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1")&&new Te(z.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),i}}async updateDevicesInfo(){const i=await this.enumerateDevices(!0,!0,!0),t=Date.now(),n=[];if(i[0]&&i[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const l=i.find(h=>h.kind==="audioinput"&&h.deviceId==="default"),u=i.find(h=>h.kind==="audiooutput"&&h.deviceId==="default");l&&u?u.groupId===l.groupId?L.debug("[device-check] default input ".concat(l.label," and output ").concat(u.label," is the same group")):L.warning("[device-check] default input ".concat(l.label," and output ").concat(u.label," is not the same group")):L.debug("[device-check] default input or output not found")}const a=this.checkMediaDeviceInfoIsOk(i);if(i.forEach(l=>{if(!l.deviceId)return;const u=this.deviceInfoMap.get("".concat(l.kind,"_").concat(l.deviceId));if((u?u.state:"INACTIVE")!=="ACTIVE"){const h={initAt:t,updateAt:t,device:l,state:"ACTIVE"};this.deviceInfoMap.set("".concat(l.kind,"_").concat(l.deviceId),h),n.push(h)}u&&(u.updateAt=t)}),this.deviceInfoMap.forEach((l,u)=>{l.state==="ACTIVE"&&l.updateAt!==t&&(l.state="INACTIVE",n.push(l))}),this.state!==vd.INITEND)return a.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(a.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));n.forEach(l=>{switch(l.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(el.RECORDING_DEVICE_CHANGED,l);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(el.CAMERA_DEVICE_CHANGED,l);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(el.PLAYOUT_DEVICE_CHANGED,l)}}),a.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),a.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(i){const t=i.filter(l=>l.kind==="audioinput"),n=i.filter(l=>l.kind==="videoinput"),a={audio:!1,video:!1};for(const l of t)if(l.label&&l.deviceId){a.audio=!0;break}for(const l of n)if(l.label&&l.deviceId){a.video=!0;break}return a}};let QT=!1;const ta=new class extends wn{constructor(){super(...arguments),w(this,"onAutoplayFailed",void 0),w(this,"onAudioAutoplayFailed",void 0)}};function oF(){if(Wt(),!QT){const i=t=>{t.preventDefault(),QT=!1,r0()?document.body.removeEventListener("click",i,!0):(document.body.removeEventListener("touchstart",i,!0),document.body.removeEventListener("mousedown",i,!0))};QT=!0,r0()?document.body.addEventListener("click",i,!0):(document.body.addEventListener("touchstart",i,!0),document.body.addEventListener("mousedown",i,!0)),L.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),ta.onAutoplayFailed?ta.onAutoplayFailed():ta.onAudioAutoplayFailed?L.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):L.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),ta.emit("autoplay-failed")}}function aF(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function sF(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?aF(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):aF(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}function cF(i,t,n,a){if(!i)return;const l=We.getBaseInfoBySessionId(i);if(!l)return;const u=l.info,h=Date.now(),p=sF(sF({},u),{},{vid:u.vid===void 0?0:Number(u.vid),lts:h,elapse:h-l.startTime,cbRegistered:ta.onAutoplayFailed||ta.onAudioAutoplayFailed?1:-1,errorMsg:n,mediaType:t,trackId:a,extend:void 0});We.send({type:yn.AUTOPLAY_FAILED,data:p},!0)}const fte=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],go=new class{constructor(){w(this,"onAutoplayFailed",void 0),w(this,"elementMap",new Map),w(this,"elementStateMap",new Map),w(this,"elementsNeedToResume",[]),w(this,"sinkIdMap",new Map),w(this,"autoResumeAfterInterruption",i=>{Array.from(this.elementMap.entries()).forEach(t=>{let[n,a]=t;const l=this.elementStateMap.get(n),u=a.srcObject.getAudioTracks()[0],h=u&&u.readyState;if(L.debug("resume after interrupted, ele: ".concat(l," audio: ").concat(h," ").concat(i)),h==="live"){if(i)return a.pause(),void a.play();if(nn.curState==="running")return Ph()?(a.pause(),void a.play()):void(l&&l==="paused"&&a.play())}})}),w(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(i=>{let[t,n]=i;const a=n.srcObject.getAudioTracks()[0];a&&a.readyState==="live"&&(L.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),n.pause(),n.play())})}),this.autoResumeAudioElement(),nn.on(Ar.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),nn.on(Ar.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),nn.on(Ar.STATE_CHANGE,()=>{Pi()&&nn.prevState==="suspended"&&nn.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(i,t){const n=this.elementMap.get(i);if(this.sinkIdMap.set(i,t),n)try{await n.setSinkId(t)}catch(a){throw new Te(z.PERMISSION_DENIED,"can not set sink id: "+a.toString())}}play(i,t,n,a){if(this.elementMap.has(t))return;const l=document.createElement("audio");l.autoplay=!0,l.srcObject=new MediaStream([i]),this.bindAudioElementEvents(t,l),this.elementMap.set(t,l),this.elementStateMap.set(t,Si.INIT),this.setVolume(t,n);const u=this.sinkIdMap.get(t);if(u)try{l.setSinkId(u).catch(p=>{L.warning("[".concat(t,"] set sink id failed"),p.toString())})}catch(p){L.warning("[".concat(t,"] set sink id failed"),p.toString())}const h=l.play();h&&h.then&&h.catch(p=>{a&&cF(a,"audio",p.message,t),L.warning("audio element play warning",p.toString()),this.elementMap.has(t)&&p.name==="NotAllowedError"&&(L.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(l),Ev(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),oF()}))})}updateTrack(i,t){const n=this.elementMap.get(i);n&&(n.srcObject=new MediaStream([t]))}isPlaying(i){return this.elementMap.has(i)&&this.elementStateMap.get(i)==="playing"}setVolume(i,t){const n=this.elementMap.get(i);n&&(t=Math.max(0,Math.min(100,t)),n.volume=t/100)}stop(i){const t=this.elementMap.get(i);if(this.sinkIdMap.delete(i),!t)return;const n=this.elementsNeedToResume.indexOf(t);this.elementsNeedToResume.splice(n,1),t.srcObject=null,t.remove(),this.elementMap.delete(i),this.elementStateMap.delete(i)}bindAudioElementEvents(i,t){fte.forEach(n=>{t.addEventListener(n,a=>{const l=this.elementStateMap.get(i),u=a.type==="pause"?"paused":a.type;if(L.debug("[".concat(i,"] audio-element-status change ").concat(l," => ").concat(u)),a.type==="error"){const h=t==null?void 0:t.error;h&&L.error("[".concat(i,"] media error, code: ").concat(h.code,", message: ").concat(h.message))}this.elementStateMap.set(i,u)})})}getPlayerState(i){return this.elementStateMap.get(i)||"uninit"}autoResumeAudioElement(){const i=()=>{this.elementsNeedToResume.forEach(t=>{t.play().then(n=>{L.debug("Auto resume audio element success")}).catch(n=>{L.warning("Auto resume audio element failed!",n)})}),this.elementsNeedToResume=[]};new _e(t=>{document.body?t():window.addEventListener("load",()=>t())}).then(()=>{r0()?document.body.addEventListener("click",i,!0):(document.body.addEventListener("touchstart",i,!0),document.body.addEventListener("mousedown",i,!0))})}};function Xn(){return function(i,t,n){const a=n.value;return typeof a=="function"&&(n.value=function(){this._isClosed&&new Te(z.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",L);for(var l=arguments.length,u=new Array(l),h=0;h<l;h++)u[h]=arguments[h];const p=a.apply(this,u);return p instanceof _e?new _e((v,E)=>{p.then(v).catch(E)}):p}),n}}function lF(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function Yv(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?lF(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):lF(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}class uF extends wn{constructor(t){super(),w(this,"name","VideoProcessorDestination"),w(this,"ID","0"),w(this,"_source",void 0),w(this,"videoContext",void 0),w(this,"inputTrack",void 0),this.videoContext=t}get kind(){return"video"}get enabled(){return!0}pipe(){throw new Te(z.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new Te(z.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(t){if(t.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);t.track&&t.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=t.track,this.emit(yi.ON_TRACK,t.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(yi.ON_TRACK,void 0)}}class dF extends wn{set chained(t){this._chained=t}get chained(){return this._chained}constructor(t,n){super(),w(this,"constraintsMap",new Map),w(this,"statsRegistry",[]),w(this,"usageRegistry",[]),w(this,"trackId",void 0),w(this,"direction",void 0),w(this,"_chained",!1),this.trackId=t,this.direction=n}async getConstraints(){return await cr(this,mo.REQUEST_CONSTRAINTS)}async requestApplyConstraints(t,n){var a;return L.info("processor ".concat(n.name," requestApplyConstraints for ").concat(this.trackId)),t&&this.constraintsMap.set(n,t),hn(this,mo.REQUEST_UPDATE_CONSTRAINTS,Array.from(ks(a=this.constraintsMap).call(a)))}async requestRevertConstraints(t){var n;if(this.constraintsMap.has(t))return L.info("processor ".concat(t.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(t),hn(this,mo.REQUEST_UPDATE_CONSTRAINTS,Array.from(ks(n=this.constraintsMap).call(n)))}registerStats(t,n,a){this.statsRegistry.find(l=>l.processorID===t.ID&&l.processorName===t.name&&l.type===n)||this.statsRegistry.push({processorName:t.name,processorID:t.ID,type:n,cb:a})}unregisterStats(t,n){const a=this.statsRegistry.findIndex(l=>l.processorID===t.ID&&l.processorName===t.name&&l.type===n);a!==-1&&this.statsRegistry.splice(a,1)}gatherStats(){const t=[];for(const{processorID:n,processorName:a,type:l,cb:u}of this.statsRegistry)try{const h=u();t.push({processorID:n,processorName:a,type:l,stats:h})}catch(h){L.error(new Te(z.UNEXPECTED_ERROR,h.message))}return t}registerUsage(t,n){this.usageRegistry.find(a=>a.processorID===t.ID&&a.processorName===t.name)||this.usageRegistry.push({processorID:t.ID,processorName:t.name,cb:n})}unregisterUsage(t){const n=this.usageRegistry.findIndex(a=>a.processorID===t.ID&&a.processorName===t.name);n!==-1&&this.usageRegistry.splice(n,1)}async gatherUsage(){const t=[];if(!this.chained)return[];for(const{cb:n}of this.usageRegistry)try{let a=n();a instanceof _e&&(a=await a),t.push(Yv(Yv({},a),{},{direction:this.direction}))}catch(a){L.error("gather extension usage error",a)}return t}getDirection(){return this.direction}}class qv extends wn{constructor(t){super(),w(this,"name","AudioProcessorDestination"),w(this,"ID","0"),w(this,"inputTrack",void 0),w(this,"inputNode",void 0),w(this,"audioProcessorContext",void 0),w(this,"_source",void 0),this.audioProcessorContext=t}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new Te(z.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new Te(z.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(yi.ON_TRACK,void 0),this.emit(yi.ON_NODE,void 0)}updateInput(t){if(t.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);t.track&&this.inputTrack!==t.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=t.track,this.emit(yi.ON_TRACK,this.inputTrack)),t.node&&this.inputNode!==t.node&&(this.audioProcessorContext.chained=!0,this.inputNode=t.node,this.emit(yi.ON_NODE,this.inputNode))}}class Xv extends wn{set chained(t){this._chained=t}get chained(){return this._chained}constructor(t,n,a){super(),w(this,"constraintsMap",new Map),w(this,"statsRegistry",[]),w(this,"audioContext",void 0),w(this,"trackId",void 0),w(this,"direction",void 0),w(this,"usageRegistry",[]),w(this,"_chained",!1),this.audioContext=t,this.trackId=n,this.direction=a}async getConstraints(){return cr(this,mo.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(t,n){var a;return L.info("processor ".concat(n.name," requestApplyConstraints for ").concat(this.trackId)),t&&this.constraintsMap.set(n,t),hn(this,mo.REQUEST_UPDATE_CONSTRAINTS,Array.from(ks(a=this.constraintsMap).call(a)))}async requestRevertConstraints(t){var n;if(this.constraintsMap.has(t))return this.constraintsMap.delete(t),hn(this,mo.REQUEST_UPDATE_CONSTRAINTS,Array.from(ks(n=this.constraintsMap).call(n)))}registerStats(t,n,a){this.statsRegistry.find(l=>l.processorID===t.ID&&l.processorName===t.name&&l.type===n)||this.statsRegistry.push({processorName:t.name,processorID:t.ID,type:n,cb:a})}unregisterStats(t,n){const a=this.statsRegistry.findIndex(l=>l.processorID===t.ID&&l.processorName===t.name&&l.type===n);a!==-1&&this.statsRegistry.splice(a,1)}gatherStats(){const t=[];for(const{processorID:n,processorName:a,type:l,cb:u}of this.statsRegistry)try{const h=u();t.push({processorID:n,processorName:a,type:l,stats:h})}catch(h){L.error(new Te(z.UNEXPECTED_ERROR,h.message))}return t}registerUsage(t,n){this.usageRegistry.find(a=>a.processorID===t.ID&&a.processorName===t.name)||this.usageRegistry.push({processorID:t.ID,processorName:t.name,cb:n})}unregisterUsage(t){const n=this.usageRegistry.findIndex(a=>a.processorID===t.ID&&a.processorName===t.name);n!==-1&&this.usageRegistry.splice(n,1)}async gatherUsage(){const t=[];if(!this.chained)return[];for(const{cb:n}of this.usageRegistry)try{let a=n();a instanceof _e&&(a=await a),t.push(Yv(Yv({},a),{},{direction:this.direction}))}catch(a){L.error("gather extension usage error",a)}return t}getDirection(){return this.direction}}class ZT extends wn{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),w(this,"context",void 0),w(this,"processSourceNode",void 0),w(this,"outputTrack",void 0),w(this,"processedNode",void 0),w(this,"clonedTrack",void 0),w(this,"outputNode",void 0),this.outputNode=new mte}setVolume(){}createOutputTrack(){throw new Te(z.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class mte{disconnect(){}connect(){}}let Qh=null;class gte{constructor(){w(this,"state","open"),w(this,"trigger",void 0),w(this,"tasks",[]),L.debug("[macro-task-queue] is created."),this.trigger=window.setTimeout(()=>{this.state="closed",L.debug("[macro-task-queue] will be closed, all remaining tasks will execute. [".concat(this.tasks.map(t=>t.key),"]")),this.trigger=void 0,this.tasks.forEach(t=>{let{func:n}=t;return n()}),this.tasks.length=0,L.debug("[macro-task-queue] is closed.")})}enqueue(t,n){this.state!=="closed"&&(this.tasks.push({key:t,func:n}),L.debug("[macro-task-queue] is queued, current queue ".concat(this.tasks.length,". ").concat(typeof t=="string"?t:"")))}runTask(t){if(this.state==="closed")return;const n=this.tasks.findIndex(a=>a.key===t);if(n!==-1){const a=this.tasks.splice(n,1);L.debug("[macro-task-queue] is unqueued, current queue ".concat(this.tasks.length,". ").concat(typeof t=="string"?t:"")),a[0].func()}}release(){this.trigger&&(this.state="closed",clearTimeout(this.trigger),this.trigger=void 0,this.tasks.length=0,L.debug("[macro-task-queue] is closed."))}}function eR(i){return function(t,n,a){var l;const u=(l=a.value)!==null&&l!==void 0?l:a.get,h=function(){Qh&&Qh.state==="open"&&Qh.runTask(i);for(var p=arguments.length,v=new Array(p),E=0;E<p;E++)v[E]=arguments[E];return u==null?void 0:u.apply(this,...v)};return a.value?a.value=h:a.get=h,a}}function hF(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function tR(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hF(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):hF(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}class Xt extends ci{get _source(){return this._trackSource}set _source(t){this._trackSource=t}get processorContext(){return this._processorContext}set processorContext(t){this._processorContext=t}get processorDestination(){return this._processorDestination}set processorDestination(t){this._processorDestination=t}get isPlaying(){return this._useAudioElement?go.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(t,n,a,l,u){super(t,a),w(this,"trackMediaType","audio"),w(this,"_encoderConfig",void 0),w(this,"_trackSource",void 0),w(this,"_enabled",!0),w(this,"_volume",100),w(this,"_useAudioElement",!1),w(this,"_bypassWebAudio",!1),w(this,"processor",void 0),w(this,"_processorContext",void 0),w(this,"_processorDestination",void 0),w(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=n,this._getOriginVolumeLevel=!!l;const h=()=>{this.processorContext=new Xv(this._source.context,this.getTrackId(),"local"),this.processorDestination=new qv(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(fo.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})},p=u&&Ni()&&!JM();J("DISABLE_WEBAUDIO")?(this._source=new ZT,this._useAudioElement=!0,this._bypassWebAudio=!0):p?this._source=new ZT:(this._source=new XT(t,!1,this._getOriginVolumeLevel?t:void 0),J("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")||(this._useAudioElement=!0)),h(),!J("DISABLE_WEBAUDIO")&&p&&(Qh||(Qh=new gte),Qh).enqueue("INIT_WEBAUDIO",()=>{this._source=new XT(t,!1,this._getOriginVolumeLevel?t:void 0),J("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")||(this._useAudioElement=!0),h(),this.emit(zv.UPDATE_TRACK_SOURCE)})}setVolume(t){an(t,"volume",0,1e3),this._volume=t,this._source.setVolume(t/100),this._useAudioElement&&go.setVolume(this.getTrackId(),t);try{if(this._bypassWebAudio)return void L.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const n=this._source.createOutputTrack();this._mediaStreamTrack!==n&&(this._mediaStreamTrack=n,hn(this,Fe.NEED_REPLACE_TRACK,this).then(()=>{L.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(a=>{L.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),a)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(t){if(!this._useAudioElement||!n0()&&J("RESTRICTION_SET_PLAYBACK_DEVICE"))throw new Te(z.NOT_SUPPORTED,"your browser does not support setting the audio output device");await go.setSinkID(this.getTrackId(),t)}async setEnabled(t,n,a){return this._setEnabled(t,n,a)}async _setEnabled(t,n,a){if(!a){if(t===this._enabled)return;this.stateCheck("enabled",t)}if(L.info("[".concat(this.getTrackId(),"] start setEnabled"),t),t){this._originMediaStreamTrack.enabled=!0;try{a||(this._enabled=!0),await hn(this,Fe.NEED_ENABLE_TRACK,this),L.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(t," success"))}catch(l){throw a||(this._enabled=!1),L.error("[".concat(this.getTrackId(),"] setEnabled to true error"),l.toString()),l}}else{this._originMediaStreamTrack.enabled=!1,a||(this._enabled=!1);try{await hn(this,Fe.NEED_DISABLE_TRACK,this)}catch(l){throw a||(this._enabled=!0),L.error("[".concat(this.getTrackId(),"] setEnabled to false error"),l.toString()),l}}}async setMuted(t){t!==this._muted&&(this.stateCheck("muted",t),this._muted=t,this._originMediaStreamTrack.enabled=!t,L.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(t)),t?await hn(this,Fe.NEED_MUTE_TRACK,this):await hn(this,Fe.NEED_UNMUTE_TRACK,this))}getStats(){return o0(()=>{L.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),No(this,Fe.GET_STATS)||tR({},GT)}setAudioFrameCallback(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!t)return this._source.removeAllListeners(fo.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(n),this._source.removeAllListeners(fo.ON_AUDIO_BUFFER),this._source.on(fo.ON_AUDIO_BUFFER,a=>t(a))}play(){L.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(L.debug("[".concat(this.getTrackId(),"] start audio playback in element")),go.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){L.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?go.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let t=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];L.debug("[".concat(this.getTrackId(),"] update player source track")),t&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&go.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(t,n){this._originMediaStreamTrack!==t&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),n&&this._originMediaStreamTrack.stop()),t.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=t,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this.processor.updateInput({track:t,context:this.processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await hn(this,Fe.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(t))}renewMediaStreamTrack(t){return _e.resolve(void 0)}pipe(t){if(this._bypassWebAudio)throw new Te(z.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===t)return t;if(t._source)throw new Te(z.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),t}unpipe(){var t;if(!this.processor)return;const n=this.processor;(t=this._source.processSourceNode)===null||t===void 0||t.disconnect(),this.processor._source=!1,this.processor=void 0,n.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(yi.ON_TRACK,async t=>{t?t!==this._mediaStreamTrack&&(this._mediaStreamTrack=t,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(t),await hn(this,Fe.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await hn(this,Fe.NEED_REPLACE_TRACK,this))}),this.processorDestination.on(yi.ON_NODE,t=>{this._source.processedNode=t})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(yi.ON_TRACK),this.processorDestination.removeAllListeners(yi.ON_NODE)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(mo.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(mo.REQUEST_CONSTRAINTS)}}Re([eR("INIT_WEBAUDIO"),H("design:type",Object),H("design:paramtypes",[Object])],Xt.prototype,"_source",null),Re([eR("INIT_WEBAUDIO"),H("design:type",Xv),H("design:paramtypes",[Xv])],Xt.prototype,"processorContext",null),Re([eR("INIT_WEBAUDIO"),H("design:type",qv),H("design:paramtypes",[qv])],Xt.prototype,"processorDestination",null),Re([Je({argsMap:(i,t)=>[i.getTrackId(),t],throttleTime:300}),H("design:type",Function),H("design:paramtypes",[Number]),H("design:returntype",void 0)],Xt.prototype,"setVolume",null),Re([Je({argsMap:(i,t)=>[i.getTrackId(),t]}),Xn(),H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],Xt.prototype,"setPlaybackDevice",null),Re([Fh("LocalAudioTrack","_enabledMutex"),Je({argsMap:(i,t)=>[i.getTrackId(),t]}),Xn(),H("design:type",Function),H("design:paramtypes",[Boolean,Object,Boolean]),H("design:returntype",_e)],Xt.prototype,"setEnabled",null),Re([Fh("LocalAudioTrack","_enabledMutex"),Je({argsMap:(i,t)=>[i.getTrackId(),t]}),Xn(),H("design:type",Function),H("design:paramtypes",[Boolean]),H("design:returntype",_e)],Xt.prototype,"setMuted",null),Re([Xn(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",Object)],Xt.prototype,"getStats",null),Re([Xn(),H("design:type",Function),H("design:paramtypes",[Object,Number]),H("design:returntype",void 0)],Xt.prototype,"setAudioFrameCallback",null),Re([Je({argsMap:i=>[i.getTrackId()]}),Xn(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],Xt.prototype,"play",null),Re([Je({argsMap:i=>[i.getTrackId()]}),Xn(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],Xt.prototype,"stop",null),Re([Je({argsMap:i=>[i.getTrackId()]}),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],Xt.prototype,"close",null),Re([Je({argsMap:(i,t)=>[i.getTrackId(),t.name]}),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",Object)],Xt.prototype,"pipe",null),Re([Je({argsMap:i=>[i.getTrackId()]}),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],Xt.prototype,"unpipe",null);class _d extends Xt{get __className__(){return"MicrophoneAudioTrack"}constructor(t,n,a,l){super(t,n.encoderConfig?Gv(n.encoderConfig):{},l,J("GET_VOLUME_OF_MUTED_AUDIO_TRACK"),!0),w(this,"_config",void 0),w(this,"_deviceName","default"),w(this,"_constraints",void 0),w(this,"_originalConstraints",void 0),w(this,"_enabled",!0),this._config=n,this._constraints=a,this._originalConstraints=a,this._deviceName=t.label,typeof n.bypassWebAudio=="boolean"&&(this._bypassWebAudio=n.bypassWebAudio),(Ph()||Hb())&&nn.bindInterruptDetectorTrack(this),this.on(zv.UPDATE_TRACK_SOURCE,()=>{this.bindProcessorContextEvents()}),JM()&&this.bindProcessorContextEvents()}async setDevice(t){if(L.info("[".concat(this.getTrackId(),"] start set device to ").concat(t)),this._enabled)try{const n=await ea.getDeviceById(t),a={};a.audio=tR({},this._constraints),a.audio.deviceId={exact:t},this._originMediaStreamTrack.stop();let l=null;try{l=await Zo(a,this.getTrackId())}catch(u){throw L.error("[".concat(this.getTrackId(),"] setDevice failed"),u.toString()),l=await Zo({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(l.getAudioTracks()[0],!1),u}await this._updateOriginMediaStreamTrack(l.getAudioTracks()[0],!1),this._deviceName=n.label,this._config.microphoneId=t,this._constraints.deviceId={exact:t}}catch(n){throw L.error("[".concat(this.getTrackId(),"] setDevice error"),n.toString()),n}else try{const n=await ea.getDeviceById(t);this._deviceName=n.label,this._config.microphoneId=t,this._constraints.deviceId={exact:t}}catch(n){throw L.error("[".concat(this.getTrackId(),"] setDevice error"),n.toString()),n}L.info("[".concat(this.getTrackId(),"] set device to ").concat(t," success"))}async setEnabled(t,n,a){if(n)return L.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(t);if(!a){if(t===this._enabled)return;this.stateCheck("enabled",t)}if(L.info("[".concat(this.getTrackId(),"] start setEnabled"),t),!t){var l;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(l=this._source.clonedTrack)===null||l===void 0||l.stop(),a||(this._enabled=!1);try{await hn(this,Fe.NEED_DISABLE_TRACK,this)}catch(p){throw L.error("[".concat(this.getTrackId(),"] setEnabled false failed"),p.toString()),p}return}const u=tR({},this._constraints),h=ea.searchDeviceIdByName(this._deviceName);h&&!u.deviceId&&(u.deviceId=h);try{a||(this._enabled=!0);const p=await Zo({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(p.getAudioTracks()[0],!1),await hn(this,Fe.NEED_ENABLE_TRACK,this)}catch(p){throw a||(this._enabled=!1),L.error("[".concat(this.getTrackId(),"] setEnabled true failed"),p.toString()),p}L.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(Ph()||Hb())&&nn.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((Pi()||vc())&&this._enabled&&!this._isClosed&&nn.duringInterruption){const t=async()=>{nn.off(Ar.IOS_INTERRUPTION_END,t),this._enabled&&!this._isClosed&&(L.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};nn.on(Ar.IOS_INTERRUPTION_END,t)}else L.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(ru.TRACK_ENDED)}async renewMediaStreamTrack(t){const n=t||this._constraints,a=ea.searchDeviceIdByName(this._deviceName);if(a&&!n.deviceId&&(n.deviceId=a),this._constraints=n,this._enabled){this._originMediaStreamTrack.stop();const l=await Zo({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(l.getAudioTracks()[0],!0)}}bindProcessorContextEvents(){this.processorContext.on(mo.REQUEST_UPDATE_CONSTRAINTS,async(t,n,a)=>{try{const l=Object.assign({},this._originalConstraints,...t);await this.renewMediaStreamTrack(l),n()}catch(l){a(l)}}),this.processorContext.on(mo.REQUEST_CONSTRAINTS,async t=>{t(this._originMediaStreamTrack.getSettings())})}}Re([Je({argsMap:(i,t)=>[i.getTrackId(),t]}),Xn(),H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],_d.prototype,"setDevice",null),Re([Fh("MicrophoneAudioTrack","_enabledMutex"),Je({argsMap:(i,t,n)=>[i.getTrackId(),t,n]}),Xn(),H("design:type",Function),H("design:paramtypes",[Boolean,Boolean,Boolean]),H("design:returntype",_e)],_d.prototype,"setEnabled",null),Re([Je({argsMap:i=>[i.getTrackId()]}),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],_d.prototype,"close",null);class iu extends Xt{get __className__(){return"BufferSourceAudioTrack"}constructor(t,n,a,l){super(n.createOutputTrack(),a,l),w(this,"source",void 0),w(this,"_bufferSource",void 0),this.source=t,this._bufferSource=n,this._bufferSource.on(fo.AUDIO_SOURCE_STATE_CHANGE,u=>{this.safeEmit(ru.SOURCE_STATE_CHANGE,u)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(t){t&&this._bufferSource.updateOptions(t),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(t){this._bufferSource.seekAudioBuffer(t)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(t){an(t,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(t)}}Re([Je({argsMap:(i,t)=>[i.getTrackId(),t,i.duration]}),Xn(),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",void 0)],iu.prototype,"startProcessAudioBuffer",null),Re([Je({argsMap:i=>[i.getTrackId()]}),Xn(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],iu.prototype,"pauseProcessAudioBuffer",null),Re([Je({argsMap:i=>[i.getTrackId()]}),Xn(),H("design:type",Function),H("design:paramtypes",[Number]),H("design:returntype",void 0)],iu.prototype,"seekAudioBuffer",null),Re([Je({argsMap:i=>[i.getTrackId()]}),Xn(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],iu.prototype,"resumeProcessAudioBuffer",null),Re([Je({argsMap:i=>[i.getTrackId()]}),Xn(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],iu.prototype,"stopProcessAudioBuffer",null),Re([Je({argsMap:i=>[i.getTrackId()]}),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],iu.prototype,"close",null),Re([Je({argsMap:i=>[i.getTrackId()]}),Xn(),H("design:type",Function),H("design:paramtypes",[Number]),H("design:returntype",void 0)],iu.prototype,"setAudioBufferPlaybackSpeed",null);class dr extends Xt{get __className__(){return"MixingAudioTrack"}get isActive(){for(const t of this.trackList)if(t._enabled&&!t._isClosed&&!t.muted)return!0;return!1}constructor(){const t=Xh().createMediaStreamDestination();super(t.stream.getAudioTracks()[0],void 0,pn(8,"track-mix-")),w(this,"trackList",void 0),w(this,"destNode",void 0);try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=t,this.trackList=[]}hasAudioTrack(t){return this.trackList.indexOf(t)!==-1}addAudioTrack(t){this.trackList.indexOf(t)===-1?(L.debug("add ".concat(t.getTrackId()," to mixing track")),t._source.outputNode.connect(this.destNode),this.trackList.push(t),this.updateEncoderConfig()):L.debug("track ".concat(t.getTrackId()," is already added"))}removeAudioTrack(t){if(this.trackList.indexOf(t)!==-1){L.debug("remove ".concat(t.getTrackId()," from mixing track"));try{t._source.outputNode.disconnect(this.destNode)}catch{}vv(this.trackList,t),this.updateEncoderConfig()}}updateEncoderConfig(){const t={};this.trackList.forEach(n=>{n._encoderConfig&&((n._encoderConfig.bitrate||0)>(t.bitrate||0)&&(t.bitrate=n._encoderConfig.bitrate),(n._encoderConfig.sampleRate||0)>(t.sampleRate||0)&&(t.sampleRate=n._encoderConfig.sampleRate),(n._encoderConfig.sampleSize||0)>(t.sampleSize||0)&&(t.sampleSize=n._encoderConfig.sampleSize),n._encoderConfig.stereo&&(t.stereo=!0))}),this._encoderConfig=t}_updateRtpTransceiver(t){this._rtpTransceiver!==t&&(this._rtpTransceiver=t,this.trackList.forEach(n=>{n instanceof dr?n.emit(Yh.TRANSCEIVER_UPDATED,t):n._updateRtpTransceiver(t)}))}}function Jv(i){const t={};i.facingMode&&(t.facingMode=i.facingMode),i.cameraId&&(t.deviceId={exact:i.cameraId});const n=Sc(i.encoderConfig);return n.width!=null&&(t.width=n.width),n.height!=null&&(t.height=n.height),!Mk()&&n.frameRate&&(t.frameRate=n.frameRate),Wt().name===qt.EDGE&&typeof t.frameRate=="object"&&(t.frameRate.max=60),un()&&(t.frameRate={ideal:30,max:30}),t}function pF(i){const t={};if(Mk()||(i.AGC!==void 0&&(t.autoGainControl=i.AGC),i.AEC!==void 0&&(t.echoCancellation=i.AEC),i.ANS!==void 0&&(t.noiseSuppression=i.ANS,n0()&&i.ANS&&(t.googHighpassFilter=i.ANS))),i.encoderConfig){const n=Gv(i.encoderConfig);t.channelCount=n.stereo?2:1,t.sampleRate=n.sampleRate,t.sampleSize=n.sampleSize}return i.microphoneId&&(t.deviceId={exact:i.microphoneId}),mv()&&(t.sampleRate=void 0),t}class vte extends ZM{set currentState(t){t!==this._currentState&&(this._currentState=t,this.safeEmit(fo.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),w(this,"audioBuffer",void 0),w(this,"sourceNode",void 0),w(this,"startPlayTime",0),w(this,"startPlayOffset",0),w(this,"pausePlayTime",0),w(this,"options",void 0),w(this,"currentLoopCount",0),w(this,"currentPlaybackSpeed",100),w(this,"_currentState","stopped"),this.audioBuffer=t,this.options=n,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(t){this.currentState==="stopped"?(this.options=t,this.startPlayOffset=this.options.startPlayTime||0):L.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(t){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=t,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=t))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(t){this.sourceNode&&(this.currentState==="playing"&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=t/100),this.currentPlaybackSpeed=t}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const t=this.context.createBufferSource();return t.buffer=this.audioBuffer,t.loop=!!this.options.loop,t.connect(this.outputNode),t.playbackRate.value=this.currentPlaybackSpeed/100,t}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const fF=new Map;async function Ete(i,t){let n=null;if(typeof i=="string"){const l=fF.get(i);if(l)return L.debug("use cached audio resource: ",i),l;try{n=(await Ds(()=>ho.get(i,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(u){throw new Te(z.FETCH_AUDIO_FILE_FAILED,u.toString())}}else n=await new _e((u,h)=>{const p=new FileReader;p.onload=v=>{v.target?u(v.target.result):h(new Te(z.READ_LOCAL_AUDIO_FILE_ERROR))},p.onerror=()=>{h(new Te(z.READ_LOCAL_AUDIO_FILE_ERROR))},p.readAsArrayBuffer(i)});const a=await function(l){const u=Xh();return new _e((h,p)=>{u.decodeAudioData(l,v=>{h(v)},v=>{p(new Te(z.DECODE_AUDIO_FILE_FAILED,v.toString()))})})}(n);return typeof i=="string"&&t&&fF.set(i,a),a}const nR=i=>{const t=document.createElement("canvas");return t.width=2,t.height=2,new _e((n,a)=>{t.toBlob(async l=>{if(t.remove(),l){const u=await mF(l);n({buffer:u,width:t.width,height:t.height})}else a(new Te(z.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},i,1)})},mF=async i=>{const t=await i.arrayBuffer();return new Uint8Array(t)},tl=new class extends wn{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),w(this,"_lastHiddenTime",0),w(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),L.debug("document visibility went ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};function gF(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function vF(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gF(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):gF(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}class rR{get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(t){t!==this._videoElementStatus&&(L.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(t)),this._videoElementStatus=t)}constructor(t){w(this,"trackId",void 0),w(this,"config",void 0),w(this,"onFirstVideoFrameDecoded",void 0),w(this,"freezeTimeCounterList",[]),w(this,"renderFreezeAccTime",0),w(this,"isKeepLastFrame",!1),w(this,"timeUpdatedCount",0),w(this,"freezeTime",0),w(this,"playbackTime",0),w(this,"lastTimeUpdatedTime",0),w(this,"autoplayFailed",!1),w(this,"videoTrack",void 0),w(this,"videoElement",void 0),w(this,"cacheVideoElement",void 0),w(this,"videoElementCheckInterval",void 0),w(this,"_videoElementStatus",Si.NONE),w(this,"isGettingVideoDimensions",!1),w(this,"startGetVideoDimensions",()=>{const n=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return L.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(n,500)};!this.isGettingVideoDimensions&&n()}),w(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&nn.curState==="running"&&(L.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(Ok())),kk()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),w(this,"handleVideoEvents",n=>{switch(n.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=Si.PLAYING;break;case"loadeddata":if(this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=Si.CANPLAY;break;case"stalled":this.videoElementStatus=Si.STALLED;break;case"suspend":this.videoElementStatus=Si.SUSPEND;break;case"pause":this.videoElementStatus=Si.PAUSED,Pi()||vc()||Ni()&&this.autoplayFailed||!this.videoTrack||this.videoTrack.readyState!=="live"||(L.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=Si.WAITING;break;case"abort":this.videoElementStatus=Si.ABORT;break;case"ended":this.videoElementStatus=Si.ENDED;break;case"emptied":this.videoElementStatus=Si.EMPTIED;break;case"error":{this.videoElementStatus=Si.ERROR;const a=this.videoElement.error;a&&L.error("[".concat(this.trackId,"] media error, code: ").concat(a.code,", message: ").concat(a.message));break}case"timeupdate":{const a=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=a);const l=a-this.lastTimeUpdatedTime,u=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=a,tl.lastVisibleTime<tl.lastHiddenTime||u<tl.lastHiddenTime||u<tl.lastVisibleTime)return;for(l>J("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=l),this.playbackTime+=l;this.playbackTime>=6e3;){this.playbackTime-=6e3;const h=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(h),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),w(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&(L.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(Ok())),kk()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=t.trackId,this.config=t,t.element instanceof HTMLVideoElement?this.videoElement=t.element:this.videoElement=document.createElement("video"),nn.on(Ar.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),nn.on(Ar.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var t;return(t=this.videoElement.parentElement)!==null&&t!==void 0?t:void 0}updateConfig(t){this.config=t,this.trackId=t.trackId,t.element!==this.videoElement&&(this.destroy(),this.videoElement=t.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(t){this.videoTrack!==t&&(this.videoTrack=t,this.initVideoElement())}play(t){const n=this.videoElement.play();n&&n.catch&&n.catch(l=>{t&&cF(t,"video",l.message,this.trackId),l.name==="NotAllowedError"?(L.warning("detected video element autoplay failed",l),this.autoplayFailed=!0,this.handleAutoPlayFailed()):L.warning("[".concat(this.trackId,"] play warning: "),l)});const a=Wt();if((a.name==="Safari"&&Number(a.version)===15||Ph())&&n&&n.then){const l=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};n.then(l).catch(l)}}getCurrentFrame(){const t=document.createElement("canvas");t.width=this.videoElement.videoWidth,t.height=this.videoElement.videoHeight;const n=t.getContext("2d");if(!n)return L.error("create canvas context failed!"),new ImageData(2,2);n.drawImage(this.videoElement,0,0,t.width,t.height);const a=n.getImageData(0,0,t.width,t.height);return t.remove(),a}async getCurrentFrameToUint8Array(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const a=document.createElement("canvas");a.width=this.videoElement.videoWidth,a.height=this.videoElement.videoHeight;const l=a.getContext("2d");return l?(l.drawImage(this.videoElement,0,0,a.width,a.height),new _e((u,h)=>{a.toBlob(async p=>{if(a.remove(),p){const v=await mF(p);u({buffer:v,width:a.width,height:a.height})}else h(new Te(z.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},t,n<0?.1:n>1?1:n)})):await nR(t)}destroy(){nn.off(Ar.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),nn.off(Ar.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[]}initVideoElement(){if(this.videoElementStatus=Si.INIT,!this.videoElementCheckInterval&&(EF.forEach(u=>{this.videoElement.addEventListener(u,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{(function(u){return u!==document.body&&document.body.contains(u)})(this.videoElement)||(this.videoElementStatus=Si.DESTROYED)},1e3),J("ENABLE_VIDEO_FRAME_CALLBACK"))){var t,n;let u;const h=(p,v)=>{if(this.videoElementStatus===Si.PLAYING){if(u){const C=v.presentationTime-u.presentationTime;C>J("VIDEO_FREEZE_DURATION")&&tl.lastVisibleTime>=tl.lastHiddenTime&&u.timestamp>tl.lastVisibleTime&&u.timestamp>tl.lastHiddenTime&&(this.renderFreezeAccTime+=C)}u=vF(vF({},v),{},{timestamp:p})}var E,y;J("ENABLE_VIDEO_FRAME_CALLBACK")&&((E=(y=this.videoElement).requestVideoFrameCallback)===null||E===void 0||E.call(y,h))};(t=(n=this.videoElement).requestVideoFrameCallback)===null||t===void 0||t.call(n,h)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),mv()&&(this.videoElement.poster="noposter");const a=Wt();a.name==="Safari"&&Number(a.version)===15||Ph()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,un()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,un()&&this.videoElement.load());const l=this.videoElement.play();l!==void 0&&l.catch(u=>{L.debug("[".concat(this.trackId,"] playback interrupted"),u.toString())})}resetVideoElement(){EF.forEach(t=>{this.videoElement&&this.videoElement.removeEventListener(t,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=Si.NONE}handleAutoPlayFailed(){const t=n=>{n.preventDefault(),this.videoElement.play().then(()=>{L.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(a=>{L.error(a)}),this.autoplayFailed=!1,r0()?document.body.removeEventListener("click",t,!0):(document.body.removeEventListener("touchstart",t,!0),document.body.removeEventListener("mousedown",t,!0))};r0()?document.body.addEventListener("click",t,!0):(document.body.addEventListener("touchstart",t,!0),document.body.addEventListener("mousedown",t,!0)),oF()}}const EF=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class _F extends rR{constructor(t){super(t),w(this,"container",void 0),w(this,"slot",void 0),this.slot=t.element,this.updateConfig(t)}updateConfig(t){this.config=t,this.trackId=t.trackId;const n=t.element;n!==this.slot&&(this.destroy(),this.slot=n),this.createElements()}updateVideoTrack(t){this.videoTrack!==t&&(this.videoTrack=t,this.createElements())}play(t){var n;(n=this.container)!==null&&n!==void 0&&n.contains(this.videoElement)&&super.play(t)}getCurrentFrame(){var t;return(t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(t){var n;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return(n=this.container)!==null&&n!==void 0&&n.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(t,a):await nR(t)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",J("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var t;!this.container||(t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var t;if((t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var t;(t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}function yF(i){return new _e((t,n)=>{let a=!1;const l=document.createElement("video");l.setAttribute("autoplay",""),l.setAttribute("muted",""),l.muted=!0,l.autoplay=!0,l.setAttribute("playsinline",""),l.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(l);const u=Pi()?"canplay":"playing";l.addEventListener(u,()=>{const h=l.videoWidth,p=l.videoHeight;!h&&un()||(a=!0,l.srcObject=null,l.remove(),t([h,p]))}),l.srcObject=new MediaStream([i]),l.play().catch(yv),setTimeout(()=>{a||(l.srcObject=null,l.remove(),t([l.videoWidth,l.videoHeight]))},4e3)})}const _te=async(i,t,n)=>{const a=function(h){const p=[];for(let v=0;v<h.length;v+=2)p.push(parseInt(h.slice(v,v+2),16));return Uint8Array.from(p)}(function(h){const p="0123456789abcdef";function v(Ae){let Ne,it="";for(Ne=0;Ne<=3;Ne++)it+=p.charAt(Ae>>8*Ne+4&15)+p.charAt(Ae>>8*Ne&15);return it}function E(Ae,Ne){const it=(65535&Ae)+(65535&Ne);return(Ae>>16)+(Ne>>16)+(it>>16)<<16|65535&it}function y(Ae,Ne,it,yt,gn,Er){return E(function(Sn,Lo){return Sn<<Lo|Sn>>>32-Lo}(E(E(Ne,Ae),E(yt,Er)),gn),it)}function C(Ae,Ne,it,yt,gn,Er,Sn){return y(Ne&it|~Ne&yt,Ae,Ne,gn,Er,Sn)}function I(Ae,Ne,it,yt,gn,Er,Sn){return y(Ne&yt|it&~yt,Ae,Ne,gn,Er,Sn)}function k(Ae,Ne,it,yt,gn,Er,Sn){return y(Ne^it^yt,Ae,Ne,gn,Er,Sn)}function G(Ae,Ne,it,yt,gn,Er,Sn){return y(it^(Ne|~yt),Ae,Ne,gn,Er,Sn)}const B=function(Ae){let Ne;const it=1+(Ae.length+8>>6),yt=new Array(16*it);for(Ne=0;Ne<16*it;Ne++)yt[Ne]=0;for(Ne=0;Ne<Ae.length;Ne++)yt[Ne>>2]|=Ae.charCodeAt(Ne)<<Ne%4*8;return yt[Ne>>2]|=128<<Ne%4*8,yt[16*it-2]=8*Ae.length,yt}(h);let j,q,Z,re,Ce,pe=1732584193,fe=-271733879,ye=-1732584194,Ee=271733878;for(j=0;j<B.length;j+=16)q=pe,Z=fe,re=ye,Ce=Ee,pe=C(pe,fe,ye,Ee,B[j+0],7,-680876936),Ee=C(Ee,pe,fe,ye,B[j+1],12,-389564586),ye=C(ye,Ee,pe,fe,B[j+2],17,606105819),fe=C(fe,ye,Ee,pe,B[j+3],22,-1044525330),pe=C(pe,fe,ye,Ee,B[j+4],7,-176418897),Ee=C(Ee,pe,fe,ye,B[j+5],12,1200080426),ye=C(ye,Ee,pe,fe,B[j+6],17,-1473231341),fe=C(fe,ye,Ee,pe,B[j+7],22,-45705983),pe=C(pe,fe,ye,Ee,B[j+8],7,1770035416),Ee=C(Ee,pe,fe,ye,B[j+9],12,-1958414417),ye=C(ye,Ee,pe,fe,B[j+10],17,-42063),fe=C(fe,ye,Ee,pe,B[j+11],22,-1990404162),pe=C(pe,fe,ye,Ee,B[j+12],7,1804603682),Ee=C(Ee,pe,fe,ye,B[j+13],12,-40341101),ye=C(ye,Ee,pe,fe,B[j+14],17,-1502002290),fe=C(fe,ye,Ee,pe,B[j+15],22,1236535329),pe=I(pe,fe,ye,Ee,B[j+1],5,-165796510),Ee=I(Ee,pe,fe,ye,B[j+6],9,-1069501632),ye=I(ye,Ee,pe,fe,B[j+11],14,643717713),fe=I(fe,ye,Ee,pe,B[j+0],20,-373897302),pe=I(pe,fe,ye,Ee,B[j+5],5,-701558691),Ee=I(Ee,pe,fe,ye,B[j+10],9,38016083),ye=I(ye,Ee,pe,fe,B[j+15],14,-660478335),fe=I(fe,ye,Ee,pe,B[j+4],20,-405537848),pe=I(pe,fe,ye,Ee,B[j+9],5,568446438),Ee=I(Ee,pe,fe,ye,B[j+14],9,-1019803690),ye=I(ye,Ee,pe,fe,B[j+3],14,-187363961),fe=I(fe,ye,Ee,pe,B[j+8],20,1163531501),pe=I(pe,fe,ye,Ee,B[j+13],5,-1444681467),Ee=I(Ee,pe,fe,ye,B[j+2],9,-51403784),ye=I(ye,Ee,pe,fe,B[j+7],14,1735328473),fe=I(fe,ye,Ee,pe,B[j+12],20,-1926607734),pe=k(pe,fe,ye,Ee,B[j+5],4,-378558),Ee=k(Ee,pe,fe,ye,B[j+8],11,-2022574463),ye=k(ye,Ee,pe,fe,B[j+11],16,1839030562),fe=k(fe,ye,Ee,pe,B[j+14],23,-35309556),pe=k(pe,fe,ye,Ee,B[j+1],4,-1530992060),Ee=k(Ee,pe,fe,ye,B[j+4],11,1272893353),ye=k(ye,Ee,pe,fe,B[j+7],16,-155497632),fe=k(fe,ye,Ee,pe,B[j+10],23,-1094730640),pe=k(pe,fe,ye,Ee,B[j+13],4,681279174),Ee=k(Ee,pe,fe,ye,B[j+0],11,-358537222),ye=k(ye,Ee,pe,fe,B[j+3],16,-722521979),fe=k(fe,ye,Ee,pe,B[j+6],23,76029189),pe=k(pe,fe,ye,Ee,B[j+9],4,-640364487),Ee=k(Ee,pe,fe,ye,B[j+12],11,-421815835),ye=k(ye,Ee,pe,fe,B[j+15],16,530742520),fe=k(fe,ye,Ee,pe,B[j+2],23,-995338651),pe=G(pe,fe,ye,Ee,B[j+0],6,-198630844),Ee=G(Ee,pe,fe,ye,B[j+7],10,1126891415),ye=G(ye,Ee,pe,fe,B[j+14],15,-1416354905),fe=G(fe,ye,Ee,pe,B[j+5],21,-57434055),pe=G(pe,fe,ye,Ee,B[j+12],6,1700485571),Ee=G(Ee,pe,fe,ye,B[j+3],10,-1894986606),ye=G(ye,Ee,pe,fe,B[j+10],15,-1051523),fe=G(fe,ye,Ee,pe,B[j+1],21,-2054922799),pe=G(pe,fe,ye,Ee,B[j+8],6,1873313359),Ee=G(Ee,pe,fe,ye,B[j+15],10,-30611744),ye=G(ye,Ee,pe,fe,B[j+6],15,-1560198380),fe=G(fe,ye,Ee,pe,B[j+13],21,1309151649),pe=G(pe,fe,ye,Ee,B[j+4],6,-145523070),Ee=G(Ee,pe,fe,ye,B[j+11],10,-1120210379),ye=G(ye,Ee,pe,fe,B[j+2],15,718787259),fe=G(fe,ye,Ee,pe,B[j+9],21,-343485551),pe=E(pe,q),fe=E(fe,Z),ye=E(ye,re),Ee=E(Ee,Ce);return v(pe)+v(fe)+v(ye)+v(Ee)}(""+t+n)).slice(0,16),l=a.slice(0,12),u=await window.crypto.subtle.importKey("raw",a,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:l},u,i))},SF=async(i,t,n)=>await _te(i.buffer,t,n);function CF(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function na(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?CF(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):CF(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}class Rt extends ci{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==Si.PLAYING)}get processorContext(){return this._processorContext}set processorContext(t){this._processorContext=t}get __className__(){return"LocalVideoTrack"}constructor(t,n,a,l,u,h){if(super(t,u),w(this,"trackMediaType","video"),w(this,"_player",void 0),w(this,"isUseScaleResolutionDownBy",!1),w(this,"_videoVisibleTimer",null),w(this,"_statsTimer",null),w(this,"_previousVideoVisibleStatus",void 0),w(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),w(this,"_encoderConfig",void 0),w(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),w(this,"_optimizationMode",void 0),w(this,"_videoHeight",void 0),w(this,"_videoWidth",void 0),w(this,"_forceBitrateLimit",void 0),w(this,"_enabled",!0),w(this,"processorDestination",void 0),w(this,"_processorContext",void 0),Ni()){const{width:p,height:v}=t.getSettings();this._videoWidth=p,this._videoHeight=v}else this.updateMediaStreamTrackResolution();if(this._encoderConfig=n,this._scalabilityMode=a,this._optimizationMode=l,this._hints=h||[],this._hints.indexOf(mn.SCREEN_TRACK)===-1)this.updateBitrateFromProfile();else if(function(p,v,E){const y=Wt();return!(y.name!==p||!y.osVersion)&&(E?Number(y.version)>=v&&Number(y.version)<=E:Number(y.version)===v)}(qt.CHROME,115)&&pv().indexOf("Windows")!==-1){const p=function(v,E){if("VideoFrame"in window&&"TransformStream"in window&&cn().supportWebRTCInsertableStream){const y=new MediaStreamTrackProcessor(v),C=new MediaStreamTrackGenerator({kind:"video"});let I,k,G=Date.now();const B=()=>{j&&(clearInterval(j),j=void 0),I&&(I.close(),I=void 0),v.stop(),k=void 0,C.removeEventListener("ended",B)};let j=window.setInterval(()=>{if(k&&I&&Date.now()-G>(E??1e3))try{C.readyState==="live"?k.enqueue(I.clone()):B()}catch{B()}},E??1e3);const q=new TransformStream({transform:(Z,re)=>{C.readyState==="live"?(k=re,G=Date.now(),I===void 0?(I=Z,re.enqueue(Z.clone())):(re.enqueue(I),I=Z)):Z.close()}});return C.addEventListener("ended",B),y.readable.pipeThrough(q).pipeTo(C.writable),C}}(t);p&&(L.info("local screen video track begin to inject frame"),this._mediaStreamTrack=p)}n&&this._hints.indexOf(mn.CUSTOM_TRACK)!==-1&&this.setEncoderConfiguration(n),this.processorContext=new dF(this.getTrackId(),"local"),this.processorDestination=new uF(this.processorContext),this.bindProcessorDestinationEvents()}play(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof t=="string"){const l=document.getElementById(t);l?t=l:(L.warning("[".concat(this.getTrackId(),'] can not find "#').concat(t,'" element, use document.body')),t=document.body)}L.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(n));const a=na(na(na({},this._getDefaultPlayerConfig()),n),{},{trackId:this.getTrackId(),element:t});this._player?this._player.updateConfig(a):(t instanceof HTMLVideoElement?this._player=new rR(a):this._player=new _F(a),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const l=this.getVideoElementVisibleStatus();this.safeEmit(ru.VIDEO_ELEMENT_VISIBLE_STATUS,l)}catch{}},J("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._statsTimer&&(this.isUseScaleResolutionDownBy=!1,window.clearInterval(this._statsTimer),this._statsTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,L.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(t,n){if(!n){if(t===this._enabled)return;this.stateCheck("enabled",t)}if(L.info("[".concat(this.getTrackId(),"] start setEnabled"),t),!t){this._originMediaStreamTrack.enabled=!1;try{await hn(this,Fe.NEED_DISABLE_TRACK,this)}catch(a){throw L.error("[".concat(this.getTrackId(),"] setEnabled to false error"),a.toString()),a}return n||(this._enabled=!1),void L.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await hn(this,Fe.NEED_ENABLE_TRACK,this)}catch(a){throw L.error("[".concat(this.getTrackId(),"] setEnabled to true error"),a.toString()),a}L.info("[".concat(this.getTrackId(),"] setEnabled to true success")),n||(this._enabled=!0)}async setMuted(t){t!==this._muted&&(this.stateCheck("muted",t),this._muted=t,this._originMediaStreamTrack.enabled=!t,L.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(t)),t?await hn(this,Fe.NEED_MUTE_TRACK,this):await hn(this,Fe.NEED_UNMUTE_TRACK,this))}async setEncoderConfiguration(t,n){if(!this._enabled)throw new Te(z.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(t==="720p_auto"?this.startMonitorStats():this._statsTimer&&(window.clearInterval(this._statsTimer),this._statsTimer=null),t=Sc(t),this._forceBitrateLimit&&(t.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:t.bitrateMax,t.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:t.bitrateMin),t.width||t.height||t.frameRate){const a=Jv({encoderConfig:t});(Ni()||Pi()||vc())&&(a.deviceId=void 0),L.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(t),JSON.stringify(a));try{await this._originMediaStreamTrack.applyConstraints(a),this.updateMediaStreamTrackResolution()}catch(l){const u=new Te(z.UNEXPECTED_ERROR,l.toString());throw L.error("[".concat(this.getTrackId(),"] applyConstraints error"),u.toString()),u}}this._encoderConfig=t,this._hints.indexOf(mn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await hn(this,Fe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(a){return a.throw(L)}}getStats(){return o0(()=>{L.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),No(this,Fe.GET_STATS)||na({},zT)}async setBeautyEffect(t){L.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(t,n):await nR(t)}async setBitrateLimit(t){if(L.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(t))),t){this._forceBitrateLimit=t,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<t.max_bitrate?this._encoderConfig.bitrateMax:t.max_bitrate:this._encoderConfig.bitrateMax=t.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=t.min_bitrate);try{await hn(this,Fe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(n){return n.throw(L)}}}async setOptimizationMode(t){if(t!=="motion"&&t!=="detail"&&t!=="balanced")return void L.error(z.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const n=this._optimizationMode;try{this._optimizationMode=t,await hn(this,Fe.SET_OPTIMIZATION_MODE,this)}catch(a){throw this._optimizationMode=n,L.error("[".concat(this.getTrackId(),"] set optimization mode failed"),a.toString()),a}L.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(t,")"))}setScalabiltyMode(t){if(t.numSpatialLayers===1&&t.numTemporalLayers!==1)return L.error(z.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=t,L.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(t,")"))}updateMediaStreamTrackResolution(){yF(this._originMediaStreamTrack).then(t=>{let[n,a]=t;this._videoHeight=a,this._videoWidth=n}).catch(yv)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(t){if(!this._enabled)throw new Te(z.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");L.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(t)),t=Sc(t),this._forceBitrateLimit&&(t.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:t.bitrateMax,t.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:t.bitrateMin),this._encoderConfig=t,this._hints.indexOf(mn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await hn(this,Fe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(n){return n.throw(L)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:t,height:n,frameRate:a}=this.getMediaStreamTrackSettings();if(!t||!n||!a)return;const[l,u]=function(h,p,v,E){let y;const C=200*Math.pow(v/15,.6)*Math.pow(h*p/640/360,.75),I=C;if(E==="STANDARD_BITRATE")y=4*C;else{if(E!=="COMPATIABLE_BITRATE")return;y=2*C}return[Math.floor(y),Math.floor(I)]}(t,n,a,J("BITRATE_ADAPTER_TYPE"))||[void 0,void 0];this._encoderConfig.bitrateMin||this._encoderConfig.bitrateMax||(this._encoderConfig.bitrateMin=u,this._encoderConfig.bitrateMax=l,L.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(t,", h: ").concat(n,", fps: ").concat(a,"] => [brMax: ").concat(l,", brMin: ").concat(u,"]")))}getVideoElementVisibleStatus(){try{var t,n;const a=this==null||(t=this._player)===null||t===void 0?void 0:t.getContainerElement(),l={track:this,element:this==null||(n=this._player)===null||n===void 0?void 0:n.getVideoElement(),slot:a==null?void 0:a.parentElement},{element:u,slot:h}=l;if(this.isPlaying&&u instanceof HTMLVideoElement&&h instanceof HTMLElement){const p=jk.checkOneElementVisible(u),v=Object.assign({},p);if(v.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=v.visible;const E=We.reportApiInvoke(null,{tag:Pn.TRACER,name:gr.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});v.visible?E.onSuccess("Video is visible"):E.onSuccess("Invisible because of ".concat(v.reason))}return v}return}catch(a){throw new Te(z.GET_VIDEO_ELEMENT_VISIBLE_ERROR,a.message)}}async renewMediaStreamTrack(t){}pipe(t){if(this.processor===t)return t;if(t._source)throw new Te(z.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),t}unpipe(){if(!this.processor)return;const t=this.processor;this.processor._source=void 0,this.processor=void 0,t.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(t){let n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],a=this._encoderConfig;t&&(a=na(na({},a),Sc(t))),a=ld(a);const l=pn(8,"track-video-cloned-"),u=new Rt(n?this._mediaStreamTrack.clone():this._mediaStreamTrack,a,ld(this._scalabilityMode),this._optimizationMode,l,ld(this._hints));return t&&a&&u.setEncoderConfiguration(a),L.debug("clone video track from ".concat(this.getTrackId()," to ").concat(l,", clone ").concat(n)),u}async replaceTrack(t,n){if(!(t instanceof MediaStreamTrack))throw new Te(z.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if(t.kind!=="video")throw new Te(z.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(t,n,!0),this.updateMediaStreamTrackResolution()}startMonitorStats(){if(!Ni()&&!Pi())return;this._statsTimer&&window.clearInterval(this._statsTimer);let t=2,n=Hv[t],a=-1,l=Date.now();const u=h=>{h>2||h<0||(l=Date.now(),n=Hv[h],this.setSenderConfiguration(n))};this.isUseScaleResolutionDownBy=!0,this._statsTimer=window.setInterval(()=>{const h=this.getStats(),p=No(this,Fe.GET_RTC_STATS);if(h.sendPackets>0&&p){a===-1&&(a=Date.now());const v=Date.now();if(v-a<1e3||v-l<J("PROFILE_SWITCH_INTERVAL"))return;const E=h.sendFrameRate,y=.6*n.frameRate,C=.9*n.frameRate;typeof E=="number"&&E>0&&E<y?t>0&&(t--,u(t),L.debug("[".concat(this.getTrackId(),"] step down for fps ").concat(E,", switchProfile to ").concat(t))):p.OutgoingAvailableBandwidth<n.bitrateMin?t>0&&(t--,u(t),L.debug("[".concat(this.getTrackId(),"] step down for OutgoingAvailableBandwidth ").concat(p.OutgoingAvailableBandwidth,", bitrateMin ").concat(n.bitrateMin,", switchProfile to ").concat(t))):typeof E=="number"&&E>C&&t<Hv.length-1&&p.OutgoingAvailableBandwidth>1.2*Hv[t+1].bitrateMin&&(t++,u(t),L.debug("[".concat(this.getTrackId(),"] step up for fps ").concat(E,", OutgoingAvailableBandwidth ").concat(p.OutgoingAvailableBandwidth,", switchProfile to ").concat(t)))}},J("CHECK_LOCAL_STATS_INTERVAL"))}bindProcessorDestinationEvents(){this.processorDestination.on(yi.ON_TRACK,async t=>{t?t!==this._mediaStreamTrack&&(this._mediaStreamTrack=t,this._updatePlayerSource(),await hn(this,Fe.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await hn(this,Fe.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(yi.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(mo.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(mo.REQUEST_CONSTRAINTS)}}Re([Je({argsMap:(i,t,n)=>[i.getTrackId(),typeof t=="string"?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",n]}),Xn(),H("design:type",Function),H("design:paramtypes",[Object,Object]),H("design:returntype",void 0)],Rt.prototype,"play",null),Re([Je({argsMap:i=>[i.getTrackId()]}),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],Rt.prototype,"stop",null),Re([Fh("LocalVideoTrack","_enabledMutex"),Je({argsMap:(i,t)=>[i.getTrackId(),t]}),Xn(),H("design:type",Function),H("design:paramtypes",[Boolean,Boolean]),H("design:returntype",_e)],Rt.prototype,"setEnabled",null),Re([Fh("LocalVideoTrack","_enabledMutex"),Je({argsMap:(i,t)=>[i.getTrackId(),t]}),Xn(),H("design:type",Function),H("design:paramtypes",[Boolean]),H("design:returntype",_e)],Rt.prototype,"setMuted",null),Re([Je({argsMap:(i,t)=>[i.getTrackId(),t]}),Xn(),H("design:type",Function),H("design:paramtypes",[Object,Boolean]),H("design:returntype",_e)],Rt.prototype,"setEncoderConfiguration",null),Re([Xn(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",Object)],Rt.prototype,"getStats",null),Re([Je({argsMap:(i,t,n)=>[i.getTrackId(),t,n]}),Xn(),H("design:type",Function),H("design:paramtypes",[Boolean,Object]),H("design:returntype",_e)],Rt.prototype,"setBeautyEffect",null),Re([Xn(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",ImageData)],Rt.prototype,"getCurrentFrameData",null),Re([Xn(),H("design:type",Function),H("design:paramtypes",[String,Number]),H("design:returntype",_e)],Rt.prototype,"getCurrentFrameImage",null),Re([Xn(),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",_e)],Rt.prototype,"setBitrateLimit",null),Re([Xn(),H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],Rt.prototype,"setOptimizationMode",null),Re([Xn(),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",void 0)],Rt.prototype,"setScalabiltyMode",null),Re([Xn(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],Rt.prototype,"updateMediaStreamTrackResolution",null),Re([Je({argsMap:(i,t)=>[i.getTrackId(),t.name]}),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",Object)],Rt.prototype,"pipe",null),Re([Je({argsMap:i=>[i.getTrackId()]}),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],Rt.prototype,"unpipe",null),Re([Je({argsMap:i=>[i.getTrackId()]}),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],Rt.prototype,"close",null),Re([Je({argsMap:(i,t,n)=>[i.getTrackId(),t.label,n]}),H("design:type",Function),H("design:paramtypes",[MediaStreamTrack,Boolean]),H("design:returntype",_e)],Rt.prototype,"replaceTrack",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],Rt.prototype,"startMonitorStats",null);class ou extends Rt{get __className__(){return"CameraVideoTrack"}constructor(t,n,a,l,u,h){super(t,Sc(n.encoderConfig),l,u,h),w(this,"_config",void 0),w(this,"_originalConstraints",void 0),w(this,"_constraints",void 0),w(this,"_enabled",!0),w(this,"_deviceName","default"),w(this,"tryResumeVideoForIOS15_16WeChat",async()=>{(Ph()||Hb())&&!function(){const p=Wt();if(p.os!==yr.IOS||!p.osVersion)return!1;const v=p.osVersion.split(".");return Number(v[0])===15&&Number(v[1])>=2}()&&Lk()&&this._enabled&&!this._isClosed&&(L.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=n,this._originalConstraints=a,this._constraints=a,this._deviceName=t.label,this._encoderConfig=Sc(this._config.encoderConfig),nn.on(Ar.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),nn.on(Ar.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(t){return typeof t=="string"?this._setDeviceById(t):t.deviceId?this._setDeviceById(t.deviceId):t.facingMode?this._setDeviceByFacingModel(t.facingMode):void 0}async _setDeviceById(t){if(L.info("[".concat(this.getTrackId(),"] set device to ").concat(t)),this._enabled)try{const n=await ea.getDeviceById(t),a={};a.video=na({},this._constraints),a.video.deviceId={exact:t},a.video.facingMode=void 0,this._originMediaStreamTrack.stop();let l=null;try{l=await Zo(a,this.getTrackId())}catch(u){throw L.error("[".concat(this.getTrackId(),"] setDevice failed"),u.toString()),l=await Zo({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!1),u}await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=n.label,this._config.cameraId=t,this._constraints.deviceId={exact:t}}catch(n){throw L.error("[".concat(this.getTrackId(),"] setDevice error"),n.toString()),n}else try{const n=await ea.getDeviceById(t);this._deviceName=n.label,this._config.cameraId=t,this._constraints.deviceId={exact:t}}catch(n){throw L.error("[".concat(this.getTrackId(),"] setDevice error"),n.toString()),n}L.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(t){L.info("[".concat(this.getTrackId(),"] set facingMode ").concat(t));const n={video:na(na({},this._constraints),{},{deviceId:void 0,facingMode:{exact:t}})};if(this._enabled){this._originMediaStreamTrack.stop();let a=null;try{a=await Zo(n,this.getTrackId())}catch(l){throw L.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),l.toString()),a=await Zo({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1),l}await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=t,this._config.cameraId=void 0,this._constraints=na({},n.video),L.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(t,n){if(!n){if(t===this._enabled)return;this.stateCheck("enabled",t)}if(L.info("[".concat(this.getTrackId(),"] start setEnabled"),t),t){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const a=await Zo({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1)}await hn(this,Fe.NEED_ENABLE_TRACK,this)}catch(a){throw L.error("[".concat(this.getTrackId(),"] setEnabled true error"),a.toString()),a}this.updateMediaStreamTrackResolution(),L.info("[".concat(this.getTrackId(),"] setEnabled to true success")),n||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),n||(this._enabled=!1);try{await hn(this,Fe.NEED_DISABLE_TRACK,this)}catch(a){throw L.error("[".concat(this.getTrackId(),"] setEnabled to false error"),a.toString()),a}L.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(t,n){if(!this._enabled)throw new Te(z.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");t==="720p_auto"?this.startMonitorStats():this._statsTimer&&(window.clearInterval(this._statsTimer),this._statsTimer=null),t=Sc(t),this._forceBitrateLimit&&(t.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:t.bitrateMax,t.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:t.bitrateMin);const a=fn(this._config);a.encoderConfig=t;const l=Jv(a);(Ni()||Pi()||vc())&&(l.deviceId=void 0),L.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(t),JSON.stringify(l));try{await this._originMediaStreamTrack.applyConstraints(l),this.updateMediaStreamTrackResolution()}catch(u){const h=new Te(z.UNEXPECTED_ERROR,u.toString());throw L.error("[".concat(this.getTrackId(),"] applyConstraints error"),h.toString()),h}this._config=a,this._constraints=l,this._originalConstraints=l,this._encoderConfig=t,this._hints.indexOf(mn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await hn(this,Fe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(u){return u.throw(L)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((Pi()||vc())&&this._enabled&&!this._isClosed&&nn.duringInterruption){const t=async()=>{nn.off(Ar.IOS_INTERRUPTION_END,t),this._enabled&&!this._isClosed&&(L.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};nn.on(Ar.IOS_INTERRUPTION_END,t)}else L.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(ru.TRACK_ENDED)}async renewMediaStreamTrack(t){const n=t||this._constraints,a=ea.searchDeviceIdByName(this._deviceName);if(a&&!n.deviceId&&(n.deviceId={exact:a}),this._enabled){const l=await Zo({video:n},this.getTrackId());this._constraints=n,await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),nn.off(Ar.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),nn.off(Ar.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(t){let n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],a=this._encoderConfig;t&&(a=na(na({},a),Sc(t))),a=ld(a);const l=pn(8,"track-cam-cloned-"),u=new ou(n?this._mediaStreamTrack.clone():this._mediaStreamTrack,ld(na(na({},this._config),{},{encoderConfig:a})),ld(this._constraints),ld(this._scalabilityMode),this._optimizationMode,l);return t&&a&&u.setEncoderConfiguration(a),L.debug("clone track from ".concat(this.getTrackId()," to ").concat(l,", clone ").concat(n)),u}bindProcessorContextEvents(){this.processorContext.on(mo.REQUEST_UPDATE_CONSTRAINTS,async(t,n,a)=>{try{const l=Object.assign({},this._originalConstraints,...t);await this.renewMediaStreamTrack(l),n()}catch(l){a(l)}}),this.processorContext.on(mo.REQUEST_CONSTRAINTS,async t=>{t(this._originMediaStreamTrack.getSettings())})}}function bF(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function Qv(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?bF(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):bF(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}function iR(i,t,n,a){n.optimizationMode&&(a&&a.width&&a.height?(n.encoderConfig=Qv(Qv({},a),{},{bitrateMin:a.bitrateMin,bitrateMax:a.bitrateMax}),n.optimizationMode!=="motion"&&n.optimizationMode!=="detail"||(t.contentHint=n.optimizationMode,t.contentHint===n.optimizationMode?L.debug("[".concat(i,"] set content hint to"),n.optimizationMode):L.debug("[".concat(i,"] set content hint failed")))):L.warning("[".concat(i,"] can not apply optimization mode bitrate config, no encoderConfig")))}function TF(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function Zv(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?TF(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):TF(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}Re([Je({argsMap:(i,t)=>[i.getTrackId(),t]}),Xn(),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",_e)],ou.prototype,"setDevice",null),Re([Fh("CameraVideoTrack","_enabledMutex"),Je({argsMap:(i,t)=>[i.getTrackId(),t]}),Xn(),H("design:type",Function),H("design:paramtypes",[Boolean,Boolean]),H("design:returntype",_e)],ou.prototype,"setEnabled",null),Re([Je({argsMap:(i,t)=>[i.getTrackId(),t]}),Xn(),H("design:type",Function),H("design:paramtypes",[Object,Boolean]),H("design:returntype",_e)],ou.prototype,"setEncoderConfiguration",null),Re([Je({argsMap:i=>[i.getTrackId()]}),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],ou.prototype,"close",null);class RF extends YM{getUserId(){return this._userId}constructor(t,n,a,l){super(t,"track-".concat(t.kind,"-").concat(n,"-").concat(l.clientId,"_").concat(pn(5,""))),w(this,"_userId",void 0),w(this,"_uintId",void 0),w(this,"_isDestroyed",!1),w(this,"store",void 0),w(this,"processor",void 0),this._userId=n,this._uintId=a,this.store=l}_updateOriginMediaStreamTrack(t){this._originMediaStreamTrack=t,this._mediaStreamTrack=t,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,L.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}class Cc extends RF{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==Si.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(t,n,a,l){super(t,n,a,l),w(this,"_videoVisibleTimer",null),w(this,"_previousVideoVisibleStatus",void 0),w(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),w(this,"trackMediaType","video"),w(this,"_videoWidth",void 0),w(this,"_videoHeight",void 0),w(this,"_player",void 0),w(this,"processorDestination",void 0),w(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new dF(this.getTrackId(),"remote"),this.processorDestination=new uF(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return o0(()=>{L.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),No(this,Fe.GET_STATS)||Zv({},KM)}play(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof t=="string"){const l=document.getElementById(t);l?t=l:(L.warning("[".concat(this.getTrackId(),'] can not find "#').concat(t,'" element, use document.body')),t=document.body)}L.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(n));const a=Zv(Zv({fit:"cover"},n),{},{trackId:this.getTrackId(),element:t});this._player?this._player.updateConfig(a):(t instanceof HTMLVideoElement?this._player=new rR(a):this._player=new _F(a),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(gd.FIRST_FRAME_DECODED)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const l=this.getVideoElementVisibleStatus();this.safeEmit(gd.VIDEO_ELEMENT_VISIBLE_STATUS,l)}catch{}},J("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,L.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){yF(this._originMediaStreamTrack).then(t=>{let[n,a]=t;this._videoHeight=a,this._videoWidth=n}).catch(yv)}_updatePlayerSource(){L.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var t,n;const a=this==null||(t=this._player)===null||t===void 0?void 0:t.getContainerElement(),l={track:this,element:this==null||(n=this._player)===null||n===void 0?void 0:n.getVideoElement(),slot:a==null?void 0:a.parentElement},{element:u,slot:h}=l;if(this.isPlaying&&u instanceof HTMLVideoElement&&h instanceof HTMLElement){const p=jk.checkOneElementVisible(u),v=Object.assign({},p);if(v.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=v.visible;const E=We.reportApiInvoke(null,{tag:Pn.TRACER,name:gr.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});v.visible?E.onSuccess("Video is visible"):E.onSuccess("Invisible because of ".concat(v.reason))}return v}return}catch(a){throw new Te(z.GET_VIDEO_ELEMENT_VISIBLE_ERROR,a.message)}}pipe(t){if(this.processor===t)return t;if(t._source)throw new Te(z.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),t}unpipe(){if(!this.processor)return;const t=this.processor;this.processor._source=void 0,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(yi.ON_TRACK,async t=>{t?t!==this._mediaStreamTrack&&(this._mediaStreamTrack=t,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(yi.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}}Re([Je({argsMap:(i,t,n)=>[i.getTrackId(),typeof t=="string"?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",n]}),H("design:type",Function),H("design:paramtypes",[Object,Object]),H("design:returntype",void 0)],Cc.prototype,"play",null),Re([Je({argsMap:i=>[i.getTrackId()]}),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],Cc.prototype,"stop",null),Re([Je({argsMap:(i,t)=>[i.getTrackId(),t.name]}),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",Object)],Cc.prototype,"pipe",null),Re([Je({argsMap:i=>[i.getTrackId()]}),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],Cc.prototype,"unpipe",null);class is extends RF{get isPlaying(){return this._useAudioElement?go.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(t,n,a,l){super(t,n,a,l),w(this,"trackMediaType","audio"),w(this,"_source",void 0),w(this,"_useAudioElement",!0),w(this,"_volume",100),w(this,"processorContext",void 0),w(this,"processorDestination",void 0),w(this,"_played",!1),w(this,"_bypassWebAudio",!1),J("DISABLE_WEBAUDIO")?(this._source=new ZT,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new XT(t,!0),J("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(fo.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(gd.FIRST_FRAME_DECODED)}),this.processorContext=new Xv(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new qv(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(fo.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!t)return this._source.removeAllListeners(fo.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(n),this._source.removeAllListeners(fo.ON_AUDIO_BUFFER),this._source.on(fo.ON_AUDIO_BUFFER,a=>t(a))}setVolume(t){this._volume=t,this._useAudioElement?go.setVolume(this.getTrackId(),t):this._source.setVolume(t/100)}async setPlaybackDevice(t){if(!this._useAudioElement||!n0()&&J("RESTRICTION_SET_PLAYBACK_DEVICE"))throw new Te(z.NOT_SUPPORTED,"your browser does not support setting the audio output device");await go.setSinkID(this.getTrackId(),t)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return o0(()=>{L.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),No(this,Fe.GET_STATS)||Zv({},zM)}play(){L.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(L.debug("[".concat(this.getTrackId(),"] use audio element to play")),go.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){L.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?go.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let t=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];L.debug("[".concat(this.getTrackId(),"] update player source track")),t&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&go.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(t){if(this._bypassWebAudio)throw new Te(z.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===t)return t;if(t._source)throw new Te(z.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),t}unpipe(){var t;if(this._bypassWebAudio)throw new Te(z.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const n=this.processor;(t=this._source.processSourceNode)===null||t===void 0||t.disconnect(),this.processor._source=!1,this.processor=void 0,n.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(yi.ON_TRACK,async t=>{t?t!==this._mediaStreamTrack&&(this._mediaStreamTrack=t,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(t)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(yi.ON_NODE,t=>{this._source.processedNode=t;const n=!t;this._useAudioElement!==n&&(this._played?(this.stop(),this._useAudioElement=n,this.play()):this._useAudioElement=n)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(yi.ON_TRACK),this.processorDestination.removeAllListeners(yi.ON_NODE)}}Re([Je({argsMap:(i,t)=>[i.getTrackId(),t],throttleTime:300}),H("design:type",Function),H("design:paramtypes",[Number]),H("design:returntype",void 0)],is.prototype,"setVolume",null),Re([Je({argsMap:(i,t)=>[i.getTrackId(),t]}),H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],is.prototype,"setPlaybackDevice",null),Re([Je({argsMap:i=>[i.getTrackId()]}),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],is.prototype,"play",null),Re([Je({argsMap:i=>[i.getTrackId()]}),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],is.prototype,"stop",null),Re([Je({argsMap:(i,t)=>[i.getTrackId(),t.name]}),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",Object)],is.prototype,"pipe",null),Re([Je({argsMap:i=>[i.getTrackId()]}),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],is.prototype,"unpipe",null);function Zh(i){let t=i.length;for(;--t>=0;)i[t]=0}const oR=256,wF=286,p0=30,f0=15,aR=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),eE=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),yte=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),IF=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),nl=new Array(576);Zh(nl);const m0=new Array(60);Zh(m0);const g0=new Array(512);Zh(g0);const v0=new Array(256);Zh(v0);const sR=new Array(29);Zh(sR);const tE=new Array(p0);function cR(i,t,n,a,l){this.static_tree=i,this.extra_bits=t,this.extra_base=n,this.elems=a,this.max_length=l,this.has_stree=i&&i.length}let AF,OF,xF;function lR(i,t){this.dyn_tree=i,this.max_code=0,this.stat_desc=t}Zh(tE);const NF=i=>i<256?g0[i]:g0[256+(i>>>7)],E0=(i,t)=>{i.pending_buf[i.pending++]=255&t,i.pending_buf[i.pending++]=t>>>8&255},ra=(i,t,n)=>{i.bi_valid>16-n?(i.bi_buf|=t<<i.bi_valid&65535,E0(i,i.bi_buf),i.bi_buf=t>>16-i.bi_valid,i.bi_valid+=n-16):(i.bi_buf|=t<<i.bi_valid&65535,i.bi_valid+=n)},bc=(i,t,n)=>{ra(i,n[2*t],n[2*t+1])},PF=(i,t)=>{let n=0;do n|=1&i,i>>>=1,n<<=1;while(--t>0);return n>>>1},DF=(i,t,n)=>{const a=new Array(16);let l,u,h=0;for(l=1;l<=f0;l++)h=h+n[l-1]<<1,a[l]=h;for(u=0;u<=t;u++){let p=i[2*u+1];p!==0&&(i[2*u]=PF(a[p]++,p))}},kF=i=>{let t;for(t=0;t<wF;t++)i.dyn_ltree[2*t]=0;for(t=0;t<p0;t++)i.dyn_dtree[2*t]=0;for(t=0;t<19;t++)i.bl_tree[2*t]=0;i.dyn_ltree[512]=1,i.opt_len=i.static_len=0,i.sym_next=i.matches=0},LF=i=>{i.bi_valid>8?E0(i,i.bi_buf):i.bi_valid>0&&(i.pending_buf[i.pending++]=i.bi_buf),i.bi_buf=0,i.bi_valid=0},MF=(i,t,n,a)=>{const l=2*t,u=2*n;return i[l]<i[u]||i[l]===i[u]&&a[t]<=a[n]},uR=(i,t,n)=>{const a=i.heap[n];let l=n<<1;for(;l<=i.heap_len&&(l<i.heap_len&&MF(t,i.heap[l+1],i.heap[l],i.depth)&&l++,!MF(t,a,i.heap[l],i.depth));)i.heap[n]=i.heap[l],n=l,l<<=1;i.heap[n]=a},FF=(i,t,n)=>{let a,l,u,h,p=0;if(i.sym_next!==0)do a=255&i.pending_buf[i.sym_buf+p++],a+=(255&i.pending_buf[i.sym_buf+p++])<<8,l=i.pending_buf[i.sym_buf+p++],a===0?bc(i,l,t):(u=v0[l],bc(i,u+oR+1,t),h=aR[u],h!==0&&(l-=sR[u],ra(i,l,h)),a--,u=NF(a),bc(i,u,n),h=eE[u],h!==0&&(a-=tE[u],ra(i,a,h)));while(p<i.sym_next);bc(i,256,t)},dR=(i,t)=>{const n=t.dyn_tree,a=t.stat_desc.static_tree,l=t.stat_desc.has_stree,u=t.stat_desc.elems;let h,p,v,E=-1;for(i.heap_len=0,i.heap_max=573,h=0;h<u;h++)n[2*h]!==0?(i.heap[++i.heap_len]=E=h,i.depth[h]=0):n[2*h+1]=0;for(;i.heap_len<2;)v=i.heap[++i.heap_len]=E<2?++E:0,n[2*v]=1,i.depth[v]=0,i.opt_len--,l&&(i.static_len-=a[2*v+1]);for(t.max_code=E,h=i.heap_len>>1;h>=1;h--)uR(i,n,h);v=u;do h=i.heap[1],i.heap[1]=i.heap[i.heap_len--],uR(i,n,1),p=i.heap[1],i.heap[--i.heap_max]=h,i.heap[--i.heap_max]=p,n[2*v]=n[2*h]+n[2*p],i.depth[v]=(i.depth[h]>=i.depth[p]?i.depth[h]:i.depth[p])+1,n[2*h+1]=n[2*p+1]=v,i.heap[1]=v++,uR(i,n,1);while(i.heap_len>=2);i.heap[--i.heap_max]=i.heap[1],((y,C)=>{const I=C.dyn_tree,k=C.max_code,G=C.stat_desc.static_tree,B=C.stat_desc.has_stree,j=C.stat_desc.extra_bits,q=C.stat_desc.extra_base,Z=C.stat_desc.max_length;let re,Ce,pe,fe,ye,Ee,Ae=0;for(fe=0;fe<=f0;fe++)y.bl_count[fe]=0;for(I[2*y.heap[y.heap_max]+1]=0,re=y.heap_max+1;re<573;re++)Ce=y.heap[re],fe=I[2*I[2*Ce+1]+1]+1,fe>Z&&(fe=Z,Ae++),I[2*Ce+1]=fe,Ce>k||(y.bl_count[fe]++,ye=0,Ce>=q&&(ye=j[Ce-q]),Ee=I[2*Ce],y.opt_len+=Ee*(fe+ye),B&&(y.static_len+=Ee*(G[2*Ce+1]+ye)));if(Ae!==0){do{for(fe=Z-1;y.bl_count[fe]===0;)fe--;y.bl_count[fe]--,y.bl_count[fe+1]+=2,y.bl_count[Z]--,Ae-=2}while(Ae>0);for(fe=Z;fe!==0;fe--)for(Ce=y.bl_count[fe];Ce!==0;)pe=y.heap[--re],pe>k||(I[2*pe+1]!==fe&&(y.opt_len+=(fe-I[2*pe+1])*I[2*pe],I[2*pe+1]=fe),Ce--)}})(i,t),DF(n,E,i.bl_count)},UF=(i,t,n)=>{let a,l,u=-1,h=t[1],p=0,v=7,E=4;for(h===0&&(v=138,E=3),t[2*(n+1)+1]=65535,a=0;a<=n;a++)l=h,h=t[2*(a+1)+1],++p<v&&l===h||(p<E?i.bl_tree[2*l]+=p:l!==0?(l!==u&&i.bl_tree[2*l]++,i.bl_tree[32]++):p<=10?i.bl_tree[34]++:i.bl_tree[36]++,p=0,u=l,h===0?(v=138,E=3):l===h?(v=6,E=3):(v=7,E=4))},BF=(i,t,n)=>{let a,l,u=-1,h=t[1],p=0,v=7,E=4;for(h===0&&(v=138,E=3),a=0;a<=n;a++)if(l=h,h=t[2*(a+1)+1],!(++p<v&&l===h)){if(p<E)do bc(i,l,i.bl_tree);while(--p!=0);else l!==0?(l!==u&&(bc(i,l,i.bl_tree),p--),bc(i,16,i.bl_tree),ra(i,p-3,2)):p<=10?(bc(i,17,i.bl_tree),ra(i,p-3,3)):(bc(i,18,i.bl_tree),ra(i,p-11,7));p=0,u=l,h===0?(v=138,E=3):l===h?(v=6,E=3):(v=7,E=4)}};let jF=!1;const VF=(i,t,n,a)=>{ra(i,0+(a?1:0),3),LF(i),E0(i,n),E0(i,~n),n&&i.pending_buf.set(i.window.subarray(t,t+n),i.pending),i.pending+=n};var Ste=i=>{jF||((()=>{let t,n,a,l,u;const h=new Array(16);for(a=0,l=0;l<28;l++)for(sR[l]=a,t=0;t<1<<aR[l];t++)v0[a++]=l;for(v0[a-1]=l,u=0,l=0;l<16;l++)for(tE[l]=u,t=0;t<1<<eE[l];t++)g0[u++]=l;for(u>>=7;l<p0;l++)for(tE[l]=u<<7,t=0;t<1<<eE[l]-7;t++)g0[256+u++]=l;for(n=0;n<=f0;n++)h[n]=0;for(t=0;t<=143;)nl[2*t+1]=8,t++,h[8]++;for(;t<=255;)nl[2*t+1]=9,t++,h[9]++;for(;t<=279;)nl[2*t+1]=7,t++,h[7]++;for(;t<=287;)nl[2*t+1]=8,t++,h[8]++;for(DF(nl,287,h),t=0;t<p0;t++)m0[2*t+1]=5,m0[2*t]=PF(t,5);AF=new cR(nl,aR,257,wF,f0),OF=new cR(m0,eE,0,p0,f0),xF=new cR(new Array(0),yte,0,19,7)})(),jF=!0),i.l_desc=new lR(i.dyn_ltree,AF),i.d_desc=new lR(i.dyn_dtree,OF),i.bl_desc=new lR(i.bl_tree,xF),i.bi_buf=0,i.bi_valid=0,kF(i)},Cte=(i,t,n,a)=>{let l,u,h=0;i.level>0?(i.strm.data_type===2&&(i.strm.data_type=(p=>{let v,E=4093624447;for(v=0;v<=31;v++,E>>>=1)if(1&E&&p.dyn_ltree[2*v]!==0)return 0;if(p.dyn_ltree[18]!==0||p.dyn_ltree[20]!==0||p.dyn_ltree[26]!==0)return 1;for(v=32;v<oR;v++)if(p.dyn_ltree[2*v]!==0)return 1;return 0})(i)),dR(i,i.l_desc),dR(i,i.d_desc),h=(p=>{let v;for(UF(p,p.dyn_ltree,p.l_desc.max_code),UF(p,p.dyn_dtree,p.d_desc.max_code),dR(p,p.bl_desc),v=18;v>=3&&p.bl_tree[2*IF[v]+1]===0;v--);return p.opt_len+=3*(v+1)+5+5+4,v})(i),l=i.opt_len+3+7>>>3,u=i.static_len+3+7>>>3,u<=l&&(l=u)):l=u=n+5,n+4<=l&&t!==-1?VF(i,t,n,a):i.strategy===4||u===l?(ra(i,2+(a?1:0),3),FF(i,nl,m0)):(ra(i,4+(a?1:0),3),((p,v,E,y)=>{let C;for(ra(p,v-257,5),ra(p,E-1,5),ra(p,y-4,4),C=0;C<y;C++)ra(p,p.bl_tree[2*IF[C]+1],3);BF(p,p.dyn_ltree,v-1),BF(p,p.dyn_dtree,E-1)})(i,i.l_desc.max_code+1,i.d_desc.max_code+1,h+1),FF(i,i.dyn_ltree,i.dyn_dtree)),kF(i),a&&LF(i)},bte=(i,t,n)=>(i.pending_buf[i.sym_buf+i.sym_next++]=t,i.pending_buf[i.sym_buf+i.sym_next++]=t>>8,i.pending_buf[i.sym_buf+i.sym_next++]=n,t===0?i.dyn_ltree[2*n]++:(i.matches++,t--,i.dyn_ltree[2*(v0[n]+oR+1)]++,i.dyn_dtree[2*NF(t)]++),i.sym_next===i.sym_end),Tte={_tr_init:Ste,_tr_stored_block:VF,_tr_flush_block:Cte,_tr_tally:bte,_tr_align:i=>{ra(i,2,3),bc(i,256,nl),(t=>{t.bi_valid===16?(E0(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(i)}},_0=(i,t,n,a)=>{let l=65535&i|0,u=i>>>16&65535|0,h=0;for(;n!==0;){h=n>2e3?2e3:n,n-=h;do l=l+t[a++]|0,u=u+l|0;while(--h);l%=65521,u%=65521}return l|u<<16|0};const Rte=new Uint32Array((()=>{let i,t=[];for(var n=0;n<256;n++){i=n;for(var a=0;a<8;a++)i=1&i?3988292384^i>>>1:i>>>1;t[n]=i}return t})());var Gi=(i,t,n,a)=>{const l=Rte,u=a+n;i^=-1;for(let h=a;h<u;h++)i=i>>>8^l[255&(i^t[h])];return-1^i},yd={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ep={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:wte,_tr_stored_block:hR,_tr_flush_block:Ite,_tr_tally:au,_tr_align:Ate}=Tte,{Z_NO_FLUSH:su,Z_PARTIAL_FLUSH:Ote,Z_FULL_FLUSH:xte,Z_FINISH:os,Z_BLOCK:$F,Z_OK:Zi,Z_STREAM_END:HF,Z_STREAM_ERROR:Tc,Z_DATA_ERROR:Nte,Z_BUF_ERROR:pR,Z_DEFAULT_COMPRESSION:Pte,Z_FILTERED:Dte,Z_HUFFMAN_ONLY:nE,Z_RLE:kte,Z_FIXED:Lte,Z_DEFAULT_STRATEGY:Mte,Z_UNKNOWN:Fte,Z_DEFLATED:rE}=ep,fR=286,Ute=30,Bte=19,jte=2*fR+1,Vte=15,Sd=258,Rc=262,tp=42,Cd=113,y0=666,bd=(i,t)=>(i.msg=yd[t],t),WF=i=>2*i-(i>4?9:0),cu=i=>{let t=i.length;for(;--t>=0;)i[t]=0},$te=i=>{let t,n,a,l=i.w_size;t=i.hash_size,a=t;do n=i.head[--a],i.head[a]=n>=l?n-l:0;while(--t);t=l,a=t;do n=i.prev[--a],i.prev[a]=n>=l?n-l:0;while(--t)};let lu=(i,t,n)=>(t<<i.hash_shift^n)&i.hash_mask;const Aa=i=>{const t=i.state;let n=t.pending;n>i.avail_out&&(n=i.avail_out),n!==0&&(i.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),i.next_out),i.next_out+=n,t.pending_out+=n,i.total_out+=n,i.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))},Oa=(i,t)=>{Ite(i,i.block_start>=0?i.block_start:-1,i.strstart-i.block_start,t),i.block_start=i.strstart,Aa(i.strm)},Vn=(i,t)=>{i.pending_buf[i.pending++]=t},S0=(i,t)=>{i.pending_buf[i.pending++]=t>>>8&255,i.pending_buf[i.pending++]=255&t},mR=(i,t,n,a)=>{let l=i.avail_in;return l>a&&(l=a),l===0?0:(i.avail_in-=l,t.set(i.input.subarray(i.next_in,i.next_in+l),n),i.state.wrap===1?i.adler=_0(i.adler,t,l,n):i.state.wrap===2&&(i.adler=Gi(i.adler,t,l,n)),i.next_in+=l,i.total_in+=l,l)},GF=(i,t)=>{let n,a,l=i.max_chain_length,u=i.strstart,h=i.prev_length,p=i.nice_match;const v=i.strstart>i.w_size-Rc?i.strstart-(i.w_size-Rc):0,E=i.window,y=i.w_mask,C=i.prev,I=i.strstart+Sd;let k=E[u+h-1],G=E[u+h];i.prev_length>=i.good_match&&(l>>=2),p>i.lookahead&&(p=i.lookahead);do if(n=t,E[n+h]===G&&E[n+h-1]===k&&E[n]===E[u]&&E[++n]===E[u+1]){u+=2,n++;do;while(E[++u]===E[++n]&&E[++u]===E[++n]&&E[++u]===E[++n]&&E[++u]===E[++n]&&E[++u]===E[++n]&&E[++u]===E[++n]&&E[++u]===E[++n]&&E[++u]===E[++n]&&u<I);if(a=Sd-(I-u),u=I-Sd,a>h){if(i.match_start=t,h=a,a>=p)break;k=E[u+h-1],G=E[u+h]}}while((t=C[t&y])>v&&--l!=0);return h<=i.lookahead?h:i.lookahead},np=i=>{const t=i.w_size;let n,a,l;do{if(a=i.window_size-i.lookahead-i.strstart,i.strstart>=t+(t-Rc)&&(i.window.set(i.window.subarray(t,t+t-a),0),i.match_start-=t,i.strstart-=t,i.block_start-=t,i.insert>i.strstart&&(i.insert=i.strstart),$te(i),a+=t),i.strm.avail_in===0)break;if(n=mR(i.strm,i.window,i.strstart+i.lookahead,a),i.lookahead+=n,i.lookahead+i.insert>=3)for(l=i.strstart-i.insert,i.ins_h=i.window[l],i.ins_h=lu(i,i.ins_h,i.window[l+1]);i.insert&&(i.ins_h=lu(i,i.ins_h,i.window[l+3-1]),i.prev[l&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=l,l++,i.insert--,!(i.lookahead+i.insert<3)););}while(i.lookahead<Rc&&i.strm.avail_in!==0)},zF=(i,t)=>{let n,a,l,u=i.pending_buf_size-5>i.w_size?i.w_size:i.pending_buf_size-5,h=0,p=i.strm.avail_in;do{if(n=65535,l=i.bi_valid+42>>3,i.strm.avail_out<l||(l=i.strm.avail_out-l,a=i.strstart-i.block_start,n>a+i.strm.avail_in&&(n=a+i.strm.avail_in),n>l&&(n=l),n<u&&(n===0&&t!==os||t===su||n!==a+i.strm.avail_in)))break;h=t===os&&n===a+i.strm.avail_in?1:0,hR(i,0,0,h),i.pending_buf[i.pending-4]=n,i.pending_buf[i.pending-3]=n>>8,i.pending_buf[i.pending-2]=~n,i.pending_buf[i.pending-1]=~n>>8,Aa(i.strm),a&&(a>n&&(a=n),i.strm.output.set(i.window.subarray(i.block_start,i.block_start+a),i.strm.next_out),i.strm.next_out+=a,i.strm.avail_out-=a,i.strm.total_out+=a,i.block_start+=a,n-=a),n&&(mR(i.strm,i.strm.output,i.strm.next_out,n),i.strm.next_out+=n,i.strm.avail_out-=n,i.strm.total_out+=n)}while(h===0);return p-=i.strm.avail_in,p&&(p>=i.w_size?(i.matches=2,i.window.set(i.strm.input.subarray(i.strm.next_in-i.w_size,i.strm.next_in),0),i.strstart=i.w_size,i.insert=i.strstart):(i.window_size-i.strstart<=p&&(i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,i.insert>i.strstart&&(i.insert=i.strstart)),i.window.set(i.strm.input.subarray(i.strm.next_in-p,i.strm.next_in),i.strstart),i.strstart+=p,i.insert+=p>i.w_size-i.insert?i.w_size-i.insert:p),i.block_start=i.strstart),i.high_water<i.strstart&&(i.high_water=i.strstart),h?4:t!==su&&t!==os&&i.strm.avail_in===0&&i.strstart===i.block_start?2:(l=i.window_size-i.strstart,i.strm.avail_in>l&&i.block_start>=i.w_size&&(i.block_start-=i.w_size,i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,l+=i.w_size,i.insert>i.strstart&&(i.insert=i.strstart)),l>i.strm.avail_in&&(l=i.strm.avail_in),l&&(mR(i.strm,i.window,i.strstart,l),i.strstart+=l,i.insert+=l>i.w_size-i.insert?i.w_size-i.insert:l),i.high_water<i.strstart&&(i.high_water=i.strstart),l=i.bi_valid+42>>3,l=i.pending_buf_size-l>65535?65535:i.pending_buf_size-l,u=l>i.w_size?i.w_size:l,a=i.strstart-i.block_start,(a>=u||(a||t===os)&&t!==su&&i.strm.avail_in===0&&a<=l)&&(n=a>l?l:a,h=t===os&&i.strm.avail_in===0&&n===a?1:0,hR(i,i.block_start,n,h),i.block_start+=n,Aa(i.strm)),h?3:1)},gR=(i,t)=>{let n,a;for(;;){if(i.lookahead<Rc){if(np(i),i.lookahead<Rc&&t===su)return 1;if(i.lookahead===0)break}if(n=0,i.lookahead>=3&&(i.ins_h=lu(i,i.ins_h,i.window[i.strstart+3-1]),n=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),n!==0&&i.strstart-n<=i.w_size-Rc&&(i.match_length=GF(i,n)),i.match_length>=3)if(a=au(i,i.strstart-i.match_start,i.match_length-3),i.lookahead-=i.match_length,i.match_length<=i.max_lazy_match&&i.lookahead>=3){i.match_length--;do i.strstart++,i.ins_h=lu(i,i.ins_h,i.window[i.strstart+3-1]),n=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart;while(--i.match_length!=0);i.strstart++}else i.strstart+=i.match_length,i.match_length=0,i.ins_h=i.window[i.strstart],i.ins_h=lu(i,i.ins_h,i.window[i.strstart+1]);else a=au(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++;if(a&&(Oa(i,!1),i.strm.avail_out===0))return 1}return i.insert=i.strstart<2?i.strstart:2,t===os?(Oa(i,!0),i.strm.avail_out===0?3:4):i.sym_next&&(Oa(i,!1),i.strm.avail_out===0)?1:2},rp=(i,t)=>{let n,a,l;for(;;){if(i.lookahead<Rc){if(np(i),i.lookahead<Rc&&t===su)return 1;if(i.lookahead===0)break}if(n=0,i.lookahead>=3&&(i.ins_h=lu(i,i.ins_h,i.window[i.strstart+3-1]),n=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),i.prev_length=i.match_length,i.prev_match=i.match_start,i.match_length=2,n!==0&&i.prev_length<i.max_lazy_match&&i.strstart-n<=i.w_size-Rc&&(i.match_length=GF(i,n),i.match_length<=5&&(i.strategy===Dte||i.match_length===3&&i.strstart-i.match_start>4096)&&(i.match_length=2)),i.prev_length>=3&&i.match_length<=i.prev_length){l=i.strstart+i.lookahead-3,a=au(i,i.strstart-1-i.prev_match,i.prev_length-3),i.lookahead-=i.prev_length-1,i.prev_length-=2;do++i.strstart<=l&&(i.ins_h=lu(i,i.ins_h,i.window[i.strstart+3-1]),n=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart);while(--i.prev_length!=0);if(i.match_available=0,i.match_length=2,i.strstart++,a&&(Oa(i,!1),i.strm.avail_out===0))return 1}else if(i.match_available){if(a=au(i,0,i.window[i.strstart-1]),a&&Oa(i,!1),i.strstart++,i.lookahead--,i.strm.avail_out===0)return 1}else i.match_available=1,i.strstart++,i.lookahead--}return i.match_available&&(a=au(i,0,i.window[i.strstart-1]),i.match_available=0),i.insert=i.strstart<2?i.strstart:2,t===os?(Oa(i,!0),i.strm.avail_out===0?3:4):i.sym_next&&(Oa(i,!1),i.strm.avail_out===0)?1:2};function wc(i,t,n,a,l){this.good_length=i,this.max_lazy=t,this.nice_length=n,this.max_chain=a,this.func=l}const C0=[new wc(0,0,0,0,zF),new wc(4,4,8,4,gR),new wc(4,5,16,8,gR),new wc(4,6,32,32,gR),new wc(4,4,16,16,rp),new wc(8,16,32,32,rp),new wc(8,16,128,128,rp),new wc(8,32,128,256,rp),new wc(32,128,258,1024,rp),new wc(32,258,258,4096,rp)];function Hte(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=rE,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*jte),this.dyn_dtree=new Uint16Array(2*(2*Ute+1)),this.bl_tree=new Uint16Array(2*(2*Bte+1)),cu(this.dyn_ltree),cu(this.dyn_dtree),cu(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Vte+1),this.heap=new Uint16Array(2*fR+1),cu(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*fR+1),cu(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const b0=i=>{if(!i)return 1;const t=i.state;return!t||t.strm!==i||t.status!==tp&&t.status!==57&&t.status!==69&&t.status!==73&&t.status!==91&&t.status!==103&&t.status!==Cd&&t.status!==y0?1:0},KF=i=>{if(b0(i))return bd(i,Tc);i.total_in=i.total_out=0,i.data_type=Fte;const t=i.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?57:t.wrap?tp:Cd,i.adler=t.wrap===2?0:1,t.last_flush=-2,wte(t),Zi},YF=i=>{const t=KF(i);var n;return t===Zi&&((n=i.state).window_size=2*n.w_size,cu(n.head),n.max_lazy_match=C0[n.level].max_lazy,n.good_match=C0[n.level].good_length,n.nice_match=C0[n.level].nice_length,n.max_chain_length=C0[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},qF=(i,t,n,a,l,u)=>{if(!i)return Tc;let h=1;if(t===Pte&&(t=6),a<0?(h=0,a=-a):a>15&&(h=2,a-=16),l<1||l>9||n!==rE||a<8||a>15||t<0||t>9||u<0||u>Lte||a===8&&h!==1)return bd(i,Tc);a===8&&(a=9);const p=new Hte;return i.state=p,p.strm=i,p.status=tp,p.wrap=h,p.gzhead=null,p.w_bits=a,p.w_size=1<<p.w_bits,p.w_mask=p.w_size-1,p.hash_bits=l+7,p.hash_size=1<<p.hash_bits,p.hash_mask=p.hash_size-1,p.hash_shift=~~((p.hash_bits+3-1)/3),p.window=new Uint8Array(2*p.w_size),p.head=new Uint16Array(p.hash_size),p.prev=new Uint16Array(p.w_size),p.lit_bufsize=1<<l+6,p.pending_buf_size=4*p.lit_bufsize,p.pending_buf=new Uint8Array(p.pending_buf_size),p.sym_buf=p.lit_bufsize,p.sym_end=3*(p.lit_bufsize-1),p.level=t,p.strategy=u,p.method=n,YF(i)};var Wte=(i,t)=>{if(b0(i)||t>$F||t<0)return i?bd(i,Tc):Tc;const n=i.state;if(!i.output||i.avail_in!==0&&!i.input||n.status===y0&&t!==os)return bd(i,i.avail_out===0?pR:Tc);const a=n.last_flush;if(n.last_flush=t,n.pending!==0){if(Aa(i),i.avail_out===0)return n.last_flush=-1,Zi}else if(i.avail_in===0&&WF(t)<=WF(a)&&t!==os)return bd(i,pR);if(n.status===y0&&i.avail_in!==0)return bd(i,pR);if(n.status===tp&&n.wrap===0&&(n.status=Cd),n.status===tp){let l=rE+(n.w_bits-8<<4)<<8,u=-1;if(u=n.strategy>=nE||n.level<2?0:n.level<6?1:n.level===6?2:3,l|=u<<6,n.strstart!==0&&(l|=32),l+=31-l%31,S0(n,l),n.strstart!==0&&(S0(n,i.adler>>>16),S0(n,65535&i.adler)),i.adler=1,n.status=Cd,Aa(i),n.pending!==0)return n.last_flush=-1,Zi}if(n.status===57){if(i.adler=0,Vn(n,31),Vn(n,139),Vn(n,8),n.gzhead)Vn(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Vn(n,255&n.gzhead.time),Vn(n,n.gzhead.time>>8&255),Vn(n,n.gzhead.time>>16&255),Vn(n,n.gzhead.time>>24&255),Vn(n,n.level===9?2:n.strategy>=nE||n.level<2?4:0),Vn(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Vn(n,255&n.gzhead.extra.length),Vn(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(i.adler=Gi(i.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(Vn(n,0),Vn(n,0),Vn(n,0),Vn(n,0),Vn(n,0),Vn(n,n.level===9?2:n.strategy>=nE||n.level<2?4:0),Vn(n,3),n.status=Cd,Aa(i),n.pending!==0)return n.last_flush=-1,Zi}if(n.status===69){if(n.gzhead.extra){let l=n.pending,u=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+u>n.pending_buf_size;){let p=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+p),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>l&&(i.adler=Gi(i.adler,n.pending_buf,n.pending-l,l)),n.gzindex+=p,Aa(i),n.pending!==0)return n.last_flush=-1,Zi;l=0,u-=p}let h=new Uint8Array(n.gzhead.extra);n.pending_buf.set(h.subarray(n.gzindex,n.gzindex+u),n.pending),n.pending+=u,n.gzhead.hcrc&&n.pending>l&&(i.adler=Gi(i.adler,n.pending_buf,n.pending-l,l)),n.gzindex=0}n.status=73}if(n.status===73){if(n.gzhead.name){let l,u=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>u&&(i.adler=Gi(i.adler,n.pending_buf,n.pending-u,u)),Aa(i),n.pending!==0)return n.last_flush=-1,Zi;u=0}l=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Vn(n,l)}while(l!==0);n.gzhead.hcrc&&n.pending>u&&(i.adler=Gi(i.adler,n.pending_buf,n.pending-u,u)),n.gzindex=0}n.status=91}if(n.status===91){if(n.gzhead.comment){let l,u=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>u&&(i.adler=Gi(i.adler,n.pending_buf,n.pending-u,u)),Aa(i),n.pending!==0)return n.last_flush=-1,Zi;u=0}l=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Vn(n,l)}while(l!==0);n.gzhead.hcrc&&n.pending>u&&(i.adler=Gi(i.adler,n.pending_buf,n.pending-u,u))}n.status=103}if(n.status===103){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(Aa(i),n.pending!==0))return n.last_flush=-1,Zi;Vn(n,255&i.adler),Vn(n,i.adler>>8&255),i.adler=0}if(n.status=Cd,Aa(i),n.pending!==0)return n.last_flush=-1,Zi}if(i.avail_in!==0||n.lookahead!==0||t!==su&&n.status!==y0){let l=n.level===0?zF(n,t):n.strategy===nE?((u,h)=>{let p;for(;;){if(u.lookahead===0&&(np(u),u.lookahead===0)){if(h===su)return 1;break}if(u.match_length=0,p=au(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++,p&&(Oa(u,!1),u.strm.avail_out===0))return 1}return u.insert=0,h===os?(Oa(u,!0),u.strm.avail_out===0?3:4):u.sym_next&&(Oa(u,!1),u.strm.avail_out===0)?1:2})(n,t):n.strategy===kte?((u,h)=>{let p,v,E,y;const C=u.window;for(;;){if(u.lookahead<=Sd){if(np(u),u.lookahead<=Sd&&h===su)return 1;if(u.lookahead===0)break}if(u.match_length=0,u.lookahead>=3&&u.strstart>0&&(E=u.strstart-1,v=C[E],v===C[++E]&&v===C[++E]&&v===C[++E])){y=u.strstart+Sd;do;while(v===C[++E]&&v===C[++E]&&v===C[++E]&&v===C[++E]&&v===C[++E]&&v===C[++E]&&v===C[++E]&&v===C[++E]&&E<y);u.match_length=Sd-(y-E),u.match_length>u.lookahead&&(u.match_length=u.lookahead)}if(u.match_length>=3?(p=au(u,1,u.match_length-3),u.lookahead-=u.match_length,u.strstart+=u.match_length,u.match_length=0):(p=au(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++),p&&(Oa(u,!1),u.strm.avail_out===0))return 1}return u.insert=0,h===os?(Oa(u,!0),u.strm.avail_out===0?3:4):u.sym_next&&(Oa(u,!1),u.strm.avail_out===0)?1:2})(n,t):C0[n.level].func(n,t);if(l!==3&&l!==4||(n.status=y0),l===1||l===3)return i.avail_out===0&&(n.last_flush=-1),Zi;if(l===2&&(t===Ote?Ate(n):t!==$F&&(hR(n,0,0,!1),t===xte&&(cu(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),Aa(i),i.avail_out===0))return n.last_flush=-1,Zi}return t!==os?Zi:n.wrap<=0?HF:(n.wrap===2?(Vn(n,255&i.adler),Vn(n,i.adler>>8&255),Vn(n,i.adler>>16&255),Vn(n,i.adler>>24&255),Vn(n,255&i.total_in),Vn(n,i.total_in>>8&255),Vn(n,i.total_in>>16&255),Vn(n,i.total_in>>24&255)):(S0(n,i.adler>>>16),S0(n,65535&i.adler)),Aa(i),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?Zi:HF)},Gte=(i,t)=>{let n=t.length;if(b0(i))return Tc;const a=i.state,l=a.wrap;if(l===2||l===1&&a.status!==tp||a.lookahead)return Tc;if(l===1&&(i.adler=_0(i.adler,t,n,0)),a.wrap=0,n>=a.w_size){l===0&&(cu(a.head),a.strstart=0,a.block_start=0,a.insert=0);let v=new Uint8Array(a.w_size);v.set(t.subarray(n-a.w_size,n),0),t=v,n=a.w_size}const u=i.avail_in,h=i.next_in,p=i.input;for(i.avail_in=n,i.next_in=0,i.input=t,np(a);a.lookahead>=3;){let v=a.strstart,E=a.lookahead-2;do a.ins_h=lu(a,a.ins_h,a.window[v+3-1]),a.prev[v&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=v,v++;while(--E);a.strstart=v,a.lookahead=2,np(a)}return a.strstart+=a.lookahead,a.block_start=a.strstart,a.insert=a.lookahead,a.lookahead=0,a.match_length=a.prev_length=2,a.match_available=0,i.next_in=h,i.input=p,i.avail_in=u,a.wrap=l,Zi},T0={deflateInit:(i,t)=>qF(i,t,rE,15,8,Mte),deflateInit2:qF,deflateReset:YF,deflateResetKeep:KF,deflateSetHeader:(i,t)=>b0(i)||i.state.wrap!==2?Tc:(i.state.gzhead=t,Zi),deflate:Wte,deflateEnd:i=>{if(b0(i))return Tc;const t=i.state.status;return i.state=null,t===Cd?bd(i,Nte):Zi},deflateSetDictionary:Gte,deflateInfo:"pako deflate (from Nodeca project)"};const zte=(i,t)=>Object.prototype.hasOwnProperty.call(i,t);var iE={assign:function(i){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const a in n)zte(n,a)&&(i[a]=n[a])}}return i},flattenChunks:i=>{let t=0;for(let a=0,l=i.length;a<l;a++)t+=i[a].length;const n=new Uint8Array(t);for(let a=0,l=0,u=i.length;a<u;a++){let h=i[a];n.set(h,l),l+=h.length}return n}};let XF=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{XF=!1}const R0=new Uint8Array(256);for(let i=0;i<256;i++)R0[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;R0[254]=R0[254]=1;var w0={string2buf:i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let t,n,a,l,u,h=i.length,p=0;for(l=0;l<h;l++)n=i.charCodeAt(l),(64512&n)==55296&&l+1<h&&(a=i.charCodeAt(l+1),(64512&a)==56320&&(n=65536+(n-55296<<10)+(a-56320),l++)),p+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(p),u=0,l=0;u<p;l++)n=i.charCodeAt(l),(64512&n)==55296&&l+1<h&&(a=i.charCodeAt(l+1),(64512&a)==56320&&(n=65536+(n-55296<<10)+(a-56320),l++)),n<128?t[u++]=n:n<2048?(t[u++]=192|n>>>6,t[u++]=128|63&n):n<65536?(t[u++]=224|n>>>12,t[u++]=128|n>>>6&63,t[u++]=128|63&n):(t[u++]=240|n>>>18,t[u++]=128|n>>>12&63,t[u++]=128|n>>>6&63,t[u++]=128|63&n);return t},buf2string:(i,t)=>{const n=t||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,t));let a,l;const u=new Array(2*n);for(l=0,a=0;a<n;){let h=i[a++];if(h<128){u[l++]=h;continue}let p=R0[h];if(p>4)u[l++]=65533,a+=p-1;else{for(h&=p===2?31:p===3?15:7;p>1&&a<n;)h=h<<6|63&i[a++],p--;p>1?u[l++]=65533:h<65536?u[l++]=h:(h-=65536,u[l++]=55296|h>>10&1023,u[l++]=56320|1023&h)}}return((h,p)=>{if(p<65534&&h.subarray&&XF)return String.fromCharCode.apply(null,h.length===p?h:h.subarray(0,p));let v="";for(let E=0;E<p;E++)v+=String.fromCharCode(h[E]);return v})(u,l)},utf8border:(i,t)=>{(t=t||i.length)>i.length&&(t=i.length);let n=t-1;for(;n>=0&&(192&i[n])==128;)n--;return n<0||n===0?t:n+R0[i[n]]>t?n:t}},JF=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const QF=Object.prototype.toString,{Z_NO_FLUSH:Kte,Z_SYNC_FLUSH:Yte,Z_FULL_FLUSH:qte,Z_FINISH:Xte,Z_OK:oE,Z_STREAM_END:Jte,Z_DEFAULT_COMPRESSION:Qte,Z_DEFAULT_STRATEGY:Zte,Z_DEFLATED:ene}=ep;function I0(i){this.options=iE.assign({level:Qte,method:ene,chunkSize:16384,windowBits:15,memLevel:8,strategy:Zte},i||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new JF,this.strm.avail_out=0;let n=T0.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==oE)throw new Error(yd[n]);if(t.header&&T0.deflateSetHeader(this.strm,t.header),t.dictionary){let a;if(a=typeof t.dictionary=="string"?w0.string2buf(t.dictionary):QF.call(t.dictionary)==="[object ArrayBuffer]"?new Uint8Array(t.dictionary):t.dictionary,n=T0.deflateSetDictionary(this.strm,a),n!==oE)throw new Error(yd[n]);this._dict_set=!0}}function vR(i,t){const n=new I0(t);if(n.push(i,!0),n.err)throw n.msg||yd[n.err];return n.result}I0.prototype.push=function(i,t){const n=this.strm,a=this.options.chunkSize;let l,u;if(this.ended)return!1;for(u=t===~~t?t:t===!0?Xte:Kte,typeof i=="string"?n.input=w0.string2buf(i):QF.call(i)==="[object ArrayBuffer]"?n.input=new Uint8Array(i):n.input=i,n.next_in=0,n.avail_in=n.input.length;;)if(n.avail_out===0&&(n.output=new Uint8Array(a),n.next_out=0,n.avail_out=a),(u===Yte||u===qte)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(l=T0.deflate(n,u),l===Jte)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),l=T0.deflateEnd(this.strm),this.onEnd(l),this.ended=!0,l===oE;if(n.avail_out!==0){if(u>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(n.avail_in===0)break}else this.onData(n.output)}return!0},I0.prototype.onData=function(i){this.chunks.push(i)},I0.prototype.onEnd=function(i){i===oE&&(this.result=iE.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};var tne={Deflate:I0,deflate:vR,deflateRaw:function(i,t){return(t=t||{}).raw=!0,vR(i,t)},gzip:function(i,t){return(t=t||{}).gzip=!0,vR(i,t)},constants:ep};const aE=16209;var nne=function(i,t){let n,a,l,u,h,p,v,E,y,C,I,k,G,B,j,q,Z,re,Ce,pe,fe,ye,Ee,Ae;const Ne=i.state;n=i.next_in,Ee=i.input,a=n+(i.avail_in-5),l=i.next_out,Ae=i.output,u=l-(t-i.avail_out),h=l+(i.avail_out-257),p=Ne.dmax,v=Ne.wsize,E=Ne.whave,y=Ne.wnext,C=Ne.window,I=Ne.hold,k=Ne.bits,G=Ne.lencode,B=Ne.distcode,j=(1<<Ne.lenbits)-1,q=(1<<Ne.distbits)-1;e:do{k<15&&(I+=Ee[n++]<<k,k+=8,I+=Ee[n++]<<k,k+=8),Z=G[I&j];t:for(;;){if(re=Z>>>24,I>>>=re,k-=re,re=Z>>>16&255,re===0)Ae[l++]=65535&Z;else{if(!(16&re)){if(!(64&re)){Z=G[(65535&Z)+(I&(1<<re)-1)];continue t}if(32&re){Ne.mode=16191;break e}i.msg="invalid literal/length code",Ne.mode=aE;break e}Ce=65535&Z,re&=15,re&&(k<re&&(I+=Ee[n++]<<k,k+=8),Ce+=I&(1<<re)-1,I>>>=re,k-=re),k<15&&(I+=Ee[n++]<<k,k+=8,I+=Ee[n++]<<k,k+=8),Z=B[I&q];n:for(;;){if(re=Z>>>24,I>>>=re,k-=re,re=Z>>>16&255,!(16&re)){if(!(64&re)){Z=B[(65535&Z)+(I&(1<<re)-1)];continue n}i.msg="invalid distance code",Ne.mode=aE;break e}if(pe=65535&Z,re&=15,k<re&&(I+=Ee[n++]<<k,k+=8,k<re&&(I+=Ee[n++]<<k,k+=8)),pe+=I&(1<<re)-1,pe>p){i.msg="invalid distance too far back",Ne.mode=aE;break e}if(I>>>=re,k-=re,re=l-u,pe>re){if(re=pe-re,re>E&&Ne.sane){i.msg="invalid distance too far back",Ne.mode=aE;break e}if(fe=0,ye=C,y===0){if(fe+=v-re,re<Ce){Ce-=re;do Ae[l++]=C[fe++];while(--re);fe=l-pe,ye=Ae}}else if(y<re){if(fe+=v+y-re,re-=y,re<Ce){Ce-=re;do Ae[l++]=C[fe++];while(--re);if(fe=0,y<Ce){re=y,Ce-=re;do Ae[l++]=C[fe++];while(--re);fe=l-pe,ye=Ae}}}else if(fe+=y-re,re<Ce){Ce-=re;do Ae[l++]=C[fe++];while(--re);fe=l-pe,ye=Ae}for(;Ce>2;)Ae[l++]=ye[fe++],Ae[l++]=ye[fe++],Ae[l++]=ye[fe++],Ce-=3;Ce&&(Ae[l++]=ye[fe++],Ce>1&&(Ae[l++]=ye[fe++]))}else{fe=l-pe;do Ae[l++]=Ae[fe++],Ae[l++]=Ae[fe++],Ae[l++]=Ae[fe++],Ce-=3;while(Ce>2);Ce&&(Ae[l++]=Ae[fe++],Ce>1&&(Ae[l++]=Ae[fe++]))}break}}break}}while(n<a&&l<h);Ce=k>>3,n-=Ce,k-=Ce<<3,I&=(1<<k)-1,i.next_in=n,i.next_out=l,i.avail_in=n<a?a-n+5:5-(n-a),i.avail_out=l<h?h-l+257:257-(l-h),Ne.hold=I,Ne.bits=k};const sE=15,rne=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ine=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),one=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ane=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var A0=(i,t,n,a,l,u,h,p)=>{const v=p.bits;let E,y,C,I,k,G,B=0,j=0,q=0,Z=0,re=0,Ce=0,pe=0,fe=0,ye=0,Ee=0,Ae=null;const Ne=new Uint16Array(16),it=new Uint16Array(16);let yt,gn,Er,Sn=null;for(B=0;B<=sE;B++)Ne[B]=0;for(j=0;j<a;j++)Ne[t[n+j]]++;for(re=v,Z=sE;Z>=1&&Ne[Z]===0;Z--);if(re>Z&&(re=Z),Z===0)return l[u++]=20971520,l[u++]=20971520,p.bits=1,0;for(q=1;q<Z&&Ne[q]===0;q++);for(re<q&&(re=q),fe=1,B=1;B<=sE;B++)if(fe<<=1,fe-=Ne[B],fe<0)return-1;if(fe>0&&(i===0||Z!==1))return-1;for(it[1]=0,B=1;B<sE;B++)it[B+1]=it[B]+Ne[B];for(j=0;j<a;j++)t[n+j]!==0&&(h[it[t[n+j]]++]=j);if(i===0?(Ae=Sn=h,G=20):i===1?(Ae=rne,Sn=ine,G=257):(Ae=one,Sn=ane,G=0),Ee=0,j=0,B=q,k=u,Ce=re,pe=0,C=-1,ye=1<<re,I=ye-1,i===1&&ye>852||i===2&&ye>592)return 1;for(;;){yt=B-pe,h[j]+1<G?(gn=0,Er=h[j]):h[j]>=G?(gn=Sn[h[j]-G],Er=Ae[h[j]-G]):(gn=96,Er=0),E=1<<B-pe,y=1<<Ce,q=y;do y-=E,l[k+(Ee>>pe)+y]=yt<<24|gn<<16|Er|0;while(y!==0);for(E=1<<B-1;Ee&E;)E>>=1;if(E!==0?(Ee&=E-1,Ee+=E):Ee=0,j++,--Ne[B]==0){if(B===Z)break;B=t[n+h[j]]}if(B>re&&(Ee&I)!==C){for(pe===0&&(pe=re),k+=q,Ce=B-pe,fe=1<<Ce;Ce+pe<Z&&(fe-=Ne[Ce+pe],!(fe<=0));)Ce++,fe<<=1;if(ye+=1<<Ce,i===1&&ye>852||i===2&&ye>592)return 1;C=Ee&I,l[C]=re<<24|Ce<<16|k-u|0}}return Ee!==0&&(l[k+Ee]=B-pe<<24|64<<16|0),p.bits=re,0};const{Z_FINISH:ZF,Z_BLOCK:sne,Z_TREES:cE,Z_OK:Td,Z_STREAM_END:cne,Z_NEED_DICT:lne,Z_STREAM_ERROR:as,Z_DATA_ERROR:eU,Z_MEM_ERROR:tU,Z_BUF_ERROR:une,Z_DEFLATED:nU}=ep,lE=16180,uE=16190,rl=16191,ER=16192,_R=16194,dE=16199,hE=16200,yR=16206,jr=16209,rU=i=>(i>>>24&255)+(i>>>8&65280)+((65280&i)<<8)+((255&i)<<24);function dne(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Rd=i=>{if(!i)return 1;const t=i.state;return!t||t.strm!==i||t.mode<lE||t.mode>16211?1:0},iU=i=>{if(Rd(i))return as;const t=i.state;return i.total_in=i.total_out=t.total=0,i.msg="",t.wrap&&(i.adler=1&t.wrap),t.mode=lE,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Td},oU=i=>{if(Rd(i))return as;const t=i.state;return t.wsize=0,t.whave=0,t.wnext=0,iU(i)},aU=(i,t)=>{let n;if(Rd(i))return as;const a=i.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?as:(a.window!==null&&a.wbits!==t&&(a.window=null),a.wrap=n,a.wbits=t,oU(i))},sU=(i,t)=>{if(!i)return as;const n=new dne;i.state=n,n.strm=i,n.window=null,n.mode=lE;const a=aU(i,t);return a!==Td&&(i.state=null),a};let SR,CR,cU=!0;const hne=i=>{if(cU){SR=new Int32Array(512),CR=new Int32Array(32);let t=0;for(;t<144;)i.lens[t++]=8;for(;t<256;)i.lens[t++]=9;for(;t<280;)i.lens[t++]=7;for(;t<288;)i.lens[t++]=8;for(A0(1,i.lens,0,288,SR,0,i.work,{bits:9}),t=0;t<32;)i.lens[t++]=5;A0(2,i.lens,0,32,CR,0,i.work,{bits:5}),cU=!1}i.lencode=SR,i.lenbits=9,i.distcode=CR,i.distbits=5},lU=(i,t,n,a)=>{let l;const u=i.state;return u.window===null&&(u.wsize=1<<u.wbits,u.wnext=0,u.whave=0,u.window=new Uint8Array(u.wsize)),a>=u.wsize?(u.window.set(t.subarray(n-u.wsize,n),0),u.wnext=0,u.whave=u.wsize):(l=u.wsize-u.wnext,l>a&&(l=a),u.window.set(t.subarray(n-a,n-a+l),u.wnext),(a-=l)?(u.window.set(t.subarray(n-a,n),0),u.wnext=a,u.whave=u.wsize):(u.wnext+=l,u.wnext===u.wsize&&(u.wnext=0),u.whave<u.wsize&&(u.whave+=l))),0};var pne=(i,t)=>{let n,a,l,u,h,p,v,E,y,C,I,k,G,B,j,q,Z,re,Ce,pe,fe,ye,Ee=0;const Ae=new Uint8Array(4);let Ne,it;const yt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Rd(i)||!i.output||!i.input&&i.avail_in!==0)return as;n=i.state,n.mode===rl&&(n.mode=ER),h=i.next_out,l=i.output,v=i.avail_out,u=i.next_in,a=i.input,p=i.avail_in,E=n.hold,y=n.bits,C=p,I=v,ye=Td;e:for(;;)switch(n.mode){case lE:if(n.wrap===0){n.mode=ER;break}for(;y<16;){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}if(2&n.wrap&&E===35615){n.wbits===0&&(n.wbits=15),n.check=0,Ae[0]=255&E,Ae[1]=E>>>8&255,n.check=Gi(n.check,Ae,2,0),E=0,y=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&E)<<8)+(E>>8))%31){i.msg="incorrect header check",n.mode=jr;break}if((15&E)!==nU){i.msg="unknown compression method",n.mode=jr;break}if(E>>>=4,y-=4,fe=8+(15&E),n.wbits===0&&(n.wbits=fe),fe>15||fe>n.wbits){i.msg="invalid window size",n.mode=jr;break}n.dmax=1<<n.wbits,n.flags=0,i.adler=n.check=1,n.mode=512&E?16189:rl,E=0,y=0;break;case 16181:for(;y<16;){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}if(n.flags=E,(255&n.flags)!==nU){i.msg="unknown compression method",n.mode=jr;break}if(57344&n.flags){i.msg="unknown header flags set",n.mode=jr;break}n.head&&(n.head.text=E>>8&1),512&n.flags&&4&n.wrap&&(Ae[0]=255&E,Ae[1]=E>>>8&255,n.check=Gi(n.check,Ae,2,0)),E=0,y=0,n.mode=16182;case 16182:for(;y<32;){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}n.head&&(n.head.time=E),512&n.flags&&4&n.wrap&&(Ae[0]=255&E,Ae[1]=E>>>8&255,Ae[2]=E>>>16&255,Ae[3]=E>>>24&255,n.check=Gi(n.check,Ae,4,0)),E=0,y=0,n.mode=16183;case 16183:for(;y<16;){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}n.head&&(n.head.xflags=255&E,n.head.os=E>>8),512&n.flags&&4&n.wrap&&(Ae[0]=255&E,Ae[1]=E>>>8&255,n.check=Gi(n.check,Ae,2,0)),E=0,y=0,n.mode=16184;case 16184:if(1024&n.flags){for(;y<16;){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}n.length=E,n.head&&(n.head.extra_len=E),512&n.flags&&4&n.wrap&&(Ae[0]=255&E,Ae[1]=E>>>8&255,n.check=Gi(n.check,Ae,2,0)),E=0,y=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(k=n.length,k>p&&(k=p),k&&(n.head&&(fe=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(a.subarray(u,u+k),fe)),512&n.flags&&4&n.wrap&&(n.check=Gi(n.check,a,k,u)),p-=k,u+=k,n.length-=k),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(p===0)break e;k=0;do fe=a[u+k++],n.head&&fe&&n.length<65536&&(n.head.name+=String.fromCharCode(fe));while(fe&&k<p);if(512&n.flags&&4&n.wrap&&(n.check=Gi(n.check,a,k,u)),p-=k,u+=k,fe)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(p===0)break e;k=0;do fe=a[u+k++],n.head&&fe&&n.length<65536&&(n.head.comment+=String.fromCharCode(fe));while(fe&&k<p);if(512&n.flags&&4&n.wrap&&(n.check=Gi(n.check,a,k,u)),p-=k,u+=k,fe)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;y<16;){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}if(4&n.wrap&&E!==(65535&n.check)){i.msg="header crc mismatch",n.mode=jr;break}E=0,y=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),i.adler=n.check=0,n.mode=rl;break;case 16189:for(;y<32;){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}i.adler=n.check=rU(E),E=0,y=0,n.mode=uE;case uE:if(n.havedict===0)return i.next_out=h,i.avail_out=v,i.next_in=u,i.avail_in=p,n.hold=E,n.bits=y,lne;i.adler=n.check=1,n.mode=rl;case rl:if(t===sne||t===cE)break e;case ER:if(n.last){E>>>=7&y,y-=7&y,n.mode=yR;break}for(;y<3;){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}switch(n.last=1&E,E>>>=1,y-=1,3&E){case 0:n.mode=16193;break;case 1:if(hne(n),n.mode=dE,t===cE){E>>>=2,y-=2;break e}break;case 2:n.mode=16196;break;case 3:i.msg="invalid block type",n.mode=jr}E>>>=2,y-=2;break;case 16193:for(E>>>=7&y,y-=7&y;y<32;){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}if((65535&E)!=(E>>>16^65535)){i.msg="invalid stored block lengths",n.mode=jr;break}if(n.length=65535&E,E=0,y=0,n.mode=_R,t===cE)break e;case _R:n.mode=16195;case 16195:if(k=n.length,k){if(k>p&&(k=p),k>v&&(k=v),k===0)break e;l.set(a.subarray(u,u+k),h),p-=k,u+=k,v-=k,h+=k,n.length-=k;break}n.mode=rl;break;case 16196:for(;y<14;){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}if(n.nlen=257+(31&E),E>>>=5,y-=5,n.ndist=1+(31&E),E>>>=5,y-=5,n.ncode=4+(15&E),E>>>=4,y-=4,n.nlen>286||n.ndist>30){i.msg="too many length or distance symbols",n.mode=jr;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;y<3;){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}n.lens[yt[n.have++]]=7&E,E>>>=3,y-=3}for(;n.have<19;)n.lens[yt[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,Ne={bits:n.lenbits},ye=A0(0,n.lens,0,19,n.lencode,0,n.work,Ne),n.lenbits=Ne.bits,ye){i.msg="invalid code lengths set",n.mode=jr;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;Ee=n.lencode[E&(1<<n.lenbits)-1],j=Ee>>>24,q=Ee>>>16&255,Z=65535&Ee,!(j<=y);){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}if(Z<16)E>>>=j,y-=j,n.lens[n.have++]=Z;else{if(Z===16){for(it=j+2;y<it;){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}if(E>>>=j,y-=j,n.have===0){i.msg="invalid bit length repeat",n.mode=jr;break}fe=n.lens[n.have-1],k=3+(3&E),E>>>=2,y-=2}else if(Z===17){for(it=j+3;y<it;){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}E>>>=j,y-=j,fe=0,k=3+(7&E),E>>>=3,y-=3}else{for(it=j+7;y<it;){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}E>>>=j,y-=j,fe=0,k=11+(127&E),E>>>=7,y-=7}if(n.have+k>n.nlen+n.ndist){i.msg="invalid bit length repeat",n.mode=jr;break}for(;k--;)n.lens[n.have++]=fe}}if(n.mode===jr)break;if(n.lens[256]===0){i.msg="invalid code -- missing end-of-block",n.mode=jr;break}if(n.lenbits=9,Ne={bits:n.lenbits},ye=A0(1,n.lens,0,n.nlen,n.lencode,0,n.work,Ne),n.lenbits=Ne.bits,ye){i.msg="invalid literal/lengths set",n.mode=jr;break}if(n.distbits=6,n.distcode=n.distdyn,Ne={bits:n.distbits},ye=A0(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,Ne),n.distbits=Ne.bits,ye){i.msg="invalid distances set",n.mode=jr;break}if(n.mode=dE,t===cE)break e;case dE:n.mode=hE;case hE:if(p>=6&&v>=258){i.next_out=h,i.avail_out=v,i.next_in=u,i.avail_in=p,n.hold=E,n.bits=y,nne(i,I),h=i.next_out,l=i.output,v=i.avail_out,u=i.next_in,a=i.input,p=i.avail_in,E=n.hold,y=n.bits,n.mode===rl&&(n.back=-1);break}for(n.back=0;Ee=n.lencode[E&(1<<n.lenbits)-1],j=Ee>>>24,q=Ee>>>16&255,Z=65535&Ee,!(j<=y);){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}if(q&&!(240&q)){for(re=j,Ce=q,pe=Z;Ee=n.lencode[pe+((E&(1<<re+Ce)-1)>>re)],j=Ee>>>24,q=Ee>>>16&255,Z=65535&Ee,!(re+j<=y);){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}E>>>=re,y-=re,n.back+=re}if(E>>>=j,y-=j,n.back+=j,n.length=Z,q===0){n.mode=16205;break}if(32&q){n.back=-1,n.mode=rl;break}if(64&q){i.msg="invalid literal/length code",n.mode=jr;break}n.extra=15&q,n.mode=16201;case 16201:if(n.extra){for(it=n.extra;y<it;){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}n.length+=E&(1<<n.extra)-1,E>>>=n.extra,y-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;Ee=n.distcode[E&(1<<n.distbits)-1],j=Ee>>>24,q=Ee>>>16&255,Z=65535&Ee,!(j<=y);){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}if(!(240&q)){for(re=j,Ce=q,pe=Z;Ee=n.distcode[pe+((E&(1<<re+Ce)-1)>>re)],j=Ee>>>24,q=Ee>>>16&255,Z=65535&Ee,!(re+j<=y);){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}E>>>=re,y-=re,n.back+=re}if(E>>>=j,y-=j,n.back+=j,64&q){i.msg="invalid distance code",n.mode=jr;break}n.offset=Z,n.extra=15&q,n.mode=16203;case 16203:if(n.extra){for(it=n.extra;y<it;){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}n.offset+=E&(1<<n.extra)-1,E>>>=n.extra,y-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){i.msg="invalid distance too far back",n.mode=jr;break}n.mode=16204;case 16204:if(v===0)break e;if(k=I-v,n.offset>k){if(k=n.offset-k,k>n.whave&&n.sane){i.msg="invalid distance too far back",n.mode=jr;break}k>n.wnext?(k-=n.wnext,G=n.wsize-k):G=n.wnext-k,k>n.length&&(k=n.length),B=n.window}else B=l,G=h-n.offset,k=n.length;k>v&&(k=v),v-=k,n.length-=k;do l[h++]=B[G++];while(--k);n.length===0&&(n.mode=hE);break;case 16205:if(v===0)break e;l[h++]=n.length,v--,n.mode=hE;break;case yR:if(n.wrap){for(;y<32;){if(p===0)break e;p--,E|=a[u++]<<y,y+=8}if(I-=v,i.total_out+=I,n.total+=I,4&n.wrap&&I&&(i.adler=n.check=n.flags?Gi(n.check,l,I,h-I):_0(n.check,l,I,h-I)),I=v,4&n.wrap&&(n.flags?E:rU(E))!==n.check){i.msg="incorrect data check",n.mode=jr;break}E=0,y=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;y<32;){if(p===0)break e;p--,E+=a[u++]<<y,y+=8}if(4&n.wrap&&E!==(4294967295&n.total)){i.msg="incorrect length check",n.mode=jr;break}E=0,y=0}n.mode=16208;case 16208:ye=cne;break e;case jr:ye=eU;break e;case 16210:return tU;default:return as}return i.next_out=h,i.avail_out=v,i.next_in=u,i.avail_in=p,n.hold=E,n.bits=y,(n.wsize||I!==i.avail_out&&n.mode<jr&&(n.mode<yR||t!==ZF))&&lU(i,i.output,i.next_out,I-i.avail_out),C-=i.avail_in,I-=i.avail_out,i.total_in+=C,i.total_out+=I,n.total+=I,4&n.wrap&&I&&(i.adler=n.check=n.flags?Gi(n.check,l,I,i.next_out-I):_0(n.check,l,I,i.next_out-I)),i.data_type=n.bits+(n.last?64:0)+(n.mode===rl?128:0)+(n.mode===dE||n.mode===_R?256:0),(C===0&&I===0||t===ZF)&&ye===Td&&(ye=une),ye},il={inflateReset:oU,inflateReset2:aU,inflateResetKeep:iU,inflateInit:i=>sU(i,15),inflateInit2:sU,inflate:pne,inflateEnd:i=>{if(Rd(i))return as;let t=i.state;return t.window&&(t.window=null),i.state=null,Td},inflateGetHeader:(i,t)=>{if(Rd(i))return as;const n=i.state;return 2&n.wrap?(n.head=t,t.done=!1,Td):as},inflateSetDictionary:(i,t)=>{const n=t.length;let a,l,u;return Rd(i)?as:(a=i.state,a.wrap!==0&&a.mode!==uE?as:a.mode===uE&&(l=1,l=_0(l,t,n,0),l!==a.check)?eU:(u=lU(i,t,n,n),u?(a.mode=16210,tU):(a.havedict=1,Td)))},inflateInfo:"pako inflate (from Nodeca project)"},fne=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const uU=Object.prototype.toString,{Z_NO_FLUSH:mne,Z_FINISH:gne,Z_OK:O0,Z_STREAM_END:bR,Z_NEED_DICT:TR,Z_STREAM_ERROR:vne,Z_DATA_ERROR:dU,Z_MEM_ERROR:Ene}=ep;function x0(i){this.options=iE.assign({chunkSize:65536,windowBits:15,to:""},i||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||i&&i.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new JF,this.strm.avail_out=0;let n=il.inflateInit2(this.strm,t.windowBits);if(n!==O0)throw new Error(yd[n]);if(this.header=new fne,il.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=w0.string2buf(t.dictionary):uU.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=il.inflateSetDictionary(this.strm,t.dictionary),n!==O0)))throw new Error(yd[n])}function RR(i,t){const n=new x0(t);if(n.push(i),n.err)throw n.msg||yd[n.err];return n.result}x0.prototype.push=function(i,t){const n=this.strm,a=this.options.chunkSize,l=this.options.dictionary;let u,h,p;if(this.ended)return!1;for(h=t===~~t?t:t===!0?gne:mne,uU.call(i)==="[object ArrayBuffer]"?n.input=new Uint8Array(i):n.input=i,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(a),n.next_out=0,n.avail_out=a),u=il.inflate(n,h),u===TR&&l&&(u=il.inflateSetDictionary(n,l),u===O0?u=il.inflate(n,h):u===dU&&(u=TR));n.avail_in>0&&u===bR&&n.state.wrap>0&&i[n.next_in]!==0;)il.inflateReset(n),u=il.inflate(n,h);switch(u){case vne:case dU:case TR:case Ene:return this.onEnd(u),this.ended=!0,!1}if(p=n.avail_out,n.next_out&&(n.avail_out===0||u===bR))if(this.options.to==="string"){let v=w0.utf8border(n.output,n.next_out),E=n.next_out-v,y=w0.buf2string(n.output,v);n.next_out=E,n.avail_out=a-E,E&&n.output.set(n.output.subarray(v,v+E),0),this.onData(y)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(u!==O0||p!==0){if(u===bR)return u=il.inflateEnd(this.strm),this.onEnd(u),this.ended=!0,!0;if(n.avail_in===0)break}}return!0},x0.prototype.onData=function(i){this.chunks.push(i)},x0.prototype.onEnd=function(i){i===O0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=iE.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};var _ne={Inflate:x0,inflate:RR,inflateRaw:function(i,t){return(t=t||{}).raw=!0,RR(i,t)},ungzip:RR,constants:ep};const{Deflate:Lwe,deflate:yne,deflateRaw:Mwe,gzip:Fwe}=tne,{Inflate:Uwe,inflate:Sne,inflateRaw:Bwe,ungzip:jwe}=_ne;var wR,Cne=yne,bne=Sne;(function(i){i[i.ONE_BYTE=0]="ONE_BYTE",i[i.TWO_BYTE=1]="TWO_BYTE"})(wR||(wR={}));class Tne{constructor(){w(this,"_sequence",0),w(this,"_startTime",Date.now()),w(this,"isUseOneByte",!0)}get startTime(){const t=Date.now()-this._startTime;return t<Math.pow(2,16)?t:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(t){const n={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:t};if(t.byteLength>128){const p=new Uint8Array(4);p.set([1,0,0,0]);const v={id:0,length:4,data:p.buffer},E={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[v]};n.commonPacketHeader.extension=1,n.extension=E,n.payload=this.compress(t),n.commonPacketHeader.length=8+(n.extension.length+2)+n.payload.byteLength}else n.commonPacketHeader.length=8+n.payload.byteLength;J("SHOW_DATASTREAM2_LOG")&&L.debug("send data header: ".concat(JSON.stringify(n.commonPacketHeader)));const a=new ArrayBuffer(n.commonPacketHeader.length),l=new Uint8Array(a),u=new DataView(a);let h=0;if(u.setUint16(h,n.commonPacketHeader.extension<<15|n.commonPacketHeader.reserved<<14|n.commonPacketHeader.length,!0),h+=2,u.setUint32(h,n.commonPacketHeader.sequence,!0),h+=4,u.setUint16(h,n.commonStreamHeader,!0),h+=2,n.extension){const p=this.serializeExtension(n.extension);l.set(new Uint8Array(p),h),h+=p.byteLength}if(l.set(new Uint8Array(n.payload),h),h+=n.payload.byteLength,h!==n.commonPacketHeader.length)throw Error("serialize error!");return a}deserialize(t){if(t.byteLength<4)return new ArrayBuffer(0);const n=new DataView(t);let a=0;const l=n.getUint16(a,!0);a+=2;const u={length:16383&l,reserved:(16384&l)>>14,extension:(32768&l)>>15,sequence:n.getUint16(a+2,!0)<<16|n.getUint16(a,!0)};let h,p;if(a+=4,J("SHOW_DATASTREAM2_LOG")&&L.debug("receive data header: ".concat(JSON.stringify(u))),n.getUint16(a,!0),a+=2,u.extension){p=this.deserializeExtension(t.slice(a)),a+=2+p.length,h=t.slice(a);let v=!1;if(p.datas.length>0){const E=p.datas.find(y=>y.id===0);E&&(v=(1&new DataView(E.data).getUint32(0,!0))==1)}h=v?this.decompress(h):h}else h=t.slice(8);return h}serializeExtension(t){const{profile:n,length:a,datas:l}=t,u=new ArrayBuffer(a+2),h=new Uint8Array(u),p=new DataView(u);let v=0;if(p.setUint8(v++,n),p.setUint8(v++,a),l.forEach(E=>{n?(p.setUint8(v++,E.id),p.setUint8(v++,E.length),h.set(new Uint8Array(E.data),v),v+=E.data.byteLength):(p.setUint8(v++,E.id|E.length<<4),h.set(new Uint8Array(E.data),v),v+=E.data.byteLength)}),v!==a+2)throw Error("serialize extension error, is ".concat(v,"!==").concat(a+2));return u}deserializeExtension(t){const n=new DataView(t);let a=0;const l=n.getUint8(a);a++;const u=n.getUint8(a);a++;const h=l===wR.TWO_BYTE,p=[],v=new DataView(t,2);let E=0;for(;E<u;){let y=0,C=0,I=new ArrayBuffer(0);h?(y=v.getUint8(E),E++,C=v.getUint8(E),E++):(y=15&v.getUint8(E),C=v.getUint8(E)>>4,E++),C>0&&(I=v.buffer.slice(E+2,E+2+C),E+=I.byteLength),p.push({id:y,length:C,data:I})}if(E!==u)throw Error("parse error");return{profile:l,length:u,datas:p}}decompress(t){return bne(new Uint8Array(t))}compress(t){return Cne(new Uint8Array(t))}}class hU extends wn{constructor(t,n){super(),w(this,"_version",1),w(this,"_type",3),w(this,"_config",void 0),w(this,"_originDataChannel",void 0),w(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),w(this,"_dataStreamPacketHandler",void 0),w(this,"_datachannelEventMap",new Map),this._config=t,n&&(this._originDataChannel=n,this._bandDataChannelEvents(n)),this._initPacketHeader(),this._dataStreamPacketHandler=new Tne}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return J("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var t,n;return(t=(n=this._originDataChannel)===null||n===void 0?void 0:n.readyState)!==null&&t!==void 0?t:"connecting"}get _originDataChannelId(){var t,n;return(t=(n=this._originDataChannel)===null||n===void 0?void 0:n.id)!==null&&t!==void 0?t:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new _e((t,n)=>{if(this._originDataChannel){this._originDataChannel.readyState==="open"&&t();const a=setTimeout(()=>{var l;n(new Te(z.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat((l=this._originDataChannel)===null||l===void 0?void 0:l.id)))},1e4);this._originDataChannel.onopen=()=>{clearTimeout(a),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),t()},this._originDataChannel.onerror=()=>{throw clearTimeout(a),new Te(z.DATACHANNEL_CONNECTION_TIMEOUT)}}else n(new Te(z.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})}_updateOriginDataChannel(t){this._originDataChannel=t,this._bandDataChannelEvents(t)}_initPacketHeader(){const t=new DataView(this._dataStreamPacketHeader);t.setUint16(0,this._version),t.setUint8(2,this._type),t.setUint8(3,this._config.id)}_bandDataChannelEvents(t){this._unbindDataChannelEvents(t),[qh.OPEN,qh.CLOSE,qh.ERROR].forEach(n=>{const a=()=>{this.emit(n)};this._datachannelEventMap.set(n,a),t.addEventListener(n,a)})}_unbindDataChannelEvents(t){Array.from(this._datachannelEventMap.entries()).forEach(n=>{let[a,l]=n;t.removeEventListener(a,l)}),this._datachannelEventMap.clear()}}class Rne extends hU{constructor(t){super(t),w(this,"_messageListener",void 0),this._messageListener=n=>{if(n.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const a=n.data.slice(0,this._dataStreamPacketHeader.byteLength),l=new DataView(a).getUint8(3);if(l!==this.id)return void(J("SHOW_DATASTREAM2_LOG")&&L.debug("invalid datachannel id: ".concat(l," !== ").concat(this.id)));let u=n.data.slice(this._dataStreamPacketHeader.byteLength);u=this._dataStreamPacketHandler.deserialize(u),this.emit(qh.MESSAGE,u)}}_updateOriginDataChannel(t){super._updateOriginDataChannel(t),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class pU extends hU{send(t){if(this._originDataChannel){let n=t;n=this._dataStreamPacketHandler.serialize(t);const a=new Uint8Array(this._dataStreamPacketHeader.byteLength+n.byteLength);a.set(new Uint8Array(this._dataStreamPacketHeader),0),a.set(new Uint8Array(n),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(a.buffer)}}}(function(){const i=Wt();_i.getDisplayMedia=function(t){return!!(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)}(),_i.getStreamFromExtension=i.name===qt.CHROME&&Number(i.version)>34,_i.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const t=new RTCPeerConnection;let n=!1;try{t.addTransceiver("audio"),n=!0}catch{}return t.close(),n}(),_i.supportMinBitrate=i.name===qt.CHROME||i.name===qt.EDGE,_i.supportSetRtpSenderParameters=function(){const t=Wt();return!window.RTCRtpSender||!window.RTCRtpSender.prototype.setParameters||!window.RTCRtpSender.prototype.getParameters?!1:!!Wl()||!(!Ni()&&!fv())||t.name===qt.FIREFOX&&Number(t.version)>=64}(),i.name===qt.SAFARI&&(Number(i.version)>=14?_i.supportDualStream=!0:_i.supportDualStream=!1),_i.webAudioMediaStreamDest=function(){const t=Wt();return!(t.name===qt.SAFARI&&Number(t.version)<12)}(),_i.supportReplaceTrack=function(){return window.RTCRtpSender?typeof RTCRtpSender.prototype.replaceTrack=="function":!1}(),_i.supportWebGL=typeof WebGLRenderingContext<"u",_i.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,Wl()||(_i.webAudioWithAEC=!0),_i.supportShareAudio=function(){const t=Wt();return(t.os===yr.WIN_10||t.os===yr.WIN_81||t.os===yr.WIN_7||t.os===yr.LINUX||t.os===yr.MAC_OS||t.os===yr.CHROMIUM_OS)&&t.name===qt.CHROME&&Number(t.version)>=74}(),_i.supportDataChannel=function(){return!!($b(76)||function(t){const n=Wt();return!(n.name!==qt.FIREFOX||!n.osVersion)&&Number(n.version)>=t}(68)||function(t){const n=Wt();return!(n.name!==qt.SAFARI||!n.osVersion)&&Number(n.version)>=t}(14))}(),_i.supportPCSetConfiguration=function(){const t=window.RTCPeerConnection;return!un()&&!!t&&t.prototype.setConfiguration instanceof Function}(),_i.supportWebRTCEncodedTransform=function(){const t=Wt();return t.name==="Chrome"&&Number(t.version)>=86}(),_i.supportWebRTCInsertableStream=function(){const t=Wt();return(t.name===qt.CHROME||t.name===qt.EDGE)&&Number(t.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),Ev(()=>{_i.supportDualStreamEncoding=function(){const t=Wt();return J("DISABLE_WEBAUDIO")?!0:t.name==="Safari"&&Number(t.version)>=14||!!(t.name==="Chrome"&&/Windows/i.test(t.os||"")&&Number(t.version)>=100&&J("CHROME_DUAL_STREAM_USE_ENCODING"))}(),L.info("browser compatibility",JSON.stringify(_i),JSON.stringify(i))})})();class wne extends wn{constructor(){super(...arguments),w(this,"resultStorage",new Map)}setLocalAudioStats(t,n,a){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",t,this.checkAudioInputLevel(a,n)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",t,this.checkSendAudioBitrate(a,n))}setLocalVideoStats(t,n,a){this.record("SEND_VIDEO_BITRATE_TOO_LOW",t,this.checkSendVideoBitrate(a,n)),this.record("FRAMERATE_INPUT_TOO_LOW",t,this.checkFramerateInput(a,n)),this.record("FRAMERATE_SENT_TOO_LOW",t,this.checkFramerateSent(a))}setRemoteAudioStats(t,n){const a=t.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",a,this.checkAudioOutputLevel(n))}setRemoteVideoStats(t,n){const a=t.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",a,this.checkVideoDecode(n))}record(t,n,a){if(J("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(t)||this.resultStorage.set(t,{result:[],isPrevNormal:!0});const l=this.resultStorage.get(t);if(l&&(l.result.push(a),l.result.length>=5)){var u;const h=Be(u=l.result).call(u,!0);l.isPrevNormal&&!h&&this.emit("exception",fU[t],t,n),!l.isPrevNormal&&h&&this.emit("exception",fU[t]+2e3,t+"_RECOVER",n),l.isPrevNormal=h,l.result=[]}}checkAudioOutputLevel(t){return!(t.receiveBitrate>0&&t.receiveLevel===0)}checkAudioInputLevel(t,n){return n instanceof dr&&!n.isActive||!!n.muted||t.sendVolumeLevel!==0}checkFramerateInput(t,n){let a=null;n._encoderConfig&&n._encoderConfig.frameRate&&(a=Jo(n._encoderConfig.frameRate));const l=t.captureFrameRate;return!a||!l||!(a>10&&l<5||a<10&&a>=5&&l<=1)}checkFramerateSent(t){return!(t.captureFrameRate&&t.sendFrameRate&&t.captureFrameRate>5&&t.sendFrameRate<=1)}checkSendVideoBitrate(t,n){return!!n.muted||t.sendBitrate!==0}checkSendAudioBitrate(t,n){return n instanceof dr&&!n.isActive||!!n.muted||t.sendBitrate!==0}checkVideoDecode(t){return t.receiveBitrate===0||t.decodeFrameRate!==0}}const fU={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},li=new class{markSubscribeStart(i,t){performance.mark("agora-web-sdk/".concat(i,"/subscribe-").concat(t))}markPublishStart(i,t){performance.mark("agora-web-sdk/".concat(i,"/publish-").concat(t))}measureFromSubscribeStart(i,t){const n=performance.getEntriesByName("agora-web-sdk/".concat(i,"/subscribe-").concat(t));if(n.length>0){const a=n[n.length-1];return Math.round(performance.now()-a.startTime)}return 0}measureFromPublishStart(i,t){const n=performance.getEntriesByName("agora-web-sdk/".concat(i,"/publish-").concat(t));if(n.length>0){const a=n[n.length-1];return Math.round(performance.now()-a.startTime)}return 0}};function IR(i,t){this.v=i,this.k=t}function _t(i){return new IR(i,0)}var Ine=Ak,Ane=mc;jn({target:"Promise",stat:!0,forced:!0},{withResolvers:function(){var i=Ane.f(this);return{promise:i.promise,resolve:i.resolve,reject:i.reject}}});var One=mc,xne=Oh;jn({target:"Promise",stat:!0,forced:!0},{try:function(i){var t=One.f(this),n=xne(i);return(n.error?t.reject:t.resolve)(n.value),t.promise}});var AR=c(Ine),mU=_h.f("asyncIterator"),Nne=c(mU);function N0(i){var t,n;function a(u,h){try{var p=i[u](h),v=p.value,E=v instanceof IR;AR.resolve(E?v.v:v).then(function(y){if(E){var C=u==="return"?"return":"next";if(!v.k||y.done)return a(C,y);y=i[C](y).value}l(p.done?"return":"normal",y)},function(y){a("throw",y)})}catch(y){l("throw",y)}}function l(u,h){switch(u){case"return":t.resolve({value:h,done:!0});break;case"throw":t.reject(h);break;default:t.resolve({value:h,done:!1})}(t=t.next)?a(t.key,t.arg):n=null}this._invoke=function(u,h){return new AR(function(p,v){var E={key:u,arg:h,resolve:p,reject:v,next:null};n?n=n.next=E:(t=n=E,a(u,h))})},typeof i.return!="function"&&(this.return=void 0)}function Do(i){return function(){return new N0(i.apply(this,arguments))}}N0.prototype[typeof Rh=="function"&&Nne||"@@asyncIterator"]=function(){return this},N0.prototype.next=function(i){return this._invoke("next",i)},N0.prototype.throw=function(i){return this._invoke("throw",i)},N0.prototype.return=function(i){return this._invoke("return",i)};var gU=c(lt.Object.getOwnPropertySymbols),Pne=jn,Dne=pC.indexOf,kne=cb,OR=Y([].indexOf),vU=!!OR&&1/OR([1],1,-0)<0;Pne({target:"Array",proto:!0,forced:vU||!kne("indexOf")},{indexOf:function(i){var t=arguments.length>1?arguments[1]:void 0;return vU?OR(this,i,t)||0:Dne(this,i,t)}});var Lne=Bl("Array").indexOf,Mne=R,Fne=Lne,xR=Array.prototype,EU=c(function(i){var t=i.indexOf;return i===xR||Mne(xR,i)&&t===xR.indexOf?Fne:t}),Une=xi,_U=xC;jn({target:"Object",stat:!0,forced:d(function(){_U(1)})},{keys:function(i){return _U(Une(i))}});var Bne=c(lt.Object.keys);function jne(i,t){if(i==null)return{};var n,a,l=function(h,p){if(h==null)return{};var v,E,y={},C=Bne(h);for(E=0;E<C.length;E++)v=C[E],EU(p).call(p,v)>=0||(y[v]=h[v]);return y}(i,t);if(gU){var u=gU(i);for(a=0;a<u.length;a++)n=u[a],EU(t).call(t,n)>=0||Object.prototype.propertyIsEnumerable.call(i,n)&&(l[n]=i[n])}return l}var yU={exports:{}};(function(i,t){i.exports=(()=>{var n={8:(u,h,p)=>{p.r(h),p.d(h,{Parser:()=>it,Printer:()=>Lo,parse:()=>st,print:()=>Gt});const v=`
`,E="".concat("\r").concat(v),y=" ";let C;function I(De){return De>="0"&&De<="9"}function k(De){return De>="!"&&De<="~"}function G(De){return k(De)||De>="Â"&&De<="Ã¿"}function B(De){return De==="!"||De>="#"&&De<="'"||De>="*"&&De<="+"||De>="-"&&De<="."||De>="0"&&De<="9"||De>="A"&&De<="Z"||De>="^"&&De<="~"}function j(De){return De>="1"&&De<="9"}function q(De){return De>="A"&&De<="Z"||De>="a"&&De<="z"}function Z(De){return De==="d"||De==="h"||De==="m"||De==="s"}function re(De){return De>""&&De<"	"||De>"\v"&&De<"\f"||De>""&&De<"Ã¿"}function Ce(De){return q(De)||I(De)||De==="+"||De==="/"}function pe(De){return I(De)||q(De)||De==="+"||De==="/"||De==="-"||De==="_"}function fe(De){return q(De)||I(De)||De==="+"||De==="/"}function ye(De,U){var X=Object.keys(De);if(Object.getOwnPropertySymbols){var oe=Object.getOwnPropertySymbols(De);U&&(oe=oe.filter(function(xe){return Object.getOwnPropertyDescriptor(De,xe).enumerable})),X.push.apply(X,oe)}return X}function Ee(De){for(var U=1;U<arguments.length;U++){var X=arguments[U]!=null?arguments[U]:{};U%2?ye(Object(X),!0).forEach(function(oe){Ae(De,oe,X[oe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(De,Object.getOwnPropertyDescriptors(X)):ye(Object(X)).forEach(function(oe){Object.defineProperty(De,oe,Object.getOwnPropertyDescriptor(X,oe))})}return De}function Ae(De,U,X){return U in De?Object.defineProperty(De,U,{value:X,enumerable:!0,configurable:!0,writable:!0}):De[U]=X,De}(function(De){De.VERSION="v",De.ORIGIN="o",De.SESSION_NAME="s",De.INFORMATION="i",De.URI="u",De.EMAIL="e",De.PHONE="p",De.CONNECTION="c",De.BANDWIDTH="b",De.TIME="t",De.REPEAT="r",De.ZONE_ADJUSTMENTS="z",De.KEY="k",De.ATTRIBUTE="a",De.MEDIA="m"})(C||(C={}));class Ne{consumeText(U,X){let oe=X;for(;oe<U.length;){const xe=U[oe];if(xe==="\0"||xe==="\r"||xe===v)break;oe+=1}if(oe-X==0)throw new Error("Invalid text, at ".concat(U));return oe}consumeUnicastAddress(U,X,oe){return this.consumeTill(U,X,y)}consumeOneOrMore(U,X,oe){let xe=X;for(;oe(U[xe]);)xe++;if(xe-X==0)throw new Error("Invalid rule at ".concat(X,"."));return xe}consumeSpace(U,X){if(U[X]===y)return X+1;throw new Error("Invalid space at ".concat(X,"."))}consumeIP4Address(U,X){let oe=X;for(let xe=0;xe<4;xe++)if(oe=this.consumeDecimalUChar(U,oe),xe!==3){if(U[oe]!==".")throw new Error("Invalid IP4 address.");oe++}return oe}consumeDecimalUChar(U,X){let oe=X;for(let ft=0;ft<3&&I(U[oe]);ft++,oe++);if(oe-X==0)throw new Error("Invalid decimal uchar.");const xe=parseInt(U.slice(X,oe));if(xe>=0&&xe<=255)return oe;throw new Error("Invalid decimal uchar")}consumeIP6Address(U,X){let oe=this.consumeHexpart(U,X);return U[oe]===":"&&(oe+=1,oe=this.consumeIP4Address(U,oe)),oe}consumeHexpart(U,X){let oe=X;if(U[oe]===":"&&U[oe+1]===":"){oe+=2;try{oe=this.consumeHexseq(U,oe)}catch{}return oe}if(oe=this.consumeHexseq(U,oe),U[oe]===":"&&U[oe+1]===":"){oe+=2;try{oe=this.consumeHexseq(U,oe)}catch{}return oe}return oe}consumeHexseq(U,X){let oe=X;for(;oe=this.consumeHex4(U,oe),U[oe]===":"&&U[oe+1]!==":";)oe+=1;return oe}consumeHex4(U,X){let oe=0;for(;oe<4;oe++)if(!((xe=U[X+oe])>="0"&&xe<="9"||xe>="a"&&xe<="f"||xe>="A"&&xe<="F")){if(oe===0)throw new Error("Invalid hex 4");break}var xe;return X+oe}consumeFQDN(U,X){let oe=X;for(;I(U[oe])||q(U[oe])||U[oe]==="-"||U[oe]===".";)oe+=1;if(oe-X<4)throw new Error("Invalid FQDN");return oe}consumeExtnAddr(U,X){return this.consumeOneOrMore(U,X,G)}consumeMulticastAddress(U,X,oe){switch(oe){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(U,X);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(U,X);default:try{return this.consumeFQDN(U,X)}catch{return this.consumeExtnAddr(U,X)}}}consumeIP6MulticastAddress(U,X){const oe=this.consumeHexpart(U,X);return U[oe]==="/"?this.consumeInteger(U,oe+1):oe}consumeIP4MulticastAddress(U,X){let oe=X+3;const xe=U.slice(X,oe),ft=parseInt(xe);if(ft<224||ft>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let _n=0;_n<3;_n++){if(U[oe]!==".")throw new Error("Invalid IP4 multicast address.");oe+=1,oe=this.consumeDecimalUChar(U,oe)}return U[oe]==="/"&&(oe+=1),oe=this.consumeTTL(U,oe),U[oe]==="/"&&(oe=this.consumeInteger(U,oe)),oe}consumeInteger(U,X){if(!j(U[X]))throw new Error("Invalid integer.");for(X+=1;I(U[X]);)X+=1;return X}consumeTTL(U,X){if(U[X]==="0")return X+1;if(!j(U[X]))throw new Error("Invalid TTL.");X+=1;for(let oe=0;oe<2&&I(U[X]);oe++)X+=1;return X}consumeToken(U,X){return this.consumeOneOrMore(U,X,B)}consumeTime(U,X){let oe=X;if(U[oe]==="0")return oe+1;for(j(U[oe])&&(oe+=1);I(U[oe]);)oe++;if(oe-X<10)throw new Error("Invalid time");return oe}consumeAddress(U,X){return this.consumeTill(U,X,y)}consumeTypedTime(U,X){let oe=X;return oe=this.consumeOneOrMore(U,oe,I),Z(U[oe])?oe+1:oe}consumeRepeatInterval(U,X){if(!j(U[X]))throw new Error("Invalid repeat interval");for(X+=1;I(U[X]);)X+=1;return Z(U[X])&&(X+=1),X}consumePort(U,X){return this.consumeOneOrMore(U,X,I)}consume(U,X,oe){for(let xe=0;xe<oe.length;xe++){if(X+xe>=U.length)throw new Error("consume exceeding value length");if(U[X+xe]!==oe[xe])throw new Error("consume ".concat(oe," failed at ").concat(xe))}return X+oe.length}consumeTill(U,X,oe){let xe=X;for(;xe<U.length&&(typeof oe!="string"||U[xe]!==oe)&&(typeof oe!="function"||!oe(U[xe]));)xe++;return xe}}class it extends Ne{constructor(){super(),Ae(this,"records",[]),Ae(this,"currentLine",0)}parse(U){const X=this.probeEOL(U);this.records=U.split(X).filter(_r=>!!_r.trim()).map(this.parseLine),this.currentLine=0;const oe=this.parseVersion(),xe=this.parseOrigin(),ft=this.parseSessionName(),_n=this.parseInformation(),hi=this.parseUri(),Mo=this.parseEmail(),cl=this.parsePhone(),IE=this.parseConnection(),AE=this.parseBandWidth(),Da=this.parseTimeFields(),Eu=this.parseKey(),hp=this.parseSessionAttribute(),Jn=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:oe,origin:xe,sessionName:ft,information:_n,uri:hi,emails:Mo,phones:cl,connection:IE,bandwidths:AE,timeFields:Da,key:Eu,attributes:hp,mediaDescriptions:Jn}}getCurrentRecord(){const U=this.records[this.currentLine];if(!U)throw new Error("Record doesn't exit.");return U}probeEOL(U){for(let X=0;X<U.length;X++)if(U[X]===v)return U[X-1]==="\r"?E:v;throw new Error("Invalid newline character.")}parseLine(U,X){if(U.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const oe=U[0];if(U[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:oe,value:U.slice(2),line:X,cur:0}}parseSessionAttribute(){const U=new gn;for(;this.currentLine<this.records.length;){const X=this.getCurrentRecord();if(X.type!==C.ATTRIBUTE)break;const oe={attField:this.extractOneOrMore(X,xe=>B(xe)&&xe!==":"),_cur:0};X.value[X.cur]===":"&&(X.cur+=1,oe.attValue=this.extractOneOrMore(X,re)),U.parse(oe),this.currentLine++}return U.digest()}parseMediaAttributes(U){const X=new Er(U);for(;this.currentLine<this.records.length;){const oe=this.getCurrentRecord();if(oe.type!==C.ATTRIBUTE)break;const xe={attField:this.extractOneOrMore(oe,ft=>B(ft)&&ft!==":"),_cur:0};oe.value[oe.cur]===":"&&(oe.cur+=1,xe.attValue=this.extractOneOrMore(oe,re)),X.parse(xe),this.currentLine++}return X.digest()}parseKey(){const U=this.getCurrentRecord();if(U.type===C.KEY){if(U.value==="prompt"||U.value==="clear:"||U.value==="base64:"||U.value==="uri:")return U.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const U=this.getCurrentRecord();if(U.type===C.ZONE_ADJUSTMENTS){const X=[];for(;;)try{const oe=this.extract(U,this.consumeTime);this.consumeSpaceForRecord(U);let xe=!1;U.value[U.cur]==="-"&&(xe=!0,U.cur+=1);const ft=this.extract(U,this.consumeTypedTime);X.push({time:oe,typedTime:ft,back:xe})}catch{break}if(X.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,X}return[]}parseRepeat(){const U=[];for(;;){const X=this.getCurrentRecord();if(X.type!==C.REPEAT)break;{const oe=this.extract(X,this.consumeRepeatInterval),xe=this.parseTypedTime(X);U.push({repeatInterval:oe,typedTimes:xe}),this.currentLine++}}return U}parseTypedTime(U){const X=[];for(;;)try{this.consumeSpaceForRecord(U),X.push(this.extract(U,this.consumeTypedTime))}catch{break}if(X.length===0)throw new Error("Invalid typed time.");return X}parseTime(){const U=this.getCurrentRecord(),X=this.extract(U,this.consumeTime);this.consumeSpaceForRecord(U);const oe=this.extract(U,this.consumeTime);return this.currentLine++,{startTime:X,stopTime:oe}}parseBandWidth(){const U=[];for(;this.currentLine<this.records.length;){const X=this.getCurrentRecord();if(X.type!==C.BANDWIDTH)break;{const oe=this.extractOneOrMore(X,B);if(X.value[X.cur]!==":")throw new Error("Invalid bandwidth field.");X.cur++;const xe=this.extractOneOrMore(X,I);U.push({bwtype:oe,bandwidth:xe}),this.currentLine++}}return U}parseVersion(){const U=this.getCurrentRecord();if(U.type!==C.VERSION)throw new Error("first sdp record must be version");const X=U.value.slice(0,this.consumeOneOrMore(U.value,0,I));if(X.length!==U.value.length)throw new Error('invalid proto version, "v='.concat(U.value,'"'));return this.currentLine++,X}parseOrigin(){const U=this.getCurrentRecord();if(U.type!==C.ORIGIN)throw new Error("second line of sdp must be origin");const X=this.extractOneOrMore(U,G);this.consumeSpaceForRecord(U);const oe=this.extractOneOrMore(U,I);this.consumeSpaceForRecord(U);const xe=this.extractOneOrMore(U,I);this.consumeSpaceForRecord(U);const ft=this.extractOneOrMore(U,B);this.consumeSpaceForRecord(U);const _n=this.extractOneOrMore(U,B);this.consumeSpaceForRecord(U);const hi=this.extract(U,this.consumeUnicastAddress);return this.currentLine++,{username:X,sessId:oe,sessVersion:xe,nettype:ft,addrtype:_n,unicastAddress:hi}}parseSessionName(){const U=this.getCurrentRecord();if(U.type===C.SESSION_NAME){const X=this.extract(U,this.consumeText);return this.currentLine++,X}}parseInformation(){const U=this.getCurrentRecord();if(U.type!==C.INFORMATION)return;const X=this.extract(U,this.consumeText);return this.currentLine++,X}parseUri(){const U=this.getCurrentRecord();if(U.type===C.URI)return this.currentLine++,U.value}parseEmail(){const U=[];for(;;){const X=this.getCurrentRecord();if(X.type!==C.EMAIL)break;U.push(X.value),this.currentLine++}return U}parsePhone(){const U=[];for(;;){const X=this.getCurrentRecord();if(X.type!==C.PHONE)break;U.push(X.value),this.currentLine++}return U}parseConnection(){const U=this.getCurrentRecord();if(U.type===C.CONNECTION){const X=this.extractOneOrMore(U,B);this.consumeSpaceForRecord(U);const oe=this.extractOneOrMore(U,B);this.consumeSpaceForRecord(U);const xe=this.extract(U,this.consumeAddress);return this.currentLine++,{nettype:X,addrtype:oe,address:xe}}}parseMedia(){const U=this.getCurrentRecord(),X=this.extract(U,this.consumeToken);this.consumeSpaceForRecord(U);let oe=this.extract(U,this.consumePort);U.value[U.cur]==="/"&&(U.cur+=1,oe+=this.extract(U,this.consumeInteger)),this.consumeSpaceForRecord(U);const xe=[];for(xe.push(this.extract(U,this.consumeToken));U.value[U.cur]==="/";)U.cur+=1,xe.push(this.extract(U,this.consumeToken));if(xe.length===0)throw new Error("Invalid proto");const ft=this.parseFmt(U);return this.currentLine++,{mediaType:X,port:oe,protos:xe,fmts:ft}}parseTimeFields(){const U=[];for(;this.getCurrentRecord().type===C.TIME;){const X=this.parseTime(),oe=this.parseRepeat(),xe=this.parseZone();U.push({time:X,repeats:oe,zones:xe})}return U}parseMediaDescription(){const U=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===C.MEDIA;){const X=this.parseMedia(),oe=this.parseInformation(),xe=this.parseConnections(),ft=this.parseBandWidth(),_n=this.parseKey(),hi=this.parseMediaAttributes(X);U.push({media:X,information:oe,connections:xe,bandwidths:ft,key:_n,attributes:hi})}return U}parseConnections(){const U=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===C.CONNECTION;)U.push(this.parseConnection());return U}parseFmt(U){const X=[];for(;;)try{this.consumeSpaceForRecord(U),X.push(this.extract(U,this.consumeToken))}catch{break}if(X.length===0)throw new Error("Invalid fmts");return X}extract(U,X,...oe){const xe=X.call(this,U.value,U.cur,...oe),ft=U.value.slice(U.cur,xe);return U.cur=xe,ft}extractOneOrMore(U,X){const oe=this.consumeOneOrMore(U.value,U.cur,X),xe=U.value.slice(U.cur,oe);return U.cur=oe,xe}consumeSpaceForRecord(U){if(U.value[U.cur]!==y)throw new Error("Invalid space at ".concat(U.cur,"."));U.cur+=1}}class yt extends Ne{constructor(...U){super(...U),Ae(this,"attributes",void 0),Ae(this,"digested",!1)}extractOneOrMore(U,X,oe){const xe=this.consumeOneOrMore(U.attValue,U._cur,X),ft=U.attValue.slice(U._cur,xe),[_n,hi]=oe||[];if(typeof _n=="number"&&ft.length<_n)throw new Error("error in length, should be more or equal than ".concat(_n," characters."));if(typeof hi=="number"&&ft.length>hi)throw new Error("error in length, should be less or equal than ".concat(hi," characters."));return U._cur=xe,ft}consumeAttributeSpace(U){if(U.attValue[U._cur]!==y)throw new Error("Invalid space at ".concat(U._cur,"."));U._cur+=1}extract(U,X,...oe){if(!U.attValue)throw new Error("Nothing to extract from attValue.");const xe=X.call(this,U.attValue,U._cur,...oe),ft=U.attValue.slice(U._cur,xe);return U._cur=xe,ft}atEnd(U){if(!U.attValue)throw new Error;return U._cur>=U.attValue.length}peekChar(U){if(!U.attValue)throw new Error;return U.attValue[U._cur]}peek(U,X){if(!U.attValue)throw new Error;for(let oe=0;oe<X.length;oe++)if(X[oe]!==U.attValue[U._cur+oe])return!1;return!0}parseIceUfrag(U){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(U,Ce,[4,256])}parseIcePwd(U){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(U,Ce,[22,256])}parseIceOptions(U){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const X=[];for(;!this.atEnd(U);){X.push(this.extractOneOrMore(U,Ce));try{this.consumeAttributeSpace(U)}catch(oe){if(this.atEnd(U))break;throw oe}}this.attributes.iceOptions=X}parseFingerprint(U){const X=this.extract(U,this.consumeToken);this.consumeAttributeSpace(U);const oe=this.extract(U,this.consumeTill);this.attributes.fingerprints.push({hashFunction:X,fingerprint:oe})}parseExtmap(U){const X=this.extractOneOrMore(U,I);let oe;this.peekChar(U)==="/"&&(this.extract(U,this.consume,"/"),oe=this.extract(U,this.consumeToken)),this.consumeAttributeSpace(U);const xe=this.extract(U,this.consumeTill,y),ft=Ee(Ee({entry:parseInt(X,10)},oe&&{direction:oe}),{},{extensionName:xe});this.peekChar(U)===y&&(this.consumeAttributeSpace(U),ft.extensionAttributes=this.extract(U,this.consumeTill)),this.attributes.extmaps.push(ft)}parseSetup(U){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const X=this.extract(U,this.consumeTill);if(X!=="active"&&X!=="passive"&&X!=="actpass"&&X!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=X}}class gn extends yt{constructor(...U){super(...U),Ae(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(U){if(this.digested)throw new Error("already digested");try{switch(U.attField){case"group":this.parseGroup(U);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(U);break;case"ice-pwd":this.parseIcePwd(U);break;case"ice-options":this.parseIceOptions(U);break;case"fingerprint":this.parseFingerprint(U);break;case"setup":this.parseSetup(U);break;case"tls-id":this.parseTlsId(U);break;case"identity":this.parseIdentity(U);break;case"extmap":this.parseExtmap(U);break;case"msid-semantic":this.parseMsidSemantic(U);break;default:U.ignored=!0,this.attributes.unrecognized.push(U)}}catch(X){throw console.error("parsing session attribute ".concat(U.attField,' error, "a=').concat(U.attField,":").concat(U.attValue,'"')),X}if(!U.ignored&&U.attValue&&!this.atEnd(U))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(U){const X=this.extract(U,this.consumeToken),oe=[];for(;!this.atEnd(U)&&this.peekChar(U)===y;)this.consumeAttributeSpace(U),oe.push(this.extract(U,this.consumeToken));this.attributes.groups.push({semantic:X,identificationTag:oe})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(U){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(U,pe)}parseIdentity(U){const X=this.extractOneOrMore(U,fe),oe=[];for(;!this.atEnd(U)&&this.peekChar(U)===y;){this.consumeAttributeSpace(U);const xe=this.extract(U,this.consumeToken);this.extract(U,this.consume,"=");const ft=this.extractOneOrMore(U,_n=>_n!==y&&re(_n));oe.push({name:xe,value:ft})}this.attributes.identities.push({assertionValue:X,extensions:oe})}parseMsidSemantic(U){this.peekChar(U)===y&&this.consumeAttributeSpace(U);const X={semantic:this.extract(U,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(U)}catch{break}if(this.peekChar(U)==="*"){this.extract(U,this.consume,"*"),X.applyForAll=!0;break}{const oe=this.extract(U,this.consumeTill,y);X.identifierList.push(oe)}}this.attributes.msidSemantic=X}}class Er extends yt{constructor(U){super(),Ae(this,"attributes",void 0),U.protos.indexOf("RTP")!==-1||U.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(U){if(this.digested)throw new Error("already digested");try{switch(U.attField){case"extmap":this.parseExtmap(U);break;case"setup":this.parseSetup(U);break;case"ice-ufrag":this.parseIceUfrag(U);break;case"ice-pwd":this.parseIcePwd(U);break;case"ice-options":this.parseIceOptions(U);break;case"candidate":this.parseCandidate(U);break;case"remote-candidate":this.parseRemoteCandidate(U);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(U);break;case"rtpmap":this.parseRtpmap(U);break;case"ptime":this.parsePtime(U);break;case"maxptime":this.parseMaxPtime(U);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(U);break;case"ssrc":this.parseSSRC(U);break;case"fmtp":this.parseFmtp(U);break;case"rtcp-fb":this.parseRtcpFb(U);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(U);break;case"mid":this.parseMid(U);break;case"msid":this.parseMsid(U);break;case"imageattr":this.parseImageAttr(U);break;case"rid":this.parseRid(U);break;case"simulcast":this.parseSimulcast(U);break;case"sctp-port":this.parseSctpPort(U);break;case"max-message-size":this.parseMaxMessageSize(U);break;case"ssrc-group":this.parseSSRCGroup(U);break;default:U.ignored=!0,this.attributes.unrecognized.push(U)}}catch(X){throw console.error("parsing media attribute ".concat(U.attField,' error, "a=').concat(U.attField,":").concat(U.attValue,'"')),X}if(!U.ignored&&U.attValue&&!this.atEnd(U))throw new Error("attribute parsing error")}parseCandidate(U){const X=this.extractOneOrMore(U,Ce,[1,32]);this.consumeAttributeSpace(U);const oe=this.extractOneOrMore(U,I,[1,5]);this.consumeAttributeSpace(U);const xe=this.extract(U,this.consumeToken);this.consumeAttributeSpace(U);const ft=this.extractOneOrMore(U,I,[1,10]);this.consumeAttributeSpace(U);const _n=this.extract(U,this.consumeAddress);this.consumeAttributeSpace(U);const hi=this.extract(U,this.consumePort);this.consumeAttributeSpace(U),this.extract(U,this.consume,"typ"),this.consumeAttributeSpace(U);const Mo={foundation:X,componentId:oe,transport:xe,priority:ft,connectionAddress:_n,port:hi,type:this.extract(U,this.consumeToken),extension:{}};for(this.peek(U," raddr")&&(this.extract(U,this.consume," raddr"),this.consumeAttributeSpace(U),Mo.relAddr=this.extract(U,this.consumeAddress)),this.peek(U," rport")&&(this.extract(U,this.consume," rport"),this.consumeAttributeSpace(U),Mo.relPort=this.extract(U,this.consumePort));this.peekChar(U)===y;){this.consumeAttributeSpace(U);const cl=this.extract(U,this.consumeToken);this.consumeAttributeSpace(U),Mo.extension[cl]=this.extractOneOrMore(U,k)}this.attributes.candidates.push(Mo)}parseRemoteCandidate(U){const X=[];for(;;){const oe=this.extractOneOrMore(U,I,[1,5]);this.consumeAttributeSpace(U);const xe=this.extract(U,this.consumeAddress);this.consumeAttributeSpace(U);const ft=this.extract(U,this.consumePort);X.push({componentId:oe,connectionAddress:xe,port:ft});try{this.consumeAttributeSpace(U)}catch{break}}this.attributes.remoteCandidatesList.push(X)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(U){const X=this.extract(U,this.consumeToken);this.consumeAttributeSpace(U);const oe=this.extract(U,this.consumeTill,"/");this.extract(U,this.consume,"/");const xe={encodingName:oe,clockRate:this.extractOneOrMore(U,I)};this.atEnd(U)||this.peekChar(U)!=="/"||(this.extract(U,this.consume,"/"),xe.encodingParameters=parseInt(this.extract(U,this.consumeTill),10));const ft=this.attributes.payloads.find(_n=>_n.payloadType===parseInt(X,10));ft?ft.rtpMap=xe:this.attributes.payloads.push({payloadType:parseInt(X,10),rtpMap:xe,rtcpFeedbacks:[]})}parsePtime(U){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(U,this.consumeTill)}parseMaxPtime(U){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(U,this.consumeTill)}parseDirection(U){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=U.attField}parseSSRC(U){const X=this.extractOneOrMore(U,I);this.consumeAttributeSpace(U);const oe=this.extract(U,this.consumeTill,":");let xe;this.peekChar(U)===":"&&(this.extract(U,this.consume,":"),xe=this.extract(U,this.consumeTill));const ft=this.attributes.ssrcs.find(_n=>_n.ssrcId===parseInt(X,10));ft?ft.attributes[oe]=xe:this.attributes.ssrcs.push({ssrcId:parseInt(X,10),attributes:{[oe]:xe}})}parseFmtp(U){const X=this.extract(U,this.consumeTill,y);this.consumeAttributeSpace(U);const oe=this.extract(U,this.consumeTill),xe={};oe.split(";").forEach(_n=>{let[hi,Mo]=_n.split("=");hi=hi.trim();const cl=typeof Mo=="string"?Mo.trim():null;typeof hi=="string"&&hi.length>0&&(xe[hi]=cl)});const ft=this.attributes.payloads.find(_n=>_n.payloadType===parseInt(X,10));ft?ft.fmtp={parameters:xe}:this.attributes.payloads.push({payloadType:parseInt(X,10),rtcpFeedbacks:[],fmtp:{parameters:xe}})}parseFmtParameters(U){const X={},oe=this.extract(U,this.consumeTill,"=");U._cur++;const xe=this.extract(U,this.consumeTill,";");for(X[oe]=xe;U.attValue[U._cur]===";";){const ft=this.extract(U,this.consumeTill,"=");U._cur++;const _n=this.extract(U,this.consumeTill,";");X[ft]=_n}return X}parseRtcpFb(U){let X="";X=this.peekChar(U)==="*"?this.extract(U,this.consume,"*"):this.extract(U,this.consumeTill,y),this.consumeAttributeSpace(U);const oe=this.extract(U,this.consumeTill,y);let xe;if(oe==="trr-int")xe={type:oe,interval:this.extract(U,this.consumeTill)};else{const ft={type:oe};this.peekChar(U)===y&&(this.consumeAttributeSpace(U),ft.parameter=this.extract(U,this.consumeToken),this.peekChar(U)===y&&(ft.additional=this.extract(U,this.consumeTill))),xe=ft}if(X==="*")this.attributes.rtcpFeedbackWildcards.push(xe);else{const ft=this.attributes.payloads.find(_n=>_n.payloadType===parseInt(X,10));ft?ft.rtcpFeedbacks.push(xe):this.attributes.payloads.push({payloadType:parseInt(X,10),rtcpFeedbacks:[xe]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(U){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const X={port:this.extract(U,this.consumePort)};this.peekChar(U)===y&&(this.consumeAttributeSpace(U),X.netType=this.extractOneOrMore(U,B),this.consumeAttributeSpace(U),X.addressType=this.extractOneOrMore(U,B),this.consumeAttributeSpace(U),X.address=this.extract(U,this.consumeAddress)),this.attributes.rtcp=X}parseMsid(U){const X={id:this.extractOneOrMore(U,B,[1,64])};this.peekChar(U)===y&&(this.consumeAttributeSpace(U),X.appdata=this.extractOneOrMore(U,B,[1,64])),this.attributes.msids.push(X)}parseImageAttr(U){this.attributes.imageattr.push(U.attValue)}parseRid(U){const X=this.extractOneOrMore(U,xe=>q(xe)||I(xe)||xe==="_"||xe==="-");this.consumeAttributeSpace(U);const oe={id:X,direction:this.extract(U,this.consumeToken),params:[]};if(this.peekChar(U)===y){if(this.consumeAttributeSpace(U),this.peek(U,"pt=")){this.extract(U,this.consume,"pt=");const xe=[];for(;;){const ft=this.extract(U,this.consumeToken);xe.push(ft);try{this.extract(U,this.consume,",")}catch{break}}oe.payloads=xe,this.peekChar(U)===y&&this.extract(U,this.consume,y)}for(;;){const xe=this.extract(U,this.consumeToken);switch(xe){case"depend":{const ft={type:xe,rids:this.extract(U,this.consume,"=").split(",")};oe.params.push(ft);break}default:{const ft={type:xe};this.peekChar(U)==="="&&(this.extract(U,this.consume,"="),ft.val=this.extract(U,this.consumeTill,";")),oe.params.push(ft)}}try{this.extract(U,this.consume,";")}catch{break}}}this.attributes.rids.push(oe)}parseSimulcast(U){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=U.attValue,this.extract(U,this.consumeTill)}parseSctpPort(U){this.attributes.sctpPort=this.extractOneOrMore(U,I,[1,5])}parseMaxMessageSize(U){this.attributes.maxMessageSize=this.extractOneOrMore(U,I,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(U){this.attributes.mid=this.extract(U,this.consumeToken)}parseSSRCGroup(U){const X=this.extract(U,this.consumeToken),oe=[];for(;;)try{this.consumeAttributeSpace(U);const xe=this.extract(U,this.consumeInteger);oe.push(parseInt(xe,10))}catch{break}this.attributes.ssrcGroups.push({semantic:X,ssrcIds:oe})}}function Sn(De,U,X){return U in De?Object.defineProperty(De,U,{value:X,enumerable:!0,configurable:!0,writable:!0}):De[U]=X,De}class Lo{constructor(){Sn(this,"eol",E)}print(U,X){let oe="";return X&&(this.eol=X),oe+=this.printVersion(U.version),oe+=this.printOrigin(U.origin),oe+=this.printSessionName(U.sessionName),oe+=this.printInformation(U.information),oe+=this.printUri(U.uri),oe+=this.printEmail(U.emails),oe+=this.printPhone(U.phones),oe+=this.printConnection(U.connection),oe+=this.printBandwidth(U.bandwidths),oe+=this.printTimeFields(U.timeFields),oe+=this.printKey(U.key),oe+=this.printSessionAttributes(U.attributes),oe+=this.printMediaDescription(U.mediaDescriptions),oe}printVersion(U){return"v=".concat(U).concat(this.eol)}printOrigin(U){return"o=".concat(U.username," ").concat(U.sessId," ").concat(U.sessVersion," ").concat(U.nettype," ").concat(U.addrtype," ").concat(U.unicastAddress).concat(this.eol)}printSessionName(U){return U?"s=".concat(U).concat(this.eol):""}printInformation(U){return U?"i=".concat(U).concat(this.eol):""}printUri(U){return U?"u=".concat(U).concat(this.eol):""}printEmail(U){let X="";for(const oe of U)X+="e=".concat(oe).concat(this.eol);return X}printPhone(U){let X="";for(const oe of U)X+="e=".concat(oe).concat(this.eol);return X}printConnection(U){return U?"c=".concat(U.nettype," ").concat(U.addrtype," ").concat(U.address).concat(this.eol):""}printBandwidth(U){let X="";for(const oe of U)X+="b=".concat(oe.bwtype,":").concat(oe.bandwidth).concat(this.eol);return X}printTimeFields(U){let X="";for(const oe of U){X+="t=".concat(oe.time.startTime," ").concat(oe.time.startTime).concat(this.eol);for(const xe of oe.repeats)X+="r=".concat(xe.repeatInterval," ").concat(xe.typedTimes.join(" ")).concat(this.eol);oe.zoneAdjustments&&(X+="z=",X+="z=".concat(oe.zoneAdjustments.map(xe=>"".concat(xe.time," ").concat(xe.back?"-":""," ").concat(xe.typedTime)).join(" ")).concat(this.eol),X+=this.eol)}return X}printKey(U){return U?"k=".concat(U).concat(this.eol):""}printAttributes(U){let X="";for(const oe of U)X+="a=".concat(oe.attField).concat(oe.attValue?":".concat(oe.attValue):"").concat(this.eol);return X}printMediaDescription(U){let X="";for(const oe of U)X+=this.printMedia(oe.media),X+=this.printInformation(oe.information),X+=this.printConnections(oe.connections),X+=this.printBandwidth(oe.bandwidths),X+=this.printKey(oe.key),X+=this.printMediaAttributes(oe);return X}printConnections(U){let X="";for(const oe of U)X+=this.printConnection(oe);return X}printMedia(U){return"m=".concat(U.mediaType," ").concat(U.port," ").concat(U.protos.join("/")," ").concat(U.fmts.join(" ")).concat(this.eol)}printSessionAttributes(U){return new Pe(this.eol).print(U)}printMediaAttributes(U){return new Ue(this.eol).print(U)}}class we{constructor(U){Sn(this,"eol",void 0),this.eol=U}printIceUfrag(U){return U===void 0?"":"a=ice-ufrag:".concat(U).concat(this.eol)}printIcePwd(U){return U===void 0?"":"a=ice-pwd:".concat(U).concat(this.eol)}printIceOptions(U){return U===void 0?"":"a=ice-options:".concat(U.join(y)).concat(this.eol)}printFingerprints(U){return U.length>0?U.map(X=>"a=fingerprint:".concat(X.hashFunction).concat(y).concat(X.fingerprint)).join(this.eol)+this.eol:""}printExtmap(U){return U.map(X=>"a=extmap:".concat(X.entry).concat(X.direction?"/".concat(X.direction):"").concat(y).concat(X.extensionName).concat(X.extensionAttributes?"".concat(y).concat(X.extensionAttributes):"").concat(this.eol)).join("")}printSetup(U){return U===void 0?"":"a=setup:".concat(U).concat(this.eol)}printUnrecognized(U){return U.map(X=>"a=".concat(X.attField).concat(X.attValue?":".concat(X.attValue):"").concat(this.eol)).join("")}}class Pe extends we{print(U){let X="";return X+=this.printGroups(U.groups),X+=this.printMsidSemantic(U.msidSemantic),X+=this.printIceLite(U.iceLite),X+=this.printIceUfrag(U.iceUfrag),X+=this.printIcePwd(U.icePwd),X+=this.printIceOptions(U.iceOptions),X+=this.printFingerprints(U.fingerprints),X+=this.printSetup(U.setup),X+=this.printTlsId(U.tlsId),X+=this.printIdentity(U.identities),X+=this.printExtmap(U.extmaps),X+=this.printUnrecognized(U.unrecognized),X}printGroups(U){let X="";return U.length>0&&(X+=U.map(oe=>"a=group:".concat(oe.semantic).concat(oe.identificationTag.map(xe=>"".concat(y).concat(xe)).join("")).concat(this.eol)).join("")),X}printIceLite(U){return U===void 0?"":"a=ice-lite"+this.eol}printTlsId(U){return U?"a=tls-id:".concat(U).concat(this.eol):""}printIdentity(U){return U.length===0?"":U.map(X=>"a=identity:".concat(X.assertionValue).concat(X.extensions.map(oe=>"".concat(y).concat(oe.name).concat(oe.value?"=".concat(oe.value):"")))).join(this.eol)+this.eol}printMsidSemantic(U){if(!U)return"";let X="a=msid-semantic:".concat(U.semantic);return U.applyForAll?X+="".concat(y,"*"):U.identifierList.length>0&&(X+=U.identifierList.map(oe=>"".concat(y).concat(oe))),X+this.eol}}class Ue extends we{print(U){const X=U.attributes;let oe="";return oe+=this.printRTCP(X.rtcp),oe+=this.printIceUfrag(X.iceUfrag),oe+=this.printIcePwd(X.icePwd),oe+=this.printIceOptions(X.iceOptions),oe+=this.printCandidates(X.candidates),oe+=this.printRemoteCandidatesList(X.remoteCandidatesList),oe+=this.printEndOfCandidates(X.endOfCandidates),oe+=this.printFingerprints(X.fingerprints),oe+=this.printSetup(X.setup),oe+=this.printMid(X.mid),oe+=this.printExtmap(X.extmaps),oe+=this.printRTPRelated(X),oe+=this.printPtime(X.ptime),oe+=this.printMaxPtime(X.maxPtime),oe+=this.printDirection(X.direction),oe+=this.printSSRCGroups(X.ssrcGroups),oe+=this.printSSRC(X.ssrcs),oe+=this.printRTCPMux(X.rtcpMux),oe+=this.printRTCPMuxOnly(X.rtcpMuxOnly),oe+=this.printRTCPRsize(X.rtcpRsize),oe+=this.printMSId(X.msids),oe+=this.printImageattr(X.imageattr),oe+=this.printRid(X.rids),oe+=this.printSimulcast(X.simulcast),oe+=this.printSCTPPort(X.sctpPort),oe+=this.printMaxMessageSize(X.maxMessageSize),oe+=this.printUnrecognized(X.unrecognized),oe}printCandidates(U){return U.map(X=>"a=candidate:".concat(X.foundation).concat(y).concat(X.componentId).concat(y).concat(X.transport).concat(y).concat(X.priority).concat(y).concat(X.connectionAddress).concat(y).concat(X.port).concat(y,"typ").concat(y).concat(X.type).concat(X.relAddr?"".concat(y,"raddr").concat(y).concat(X.relAddr):"").concat(X.relPort?"".concat(y,"rport").concat(y).concat(X.relPort):"").concat(Object.keys(X.extension).map(oe=>"".concat(y).concat(oe).concat(y).concat(X.extension[oe])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(U){return U.map(X=>"a=remote-candidates:".concat(X.join(y)).concat(this.eol)).join("")}printEndOfCandidates(U){return U===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(U){if(!U.payloads)return"";const X=U.payloads;let oe="";oe+=U.rtcpFeedbackWildcards.map(xe=>this.printRTCPFeedback("*",xe)).join("");for(const xe of X)oe+=this.printRtpMap(xe.payloadType,xe.rtpMap),oe+=this.printFmtp(xe.payloadType,xe.fmtp),oe+=xe.rtcpFeedbacks.map(ft=>this.printRTCPFeedback(xe.payloadType,ft)).join("");return oe}printFmtp(U,X){if(!X)return"";const oe=Object.keys(X.parameters);return oe.length===1&&X.parameters[oe[0]]===null?"a=fmtp:".concat(U).concat(y).concat(oe[0]).concat(this.eol):"a=fmtp:".concat(U).concat(y).concat(Object.keys(X.parameters).map(xe=>"".concat(xe,"=").concat(X.parameters[xe])).join(";")).concat(this.eol)}printRtpMap(U,X){return X?"a=rtpmap:".concat(U).concat(y).concat(X.encodingName,"/").concat(X.clockRate).concat(X.encodingParameters?"/".concat(X.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(U,X){let oe="a=rtcp-fb:".concat(U).concat(y),xe=X;return xe.type==="trr-int"?oe+="ttr-int".concat(y).concat(xe.interval):(oe+="".concat(xe.type),xe.parameter&&(oe+="".concat(y).concat(xe.parameter),xe.additional&&(oe+="".concat(y).concat(xe.additional)))),oe+this.eol}printPtime(U){return U===void 0?"":"a=ptime:".concat(U).concat(this.eol)}printMaxPtime(U){return U===void 0?"":"a=maxptime:".concat(U).concat(this.eol)}printDirection(U){return U===void 0?"":"a=".concat(U).concat(this.eol)}printSSRC(U){return U.map(X=>Object.keys(X.attributes).map(oe=>"a=ssrc:".concat(X.ssrcId.toString(10)).concat(y).concat(oe).concat(X.attributes[oe]?":".concat(X.attributes[oe]):"").concat(this.eol)).join("")).join("")}printRTCPMux(U){return U===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(U){return U===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(U){return U===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(U){if(U===void 0)return"";let X="a=rtcp:".concat(U.port);return U.netType&&(X+="".concat(y).concat(U.netType)),U.addressType&&(X+="".concat(y).concat(U.addressType)),U.address&&(X+="".concat(y).concat(U.address)),X+this.eol}printMSId(U){return U.map(X=>"a=msid:".concat(X.id).concat(X.appdata?"".concat(y).concat(X.appdata):"").concat(this.eol)).join("")}printImageattr(U){return U.map(X=>"a=imageattr:".concat(X).concat(this.eol)).join("")}printRid(U){return U.map(X=>{let oe="a=rid:".concat(X.id).concat(y).concat(X.direction);return X.payloads&&(oe+="".concat(y,"pt=").concat(X.payloads.join(","))),X.params.length>0&&(oe+="".concat(y).concat(X.params.map(xe=>xe.type==="depend"?"depend=".concat(xe.rids.join(",")):"".concat(xe.type,"=").concat(xe.val)).join(";"))),oe+this.eol}).join("")}printSimulcast(U){return U===void 0?"":"a=simulcast:".concat(U).concat(this.eol)}printSCTPPort(U){return U===void 0?"":"a=sctp-port:".concat(U).concat(this.eol)}printMaxMessageSize(U){return U===void 0?"":"a=max-message-size:".concat(U).concat(this.eol)}printMid(U){return U===void 0?"":"a=mid:".concat(U).concat(this.eol)}printSSRCGroups(U){return U.map(X=>"a=ssrc-group:".concat(X.semantic).concat(X.ssrcIds.map(oe=>"".concat(y).concat(oe.toString(10))).join("")).concat(this.eol)).join("")}}function st(De){return new it().parse(De)}function Gt(De,U){return new Lo().print(De,U)}}},a={};function l(u){if(a[u])return a[u].exports;var h=a[u]={exports:{}};return n[u](h,h.exports,l),h.exports}return l.d=(u,h)=>{for(var p in h)l.o(h,p)&&!l.o(u,p)&&Object.defineProperty(u,p,{enumerable:!0,get:h[p]})},l.o=(u,h)=>Object.prototype.hasOwnProperty.call(u,h),l.r=u=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(u,"__esModule",{value:!0})},l(8)})()})(yU);var In=yU.exports;function ss(i){if(Array.isArray(i))return i.map(n=>n);if(!SU(i))return i;const t={};for(const n in i){const a=i[n];SU(a)||Array.isArray(a)?t[n]=ss(a):t[n]=a}return t}function SU(i){return!(typeof i!="object"||Array.isArray(i)||!i)}class NR{constructor(t){w(this,"input",[]),w(this,"size",void 0),this.size=t}add(t){this.input.push(t),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}}const Ic={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},P0={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:Ic,remoteCandidate:Ic}},CU={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0},bU={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},TU={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},RU={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0};function wU(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function IU(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wU(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):wU(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}class PR{constructor(t,n){w(this,"onFirstVideoReceived",void 0),w(this,"onFirstVideoDecoded",void 0),w(this,"onFirstAudioReceived",void 0),w(this,"onFirstVideoDecodedTimeout",void 0),w(this,"onFirstAudioDecoded",void 0),w(this,"onSelectedLocalCandidateChanged",void 0),w(this,"onSelectedRemoteCandidateChanged",void 0),w(this,"videoIsReady",!1),w(this,"videoIsReady2",{}),w(this,"pc",void 0),w(this,"options",void 0),w(this,"intervalTimer",void 0),w(this,"stats",ss(P0)),w(this,"isFirstVideoReceived",{}),w(this,"isFirstVideoDecoded",{}),w(this,"isFirstAudioReceived",{}),w(this,"isFirstAudioDecoded",{}),w(this,"isFirstVideoDecodedTimeout",{}),w(this,"lossRateWindowStats",[]),this.pc=t,this.options=n,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new _e(t=>{t({local:IU({},Ic),remote:IU({},Ic)})})}setVideoIsReady(t){this.videoIsReady=t}setVideoIsReady2(t,n){this.videoIsReady2[t]=n}getVideoIsReady(t){return this.videoIsReady2[t]||!1}setIsFirstAudioDecoded(t){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(t){this.lossRateWindowStats.push(t),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const n=this.lossRateWindowStats.length,a=["videoSend","audioSend","videoRecv","audioRecv"];let l=0,u=0,h=0,p=0;for(const v of a)t[v].forEach((E,y)=>{if(!this.lossRateWindowStats[n-1][v][y]||!this.lossRateWindowStats[0][v][y])return;const C=this.lossRateWindowStats[n-1][v][y].packets-this.lossRateWindowStats[0][v][y].packets,I=this.lossRateWindowStats[n-1][v][y].packetsLost-this.lossRateWindowStats[0][v][y].packetsLost;v==="videoSend"||v==="audioSend"?(l+=C,h+=I):(u+=C,p+=I),Number.isNaN(C)||Number.isNaN(C)?E.packetLostRate=0:E.packetLostRate=C<=0||I<=0?0:I/(C+I)});t.sendPacketLossRate=l<=0||h<=0?0:h/(l+h),t.recvPacketLossRate=u<=0||p<=0?0:p/(u+p)}}function AU(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function Vne(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?AU(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):AU(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}class $ne extends PR{constructor(){super(...arguments),w(this,"_stats",P0),w(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const t=await this._getStats(),n=this.statsResponsesToObjects(t);this._stats=ss(P0);const a=n.filter(u=>u.type==="ssrc");this.processSSRCStats(a);const l=n.find(u=>u.type==="VideoBwe");l&&this.processBandwidthStats(l),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(t){this._stats.bitrate={actualEncoded:Number(t.googActualEncBitrate),targetEncoded:Number(t.googTargetEncBitrate),retransmit:Number(t.googRetransmitBitrate),transmit:Number(t.googTransmitBitrate)},this._stats.sendBandwidth=Number(t.googAvailableSendBandwidth)}processSSRCStats(t){t.forEach(n=>{var a;const l=Be(a=n.id).call(a,"send");switch("".concat(n.mediaType,"_").concat(l?"send":"recv")){case"video_send":{const u=ss(bU);u.codec=n.googCodecName,u.adaptionChangeReason="none",n.googCpuLimitedResolution&&(u.adaptionChangeReason="cpu"),n.googBandwidthLimitedResolution&&(u.adaptionChangeReason="bandwidth"),u.avgEncodeMs=Number(n.googAvgEncodeMs),u.inputFrame={width:Number(n.googFrameWidthInput)||Number(n.googFrameWidthSent),height:Number(n.googFrameHeightInput)||Number(n.googFrameHeightSent),frameRate:Number(n.googFrameRateInput)},u.sentFrame={width:Number(n.googFrameWidthSent),height:Number(n.googFrameHeightSent),frameRate:Number(n.googFrameRateInput)},u.firsCount=Number(n.googFirReceived),u.nacksCount=Number(n.googNacksReceived),u.plisCount=Number(n.googPlisReceived),u.frameCount=Number(n.framesEncoded),u.bytes=Number(n.bytesSent),u.packets=Number(n.packetsSent),u.packetsLost=Number(n.packetsLost),u.ssrc=Number(n.ssrc),u.rttMs=Number(n.googRtt||0),this._stats.videoSend.push(u),this._stats.rtt=u.rttMs;break}case"video_recv":{const u=ss(CU),h=this.lastDecodeVideoReceiverStats.get(Number(n.ssrc));if(u.codec=n.googCodecName,u.targetDelayMs=Number(n.googTargetDelayMs),u.renderDelayMs=Number(n.googRenderDelayMs),u.currentDelayMs=Number(n.googCurrentDelayMs),u.minPlayoutDelayMs=Number(n.googMinPlayoutDelayMs),u.decodeMs=Number(n.googDecodeMs),u.maxDecodeMs=Number(n.googMaxDecodeMs),u.receivedFrame={width:Number(n.googFrameWidthReceived),height:Number(n.googFrameHeightReceived),frameRate:Number(n.googFrameRateReceived)},u.decodedFrame={width:Number(n.googFrameWidthReceived),height:Number(n.googFrameHeightReceived),frameRate:Number(n.googFrameRateDecoded)},u.decodeFrameRate=Number(n.googFrameRateDecoded),u.outputFrame={width:Number(n.googFrameWidthReceived),height:Number(n.googFrameHeightReceived),frameRate:Number(n.googFrameRateOutput)},u.jitterBufferMs=Number(n.googJitterBufferMs),u.firsCount=Number(n.googFirsSent),u.nacksCount=Number(n.googNacksSent),u.plisCount=Number(n.googPlisSent),u.framesDecodeCount=Number(n.framesDecoded),u.bytes=Number(n.bytesReceived),u.packets=Number(n.packetsReceived),u.packetsLost=Number(n.packetsLost),u.ssrc=Number(n.ssrc),u.packets>0&&!this.isFirstVideoReceived[u.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(u.ssrc),this.isFirstVideoReceived[u.ssrc]=!0),u.framesDecodeCount>0&&!this.isFirstVideoDecoded[u.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(u.ssrc,u.decodedFrame.width,u.decodedFrame.height),this.isFirstVideoDecoded[u.ssrc]=!0),h){const p=h.stats,v=Date.now()-h.lts;u.framesDecodeFreezeTime=p.framesDecodeFreezeTime,u.framesDecodeInterval=p.framesDecodeInterval,u.framesDecodeCount>p.framesDecodeCount&&this.isFirstVideoDecoded[u.ssrc]?(h.lts=Date.now(),u.framesDecodeInterval=v,u.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(n.ssrc,10))?u.framesDecodeFreezeTime+=u.framesDecodeInterval:this.setVideoIsReady2(parseInt(n.ssrc,10),!0))):u.framesDecodeCount<h.stats.framesDecodeCount&&(u.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(u.ssrc,{stats:Vne({},u),lts:Date.now()}),this._stats.videoRecv.push(u);break}case"audio_recv":{const u=ss(RU);u.codec=n.googCodecName,u.outputLevel=Math.abs(Number(n.audioOutputLevel))/32767,u.decodingCNG=Number(n.googDecodingCNG),u.decodingCTN=Number(n.googDecodingCTN),u.decodingCTSG=Number(n.googDecodingCTSG),u.decodingNormal=Number(n.googDecodingNormal),u.decodingPLC=Number(n.googDecodingPLC),u.decodingPLCCNG=Number(n.googDecodingPLCCNG),u.expandRate=Number(n.googExpandRate),u.accelerateRate=Number(n.googAccelerateRate),u.preemptiveExpandRate=Number(n.googPreemptiveExpandRate),u.secondaryDecodedRate=Number(n.googSecondaryDecodedRate),u.speechExpandRate=Number(n.googSpeechExpandRate),u.preferredJitterBufferMs=Number(n.googPreferredJitterBufferMs),u.jitterBufferMs=Number(n.googJitterBufferMs),u.jitterMs=Number(n.googJitterReceived),u.bytes=Number(n.bytesReceived),u.packets=Number(n.packetsReceived),u.packetsLost=Number(n.packetsLost),u.ssrc=Number(n.ssrc),u.receivedFrames=Number(n.googDecodingCTN)||Number(n.packetsReceived),u.droppedFrames=Number(n.googDecodingPLC)+Number(n.googDecodingPLCCNG)||Number(n.packetsLost),u.receivedFrames>0&&!this.isFirstAudioReceived[u.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(u.ssrc),this.isFirstAudioReceived[u.ssrc]=!0),u.decodingNormal>0&&!this.isFirstAudioDecoded[u.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(u.ssrc),this.isFirstAudioDecoded[u.ssrc]=!0),this._stats.audioRecv.push(u);break}case"audio_send":{const u=ss(TU);u.codec=n.googCodecName,u.inputLevel=Math.abs(Number(n.audioInputLevel))/32767,u.aecReturnLoss=Number(n.googEchoCancellationReturnLoss||0),u.aecReturnLossEnhancement=Number(n.googEchoCancellationReturnLossEnhancement||0),u.residualEchoLikelihood=Number(n.googResidualEchoLikelihood||0),u.residualEchoLikelihoodRecentMax=Number(n.googResidualEchoLikelihoodRecentMax||0),u.bytes=Number(n.bytesSent),u.packets=Number(n.packetsSent),u.packetsLost=Number(n.packetsLost),u.ssrc=Number(n.ssrc),u.rttMs=Number(n.googRtt||0),this._stats.rtt=u.rttMs,this._stats.audioSend.push(u);break}}})}_getStats(){return new _e((t,n)=>{this.pc.getStats(t,n)})}statsResponsesToObjects(t){const n=[];return t.result().forEach(a=>{const l={id:a.id,timestamp:a.timestamp.valueOf().toString(),type:a.type};a.names().forEach(u=>{l[u]=a.stat(u)}),n.push(l)}),n}}function OU(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function wd(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?OU(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):OU(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}class xU extends PR{constructor(){super(...arguments),w(this,"_stats",P0),w(this,"report",void 0),w(this,"lastDecodeVideoReceiverStats",new Map),w(this,"lastVideoFramesRecv",new Map),w(this,"lastVideoFramesSent",new Map),w(this,"lastVideoFramesDecode",new Map),w(this,"lastVideoJBDelay",new Map),w(this,"lastAudioJBDelay",new Map),w(this,"mediaBytesSent",new Map),w(this,"mediaBytesRetransmit",new Map),w(this,"mediaBytesTargetEncode",new Map),w(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=ss(P0),this.report.forEach(t=>{switch(t.type){case po.OUTBOUND:case po.INBOUND:{const n=t.mediaType||t.kind,a=!n&&"frameWidth"in t,l=!n&&!("frameWidth"in t);t.type===po.OUTBOUND?n==="audio"||l?this.processAudioOutboundStats(t):(n==="video"||a)&&this.processVideoOutboundStats(t):t.type===po.INBOUND&&(n==="audio"||l?this.processAudioInboundStats(t):(n==="video"||a)&&this.processVideoInboundStats(t));break}case po.TRANSPORT:{const n=this.report.get(t.selectedCandidatePairId);n&&this.processCandidatePairStats(n);break}case po.CANDIDATE_PAIR:t.selected&&this.processCandidatePairStats(t)}}),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const t=await this.pc.getStats(),n={local:wd({},Ic),remote:wd({},Ic)};return t.forEach(a=>{let l;if(a.type===po.TRANSPORT&&(l=t.get(a.selectedCandidatePairId)),a.type===po.CANDIDATE_PAIR&&a.selected&&(l=a),l){const u=(h,p)=>{h.type=p.type,h.id=p.id,p.address&&(h.address=p.address),p.candidateType&&(h.candidateType=p.candidateType),p.port&&(h.port=p.port),p.priority&&(h.priority=p.priority),p.protocol&&(h.protocol=p.protocol),p.relayProtocol&&(h.relayProtocol=p.relayProtocol)};if(l.localCandidateId){const h=t.get(l.localCandidateId);h&&u(n.local,h)}if(l.remoteCandidateId){const h=t.get(l.remoteCandidateId);h&&u(n.remote,h)}}}),n}processCandidatePairStats(t){if(this._stats.sendBandwidth=t.availableOutgoingBitrate||0,t.currentRoundTripTime&&(this._stats.rtt=1e3*t.currentRoundTripTime),this._stats.videoSend.forEach(n=>{t.currentRoundTripTime&&(n.rttMs=1e3*t.currentRoundTripTime)}),this._stats.audioSend.forEach(n=>{t.currentRoundTripTime&&(n.rttMs=1e3*t.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=t.id,t.localCandidateId){const n=this.report.get(t.localCandidateId);n&&this.processCandidateStats(n)}if(t.remoteCandidateId){const n=this.report.get(t.remoteCandidateId);n&&this.processCandidateStats(n)}}processCandidateStats(t){let n;t.type===po.LOCAL_CANDIDATE&&(n=this._stats.selectedCandidatePair.localCandidate),t.type===po.REMOTE_CANDIDATE&&(n=this._stats.selectedCandidatePair.remoteCandidate),n&&(n.type=t.type,n.id=t.id,t.address&&(n.address=t.address),t.candidateType&&(n.candidateType=t.candidateType),t.port&&(n.port=t.port),t.priority&&(n.priority=t.priority),t.protocol&&(n.protocol=t.protocol),t.relayProtocol&&(n.relayProtocol=t.relayProtocol),t.type===po.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==n.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(wd({},n),wd({},this.stats.selectedCandidatePair.localCandidate)),t.type===po.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==n.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(wd({},n),wd({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(t){let n=this._stats.audioRecv.find(a=>a.ssrc===t.ssrc);n||(n=ss(RU),this._stats.audioRecv.push(n)),n.ssrc=t.ssrc,n.packets=t.packetsReceived,n.packetsLost=t.packetsLost,n.bytes=t.bytesReceived,n.jitterMs=1e3*t.jitter,this.processAudioTrackReceiverStats(t,t.trackId,n),t.codecId&&(n.codec=this.getCodecFromCodecStats(t.codecId)),n.receivedFrames||(n.receivedFrames=t.packetsReceived),n.droppedFrames||(n.droppedFrames=t.packetsLost),n.receivedFrames>0&&!this.isFirstAudioReceived[n.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(n.ssrc),this.isFirstAudioReceived[n.ssrc]=!0),n.outputLevel&&n.outputLevel>0&&!this.isFirstAudioDecoded[n.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(n.ssrc),this.isFirstAudioDecoded[n.ssrc]=!0),typeof t.concealedSamples=="number"&&(n.concealedSamples=t.concealedSamples)}processVideoInboundStats(t){let n=this._stats.videoRecv.find(h=>h.ssrc===t.ssrc);n||(n=ss(CU),this._stats.videoRecv.push(n)),n.ssrc=t.ssrc,n.packets=t.packetsReceived,n.packetsLost=t.packetsLost,n.bytes=t.bytesReceived,n.firsCount=t.firCount,n.nacksCount=t.nackCount,n.plisCount=t.pliCount,n.framesDecodeCount=t.framesDecoded,n.totalInterFrameDelay=t.totalInterFrameDelay,n.totalSquaredInterFrameDelay=t.totalSquaredInterFrameDelay;const a=this.lastDecodeVideoReceiverStats.get(n.ssrc),l=this.lastVideoFramesDecode.get(n.ssrc),u=Date.now();if(n.framesDecodeCount>0&&!this.isFirstVideoDecoded[n.ssrc]){const h=n.decodedFrame?n.decodedFrame.width:0,p=n.decodedFrame?n.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(n.ssrc,h,p),this.isFirstVideoDecoded[n.ssrc]=!0}if(a){const h=a.stats,p=u-a.lts;n.framesDecodeFreezeTime=h.framesDecodeFreezeTime,n.framesDecodeInterval=h.framesDecodeInterval,!this.isFirstVideoDecoded[n.ssrc]&&p>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[n.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(n.ssrc),this.isFirstVideoDecodedTimeout[n.ssrc]=!0),n.framesDecodeCount>h.framesDecodeCount&&this.isFirstVideoDecoded[n.ssrc]?(a.lts=Date.now(),n.framesDecodeInterval=p,n.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(t.ssrc))?n.framesDecodeFreezeTime+=n.framesDecodeInterval:this.setVideoIsReady2(parseInt(t.ssrc,10),!0))):n.framesDecodeCount<h.framesDecodeCount&&(n.framesDecodeInterval=0),t.framesDecoded&&t.qpSum&&(a.stats.framesDecodeCount>t.framesDecoded?n.qpSumPerFrame=t.qpSum/t.framesDecoded:n.qpSumPerFrame=(t.qpSum-a.qpSum)/(t.framesDecoded-a.stats.framesDecodeCount))}l&&u-l.lts>=800?(n.decodeFrameRate=Math.round((n.framesDecodeCount-l.count)/((u-l.lts)/1e3)),this.lastVideoFramesDecode.set(n.ssrc,{count:n.framesDecodeCount,lts:u,rate:n.decodeFrameRate})):l?n.decodeFrameRate=l.rate:this.lastVideoFramesDecode.set(n.ssrc,{count:n.framesDecodeCount,lts:u,rate:0}),t.totalDecodeTime&&(n.decodeMs=1e3*t.totalDecodeTime),this.processVideoTrackReceiverStats(t,t.trackId,n),t.codecId&&(n.codec=this.getCodecFromCodecStats(t.codecId)),t.framerateMean&&(n.framesRateFirefox=t.framerateMean),n.packets>0&&!this.isFirstVideoReceived[n.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(n.ssrc),this.isFirstVideoReceived[n.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(n.ssrc,{stats:wd({},n),lts:a?a.lts:Date.now(),qpSum:t.qpSum})}processVideoOutboundStats(t){let n=this._stats.videoSend.find(l=>l.ssrc===t.ssrc);n||(n=ss(bU),this._stats.videoSend.push(n));const a=this.mediaBytesSent.get(t.ssrc);if(a)a.add(t.bytesSent);else{const l=new NR(10);l.add(t.bytesSent),this.mediaBytesSent.set(t.ssrc,l)}if(t.retransmittedBytesSent!==void 0){const l=this.mediaBytesRetransmit.get(t.ssrc);if(l)l.add(t.retransmittedBytesSent);else{const u=new NR(10);u.add(t.retransmittedBytesSent),this.mediaBytesRetransmit.set(t.ssrc,u)}}if(t.totalEncodedBytesTarget){const l=this.mediaBytesTargetEncode.get(t.ssrc);if(l)l.add(t.totalEncodedBytesTarget);else{const u=new NR(10);u.add(t.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(t.ssrc,u)}}if(n.ssrc=t.ssrc,n.bytes=t.bytesSent,n.packets=t.packetsSent,n.firsCount=t.firCount,n.nacksCount=t.nackCount,n.plisCount=t.pliCount,n.frameCount=t.framesEncoded,n.adaptionChangeReason=t.qualityLimitationReason,n.scalabilityMode=t.scalabilityMode,t.totalEncodeTime&&t.framesEncoded){const l=this.lastEncoderMs.get(t.ssrc);if(!l||l.lastFrameCount>t.framesEncoded)n.avgEncodeMs=1e3*t.totalEncodeTime/t.framesEncoded;else{const u=t.framesEncoded-l.lastFrameCount,h=t.totalEncodeTime-l.lastEncoderTime;n.avgEncodeMs=1e3*h/u}}if(t.framesEncoded&&t.qpSum){const l=this.lastEncoderMs.get(t.ssrc);!l||l.lastFrameCount>t.framesEncoded?n.qpSumPerFrame=t.qpSum/t.framesEncoded:n.qpSumPerFrame=(t.qpSum-l.lastQpSum)/(t.framesEncoded-l.lastFrameCount)}if(this.lastEncoderMs.set(t.ssrc,{lastFrameCount:t.framesEncoded,lastEncoderTime:t.totalEncodeTime,lastQpSum:t.qpSum,lts:Date.now()}),t.codecId&&(n.codec=this.getCodecFromCodecStats(t.codecId)),t.mediaSourceId&&this.processVideoMediaSource(t.mediaSourceId,n),this.processVideoTrackSenderStats(t,t.trackId,n),t.remoteId)this.processRemoteInboundStats(t.remoteId,n);else{const l=this.findRemoteStatsId(t.ssrc,po.REMOTE_INBOUND);l&&this.processRemoteInboundStats(l,n)}}processAudioOutboundStats(t){let n=this._stats.audioSend.find(a=>a.ssrc===t.ssrc);if(n||(n=ss(TU),this._stats.audioSend.push(n)),n.ssrc=t.ssrc,n.packets=t.packetsSent,n.bytes=t.bytesSent,t.mediaSourceId&&this.processAudioMediaSource(t.mediaSourceId,n),t.codecId&&(n.codec=this.getCodecFromCodecStats(t.codecId)),this.processAudioTrackSenderStats(t,t.trackId,n),t.remoteId)this.processRemoteInboundStats(t.remoteId,n);else{const a=this.findRemoteStatsId(t.ssrc,po.REMOTE_INBOUND);a&&this.processRemoteInboundStats(a,n)}}findRemoteStatsId(t,n){var a;const l=Array.from(ks(a=this.report).call(a)).find(u=>u.type===n&&u.ssrc===t);return l?l.id:null}processVideoMediaSource(t,n){const a=this.report.get(t);a&&a.width&&a.height&&a.framesPerSecond&&(n.inputFrame={width:a.width,height:a.height,frameRate:a.framesPerSecond})}processAudioMediaSource(t,n){const a=this.report.get(t);a&&(n.inputLevel=a.audioLevel)}processVideoTrackSenderStats(t,n,a){var l,u,h,p;const v=n?this.report.get(n):void 0,E=(l=v==null?void 0:v.framesSent)!==null&&l!==void 0?l:t.framesSent;if(typeof E!="number")return;let y=(u=v==null?void 0:v.frameWidth)!==null&&u!==void 0?u:t.frameWidth,C=(h=v==null?void 0:v.frameHeight)!==null&&h!==void 0?h:t.frameHeight,I=(p=v==null?void 0:v.framesPerSecond)!==null&&p!==void 0?p:t.framesPerSecond;if(typeof y=="number"&&typeof C=="number"||(y=0,C=0),I==null){const k=Date.now(),G=this.lastVideoFramesSent.get(a.ssrc);G&&k-G.lts>=800?(I=Math.round((E-G.count)/((k-G.lts)/1e3)),this.lastVideoFramesSent.set(a.ssrc,{count:E,lts:k,rate:I})):G?I=G.rate:this.lastVideoFramesSent.set(a.ssrc,{count:E,lts:k,rate:0})}a.sentFrame={width:y,height:C,frameRate:Math.max(0,I)}}processVideoTrackReceiverStats(t,n,a){var l,u,h,p,v;const E=n?this.report.get(n):void 0,y=(l=E==null?void 0:E.framesReceived)!==null&&l!==void 0?l:t.framesReceived,C=(u=E==null?void 0:E.frameWidth)!==null&&u!==void 0?u:t.frameWidth,I=(h=E==null?void 0:E.frameHeight)!==null&&h!==void 0?h:t.frameHeight,k=(p=E==null?void 0:E.jitterBufferDelay)!==null&&p!==void 0?p:t.jitterBufferDelay,G=(v=E==null?void 0:E.jitterBufferEmittedCount)!==null&&v!==void 0?v:t.jitterBufferEmittedCount;if(typeof y=="number"){const B=this.lastVideoFramesRecv.get(a.ssrc),j=Date.now();a.framesReceivedCount=y;let q=0;B&&j-B.lts>=800?(q=Math.round((y-B.count)/((j-B.lts)/1e3)),this.lastVideoFramesRecv.set(a.ssrc,{count:y,lts:j,rate:q})):B?q=B.rate:this.lastVideoFramesRecv.set(a.ssrc,{count:y,lts:j,rate:0}),a.receivedFrame={width:C||0,height:I||0,frameRate:q||0},a.decodedFrame={width:C||0,height:I||0,frameRate:a.decodeFrameRate||0},a.outputFrame={width:C||0,height:I||0,frameRate:a.decodeFrameRate||0}}if(k&&G){const B=this.lastVideoJBDelay.get(a.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let j=B.jitterBufferMs;const q=G-B.jitterBufferEmittedCount;q>0&&(j=1e3*(k-B.jitterBufferDelay)/q),a.jitterBufferMs=j,a.currentDelayMs=Math.round(j),this.lastVideoJBDelay.set(a.ssrc,{jitterBufferDelay:k,jitterBufferEmittedCount:G,jitterBufferMs:a.currentDelayMs})}}processAudioTrackSenderStats(t,n,a){var l,u,h,p;const v=n?this.report.get(n):void 0,E=(l=(u=v==null?void 0:v.echoReturnLoss)!==null&&u!==void 0?u:t.echoReturnLoss)!==null&&l!==void 0?l:0,y=(h=(p=v==null?void 0:v.echoReturnLossEnhancement)!==null&&p!==void 0?p:t.echoReturnLossEnhancement)!==null&&h!==void 0?h:0;a.aecReturnLoss=E,a.aecReturnLossEnhancement=y}processAudioTrackReceiverStats(t,n,a){var l,u,h,p,v,E,y;const C=n?this.report.get(n):void 0,I=(l=C==null?void 0:C.removedSamplesForAcceleration)!==null&&l!==void 0?l:t.removedSamplesForAcceleration,k=(u=C==null?void 0:C.totalSamplesReceived)!==null&&u!==void 0?u:t.totalSamplesReceived,G=(h=C==null?void 0:C.jitterBufferDelay)!==null&&h!==void 0?h:t.jitterBufferDelay,B=(p=C==null?void 0:C.jitterBufferEmittedCount)!==null&&p!==void 0?p:t.jitterBufferEmittedCount,j=(v=C==null?void 0:C.audioLevel)!==null&&v!==void 0?v:t==null?void 0:t.audioLevel,q=(E=C==null?void 0:C.totalSamplesDuration)!==null&&E!==void 0?E:t==null?void 0:t.totalSamplesDuration,Z=(y=C==null?void 0:C.concealedSamples)!==null&&y!==void 0?y:t.concealedSamples;if(I&&k&&(a.accelerateRate=I/k),G&&B){const Ce=this.lastAudioJBDelay.get(a.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let pe=Ce.jitterBufferMs;const fe=B-Ce.jitterBufferEmittedCount;fe>0&&(pe=1e3*(G-Ce.jitterBufferDelay)/fe),a.jitterBufferMs=Math.round(pe),this.lastAudioJBDelay.set(a.ssrc,{jitterBufferDelay:G,jitterBufferEmittedCount:B,jitterBufferMs:a.jitterBufferMs})}a.outputLevel=j;let re=1920;q&&k&&(re=k/q/50,a.receivedFrames=Math.round(k/re)),Z&&(a.droppedFrames=Math.round(Z/re))}processRemoteInboundStats(t,n){const a=this.report.get(t);a&&(n.packetsLost=a.packetsLost,a.roundTripTime&&(n.rttMs=1e3*a.roundTripTime),a.jitter&&(n.jitterMs=1e3*a.jitter),a.timestamp&&(n.timestamp=a.timestamp))}getCodecFromCodecStats(t){const n=this.report.get(t);if(!n)return"";const a=n.mimeType.match(/\/(.*)$/);return a&&a[1]?a[1]:""}updateSendBitrate(){let t=0,n=null,a=null;this.mediaBytesSent.forEach(u=>{t+=u.diffMean()}),this.mediaBytesRetransmit.forEach(u=>{n=n===null?u.diffMean():n+u.diffMean()}),this.mediaBytesTargetEncode.forEach(u=>{a=a===null?u.diffMean():a+u.diffMean()});const l=n!==null?t-n:t;this._stats.bitrate={actualEncoded:8*l/(this.options.updateInterval/1e3),transmit:8*t/(this.options.updateInterval/1e3)},n!==null&&(this._stats.bitrate.retransmit=8*n/(this.options.updateInterval/1e3)),a!==null&&(this._stats.bitrate.targetEncoded=8*a/(this.options.updateInterval/1e3))}}class Hne extends PR{updateStats(){return _e.resolve()}}function pE(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:500,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4;const u=function(){const h=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return h&&h[0]?Number(h[0].split("/")[1]):null}();return u?u<76?new $ne(i,{updateInterval:t,lossRateInterval:n,freezeRateLimit:a,firstVideoDecodedTimeout:l}):new xU(i,{updateInterval:t,lossRateInterval:n,freezeRateLimit:a,firstVideoDecodedTimeout:l}):function(h){return!!window.RTCStatsReport&&h.getStats()instanceof _e}(i)?new xU(i,{updateInterval:t,lossRateInterval:n,freezeRateLimit:a,firstVideoDecodedTimeout:l}):new Hne(i,{updateInterval:t,lossRateInterval:n,freezeRateLimit:a,firstVideoDecodedTimeout:l})}function NU(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function PU(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?NU(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):NU(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}function D0(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;const{filterRTX:l,filterVideoFec:u,filterAudioFec:h,filterAudioCodec:p,filterVideoCodec:v}=t,{useXR:E}=n;let y=[],C=[],I=[],k=[],G=!1,B=!1;if(In.parse(i).mediaDescriptions.forEach(q=>{a&&a!==q.attributes.direction||(q.media.mediaType!=="video"||G||(C=q.attributes.payloads,k=q.attributes.extmaps,G=!0),q.media.mediaType!=="audio"||B||(y=q.attributes.payloads,I=q.attributes.extmaps,B=!0))}),!k||C.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!I||y.length===0)throw new Error("Cannot get audio capabilities from SDP.");C.forEach(q=>{var Z;(Z=q.rtpMap)!==null&&Z!==void 0&&Z.clockRate&&(q.rtpMap.clockRate=parseInt(q.rtpMap.clockRate)),E&&q.rtcpFeedbacks.push({type:"rrtr"})}),y.forEach(q=>{var Z;(Z=q.rtpMap)!==null&&Z!==void 0&&Z.clockRate&&(q.rtpMap.clockRate=parseInt(q.rtpMap.clockRate)),E&&q.rtcpFeedbacks.push({type:"rrtr"})}),l&&(y=y.filter(q=>{var Z;return((Z=q.rtpMap)===null||Z===void 0?void 0:Z.encodingName.toLowerCase())!=="rtx"}),C=C.filter(q=>{var Z;return((Z=q.rtpMap)===null||Z===void 0?void 0:Z.encodingName.toLowerCase())!=="rtx"})),u&&(C=C.filter(q=>{var Z;return!/(red)|(ulpfec)|(flexfec)/i.test(((Z=q.rtpMap)===null||Z===void 0?void 0:Z.encodingName)||"")})),h&&(y=y.filter(q=>{var Z;return!/(red)|(ulpfec)|(flexfec)/i.test(((Z=q.rtpMap)===null||Z===void 0?void 0:Z.encodingName)||"")})),p&&(p==null?void 0:p.length)>0&&(y=y.filter(q=>{var Z;return Be(p).call(p,((Z=q.rtpMap)===null||Z===void 0?void 0:Z.encodingName.toLowerCase())||"")})),v&&(v==null?void 0:v.length)>0&&(C=C.filter(q=>{var Z;return Be(v).call(v,((Z=q.rtpMap)===null||Z===void 0?void 0:Z.encodingName.toLowerCase())||"")}));const j=J("UNSUPPORTED_VIDEO_CODEC");return j&&j.length>0&&(C=C.filter(q=>!(q.rtpMap&&Be(j).call(j,q.rtpMap.encodingName.toLowerCase())))),{audioCodecs:y,videoCodecs:C,audioExtensions:I,videoExtensions:k}}function Fs(i){const t=In.parse(i);let n,a;for(const l of t.mediaDescriptions){if(!n){const u=l.attributes.iceUfrag,h=l.attributes.icePwd;if(!u||!h)throw new Error("Cannot get iceUfrag or icePwd from SDP.");n={iceUfrag:u,icePwd:h}}if(!a){const u=l.attributes.fingerprints;u.length>0&&(a={fingerprints:u})}}if(!a&&t.attributes.fingerprints.length>0&&(a={fingerprints:t.attributes.fingerprints}),!a||!n)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:n,dtlsParameters:a}}function DR(i,t){const n=[],a=i.attributes.ssrcGroups.filter(h=>h.semantic==="FID"),l=i.attributes.ssrcGroups.find(h=>h.semantic==="SIM"),u=i.attributes.ssrcs;if(l)l.ssrcIds.forEach(h=>{var p;const v=(p=a.find(E=>E.ssrcIds[0]===h))===null||p===void 0?void 0:p.ssrcIds[1];n.push({ssrcId:h,rtx:t?v:void 0})});else if(a.length>0){const h=a[0].ssrcIds[0],p=a[0].ssrcIds[1];n.push({ssrcId:h,rtx:t?p:void 0})}else{if(u.length===0)throw new Error("No ssrcs found on local media description.");n.push({ssrcId:u[0].ssrcId})}return n}function DU(i,t){const{cname:n}=i;let a;t&&t.ip&&typeof t.port=="number"?(a=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:t.ip,port:t.port.toString(),type:"host",extension:{}}],L.debug("Using remote candidate from AP ".concat(t.ip,":").concat(t.port)),t.ip6&&(a.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:t.ip6,port:t.port.toString(),type:"host",extension:{}}),L.debug("Using IPV6 remote candidate from AP ".concat(t.ip6,":").concat(t.port)))):a=i.iceParameters.candidates.map(p=>({foundation:p.foundation,componentId:"1",transport:p.protocol,priority:p.priority.toString(),connectionAddress:p.ip,port:p.port.toString(),type:p.type,extension:{}}));const l={fingerprints:i.dtlsParameters.fingerprints.map(p=>({hashFunction:p.algorithm,fingerprint:p.fingerprint}))},u={iceUfrag:i.iceParameters.iceUfrag,icePwd:i.iceParameters.icePwd};let h;switch(i.dtlsParameters.role){case"server":h="passive";break;case"client":h="active";break;case"auto":h="actpass"}return{dtlsParameters:l,iceParameters:u,candidates:a,rtpCapabilities:op(i.rtpCapabilities),setup:h,cname:n}}function vo(i,t,n){const a=[],l=[];return i.forEach(u=>{let{ssrcId:h,rtx:p}=u;const v=pn(8,"track-"),E={ssrcId:h,attributes:PU({label:v,mslabel:n=n||pn(10,""),msid:"".concat(n," ").concat(v)},t&&{cname:t})};if(a.push(E),p!==void 0){const y={ssrcId:p,attributes:PU({label:v,mslabel:n,msid:"".concat(n," ").concat(v)},t&&{cname:t})};a.push(y),l.push({semantic:"FID",ssrcIds:[h,p]})}}),i.length>1&&l.push({semantic:"SIM",ssrcIds:i.map(u=>{let{ssrcId:h}=u;return h})}),{ssrcs:a,ssrcGroups:l}}function uu(i,t){t instanceof Xt&&i.attributes.payloads.forEach(n=>{var a;const l=(a=n.rtpMap)===null||a===void 0?void 0:a.encodingName.toLowerCase();if(!l||["opus","pcmu","pcma","g722"].indexOf(l)===-1)return;n.fmtp||(n.fmtp={parameters:{}}),n.fmtp.parameters.minptime="10",n.fmtp.parameters.useinbandfec="1";const u=t._encoderConfig;u&&l!=="pcmu"&&l!=="pcma"&&l!=="g722"&&(u.bitrate&&!un()&&(n.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*u.bitrate))),u.sampleRate&&(n.fmtp.parameters.maxplaybackrate="".concat(u.sampleRate),n.fmtp.parameters["sprop-maxcapturerate"]="".concat(u.sampleRate)),u.stereo&&(n.fmtp.parameters.stereo="1",n.fmtp.parameters["sprop-stereo"]="1"))})}function fE(i){const t=i.attributes.unrecognized.findIndex(n=>n.attField==="x-google-flag"&&n.attValue==="conference");t!==-1&&i.attributes.unrecognized.splice(t,1)}function mE(i,t){var n;if(!(t instanceof Rt&&t._encoderConfig&&t._hints.indexOf(mn.SCREEN_TRACK)===-1))return;const a=t._encoderConfig;cn().supportMinBitrate&&a.bitrateMin&&i.attributes.payloads.forEach(l=>{var u,h;Be(u=["h264","h265","vp8","vp9","av1"]).call(u,((h=l.rtpMap)===null||h===void 0?void 0:h.encodingName.toLowerCase())||"")&&(l.fmtp||(l.fmtp={parameters:{}}),l.fmtp.parameters["x-google-min-bitrate"]="".concat(a.bitrateMin))}),cn().supportMinBitrate&&!Be(n=t._hints).call(n,mn.LOW_STREAM)&&a.bitrateMax&&i.attributes.payloads.forEach(l=>{var u,h;Be(u=["h264","h265","vp8","vp9","av1"]).call(u,((h=l.rtpMap)===null||h===void 0?void 0:h.encodingName.toLowerCase())||"")&&(l.fmtp||(l.fmtp={parameters:{}}),l.fmtp.parameters["x-google-start-bitrate"]="".concat(J("X_GOOGLE_START_BITRATE")||Math.floor(a.bitrateMax)))})}function kR(i){if(i.media.mediaType!=="video")return;const t=Wt();if(t.name!==qt.SAFARI&&t.os!==yr.IOS)return;const n=i.attributes.extmaps.findIndex(a=>/video-orientation/g.test(a.extensionName));n!==-1&&i.attributes.extmaps.splice(n,1)}function ip(i,t,n){if(!t)return;let a,l;if(i.media.mediaType==="video"?(a=n.videoExtensions,l=n.videoCodecs):(a=n.audioExtensions,l=n.audioCodecs),t.twcc===!0){const u=a.find(h=>h.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");u&&(i.attributes.extmaps.find(p=>p.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01")||i.attributes.extmaps.push({entry:u.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"}),function(p,v){return v.filter(E=>!!p.find(y=>y.payloadType===E.payloadType&&!!y.rtcpFeedbacks.find(C=>C.type==="transport-cc")))}(l,i.attributes.payloads).forEach(p=>{p.rtcpFeedbacks.find(v=>v.type==="transport-cc")||p.rtcpFeedbacks.push({type:"transport-cc"})}))}else if(t.twcc===!1){const u=i.attributes.extmaps.findIndex(h=>h.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");u!==-1&&i.attributes.extmaps.splice(u,1),i.attributes.payloads.forEach(h=>{const p=h.rtcpFeedbacks.findIndex(v=>v.type==="transport-cc");p!==-1&&h.rtcpFeedbacks.splice(p,1)})}if(t.remb===!0){const u=a.find(h=>h.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");u&&(i.attributes.extmaps.find(p=>p.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time")||i.attributes.extmaps.push({entry:u.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}),function(p,v){return v.filter(E=>!!p.find(y=>y.payloadType===E.payloadType&&!!y.rtcpFeedbacks.find(C=>C.type==="goog-remb")))}(l,i.attributes.payloads).forEach(p=>{p.rtcpFeedbacks.find(v=>v.type==="goog-remb")||p.rtcpFeedbacks.push({type:"goog-remb"})}))}else if(t.remb===!1){const u=i.attributes.extmaps.findIndex(h=>h.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");u!==-1&&i.attributes.extmaps.splice(u,1),i.attributes.payloads.forEach(h=>{const p=h.rtcpFeedbacks.findIndex(v=>v.type==="goog-remb");p!==-1&&h.rtcpFeedbacks.splice(p,1)})}}function LR(i,t,n){if(un()||i.media.mediaType!=="video"||!(t instanceof Rt)||n!=="vp9"&&n!=="vp8"||n==="vp8"&&!J("SIMULCAST")||t._scalabilityMode===void 0||t._scalabilityMode.numSpatialLayers<=1)return;const a=n==="vp8"?2:t._scalabilityMode.numSpatialLayers,l=i.attributes.ssrcs[0],u=i.attributes.ssrcGroups.find(p=>p.semantic==="FID"&&p.ssrcIds[0]===l.ssrcId),h={semantic:"SIM",ssrcIds:[l.ssrcId]};for(let p=1;p<a;p++)i.attributes.ssrcs.push({ssrcId:l.ssrcId+p,attributes:fn(l.attributes)}),h.ssrcIds.push(l.ssrcId+p),u&&(i.attributes.ssrcs.push({ssrcId:u.ssrcIds[1]+p,attributes:fn(l.attributes)}),i.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[l.ssrcId+p,u.ssrcIds[1]+p]}));i.attributes.ssrcGroups.unshift(h)}async function MR(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=new RTCPeerConnection;n.addTransceiver("video",{direction:"sendonly"}),n.addTransceiver("audio",{direction:"sendonly"}),n.addTransceiver("video",{direction:"recvonly"}),n.addTransceiver("audio",{direction:"recvonly"});const a=(await n.createOffer()).sdp,{send:l,recv:u,sendrecv:h}=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E=arguments.length>2?arguments[2]:void 0;const y=D0(E,p,v,"sendonly"),C=D0(E,p,v,"recvonly"),I={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},k={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},G={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(cs(y,C,"videoExtensions",I,k,G),cs(y,C,"videoCodecs",I,k,G),cs(y,C,"audioExtensions",I,k,G),cs(y,C,"audioCodecs",I,k,G),J("RAISE_H264_BASELINE_PRIORITY")){const B=G.videoCodecs.findIndex(j=>{var q,Z;return((q=j.rtpMap)===null||q===void 0?void 0:q.encodingName.toLocaleLowerCase())==="h264"&&((Z=j.fmtp)===null||Z===void 0?void 0:Z.parameters["profile-level-id"])==="42001f"});if(B!==-1){const j=G.videoCodecs.findIndex(q=>{var Z;return((Z=q.rtpMap)===null||Z===void 0?void 0:Z.encodingName.toLocaleLowerCase())==="h264"});if(j<B){L.debug("raising H264 baseline profile priority");const q=G.videoCodecs[B];G.videoCodecs.splice(B,1),G.videoCodecs.splice(j,0,q)}j!==-1&&(k.videoCodecs=k.videoCodecs.filter(q=>{var Z,re;return!(((Z=q.rtpMap)===null||Z===void 0?void 0:Z.encodingName.toLocaleLowerCase())==="h264"&&((re=q.fmtp)===null||re===void 0?void 0:re.parameters["profile-level-id"])!=="42001f")})),j!==-1&&J("FILTER_SEND_H264_BASELINE")&&(I.videoCodecs=I.videoCodecs.filter(q=>{var Z,re;return!(((Z=q.rtpMap)===null||Z===void 0?void 0:Z.encodingName.toLocaleLowerCase())==="h264"&&((re=q.fmtp)===null||re===void 0?void 0:re.parameters["profile-level-id"])!=="42001f")}))}}return{send:I,recv:k,sendrecv:G}}(i,t,a);try{n.close()}catch{}return{send:l,recv:u,sendrecv:h}}function kU(){const i={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},t=D0(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"recvonly"),n={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},a={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},l={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(cs(i,t,"videoExtensions",n,a,l),cs(i,t,"videoCodecs",n,a,l),cs(i,t,"audioExtensions",n,a,l),cs(i,t,"audioCodecs",n,a,l),J("RAISE_H264_BASELINE_PRIORITY")){const u=l.videoCodecs.findIndex(h=>h.rtpMap&&h.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&h.fmtp&&h.fmtp.parameters["profile-level-id"]==="42001f");if(u!==-1){const h=l.videoCodecs.findIndex(p=>p.rtpMap&&p.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(h<u){L.debug("raising H264 baseline profile priority");const p=l.videoCodecs[u];l.videoCodecs.splice(u,1),l.videoCodecs.splice(h,0,p)}h!==-1&&(a.videoCodecs=a.videoCodecs.filter(p=>!(p.rtpMap&&p.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&p.fmtp&&p.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:n,recv:a,sendrecv:l}}function cs(i,t,n,a,l,u){if(n==="videoExtensions"||n==="audioExtensions"){const h=[];return i[n].forEach(p=>{t[n].some((v,E)=>{if(p.entry===v.entry&&p.extensionName===v.extensionName)return h.push(E),!0})?u[n].push(p):a[n].push(p)}),void t[n].forEach((p,v)=>{h.indexOf(v)===-1&&l[n].push(p)})}if(n==="videoCodecs"||n==="audioCodecs"){const h=[];return i[n].forEach(p=>{t[n].some((v,E)=>{if(p.payloadType===v.payloadType&&JSON.stringify(p)===JSON.stringify(v))return h.push(E),!0})?u[n].push(p):a[n].push(p)}),void t[n].forEach((p,v)=>{h.indexOf(v)===-1&&l[n].push(p)})}}function op(i){const{send:t,recv:n,sendrecv:a}=i;if(!a){if(!t||!n)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:t,recv:n}}let l,u;return t?(l={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},l.audioCodecs=[...t.audioCodecs,...a.audioCodecs],l.videoCodecs=[...t.videoCodecs,...a.videoCodecs],l.audioExtensions=[...t.audioExtensions,...a.audioExtensions],l.videoExtensions=[...t.videoExtensions,...a.videoExtensions]):l=a,n?(u={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},u.audioCodecs=[...n.audioCodecs,...a.audioCodecs],u.videoCodecs=[...n.videoCodecs,...a.videoCodecs],u.audioExtensions=[...n.audioExtensions,...a.audioExtensions],u.videoExtensions=[...n.videoExtensions,...a.videoExtensions]):u=a,{send:l,recv:u}}function Us(i){i.media.mediaType==="audio"&&i.attributes.payloads.filter(t=>{var n;return((n=t.rtpMap)===null||n===void 0?void 0:n.encodingName.toLowerCase())==="opus"}).forEach(t=>{t.fmtp||(t.fmtp={parameters:{}}),t.fmtp.parameters.stereo="1",t.fmtp.parameters["sprop-stereo"]="1"})}function k0(i){i.mediaDescriptions.forEach(t=>{t.media.mediaType!=="video"&&t.media.mediaType!=="audio"||t.attributes.payloads.forEach(n=>{n.rtcpFeedbacks.findIndex(a=>a.type==="rrtr")===-1&&n.rtcpFeedbacks.push({type:"rrtr"})})})}function Id(i,t,n,a){let l=[];if(i===je.VIDEO){if(J("H264_PROFILE_LEVEL_ID")&&a==="h264"&&(l=t.videoCodecs.filter(u=>{var h;return Be(h=u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").call(h,a)&&u&&u.fmtp&&u.fmtp.parameters["profile-level-id"]===J("H264_PROFILE_LEVEL_ID")})),!Array.isArray(l)||l.length===0){let u=[];const h=[],p=[];n.videoCodecs.forEach(v=>{var E,y,C;Be(E=v.rtpMap&&v.rtpMap.encodingName.toLowerCase()||"").call(E,a)&&u.push(v),Be(y=v.rtpMap&&v.rtpMap.encodingName.toLowerCase()||"").call(y,"vp8")&&h.push(v),Be(C=v.rtpMap&&v.rtpMap.encodingName.toLowerCase()||"").call(C,"h264")&&p.push(v)}),u.length===0&&(h.length!==0?(u=h,L.warning("codec ".concat(a," not included in rtpCapabilities, fallback to default payloads: vp8"))):p.length!==0&&(u=p,L.warning("codec ".concat(a," not included in rtpCapabilities, fallback to default payloads: h264")))),u.length!==0&&(l=t.videoCodecs.filter(v=>u.some(E=>E.payloadType===v.payloadType)))}if(J("USE_PUB_RTX")){const u=l.map(p=>p.payloadType.toString()),h=t.videoCodecs.filter(p=>p.rtpMap&&p.rtpMap.encodingName==="rtx"&&Be(u).call(u,p.fmtp&&p.fmtp.parameters.apt||""));l=[...l,...h]}l.length===0&&(L.warning("codec ".concat(a," not included in rtpCapabilities, fallback to default payloads: ").concat(t.videoCodecs[0].rtpMap&&t.videoCodecs[0].rtpMap.encodingName)),l=t.videoCodecs)}else l=t.audioCodecs.filter(u=>{var h;return Be(h=u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").call(h,a)}),l.length===0&&(L.warning("codec ".concat(a," not included in rtpCapabilities, fallback to opus")),l=t.audioCodecs.filter(u=>{var h;return Be(h=u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").call(h,"opus")}));return l}let LU=class{get localCapabilities(){return fn(this._localCapabilities)}get rtpCapabilities(){return fn(this._rtpCapabilities)}get candidates(){return fn(this._candidates)}get iceParameters(){return fn(this._iceParameters)}get dtlsParameters(){return fn(this._dtlsParameters)}constructor(i){w(this,"sessionDesc",void 0),w(this,"_localCapabilities",void 0),w(this,"_rtpCapabilities",void 0),w(this,"_candidates",void 0),w(this,"_iceParameters",void 0),w(this,"_dtlsParameters",void 0),w(this,"setup",void 0),w(this,"currentMidIndex",void 0),w(this,"cname","o/i14u9pJrxRKAsu"),w(this,"firefoxSsrcMidMap",new Map),i=fn(i);const{remoteIceParameters:t,remoteDtlsParameters:n,candidates:a,remoteRTPCapabilities:l,localCapabilities:u,direction:h,setup:p,videoCodec:v,audioCodec:E}=i;let y;this.setup=p,y=h===vi.RECEIVE_ONLY?In.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`):In.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`),this._rtpCapabilities=l,this._candidates=a,this._iceParameters=t,this._dtlsParameters=n,this._localCapabilities=u;const C=h===vi.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,I=h===vi.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,k=h===vi.RECEIVE_ONLY?l.send.videoCodecs:Id(je.VIDEO,C,I,v),G=h===vi.RECEIVE_ONLY?l.send.audioCodecs:Id(je.AUDIO,C,I,E);for(const B of y.mediaDescriptions){if(B.attributes.iceUfrag=t.iceUfrag,B.attributes.icePwd=t.icePwd,B.attributes.fingerprints=n.fingerprints,B.attributes.candidates=a,B.attributes.setup=this.setup,B.media.mediaType==="application"&&(B.attributes.sctpPort="5000"),B.media.mediaType==="video"&&(B.media.fmts=k.map(j=>j.payloadType.toString(10)),B.attributes.payloads=k,B.attributes.extmaps=C.videoExtensions,J("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:j,ssrcGroups:q}=vo([{ssrcId:4e4,rtx:J("USE_SUB_RTX")?40001:void 0}],this.cname);B.attributes.ssrcs=j,B.attributes.ssrcGroups=q}if(B.media.mediaType==="audio"&&(B.media.fmts=G.map(j=>j.payloadType.toString(10)),B.attributes.payloads=G,B.attributes.extmaps=C.audioExtensions,Us(B),J("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:j,ssrcGroups:q}=vo([{ssrcId:2e4}],this.cname);B.attributes.ssrcs=j,B.attributes.ssrcGroups=q}}this.sessionDesc=y,this.currentMidIndex=y.mediaDescriptions.length-1}toString(){return In.print(this.sessionDesc)}hasMid(i){return Array.isArray(i)?i.every(t=>this.hasMid(t)):this.sessionDesc.mediaDescriptions.some(t=>t.attributes.mid===i)}send(i,t,n,a,l){n=n.replace(/ /g,"-");const{ssrcs:u,ssrcGroups:h}=vo(t,this.cname,J("SYNC_GROUP")?n:void 0),p=this.findPreloadMediaDesc(u);if(p){if(un()&&this.firefoxSsrcMidMap.set(u[0].ssrcId,p.attributes.mid),l&&(l.twcc||l.remb)){const v=this.sessionDesc.mediaDescriptions.indexOf(p);return this.sessionDesc.mediaDescriptions[v]=this.mungSendMediaDesc(p,l),{mid:p.attributes.mid,needExchangeSDP:!0}}return{mid:p.attributes.mid,needExchangeSDP:!1}}{const v=this.findAvailableMediaIndex(i,u,a);let E;return v===-1?(E=this.createOrRecycleSendMedia(i,u,h,"sendonly",a,l),this.updateBundleMids()):(E=fn(this.sessionDesc.mediaDescriptions[v]),E.attributes.direction="sendonly",E.attributes.ssrcs=u,E.attributes.ssrcGroups=h,this.sessionDesc.mediaDescriptions[v]=this.mungSendMediaDesc(E,l)),un()&&this.firefoxSsrcMidMap.set(u[0].ssrcId,E.attributes.mid),{needExchangeSDP:!0,mid:E.attributes.mid}}}stopSending(i){const t=this.sessionDesc.mediaDescriptions.filter(n=>n.attributes.mid&&i.indexOf(n.attributes.mid)!==-1);if(t.length!==i.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");t.forEach(n=>{n.attributes.ssrcs=[]}),this.updateBundleMids()}receive(i,t,n){const a=[];return i.forEach(l=>{const u=l._mediaStreamTrack.kind,h=this.findAvailableRecvMediaIndex(u);let p,v=!1;h===-1?(v=!0,p=this.createOrRecycleRecvMedia(l,[],"recvonly",t,n),this.updateBundleMids()):(p=fn(this.sessionDesc.mediaDescriptions[h]),p.attributes.direction="recvonly"),a.push({mid:p.attributes.mid,needCreateTransceiver:v})}),a}stopReceiving(i){const t=this.sessionDesc.mediaDescriptions.filter(n=>i.indexOf(n.attributes.mid)!==-1);if(t.length!==i.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");t.forEach(n=>{n.media.port="0",n.attributes.direction="inactive"}),this.updateBundleMids()}addRemoteCandidate(i){const{foundation:t,protocol:n,address:a,port:l,type:u,relatedAddress:h,relatedPort:p,priority:v}=new RTCIceCandidate(i),E={foundation:t??"",componentId:"1",transport:n??"",priority:v?v+"":"",connectionAddress:a??"",port:l?l+"":"",type:u?u+"":"",relAddr:h??"",relPort:p?p+"":"",extension:{}};this.candidates.some(y=>y.priority===E.priority&&y.connectionAddress===E.connectionAddress&&y.port===E.port)||(this._candidates.push(E),this.sessionDesc.mediaDescriptions.forEach(y=>{y.attributes.candidates=this.candidates}))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(i,t,n,a,l){const u=i._mediaStreamTrack.kind,h=this.rtpCapabilities.recv,p=Id(u,h,this.localCapabilities.send,u===je.AUDIO?l:a),v=u===je.VIDEO?h.videoExtensions:h.audioExtensions,E="".concat(++this.currentMidIndex);let y={media:{mediaType:u,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:p.map(I=>I.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:v,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:p,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:n,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(E)}};y=this.mungRecvMediaDsec(y,i);const C=this.findFirstClosedMedia(u);if(C){const I=this.sessionDesc.mediaDescriptions.indexOf(C);this.sessionDesc.mediaDescriptions[I]=y}else this.sessionDesc.mediaDescriptions.push(y);return y}muteRemote(i){const t=this.sessionDesc.mediaDescriptions.filter(n=>Be(i).call(i,n.attributes.mid||""));if(t.length!==i.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(n=>{n.attributes.direction="inactive"})}unmuteRemote(i){const t=this.sessionDesc.mediaDescriptions.filter(n=>Be(i).call(i,n.attributes.mid||""));if(t.length!==i.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(n=>{n.attributes.direction="recvonly"})}findAvailableMediaIndex(i,t,n){return this.sessionDesc.mediaDescriptions.findIndex(a=>{const l=a.media.mediaType===i&&a.media.port!=="0"&&(a.attributes.direction==="sendonly"||a.attributes.direction==="sendrecv")&&a.attributes.ssrcs.length===0;if(un()){if(l){const u=this.firefoxSsrcMidMap.get(t[0].ssrcId);return!(u||a.attributes.mid!=="0"&&a.attributes.mid!=="1")||!(!u||u!==a.attributes.mid)}return!1}return l&&a.attributes.mid===n})}findAvailableRecvMediaIndex(i){return this.sessionDesc.mediaDescriptions.findIndex(t=>{const n=t.media.mediaType===i&&t.media.port!=="0"&&(t.attributes.direction==="recvonly"||t.attributes.direction==="sendrecv");return t.attributes.mid!=="0"&&t.attributes.mid!=="1"&&n})}predictReceivingMids(i){const t=[];for(let n=0;n<i;n++)t.push((this.currentMidIndex+n+1).toString(10));return t}restartICE(i){i=fn(i),this._iceParameters=i,this.sessionDesc.mediaDescriptions.forEach(t=>{t.attributes.iceUfrag=i.iceUfrag,t.attributes.icePwd=i.icePwd})}createOrRecycleSendMedia(i,t,n,a,l,u){const h=this.rtpCapabilities.send,p=i===je.VIDEO?h.videoCodecs:h.audioCodecs,v=i===je.VIDEO?h.videoExtensions:h.audioExtensions;un()&&(l="".concat(++this.currentMidIndex));let E={media:{mediaType:i,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:p.map(C=>C.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:v,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:n,rtcpFeedbackWildcards:[],payloads:p,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:a,rtcpMux:!0,rtcpRsize:!0,mid:l}};E=this.mungSendMediaDesc(E,u);const y=this.findFirstClosedMedia(i);if(y){const C=this.sessionDesc.mediaDescriptions.indexOf(y);this.sessionDesc.mediaDescriptions[C]=E}else this.sessionDesc.mediaDescriptions.push(E);return E}mungRecvMediaDsec(i,t,n){const a=fn(i);return fE(a),uu(a,t),mE(a,t),kR(a),ip(a,n,this.localCapabilities.send),a}mungSendMediaDesc(i,t){const n=fn(i);return ip(n,t,this.localCapabilities.recv),Us(n),n}updateRecvMedia(i,t){const n=this.sessionDesc.mediaDescriptions.findIndex(a=>a.attributes.mid===i);if(n!==-1){const a=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[n],t);this.sessionDesc.mediaDescriptions[n]=a}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(i=>i.media.port!=="0").map(i=>i.attributes.mid)}findPreloadMediaDesc(i){return this.sessionDesc.mediaDescriptions.find(t=>{var n;return((n=t.attributes)===null||n===void 0||(n=n.ssrcs[0])===null||n===void 0?void 0:n.ssrcId)===i[0].ssrcId})}findFirstClosedMedia(i){return this.sessionDesc.mediaDescriptions.find(t=>un()?t.media.port==="0"&&t.media.mediaType===i:t.media.port==="0")}};const Wne=["sdp"];function MU(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function du(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?MU(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):MU(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}let ia=class Rp extends pM{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var t,n;return(t=(n=this.peerConnection.getReceivers()[0])===null||n===void 0||(n=n.transport)===null||n===void 0?void 0:n.state)!==null&&t!==void 0?t:null}get localCodecs(){return[]}set isInRestartIce(t){this._isInRestartIce=t}get isInRestartIce(){return this._isInRestartIce}constructor(t,n,a){super(t,n),w(this,"direction",void 0),w(this,"name",void 0),w(this,"store",void 0),w(this,"spec",void 0),w(this,"peerConnection",void 0),w(this,"initialOffer",void 0),w(this,"transport",void 0),w(this,"statsFilter",void 0),w(this,"localCandidateCount",0),w(this,"allCandidatesReceived",!1),w(this,"localCandidateAddress",null),w(this,"useXR",J("USE_XR")),w(this,"filter",{filterRTX:!J("USE_PUB_RTX")&&!J("USE_SUB_RTX"),filterVideoFec:J("FILTER_VIDEO_FEC"),filterAudioFec:J("FILTER_AUDIO_FEC")}),w(this,"extension",{useXR:this.useXR}),w(this,"_isInRestartIce",!1),w(this,"mutex",new Ur("P2PConnection-mutex")),w(this,"onLocalCandidate",void 0),w(this,"remoteSDP",void 0),w(this,"pendingCandidates",[]),w(this,"localCapabilities",void 0),w(this,"isReady",!1),w(this,"restartCnt",0),w(this,"curTurnServerIndex",0),this.store=n,this.spec=t,this.peerConnection=new RTCPeerConnection(Rp.resolvePCConfiguration(t,n.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=a??vi.SEND_ONLY,this.name=this.direction===vi.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=pE(this.peerConnection,J("STATS_UPDATE_INTERVAL"),void 0,un()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(t){try{const n=await MR(this.filter,this.extension);if(this.localCapabilities=op(n),t){const{sdp:a}=t,l=jne(t,Wne),u=function(){const y={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},C=D0(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"sendonly"),I={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},k={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},G={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(cs(C,y,"videoExtensions",I,k,G),cs(C,y,"videoCodecs",I,k,G),cs(C,y,"audioExtensions",I,k,G),cs(C,y,"audioCodecs",I,k,G),J("RAISE_H264_BASELINE_PRIORITY")){const B=G.videoCodecs.findIndex(j=>j.rtpMap&&j.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&j.fmtp&&j.fmtp.parameters["profile-level-id"]==="42001f");if(B!==-1){const j=G.videoCodecs.findIndex(q=>q.rtpMap&&q.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(j<B){L.debug("raising H264 baseline profile priority");const q=G.videoCodecs[B];G.videoCodecs.splice(B,1),G.videoCodecs.splice(j,0,q)}j!==-1&&J("FILTER_SEND_H264_BASELINE")&&(I.videoCodecs=I.videoCodecs.filter(q=>!(q.rtpMap&&q.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&q.fmtp&&q.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:I,recv:k,sendrecv:G}}(this.filter,this.extension,a);this.remoteSDP=new LU({remoteIceParameters:l.iceParameters,remoteDtlsParameters:l.dtlsParameters,candidates:[],remoteRTPCapabilities:u,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;const h=await this.peerConnection.createAnswer();if(!h.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");const p=Fs(h.sdp);await this.peerConnection.setLocalDescription(h);const v=await kU(this.filter,this.extension,h.sdp);this.localCapabilities=op(v);const E=this.peerConnection.getTransceivers()[0];return E!=null&&E.receiver&&E.receiver.transport&&this.tryBindTransportEvents(E.receiver.transport),du(du({},p),{},{sdp:h.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});const a=await this.peerConnection.createOffer();if(!a.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const l=Fs(a.sdp);return this.initialOffer=a,du(du({},l),{},{sdp:a.sdp})}}catch(n){throw new Te(z.GET_LOCAL_CONNECTION_PARAMS_FAILED,n.toString())}}async connect(t){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);const{sdp:n,iceParameters:a,dtlsParameters:l}=t,u=await kU(this.filter,this.extension,n);this.remoteSDP=new LU({remoteIceParameters:a,remoteDtlsParameters:l,candidates:[],remoteRTPCapabilities:u,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});const h=this.peerConnection.getTransceivers()[0];h!=null&&h.sender&&h.sender.transport&&this.tryBindTransportEvents(h.sender.transport)}catch(n){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(n.toString()))}}async addRemoteCandidate(t){try{t&&this.pendingCandidates.push(t),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach(n=>{this.peerConnection.addIceCandidate(n)}),this.pendingCandidates=[])}catch(n){throw new Te(z.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(n.toString()))}}send(t,n,a){var l=this;return Do(function*(){const u=yield _t(l.mutex.lock("From P2PConnection.send"));try{if(!l.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const h=[],p=l.remoteSDP.receive(t,n,a);t.forEach((j,q)=>{if(p[q].needCreateTransceiver){const Z=l.peerConnection.addTransceiver(j._mediaStreamTrack,{direction:"sendonly"});h.push(Z),j._updateRtpTransceiver(Z)}else{const Z=l.peerConnection.getTransceivers().find(re=>re.mid===p[q].mid);if(!Z)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(p[q].mid));h.push(Z),j._updateRtpTransceiver(Z)}}),un()&&J("SIMULCAST")===!0&&(yield _t(l.applySimulcastForFirefox(h,t)));const v=p.map(j=>j.mid),E=yield _t(l.peerConnection.createOffer()),y=l.mungSendOfferSDP(E.sdp,t,v),C=In.parse(y),I=v.map(j=>{const q=C.mediaDescriptions.find(Z=>Z.attributes.mid===j);if(!q)throw new Error("Cannot extract ssrc from mediaDescription.");return DR(q,J("USE_PUB_RTX"))}),k=h.map((j,q)=>{const Z=v[q];return{localSSRC:I[q],id:Z}});yield _t(l.peerConnection.setLocalDescription({type:"offer",sdp:y}));try{yield k}catch(j){const q=l.remoteSDP.toString();throw yield _t(l.peerConnection.setLocalDescription({type:"offer",sdp:y})),yield _t(l.peerConnection.setRemoteDescription({type:"answer",sdp:q})),yield _t(l.stopSending(v,!0)),j}yield _t(l.applySimulcastEncodings(h,t)),yield _t(l.applySendEncodings(h,t));const G=l.remoteSDP.toString(),B=l.logSDPExchange(y,"offer","local","send");return B==null||B(G),yield _t(l.setRemoteDescription({type:"answer",sdp:G})),h.map((j,q)=>{const Z=v[q];return{localSSRC:I[q],id:Z}})}catch(h){throw h instanceof Te?h:new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(h.toString()))}finally{u()}})()}async stopSending(t,n){const a=n?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const l=this.peerConnection.getTransceivers().filter(v=>t.indexOf(v.mid)!==-1);if(l.length!==t.length)throw new Error("Transceivers' length (".concat(l.length,") doesn't match mids' length (").concat(t.length,") when trying to call P2PConnection.stopSending."));l.map(v=>{var E;v.direction="inactive",(E=v.stop)===null||E===void 0||E.call(v)});const u=await this.peerConnection.createOffer(),h=this.logSDPExchange(u.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(u),this.remoteSDP.stopReceiving(t);const p=this.remoteSDP.toString();h==null||h(p),await this.setRemoteDescription({type:"answer",sdp:p})}catch(l){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(l.toString()))}finally{a&&a()}}async receive(t,n,a,l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{mid:u,needExchangeSDP:h}=this.remoteSDP.send(t,n,a,l);if(h){const v=this.remoteSDP.toString(),E=this.logSDPExchange(v,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:v});const y=await this.peerConnection.createAnswer(),C=this.mungReceiveAnswerSDP(y.sdp,u,t);E==null||E(C||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:C}),L.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," by exchanging SDP."))}else L.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," no need to exchange SDP."));const p=this.peerConnection.getTransceivers().find(v=>v.mid===u);if(!p||p.mid===null)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:p.receiver.track,mid:p.mid,transceiver:p}}catch(u){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async mockReceive(t,n,a,l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{mid:u,needExchangeSDP:h}=this.remoteSDP.send(t,n,a,l);if(h){const p=this.remoteSDP.toString(),v=this.logSDPExchange(p,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:p});const E=await this.peerConnection.createAnswer(),y=this.mungReceiveAnswerSDP(E.sdp,u,t);v==null||v(y||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:y}),L.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," by exchanging SDP."))}else L.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," no need to exchange SDP."))}catch(u){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async stopReceiving(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(t);const n=this.remoteSDP.toString(),a=this.logSDPExchange(n,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:n});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(n){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(n.toString()))}}async restartICE(t){try{if(this.store.p2pTransport===Xc.Auto&&(this.store.p2pTransport=Xc.SdRtn,cn().supportPCSetConfiguration&&this.peerConnection.setConfiguration(Rp.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,cn().supportPCSetConfiguration&&this.peerConnection.setConfiguration(Rp.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!t){this.restartCnt++,this.isReady=!1;const n=await this.peerConnection.createOffer({iceRestart:!0});if(!n.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const{iceParameters:a}=Fs(n.sdp);return this.store.descriptionStart(),this.direction===vi.SEND_ONLY&&await this.peerConnection.setLocalDescription(n),a}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(t),this.store.descriptionStart(),this.direction===vi.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});const n=await this.peerConnection.createAnswer();if(!n.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");const{iceParameters:a}=Fs(n.sdp);return await this.peerConnection.setLocalDescription(n),a}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(n){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(n.toString()))}}close(){var t;this.peerConnection.close(),this.peerConnection.onicecandidate=null,(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}async updateEncoderConfig(t,n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const a=await this.peerConnection.createOffer(),l=this.mungSendOfferSDP(a.sdp,[n],[t]);this.remoteSDP.updateRecvMedia(t,n);const u=this.remoteSDP.toString(),h=this.logSDPExchange(l,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:l}),h==null||h(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(a){throw new Te(z.EXCHANGE_SDP_FAILED,a.toString())}}async updateSendParameters(t,n){const a=this.peerConnection.getTransceivers().filter(l=>l.mid===t);a.length===1&&(this.isVP8Simulcast(n)?un()||await this.applySimulcastEncodings(a,[n]):await this.applySendEncodings(a,[n]))}setStatsRemoteVideoIsReady(t,n){this.statsFilter.setVideoIsReady2(t,n)}async replaceTrack(t,n){const a=this.peerConnection.getTransceivers().find(l=>l.mid===n);a&&await a.sender.replaceTrack(t._mediaStreamTrack)}async getSelectedCandidatePair(){const t=this.peerConnection.getReceivers();if(t.length>0&&t[0].transport&&t[0].transport.iceTransport&&t[0].transport.iceTransport.getSelectedCandidatePair&&t[0].transport.iceTransport.getSelectedCandidatePair()){const n=t[0].transport.iceTransport,{local:a,remote:l}=n.getSelectedCandidatePair();return{local:du(du({},Ic),{},{candidateType:a.type,protocol:a.protocol,address:a.address,port:a.port}),remote:du(du({},Ic),{},{candidateType:l.type,protocol:l.protocol,address:l.address,port:l.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t,n;Be(t=["connected","completed"]).call(t,this.peerConnection.iceConnectionState)&&(this.isReady=!1),(n=this.onICEConnectionStateChange)===null||n===void 0||n.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;this.peerConnection.connectionState==="connected"&&(this.restartCnt=0),(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=t=>{if(t.candidate){var n;t.candidate.candidate&&(this.localCandidateAddress=t.candidate.address,(n=this.onLocalCandidate)===null||n===void 0||n.call(this,t.candidate.toJSON())),this.localCandidateCount+=1}else this.allCandidatesReceived=!0,L.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t,n){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const l={iceServers:[]};var u;return t.iceServers?l.iceServers=t.iceServers:t.turnServer&&t.turnServer.mode!=="off"&&(kh(t.turnServer.servers)?l.iceServers=t.turnServer.servers:(l.iceServers&&l.iceServers.push(...Rp.turnServerConfigToIceServers(t.turnServer.servers,n,a)),J("USE_TURN_SERVER_OF_GATEWAY")&&l.iceServers&&t.turnServer.serversFromGateway&&l.iceServers.push(...Rp.turnServerConfigToIceServers(t.turnServer.serversFromGateway,n,a)),Be(u=[Xc.Relay,Xc.SdRtn]).call(u,n)&&(l.iceTransportPolicy="relay"),J("FORCE_TURN_TCP")?l.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(h=>{h.forceturn&&(l.iceTransportPolicy="relay")}))),J("ENABLE_ENCODED_TRANSFORM")&&cn().supportWebRTCEncodedTransform&&(l.encodedInsertableStreams=!0),L.debug("P2PConnection p2pTransport is ".concat(n)),l}static turnServerConfigToIceServers(t,n){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const l=[],u=t.filter(p=>p.tcpport);L.debug("P2PConnection turnServers is ".concat(u,", current index is ").concat(a));const h=u.length>a?u[a]:u[0];switch(n){case Xc.SdRtn:const p=t.filter(E=>{var y;return Be(y=E.username).call(y,"glb:")&&E.turnServerURL==E.turnServerURL}),v=p.length>a?p[a]:p[0];v&&(l.push({username:v.username,credential:v.password,credentialType:"password",urls:"turn:".concat(eu(v.turnServerURL),":").concat(v.tcpport,"?transport=udp")}),l.push({username:v.username,credential:v.password,credentialType:"password",urls:"turns:".concat(eu(v.turnServerURL),":").concat(v.tcpport,"?transport=tcp")}));break;case Xc.Relay:h&&(l.push({username:h.username,credential:h.password,credentialType:"password",urls:"turn:".concat(h.turnServerURL,":").concat(h.tcpport,"?transport=udp")}),l.push({username:h.username,credential:h.password,credentialType:"password",urls:"turns:".concat(eu(h.turnServerURL),":").concat(h.tcpport,"?transport=tcp")}));break;default:h&&(l.push({username:h.username,credential:h.password,credentialType:"password",urls:"turn:".concat(h.turnServerURL,":").concat(h.tcpport,"?transport=udp")}),l.push({username:h.username,credential:h.password,credentialType:"password",urls:"turns:".concat(eu(h.turnServerURL),":").concat(h.tcpport,"?transport=tcp")}),l.push({username:h.username,credential:h.password,credentialType:"password",urls:"stun:".concat(h.turnServerURL,":").concat(h.tcpport)}))}return l}tryBindTransportEvents(t){if(t){this.transport=t,t.onstatechange=()=>{var a;t!=null&&t.state&&((a=this.onDTLSTransportStateChange)===null||a===void 0||a.call(this,t.state))},t.onerror=a=>{var l;(l=this.onDTLSTransportError)===null||l===void 0||l.call(this,"error"in a?a.error:a)};const n=t.iceTransport;n&&(n.onstatechange=()=>{const a=t==null?void 0:t.iceTransport.state;var l;a&&((l=this.onICETransportStateChange)===null||l===void 0||l.call(this,a))},n.getSelectedCandidatePair&&(n.onselectedcandidatepairchange=()=>{if(n.getSelectedCandidatePair()){const{local:a,remote:l}=n.getSelectedCandidatePair();L.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:a.type,protocol:a.protocol}),", remote ").concat(JSON.stringify({candidateType:l.type,protocol:l.protocol,address:l.address,port:l.port})," )"))}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(t,n){var a;if(n||(n=this.peerConnection.getSenders().find(y=>y.track===t._mediaStreamTrack)),!n)return L.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(t))return L.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!cn().supportSetRtpSenderParameters)return L.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const l={},u={};switch(t._optimizationMode){case"motion":l.degradationPreference="maintain-framerate";break;case"detail":l.degradationPreference="maintain-resolution";break;default:l.degradationPreference="balanced"}if(t._encoderConfig){var h;const{bitrateMax:y,frameRate:C,scaleResolutionDownBy:I}=t._encoderConfig;y&&(u.maxBitrate=1e3*y),Be(h=t._hints).call(h,mn.LOW_STREAM)&&(C&&(u.maxFramerate=Jo(C)),I&&I>=1&&(u.scaleResolutionDownBy=I))}if(J("DSCP_TYPE")&&Wl()){var p;const y=J("DSCP_TYPE");Be(p=["very-low","low","medium","high"]).call(p,y)&&(u.networkPriority=y)}const v=n.getParameters(),E=(a=v.encodings)===null||a===void 0?void 0:a[0];un()&&!E&&(l.encodings=[u]),E&&Object.assign(E,u),Object.assign(v,l),L.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(v.encodings))),await n.setParameters(v)}async applySendEncodings(t,n){try{if(!cn().supportSetRtpSenderParameters||t.length!==n.length)return;for(let a=0;a<t.length;a++){const l=t[a],u=n[a];u instanceof Rt&&!this.isVP8Simulcast(u)&&await this.updateRtpSenderEncodings(u,l.sender)}}catch{L.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(t,n,a){const l=In.parse(t);return n.forEach((u,h)=>{const p=a[h],v=l.mediaDescriptions.find(E=>E.attributes.mid===p);v&&(uu(v,u),LR(v,u,this.store.codec))}),In.print(l)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var n;(n=this.onFirstAudioReceived)===null||n===void 0||n.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var n;(n=this.onFirstVideoReceived)===null||n===void 0||n.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var n;(n=this.onFirstAudioDecoded)===null||n===void 0||n.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,n,a)=>{var l;(l=this.onFirstVideoDecoded)===null||l===void 0||l.call(this,t,n,a)},this.statsFilter.onSelectedLocalCandidateChanged=(t,n)=>{var a;(a=this.onSelectedLocalCandidateChanged)===null||a===void 0||a.call(this,t,n)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,n)=>{var a;(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0||a.call(this,t,n)},this.statsFilter.onFirstVideoDecodedTimeout=t=>{var n;(n=this.onFirstVideoDecodedTimeout)===null||n===void 0||n.call(this,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(t,n){if(t.length===n.length)for(let v=0;v<t.length;v++){var a,l,u,h,p;const E=t[v],y=n[v];if(y instanceof Rt&&!Be(a=y._hints).call(a,mn.LOW_STREAM)&&(l=y._encoderConfig)!==null&&l!==void 0&&l.bitrateMax&&((u=y._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(h=y._scalabilityMode)!==null&&h!==void 0&&h.numSpatialLayers&&((p=y._scalabilityMode)===null||p===void 0?void 0:p.numSpatialLayers)>1&&this.store.codec==="vp8"){const C={},I={high:1e3*(y._encoderConfig.bitrateMax-50),medium:5e4};C.encodings=[{rid:"m",active:!0,maxBitrate:I.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:I.high}];const k=E.sender.getParameters();await E.sender.setParameters(Object.assign(k,C))}}}async applySimulcastEncodings(t,n){if(!un()&&t.length===n.length)for(let a=0;a<t.length;a++){const l=n[a];if(l instanceof Rt&&this.isVP8Simulcast(l)){const u=t[a],h={},p={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};h.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:p.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:p.medium,scaleResolutionDownBy:4}];const v=u.sender.getParameters();await u.sender.setParameters(Object.assign(v,h))}}}isVP8Simulcast(t){var n,a,l,u,h;return!!(t instanceof Rt&&J("SIMULCAST")&&this.store.codec==="vp8"&&!Be(n=t._hints).call(n,mn.LOW_STREAM)&&(a=t._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&((l=t._encoderConfig)===null||l===void 0?void 0:l.bitrateMax)>200&&(u=t._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((h=t._scalabilityMode)===null||h===void 0?void 0:h.numSpatialLayers)>1)}logSDPExchange(t,n,a,l){if(J("SDP_LOGGING"))return L.upload("[".concat(this.store.clientId,"] exchanging ").concat(a," ").concat(n," SDP during P2PConnection.").concat(l,`
`),t),n==="offer"?u=>{this.logSDPExchange(u,"answer",a==="local"?"remote":"local",l)}:void 0}async muteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const n=this.peerConnection.getTransceivers().filter(h=>h.mid&&t.indexOf(h.mid)!==-1);if(n.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");n.map(h=>{h.direction="inactive"});const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.muteRemote(t);const u=this.remoteSDP.toString();l==null||l(u),await this.setRemoteDescription({type:"answer",sdp:u})}catch(n){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(n.toString()))}}async unmuteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const n=this.peerConnection.getTransceivers().filter(h=>h.mid&&t.indexOf(h.mid)!==-1);if(n.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");n.map(async h=>{h.direction="sendonly"});const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.unmuteRemote(t);const u=this.remoteSDP.toString();l==null||l(u),await this.setRemoteDescription({type:"answer",sdp:u})}catch(n){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(n.toString()))}}async getRemoteSSRC(t,n){var a,l;if(n=(a=n)!==null&&a!==void 0?a:(l=this.currentRemoteDescription)===null||l===void 0?void 0:l.sdp){var u;const h=(u=In.parse(n).mediaDescriptions.find(p=>p.attributes.mid===t))===null||u===void 0?void 0:u.attributes.ssrcs;return h==null?void 0:h[0].ssrcId}}async setRemoteDescription(t){var n;await this.peerConnection.setRemoteDescription(t),Be(n=["connected","completed"]).call(n,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(t,n,a){const l=In.parse(t),u=l.mediaDescriptions.find(h=>h.attributes.mid===n);return u&&(a===je.AUDIO&&u.media.mediaType==="audio"&&Us(u),this.useXR&&k0(l)),In.print(l)}};function ls(i,t,n){const a=i[t];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return n.value=async function(){const l=this.mutex,u=await l.lock("From P2PConnection.".concat(t));try{for(var h=arguments.length,p=new Array(h),v=0;v<h;v++)p[v]=arguments[v];return await a.apply(this,p)}finally{u()}},n}function FR(i,t){let n=document.createElement("video"),a=document.createElement("canvas");n.setAttribute("style","display:none"),a.setAttribute("style","display:none"),n.setAttribute("muted",""),n.muted=!0,n.setAttribute("autoplay",""),n.autoplay=!0,n.setAttribute("playsinline",""),a.width=Jo(t.width),a.height=Jo(t.height);const l=Jo(t.framerate||15);document.body.append(n),document.body.append(a);let u=i._mediaStreamTrack;n.srcObject=new MediaStream([u]),n.play();const h=a.getContext("2d");if(!h)throw new ue(z.UNEXPECTED_ERROR,"can not get canvas context");const p=cn(),v=a.captureStream(p.supportRequestFrame?0:l).getVideoTracks()[0];v.canvas||(v.canvas=a),a.startCapture=()=>{if(!n)return a.stopCapture&&a.stopCapture();if(n.paused&&n.play(),n.videoHeight>2&&n.videoWidth>2){const y=n.videoWidth,C=n.videoHeight/y,I=a.width*C;Math.abs(I-a.height)>=2&&(L.debug("adjust low stream resolution","".concat(a.width,"x").concat(a.height," -> ").concat(a.width,"x").concat(I)),a.height=I)}h.drawImage(n,0,0,a.width,a.height),v.requestFrame&&v.requestFrame(),u!==i._mediaStreamTrack&&(u=i._mediaStreamTrack,n.srcObject=new MediaStream([u]))},a.stopCapture=qT(()=>a.startCapture&&a.startCapture(),l);const E=v.stop;return v.stop=()=>{E.call(v),n&&(n.remove(),n.srcObject=null,n=null),a&&(a.width=0,a.remove(),a.stopCapture&&a.stopCapture(),a.startCapture=void 0,a.stopCapture=void 0,a=null),L.debug("clean low stream renderer")},v}var L0,FU,Or,hu,ui,ap,UR,ol,xa,BR,oa;Re([ls,H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",_e)],ia.prototype,"establish",null),Re([ls,H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",_e)],ia.prototype,"connect",null),Re([ls,H("design:type",Function),H("design:paramtypes",[String,Array,String,String]),H("design:returntype",_e)],ia.prototype,"receive",null),Re([ls,H("design:type",Function),H("design:paramtypes",[String,Array,String,String]),H("design:returntype",_e)],ia.prototype,"mockReceive",null),Re([ls,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],ia.prototype,"stopReceiving",null),Re([ls,H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",_e)],ia.prototype,"restartICE",null),Re([ls,H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],ia.prototype,"close",null),Re([ls,H("design:type",Function),H("design:paramtypes",[String,ci]),H("design:returntype",_e)],ia.prototype,"updateEncoderConfig",null),Re([ls,H("design:type",Function),H("design:paramtypes",[String,ci]),H("design:returntype",_e)],ia.prototype,"updateSendParameters",null),Re([ls,H("design:type",Function),H("design:paramtypes",[ci,String]),H("design:returntype",_e)],ia.prototype,"replaceTrack",null),Re([ls,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],ia.prototype,"muteLocal",null),Re([ls,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],ia.prototype,"unmuteLocal",null),function(i){i[i.HEIGHT=2033]="HEIGHT",i[i.FRAME_RATE=2034]="FRAME_RATE",i[i.WIDTH=2035]="WIDTH"}(L0||(L0={})),function(i){i[i.HEIGHT=2072]="HEIGHT",i[i.FRAME_RATE=2074]="FRAME_RATE",i[i.WIDTH=2076]="WIDTH"}(FU||(FU={})),function(i){i[i.FRAME_RATE=2002]="FRAME_RATE",i[i.WIDTH=2003]="WIDTH",i[i.HEIGHT=2004]="HEIGHT",i[i.PACKAGE_LOST=2005]="PACKAGE_LOST",i[i.AVG_ENCODE=2007]="AVG_ENCODE",i[i.NACKS=2009]="NACKS",i[i.PLIS=2010]="PLIS",i[i.FIRS=2011]="FIRS",i[i.BITRATE=2012]="BITRATE",i[i.PACKAGE_RATE=2031]="PACKAGE_RATE",i[i.ADAPTATION=2032]="ADAPTATION",i[i.ACTUAL_ENCODED=2060]="ACTUAL_ENCODED",i[i.BANDWIDTH=2061]="BANDWIDTH",i[i.RETRANSMIT=2062]="RETRANSMIT",i[i.TARGET_ENCODED=2064]="TARGET_ENCODED",i[i.TRANSMIT=2066]="TRANSMIT",i[i.FREEZE=2082]="FREEZE",i[i.DISABLED=2095]="DISABLED",i[i.PLAYER_STATUS=2128]="PLAYER_STATUS",i[i.QP_SUM=2143]="QP_SUM"}(Or||(Or={})),function(i){i[i.BITRATE=2069]="BITRATE",i[i.PACKAGE_LOST=2070]="PACKAGE_LOST",i[i.PACKAGE_RATE=2071]="PACKAGE_RATE",i[i.HEIGHT=2073]="HEIGHT",i[i.FRAME_RATE=2075]="FRAME_RATE",i[i.WIDTH=2077]="WIDTH"}(hu||(hu={})),function(i){i[i.JITTER=-1]="JITTER",i[i.PACKAGE_LOST=2014]="PACKAGE_LOST",i[i.WIDTH=2018]="WIDTH",i[i.HEIGHT=2019]="HEIGHT",i[i.FRAME_RATE=2020]="FRAME_RATE",i[i.JITTER_BUFFER=2023]="JITTER_BUFFER",i[i.CURRENT_DELAY=2024]="CURRENT_DELAY",i[i.NACKS=2026]="NACKS",i[i.PLIS=2027]="PLIS",i[i.FIRS=2028]="FIRS",i[i.BITRATE=2029]="BITRATE",i[i.PACKAGE_RATE=2078]="PACKAGE_RATE",i[i.FREEZE=2084]="FREEZE",i[i.DISABLED=2101]="DISABLED",i[i.PLAYER_STATUS=2129]="PLAYER_STATUS",i[i.QP_SUM=2144]="QP_SUM",i[i.I_FRAME_DELAY=2149]="I_FRAME_DELAY"}(ui||(ui={})),function(i){i[i.FRAME_RATE_DECODE=2021]="FRAME_RATE_DECODE",i[i.FRAME_RATE_RENDER=2022]="FRAME_RATE_RENDER",i[i.FREEZE_TIME=2109]="FREEZE_TIME",i[i.FREEZE_TIME_RENDER=2147]="FREEZE_TIME_RENDER"}(ap||(ap={})),function(i){i[i.PCM_LEVEL=2104]="PCM_LEVEL"}(UR||(UR={})),function(i){i[i.PACKAGE_LOST=-1]="PACKAGE_LOST",i[i.LEVEL=2038]="LEVEL",i[i.BITRATE=2039]="BITRATE",i[i.PACKAGE_RATE=2040]="PACKAGE_RATE",i[i.AEC_RETURN_LOSS=2041]="AEC_RETURN_LOSS",i[i.AEC_RETURN_LOSS_ENH=2042]="AEC_RETURN_LOSS_ENH",i[i.FREEZE=2081]="FREEZE",i[i.DISABLED=2096]="DISABLED"}(ol||(ol={})),function(i){i[i.BITRATE=2044]="BITRATE",i[i.PACKAGE_LOST=2045]="PACKAGE_LOST",i[i.PACKAGE_RATE=2046]="PACKAGE_RATE",i[i.CURRENT_DELAY=2047]="CURRENT_DELAY",i[i.JITTER_BUFFER=2054]="JITTER_BUFFER",i[i.JITTER=2055]="JITTER",i[i.FREEZE=2083]="FREEZE",i[i.DISABLED=2102]="DISABLED",i[i.PCM_LEVEL=2105]="PCM_LEVEL",i[i.PLAYER_STATUS=2130]="PLAYER_STATUS",i[i.CONCEALED_SAMPLES=2148]="CONCEALED_SAMPLES"}(xa||(xa={})),function(i){i[i.FREEZE_TIME=-1]="FREEZE_TIME",i[i.LEVEL=2043]="LEVEL"}(BR||(BR={})),function(i){i[i.RTT=2006]="RTT",i[i.CONN_TYPE=801]="CONN_TYPE"}(oa||(oa={}));const al=1e3,Ad=3;function Ot(i,t,n){n!=null&&Number.isFinite(n)&&(i[t]=Math.round(Math.max(0,n)))}function UU(i){const t={[oa.CONN_TYPE]:0,[oa.RTT]:i.rtt};switch(i.selectedCandidatePair.localCandidate.candidateType){case"relay":{const n=i.selectedCandidatePair.localCandidate.relayProtocol;n==="udp"&&(t[oa.CONN_TYPE]=1),n==="tcp"&&(t[oa.CONN_TYPE]=3),n==="tls"&&(t[oa.CONN_TYPE]=4);break}case"srflx":t[oa.CONN_TYPE]=2}return t}class BU extends wn{constructor(t){super(),w(this,"store",void 0),w(this,"uploadWRTCStatsTimer",void 0),w(this,"uploadOutboundDenoiserStatsTimer",void 0),w(this,"uploadExtStatsTimer",void 0),w(this,"uploadExtUsageStatsTimer",void 0),w(this,"uploadInboundExtStatsTimer",void 0),w(this,"requestStats",void 0),w(this,"requestTransportStats",void 0),w(this,"requestLocalMedia",void 0),w(this,"requestRemoteMedia",void 0),w(this,"requestAllTracks",void 0),w(this,"requestVideoIsReady",void 0),w(this,"requestUploadStats",void 0),w(this,"requestUpload",void 0),w(this,"uploadOutboundStarted",!1),w(this,"uploadInboundStarted",!1),w(this,"uploadTransportStarted",!1),w(this,"uploadExtensionUsageStarted",!1),w(this,"lastRecvStats",void 0),w(this,"lastSendStats",void 0),w(this,"lastFullRecvStats",void 0),w(this,"lastFullSendStats",void 0),w(this,"needUploadRenderFreezeTime",!0),this.store=t}uploadWRTCStats(t){if(!this.requestStats||!this.requestUploadStats)return;let n,a;if(this.uploadTransportStarted&&(n=this.requestStats(),this.store.useP2P&&(a=this.requestStats(!0))),!n&&this.uploadOutboundStarted&&(n=this.requestStats()),!a&&this.uploadInboundStarted&&(a=this.requestStats(!0)),n||a){const l={};if(this.uploadTransportStarted&&n){const u=this.getTransportStats(n,a,t);u&&(l.misc=[u])}if(this.uploadOutboundStarted&&n){const u=this.getOutboundStats(n,t?this.lastSendStats:this.lastFullSendStats,t);u&&(l.outbound=[u])}if(this.uploadInboundStarted&&a){const u=this.getInboundStats(a,t?this.lastRecvStats:this.lastFullRecvStats,t);u&&(l.inbound=u)}this.requestUploadStats(l)}this.lastRecvStats=a,this.lastSendStats=n,t||(this.lastFullRecvStats=a,this.lastFullSendStats=n)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;let t=1;this.uploadWRTCStatsTimer=window.setInterval(()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted)return this.stopUploadWRTCStats();this.uploadWRTCStats(t!==Ad),++t===Ad+1&&(t=1)},al)}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0)}getTransportStats(t,n,a){if(!this.requestStats)return;if(a)return t.rtt==null?void 0:{addition:{[oa.RTT]:t.rtt,[oa.CONN_TYPE]:void 0}};const l=UU(t);if(this.store.useP2P){if(n){const u=UU(n);l[oa.CONN_TYPE]+=u[oa.CONN_TYPE]<<3}l[oa.CONN_TYPE]+=110}else l[oa.CONN_TYPE]+=100;return{addition:l}}getOutboundStats(t,n,a){if(!this.requestUploadStats||!this.requestLocalMedia)return;const l=this.requestLocalMedia();if(!l||l.length===0)return;let u,h,p;return l.forEach(v=>{let[E,{track:y,ssrcs:C}]=v;switch(E){case Ie.LocalVideoLowTrack:case Ie.LocalVideoTrack:if(E===Ie.LocalVideoTrack){const I=function(B,j,q,Z,re){const Ce=j.videoSend.find(Ae=>Ae.ssrc===B);if(!Ce)return;const pe={},{sentFrame:fe,inputFrame:ye}=Ce;if(ye&&fe){const Ae=ye.frameRate,Ne=fe.frameRate;pe[Or.FREEZE]=function(it,yt){let gn=!0;return gn=!(it<=5)&&(it<=10?yt<3:it<=20?yt<4:yt<5),gn}(Ae,Ne)?1:0}if(Ot(pe,Or.QP_SUM,Ce.qpSumPerFrame),re)return pe;switch(fe&&(Ot(pe,Or.HEIGHT,fe.height),Ot(pe,Or.WIDTH,fe.width),Ot(pe,Or.FRAME_RATE,fe.frameRate)),pe[Or.DISABLED]=Z._originMediaStreamTrack&&!Z._originMediaStreamTrack.enabled||Z._mediaStreamTrack&&!Z._mediaStreamTrack.enabled?1:0,Ce.adaptionChangeReason){case"none":pe[Or.ADAPTATION]=0;break;case"cpu":pe[Or.ADAPTATION]=1;break;case"bandwidth":pe[Or.ADAPTATION]=2;break;case"other":pe[Or.ADAPTATION]=3}pe[Or.PLAYER_STATUS]=KT[Z._player?Z._player.videoElementStatus:"uninit"],Ot(pe,Or.NACKS,Ce.nacksCount),Ot(pe,Or.PLIS,Ce.plisCount),Ot(pe,Or.FIRS,Ce.firsCount),Ot(pe,Or.AVG_ENCODE,Ce.avgEncodeMs);const Ee=q&&q.videoSend.find(Ae=>Ae.ssrc===B);if(Ee){let Ae=re?al:al*Ad;Ee.timestamp&&Ce.timestamp&&(Ae=Ce.timestamp-Ee.timestamp),Ee.packets!=null&&Ce.packets!=null&&Ot(pe,Or.PACKAGE_RATE,1e3*(Ce.packets-Ee.packets)/Ae),Ce.packetsLost!=null&&Ee.packetsLost!=null&&Ot(pe,Or.PACKAGE_LOST,Ce.packetsLost-Ee.packetsLost),Ee.bytes!=null&&Ce.bytes!=null&&Ot(pe,Or.BITRATE,8*(Ce.bytes-Ee.bytes)/Ae)}return pe}(C[0].ssrcId,t,n,y,a),k=a?null:function(B,j,q){const Z=j.videoSend.find(Ee=>Ee.ssrc===B);if(!Z)return null;const re={},Ce=Z.inputFrame,pe=Ce&&Ce.height||q&&q._videoHeight||0,fe=Ce&&Ce.width||q&&q._videoWidth||0,ye=Ce&&Ce.frameRate||0;return Ot(re,L0.HEIGHT,pe),Ot(re,L0.WIDTH,fe),Ot(re,L0.FRAME_RATE,ye),re}(C[0].ssrcId,t,y),G=a?null:function(B){const j={};return Ot(j,Or.RETRANSMIT,B.bitrate.retransmit),Ot(j,Or.TARGET_ENCODED,B.bitrate.targetEncoded),Ot(j,Or.ACTUAL_ENCODED,B.bitrate.actualEncoded),Ot(j,Or.TRANSMIT,B.bitrate.transmit),Ot(j,Or.BANDWIDTH,B.sendBandwidth),j}(t);h=Object.assign({},I,k,G)}else p=a?void 0:function(I,k,G){const B=k.videoSend.find(Z=>Z.ssrc===I);if(!B)return;const j={},q=B.sentFrame;if(q&&(Ot(j,hu.HEIGHT,q.height),Ot(j,hu.WIDTH,q.width),Ot(j,hu.FRAME_RATE,q.frameRate)),G){const Z=G.videoSend.find(re=>re.ssrc===I);if(Z){let re=al*Ad;Z.timestamp&&B.timestamp&&(re=B.timestamp-Z.timestamp),Z.packets!=null&&B.packets!=null&&Ot(j,hu.PACKAGE_RATE,1e3*(B.packets-Z.packets)/re),B.packetsLost!=null&&Z.packetsLost!=null&&Ot(j,hu.PACKAGE_LOST,B.packetsLost-Z.packetsLost),Z.bytes!=null&&B.bytes!=null&&Ot(j,hu.BITRATE,8*(B.bytes-Z.bytes)/re)}}return j}(C[0].ssrcId,t,n);break;case Ie.LocalAudioTrack:u=a?void 0:function(I,k,G,B){const j=k.audioSend.find(pe=>pe.ssrc===I);if(!j)return;const q={};q[ol.DISABLED]=B._originMediaStreamTrack&&!B._originMediaStreamTrack.enabled||B._mediaStreamTrack&&!B._mediaStreamTrack.enabled?1:0;const Z=B._source.getAccurateVolumeLevel(),re=j.inputLevel;Ot(q,ol.LEVEL,100*(re??Z)),Ot(q,UR.PCM_LEVEL,100*Z),Ot(q,ol.AEC_RETURN_LOSS,j.aecReturnLoss),Ot(q,ol.AEC_RETURN_LOSS_ENH,j.aecReturnLossEnhancement),q[ol.FREEZE]=0;const Ce=G&&G.audioSend.find(pe=>pe.ssrc===I);if(Ce){let pe=al*Ad;Ce.timestamp&&j.timestamp&&(pe=j.timestamp-Ce.timestamp),Ce.bytes!=null&&j.bytes!=null&&Ot(q,ol.BITRATE,8*(j.bytes-Ce.bytes)/pe),Ce.packets!=null&&j.packets!=null&&Ot(q,ol.PACKAGE_RATE,1e3*(j.packets-Ce.packets)/pe)}return q}(C[0].ssrcId,t,n,y)}}),{high:h,low:p,audio:u}}getInboundStats(t,n,a){if(!this.requestRemoteMedia)return;const l=this.requestRemoteMedia()||[],u=[];return l.forEach(h=>{let[p,v]=h;const E={peer:p.uid};if(v.has(je.VIDEO)&&p.videoTrack){const y=p._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(p._videoSSRC)||!1,C=p.videoTrack?function(I,k,G,B,j,q,Z){const re=k.videoRecv.find(Ae=>Ae.ssrc===I);if(!re)return;const Ce={},{receivedFrame:pe,outputFrame:fe,decodeFrameRate:ye}=re,Ee=G&&G.videoRecv.find(Ae=>Ae.ssrc===I);if(Ce[ui.FREEZE]=j&&M0.isRemoteVideoFreeze(B,re,Ee)?1:0,Ot(Ce,ap.FRAME_RATE_DECODE,ye),Ot(Ce,ui.QP_SUM,re.qpSumPerFrame),re.framesRateFirefox&&Ot(Ce,ui.FRAME_RATE,re.framesRateFirefox),pe&&Ot(Ce,ui.FRAME_RATE,pe.frameRate),Ee){const Ae=k.timestamp-G.timestamp||(Z?al:Ad*al);re.packetsLost!=null&&Ee.packetsLost!=null&&Ot(Ce,ui.PACKAGE_LOST,re.packetsLost-Ee.packetsLost),Ee.bytes!=null&&re.bytes!=null&&Ot(Ce,ui.BITRATE,8*(re.bytes-Ee.bytes)/Ae),Ee.packets!=null&&re.packets!=null&&Ot(Ce,ui.PACKAGE_RATE,1e3*(re.packets-Ee.packets)/Ae)}if(Z)return Ce;if(pe?(Ot(Ce,ui.HEIGHT,pe.height),Ot(Ce,ui.WIDTH,pe.width)):B&&(Ot(Ce,ui.HEIGHT,B._videoHeight||0),Ot(Ce,ui.WIDTH,B._videoWidth||0)),fe&&Ot(Ce,ap.FRAME_RATE_RENDER,fe.frameRate),Ot(Ce,ui.JITTER_BUFFER,re.jitterBufferMs),Ot(Ce,ui.CURRENT_DELAY,re.currentDelayMs),Ot(Ce,ui.FIRS,re.firsCount),Ot(Ce,ui.NACKS,re.nacksCount),Ot(Ce,ui.PLIS,re.plisCount),B){Ce[ui.DISABLED]=B._originMediaStreamTrack.enabled&&B._mediaStreamTrack.enabled?0:1;const Ae=B._player;if(Ae){const{freezeTimeCounterList:Ne,renderFreezeAccTime:it}=Ae;if(Ne&&Ne.length>0&&Ot(Ce,ap.FREEZE_TIME,Ne.splice(0,1)[0]),q&&tl.visibility==="visible"){const yt=Math.min(6e3,it);Ae.renderFreezeAccTime=Math.max(0,it-yt),Ot(Ce,ap.FREEZE_TIME_RENDER,yt)}}}if(Ce[ui.PLAYER_STATUS]=KT[B._player?B._player.videoElementStatus:"uninit"],Ee&&re.totalInterFrameDelay!==void 0&&re.totalSquaredInterFrameDelay!==void 0&&Ee.totalInterFrameDelay!==void 0&&Ee.totalSquaredInterFrameDelay!==void 0){const Ae=re.totalInterFrameDelay-Ee.totalInterFrameDelay,Ne=re.totalSquaredInterFrameDelay-Ee.totalSquaredInterFrameDelay,it=re.framesDecodeCount-Ee.framesDecodeCount,yt=Ae/it*1e3,gn=Math.round(1e3*Math.sqrt((Ne-Math.pow(Ae,2)/it)/it));!isNaN(gn)&&yt+gn>Math.max(3*yt,yt+150)&&(Ce[ui.I_FRAME_DELAY]=gn)}return Ce}(p._videoSSRC,t,n,p.videoTrack,y===!0,this.needUploadRenderFreezeTime,a):void 0;C&&(E.video=C)}if(v.has(je.AUDIO)&&p.audioTrack){const y=p.audioTrack?function(C,I,k,G,B){const j=I.audioRecv.find(Ae=>Ae.ssrc===C);if(!j)return;const q={},Z=k&&k.audioRecv.find(Ae=>Ae.ssrc===C),{receivedFrames:re,droppedFrames:Ce}=j;var pe,fe;if(Ot(q,xa.JITTER,j.jitterMs),re!=null&&Ce!=null&&(q[xa.FREEZE]=(fe=Ce,(pe=re)===0||100*fe/pe>20?1:0)),Z){const Ae=I.timestamp-k.timestamp||(B?al:al*Ad);j.packets!=null&&Z.packets!=null&&Ot(q,xa.PACKAGE_RATE,1e3*(j.packets-Z.packets)/Ae),Z.bytes!=null&&j.bytes!=null&&Ot(q,xa.BITRATE,8*(j.bytes-Z.bytes)/Ae),j.packetsLost!=null&&Z.packetsLost!=null&&Ot(q,xa.PACKAGE_LOST,j.packetsLost-Z.packetsLost)}if(B)return q;const ye=G._source.getAccurateVolumeLevel(),Ee=j.outputLevel;if(Ot(q,BR.LEVEL,100*(Ee??ye)),Ot(q,xa.PCM_LEVEL,100*ye),G&&(q[xa.DISABLED]=G._originMediaStreamTrack.enabled&&G._mediaStreamTrack.enabled?0:1),Ot(q,xa.JITTER_BUFFER,j.jitterBufferMs),Ot(q,xa.CURRENT_DELAY,j.jitterBufferMs),q[xa.PLAYER_STATUS]=KT[go.getPlayerState(G.getTrackId())],Z){const Ae=j.concealedSamples-Z.concealedSamples;Ae>0&&Ot(q,xa.CONCEALED_SAMPLES,Ae)}return q}(p._audioSSRC,t,n,p.audioTrack,a):void 0;y&&(E.audio=y)}(E.video||E.audio)&&u.push(E)}),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,u}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval(()=>{if(!this.requestAllTracks||!this.requestUpload)return;const t=(this.requestAllTracks()||[]).find(n=>n instanceof _d);if(t&&t._external.getDenoiserStats){const n=t._external.getDenoiserStats();n&&this.requestUpload(Jc.DENOISER_STATS,n)}},2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval(()=>{!this.requestAllTracks||!this.requestUpload||this.requestAllTracks().forEach(t=>{t.getProcessorStats().forEach(n=>{this.requestUpload&&this.requestUpload(n.type,n.stats)})})},2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval(()=>{!this.requestUpload||!this.requestRemoteMedia||(this.requestRemoteMedia()||[]).forEach(t=>{let[n,a]=t;a.has(je.VIDEO)&&n.videoTrack&&n.videoTrack.getProcessorStats().forEach(l=>{this.requestUpload&&this.requestUpload(l.type,l.stats)}),a.has(je.AUDIO)&&n.audioTrack&&n.audioTrack.getProcessorStats().forEach(l=>{this.requestUpload&&this.requestUpload(l.type,l.stats)})})},2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0))}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);const t=new Map;this.uploadExtUsageStatsTimer=window.setInterval(async()=>{const n=Date.now(),a={connectionInterval:J("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:n};let l=[];const u=this.requestAllTracks&&this.requestAllTracks()||[];for(const E of u)!E.muted&&E.enabled&&(l=l.concat(await E.getProcessorUsage()));const h=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(const[E,y]of h)y.has(je.VIDEO)&&E.videoTrack&&(l=l.concat(await E.videoTrack.getProcessorUsage())),y.has(je.AUDIO)&&E.audioTrack&&(l=l.concat(await E.audioTrack.getProcessorUsage()));if(l.length===0)return;a.details=function(E,y){const C={};for(const{id:B,value:j,level:q,direction:Z}of E){var I;const re=(I=y.get(B))!==null&&I!==void 0?I:0,Ce=j===2?re+J("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:re;var k,G;y.set(B,Ce),C[B]?(j===2&&(C[B].value=j),q>C[B].level&&(C[B].level=q),Z==="remote"&&(C[B].remoteUidCount+=1),C[B].totalTs=(k=y.get(B))!==null&&k!==void 0?k:0):C[B]={value:j,level:q,remoteUidCount:Z==="local"?0:1,totalTs:(G=y.get(B))!==null&&G!==void 0?G:0}}return Object.keys(C).map(B=>{const{level:j,value:q,totalTs:Z}=C[B];return{id:B,level:j,value:q,totalTs:Z}})}(l,t);const p=Date.now(),v=p>n?p:n+1;this.requestUpload&&this.requestUpload(Jc.EXTENSION_USAGE_STATS,{usageStats:a,sendTs:v})},J("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}}class Kr{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(t,n){w(this,"uid",void 0),w(this,"_uintid",void 0),w(this,"_trust_in_room_",!0),w(this,"_trust_audio_enabled_state_",!0),w(this,"_trust_video_enabled_state_",!0),w(this,"_trust_audio_mute_state_",!0),w(this,"_trust_video_mute_state_",!0),w(this,"_audio_muted_",!1),w(this,"_video_muted_",!1),w(this,"_audio_enabled_",!0),w(this,"_video_enabled_",!0),w(this,"_audio_added_",!1),w(this,"_video_added_",!1),w(this,"_is_pre_created",!1),w(this,"_video_pre_subscribed",!1),w(this,"_audio_pre_subscribed",!1),w(this,"_trust_video_stream_added_state_",!0),w(this,"_trust_audio_stream_added_state_",!0),w(this,"_audioTrack",void 0),w(this,"_videoTrack",void 0),w(this,"_dataChannels",[]),w(this,"_audioSSRC",void 0),w(this,"_videoSSRC",void 0),w(this,"_audioOrtc",void 0),w(this,"_videoOrtc",void 0),w(this,"_cname",void 0),w(this,"_rtxSsrcId",void 0),w(this,"_videoMid",void 0),w(this,"_audioMid",void 0),this.uid=t,this._uintid=n}}var Na;function Gne(i,t){var n;let a;switch(t){case Ie.LocalAudioTrack:a=Kt.Audio;break;case Ie.LocalVideoTrack:a=Be(n=i._hints).call(n,mn.SCREEN_TRACK)?Kt.Screen:Kt.High;break;case Ie.LocalVideoLowTrack:a=Kt.Low}return a}function jU(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function gE(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jU(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):jU(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}(function(i){i.SEND_ONLY="SEND_ONLY",i.RECEIVE_ONLY="RECEIVE_ONLY"})(Na||(Na={}));class Rr extends wn{get state(){return this._state}set state(t){const n=this._state;this._state=t,this.emit(Qe.StateChange,n,this._state)}constructor(t,n){super(),w(this,"store",void 0),w(this,"statsUploader",void 0),w(this,"sendConnection",void 0),w(this,"recvConnection",void 0),w(this,"localTrackMap",new Map),w(this,"remoteUserMap",new Map),w(this,"localDataChannels",[]),w(this,"pendingLocalTracks",[]),w(this,"pendingRemoteTracks",[]),w(this,"statsCollector",void 0),w(this,"dtlsFailedCount",0),w(this,"sendMutex",new Ur("P2PChannel2-send-mutex")),w(this,"recvMutex",new Ur("P2PChannel2-recv-mutex")),w(this,"_state",tn.Disconnected),w(this,"_restartStates",["disconnected","failed"]),w(this,"reconnectInterval",void 0),w(this,"uploadUnplinkStarted",!1),w(this,"uploadDownlinkStarted",!1),w(this,"uplinkStateUploadInterval",void 0),w(this,"downlinkStatsUploadInterval",void 0),w(this,"handleMuteLocalTrack",async(a,l,u)=>{const h=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==tn.Connected)return void u(new Te(z.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const E=this.filterTobeMutedTracks(a);if(E.length===0)return void l();const y=E.find(G=>G[0]==="videoLowTrack");y&&y[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(E.map(G=>{let[,{id:B}]=G;return B}));let C=!1;var p,v;a.trackMediaType==="video"?C=!((p=this.localTrackMap.get(Ie.LocalAudioTrack))===null||p===void 0||!p.track._muted):C=((v=this.localTrackMap.get(Ie.LocalVideoTrack))===null||v===void 0?void 0:v.id)===void 0;const I=this.createMuteMessage(E);await hn(this,Qe.RequestMuteLocal,I);const k=a.trackMediaType==="video"?yc.MUTE_LOCAL_VIDEO:yc.MUTE_LOCAL_AUDIO;await hn(this,Qe.RequestP2PMuteLocal,{action:k,message:I,isMuteAll:C}),l()}catch(E){u(E)}finally{h()}}),w(this,"handleUnmuteLocalTrack",async(a,l,u)=>{const h=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==tn.Connected)return void u(new Te(z.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const p=this.filterTobeUnmutedTracks(a);if(p.length===0)return void l();await this.sendConnection.unmuteLocal(p.map(y=>{let[,{id:C}]=y;return C}));const v=this.createUnmuteMessage(p),E=a.trackMediaType==="video"?yc.UNMUTE_LOCAL_VIDEO:yc.UNMUTE_LOCAL_AUDIO;await hn(this,Qe.RequestP2PMuteLocal,{action:E,message:v}),l()}catch(p){u(p)}finally{h()}}),w(this,"handleUpdateVideoEncoder",async(a,l,u)=>{const h=await this.sendMutex.lock("Locking from P2PChannel2.handleSetVideoEncoder");try{const p=this.localTrackMap.get(Ie.LocalVideoTrack);if(!this.sendConnection||!p||p.track!==a||this.state!==tn.Connected)return void l();const{id:v,track:E}=p;v&&(await this.sendConnection.updateSendParameters(v,E),await this.sendConnection.updateEncoderConfig(v,E),this.emit(Qe.UpdateVideoEncoder,E)),l()}catch(p){u(p)}finally{h()}}),w(this,"handleSetOptimizationMode",async(a,l,u)=>{const h=await this.sendMutex.lock("Locking from P2PChannel2.handleSetOptimizationMode");try{const p=this.localTrackMap.get(Ie.LocalVideoTrack);if(!this.sendConnection||!p||p.track!==a||this.state!==tn.Connected)return;const{id:v,track:E}=p;v&&await this.sendConnection.updateSendParameters(v,E),l()}catch(p){u(p)}finally{h()}}),w(this,"handleReplaceTrack",async(a,l,u,h)=>{let p;L.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(a.getTrackId(),"]")),typeof h=="boolean"&&h||(p=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var v;const y=Array.from(this.localTrackMap.entries()).find(C=>{let[,{track:I}]=C;return a===I});if(!this.sendConnection||!y||y[1].id===void 0||this.state!==tn.Connected)return void l();if(await((v=this.sendConnection)===null||v===void 0?void 0:v.replaceTrack(a,y[1].id)),y[0]===Ie.LocalVideoTrack&&cn().supportDualStreamEncoding){const C=this.localTrackMap.get(Ie.LocalVideoLowTrack);if(C){const I=a._mediaStreamTrack.clone();C.track._originMediaStreamTrack.stop(),C.track._mediaStreamTrack=I,C.track._originMediaStreamTrack=I,await new _e((k,G)=>{this.handleReplaceTrack(C.track,k,G,!0)})}}l()}catch(y){u(y)}finally{var E;(E=p)===null||E===void 0||E()}}),w(this,"handleGetLocalVideoStats",a=>{a(this.statsCollector.getLocalVideoTrackStats())}),w(this,"handleGetLocalAudioStats",a=>{a(this.statsCollector.getLocalAudioTrackStats())}),w(this,"handleGetRemoteVideoStats",a=>this.statsCollector.getRemoteVideoTrackStats(a.uid)[a.uid]),w(this,"handleGetRemoteAudioStats",a=>this.statsCollector.getRemoteAudioTrackStats(a.uid)[a.uid]),this.store=t,this.statsCollector=n,this.statsCollector.addP2PChannel(this),this.statsUploader=new BU(t),this.bindStatsUploaderEvents(),this.reconnectInterval=window.setInterval(()=>{[this.sendConnection,this.recvConnection].forEach(a=>{a&&(a.iceConnectionState!=="disconnected"&&a.iceConnectionState!=="failed"||this.handleDisconnect(a.direction))})},J("ICE_RESTART_INTERVAL"))}async startP2PConnection(t,n){throw new Te(z.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(t,n,a,l,u,h){throw new Te(z.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(t,n){let a;try{if(n){this.recvConnection&&(L.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),a=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new ia(t,this.store,vi.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);const l=await this.recvConnection.establish(n);return{iceParameters:l.iceParameters,dtlsParameters:l.dtlsParameters,sdp:l.sdp}}{this.state=tn.New,this.sendConnection&&(L.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),a=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new ia(t,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);const l=await this.sendConnection.establish();return{iceParameters:l.iceParameters,dtlsParameters:l.dtlsParameters,sdp:l.sdp}}}finally{a&&a()}}async p2pConnect(t){if(!this.sendConnection)throw new Te(z.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect(t),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=tn.Connected}async addRemoteCandidate(t,n){if(n===vi.RECEIVE_ONLY){if(!this.sendConnection)throw new Te(z.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate(t)}else{if(!this.recvConnection)throw new Te(z.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(t)}}publish(t,n,a){var l=this;return Do(function*(){const u=yield _t(l.sendMutex.lock("From P2PChannel.publish"));try{if(!l.sendConnection||l.state!==tn.Connected){l.throwIfTrackTypeNotMatch(t);const y=t.filter(C=>l.pendingLocalTracks.indexOf(C)===-1);return void(l.pendingLocalTracks=l.pendingLocalTracks.concat(y))}l.store.pubId=l.store.pubId+1,li.markPublishStart(l.store.clientId,l.store.pubId);const h=l.filterTobePublishedTracks(t,n,a);if(h.length===0)return void(yield _t(l.tryToUnmuteAudio(t)));h.forEach(y=>{let{track:C,type:I}=y;const k=Date.now();l.store.publish(C.getTrackId(),I===Ie.LocalAudioTrack?"audio":"video",k)}),l.bindLocalTrackEvents(h);const p=yield _t(l.sendConnection.send(h.map(y=>{let{track:C}=y;return C}),l.store.codec,l.store.audioCodec)),v=(yield _t(p.next())).value,E=l.createGatewayPublishMessage(h,v);try{yield E}catch(y){throw p.throw(y),(y==null?void 0:y.code)===z.WS_ABORT&&h.forEach(C=>{let{track:I}=C;l.pendingLocalTracks.indexOf(I)===-1&&l.pendingLocalTracks.push(I)}),l.unbindLocalTrackEvents(h),y}yield _t(p.next()),h.forEach(y=>{let{type:C}=y;l.statsCollector.addLocalStats(C)}),l.statsUploader.startUploadOutboundStats(),l.assignLocalTracks(h,v),h.forEach(y=>{let{track:C,type:I}=y;const k=Date.now();l.store.publish(C.getTrackId(),I===Ie.LocalAudioTrack?"audio":"video",void 0,k)}),l.startUploadUplinkState()}finally{u()}})()}async unpublish(t){if(!this.sendConnection||this.state!==tn.Connected)return void(t.length===0?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter(u=>!Be(t).call(t,u)));const n=this.filterTobeUnpublishedTracks(t);if(n.length===0)return;const a=n.find(u=>u[0]==="videoLowTrack");a&&a[1].track.close();const l=this.createGatewayUnpublishMessage(n);if(await this.sendConnection.stopSending(n.map(u=>{let[,{id:h}]=u;return h})),this.withdrawLocalTracks(n),this.unbindLocalTrackEvents(n.map(u=>{let[h,{track:p}]=u;return{type:h,track:p}})),n.forEach(u=>{let[h]=u;this.statsCollector.removeLocalStats(h)}),this.localTrackMap.size===0&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===tn.Connected)return a&&a[1].track.close(),l;t.forEach(u=>{const h=this.pendingLocalTracks.indexOf(u);h!==-1&&this.pendingLocalTracks.splice(h,1)})}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);const t=()=>{const n=[],a=[];Array.from(this.localTrackMap.entries()).forEach(l=>{let[u,{track:h,ssrcs:p}]=l;const v={stream_type:Gne(h,u),ssrcs:p};h._muted||!h._enabled?n.push(v):a.push(v)}),n.length>0&&n.forEach(l=>{hn(this,Qe.RequestMuteLocal,[l])}),a.length>0&&a.forEach(l=>{hn(this,Qe.RequestUnmuteLocal,[l])})};t(),this.uplinkStateUploadInterval=window.setInterval(()=>{t()},3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(t){return Do(function*(){throw new Te(z.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}async republish(){this.pendingLocalTracks.length>0&&(L.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await cr(this,Qe.RequestRePublish,this.pendingLocalTracks),this.emit(Qe.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new Te(z.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe(t,n,a,l){var u;if(!this.recvConnection)throw new Te(z.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if((u=this.remoteUserMap.get(t))!==null&&u!==void 0&&u.has(n))return;const{track:h,mid:p,transceiver:v}=await this.recvConnection.receive(n,[{ssrcId:a}],String(t.uid),l);n===je.AUDIO?(t._audioTrack?t._audioTrack._updateOriginMediaStreamTrack(h):(t._audioTrack=new is(h,t.uid,t._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(t._audioTrack.getTrackId()))),v&&t._audioTrack._updateRtpTransceiver(v),this.bindRemoteTrackEvents(t,t._audioTrack)):(t._videoSSRC=a,t._videoTrack?t._videoTrack._updateOriginMediaStreamTrack(h):(t._videoTrack=new Cc(h,t.uid,t._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(t._videoTrack.getTrackId()))),v&&t._videoTrack._updateRtpTransceiver(v),this.bindRemoteTrackEvents(t,t._videoTrack));const E=this.remoteUserMap.get(t);E?E.set(n,p):this.remoteUserMap.set(t,new Map([[n,p]])),this.statsCollector.addRemoteStats(t.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();const y=this.pendingRemoteTracks.findIndex(C=>{let{user:I,kind:k}=C;return I.uid===t.uid&&n===k});y!==-1&&(this.pendingRemoteTracks.splice(y,1),this.emit(Qe.MediaReconnectEnd,t.uid))}async mockSubscribe(t,n,a,l){if(!this.recvConnection)throw new Te(z.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(n,[{ssrcId:a}],String(t.uid),l)}async unsubscribe(t,n,a){const l=this.pendingRemoteTracks.filter(h=>{let{user:p,kind:v}=h;return n!==void 0?p.uid===t.uid&&n===v:p.uid===t.uid});if(l.forEach(h=>{const p=this.pendingRemoteTracks.indexOf(h);this.pendingRemoteTracks.splice(p,1)}),this.recvConnection||a||l.forEach(h=>{let{kind:p}=h;var v;if(p===je.AUDIO)(v=t._audioTrack)===null||v===void 0||v._destroy(),t._audioTrack=void 0;else if(p===je.VIDEO){var E;(E=t._videoTrack)===null||E===void 0||E._destroy(),t._videoTrack=void 0}}),!this.recvConnection)return;const u=this.filterTobeUnSubscribedTracks(t,n);u.length!==0&&(await this.recvConnection.stopReceiving(u.map(h=>{let[,{id:p}]=h;return p})),this.withdrawRemoteTracks(u),this.remoteUserMap.size===0&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),u.forEach(h=>{let[p,{kind:v}]=h;var E,y;if(v===je.VIDEO&&p._videoSSRC&&((E=this.recvConnection)===null||E===void 0||E.setStatsRemoteVideoIsReady(p._videoSSRC,!1)),v===je.VIDEO)this.unbindRemoteTrackEvents(p._videoTrack),a||((y=p._videoTrack)===null||y===void 0||y._destroy(),p._videoTrack=void 0);else if(v===je.AUDIO){var C;this.unbindRemoteTrackEvents(p._audioTrack),!a&&((C=p._audioTrack)===null||C===void 0||C._destroy(),p._audioTrack=void 0)}}),u.forEach(h=>{let[,{kind:p}]=h;hn(this,Qe.RequestP2PMuteRemote,p)}))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);const t=()=>Array.from(this.remoteUserMap.entries()).forEach(n=>{let[,a]=n;[je.VIDEO,je.AUDIO].forEach(l=>{a.has(l)?hn(this,Qe.RequestP2PUnmuteRemote,l):hn(this,Qe.RequestP2PMuteRemote,l)})});t(),this.downlinkStatsUploadInterval=window.setInterval(()=>{t()},3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe(t){throw new Te(z.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(t){throw new Te(z.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(t){throw new Te(z.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(t){throw new Te(z.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(t,n){if(!this.recvConnection)return;const a=this.remoteUserMap.get(t);if(!a)return void L.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(t.uid,"."));if(!a.get(n))return void L.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(t.uid," media type ").concat(n,"."));const l=n===je.VIDEO?t._videoSSRC:t._audioSSRC;l!==void 0&&this.recvConnection.setStatsRemoteVideoIsReady(l,!1)}async unmuteRemote(t,n){return this.unmuteRemoteNoLock(t,n)}async unmuteRemoteNoLock(t,n){if(!this.recvConnection)return;const a=this.remoteUserMap.get(t);if(!a)return void L.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(t.uid,"."));a.get(n)||L.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(t.uid," media type ").concat(n,"."))}getAllTracks(t){const n=this.localTrackMap.get(Ie.LocalAudioTrack);if((n==null?void 0:n.track)instanceof dr){const a=n.track;return Array.from(this.localTrackMap.entries()).filter(l=>{let[u]=l;return u!==Ie.LocalAudioTrack}).filter(l=>{let[u]=l;return!(t&&u===Ie.LocalVideoLowTrack)}).map(l=>{let[,{track:u}]=l;return u}).concat(a.trackList)}return Array.from(this.localTrackMap.entries()).filter(a=>{let[l]=a;return!(t&&l===Ie.LocalVideoLowTrack)}).map(a=>{let[,{track:l}]=a;return l})}reportPublishEvent(t,n,a,l,u){if(t){const p=this.localTrackMap.get(Ie.LocalAudioTrack),v=l?this.localTrackMap.get(Ie.LocalVideoLowTrack):this.localTrackMap.get(Ie.LocalVideoTrack);We.publish(this.store.sessionId,{eventElapse:li.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:t,ec:n,audioName:p==null?void 0:p.track.getTrackLabel(),videoName:v==null?void 0:v.track.getTrackLabel(),screenshare:(v==null?void 0:v.track._hints.indexOf(mn.SCREEN_TRACK))!==-1,audio:!!p,video:!!v,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:u})}else{var h;a||(a=[]);const p=a.find(E=>E instanceof Xt),v=l?(h=this.localTrackMap.get(Ie.LocalVideoTrack))===null||h===void 0?void 0:h.track:a.find(E=>E instanceof Rt);We.publish(this.store.sessionId,{eventElapse:li.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:t,ec:n,audioName:p==null?void 0:p.getTrackLabel(),videoName:v==null?void 0:v.getTrackLabel(),screenshare:(v==null?void 0:v._hints.indexOf(mn.SCREEN_TRACK))!==-1,audio:!!p,video:!!v,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:u})}}reportSubscribeEvent(t,n,a,l){const u=l===je.VIDEO?a._videoSSRC:a._audioSSRC;u&&We.subscribe(this.store.sessionId,{succ:t,ec:n,video:l===je.VIDEO,audio:l===je.AUDIO,peerid:a.uid,subscribeRequestid:l===je.VIDEO?a._videoSSRC:a._audioSSRC,p2pid:this.store.p2pId,eventElapse:li.measureFromSubscribeStart(this.store.clientId,u)})}reset(){L.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new Ur("P2PChannel2-send-mutex"),this.sendMutex=new Ur("P2PChannel2-recv-mutex"),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const t=this.localTrackMap.get(Ie.LocalAudioTrack);if((t==null?void 0:t.track)instanceof dr){if(t.track.trackList.length>0){const n=t.track;t.track.trackList.forEach(a=>{n.removeAudioTrack(a)})}t.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=tn.Disconnected}getStats(t){var n,a;return t?(a=this.recvConnection)===null||a===void 0?void 0:a.getStats():(n=this.sendConnection)===null||n===void 0?void 0:n.getStats()}getRemoteVideoIsReady(t){var n;return((n=this.recvConnection)===null||n===void 0?void 0:n.getRemoteVideoIsReady(t))||!1}getLocalAudioVolume(){const t=this.localTrackMap.get(Ie.LocalAudioTrack);if(t)return t.track.getVolumeLevel()}getLocalVideoSize(){const t=this.localTrackMap.get(Ie.LocalVideoTrack);if(t)return{width:t.track._videoWidth||0,height:t.track._videoHeight||0}}getEncoderConfig(t){const n=this.localTrackMap.get(t);return n&&n.track instanceof Rt||n&&n.track instanceof Xt?n.track._encoderConfig:void 0}getLocalMedia(t){return this.localTrackMap.get(t)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(t,n){if(!t)return this.remoteUserMap.size>0;const a=this.remoteUserMap.get(t);return!!a&&(!n||a.has(n))}async hasRemoteMediaWithLock(t,n){if(!t)return this.remoteUserMap.size>0;const a=this.remoteUserMap.get(t);return!!a&&(!n||a.has(n))}getRemoteMedia(t){var n;const a=Array.from(zo(n=this.remoteUserMap).call(n)).find(l=>l.uid===t);return a?{audioTrack:a.audioTrack,audioSSRC:a._audioSSRC,videoTrack:a.videoTrack,videoSSRC:a._videoSSRC}:{}}getAudioLevels(){let t=Array.from(this.remoteUserMap.entries()).map(a=>{let[l]=a;return{uid:l.uid,level:l.audioTrack?100*l.audioTrack._source.getAccurateVolumeLevel():0}});const n=this.localTrackMap.get(Ie.LocalAudioTrack);return n&&t.push({level:100*n.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),t=zf(t).call(t,(a,l)=>a.level-l.level),t}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(L.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=tn.Reconnecting,J("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(t=>{let[n]=t;var a;n._videoTrack&&n._videoTrack._player&&((a=n._videoTrack._player.getVideoElement())===null||a===void 0||a.pause(),n._videoTrack._player.isKeepLastFrame=!0,n._videoTrack._originMediaStreamTrack.stop())}),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(t=>{var n;let[a,{track:l}]=t;switch(a){case Ie.LocalVideoTrack:Be(n=l._hints).call(n,mn.LOW_STREAM)?l.close():this.pendingLocalTracks.push(l);break;case Ie.LocalAudioTrack:l instanceof dr?this.pendingLocalTracks=this.pendingLocalTracks.concat(l.trackList):this.pendingLocalTracks.push(l);case Ie.LocalVideoLowTrack:}}),this.emit(Qe.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(t=>{let[n,a]=t;Array.from(zo(a).call(a)).forEach(l=>{this.setPendingRemoteMedia(n,l)}),this.emit(Qe.MediaReconnectStart,n.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),L.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(t,n){for(const a of this.pendingRemoteTracks){const{user:l,kind:u}=a;if((t instanceof Kr?t.uid:t)===l.uid&&n===u)return!0}return!1}setPendingRemoteMedia(t,n){this.hasPendingRemoteMedia(t,n)||this.pendingRemoteTracks.push({user:t,kind:n})}async restartICE(t,n){let a,l;if(t===vi.SEND_ONLY){if(!this.sendConnection)throw new Te(z.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");a=await this.sendMutex.lock("From P2PChannel.restartICE"),l=this.sendConnection}else{if(!this.recvConnection)throw new Te(z.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");a=await this.recvMutex.lock("From P2PChannel.restartICE"),l=this.recvConnection}try{if(n){const u=await l.restartICE(n);return l.isInRestartIce=!1,u}{const u=await l.restartICE();if(u){const h=await cr(this,Qe.RequestP2PRestartICE,{direction:vi.RECEIVE_ONLY,iceParameter:u});await l.restartICE(h),l.isInRestartIce=!1}}}finally{a()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const t=this.sendConnection.getStats(),n=this.localTrackMap.get(Ie.LocalVideoTrack),a=this.localTrackMap.get(Ie.LocalAudioTrack),l=t.videoSend.find(G=>{var B;return G.ssrc===(n==null||(B=n.ssrcs)===null||B===void 0?void 0:B[0].ssrcId)}),u=t.audioSend.find(G=>{var B;return G.ssrc===(a==null||(B=a.ssrcs)===null||B===void 0?void 0:B[0].ssrcId)});if(!l||!u)return 1;const h=No(this,Qe.NeedSignalRTT),p=l?l.rttMs:void 0,v=u?u.rttMs:void 0,E=p&&v?(p+v)/2:p||v,y=(E&&h?(E+h)/2:E||h)||0,C=100*t.sendPacketLossRate*.7/50+.3*y/1500,I=C<.17?1:C<.36?2:C<.59?3:C<.1?4:5,k=n==null?void 0:n.track;if(k&&k._encoderConfig&&k._hints.indexOf(mn.SCREEN_TRACK)===-1){const G=k._encoderConfig.bitrateMax,B=t.bitrate.actualEncoded;if(G&&B){const j=(1e3*G-B)/(1e3*G);return iM[j<.15?0:j<.3?1:j<.45?2:j<.6?3:4][I]}}return I}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const t=this.recvConnection.getStats();let n=0;return Array.from(this.remoteUserMap.entries()).forEach(a=>{let[l]=a;const u=l._audioSSRC,h=l._videoSSRC,p=t.audioRecv.find(B=>B.ssrc===u),v=t.videoRecv.find(B=>B.ssrc===h);if(!p&&!v)return void(n+=1);const E=No(this,Qe.NeedSignalRTT),y=t.rtt,C=(y&&E?(y+E)/2:y||E)||0,I=p?p.jitterMs:void 0,k=t.recvPacketLossRate;let G=.7*k*100/50+.3*C/1500;I&&(G=.6*k*100/50+.2*C/1500+.2*I/400),n+=G<.1?1:G<.17?2:G<.36?3:G<.59?4:5}),this.remoteUserMap.size>0?Math.round(n/this.remoteUserMap.size):n}async muteLocalTrack(t){return new _e((n,a)=>{this.handleMuteLocalTrack(t,n,a)})}filterTobePublishedTracks(t,n,a){const l=[],u=cn(),h=this.getAllTracks();t=Lh(t=t.filter(E=>h.indexOf(E)===-1));let p=!1,v=!1;for(const E of t){if(E instanceof Rt&&(this.localTrackMap.has(Ie.LocalVideoTrack)||p?new Te(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(l.push({track:E,type:Ie.LocalVideoTrack}),p=!0),n)){const y=this.getLowVideoTrack(E,a);l.push({track:y,type:Ie.LocalVideoLowTrack})}if(E instanceof Xt){const y=this.localTrackMap.get(Ie.LocalAudioTrack);if(y){if(!(y.track instanceof dr))throw new Te(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(E._bypassWebAudio)throw new Te(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");y.track.addAudioTrack(E),this.bindLocalAudioTrackEvents(E,!0)}else if(v){const C=l.find(I=>{let{type:k}=I;return k===Ie.LocalAudioTrack});if(!(C.track instanceof dr))throw new Te(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(E._bypassWebAudio)throw new Te(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");C.track.addAudioTrack(E)}else{if(!u.webAudioMediaStreamDest||E instanceof dr||E._bypassWebAudio)l.push({track:E,type:Ie.LocalAudioTrack});else{const C=new dr;C.addAudioTrack(E),l.push({track:C,type:Ie.LocalAudioTrack})}v=!0}}}return l}filterTobeUnpublishedTracks(t){const n=[],a=this.getAllTracks();t=Lh(t=t.filter(l=>a.indexOf(l)!==-1));for(const l of t){if(l instanceof Xt){const u=this.localTrackMap.get(Ie.LocalAudioTrack);if(!u)continue;u.track instanceof dr?(u.track.removeAudioTrack(l),this.unbindLocalAudioTrackEvents(l),u.track.trackList.length===0&&(n.push([Ie.LocalAudioTrack,u]),u.track.close())):n.push([Ie.LocalAudioTrack,u])}if(l instanceof Rt){const u=this.localTrackMap.get(Ie.LocalVideoTrack);if(!u)continue;n.push([Ie.LocalVideoTrack,u]);const h=this.localTrackMap.get(Ie.LocalVideoLowTrack);h&&n.push([Ie.LocalVideoLowTrack,h])}}return n}bindLocalTrackEvents(t){t.forEach(n=>{let{track:a,type:l}=n;switch(l){case Ie.LocalVideoTrack:a.addListener(Fe.GET_STATS,this.handleGetLocalVideoStats),a.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.addListener(Fe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),a.addListener(Fe.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),a.addListener(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),a.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ie.LocalAudioTrack:this.bindLocalAudioTrackEvents(a);case Ie.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(t,n){t instanceof dr?t.trackList.forEach(a=>{a.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.addListener(Fe.GET_STATS,this.handleGetLocalAudioStats),a.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(t.addListener(Fe.GET_STATS,this.handleGetLocalAudioStats),t.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),n||t.addListener(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(t){t||(t=Array.from(this.localTrackMap.entries()).map(n=>{let[a,{track:l}]=n;return{track:l,type:a}})),t.forEach(n=>{let{track:a,type:l}=n;switch(l){case Ie.LocalVideoTrack:a.off(Fe.GET_STATS,this.handleGetLocalVideoStats),a.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.off(Fe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),a.off(Fe.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),a.off(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),a.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ie.LocalAudioTrack:this.unbindLocalAudioTrackEvents(a);case Ie.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(t){t instanceof dr?t.trackList.forEach(n=>{n.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.off(Fe.GET_STATS,this.handleGetLocalAudioStats),n.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(t.off(Fe.GET_STATS,this.handleGetLocalAudioStats),t.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(t,n){n instanceof Cc&&n.addListener(Fe.GET_STATS,a=>{a(this.handleGetRemoteVideoStats(t))}),n instanceof is&&n.addListener(Fe.GET_STATS,a=>{a(this.handleGetRemoteAudioStats(t))})}unbindRemoteTrackEvents(t){t&&t.removeAllListeners(Fe.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(t=>{let[n,a]=t;a.has(je.AUDIO)&&this.unbindRemoteTrackEvents(n._audioTrack),a.has(je.VIDEO)&&this.unbindRemoteTrackEvents(n._videoTrack)})}createGatewayPublishMessage(t,n){return t.map((a,l)=>{var u;let h,{track:p,type:v}=a;switch(v){case Ie.LocalAudioTrack:h=Kt.Audio;break;case Ie.LocalVideoTrack:h=Be(u=p._hints).call(u,mn.SCREEN_TRACK)?Kt.Screen:Kt.High;break;case Ie.LocalVideoLowTrack:h=Kt.Low}return{kind:v===Ie.LocalAudioTrack?je.AUDIO:je.VIDEO,stream_type:h,mid:n[l].id,ssrcs:n[l].localSSRC,isMuted:p.muted||!p.enabled}})}createGatewayUnpublishMessage(t){return t.map(n=>{var a;let l,[u,{track:h,ssrcs:p,id:v}]=n;switch(u){case Ie.LocalVideoTrack:l=Be(a=h._hints).call(a,mn.SCREEN_TRACK)?Kt.Screen:Kt.High;break;case Ie.LocalAudioTrack:l=Kt.Audio;break;case Ie.LocalVideoLowTrack:l=Kt.Low}return{stream_type:l,ssrcs:p,mid:v}})}assignLocalTracks(t,n){t.forEach((a,l)=>{let{track:u,type:h}=a;this.localTrackMap.set(h,{track:u,id:n[l].id,ssrcs:n[l].localSSRC})})}withdrawLocalTracks(t){t.forEach(n=>{let[a]=n;this.localTrackMap.delete(a)})}bindConnectionEvents(t){t.onConnectionStateChange=async n=>{var a;L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat(t.name,".onConnectionStateChange(").concat(n,")")),this.emit(Qe.PeerConnectionStateChange,n),n!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),n==="connected"&&(t.isInRestartIce=!1),Be(a=this._restartStates).call(a,n)&&!t.isInRestartIce&&(n==="disconnected"&&await Fr(800),t.iceConnectionState!=="disconnected"&&t.iceConnectionState!=="failed"||this.handleDisconnect(t.direction))},t.onICEConnectionStateChange=n=>{n!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(n,")")),We.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:n,tag:Pn.TRACER}).onSuccess(),this.emit(Qe.IceConnectionStateChange,n)},t.onICETransportStateChange=n=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(n,")"))},t.onDTLSTransportStateChange=n=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(n,")"))},t.onDTLSTransportError=n=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(n,")"))},t.onFirstAudioDecoded=n=>{var a;const l=Array.from(zo(a=this.remoteUserMap).call(a)).find(h=>h._audioSSRC===n);var u;l&&(this.store.subscribe(l.uid,"audio",void 0,void 0,void 0,Date.now()),(u=l.audioTrack)===null||u===void 0||u.emit(gd.FIRST_FRAME_DECODED),We.firstRemoteFrame(this.store.sessionId,Cr.FIRST_AUDIO_DECODE,yn.FIRST_AUDIO_DECODE,{peer:l._uintid,subscribeElapse:li.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId}))},t.onFirstAudioReceived=n=>{var a;const l=Array.from(zo(a=this.remoteUserMap).call(a)).find(u=>u._audioSSRC===n);l&&We.firstRemoteFrame(this.store.sessionId,Cr.FIRST_AUDIO_RECEIVED,yn.FIRST_AUDIO_RECEIVED,{peer:l._uintid,subscribeElapse:li.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId})},t.onFirstVideoDecoded=(n,a,l)=>{this.reportVideoFirstFrameDecoded(n,a,l)},t.onFirstVideoReceived=n=>{var a;const l=Array.from(zo(a=this.remoteUserMap).call(a)).find(u=>u._videoSSRC===n);l&&We.firstRemoteFrame(this.store.sessionId,Cr.FIRST_VIDEO_RECEIVED,yn.FIRST_VIDEO_RECEIVED,{peer:l._uintid,subscribeElapse:li.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId})},t.onSelectedLocalCandidateChanged=(n,a)=>{const l=n.candidateType==="relay",u=a.candidateType==="relay";a.candidateType!=="unknown"&&l===u||this.emit(Qe.ConnectionTypeChange,l),L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(tu(a))," -> ").concat(JSON.stringify(tu(n)),")"))},t.onSelectedRemoteCandidateChanged=(n,a)=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(tu(a))," -> ").concat(JSON.stringify(tu(n)),")"))},t.onFirstVideoDecodedTimeout=n=>{this.reportVideoFirstFrameDecoded(n,void 0,void 0,!0)},t.onLocalCandidate=n=>{this.emit(Qe.LocalCandidate,{candidate:n,direction:t.direction})}}unbindConnectionEvents(t){t.onConnectionStateChange=void 0,t.onICEConnectionStateChange=void 0,t.onICETransportStateChange=void 0,t.onDTLSTransportStateChange=void 0,t.onDTLSTransportError=void 0,t.onFirstAudioDecoded=void 0,t.onFirstAudioReceived=void 0,t.onFirstVideoDecoded=void 0,t.onFirstVideoReceived=void 0,t.onSelectedLocalCandidateChanged=void 0,t.onSelectedRemoteCandidateChanged=void 0,t.onFirstVideoDecodedTimeout=void 0,t.onLocalCandidate=void 0}async handleDisconnect(t){const n=t===vi.SEND_ONLY?this.sendConnection:this.recvConnection;n&&!n.isInRestartIce&&(n.isInRestartIce=!0,L.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(n.name,"] start use restartICE")),t===vi.SEND_ONLY?this.restartICE(t):cr(this,Qe.RequestP2PRestartICE,{direction:vi.SEND_ONLY}))}filterTobeMutedTracks(t){const n=[];if(this.getAllTracks().indexOf(t)===-1)return n;const a=this.localTrackMap.get(Ie.LocalAudioTrack);if(t instanceof Xt&&(a==null?void 0:a.track)instanceof dr)return a.track.isActive||n.push([Ie.LocalAudioTrack,a]),n;const l=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:h}]=u;return t===h});if(l&&(n.push(l),l[0]===Ie.LocalVideoTrack)){const u=this.localTrackMap.get(Ie.LocalVideoLowTrack);u&&n.push([Ie.LocalVideoLowTrack,u])}return n}filterTobeUnmutedTracks(t){const n=[],a=this.localTrackMap.get(Ie.LocalAudioTrack);if(t instanceof Xt&&(a==null?void 0:a.track)instanceof dr)return a.track.isActive&&n.push([Ie.LocalAudioTrack,a]),n;const l=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:h}]=u;return t===h});if(l)if(l[0]===Ie.LocalVideoTrack){n.push(l);const u=this.localTrackMap.get(Ie.LocalVideoLowTrack);u&&n.push([Ie.LocalVideoLowTrack,u])}else n.push(l);return n}createMuteMessage(t){return t.map(n=>{var a;let l,[u,{track:h,ssrcs:p,id:v}]=n;switch(u){case Ie.LocalAudioTrack:l=Kt.Audio;break;case Ie.LocalVideoTrack:l=Be(a=h._hints).call(a,mn.SCREEN_TRACK)?Kt.Screen:Kt.High;break;case Ie.LocalVideoLowTrack:l=Kt.Low}return{stream_type:l,ssrcs:p,mid:v}})}createUnmuteMessage(t){return t.map(n=>{var a;let l,[u,{track:h,ssrcs:p,id:v}]=n;switch(u){case Ie.LocalAudioTrack:l=Kt.Audio;break;case Ie.LocalVideoTrack:l=Be(a=h._hints).call(a,mn.SCREEN_TRACK)?Kt.Screen:Kt.High;break;case Ie.LocalVideoLowTrack:l=Kt.Low}return{stream_type:l,ssrcs:p,mid:v}})}filterTobeUnSubscribedTracks(t,n){const a=[],l=this.remoteUserMap.get(t);if(!l)return a;if(n){const u=l.get(n);if(!u)return a;a.push([t,{kind:n,id:u}])}else Array.from(l.entries()).forEach(u=>{let[h,p]=u;a.push([t,{kind:h,id:p}])});return a}createUnsubscribeMessage(t){const n=[];return t.forEach(a=>{let[l,{kind:u,id:h}]=a;switch(u){case je.VIDEO:return void(l._videoSSRC&&n.push({stream_type:je.VIDEO,ssrcId:l._videoSSRC}));case je.AUDIO:return void(l._audioSSRC&&n.push({stream_type:je.AUDIO,ssrcId:l._audioSSRC}))}}),n}withdrawRemoteTracks(t){t.forEach(n=>{let[a,{kind:l}]=n;const u=this.remoteUserMap.get(a);u&&(u.delete(l),Array.from(u.entries()).length===0&&this.remoteUserMap.delete(a))})}async updateBitrateLimit(t){const n=this.localTrackMap.get(Ie.LocalVideoTrack),a=this.localTrackMap.get(Ie.LocalVideoLowTrack);n&&await n.track.setBitrateLimit(t.uplink),a&&t.low_stream_uplink&&await a.track.setBitrateLimit({max_bitrate:t.low_stream_uplink.bitrate,min_bitrate:t.low_stream_uplink.bitrate||0})}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const t=this.sendConnection.peerConnectionState,n=this.recvConnection.peerConnectionState;return t!=="connected"&&n!=="connected"}return!0}async tryToUnmuteAudio(t){for(let n=0;n<t.length;n++)if(t[n]instanceof Xt){const a=this.filterTobeUnmutedTracks(t[n]);if(a.length===0)continue;const l=this.createUnmuteMessage(a);return void await hn(this,Qe.RequestUnmuteLocal,l)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=t=>this.getStats(t),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter(t=>{let[,{ssrcs:n}]=t;return!!n}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=t=>{var n;return!((n=this.recvConnection)===null||n===void 0||!n.getRemoteVideoIsReady(t))},this.statsUploader.requestUpload=(t,n)=>this.emit(Qe.RequestUpload,t,n),this.statsUploader.requestUploadStats=t=>this.emit(Qe.RequestUploadStats,t),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Fr(Cv(this.dtlsFailedCount,ur)),this.emit(Qe.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(Ie.LocalVideoTrack)||this.pendingLocalTracks.some(t=>t instanceof Rt)}throwIfTrackTypeNotMatch(t){if(t.filter(n=>n instanceof Rt).length>1)throw new Te(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t.filter(n=>n instanceof Xt).length>1&&(t.some(n=>n instanceof Xt&&n._bypassWebAudio)||!cn().webAudioMediaStreamDest))throw new Te(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const n of t){if(n instanceof Rt&&this.pendingLocalTracks.some(a=>a instanceof Rt))throw new Te(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(n instanceof Xt&&this.pendingLocalTracks.some(a=>a instanceof Xt)&&(!cn().webAudioMediaStreamDest||n._bypassWebAudio||this.pendingLocalTracks.some(a=>a instanceof Xt&&a._bypassWebAudio)))throw new Te(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(t,n){const a=!J("DISABLE_DUAL_STREAM_USE_ENCODING")&&cn().supportDualStreamEncoding,l=gE(gE({},{width:160,height:120,framerate:15,bitrate:50}),n);let u;u=a?t._mediaStreamTrack.clone():FR(t,l);const h=pn(8,"track-low-"),p=new Rt(u,gE(gE({},a&&{scaleResolutionDownBy:PT(l,t)}),{},{frameRate:l.framerate,bitrateMax:l.bitrate,bitrateMin:l.bitrate}),void 0,void 0,h);return p.on(Yh.TRANSCEIVER_UPDATED,v=>{t._updateRtpTransceiver(v,nu.LOW_STREAM)}),p._hints.push(mn.LOW_STREAM),t.addListener(Fe.NEED_CLOSE,()=>{p.close()}),p}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(t,n,a,l){var u;const h=Array.from(zo(u=this.remoteUserMap).call(u)).find(p=>p._videoSSRC===t);if(h){l||this.store.subscribe(h.uid,"video",void 0,void 0,void 0,void 0,Date.now());const p=this.store.keyMetrics,v=p.subscribe.find(E=>E.userId===h.uid&&E.type==="video");We.firstRemoteVideoDecode(this.store.sessionId,Cr.FIRST_VIDEO_DECODE,yn.FIRST_VIDEO_DECODE,{peer:h._uintid,videowidth:n,videoheight:a,subscribeElapse:li.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId,apEnd:p.requestAPEnd||0,apStart:p.requestAPStart||0,joinGwEnd:p.joinGatewayEnd||0,joinGwStart:p.joinGatewayStart||0,pcEnd:p.peerConnectionEnd||0,pcStart:p.peerConnectionStart||0,subscriberEnd:(v==null?void 0:v.subscribeEnd)||0,subscriberStart:(v==null?void 0:v.subscribeStart)||0,videoAddNotify:(v==null?void 0:v.streamAdded)||0,state:l?1:0})}}async remoteMediaSsrcChanged(t,n,a){if(!this.recvConnection)return!1;const l=this.remoteUserMap.get(t);if(!l)return!1;const u=l.get(n);if(!u)return!1;const h=await this.recvConnection.getRemoteSSRC(u);return h!==void 0&&h!==a}resetConnection(t){L.debug("[".concat(this.store.clientId,"] [P2PChannel2] reset connection to ").concat(t)),this.state===tn.Connected?(L.debug("[".concat(this.store.clientId,"] [P2PChannel2] fallback to websocket but P2PChannel2 state still connected, disconnect first")),this.disconnectForReconnect()):(this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0))}async publishDataChannel(t){throw new Te(z.NOT_SUPPORTED)}async unpublishDataChannel(t){throw new Te(z.NOT_SUPPORTED)}async subscribeDataChannel(t,n){throw new Te(z.NOT_SUPPORTED)}async unsubscribeDataChannel(t,n){throw new Te(z.NOT_SUPPORTED)}hasPendingRemoteDataChannel(t,n){throw new Te(z.NOT_SUPPORTED)}setPendingRemoteDataChannel(t,n){throw new Te(z.NOT_SUPPORTED)}async preConnect(t,n,a,l,u,h){throw new Te(z.NOT_SUPPORTED)}getEstablishParams(){throw new Te(z.NOT_SUPPORTED)}async reSubscribe(t){throw new Te(z.NOT_SUPPORTED)}async updateVideoStreamParameter(t,n){throw new Te(z.NOT_SUPPORTED)}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(t=>{let[n,{track:a}]=t;n===Ie.LocalVideoLowTrack?a._updateRtpTransceiver(void 0,nu.LOW_STREAM):a._updateRtpTransceiver(void 0)})}}function Bs(i){return function(t,n,a){const l=t[n];if(typeof l!="function")throw new Error("Cannot use mutex on object property.");return a.value=async function(){for(var u=arguments.length,h=new Array(u),p=0;p<u;p++)h[p]=arguments[p];switch(i){case Na.SEND_ONLY:{const v=await this.sendMutex.lock("From P2PChannel2.".concat(n));try{return await l.apply(this,h)}finally{v()}}case Na.RECEIVE_ONLY:{const v=await this.recvMutex.lock("From P2PChannel2.".concat(n));try{return await l.apply(this,h)}finally{v()}}default:{const v=await this.sendMutex.lock("From P2PChannel2.".concat(n)),E=await this.recvMutex.lock("From P2PChannel2.".concat(n));try{return await l.apply(this,h)}finally{v(),E()}}}},a}}function VU(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function Od(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?VU(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):VU(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}Re([Bs(Na.SEND_ONLY),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",_e)],Rr.prototype,"p2pConnect",null),Re([Bs(Na.SEND_ONLY),H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],Rr.prototype,"unpublish",null),Re([Bs(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",_e)],Rr.prototype,"unpublishLowStream",null),Re([Bs(Na.RECEIVE_ONLY),H("design:type",Function),H("design:paramtypes",[Kr,String,Number,String]),H("design:returntype",_e)],Rr.prototype,"subscribe",null),Re([Bs(Na.RECEIVE_ONLY),H("design:type",Function),H("design:paramtypes",[Kr,String,Number,String]),H("design:returntype",_e)],Rr.prototype,"mockSubscribe",null),Re([Bs(Na.RECEIVE_ONLY),H("design:type",Function),H("design:paramtypes",[Kr,String,Boolean]),H("design:returntype",_e)],Rr.prototype,"unsubscribe",null),Re([Bs(Na.RECEIVE_ONLY),H("design:type",Function),H("design:paramtypes",[Kr,String]),H("design:returntype",_e)],Rr.prototype,"muteRemote",null),Re([Bs(Na.RECEIVE_ONLY),H("design:type",Function),H("design:paramtypes",[Kr,String]),H("design:returntype",_e)],Rr.prototype,"unmuteRemote",null),Re([Bs(Na.RECEIVE_ONLY),H("design:type",Function),H("design:paramtypes",[Kr,String]),H("design:returntype",_e)],Rr.prototype,"hasRemoteMediaWithLock",null),Re([Bs(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",_e)],Rr.prototype,"disconnectForReconnect",null),Re([Bs(Na.RECEIVE_ONLY),H("design:type",Function),H("design:paramtypes",[Kr,String,Number]),H("design:returntype",_e)],Rr.prototype,"remoteMediaSsrcChanged",null);class M0{constructor(t){w(this,"store",void 0),w(this,"onStatsException",void 0),w(this,"onUploadPublishDuration",void 0),w(this,"onStatsChanged",void 0),w(this,"localStats",new Map),w(this,"remoteStats",new Map),w(this,"updateStatsInterval",void 0),w(this,"trafficStats",void 0),w(this,"trafficStatsPeerList",[]),w(this,"uplinkStats",void 0),w(this,"exceptionMonitor",void 0),w(this,"p2pChannel",void 0),w(this,"scalabilityMode",_T.L1T1),w(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=t,this.updateStatsInterval=window.setInterval(this.updateStats,1e3),this.exceptionMonitor=new wne,this.exceptionMonitor.on("exception",(n,a,l)=>{this.onStatsException&&this.onStatsException(n,a,l)})}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(Ie.LocalAudioTrack)||Od({},GT)}getLocalVideoTrackStats(){return this.localStats.get(Ie.LocalVideoTrack)||Od({},zT)}getRemoteAudioTrackStats(t){const n=(u,h)=>{if(!this.trafficStats)return h;const p=this.trafficStats.peer_delay.find(v=>v.peer_uid===u);return p&&(h.publishDuration=p.B_ppad+(Date.now()-this.trafficStats.timestamp)),h},a={};if(t){var l;const u=(l=this.remoteStats.get(t))===null||l===void 0?void 0:l.audioStats;u&&(a[t]=n(t,u))}else Array.from(this.remoteStats.entries()).forEach(u=>{let[h,{audioStats:p}]=u;p&&(a[h]=n(h,p))});return a}getRemoteNetworkQualityStats(t){const n={};if(t){var a;const l=(a=this.remoteStats.get(t))===null||a===void 0?void 0:a.networkStats;l&&(n[t]=l)}else Array.from(this.remoteStats.entries()).forEach(l=>{let[u,{networkStats:h}]=l;h&&(n[u]=h)});return n}getRemoteVideoTrackStats(t){const n=(u,h)=>{if(!this.trafficStats)return h;const p=this.trafficStats.peer_delay.find(v=>v.peer_uid===u);return p&&(h.publishDuration=p.B_ppvd+(Date.now()-this.trafficStats.timestamp)),h},a={};if(t){var l;const u=(l=this.remoteStats.get(t))===null||l===void 0?void 0:l.videoStats;u&&(a[t]=n(t,u))}else Array.from(this.remoteStats.entries()).forEach(u=>{let[h,{videoStats:p}]=u;p&&(a[h]=n(h,p))});return a}getRTCStats(){let t=0,n=0,a=0,l=0;const u=this.localStats.get(Ie.LocalAudioTrack);u&&(t+=u.sendBytes,n+=u.sendBitrate);const h=this.localStats.get(Ie.LocalVideoTrack);h&&(t+=h.sendBytes,n+=h.sendBitrate);const p=this.localStats.get(Ie.LocalVideoLowTrack);p&&(t+=p.sendBytes,n+=p.sendBitrate),this.remoteStats.forEach(E=>{let{audioStats:y,videoStats:C}=E;y&&(a+=y.receiveBytes,l+=y.receiveBitrate),C&&(a+=C.receiveBytes,l+=C.receiveBitrate)});let v=1;return this.trafficStats&&(v+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:v,SendBitrate:n,SendBytes:t,RecvBytes:a,RecvBitrate:l,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(t){this.localStats.set(t,void 0)}removeLocalStats(t){t?this.localStats.delete(t):this.localStats.clear()}addRemoteStats(t){this.remoteStats.set(t,{})}removeRemoteStats(t){t?this.remoteStats.delete(t):this.remoteStats.clear()}addP2PChannel(t){this.p2pChannel=t}updateTrafficStats(t){t.peer_delay=t.peer_delay.filter(n=>n.B_ppad!==void 0||n.B_ppvd!==void 0),t.peer_delay.filter(n=>this.trafficStatsPeerList.indexOf(n.peer_uid)===-1).forEach(n=>{var a;const l=(a=this.p2pChannel)===null||a===void 0?void 0:a.getRemoteMedia(n.peer_uid),u=l!=null&&l.videoSSRC?li.measureFromSubscribeStart(this.store.clientId,l.videoSSRC):0,h=l!=null&&l.audioSSRC?li.measureFromSubscribeStart(this.store.clientId,l.audioSSRC):0;n.B_ppad!==void 0&&n.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(n.peer_uid,n.B_ppad,n.B_ppvd,u>h?u:h),this.trafficStatsPeerList.push(n.peer_uid))}),this.trafficStats=t}updateUplinkStats(t){this.uplinkStats&&this.uplinkStats.B_fir!==t.B_fir&&L.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(t.B_fir)),this.uplinkStats=t}static isRemoteVideoFreeze(t,n,a){if(!t)return!1;const l=!!a&&n.framesDecodeFreezeTime>a.framesDecodeFreezeTime,u=!a||n.framesDecodeCount>a.framesDecodeCount;return l||!u}static isRemoteAudioFreeze(t){return!!t&&t._isFreeze()}isLocalVideoFreeze(t){return!(!t.inputFrame||!t.sentFrame)&&t.inputFrame.frameRate>5&&t.sentFrame.frameRate<3}updateLocalStats(t){Array.from(this.localStats.entries()).forEach(n=>{let[a,l]=n;switch(a){case Ie.LocalVideoTrack:case Ie.LocalVideoLowTrack:{const h=l,p=Od({},zT),v=t.getStats(),E=t.getLocalMedia(a);if(v){const y=v.videoSend.find(C=>C.ssrc===(E==null?void 0:E.ssrcs[0].ssrcId));if(y){const C=t.getLocalVideoSize(),I=t.getEncoderConfig(Ie.LocalVideoTrack);y.codec!=="H264"&&y.codec!=="H265"&&y.codec!=="VP8"&&y.codec!=="VP9"&&y.codec!=="AV1X"&&y.codec!=="AV1"||(p.codecType=y.codec),p.sendBytes=y.bytes,p.sendBitrate=h?8*Math.max(0,p.sendBytes-h.sendBytes):0,y.inputFrame?(p.captureFrameRate=y.inputFrame.frameRate,p.captureResolutionHeight=y.inputFrame.height,p.captureResolutionWidth=y.inputFrame.width):C&&(p.captureResolutionWidth=C.width,p.captureResolutionHeight=C.height),y.sentFrame?(p.sendFrameRate=y.sentFrame.frameRate,p.sendResolutionHeight=y.sentFrame.height,p.sendResolutionWidth=y.sentFrame.width):C&&(p.sendResolutionWidth=C.width,p.sendResolutionHeight=C.height),y.avgEncodeMs&&(p.encodeDelay=y.avgEncodeMs),I&&I.bitrateMax&&(p.targetSendBitrate=1e3*I.bitrateMax),p.sendPackets=y.packets,p.sendPacketsLost=y.packetsLost,p.sendJitterMs=y.jitterMs,p.sendRttMs=y.rttMs,p.totalDuration=h?h.totalDuration+1:1,p.totalFreezeTime=h?h.totalFreezeTime:0,this.isLocalVideoFreeze(y)&&(p.totalFreezeTime+=1),y.scalabilityMode&&this.scalabilityMode!==y.scalabilityMode&&(L.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(y.scalabilityMode)),this.scalabilityMode=y.scalabilityMode)}this.trafficStats&&(p.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var u;this.localStats.set(a,p),((h==null?void 0:h.sendResolutionWidth)!==p.sendResolutionWidth||(h==null?void 0:h.sendResolutionHeight)!==p.sendResolutionHeight)&&((u=this.onStatsChanged)===null||u===void 0||u.call(this,"resolution",{width:p.sendResolutionWidth,height:p.sendResolutionHeight})),p&&E&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,E.track,p);break}case Ie.LocalAudioTrack:{const h=l,p=Od({},GT),v=t.getStats(),E=t.getLocalMedia(a);if(v){const y=v.audioSend.find(C=>C.ssrc===(E==null?void 0:E.ssrcs[0].ssrcId));if(y){if(y.codec!=="opus"&&y.codec!=="aac"&&y.codec!=="PCMU"&&y.codec!=="PCMA"&&y.codec!=="G722"||(p.codecType=y.codec),y.inputLevel)p.sendVolumeLevel=Math.round(32767*y.inputLevel);else{const C=t.getLocalAudioVolume();C&&(p.sendVolumeLevel=Math.round(32767*C))}p.sendBytes=y.bytes,p.sendPackets=y.packets,p.sendPacketsLost=y.packetsLost,p.sendJitterMs=y.jitterMs,p.sendRttMs=y.rttMs,p.sendBitrate=h?8*Math.max(0,p.sendBytes-h.sendBytes):0}}this.trafficStats&&(p.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(Ie.LocalAudioTrack,p),p&&E&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,E.track,p);break}}})}updateRemoteStats(t){Array.from(this.remoteStats.entries()).forEach(n=>{var a,l;let[u,{videoStats:h,audioStats:p,videoPcStats:v}]=n;const E=p,y=h,C=v,I=Od({},zM),k=Od({},KM),G=Od({},ute),{audioTrack:B,videoTrack:j,audioSSRC:q,videoSSRC:Z}=t.getRemoteMedia(u);let re;re=t instanceof Rr?t.getStats(!0):t.getStats();const Ce=(a=re)===null||a===void 0?void 0:a.audioRecv.find(ye=>ye.ssrc===q),pe=(l=re)===null||l===void 0?void 0:l.videoRecv.find(ye=>ye.ssrc===Z),fe=this.trafficStats&&this.trafficStats.peer_delay.find(ye=>ye.peer_uid===u);if(Ce&&(Ce.codec!=="opus"&&Ce.codec!=="aac"&&Ce.codec!=="PCMU"&&Ce.codec!=="PCMA"&&Ce.codec!=="G722"||(I.codecType=Ce.codec),Ce.outputLevel?I.receiveLevel=Math.round(32767*Ce.outputLevel):B&&(I.receiveLevel=Math.round(32767*B.getVolumeLevel())),I.receiveBytes=Ce.bytes,I.receivePackets=Ce.packets,I.receivePacketsLost=Ce.packetsLost,I.packetLossRate=I.receivePacketsLost/(I.receivePackets+I.receivePacketsLost),I.receiveBitrate=E?8*Math.max(0,I.receiveBytes-E.receiveBytes):0,I.totalDuration=E?E.totalDuration+1:1,I.totalFreezeTime=E?E.totalFreezeTime:0,I.freezeRate=I.totalFreezeTime/I.totalDuration,I.receiveDelay=Ce.jitterBufferMs,I.totalDuration>10&&M0.isRemoteAudioFreeze(B)&&(I.totalFreezeTime+=1)),pe){pe.codec!=="H264"&&pe.codec!=="H265"&&pe.codec!=="VP8"&&pe.codec!=="VP9"&&pe.codec!=="AV1X"&&pe.codec!=="AV1"||(k.codecType=pe.codec),k.receiveBytes=pe.bytes,k.receiveBitrate=y?8*Math.max(0,k.receiveBytes-y.receiveBytes):0,k.decodeFrameRate=pe.decodeFrameRate<0?0:pe.decodeFrameRate,k.renderFrameRate=pe.decodeFrameRate<0?0:pe.decodeFrameRate,pe.outputFrame&&(k.renderFrameRate=pe.outputFrame.frameRate),pe.receivedFrame?(k.receiveFrameRate=pe.receivedFrame.frameRate,k.receiveResolutionHeight=pe.receivedFrame.height,k.receiveResolutionWidth=pe.receivedFrame.width):j&&(k.receiveResolutionHeight=j._videoHeight||0,k.receiveResolutionWidth=j._videoWidth||0),pe.framesRateFirefox!==void 0&&(k.receiveFrameRate=Math.round(pe.framesRateFirefox)),k.receivePackets=pe.packets,k.receivePacketsLost=pe.packetsLost,k.packetLossRate=k.receivePacketsLost/(k.receivePackets+k.receivePacketsLost),k.totalDuration=y?y.totalDuration+1:1,k.totalFreezeTime=y?y.totalFreezeTime:0,k.receiveDelay=pe.jitterBufferMs||0;const ye=!!Z&&t.getRemoteVideoIsReady(Z);j&&ye&&M0.isRemoteVideoFreeze(j,pe,C)&&(k.totalFreezeTime+=1),k.freezeRate=k.totalFreezeTime/k.totalDuration}fe&&(I.end2EndDelay=fe.B_ad,k.end2EndDelay=fe.B_vd,I.transportDelay=fe.B_ed,k.transportDelay=fe.B_ed,I.currentPacketLossRate=fe.B_ealr4/100,k.currentPacketLossRate=fe.B_evlr4/100,G.uplinkNetworkQuality=fe.B_punq?fe.B_punq:0,G.downlinkNetworkQuality=fe.B_pdnq?fe.B_pdnq:0),this.remoteStats.set(u,{audioStats:I,videoStats:k,videoPcStats:pe,networkStats:G}),B&&this.exceptionMonitor.setRemoteAudioStats(B,I),j&&this.exceptionMonitor.setRemoteVideoStats(j,k)})}}function $U(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function F0(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$U(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):$U(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}class zne extends wn{constructor(t,n,a,l){super(),w(this,"spec",void 0),w(this,"token",void 0),w(this,"websocket",void 0),w(this,"pingpongTimer",void 0),w(this,"reconnectMode","retry"),w(this,"serviceMode",void 0),w(this,"reqId",0),w(this,"commandReqId",0),w(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),w(this,"handleWebSocketMessage",u=>{if(!u.data)return;const h=JSON.parse(u.data);h.requestId?this.emit("@".concat(h.requestId,"-").concat(h.sid),h):this.serviceMode===br.INJECT?this.emit(es.INJECT_STREAM_STATUS,h):(We.workerEvent(this.spec.sid,{actionType:"status",serverCode:h.code,workerType:this.serviceMode===br.TRANSCODE?1:2}),this.emit(es.PUBLISH_STREAM_STATUS,h))}),this.spec=n,this.token=t,this.serviceMode=l,this.websocket=new d0("live-streaming",a),this.websocket.on(nt.CONNECTED,this.handleWebSocketOpen),this.websocket.on(nt.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(nt.REQUEST_NEW_URLS,(u,h)=>{cr(this,es.REQUEST_NEW_ADDRESS).then(u).catch(h)}),this.websocket.on(nt.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(t){return this.websocket.init(t)}async request(t,n,a,l){this.reqId+=1,t==="request"&&(this.commandReqId+=1);const u=this.commandReqId,h=this.reqId;if(!h||!this.websocket)throw new ue(z.UNEXPECTED_ERROR);const p=F0({command:t,sdkVersion:Ta==="4.20.0"?"0.0.1":Ta,seq:h,requestId:h,allocate:a,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},n);if(this.websocket.state==="closed")throw new ue(z.WS_DISCONNECT);const v=()=>new _e((I,k)=>{this.websocket.once(nt.CLOSED,()=>k(new ue(z.WS_ABORT))),this.websocket.once(nt.CONNECTED,I)});this.websocket.state!=="connected"&&await v(),p.clientRequest&&(p.clientRequest.workerToken=this.token);const E=new _e((I,k)=>{const G=()=>{k(new ue(z.WS_ABORT))};this.websocket.once(nt.RECONNECTING,G),this.websocket.once(nt.CLOSED,G),this.once("@".concat(h,"-").concat(this.spec.sid),B=>{I(B)})});l&&We.workerEvent(this.spec.sid,F0(F0({},l),{},{requestId:u,actionType:"request",payload:JSON.stringify(n.clientRequest),serverCode:0,code:0}));const y=Date.now();this.websocket.sendMessage(p);let C=null;try{C=await E}catch(I){if(this.websocket.state==="closed")throw I;return await v(),await this.request(t,n,a)}return l&&We.workerEvent(this.spec.sid,F0(F0({},l),{},{requestId:u,actionType:"response",payload:JSON.stringify(C.serverResponse),serverCode:C.code,success:C.code===200,responseTime:Date.now()-y})),C.code!==200&&this.handleResponseError(C),C}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const t=Ta==="4.20.0"?"0.0.1":Ta;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:t,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(t){switch(t.code){case nr.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void L.warning("live stream response already exists stream");case nr.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case nr.LIVE_STREAM_RESPONSE_BAD_STREAM:case nr.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new ue(z.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:t.code}).throw();case nr.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(t.serverResponse.command==="UnpublishStream"||t.serverResponse.command==="UninjectStream")return;throw new ue(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case nr.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new ue(z.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:t.code}).throw();case nr.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const n=new ue(z.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(es.WARNING,n,t.serverResponse.url)}case nr.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const n=new ue(z.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(es.WARNING,n,t.serverResponse.url)}case nr.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new ue(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case nr.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new ue(z.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:t.code}).throw();case nr.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const n=new ue(z.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(es.WARNING,n,t.serverResponse.url)}case nr.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new ue(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:t.code}).throw();case nr.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new ue(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case nr.LIVE_STREAM_RESPONSE_WORKER_LOST:case nr.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(t.serverResponse.command==="UnpublishStream"||t.serverResponse.command==="UninjectStream")return;throw new ue(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case nr.ERROR_FAIL_SEND_MESSAGE:if(t.serverResponse.command==="UnpublishStream"||t.serverResponse.command==="UninjectStream")return;if(t.serverResponse.command==="UpdateTranscoding"||t.serverResponse.command==="ControlStream")return new ue(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:t.code}).throw();throw new ue(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case nr.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case nr.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case nr.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case nr.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new ue(z.LIVE_STREAMING_CDN_ERROR,"",{code:t.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(yv)},6e3)}}function HU(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function eo(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?HU(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):HU(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}class Kne extends wn{constructor(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ur,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ur;super(),w(this,"onLiveStreamWarning",void 0),w(this,"onLiveStreamError",void 0),w(this,"onInjectStatusChange",void 0),w(this,"spec",void 0),w(this,"retryTimeout",1e4),w(this,"connection",void 0),w(this,"httpRetryConfig",void 0),w(this,"wsRetryConfig",void 0),w(this,"streamingTasks",new Map),w(this,"isStartingStreamingTask",!1),w(this,"taskMutex",new Ur("live-streaming")),w(this,"cancelToken",ho.CancelToken.source()),w(this,"transcodingConfig",void 0),w(this,"injectConfig",eo({},Iee)),w(this,"injectLoopTimes",0),w(this,"uapResponse",void 0),w(this,"lastTaskId",1),w(this,"statusError",new Map),this.spec=t,this.httpRetryConfig=a,this.wsRetryConfig=n}async setTranscodingConfig(t){const n=eo(eo({},wee),t);n.videoCodecProfile!==66&&n.videoCodecProfile!==77&&n.videoCodecProfile!==100&&(L.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(n.videoCodecProfile," -> 100")),n.videoCodecProfile=100),n.transcodingUsers||(n.transcodingUsers=n.userConfigs),n.transcodingUsers&&(n.transcodingUsers=n.transcodingUsers.map(h=>eo(eo(eo({},Ree),h),{},{zOrder:h.zOrder?h.zOrder+1:1}))),function(h){Nn(h.width)||an(h.width,"config.width",0,1e4),Nn(h.height)||an(h.height,"config.height",0,1e4),Nn(h.videoBitrate)||an(h.videoBitrate,"config.videoBitrate",1,1e6),Nn(h.videoFrameRate)||an(h.videoFrameRate,"config.videoFrameRate"),Nn(h.lowLatency)||Gl(h.lowLatency,"config.lowLatency"),Nn(h.audioSampleRate)||Sr(h.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),Nn(h.audioBitrate)||an(h.audioBitrate,"config.audioBitrate",1,128),Nn(h.audioChannels)||Sr(h.audioChannels,"config.audioChannels",[1,2,3,4,5]),Nn(h.videoGop)||an(h.videoGop,"config.videoGop"),Nn(h.videoCodecProfile)||Sr(h.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),Nn(h.userCount)||an(h.userCount,"config.userCount",0,17),Nn(h.backgroundColor)||an(h.backgroundColor,"config.backgroundColor",0,16777215),Nn(h.userConfigExtraInfo)||ai(h.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),h.transcodingUsers&&!Nn(h.transcodingUsers)&&(Yc(h.transcodingUsers,"config.transcodingUsers"),h.transcodingUsers.forEach((p,v)=>{CT(p.uid),Nn(p.x)||an(p.x,"transcodingUser[".concat(v,"].x"),0,1e4),Nn(p.y)||an(p.y,"transcodingUser[".concat(v,"].y"),0,1e4),Nn(p.width)||an(p.width,"transcodingUser[".concat(v,"].width"),0,1e4),Nn(p.height)||an(p.height,"transcodingUser[".concat(v,"].height"),0,1e4),Nn(p.zOrder)||an(p.zOrder-1,"transcodingUser[".concat(v,"].zOrder"),0,100),Nn(p.alpha)||an(p.alpha,"transcodingUser[".concat(v,"].alpha"),0,1,!1)})),Nn(h.watermark)||TT(h.watermark,"watermark"),Nn(h.backgroundImage)||TT(h.backgroundImage,"backgroundImage"),h.images&&!Nn(h.images)&&(Yc(h.images,"config.images"),h.images.forEach((p,v)=>{TT(p,"images[".concat(v,"]"))}))}(n);const a=[];n.images&&a.push(...n.images.map(h=>eo(eo(eo({},bT),h),{},{zOrder:255}))),n.backgroundImage&&(a.push(eo(eo(eo({},bT),n.backgroundImage),{},{zOrder:0})),delete n.backgroundImage),n.watermark&&(a.push(eo(eo(eo({},bT),n.watermark),{},{zOrder:255})),delete n.watermark),n.images=a,n.transcodingUsers&&(n.userConfigs=n.transcodingUsers.map(h=>eo({},h)),n.userCount=n.transcodingUsers.length,delete n.transcodingUsers);const l=(n.userConfigs||[]).map(h=>typeof h.uid=="number"?_e.resolve(h.uid):jM(h.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await _e.all(l)).forEach((h,p)=>{n.userConfigs&&n.userConfigs[p]&&(n.userConfigs[p].uid=h)}),this.transcodingConfig=n,this.connection)try{var u;const h=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(ks(u=this.streamingTasks).call(u)).map(p=>p.taskId).join("#")});L.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(h.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(h){if(!h.data||!h.data.retry)throw h;h.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(p=>{L.warning("[".concat(this.spec.clientId,"] live streaming receive error"),h.toString(),"try to republish",p.url),this.startLiveStreamingTask(p.url,p.mode,h).then(()=>{L.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(p.url," success"))}).catch(v=>{L.error("[".concat(this.spec.clientId,"] live streaming republish failed"),p.url,v.toString()),this.onLiveStreamError&&this.onLiveStreamError(p.url,v)})})}}setInjectStreamConfig(t,n){this.injectConfig=Object.assign({},this.injectConfig,t),this.injectLoopTimes=n}async startLiveStreamingTask(t,n,a){var l;if(Array.from(ks(l=this.streamingTasks).call(l)).find(v=>v.mode===br.INJECT)&&n===br.INJECT)return new ue(z.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw();if(!this.transcodingConfig&&n===br.TRANSCODE)throw new ue(z.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");let u={command:"PublishStream",ts:Date.now(),url:t,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};L.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(t,", mode: ").concat(n));const h=await this.taskMutex.lock();if(!this.connection&&a)return void h();if(this.streamingTasks.get(t)&&!a)return h(),new ue(z.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(n))}catch(v){throw h(),v}switch(n){case br.TRANSCODE:u.transcodingConfig=eo({},this.transcodingConfig);break;case br.RAW:break;case br.INJECT:u={cname:this.spec.cname,command:"InjectStream",sid:this.spec.sid,transcodingConfig:this.injectConfig,ts:Date.now(),url:t,loopTimes:this.injectLoopTimes}}this.uapResponse&&this.uapResponse.vid&&(u.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const p=this.lastTaskId++;try{const v=new _e((y,C)=>{Fr(this.retryTimeout).then(()=>{if(a)return C(a);const I=this.statusError.get(t);return I?(this.statusError.delete(t),C(I)):void 0})}),E=await _e.race([this.connection.request("request",{clientRequest:u},!0,{url:t,command:"PublishStream",workerType:n===br.TRANSCODE?1:2,requestByUser:!a,tid:p.toString()}),v]);this.isStartingStreamingTask=!1,L.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(E.code)),this.streamingTasks.set(t,{clientRequest:u,mode:n,url:t,taskId:p}),h()}catch(v){if(h(),this.isStartingStreamingTask=!1,!v.data||!v.data.retry||a)throw v;return v.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(t,n,v)):await this.startLiveStreamingTask(t,n,v)}}stopLiveStreamingTask(t){return new _e((n,a)=>{const l=this.streamingTasks.get(t);if(!l||!this.connection)return new ue(z.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const u=l.mode;l.abortTask=()=>{L.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(t),n()},this.connection.request("request",{clientRequest:{command:u===br.INJECT?"UninjectStream":"UnpublishStream",url:l.url}},!1,{url:t,command:"UnPublishStream",workerType:u===br.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(h=>{L.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(h.code)),this.streamingTasks.delete(t),this.streamingTasks.size===0&&u!==br.INJECT&&(this.connection&&this.connection.close(),this.connection=void 0),n(),u===br.INJECT&&this.onInjectStatusChange&&this.onInjectStatusChange(Xl.INJECT_STREAM_STATUS_STOP_SUCCESS,this.spec.uid,t)}).catch(a)})}async controlInjectStream(t,n,a,l){const u=this.streamingTasks.get(t);if(!u||!this.connection||u.mode!==br.INJECT)throw new ue(z.INVALID_OPERATION,"can not find inject stream task to control");return(await this.connection.request("request",{clientRequest:{command:"ControlStream",url:t,control:n,audioVolume:a,position:l}})).serverResponse}resetAllTask(){var t;const n=Array.from(ks(t=this.streamingTasks).call(t));this.terminate();for(const a of n)this.startLiveStreamingTask(a.url,a.mode).catch(l=>{this.onLiveStreamError&&this.onLiveStreamError(a.url,l)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=ho.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(t){if(this.connection)throw new ue(z.UNEXPECTED_ERROR,"live streaming connection has already connected");const n=await cr(this,Hh.REQUEST_WORKER_MANAGER_LIST,t);return this.uapResponse=n,this.connection=new zne(n.workerToken,this.spec,this.wsRetryConfig,t),this.connection.on(es.WARNING,(a,l)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(l,a)),this.connection.on(es.PUBLISH_STREAM_STATUS,a=>this.handlePublishStreamServer(a)),this.connection.on(es.INJECT_STREAM_STATUS,a=>this.handleInjectStreamServerStatus(a)),this.connection.on(es.REQUEST_NEW_ADDRESS,(a,l)=>{if(!this.connection)return l(new ue(z.UNEXPECTED_ERROR,"can not get new live streaming address list"));cr(this,Hh.REQUEST_WORKER_MANAGER_LIST,t).then(u=>{this.uapResponse=u,a(u.addressList)}).catch(l)}),await this.connection.init(n.addressList),this.connection}handlePublishStreamServer(t){const n=t.serverStatus&&t.serverStatus.url||"empty_url",a=this.streamingTasks.get(n),l=t.reason;switch(t.code){case nr.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case nr.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case nr.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case nr.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const h=new ue(z.LIVE_STREAMING_CDN_ERROR,"",{code:t.code});if(a)return L.error(h.toString()),this.onLiveStreamError&&this.onLiveStreamError(n,h);if(!this.isStartingStreamingTask)return;this.statusError.set(n,h)}case nr.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const h=new ue(z.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,l);return this.onLiveStreamWarning&&this.onLiveStreamWarning(n,h)}case nr.LIVE_STREAM_RESPONSE_WORKER_LOST:case nr.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var u;if(!this.connection)return;this.connection.tryNextAddress();const h=Array.from(ks(u=this.streamingTasks).call(u));for(const p of h)p.abortTask?p.abortTask():(L.warning("[".concat(this.spec.clientId,"] publish stream status code"),t.code,"try to republish",p.url),this.startLiveStreamingTask(p.url,p.mode,new ue(z.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:t.code})).then(()=>{L.debug("[".concat(this.spec.clientId,"] republish live stream success"),p.url)}).catch(v=>{L.error(v.toString()),this.onLiveStreamError&&this.onLiveStreamError(p.url,v)}));return}}}handleInjectStreamServerStatus(t){const n=Number(t.uid),a=t.serverStatus&&t.serverStatus.url;switch(t.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(Xl.INJECT_STREAM_STATUS_START_SUCCESS,n,a));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(Xl.INJECT_STREAM_STATUS_START_ALREADY_EXISTS,n,a),void this.streamingTasks.delete(a);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(Xl.INJECT_STREAM_STATUS_START_UNAUTHORIZED,n,a),void this.streamingTasks.delete(a);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(Xl.INJECT_STREAM_STATUS_BROKEN,n,a),void this.streamingTasks.delete(a);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(Xl.INJECT_STREAM_STATUS_START_TIMEOUT,n,a),void this.streamingTasks.delete(a);default:return void L.debug("inject stream server status",t)}}hasUrl(t){return this.streamingTasks.has(t)}}class vE{constructor(){w(this,"destChannelMediaInfos",new Map),w(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(t){sM(t),this.srcChannelMediaInfo=t}addDestChannelInfo(t){sM(t),this.destChannelMediaInfos.set(t.channelName,t)}removeDestChannelInfo(t){ST(t),this.destChannelMediaInfos.delete(t)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function WU(i){if(!(i instanceof vE))return new ue(z.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const t=i.getSrcChannelMediaInfo(),n=i.getDestChannelMediaInfo();if(!t)return new ue(z.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(n.size===0)return new ue(z.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class Yne extends wn{constructor(t,n,a){super(),w(this,"ws",void 0),w(this,"requestId",1),w(this,"heartBeatTimer",void 0),w(this,"joinInfo",void 0),w(this,"clientId",void 0),w(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),w(this,"onClose",l=>{this.emit("close"),this.dispose()}),w(this,"onMessage",l=>{const u=JSON.parse(l.data);if(!u||u.command!=="serverResponse"||!u.requestId)return u&&u.command==="serverStatus"&&u.serverStatus&&u.serverStatus.command?(this.emit("status",u.serverStatus),void this.emit(u.serverStatus.command,u.serverStatus)):void 0;this.emit("req_".concat(u.requestId),u)}),this.joinInfo=t,this.clientId=n,this.ws=new d0("cross-channel-".concat(this.clientId),a),this.ws.on(nt.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(nt.CONNECTED,this.onOpen),this.ws.on(nt.ON_MESSAGE,this.onMessage),this.ws.on(nt.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(t){const n=this.requestId++;return t.requestId=n,t.seq=n,this.ws.sendMessage(t),n}waitStatus(t){return new _e((n,a)=>{const l=window.setTimeout(()=>{a(new ue(z.TIMEOUT,"wait status timeout, status: ".concat(t)))},5e3);this.once(t,u=>{window.clearTimeout(l),u.state&&u.state!==0?a(new ue(z.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(t))):n(void 0)}),this.once("dispose",()=>{window.clearTimeout(l),a(new ue(z.WS_ABORT))})})}async request(t){if(this.ws.state==="closed")throw new ue(z.WS_DISCONNECT);const n=()=>new _e((h,p)=>{this.ws.once(nt.CLOSED,()=>p(new ue(z.WS_ABORT))),this.ws.once(nt.CONNECTED,h)});this.ws.state!=="connected"&&await n();const a=this.sendMessage(t),l=new _e((h,p)=>{const v=()=>{p(new ue(z.WS_ABORT))};this.ws.once(nt.RECONNECTING,v),this.ws.once(nt.CLOSED,v),this.once("req_".concat(a),h),Fr(3e3).then(()=>{this.removeAllListeners("req_".concat(a)),this.ws.off(nt.RECONNECTING,v),this.ws.off(nt.CLOSED,v),p(new ue(z.TIMEOUT,"cross channel ws request timeout"))})}),u=await l;if(!u||u.code!==200)throw new ue(z.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(u)));return u}async connect(t){this.ws.removeAllListeners(nt.REQUEST_NEW_URLS),this.ws.on(nt.REQUEST_NEW_URLS,n=>{n(t)}),await this.ws.init(t)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(t){const n=this.requestId++;return t.requestId=n,this.ws.sendMessage(t),n}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class qne extends wn{set state(t){t!==this._state&&(t!==Wi.RELAY_STATE_FAILURE&&(this.errorCode=Jl.RELAY_OK),this.emit("state",t,this.errorCode),this._state=t)}get state(){return this._state}constructor(t,n,a,l,u){super(),w(this,"joinInfo",void 0),w(this,"sid",void 0),w(this,"clientId",void 0),w(this,"cancelToken",ho.CancelToken.source()),w(this,"workerToken",void 0),w(this,"requestId",0),w(this,"signal",void 0),w(this,"prevChannelMediaConfig",void 0),w(this,"httpRetryConfig",void 0),w(this,"_resolution",void 0),w(this,"_state",Wi.RELAY_STATE_IDLE),w(this,"errorCode",Jl.RELAY_OK),w(this,"onStatus",h=>{L.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(h))),h&&h.command&&(h.command==="onAudioPacketReceived"&&this.emit("event",Ls.PACKET_RECEIVED_AUDIO_FROM_SRC),h.command==="onVideoPacketReceived"&&this.emit("event",Ls.PACKET_RECEIVED_VIDEO_FROM_SRC),h.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=Jl.SRC_TOKEN_EXPIRED,this.state=Wi.RELAY_STATE_FAILURE),h.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=Jl.DEST_TOKEN_EXPIRED,this.state=Wi.RELAY_STATE_FAILURE))}),w(this,"onReconnect",async()=>{L.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",Ls.NETWORK_DISCONNECTED),this.state=Wi.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(h=>{this.state!==Wi.RELAY_STATE_IDLE&&(L.error("auto restart channel media relay failed",h.toString()),this.errorCode=Jl.SERVER_CONNECTION_LOST,this.state=Wi.RELAY_STATE_FAILURE)})}),this.joinInfo=t,this.clientId=n,this.sid=Yb(),this.signal=new Yne(this.joinInfo,this.clientId,a),this.httpRetryConfig=l,this._resolution=u}async startChannelMediaRelay(t){if(this.state!==Wi.RELAY_STATE_IDLE)throw new ue(z.INVALID_OPERATION);this.state=Wi.RELAY_STATE_CONNECTING,await this.connect(),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(t)}catch(n){throw n.data&&n.data.serverResponse&&n.data.serverResponse.command==="SetSourceChannel"?new ue(z.CROSS_CHANNEL_FAILED_JOIN_SRC):n.data&&n.data.serverResponse&&n.serverResponse.command==="SetDestChannelStatus"?new ue(z.CROSS_CHANNEL_FAILED_JOIN_DEST):n.data&&n.data.serverResponse&&n.serverResponse.command==="StartPacketTransfer"?new ue(z.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):n}this.prevChannelMediaConfig=t}async updateChannelMediaRelay(t){if(this.state!==Wi.RELAY_STATE_RUNNING)throw new ue(z.INVALID_OPERATION);await this.sendUpdateMessage(t),this.prevChannelMediaConfig=t}async setVideoProfile(t){if(this._resolution=t,this.state!==Wi.RELAY_STATE_RUNNING)throw new ue(z.INVALID_OPERATION);const n=this.genMessage(Ei.SetVideoProfile);await this.signal.request(n),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),L.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=Wi.RELAY_STATE_IDLE,this.dispose()}dispose(){L.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=ho.CancelToken.source(),this.state=Wi.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const t=await rte(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=t.workerToken,await this.signal.connect(t.addressList),this.emit("event",Ls.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(t){const n=this.genMessage(Ei.StopPacketTransfer);await this.signal.request(n),await this.signal.waitStatus("Normal Quit"),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const a=this.genMessage(Ei.SetSdkProfile,t);await this.signal.request(a),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const l=this.genMessage(Ei.SetSourceChannel,t);await this.signal.request(l),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",Ls.PACKET_JOINED_SRC_CHANNEL),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const u=this.genMessage(Ei.SetSourceUserId,t);await this.signal.request(u),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const h=this.genMessage(Ei.SetDestChannel,t);await this.signal.request(h),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",Ls.PACKET_JOINED_DEST_CHANNEL),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const p=this.genMessage(Ei.StartPacketTransfer,t);await this.signal.request(p),this.emit("event",Ls.PACKET_SENT_TO_DEST_CHANNEL),this.state=Wi.RELAY_STATE_RUNNING,L.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(t){const n=this.genMessage(Ei.UpdateDestChannel,t);await this.signal.request(n),this.emit("event",Ls.PACKET_UPDATE_DEST_CHANNEL),L.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const t=this.genMessage(Ei.StopPacketTransfer);await this.signal.request(t),L.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(t,n){const a=[],l=[],u=[];this.requestId+=1;const h={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:Ta,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};h.sdkVersion==="4.20.0"&&(h.sdkVersion="0.0.1");let p=null,v=null;switch(t){case Ei.SetSdkProfile:return h.clientRequest={command:"SetSdkProfile",type:"multi_channel"},h;case Ei.SetSourceChannel:if(v=n&&n.getSrcChannelMediaInfo(),!v)throw new ue(z.UNEXPECTED_ERROR,"can not find source config");return h.clientRequest={command:"SetSourceChannel",uid:"0",channelName:v.channelName,token:v.token||this.joinInfo.appId},h;case Ei.SetSourceUserId:if(v=n&&n.getSrcChannelMediaInfo(),!v)throw new ue(z.UNEXPECTED_ERROR,"can not find source config");return h.clientRequest={command:"SetSourceUserId",uid:v.uid+""},h;case Ei.SetDestChannel:if(p=n&&n.getDestChannelMediaInfo(),!p)throw new ue(z.UNEXPECTED_ERROR,"can not find dest config");return p.forEach(E=>{a.push(E.channelName),l.push(E.uid+""),u.push(E.token||this.joinInfo.appId)}),h.clientRequest={command:"SetDestChannel",channelName:a,uid:l,token:u},h;case Ei.StartPacketTransfer:return h.clientRequest={command:"StartPacketTransfer"},h;case Ei.Reconnect:return h.clientRequest={command:"Reconnect"},h;case Ei.StopPacketTransfer:return h.clientRequest={command:"StopPacketTransfer"},h;case Ei.UpdateDestChannel:if(p=n&&n.getDestChannelMediaInfo(),!p)throw new ue(z.UNEXPECTED_ERROR,"can not find dest config");return p.forEach(E=>{a.push(E.channelName),l.push(E.uid+""),u.push(E.token||this.joinInfo.appId)}),h.clientRequest={command:"UpdateDestChannel",channelName:a,uid:l,token:u},h;case Ei.SetVideoProfile:h.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return h}}function EE(i){var t={},n=!1;function a(l,u){return n=!0,{done:!1,value:new IR(u=new AR(function(h){h(i[l](u))}),1)}}return t[Rh!==void 0&&h2||"@@iterator"]=function(){return this},t.next=function(l){return n?(n=!1,l):a("next",l)},typeof i.throw=="function"&&(t.throw=function(l){if(n)throw n=!1,l;return a("throw",l)}),typeof i.return=="function"&&(t.return=function(l){return n?(n=!1,l):a("return",l)}),t}var GU=c(mU);function zU(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function KU(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zU(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):zU(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}function YU(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function qU(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?YU(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):YU(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}class Vr extends Mv{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map(t=>t.rtpMap&&t.rtpMap.encodingName.toLowerCase()||"").filter(t=>{var n;return Be(n=Object.keys(Yl)).call(n,t)}))]}constructor(t,n){super(t,n),w(this,"store",void 0),w(this,"peerConnection",void 0),w(this,"remoteSDP",void 0),w(this,"initialOffer",void 0),w(this,"statsFilter",void 0),w(this,"useRTX",!1),w(this,"localCapabilities",void 0),w(this,"localCandidateCount",0),w(this,"allCandidatesReceived",!1),w(this,"establishPromise",void 0),w(this,"mutex",new Ur("P2PConnection-mutex")),this.store=n,this.peerConnection=new RTCPeerConnection(Vr.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.statsFilter=pE(this.peerConnection,J("STATS_UPDATE_INTERVAL"),void 0,un()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const t=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!t.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const n=Fs(t.sdp),a=D0(t.sdp,{filterRTX:!this.useRTX,filterVideoFec:J("FILTER_VIDEO_FEC"),filterAudioFec:J("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=a,this.initialOffer=t,qU(qU({},n),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:a},offerSDP:t.sdp})}catch(t){throw new Te(z.GET_LOCAL_CONNECTION_PARAMS_FAILED,t.toString())}}async connect(t,n,a,l,u,h){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new class{constructor(v){w(this,"sessionDesc",void 0),w(this,"localCapabilities",void 0),w(this,"rtpCapabilities",void 0),w(this,"candidates",void 0),w(this,"iceParameters",void 0),w(this,"dtlsParameters",void 0),w(this,"setup",void 0),w(this,"currentMidIndex",void 0),w(this,"cname",void 0),v=fn(v);const{remoteIceParameters:E,remoteDtlsParameters:y,candidates:C,remoteRTPCapabilities:I,remoteSetup:k,localCapabilities:G,sdkCodec:B,cname:j}=v,q=In.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=I,this.candidates=C,this.iceParameters=E,this.dtlsParameters=y,this.setup=k,this.localCapabilities=G,this.cname=j;for(let Z=0;Z<q.mediaDescriptions.length;Z++){const re=q.mediaDescriptions[Z];if(re.attributes.iceUfrag=E.iceUfrag,re.attributes.icePwd=E.icePwd,re.attributes.fingerprints=y.fingerprints,re.attributes.candidates=C,re.attributes.setup=k,re.media.mediaType==="video"){re.media.fmts=I.videoCodecs.map(pe=>pe.payloadType.toString(10));let Ce=I.videoCodecs.filter(pe=>{var fe,ye;return(fe=pe.rtpMap)===null||fe===void 0?void 0:Be(ye=fe.encodingName.toLowerCase()).call(ye,B)});Ce.length===0&&(Ce=I.videoCodecs),re.attributes.payloads=Ce,re.attributes.extmaps=I.videoExtensions}re.media.mediaType==="audio"&&(re.media.fmts=I.audioCodecs.map(Ce=>Ce.payloadType.toString(10)),re.attributes.payloads=I.audioCodecs,re.attributes.extmaps=I.audioExtensions),q.mediaDescriptions[Z]=this.mungMediaDesc(re)}this.sessionDesc=q,this.currentMidIndex=q.mediaDescriptions.length-1}toString(){return In.print(this.sessionDesc)}send(v,E,y){const{ssrcs:C,ssrcGroups:I}=vo(E,this.cname),k=this.sessionDesc.mediaDescriptions.find(j=>v===je.VIDEO?j.media.mediaType==="video":j.media.mediaType==="audio"),G=C[0].attributes.label,B=C[0].attributes.mslabel;return k.attributes.ssrcs=k.attributes.ssrcs.concat(C),k.attributes.ssrcGroups=k.attributes.ssrcGroups.concat(I),{id:G,mslabel:B}}batchSend(v){return v.map(E=>{let{kind:y,ssrcMsg:C}=E;return this.send(y,C,void 0)})}stopSending(v){this.sessionDesc.mediaDescriptions.forEach(E=>{const y=[],C=[],I=[];E.attributes.ssrcs.forEach(k=>{Be(v).call(v,k.attributes.label||"")?I.push(k):y.push(k)}),E.attributes.ssrcGroups.forEach(k=>{var G;Be(G=I.map(B=>B.ssrcId)).call(G,k.ssrcIds[0])||C.push(k)}),E.attributes.ssrcs=y,E.attributes.ssrcGroups=C})}mute(v){const E=this.sessionDesc.mediaDescriptions.find(y=>y.attributes.mid===v);if(!E)throw new Error("mediaDescription not found with ".concat(v," in remote SDP when calling RemoteSDP.mute."));E.attributes.direction="inactive"}unmute(v){const E=this.sessionDesc.mediaDescriptions.find(y=>y.attributes.mid===v);if(!E)throw new Error("mediaDescription not found with ".concat(v," in remote SDP when calling RemoteSDP.unmute."));E.attributes.direction="sendonly"}receive(v,E,y){v.forEach((C,I)=>{const k=C._mediaStreamTrack,G=this.sessionDesc.mediaDescriptions.findIndex(j=>j.attributes.mid===k.kind),B=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[G],C);this.sessionDesc.mediaDescriptions[G]=B})}stopReceiving(v){}updateCandidates(v){v===si.TCP?this.candidates.forEach(E=>{this.candidates.findIndex(y=>y.transport==="tcp"&&y.connectionAddress===E.connectionAddress&&y.port===E.port)===-1&&this.candidates.push(KU(KU({},E),{},{foundation:"tcpcandidate",priority:Number(E.priority)-1+"",transport:"tcp",port:Number(E.port)+90+""}))}):this.candidates=this.candidates.filter(E=>E.transport!=="tcp");for(const E of this.sessionDesc.mediaDescriptions)E.attributes.candidates=this.candidates}restartICE(v){v=fn(v),this.iceParameters=v,this.sessionDesc.mediaDescriptions.forEach(E=>{E.attributes.iceUfrag=v.iceUfrag,E.attributes.icePwd=v.icePwd})}predictReceivingMids(v){const E=[];for(let y=0;y<v;y++)E.push((this.currentMidIndex+y+1).toString(10));return E}mungRecvMediaDsec(v,E){const y=fn(v);return uu(y,E),mE(y,E),y}updateRecvMedia(v,E){const y=this.sessionDesc.mediaDescriptions.findIndex(C=>C.attributes.mid===v);if(y!==-1){const C=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[y],E);this.sessionDesc.mediaDescriptions[y]=C}}bumpMid(v){this.currentMidIndex+=v}updateTrackLabel(v,E,y){const C=this.sessionDesc.mediaDescriptions.find(k=>v===je.VIDEO?k.attributes.mid==="video":k.attributes.mid==="audio");if(C){const k=C.attributes.ssrcs.find(G=>G.attributes.label===E);var I;k&&(k.attributes.label=y,(I=k.attributes.msid)===null||I===void 0||I.replace(E,y))}}mungMediaDesc(v){const E=fn(v);return fE(E),function(y){const C=y.attributes.extmaps.find(I=>I.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");C&&y.attributes.extmaps.splice(y.attributes.extmaps.indexOf(C),1),y.attributes.payloads.forEach(I=>{const k=I.rtcpFeedbacks.findIndex(G=>G.type==="transport-cc");k!==-1&&I.rtcpFeedbacks.splice(k,1)})}(E),E}getSSRC(v){for(const E of this.sessionDesc.mediaDescriptions)for(const y of E.attributes.ssrcs)if(y.attributes.label===v)return[y]}}({remoteIceParameters:t,remoteDtlsParameters:n,candidates:a,remoteRTPCapabilities:l.send,remoteSetup:u,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec,cname:h});const p=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:p})}catch(p){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(p.toString()))}}async updateRemoteRTPCapabilities(t,n){throw new Te(z.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}send(t,n){var a=this;return Do(function*(){const l=yield _t(a.mutex.lock());try{if(!a.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const u=t.map(I=>a.peerConnection.addTrack(I._mediaStreamTrack)),h=yield _t(a.peerConnection.createOffer()),p=In.parse(h.sdp),v=t.map(I=>{const k=I._mediaStreamTrack,G=p.mediaDescriptions.find(B=>B.attributes.mid===k.kind);if(!G)throw new Error("Cannot extract ssrc from mediaDescription.");return function(B,j,q){const Z=B.attributes.ssrcs.filter(Ce=>Ce.attributes.label===j),re=B.attributes.ssrcGroups;if(Z.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(re&&Z.length>1){const Ce=re.find(pe=>pe.ssrcIds.indexOf(Z[0].ssrcId)!==-1);return Ce?[{ssrcId:Ce.ssrcIds[0],rtx:q?Ce.ssrcIds[1]:void 0}]:[{ssrcId:Z[0].ssrcId}]}return[{ssrcId:Z[0].ssrcId}]}(G,k.id,a.useRTX)});let E;try{E=yield v}catch(I){throw u.forEach(k=>{Ni()&&k.replaceTrack(null),a.peerConnection.removeTrack(k)}),I}const y=a.mungSendOfferSDP(h.sdp,t);a.remoteSDP.receive(t,n,E);const C=a.remoteSDP.toString();return yield _t(a.peerConnection.setLocalDescription({type:"offer",sdp:y})),yield _t(a.applySendEncodings(u,t)),yield _t(a.peerConnection.setRemoteDescription({type:"answer",sdp:C})),t.map((I,k)=>{const G=I._mediaStreamTrack.id;return{localSSRC:v[k],id:G}})}catch(u){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(u.toString()))}finally{l()}})()}async stopSending(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const n=this.peerConnection.getSenders().filter(u=>{var h;return t.indexOf(((h=u.track)===null||h===void 0?void 0:h.id)||"")!==-1});if(n.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");n.map(u=>{Ni()&&u.replaceTrack(null),this.peerConnection.removeTrack(u)});const a=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(a),this.remoteSDP.stopReceiving(t);const l=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(n){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(n.toString()))}}async receive(t,n,a,l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{id:u,mslabel:h}=this.remoteSDP.send(t,n,l),p=new _e((y,C)=>{const I=setTimeout(()=>{C(new Error("Cannot receive track, id: ".concat(u)))},1e4),k=G=>{const B=Wt();if((B.name==="Safari"&&Number(B.version)===11||Pi())&&G.track.id!==u&&G.streams[0].id===h){var j;const q=G.streams[0].getTracks()[0];return(j=this.remoteSDP)===null||j===void 0||j.updateTrackLabel(t,u,G.track.id),this.peerConnection.removeEventListener("track",k),clearTimeout(I),void y(q)}if(G.track.id===u)return this.peerConnection.removeEventListener("track",k),clearTimeout(I),void y(G.track)};this.peerConnection.addEventListener("track",k)}),v=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:v});const E=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(E),{track:await p,id:u}}catch(u){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async stopReceiving(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(t);const n=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const a=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(a)}catch(n){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(n.toString()))}}async muteRemote(t){}async unmuteRemote(t){}async muteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const n=this.peerConnection.getSenders().filter(a=>{var l;return t.indexOf(((l=a.track)===null||l===void 0?void 0:l.id)||"")!==-1});if(n.length!==t.length)throw new Error("sender' length doesn't match mids' length.");n.map(a=>{if(Ni()&&a.track)a.track.enabled=!1;else{const l=a.getParameters();l.encodings.forEach(u=>u.active=!1),a.setParameters(l)}})}catch(n){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(n.toString()))}}async unmuteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const n=this.peerConnection.getSenders().filter(u=>{var h;return t.indexOf(((h=u.track)===null||h===void 0?void 0:h.id)||"")!==-1});if(n.length!==t.length)throw new Error("Senders' length doesn't match mids' length.");n.map(async u=>{if(Ni()&&u.track)u.track.enabled=!0;else{const h=u.getParameters();h.encodings.forEach(p=>p.active=!0),await u.setParameters(h)}});const a=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(a);const l=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(n){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(n.toString()))}}restartICE(t){var n=this;return Do(function*(){const a=yield _t(n.mutex.lock("From P2PConnection.restartICE"));try{if(!n.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(cn().supportPCSetConfiguration){const v=n.peerConnection.getConfiguration(),E=t===si.RELAY?"relay":"all";v.iceTransportPolicy!==E&&(L.debug("[".concat(n.store.clientId,"] restartICE change iceTransportPolicy from [").concat(v.iceTransportPolicy,"] to [").concat(E,"]")),v.iceTransportPolicy=E,n.peerConnection.setConfiguration(v))}else if(t===si.RELAY)return;t!==si.RELAY&&n.remoteSDP.updateCandidates(t);const l=yield _t(n.peerConnection.createOffer({iceRestart:!0}));if(!l.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const u=Fs(l.sdp),{remoteIceParameters:h}=yield u.iceParameters;n.remoteSDP.restartICE(h);const p=n.remoteSDP.toString();yield _t(n.peerConnection.setLocalDescription(l)),yield _t(n.peerConnection.setRemoteDescription({type:"answer",sdp:p}))}catch(l){L.warning("[".concat(n.store.clientId,"] restart ICE failed, abort operation"),l)}finally{a()}})()}close(){var t;this.peerConnection.close(),(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}async updateEncoderConfig(t,n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const a=await this.peerConnection.createOffer(),l=this.mungSendOfferSDP(a.sdp,[n]);this.remoteSDP.updateRecvMedia(n._mediaStreamTrack.kind,n);const u=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:l}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(a){throw new Te(z.EXCHANGE_SDP_FAILED,a.toString())}}async updateSendParameters(t,n){const a=this.peerConnection.getSenders().filter(l=>{var u;return((u=l.track)===null||u===void 0?void 0:u.id)===t});a.length===1&&await this.applySendEncodings(a,[n])}setStatsRemoteVideoIsReady(t,n){this.statsFilter.setVideoIsReady2(t,n)}async replaceTrack(t,n){const a=this.peerConnection.getSenders().find(l=>{var u;return((u=l.track)===null||u===void 0?void 0:u.id)===n});a&&await a.replaceTrack(t._mediaStreamTrack)}createDataChannels(t,n){throw new Te(z.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(t){throw new Te(z.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t;(t=this.onICEConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=t=>{t.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,L.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,L.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},J("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const n={iceServers:[],sdpSemantics:"plan-b"};return t.iceServers?n.iceServers=t.iceServers:t.turnServer&&t.turnServer.mode!=="off"&&(kh(t.turnServer.servers)?n.iceServers=t.turnServer.servers:(n.iceServers&&n.iceServers.push(...Vr.turnServerConfigToIceServers(t.turnServer.servers)),J("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&t.turnServer.serversFromGateway&&n.iceServers.push(...Vr.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(a=>{a.forceturn&&(n.iceTransportPolicy="relay")}))),n}static turnServerConfigToIceServers(t){const n=[];return t.forEach(a=>{a.security?a.tcpport&&n.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}):(a.udpport&&n.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.udpport,"?transport=udp")}),a.tcpport&&n.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}))}),n}async updateRtpSenderEncodings(t,n){var a;if(n||(n=this.peerConnection.getSenders().find(E=>{var y;return((y=E.track)===null||y===void 0?void 0:y.id)===t._mediaStreamTrack.id})),!n)return L.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(!cn().supportSetRtpSenderParameters)return L.warn("Browser not support set rtp-sender parameters");const l={},u={};if(t instanceof Rt)switch(t._optimizationMode){case"motion":l.degradationPreference="maintain-framerate";break;case"detail":l.degradationPreference="maintain-resolution";break;default:l.degradationPreference="balanced"}if(J("DSCP_TYPE")&&Wl()){var h;const E=J("DSCP_TYPE");Be(h=["very-low","low","medium","high"]).call(h,E)&&(u.networkPriority=E)}const p=n.getParameters(),v=(a=p.encodings)===null||a===void 0?void 0:a[0];v&&Object.assign(v,u),Object.assign(p,l),L.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(p.encodings))),await n.setParameters(p)}async applySendEncodings(t,n){try{if(!cn().supportSetRtpSenderParameters||t.length!==n.length)return;for(let a=0;a<t.length;a++){const l=t[a],u=n[a];l&&u&&await this.updateRtpSenderEncodings(u,l)}}catch{L.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(t,n){const a=In.parse(t);return n.forEach((l,u)=>{const h=l._mediaStreamTrack,p=a.mediaDescriptions.find(v=>v.attributes.mid===h.kind);p&&uu(p,l)}),In.print(a)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var n;(n=this.onFirstAudioReceived)===null||n===void 0||n.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var n;(n=this.onFirstVideoReceived)===null||n===void 0||n.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var n;(n=this.onFirstAudioDecoded)===null||n===void 0||n.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,n,a)=>{var l;(l=this.onFirstVideoDecoded)===null||l===void 0||l.call(this,t,n,a)},this.statsFilter.onSelectedLocalCandidateChanged=(t,n)=>{var a;(a=this.onSelectedLocalCandidateChanged)===null||a===void 0||a.call(this,t,n)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,n)=>{var a;(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0||a.call(this,t,n)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const n=this.remoteSDP.batchSend(t).map((u,h)=>{let{id:p,mslabel:v}=u;const{kind:E}=t[h];return new _e((y,C)=>{const I=setTimeout(()=>{C(new Error("Cannot receive track, id: ".concat(p)))},1e4),k=G=>{const B=Wt();if(B.name==="Safari"&&Number(B.version)===11&&G.track.id!==p&&G.streams[0].id===v){var j;const q=G.streams[0].getTracks()[0];return(j=this.remoteSDP)===null||j===void 0||j.updateTrackLabel(E,p,G.track.id),this.peerConnection.removeEventListener("track",k),clearTimeout(I),void y({track:q,id:p})}if(G.track.id===p)return this.peerConnection.removeEventListener("track",k),clearTimeout(I),void y({track:G.track,id:p})};this.peerConnection.addEventListener("track",k)})}),a=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:a});const l=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(l),await _e.all(n)}catch(n){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(n.toString()))}}async getRemoteSSRC(t){if(!this.remoteSDP)return;const n=this.remoteSDP.getSSRC(t);return n==null?void 0:n[0].ssrcId}setConfiguration(t){if(cn().supportPCSetConfiguration){const n=Vr.resolvePCConfiguration(t);this.peerConnection.setConfiguration(n)}}}function Pa(i,t,n){const a=i[t];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return n.value=async function(){const l=this.mutex,u=await l.lock("Locking from P2PConnection.".concat(t));try{for(var h=arguments.length,p=new Array(h),v=0;v<h;v++)p[v]=arguments[v];return await a.apply(this,p)}finally{u()}},n}function XU(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function pu(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?XU(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):XU(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}Re([Pa,H("design:type",Function),H("design:paramtypes",[Object,Object,Array,Object,String,String]),H("design:returntype",_e)],Vr.prototype,"connect",null),Re([Pa,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],Vr.prototype,"stopSending",null),Re([Pa,H("design:type",Function),H("design:paramtypes",[String,Array,String,Object]),H("design:returntype",_e)],Vr.prototype,"receive",null),Re([Pa,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],Vr.prototype,"stopReceiving",null),Re([Pa,H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],Vr.prototype,"muteRemote",null),Re([Pa,H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],Vr.prototype,"unmuteRemote",null),Re([Pa,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],Vr.prototype,"muteLocal",null),Re([Pa,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],Vr.prototype,"unmuteLocal",null),Re([Pa,H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],Vr.prototype,"close",null),Re([Pa,H("design:type",Function),H("design:paramtypes",[String,ci]),H("design:returntype",_e)],Vr.prototype,"updateEncoderConfig",null),Re([Pa,H("design:type",Function),H("design:paramtypes",[String,ci]),H("design:returntype",_e)],Vr.prototype,"updateSendParameters",null),Re([Pa,H("design:type",Function),H("design:paramtypes",[ci,String]),H("design:returntype",_e)],Vr.prototype,"replaceTrack",null),Re([Pa,H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],Vr.prototype,"getRemoteSSRC",null);const U0="9",JU=4e4;function QU(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function sp(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?QU(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):QU(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}class $n extends Mv{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var t,n;return(t=(n=this.peerConnection.getReceivers()[0])===null||n===void 0||(n=n.transport)===null||n===void 0?void 0:n.state)!==null&&t!==void 0?t:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(t=>t.rtpMap&&t.rtpMap.encodingName.toLowerCase()||"").filter(t=>{var n;return Be(n=Object.keys(Yl)).call(n,t)}))]}constructor(t,n){super(t,n),w(this,"store",void 0),w(this,"peerConnection",void 0),w(this,"remoteSDP",void 0),w(this,"initialOffer",void 0),w(this,"transportEventReceiver",void 0),w(this,"statsFilter",void 0),w(this,"useXR",J("USE_XR")),w(this,"localCapabilities",void 0),w(this,"remoteCodecs",void 0),w(this,"localCandidateCount",0),w(this,"allCandidatesReceived",!1),w(this,"dataStreamChannelMap",new Map),w(this,"establishPromise",void 0),w(this,"mutex",new Ur("P2PConnection-mutex")),this.store=n,this.peerConnection=new RTCPeerConnection($n.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.statsFilter=pE(this.peerConnection,J("STATS_UPDATE_INTERVAL"),void 0,un()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async updateRemoteRTPCapabilities(t,n){if(this.remoteCodecs=n,!this.remoteSDP)return void L.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(n));if(this.remoteSDP.updateRemoteCodec(t,n,this.store.codec)){const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(a);const u=this.remoteSDP.toString();l==null||l(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}else L.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const t=await this.peerConnection.createOffer();if(!t.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const n=Fs(t.sdp),a=await MR({filterRTX:!J("USE_PUB_RTX")&&!J("USE_SUB_RTX"),filterVideoFec:J("FILTER_VIDEO_FEC"),filterAudioFec:J("FILTER_AUDIO_FEC"),filterVideoCodec:J("FILTER_VIDEO_CODEC")},{useXR:this.useXR});return this.localCapabilities=op(a),this.initialOffer=t,sp(sp({},n),{},{rtpCapabilities:a,offerSDP:t.sdp})}catch(t){throw new Te(z.GET_LOCAL_CONNECTION_PARAMS_FAILED,t.toString())}}async connect(t,n,a,l,u,h){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new class{get localCapabilities(){return fn(this._localCapabilities)}get rtpCapabilities(){return fn(this._rtpCapabilities)}get candidates(){return fn(this._candidates)}get iceParameters(){return fn(this._iceParameters)}get dtlsParameters(){return fn(this._dtlsParameters)}constructor(k){w(this,"sessionDesc",void 0),w(this,"_localCapabilities",void 0),w(this,"_rtpCapabilities",void 0),w(this,"_candidates",void 0),w(this,"_iceParameters",void 0),w(this,"_dtlsParameters",void 0),w(this,"setup",void 0),w(this,"currentMidIndex",void 0),w(this,"cname",void 0),w(this,"firefoxSsrcMidMap",new Map),k=fn(k);const{remoteIceParameters:G,remoteDtlsParameters:B,candidates:j,remoteRTPCapabilities:q,remoteSetup:Z,localCapabilities:re,cname:Ce}=k,pe=In.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`);this._rtpCapabilities=q,this._candidates=j,this._iceParameters=G,this._dtlsParameters=B,this._localCapabilities=re,this.setup=Z,this.cname=Ce;const fe=this.rtpCapabilities.send;for(const ye of pe.mediaDescriptions){if(ye.attributes.iceUfrag=G.iceUfrag,ye.attributes.icePwd=G.icePwd,ye.attributes.fingerprints=B.fingerprints,ye.attributes.candidates=j,ye.attributes.setup=Z,ye.media.mediaType==="video"&&(ye.media.fmts=fe.videoCodecs.map(Ee=>Ee.payloadType.toString(10)),ye.attributes.payloads=fe.videoCodecs,ye.attributes.extmaps=fe.videoExtensions,J("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:Ee,ssrcGroups:Ae}=vo([{ssrcId:JU,rtx:J("USE_SUB_RTX")?40001:void 0}],this.cname);ye.attributes.ssrcs=Ee,ye.attributes.ssrcGroups=Ae}if(ye.media.mediaType==="audio"&&(ye.media.fmts=fe.audioCodecs.map(Ee=>Ee.payloadType.toString(10)),ye.attributes.payloads=fe.audioCodecs,ye.attributes.extmaps=fe.audioExtensions,Us(ye),J("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:Ee,ssrcGroups:Ae}=vo([{ssrcId:2e4}],this.cname);ye.attributes.ssrcs=Ee,ye.attributes.ssrcGroups=Ae}}this.sessionDesc=pe,this.currentMidIndex=pe.mediaDescriptions.length-1}preloadRemoteMedia(){const k=J("PRELOAD_MEDIA_COUNT");this.rtpCapabilities;const G=this.candidates,B=this.dtlsParameters,j=this.iceParameters,q=this.rtpCapabilities.send;for(let Z=1;Z<k;Z++){const re=2*Z+2e4,Ce=2*Z+JU,{ssrcs:pe,ssrcGroups:fe}=vo([{ssrcId:re}],this.cname),{ssrcs:ye,ssrcGroups:Ee}=vo([{ssrcId:Ce,rtx:J("USE_SUB_RTX")?Ce+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:U0,protos:["UDP","TLS","RTP","SAVPF"],fmts:q.videoCodecs.map(Ae=>Ae.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:j.iceUfrag,icePwd:j.icePwd,unrecognized:[],candidates:G,extmaps:q.videoExtensions,fingerprints:B.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:ye,ssrcGroups:Ee,rtcpFeedbackWildcards:[],payloads:q.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*Z)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:U0,protos:["UDP","TLS","RTP","SAVPF"],fmts:q.audioCodecs.map(Ae=>Ae.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:j.iceUfrag,icePwd:j.icePwd,unrecognized:[],candidates:G,extmaps:q.audioExtensions,fingerprints:B.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:pe,ssrcGroups:fe,rtcpFeedbackWildcards:[],payloads:q.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*Z+1)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return In.print(this.sessionDesc)}send(k,G,B,j){const{ssrcs:q,ssrcGroups:Z}=vo(G,this.cname,J("SYNC_GROUP")?B:void 0),re=this.findPreloadMediaDesc(q);if(re){if(un()&&this.firefoxSsrcMidMap.set(q[0].ssrcId,re.attributes.mid),j&&(j.twcc||j.remb)){const Ce=this.sessionDesc.mediaDescriptions.indexOf(re);return this.sessionDesc.mediaDescriptions[Ce]=this.mungSendMediaDesc(re,j),{mid:re.attributes.mid,needExchangeSDP:!0}}return{mid:re.attributes.mid,needExchangeSDP:!1}}{const Ce=this.findAvailableMediaIndex(k,q);let pe;return Ce===-1||Ce===1&&(Ni()||Pk())||Ce===0&&J("USE_SUB_RTX")||Dk()?(pe=this.createOrRecycleSendMedia(k,q,Z,"sendonly",j),this.updateBundleMids()):(pe=fn(this.sessionDesc.mediaDescriptions[Ce]),pe.attributes.direction="sendonly",pe.attributes.ssrcs=q,pe.attributes.ssrcGroups=Z,this.sessionDesc.mediaDescriptions[Ce]=this.mungSendMediaDesc(pe,j)),un()&&this.firefoxSsrcMidMap.set(q[0].ssrcId,pe.attributes.mid),{mid:pe.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:k,needExchangeSDP:G}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:k.attributes.mid,needExchangeSDP:G}}batchSend(k){const G=k.map(q=>{let{kind:Z,ssrcMsg:re,mslabel:Ce}=q;return this.send(Z,re,Ce)}),B=[];let j=!1;return G.forEach(q=>{let{mid:Z,needExchangeSDP:re}=q;re&&(j=!0),B.push(Z)}),{mids:B,needExchangeSDP:j}}stopSending(k){const G=this.sessionDesc.mediaDescriptions.filter(B=>B.attributes.mid&&k.indexOf(B.attributes.mid)!==-1);if(G.length!==k.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");G.forEach(B=>{B.attributes.mid==="0"||un()||Dk()?B.attributes.ssrcs=[]:(B.attributes.ssrcs=[],B.attributes.direction="inactive",B.media.port="0")}),this.updateBundleMids()}mute(k){const G=this.sessionDesc.mediaDescriptions.find(B=>B.attributes.mid===k);if(!G)throw new Error("mediaDescription not found with ".concat(k," in remote SDP when calling RemoteSDP.mute."));G.attributes.direction="inactive"}unmute(k){const G=this.sessionDesc.mediaDescriptions.find(B=>B.attributes.mid===k);if(!G)throw new Error("mediaDescription not found with ".concat(k," in remote SDP when calling RemoteSDP.unmute."));G.attributes.direction="sendonly"}muteRemote(k){const G=this.sessionDesc.mediaDescriptions.filter(B=>Be(k).call(k,B.attributes.mid||""));if(G.length!==k.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");G.forEach(B=>{B.attributes.direction="inactive"})}unmuteRemote(k){const G=this.sessionDesc.mediaDescriptions.filter(B=>Be(k).call(k,B.attributes.mid||""));if(G.length!==k.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");G.forEach(B=>{B.attributes.direction="recvonly"})}receive(k,G,B,j){k.forEach((q,Z)=>{this.createOrRecycleRecvMedia(q,[],"recvonly",G,B,j[Z])}),this.updateBundleMids()}stopReceiving(k){const G=this.sessionDesc.mediaDescriptions.filter(B=>k.indexOf(B.attributes.mid)!==-1);if(G.length!==k.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");G.forEach(B=>{B.media.port="0",B.attributes.direction="inactive"}),this.updateBundleMids()}updateCandidates(k){const G=this._candidates.filter(B=>B.transport==="udp");if(k===si.TCP){if(G.length===0)return;if(J("TCP_CANDIDATE_ONLY")){const B=this._candidates.filter(j=>j.transport==="tcp");G.forEach(j=>{B.findIndex(q=>q.connectionAddress===j.connectionAddress)===-1&&B.push(pu(pu({},j),{},{foundation:"tcpcandidate",priority:Number(j.priority)-1+"",transport:"tcp",port:Number(j.port)+90+""}))}),this._candidates=B}else{const B=[];G.forEach(j=>{B.push(pu(pu({},j),{},{foundation:"tcpcandidate",priority:Number(j.priority)-1+"",transport:"tcp",port:Number(j.port)+90+""}))}),this._candidates=[...G,...B]}}else if(k===si.RELAY){if(G.length!==0)return;{const B=this._candidates.filter(j=>j.transport==="tcp");B.forEach(j=>{G.push(pu(pu({},j),{},{foundation:"udpcandidate",priority:Number(j.priority)+1+"",transport:"udp",port:Number(j.port)-90+""}))}),this._candidates=[...G,...B]}}else G.length===0?(this._candidates.filter(B=>B.transport==="tcp").forEach(B=>{G.push(pu(pu({},B),{},{foundation:"udpcandidate",priority:Number(B.priority)+1+"",transport:"udp",port:Number(B.port)-90+""}))}),this._candidates=G):this._candidates=this._candidates.filter(B=>B.transport!=="tcp");for(const B of this.sessionDesc.mediaDescriptions)B.attributes.candidates=this.candidates}restartICE(k){k=fn(k),this._iceParameters=k,this.sessionDesc.mediaDescriptions.forEach(G=>{G.attributes.iceUfrag=k.iceUfrag,G.attributes.icePwd=k.icePwd})}predictReceivingMids(k){const G=[];for(let B=0;B<k;B++)G.push((this.currentMidIndex+B+1).toString(10));return G}findAvailableMediaIndex(k,G){return this.sessionDesc.mediaDescriptions.findIndex(B=>{const j=B.media.mediaType===k&&B.media.port!=="0"&&(B.attributes.direction==="sendonly"||B.attributes.direction==="sendrecv")&&B.attributes.ssrcs.length===0;if(un()){if(j){const q=this.firefoxSsrcMidMap.get(G[0].ssrcId);return!(q||B.attributes.mid!=="0"&&B.attributes.mid!=="1")||!(!q||q!==B.attributes.mid)}return!1}return j})}createOrRecycleDataChannel(){for(const B of this.sessionDesc.mediaDescriptions)if(B.media.mediaType==="application")return{mediaDesc:B,needExchangeSDP:!1};this.currentMidIndex+=1;const k="".concat(this.currentMidIndex),G={media:{mediaType:"application",port:U0,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(k),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(G),{mediaDesc:G,needExchangeSDP:!0}}createOrRecycleRecvMedia(k,G,B,j,q,Z){const re=k._mediaStreamTrack.kind,Ce=this.rtpCapabilities.recv,pe=Id(re,Ce,this.localCapabilities.send,re===je.VIDEO?j:q),fe=re===je.VIDEO?Ce.videoExtensions:Ce.audioExtensions;this.currentMidIndex+=1;const ye="".concat(this.currentMidIndex);let Ee={media:{mediaType:re,port:U0,protos:["UDP","TLS","RTP","SAVPF"],fmts:pe.map(Ne=>Ne.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:fe,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:G,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:pe,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:B,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(ye)}};Ee=this.mungRecvMediaDsec(Ee,k,Z);const Ae=this.findFirstClosedMedia(re);if(Ae){const Ne=this.sessionDesc.mediaDescriptions.indexOf(Ae);this.sessionDesc.mediaDescriptions[Ne]=Ee}else this.sessionDesc.mediaDescriptions.push(Ee);return Ee}updateRemoteCodec(k,G,B){const j=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(Ee=>Ee.rtpMap&&Ee.rtpMap.encodingName.toLowerCase()||"").filter(Ee=>{var Ae;return Be(Ae=Object.keys(Yl)).call(Ae,Ee)}))],q=new Set(G);if(j.every(Ee=>q.has(Ee)))return L.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(G)),!1;const Z=this._rtpCapabilities.recv.videoCodecs.filter(Ee=>G.some(Ae=>{var Ne;return Be(Ne=Ee.rtpMap&&Ee.rtpMap.encodingName.toLowerCase()||"").call(Ne,Ae)}));if(Z.length===0)return L.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(j," codecs: ").concat(G)),!1;const re=[...new Set(Z.map(Ee=>Ee.rtpMap&&Ee.rtpMap.encodingName.toLowerCase()||""))];let Ce;if(L.debug("updateRemoteCodec, from ".concat(j," to ").concat(re)),k.length===0)Ce=this.sessionDesc.mediaDescriptions.filter(Ee=>Ee.media.mediaType==="video"&&Ee.attributes.direction==="recvonly");else if(Ce=this.sessionDesc.mediaDescriptions.filter(Ee=>Ee.attributes.mid&&Be(k).call(k,Ee.attributes.mid)&&Ee.attributes.direction==="recvonly"),Ce.length!==k.length)return L.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(k,", codecs: ").concat(G)),!1;this._rtpCapabilities.recv.videoCodecs=Z;const pe=this.localCapabilities.send,fe=this.rtpCapabilities.recv,ye=Id(je.VIDEO,fe,pe,B);return Ce.forEach(Ee=>{const Ae=ye.map(Ne=>Ne.payloadType.toString(10));L.debug("updateRemoteCodec mid: ".concat(Ee.attributes.mid,", from ").concat(Ee.attributes.payloads," to ").concat(ye)),Ee.attributes.payloads=ye,Ee.media.fmts=Ae}),!0}createOrRecycleSendMedia(k,G,B,j,q){const Z=this.rtpCapabilities.send,re=k===je.VIDEO?Z.videoCodecs:Z.audioCodecs,Ce=k===je.VIDEO?Z.videoExtensions:Z.audioExtensions;this.currentMidIndex+=1;const pe="".concat(this.currentMidIndex);let fe={media:{mediaType:k,port:U0,protos:["UDP","TLS","RTP","SAVPF"],fmts:re.map(Ee=>Ee.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:Ce,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:G,ssrcGroups:B,rtcpFeedbackWildcards:[],payloads:re,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:j,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(pe)}};fe=this.mungSendMediaDesc(fe,q);const ye=this.findFirstClosedMedia(k);if(ye){const Ee=this.sessionDesc.mediaDescriptions.indexOf(ye);this.sessionDesc.mediaDescriptions[Ee]=fe}else this.sessionDesc.mediaDescriptions.push(fe);return fe}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(k=>k.media.port!=="0").map(k=>k.attributes.mid)}mungRecvMediaDsec(k,G,B){const j=fn(k);return fE(j),uu(j,G),mE(j,G),kR(j),ip(j,B,this.localCapabilities.send),j}mungSendMediaDesc(k,G){const B=fn(k);return ip(B,G,this.localCapabilities.recv),Us(B),B}updateRecvMedia(k,G){const B=this.sessionDesc.mediaDescriptions.findIndex(j=>j.attributes.mid===k);if(B!==-1){const j=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[B],G);this.sessionDesc.mediaDescriptions[B]=j}}bumpMid(k){this.currentMidIndex+=k}findFirstClosedMedia(k){return this.sessionDesc.mediaDescriptions.find(G=>un()?G.media.port==="0"&&G.media.mediaType===k:G.media.port==="0")}findPreloadMediaDesc(k){return this.sessionDesc.mediaDescriptions.find(G=>{var B;return((B=G.attributes)===null||B===void 0||(B=B.ssrcs[0])===null||B===void 0?void 0:B.ssrcId)===k[0].ssrcId})}getSSRC(k){var G;return(G=this.sessionDesc.mediaDescriptions.find(B=>B.attributes.mid===k))===null||G===void 0?void 0:G.attributes.ssrcs}}({remoteIceParameters:t,remoteDtlsParameters:n,candidates:a,remoteRTPCapabilities:l,remoteSetup:u,localCapabilities:this.localCapabilities,cname:h}),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const p=this.remoteSDP.toString(),v=In.parse(this.initialOffer.sdp),E=v.mediaDescriptions.find(k=>k.media.mediaType==="audio");E&&Us(E),this.useXR&&k0(v);const y=In.print(v),C=this.logSDPExchange(y||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:y}),C==null||C(p),await this.peerConnection.setRemoteDescription({type:"answer",sdp:p});const I=this.peerConnection.getTransceivers()[0];if(I!=null&&I.receiver&&this.tryBindTransportEvents(I.receiver),J("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia();const k=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:k});const G=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(G)}}catch(p){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(p.toString()))}}send(t,n,a){var l=this;return Do(function*(){const u=yield _t(l.mutex.lock("From P2PConnection.send"));try{if(!l.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const h=[];t.forEach(B=>{const j=l.peerConnection.addTransceiver(B._mediaStreamTrack,{direction:"sendonly"});h.push(j),B._updateRtpTransceiver(j)}),un()&&J("SIMULCAST")===!0&&(yield _t(l.applySimulcastForFirefox(h,t)));const p=yield _t(l.peerConnection.createOffer()),v=l.remoteSDP.predictReceivingMids(t.length),E=l.mungSendOfferSDP(p.sdp,t,v),y=In.parse(E),C=v.map(B=>{const j=y.mediaDescriptions.find(q=>q.attributes.mid===B);if(!j)throw new Error("Cannot extract ssrc from mediaDescription.");return DR(j,J("USE_PUB_RTX"))});let I;try{I=yield C}catch(B){I=[],l.remoteSDP.receive(t,n,a,I);const j=l.remoteSDP.toString();throw yield _t(l.peerConnection.setLocalDescription({type:"offer",sdp:E})),yield _t(l.peerConnection.setRemoteDescription({type:"answer",sdp:j})),yield _t(l.stopSending(v,!0)),B}l.remoteSDP.receive(t,n,a,I);const k=l.remoteSDP.toString(),G=l.logSDPExchange(E,"offer","local","send");return yield _t(l.peerConnection.setLocalDescription({type:"offer",sdp:E})),yield _t(l.applySimulcastEncodings(h,t)),yield _t(l.applySendEncodings(h,t)),G==null||G(k),yield _t(l.peerConnection.setRemoteDescription({type:"answer",sdp:k})),h.map((B,j)=>{const q=v[j];return{localSSRC:C[j],id:q,transceiver:B}})}catch(h){throw h instanceof Te?h:new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(h.toString()))}finally{u()}})()}async createDataChannels(t,n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let a=this.dataStreamChannelMap.get(t);a&&a.readyState==="open"?L.debug("[P2PConnection] Channels are already available and can be reused directly."):(a=this.peerConnection.createDataChannel("datastream-channel",{ordered:!1,maxRetransmits:J("DATASTREAM_MAX_RETRANSMITS")}),a.binaryType="arraybuffer",this.dataStreamChannelMap.set(t,a)),n.forEach(u=>{u._updateOriginDataChannel(a)});const{needExchangeSDP:l}=this.remoteSDP.sendDataChannel();if(l){const u=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:u});const h=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(h),L.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else L.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(a){throw a instanceof Te?a:new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(a.toString()))}}async stopDataChannels(t){try{const n=this.dataStreamChannelMap.get(t);return n==null||n.close(),void this.dataStreamChannelMap.delete(t)}catch(n){throw n instanceof Te?n:new Te(z.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(n.toString()))}}async stopSending(t,n){const a=n?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const l=this.peerConnection.getTransceivers().filter(v=>t.indexOf(v.mid)!==-1);if(l.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");l.map(v=>{var E;v.direction="inactive",(E=v.stop)===null||E===void 0||E.call(v)});const u=await this.peerConnection.createOffer(),h=this.logSDPExchange(u.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(u),this.remoteSDP.stopReceiving(t);const p=this.remoteSDP.toString();h==null||h(p),await this.peerConnection.setRemoteDescription({type:"answer",sdp:p})}catch(l){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(l.toString()))}finally{a&&a()}}async receive(t,n,a,l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{mid:u,needExchangeSDP:h}=this.remoteSDP.send(t,n,a,l);if(h){const v=this.remoteSDP.toString(),E=this.logSDPExchange(v,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:v});const y=await this.peerConnection.createAnswer(),C=this.mungReceiveAnswerSDP(y.sdp,u,t);E==null||E(C||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:C}),L.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," by exchanging SDP."))}else L.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," no need to exchange SDP."));const p=this.peerConnection.getTransceivers().find(v=>v.mid===u);if(!p)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:p.receiver.track,id:u,transceiver:p}}catch(u){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async batchReceive(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:n,needExchangeSDP:a}=this.remoteSDP.batchSend(t);if(a){const l=this.remoteSDP.toString(),u=this.logSDPExchange(l,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:l});const h=await this.peerConnection.createAnswer();u==null||u(h.sdp||""),await this.peerConnection.setLocalDescription(h),L.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))}else L.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive no need to exchange SDP."));return n.map(l=>{const u=this.peerConnection.getTransceivers().find(h=>h.mid===l);if(!u)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:u.receiver.track,id:l,transceiver:u}})}catch(n){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(n.toString()))}}async stopReceiving(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(t);const n=this.remoteSDP.toString(),a=this.logSDPExchange(n,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(n){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(n.toString()))}}async muteRemote(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(t," before remote SDP created."));this.remoteSDP.mute(t);const n=this.remoteSDP.toString(),a=this.logSDPExchange(n,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(n){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(n.toString()))}}async unmuteRemote(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(t," before remote SDP created."));this.remoteSDP.unmute(t);const n=this.remoteSDP.toString(),a=this.logSDPExchange(n,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(n){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(n.toString()))}}async muteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const n=this.peerConnection.getTransceivers().filter(h=>h.mid&&t.indexOf(h.mid)!==-1);if(n.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");n.map(h=>{h.direction="inactive"});const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.muteRemote(t);const u=this.remoteSDP.toString();l==null||l(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(n){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(n.toString()))}}async unmuteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const n=this.peerConnection.getTransceivers().filter(h=>h.mid&&t.indexOf(h.mid)!==-1);if(n.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");n.map(async(h,p)=>{h.direction="sendonly"});const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.unmuteRemote(t);const u=this.remoteSDP.toString();l==null||l(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(n){throw new Te(z.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(n.toString()))}}restartICE(t){var n=this;return Do(function*(){const a=yield _t(n.mutex.lock("From P2PConnection.restartICE"));try{if(!n.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(cn().supportPCSetConfiguration){const E=n.peerConnection.getConfiguration(),y=t===si.RELAY?"relay":"all";E.iceTransportPolicy!==y&&(L.debug("[".concat(n.store.clientId,"] restartICE change iceTransportPolicy from [").concat(E.iceTransportPolicy,"] to [").concat(y,"]")),E.iceTransportPolicy=y,n.peerConnection.setConfiguration(E))}else if(t===si.RELAY)return;n.remoteSDP.updateCandidates(t);const l=yield _t(n.peerConnection.createOffer({iceRestart:!0}));if(!l.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const u=Fs(l.sdp),{remoteIceParameters:h}=yield u.iceParameters;n.remoteSDP.restartICE(h);const p=n.remoteSDP.toString(),v=n.logSDPExchange(l.sdp||"","offer","local","restartICE");n.store.descriptionStart(),yield _t(n.peerConnection.setLocalDescription(l)),v==null||v(p),yield _t(n.peerConnection.setRemoteDescription({type:"answer",sdp:p}))}catch(l){L.warning("[".concat(n.store.clientId,"] restart ICE failed, abort operation"),l)}finally{a()}})()}close(){var t;this.peerConnection.close(),(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}async updateEncoderConfig(t,n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const a=await this.peerConnection.createOffer(),l=this.mungSendOfferSDP(a.sdp,[n],[t]);this.remoteSDP.updateRecvMedia(t,n);const u=this.remoteSDP.toString(),h=this.logSDPExchange(l,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:l}),h==null||h(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(a){throw new Te(z.EXCHANGE_SDP_FAILED,a.toString())}}async updateSendParameters(t,n){const a=this.peerConnection.getTransceivers().filter(l=>l.mid===t);a.length===1&&(this.isVP8Simulcast(n)?un()||await this.applySimulcastEncodings(a,[n]):await this.applySendEncodings(a,[n]))}setStatsRemoteVideoIsReady(t,n){this.statsFilter.setVideoIsReady2(t,n)}async replaceTrack(t,n){const a=this.peerConnection.getTransceivers().find(l=>l.mid===n);a&&await a.sender.replaceTrack(t._mediaStreamTrack)}async getSelectedCandidatePair(){const t=this.peerConnection.getReceivers();if(t.length>0&&t[0].transport&&t[0].transport.iceTransport&&t[0].transport.iceTransport.getSelectedCandidatePair&&t[0].transport.iceTransport.getSelectedCandidatePair()){const n=t[0].transport.iceTransport,{local:a,remote:l}=n.getSelectedCandidatePair();return{local:sp(sp({},Ic),{},{candidateType:a.type,protocol:a.protocol,address:a.address,port:a.port}),remote:sp(sp({},Ic),{},{candidateType:l.type,protocol:l.protocol,address:l.address,port:l.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t;(t=this.onICEConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=t=>{t.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,L.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,L.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},J("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const n={iceServers:[]};return t.iceServers?n.iceServers=t.iceServers:t.turnServer&&t.turnServer.mode!=="off"&&(kh(t.turnServer.servers)?n.iceServers=t.turnServer.servers:(n.iceServers&&n.iceServers.push(...$n.turnServerConfigToIceServers(t.turnServer.servers)),J("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&t.turnServer.serversFromGateway&&n.iceServers.push(...$n.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),J("FORCE_TURN_TCP")?n.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(a=>{a.forceturn&&(n.iceTransportPolicy="relay")}))),J("ENABLE_ENCODED_TRANSFORM")&&cn().supportWebRTCEncodedTransform&&(n.encodedInsertableStreams=!0),n}static turnServerConfigToIceServers(t){const n=[];return t.forEach(a=>{a.security?a.tcpport&&n.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(eu(a.turnServerURL),":").concat(a.tcpport,"?transport=tcp")}):(a.udpport&&!J("FORCE_TURN_TCP")&&n.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.udpport,"?transport=udp")}),a.tcpport&&n.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}))}),n}tryBindTransportEvents(t){const n=t.transport;if(n){this.transportEventReceiver=t,n.onstatechange=()=>{var l;n!=null&&n.state&&((l=this.onDTLSTransportStateChange)===null||l===void 0||l.call(this,n.state))},n.onerror=l=>{var u;(u=this.onDTLSTransportError)===null||u===void 0||u.call(this,"error"in l?l.error:l)};const a=n.iceTransport;a&&(a.onstatechange=()=>{const l=n==null?void 0:n.iceTransport.state;var u;l&&((u=this.onICETransportStateChange)===null||u===void 0||u.call(this,l))},a.getSelectedCandidatePair&&(a.onselectedcandidatepairchange=()=>{if(a.getSelectedCandidatePair()){const{local:l,remote:u}=a.getSelectedCandidatePair();L.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:l.type,protocol:l.protocol}),", remote ").concat(JSON.stringify({candidateType:u.type,protocol:u.protocol,address:u.address,port:u.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(t,n){var a;if(n||(n=this.peerConnection.getSenders().find(y=>y.track===t._mediaStreamTrack)),!n)return L.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(t))return L.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!cn().supportSetRtpSenderParameters)return L.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const l={},u={};switch(t._optimizationMode){case"motion":l.degradationPreference="maintain-framerate";break;case"detail":l.degradationPreference="maintain-resolution";break;default:l.degradationPreference="balanced"}if(t._encoderConfig){var h;const{bitrateMax:y,frameRate:C,scaleResolutionDownBy:I}=t._encoderConfig;y&&(u.maxBitrate=1e3*y),(Be(h=t._hints).call(h,mn.LOW_STREAM)||t.isUseScaleResolutionDownBy)&&(C&&(u.maxFramerate=Jo(C)),I&&I>=1&&(u.scaleResolutionDownBy=I))}if(J("DSCP_TYPE")&&Wl()){var p;const y=J("DSCP_TYPE");Be(p=["very-low","low","medium","high"]).call(p,y)&&(u.networkPriority=y)}const v=n.getParameters(),E=(a=v.encodings)===null||a===void 0?void 0:a[0];un()&&!E&&(l.encodings=[u]),E&&Object.assign(E,u),Object.assign(v,l),L.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(v.encodings))),await n.setParameters(v)}async applySendEncodings(t,n){try{if(!cn().supportSetRtpSenderParameters||t.length!==n.length)return;for(let a=0;a<t.length;a++){const l=t[a],u=n[a];u instanceof Rt&&!this.isVP8Simulcast(u)&&await this.updateRtpSenderEncodings(u,l.sender)}}catch{L.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(t,n,a){const l=In.parse(t);return n.forEach((u,h)=>{const p=a[h],v=l.mediaDescriptions.find(E=>E.attributes.mid===p);v&&(uu(v,u),LR(v,u,this.store.codec))}),In.print(l)}mungReceiveAnswerSDP(t,n,a){const l=In.parse(t),u=l.mediaDescriptions.find(h=>h.attributes.mid===n);return u&&(a===je.AUDIO&&u.media.mediaType==="audio"&&Us(u),this.useXR&&k0(l)),In.print(l)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var n;(n=this.onFirstAudioReceived)===null||n===void 0||n.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var n;(n=this.onFirstVideoReceived)===null||n===void 0||n.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var n;(n=this.onFirstAudioDecoded)===null||n===void 0||n.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,n,a)=>{var l;(l=this.onFirstVideoDecoded)===null||l===void 0||l.call(this,t,n,a)},this.statsFilter.onSelectedLocalCandidateChanged=(t,n)=>{var a;(a=this.onSelectedLocalCandidateChanged)===null||a===void 0||a.call(this,t,n)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,n)=>{var a;(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0||a.call(this,t,n)},this.statsFilter.onFirstVideoDecodedTimeout=t=>{var n;(n=this.onFirstVideoDecodedTimeout)===null||n===void 0||n.call(this,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(t,n){if(t.length===n.length)for(let v=0;v<t.length;v++){var a,l,u,h,p;const E=t[v],y=n[v];if(y instanceof Rt&&!Be(a=y._hints).call(a,mn.LOW_STREAM)&&(l=y._encoderConfig)!==null&&l!==void 0&&l.bitrateMax&&((u=y._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(h=y._scalabilityMode)!==null&&h!==void 0&&h.numSpatialLayers&&((p=y._scalabilityMode)===null||p===void 0?void 0:p.numSpatialLayers)>1&&this.store.codec==="vp8"){const C={},I={high:1e3*(y._encoderConfig.bitrateMax-50),medium:5e4};C.encodings=[{rid:"m",active:!0,maxBitrate:I.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:I.high}];const k=E.sender.getParameters();await E.sender.setParameters(Object.assign(k,C))}}}async applySimulcastEncodings(t,n){if(!un()&&t.length===n.length)for(let a=0;a<t.length;a++){const l=n[a];if(l instanceof Rt&&this.isVP8Simulcast(l)){const u=t[a],h={},p={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};h.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:p.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:p.medium,scaleResolutionDownBy:4}];const v=u.sender.getParameters();await u.sender.setParameters(Object.assign(v,h))}}}isVP8Simulcast(t){var n,a,l,u,h;return!!(t instanceof Rt&&J("SIMULCAST")&&this.store.codec==="vp8"&&!Be(n=t._hints).call(n,mn.LOW_STREAM)&&(a=t._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&((l=t._encoderConfig)===null||l===void 0?void 0:l.bitrateMax)>200&&(u=t._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((h=t._scalabilityMode)===null||h===void 0?void 0:h.numSpatialLayers)>1)}logSDPExchange(t,n,a,l){if(J("SDP_LOGGING"))return L.upload("[".concat(this.store.clientId,"] exchanging ").concat(a," ").concat(n," SDP during P2PConnection.").concat(l,`
`),t),n==="offer"?u=>{this.logSDPExchange(u,"answer",a==="local"?"remote":"local",l)}:void 0}async getRemoteSSRC(t){if(!this.remoteSDP)return;const n=this.remoteSDP.getSSRC(t);return n==null?void 0:n[0].ssrcId}setConfiguration(t){if(cn().supportPCSetConfiguration){const n=$n.resolvePCConfiguration(t);this.peerConnection.setConfiguration(n)}}}function ko(i,t,n){const a=i[t];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return n.value=async function(){const l=this.mutex,u=await l.lock("From P2PConnection.".concat(t));try{for(var h=arguments.length,p=new Array(h),v=0;v<h;v++)p[v]=arguments[v];return await a.apply(this,p)}finally{u()}},n}function ZU(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function e4(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ZU(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):ZU(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}Re([ko,H("design:type",Function),H("design:paramtypes",[Array,Array]),H("design:returntype",_e)],$n.prototype,"updateRemoteRTPCapabilities",null),Re([ko,H("design:type",Function),H("design:paramtypes",[Object,Object,Array,Object,String,String]),H("design:returntype",_e)],$n.prototype,"connect",null),Re([ko,H("design:type",Function),H("design:paramtypes",[Object,Array]),H("design:returntype",_e)],$n.prototype,"createDataChannels",null),Re([ko,H("design:type",Function),H("design:paramtypes",[String,Array,String,Object]),H("design:returntype",_e)],$n.prototype,"receive",null),Re([ko,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],$n.prototype,"batchReceive",null),Re([ko,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],$n.prototype,"stopReceiving",null),Re([ko,H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],$n.prototype,"muteRemote",null),Re([ko,H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],$n.prototype,"unmuteRemote",null),Re([ko,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],$n.prototype,"muteLocal",null),Re([ko,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],$n.prototype,"unmuteLocal",null),Re([ko,H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],$n.prototype,"close",null),Re([ko,H("design:type",Function),H("design:paramtypes",[String,ci]),H("design:returntype",_e)],$n.prototype,"updateEncoderConfig",null),Re([ko,H("design:type",Function),H("design:paramtypes",[String,ci]),H("design:returntype",_e)],$n.prototype,"updateSendParameters",null),Re([ko,H("design:type",Function),H("design:paramtypes",[ci,String]),H("design:returntype",_e)],$n.prototype,"replaceTrack",null),Re([ko,H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],$n.prototype,"getRemoteSSRC",null);const t4=`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0
a=msid-semantic: WMS
a=ice-lite
m=application 9 UDP/DTLS/SCTP webrtc-datachannel
c=IN IP4 127.0.0.1
a=mid:0
`,_E="9",jR=2e4,VR=4e4;class Xne{get localCapabilities(){return fn(this._localCapabilities)}get rtpCapabilities(){return fn(this._rtpCapabilities)}get candidates(){return fn(this._candidates)}get iceParameters(){return fn(this._iceParameters)}get dtlsParameters(){return fn(this._dtlsParameters)}constructor(t){w(this,"sessionDesc",void 0),w(this,"_localCapabilities",void 0),w(this,"_rtpCapabilities",void 0),w(this,"_candidates",void 0),w(this,"_iceParameters",void 0),w(this,"_dtlsParameters",void 0),w(this,"setup",void 0),w(this,"currentMidIndex",void 0),w(this,"cname",void 0),w(this,"firefoxSsrcMidMap",new Map),t=fn(t);const{remoteIceParameters:n,remoteDtlsParameters:a,candidates:l,remoteRTPCapabilities:u,remoteSetup:h,localCapabilities:p,cname:v}=t,E=In.parse(t4);this._rtpCapabilities=u,this._candidates=l,this._iceParameters=n,this._dtlsParameters=a,this._localCapabilities=p,this.setup=h,this.cname=v;const y=this.rtpCapabilities.send;for(const C of E.mediaDescriptions){if(C.attributes.iceUfrag=n.iceUfrag,C.attributes.icePwd=n.icePwd,C.attributes.fingerprints=a.fingerprints,C.attributes.candidates=l,C.attributes.setup=h,C.media.mediaType==="application"&&(C.attributes.sctpPort="5000"),C.media.mediaType==="video"&&(C.media.fmts=y.videoCodecs.map(I=>I.payloadType.toString(10)),C.attributes.payloads=y.videoCodecs,C.attributes.extmaps=y.videoExtensions,J("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:I,ssrcGroups:k}=vo([{ssrcId:VR,rtx:J("USE_SUB_RTX")?40001:void 0}],this.cname);C.attributes.ssrcs=I,C.attributes.ssrcGroups=k}if(C.media.mediaType==="audio"&&(C.media.fmts=y.audioCodecs.map(I=>I.payloadType.toString(10)),C.attributes.payloads=y.audioCodecs,C.attributes.extmaps=y.audioExtensions,Us(C),J("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:I,ssrcGroups:k}=vo([{ssrcId:jR}],this.cname);C.attributes.ssrcs=I,C.attributes.ssrcGroups=k}}this.sessionDesc=E,this.currentMidIndex=E.mediaDescriptions.length-1}updateRemoteRTPCapabilities(t){const n=In.parse(t4);this._rtpCapabilities=t;const a=this.rtpCapabilities.send;for(const l of n.mediaDescriptions){if(l.attributes.iceUfrag=this._iceParameters.iceUfrag,l.attributes.icePwd=this._iceParameters.icePwd,l.attributes.fingerprints=this._dtlsParameters.fingerprints,l.attributes.candidates=this._candidates,l.attributes.setup=this.setup,l.media.mediaType==="application"&&(l.attributes.sctpPort="5000"),l.media.mediaType==="video"&&(l.media.fmts=a.videoCodecs.map(u=>u.payloadType.toString(10)),l.attributes.payloads=a.videoCodecs,l.attributes.extmaps=a.videoExtensions,J("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:u,ssrcGroups:h}=vo([{ssrcId:VR,rtx:J("USE_SUB_RTX")?40001:void 0}],this.cname);l.attributes.ssrcs=u,l.attributes.ssrcGroups=h}if(l.media.mediaType==="audio"&&(l.media.fmts=a.audioCodecs.map(u=>u.payloadType.toString(10)),l.attributes.payloads=a.audioCodecs,l.attributes.extmaps=a.audioExtensions,J("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:u,ssrcGroups:h}=vo([{ssrcId:jR}],this.cname);l.attributes.ssrcs=u,l.attributes.ssrcGroups=h}}this.sessionDesc=n,this.currentMidIndex=n.mediaDescriptions.length-1}preloadRemoteMedia(t){this.rtpCapabilities;const n=this.candidates,a=this.dtlsParameters,l=this.iceParameters,u=this.rtpCapabilities.send;for(let h=1;h<t;h++){const p=2*h+jR,v=2*h+VR,{ssrcs:E,ssrcGroups:y}=vo([{ssrcId:p}],this.cname),{ssrcs:C,ssrcGroups:I}=vo([{ssrcId:v,rtx:J("USE_SUB_RTX")?v+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:_E,protos:["UDP","TLS","RTP","SAVPF"],fmts:u.videoCodecs.map(k=>k.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:l.iceUfrag,icePwd:l.icePwd,unrecognized:[],candidates:n,extmaps:u.videoExtensions,fingerprints:a.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:C,ssrcGroups:I,rtcpFeedbackWildcards:[],payloads:u.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*h-1)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:_E,protos:["UDP","TLS","RTP","SAVPF"],fmts:u.audioCodecs.map(k=>k.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:l.iceUfrag,icePwd:l.icePwd,unrecognized:[],candidates:n,extmaps:u.audioExtensions,fingerprints:a.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:E,ssrcGroups:y,rtcpFeedbackWildcards:[],payloads:u.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*h)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return In.print(this.sessionDesc)}send(t,n,a,l){const{ssrcs:u,ssrcGroups:h}=vo(n,this.cname,J("SYNC_GROUP")?a:void 0),p=this.findPreloadMediaDesc(u);if(p){if(un()&&this.firefoxSsrcMidMap.set(u[0].ssrcId,p.attributes.mid),l&&(l.twcc||l.remb)){const v=this.sessionDesc.mediaDescriptions.indexOf(p);return this.sessionDesc.mediaDescriptions[v]=this.mungSendMediaDesc(p,l),{mid:p.attributes.mid,needExchangeSDP:!0}}return{mid:p.attributes.mid,needExchangeSDP:!1}}{const v=this.findAvailableMediaIndex(t,u);let E;return v===-1||Ni()||Pi()||Pk()||v===0&&J("USE_SUB_RTX")?(E=this.createOrRecycleSendMedia(t,u,h,"sendonly",l),this.updateBundleMids()):(E=fn(this.sessionDesc.mediaDescriptions[v]),E.attributes.direction="sendonly",E.attributes.ssrcs=u,E.attributes.ssrcGroups=h,this.sessionDesc.mediaDescriptions[v]=this.mungSendMediaDesc(E,l)),un()&&this.firefoxSsrcMidMap.set(u[0].ssrcId,E.attributes.mid),{mid:E.attributes.mid,needExchangeSDP:!0}}}batchSend(t){const n=t.map(u=>{let{kind:h,ssrcMsg:p,mslabel:v}=u;return this.send(h,p,v)}),a=[];let l=!1;return n.forEach(u=>{let{mid:h,needExchangeSDP:p}=u;p&&(l=!0),a.push(h)}),{mids:a,needExchangeSDP:l}}stopSending(t){const n=this.sessionDesc.mediaDescriptions.filter(a=>a.attributes.mid&&t.indexOf(a.attributes.mid)!==-1);if(n.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");n.forEach(a=>{a.attributes.mid==="0"||un()||Ni()||Pi()?a.attributes.ssrcs=[]:(a.attributes.ssrcs=[],a.attributes.direction="inactive",a.media.port="0")}),this.updateBundleMids()}mute(t){const n=this.sessionDesc.mediaDescriptions.find(a=>a.attributes.mid===t);if(!n)throw new Error("mediaDescription not found with ".concat(t," in remote SDP when calling RemoteSDP.mute."));n.attributes.direction="inactive"}unmute(t){const n=this.sessionDesc.mediaDescriptions.find(a=>a.attributes.mid===t);if(!n)throw new Error("mediaDescription not found with ".concat(t," in remote SDP when calling RemoteSDP.unmute."));n.attributes.direction="sendonly"}muteRemote(t){const n=this.sessionDesc.mediaDescriptions.filter(a=>Be(t).call(t,a.attributes.mid||""));if(n.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");n.forEach(a=>{a.attributes.direction="inactive"})}unmuteRemote(t){const n=this.sessionDesc.mediaDescriptions.filter(a=>Be(t).call(t,a.attributes.mid||""));if(n.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");n.forEach(a=>{a.attributes.direction="recvonly"})}receive(t,n,a,l){t.forEach((u,h)=>{this.createOrRecycleRecvMedia(u,[],"recvonly",n,a,l[h])}),this.updateBundleMids()}stopReceiving(t){const n=this.sessionDesc.mediaDescriptions.filter(a=>t.indexOf(a.attributes.mid)!==-1);if(n.length!==t.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");n.forEach(a=>{a.media.port="0",a.attributes.direction="inactive"}),this.updateBundleMids()}updateCandidates(t){t===si.TCP?this._candidates.forEach(n=>{this._candidates.findIndex(a=>a.transport==="tcp"&&a.connectionAddress===n.connectionAddress&&a.port===n.port)===-1&&this._candidates.push(e4(e4({},n),{},{foundation:"tcpcandidate",priority:Number(n.priority)-1+"",transport:"tcp",port:Number(n.port)+90+""}))}):this._candidates=this._candidates.filter(n=>n.transport!=="tcp");for(const n of this.sessionDesc.mediaDescriptions)n.attributes.candidates=this.candidates}restartICE(t){t=fn(t),this._iceParameters=t,this.sessionDesc.mediaDescriptions.forEach(n=>{n.attributes.iceUfrag=t.iceUfrag,n.attributes.icePwd=t.icePwd})}predictReceivingMids(t){const n=[];for(let a=0;a<t;a++)n.push((this.currentMidIndex+a+1).toString(10));return n}findAvailableMediaIndex(t,n){return this.sessionDesc.mediaDescriptions.findIndex(a=>{const l=a.media.mediaType===t&&a.media.port!=="0"&&(a.attributes.direction==="sendonly"||a.attributes.direction==="sendrecv")&&a.attributes.ssrcs.length===0;if(un()){if(l){const u=this.firefoxSsrcMidMap.get(n[0].ssrcId);return!(u||a.attributes.mid!=="0"&&a.attributes.mid!=="1")||!(!u||u!==a.attributes.mid)}return!1}return l})}createOrRecycleRecvMedia(t,n,a,l,u,h){const p=t._mediaStreamTrack.kind,v=this.rtpCapabilities.recv,E=Id(p,v,this.localCapabilities.send,p===je.VIDEO?l:u),y=p===je.VIDEO?v.videoExtensions:v.audioExtensions;this.currentMidIndex+=1;const C="".concat(this.currentMidIndex);let I={media:{mediaType:p,port:_E,protos:["UDP","TLS","RTP","SAVPF"],fmts:E.map(G=>G.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:y,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:n,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:E,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:a,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(C)}};I=this.mungRecvMediaDsec(I,t,h);const k=this.findFirstClosedMedia(p);if(k){const G=this.sessionDesc.mediaDescriptions.indexOf(k);this.sessionDesc.mediaDescriptions[G]=I}else this.sessionDesc.mediaDescriptions.push(I);return I}updateRemoteCodec(t,n,a){const l=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(I=>I.rtpMap&&I.rtpMap.encodingName.toLowerCase()||"").filter(I=>{var k;return Be(k=Object.keys(Yl)).call(k,I)}))],u=new Set(n);if(l.every(I=>u.has(I)))return L.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(n)),!1;const h=this._rtpCapabilities.recv.videoCodecs.filter(I=>n.some(k=>{var G;return Be(G=I.rtpMap&&I.rtpMap.encodingName.toLowerCase()||"").call(G,k)}));if(h.length===0)return L.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(l," codecs: ").concat(n)),!1;const p=[...new Set(h.map(I=>I.rtpMap&&I.rtpMap.encodingName.toLowerCase()||""))];let v;if(L.debug("updateRemoteCodec, from ".concat(l," to ").concat(p)),t.length===0)v=this.sessionDesc.mediaDescriptions.filter(I=>I.media.mediaType==="video"&&I.attributes.direction==="recvonly");else if(v=this.sessionDesc.mediaDescriptions.filter(I=>I.attributes.mid&&Be(t).call(t,I.attributes.mid)&&I.attributes.direction==="recvonly"),v.length!==t.length)return L.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(t,", codecs: ").concat(n)),!1;this._rtpCapabilities.recv.videoCodecs=h;const E=this.localCapabilities.send,y=this.rtpCapabilities.recv,C=Id(je.VIDEO,y,E,a);return v.forEach(I=>{const k=C.map(G=>G.payloadType.toString(10));L.debug("updateRemoteCodec mid: ".concat(I.attributes.mid,", from ").concat(I.attributes.payloads," to ").concat(C)),I.attributes.payloads=C,I.media.fmts=k}),!0}createOrRecycleSendMedia(t,n,a,l,u){const h=this.rtpCapabilities.send,p=t===je.VIDEO?h.videoCodecs:h.audioCodecs,v=t===je.VIDEO?h.videoExtensions:h.audioExtensions;this.currentMidIndex+=1;const E="".concat(this.currentMidIndex);let y={media:{mediaType:t,port:_E,protos:["UDP","TLS","RTP","SAVPF"],fmts:p.map(I=>I.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:v,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:n,ssrcGroups:a,rtcpFeedbackWildcards:[],payloads:p,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:l,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(E)}};y=this.mungSendMediaDesc(y,u);const C=this.findFirstClosedMedia(t);if(C){const I=this.sessionDesc.mediaDescriptions.indexOf(C);this.sessionDesc.mediaDescriptions[I]=y}else this.sessionDesc.mediaDescriptions.push(y);return y}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(t=>t.media.port!=="0").map(t=>t.attributes.mid)}mungRecvMediaDsec(t,n,a){const l=fn(t);return fE(l),uu(l,n),mE(l,n),kR(l),ip(l,a,this.localCapabilities.send),l}mungSendMediaDesc(t,n){const a=fn(t);return ip(a,n,this.localCapabilities.recv),Us(a),a}updateRecvMedia(t,n){const a=this.sessionDesc.mediaDescriptions.findIndex(l=>l.attributes.mid===t);if(a!==-1){const l=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[a],n);this.sessionDesc.mediaDescriptions[a]=l}}bumpMid(t){this.currentMidIndex+=t}findFirstClosedMedia(t){return this.sessionDesc.mediaDescriptions.find(n=>un()?n.media.port==="0"&&n.media.mediaType===t:n.media.port==="0")}findPreloadMediaDesc(t){return this.sessionDesc.mediaDescriptions.find(n=>{var a;return((a=n.attributes)===null||a===void 0||(a=a.ssrcs[0])===null||a===void 0?void 0:a.ssrcId)===t[0].ssrcId})}getSSRC(t){var n;return(n=this.sessionDesc.mediaDescriptions.find(a=>a.attributes.mid===t))===null||n===void 0?void 0:n.attributes.ssrcs}}function n4(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function yE(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?n4(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):n4(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}class di extends Mv{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get localCodecs(){let t;return this.localCapabilities&&(t=op(this.localCapabilities)),[...new Set(t&&t.send.videoCodecs.map(n=>n.rtpMap&&n.rtpMap.encodingName.toLowerCase()||"").filter(n=>{var a;return Be(a=Object.keys(Yl)).call(a,n)}))]}constructor(t,n,a){super(t,n),w(this,"store",void 0),w(this,"peerConnection",void 0),w(this,"remoteSDP",void 0),w(this,"initialOffer",void 0),w(this,"transportEventReceiver",void 0),w(this,"statsFilter",void 0),w(this,"useXR",J("USE_XR")),w(this,"localCapabilities",void 0),w(this,"localCandidateCount",0),w(this,"allCandidatesReceived",!1),w(this,"remoteCodecs",void 0),w(this,"dataStreamChannelMap",new Map),w(this,"establishPromise",void 0),w(this,"mutex",new Ur("NVExtentionsConnection-mutex")),w(this,"rtcMedia",void 0),this.store=n,this.peerConnection=a,this.statsFilter=pE(this.peerConnection,J("STATS_UPDATE_INTERVAL"),void 0,un()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(t){try{const n=await this.peerConnection.createOffer();if(!n.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const a=Fs(n.sdp),l=await MR({filterRTX:!J("USE_PUB_RTX")&&!J("USE_SUB_RTX"),filterVideoFec:J("FILTER_VIDEO_FEC"),filterAudioFec:J("FILTER_AUDIO_FEC"),filterVideoCodec:J("FILTER_VIDEO_CODEC")},{useXR:this.useXR});return this.localCapabilities=l,this.initialOffer=n,yE(yE({},a),{},{rtpCapabilities:l,offerSDP:n.sdp})}catch(n){throw new ue(z.GET_LOCAL_CONNECTION_PARAMS_FAILED,n.toString())}}async connect(t,n,a,l,u,h){try{if(!this.initialOffer)throw new Error("Cannot establish NVConnection without initial offer.");this.remoteSDP=new Xne({remoteIceParameters:t,remoteDtlsParameters:n,candidates:a,remoteRTPCapabilities:l,remoteSetup:u,localCapabilities:op(this.localCapabilities),cname:h});const p=this.remoteSDP.toString(),v=In.parse(this.initialOffer.sdp),E=v.mediaDescriptions.find(I=>I.media.mediaType==="audio");E&&Us(E),this.useXR&&k0(v);const y=In.print(v),C=this.logSDPExchange(y||"","offer","local","connect");await this.peerConnection.setLocalDescription({type:"offer",sdp:y}),C==null||C(p),await this.peerConnection.setRemoteDescription({type:"answer",sdp:p})}catch(p){throw new ue(z.EXCHANGE_SDP_FAILED,"NV.connect failed; ".concat(p.toString()))}}async updateRemoteRTPCapabilities(t,n){if(this.remoteCodecs=n,!this.remoteSDP)return void L.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(n));if(this.remoteSDP.updateRemoteCodec(t,n,this.store.codec)){const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(a);const u=this.remoteSDP.toString();l==null||l(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}else L.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async updateRemoteConnect(t){var n,a,l,u;(n=this.remoteSDP)===null||n===void 0||n.updateRemoteRTPCapabilities(t),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&((u=this.remoteSDP)===null||u===void 0||u.updateRemoteCodec([],this.remoteCodecs,this.store.codec)),(a=this.remoteSDP)===null||a===void 0||a.preloadRemoteMedia(2);const h=(l=this.remoteSDP)===null||l===void 0?void 0:l.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:h});const p=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(p),L.debug("[NVExtentionsConnection] updateRemoteRTPCapabilities by exchanging SDP.")}send(t,n,a){var l=this;return Do(function*(){const u=yield _t(l.mutex.lock("From NVExtentionsConnection.send"));try{if(!l.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.send before remote SDP created");const h=[];t.forEach(B=>{const j=l.peerConnection.addTransceiver(B._mediaStreamTrack,{direction:"sendonly"});h.push(j)}),un()&&J("SIMULCAST")===!0&&(yield _t(l.applySimulcastForFirefox(h,t)));const p=yield _t(l.peerConnection.createOffer()),v=l.remoteSDP.predictReceivingMids(t.length),E=l.mungSendOfferSDP(p.sdp,t,v),y=In.parse(E),C=v.map(B=>{const j=y.mediaDescriptions.find(q=>q.attributes.mid===B);if(!j)throw new Error("Cannot extract ssrc from mediaDescription.");return DR(j,J("USE_PUB_RTX"))});let I;try{I=yield C}catch(B){I=[],l.remoteSDP.receive(t,n,a,I);const j=l.remoteSDP.toString();throw yield _t(l.peerConnection.setLocalDescription({type:"offer",sdp:E})),yield _t(l.peerConnection.setRemoteDescription({type:"answer",sdp:j})),yield _t(l.stopSending(v,!0)),B}l.remoteSDP.receive(t,n,a,I);const k=l.remoteSDP.toString(),G=l.logSDPExchange(E,"offer","local","send");return yield _t(l.peerConnection.setLocalDescription({type:"offer",sdp:E})),yield _t(l.applySimulcastEncodings(h,t)),yield _t(l.applySendEncodings(h,t)),G==null||G(k),yield _t(l.peerConnection.setRemoteDescription({type:"answer",sdp:k})),h.map((B,j)=>{const q=v[j];return{localSSRC:C[j],id:q,transceiver:B}})}catch(h){throw h instanceof ue?h:new ue(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.send failed; ".concat(h.toString()))}finally{u()}})()}async stopSending(t,n){const a=n?void 0:await this.mutex.lock("From NVExtentionsConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopSending before remote SDP created");const l=this.peerConnection.getTransceivers().filter(v=>t.indexOf(v.mid)!==-1);if(l.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call NVExtentionsConnection.stopSending.");l.map(v=>{var E;v.direction="inactive",(E=v.stop)===null||E===void 0||E.call(v)});const u=await this.peerConnection.createOffer(),h=this.logSDPExchange(u.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(u),this.remoteSDP.stopReceiving(t);const p=this.remoteSDP.toString();h==null||h(p),await this.peerConnection.setRemoteDescription({type:"answer",sdp:p})}catch(l){throw new ue(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.stopSending failed; ".concat(l.toString()))}finally{a&&a()}}async createDataChannels(t,n){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.createDataChannels before remote SDP created");let a=this.dataStreamChannelMap.get(t);return a&&a.readyState==="open"?L.debug("[P2PConnection] Channels are already available and can be reused directly."):(a=this.peerConnection.createDataChannel("datastream-channel",{ordered:!1,maxRetransmits:J("DATASTREAM_MAX_RETRANSMITS")}),a.binaryType="arraybuffer",this.dataStreamChannelMap.set(t,a)),void n.forEach(l=>{l._updateOriginDataChannel(a)})}catch(a){throw a instanceof ue?a:new ue(z.DATACHANNEL_FAILED,"NVExtentionsConnection.createDataChannels failed; ".concat(a.toString()))}}async stopDataChannels(t){try{const n=this.dataStreamChannelMap.get(t);return n==null||n.close(),void this.dataStreamChannelMap.delete(t)}catch(n){throw n instanceof ue?n:new ue(z.DATACHANNEL_FAILED,"NVExtentionsConnection.stopDataChannels failed; ".concat(n.toString()))}}async receive(t,n,a,l){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.receive ".concat(t," before remoteSDP created."));const{mid:u,needExchangeSDP:h}=this.remoteSDP.send(t,n,a,l);if(h){const v=this.remoteSDP.toString(),E=this.logSDPExchange(v,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:v});const y=await this.peerConnection.createAnswer(),C=this.mungReceiveAnswerSDP(y.sdp,u,t);E==null||E(C||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:C}),L.debug("[NVExtentionsConnection] receive ".concat(t," by exchanging SDP."))}else L.debug("[NVExtentionsConnection] receive ".concat(t," no need to exchange SDP."));const p=this.peerConnection.getTransceivers().find(v=>v.mid===u);if(!p)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:p.receiver.track,id:u}}catch(u){throw new ue(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(u.toString()))}}async batchReceive(t){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.batchReceive before remoteSDP created.");const{mids:n,needExchangeSDP:a}=this.remoteSDP.batchSend(t);if(a){const l=this.remoteSDP.toString(),u=this.logSDPExchange(l,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:l});const h=await this.peerConnection.createAnswer();u==null||u(h.sdp||""),await this.peerConnection.setLocalDescription(h),L.debug("[NVExtentionsConnection] batchReceive by exchanging SDP.")}else L.debug("[NVExtentionsConnection] batchReceive no need to exchange SDP.");return n.map(l=>{const u=this.peerConnection.getTransceivers().find(h=>h.mid===l);if(!u)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:u.receiver.track,id:l}})}catch(n){throw new ue(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(n.toString()))}}async stopReceiving(t){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(t);const n=this.remoteSDP.toString(),a=this.logSDPExchange(n,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(n){throw new ue(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection stopReceiving failed; ".concat(n.toString()))}}async muteRemote(t){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteRemote mid=".concat(t," before remote SDP created."));this.remoteSDP.mute(t);const n=this.remoteSDP.toString(),a=this.logSDPExchange(n,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(n){throw new ue(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteRemote failed; ".concat(n.toString()))}}async unmuteRemote(t){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteRemote mid=".concat(t," before remote SDP created."));this.remoteSDP.unmute(t);const n=this.remoteSDP.toString(),a=this.logSDPExchange(n,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(n){throw new ue(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteRemote failed; ".concat(n.toString()))}}async muteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteLocal before remote SDP created.");const n=this.peerConnection.getTransceivers().filter(h=>h.mid&&t.indexOf(h.mid)!==-1);if(n.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");n.map(h=>{h.direction="inactive"});const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.muteRemote(t);const u=this.remoteSDP.toString();l==null||l(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(n){throw new ue(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteLocal failed; ".concat(n.toString()))}}async unmuteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteLocal before remote SDP created.");const n=this.peerConnection.getTransceivers().filter(h=>h.mid&&t.indexOf(h.mid)!==-1);if(n.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");n.map(async(h,p)=>{h.direction="sendonly"});const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.unmuteRemote(t);const u=this.remoteSDP.toString();l==null||l(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(n){throw new ue(z.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteLocal failed; ".concat(n.toString()))}}restartICE(t){var n=this;return Do(function*(){const a=yield _t(n.mutex.lock("From NVExtentionsConnection.restartICE"));try{if(!n.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(cn().supportPCSetConfiguration){const E=n.peerConnection.getConfiguration(),y=t===si.RELAY?"relay":"all";E.iceTransportPolicy!==y&&(L.debug("restartICE change iceTransportPolicy from [".concat(E.iceTransportPolicy,"] to [").concat(y,"]")),E.iceTransportPolicy=y,n.peerConnection.setConfiguration(E))}else if(t===si.RELAY)return;t!==si.RELAY&&n.remoteSDP.updateCandidates(t);const l=yield _t(n.peerConnection.createOffer({iceRestart:!0}));if(!l.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const u=Fs(l.sdp),{remoteIceParameters:h}=yield u.iceParameters;n.remoteSDP.restartICE(h);const p=n.remoteSDP.toString(),v=n.logSDPExchange(l.sdp||"","offer","local","restartICE");yield _t(n.peerConnection.setLocalDescription(l)),v==null||v(p),yield _t(n.peerConnection.setRemoteDescription({type:"answer",sdp:p}))}catch(l){L.warning("restart ICE failed, abort operation",l)}finally{a()}})()}close(){var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}async updateEncoderConfig(t,n){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.updateEncoderConfig before remote SDP created.");const a=await this.peerConnection.createOffer(),l=this.mungSendOfferSDP(a.sdp,[n],[t]);this.remoteSDP.updateRecvMedia(t,n);const u=this.remoteSDP.toString(),h=this.logSDPExchange(l,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:l}),h==null||h(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(a){throw new ue(z.EXCHANGE_SDP_FAILED,a.toString())}}async updateSendParameters(t,n){const a=this.peerConnection.getTransceivers().filter(l=>l.mid===t);a.length===1&&(this.isVP8Simulcast(n)?un()||await this.applySimulcastEncodings(a,[n]):await this.applySendEncodings(a,[n]))}setStatsRemoteVideoIsReady(t,n){this.statsFilter.setVideoIsReady2(t,n)}async replaceTrack(t,n){const a=this.peerConnection.getTransceivers().find(l=>l.mid===n);a&&await a.sender.replaceTrack(t._mediaStreamTrack)}getP2PConnectionParams(){var t;if((t=this.peerConnection.currentLocalDescription)===null||t===void 0||!t.sdp||!this.localCapabilities)throw new Error;return yE(yE({},Fs(this.peerConnection.currentLocalDescription.sdp)),{},{rtpCapabilities:this.localCapabilities})}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t;(t=this.onICEConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=t=>{t.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,L.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,L.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},J("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const n={iceServers:[]};return t.iceServers?n.iceServers=t.iceServers:t.turnServer&&t.turnServer.mode!=="off"&&(kh(t.turnServer.servers)?n.iceServers=t.turnServer.servers:(n.iceServers&&n.iceServers.push(...di.turnServerConfigToIceServers(t.turnServer.servers)),J("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&t.turnServer.serversFromGateway&&n.iceServers.push(...di.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),J("FORCE_TURN_TCP")?n.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(a=>{a.forceturn&&(n.iceTransportPolicy="relay")}))),n}static turnServerConfigToIceServers(t){const n=[];return t.forEach(a=>{a.security?a.tcpport&&n.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(eu(a.turnServerURL),":").concat(a.tcpport,"?transport=tcp")}):(a.udpport&&!J("FORCE_TURN_TCP")&&n.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.udpport,"?transport=udp")}),a.tcpport&&n.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}))}),n}async applySendEncodings(t,n){try{if(!cn().supportSetRtpSenderParameters||t.length!==n.length)return;for(let C=0;C<t.length;C++){const I=t[C],k=n[C];if(k&&k instanceof Rt){var a,l,u;if(this.isVP8Simulcast(k))continue;const G={},B={};switch(k._optimizationMode){case"motion":G.degradationPreference="maintain-framerate";break;case"detail":G.degradationPreference="maintain-resolution";break;default:G.degradationPreference="balanced"}var h,p,v,E;if((a=k._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&(B.maxBitrate=1e3*((h=k._encoderConfig)===null||h===void 0?void 0:h.bitrateMax)),Be(l=k._hints).call(l,mn.LOW_STREAM)&&((p=k._encoderConfig)!==null&&p!==void 0&&p.frameRate&&(B.maxFramerate=Jo(k._encoderConfig.frameRate)),(v=k._encoderConfig)!==null&&v!==void 0&&v.scaleResolutionDownBy&&((E=k._encoderConfig)===null||E===void 0?void 0:E.scaleResolutionDownBy)>1&&(B.scaleResolutionDownBy=k._encoderConfig.scaleResolutionDownBy)),J("DSCP_TYPE")&&Wl()){var y;const Z=J("DSCP_TYPE");Be(y=["very-low","low","medium","high"]).call(y,Z)&&(B.networkPriority=Z)}const j=I.sender.getParameters(),q=(u=j.encodings)===null||u===void 0?void 0:u[0];un()&&!q&&(G.encodings=[B]),q&&Object.assign(q,B),Object.assign(j,G),await I.sender.setParameters(j)}}}catch{L.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(t,n,a){const l=In.parse(t);return n.forEach((u,h)=>{const p=a[h],v=l.mediaDescriptions.find(E=>E.attributes.mid===p);v&&(uu(v,u),LR(v,u,this.store.codec))}),In.print(l)}mungReceiveAnswerSDP(t,n,a){const l=In.parse(t),u=l.mediaDescriptions.find(h=>h.attributes.mid===n);return u&&a===je.AUDIO&&u.media.mediaType==="audio"&&Us(u),this.useXR&&k0(l),In.print(l)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var n;(n=this.onFirstAudioReceived)===null||n===void 0||n.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var n;(n=this.onFirstVideoReceived)===null||n===void 0||n.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var n;(n=this.onFirstAudioDecoded)===null||n===void 0||n.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,n,a)=>{var l;(l=this.onFirstVideoDecoded)===null||l===void 0||l.call(this,t,n,a)},this.statsFilter.onSelectedLocalCandidateChanged=(t,n)=>{var a;(a=this.onSelectedLocalCandidateChanged)===null||a===void 0||a.call(this,t,n)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,n)=>{var a;(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0||a.call(this,t,n)},this.statsFilter.onFirstVideoDecodedTimeout=t=>{var n;(n=this.onFirstVideoDecodedTimeout)===null||n===void 0||n.call(this,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(t,n){if(t.length===n.length)for(let v=0;v<t.length;v++){var a,l,u,h,p;const E=t[v],y=n[v];if(y instanceof Rt&&!Be(a=y._hints).call(a,mn.LOW_STREAM)&&(l=y._encoderConfig)!==null&&l!==void 0&&l.bitrateMax&&((u=y._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(h=y._scalabilityMode)!==null&&h!==void 0&&h.numSpatialLayers&&((p=y._scalabilityMode)===null||p===void 0?void 0:p.numSpatialLayers)>1&&this.store.codec==="vp8"){const C={},I={high:1e3*(y._encoderConfig.bitrateMax-50),medium:5e4};C.encodings=[{rid:"m",active:!0,maxBitrate:I.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:I.high}];const k=E.sender.getParameters();await E.sender.setParameters(Object.assign(k,C))}}}async applySimulcastEncodings(t,n){if(!un()&&t.length===n.length)for(let a=0;a<t.length;a++){const l=n[a];if(l instanceof Rt&&this.isVP8Simulcast(l)){const u=t[a],h={},p={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};h.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:p.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:p.medium,scaleResolutionDownBy:4}];const v=u.sender.getParameters();await u.sender.setParameters(Object.assign(v,h))}}}isVP8Simulcast(t){var n,a,l,u,h;return!!(t instanceof Rt&&J("SIMULCAST")&&this.store.codec==="vp8"&&!Be(n=t._hints).call(n,mn.LOW_STREAM)&&(a=t._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&((l=t._encoderConfig)===null||l===void 0?void 0:l.bitrateMax)>200&&(u=t._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((h=t._scalabilityMode)===null||h===void 0?void 0:h.numSpatialLayers)>1)}logSDPExchange(t,n,a,l){if(J("SDP_LOGGING"))return L.upload("exchanging ".concat(a," ").concat(n," SDP during NVExtentionsConnection.").concat(l,`
`),t),n==="offer"?u=>{this.logSDPExchange(u,"answer",a==="local"?"remote":"local",l)}:void 0}async getRemoteSSRC(t){if(!this.remoteSDP)return;const n=this.remoteSDP.getSSRC(t);return n==null?void 0:n[0].ssrcId}setConfiguration(t){if(cn().supportPCSetConfiguration){const n=di.resolvePCConfiguration(t);this.peerConnection.setConfiguration(n)}}}function Eo(i,t,n){const a=i[t];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return n.value=async function(){const l=this.mutex,u=await l.lock("From NVExtentionsConnection.".concat(t));try{for(var h=arguments.length,p=new Array(h),v=0;v<h;v++)p[v]=arguments[v];return await a.apply(this,p)}finally{u()}},n}function r4(i){var t,n,a,l=2;for(typeof Symbol<"u"&&(n=GU,a=Symbol.iterator);l--;){if(n&&(t=i[n])!=null)return t.call(i);if(a&&(t=i[a])!=null)return new SE(t.call(i));n="@@asyncIterator",a="@@iterator"}throw new TypeError("Object is not async iterable")}function SE(i){function t(n){if(Object(n)!==n)return _e.reject(new TypeError(n+" is not an object."));var a=n.done;return _e.resolve(n.value).then(function(l){return{value:l,done:a}})}return SE=function(n){this.s=n,this.n=n.next},SE.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(n){var a=this.s.return;return a===void 0?_e.resolve({value:n,done:!0}):t(a.apply(this.s,arguments))},throw:function(n){var a=this.s.return;return a===void 0?_e.reject(n):t(a.apply(this.s,arguments))}},new SE(i)}Re([Eo,H("design:type",Function),H("design:paramtypes",[Object,Object,Array,Object,String,String]),H("design:returntype",_e)],di.prototype,"connect",null),Re([Eo,H("design:type",Function),H("design:paramtypes",[Array,Array]),H("design:returntype",_e)],di.prototype,"updateRemoteRTPCapabilities",null),Re([Eo,H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",_e)],di.prototype,"updateRemoteConnect",null),Re([Eo,H("design:type",Function),H("design:paramtypes",[Object,Array]),H("design:returntype",_e)],di.prototype,"createDataChannels",null),Re([Eo,H("design:type",Function),H("design:paramtypes",[String,Array,String,Object]),H("design:returntype",_e)],di.prototype,"receive",null),Re([Eo,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],di.prototype,"batchReceive",null),Re([Eo,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],di.prototype,"stopReceiving",null),Re([Eo,H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],di.prototype,"muteRemote",null),Re([Eo,H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],di.prototype,"unmuteRemote",null),Re([Eo,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],di.prototype,"muteLocal",null),Re([Eo,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],di.prototype,"unmuteLocal",null),Re([Eo,H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],di.prototype,"close",null),Re([Eo,H("design:type",Function),H("design:paramtypes",[String,ci]),H("design:returntype",_e)],di.prototype,"updateEncoderConfig",null),Re([Eo,H("design:type",Function),H("design:paramtypes",[String,ci]),H("design:returntype",_e)],di.prototype,"updateSendParameters",null),Re([Eo,H("design:type",Function),H("design:paramtypes",[ci,String]),H("design:returntype",_e)],di.prototype,"replaceTrack",null),Re([Eo,H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],di.prototype,"getRemoteSSRC",null);class wr extends Mv{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get localCodecs(){return this._p2pConnection.localCodecs}constructor(t,n){super(t,n),w(this,"store",void 0),w(this,"peerConnection",void 0),w(this,"cname",void 0),w(this,"mutex",new Ur("DataChannelConnection-mutex")),w(this,"dataChannel",void 0),w(this,"_p2pConnection",void 0),w(this,"establishPromise",void 0),w(this,"_nvMedia",void 0),this.store=n,this.store.dcId=this.store.dcId+1,this.peerConnection=new RTCPeerConnection(wr.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.dataChannel=this.peerConnection.createDataChannel("agora-signal",{ordered:!1,maxPacketLifeTime:50}),this.dataChannel.binaryType="arraybuffer",this._p2pConnection=new di(t,n,this.peerConnection),this.bindPCEvents(),this.establishPromise=this._p2pConnection.establishPromise}async establish(){var t;const n=(t=this._nvMedia)===null||t===void 0?void 0:t.getLocalRtpCapabilities();return await this._p2pConnection.establish(n)}getP2PConnectionParams(){return this._p2pConnection.getP2PConnectionParams()}async connect(t,n,a,l,u,h){return this.cname=h,await this._p2pConnection.connect(t,n,a,l,u,h),await new _e((p,v)=>{const E=setTimeout(()=>{this.closeSignal(),v(new ue(z.DATACHANNEL_CONNECTION_TIMEOUT,"Datachannel connection timed out, candidates: ".concat(JSON.stringify(a))))},2e3);this.dataChannel.onopen=()=>{if(this.dataChannel.readyState==="open")return clearTimeout(E),void p()},this.dataChannel.onerror=y=>{this.closeSignal(),v(y)}}),{transmitter:this.dataChannel,close:this.closeSignal.bind(this)}}async updateRemoteRTPCapabilities(t,n){return this._p2pConnection.updateRemoteRTPCapabilities(t,n)}send(t,n,a){var l=this;return Do(function*(){const u=yield _t(l.mutex.lock("From DataChannelConnection.send"));try{return yield*EE(r4(l._p2pConnection.send(t,n,a)))}finally{u()}})()}async stopSending(t,n){return this._p2pConnection.stopSending(t,n)}async createDataChannels(t,n){return this._p2pConnection.createDataChannels(t,n)}async stopDataChannels(t){return this._p2pConnection.stopDataChannels(t)}async receive(t,n,a,l){return this._nvMedia?(L.debug("[DataChannelConnection] receive ".concat(t," by DataChannel.")),await this._nvMedia.reveiveByRTCMedia(t,n,this.cname)):(L.debug("[DataChannelConnection] receive ".concat(t," by WebRTC.")),await this._p2pConnection.receive(t,n,a,l))}async batchReceive(t){return[...await this._p2pConnection.batchReceive(t)]}async stopReceiving(t){return await this._p2pConnection.stopReceiving(t)}async muteRemote(t){return await this._p2pConnection.muteRemote(t)}async unmuteRemote(t){return await this._p2pConnection.unmuteRemote(t)}async muteLocal(t){return await this._p2pConnection.muteLocal(t)}async unmuteLocal(t){return await this._p2pConnection.unmuteLocal(t)}restartICE(t){var n=this;return Do(function*(){return yield*EE(r4(n._p2pConnection.restartICE(t)))})()}close(){var t;(t=this._nvMedia)===null||t===void 0||t.close(),this._p2pConnection.close(),this.unbindConnectionEvents(this._p2pConnection)}getStats(){return this._p2pConnection.getStats()}getRemoteVideoIsReady(t){return this._p2pConnection.getRemoteVideoIsReady(t)}updateRemoteConnect(t){var n;(n=this._nvMedia)===null||n===void 0||n.setRemoteRtpCapabilities(t),this._p2pConnection.updateRemoteConnect(t)}async updateEncoderConfig(t,n){return await this._p2pConnection.updateEncoderConfig(t,n)}async updateSendParameters(t,n){return await this._p2pConnection.updateSendParameters(t,n)}setStatsRemoteVideoIsReady(t,n){this._p2pConnection.setStatsRemoteVideoIsReady(t,n)}async replaceTrack(t,n){return await this._p2pConnection.replaceTrack(t,n)}async getRemoteSSRC(t){return this._p2pConnection.getRemoteSSRC(t)}logSDPExchange(t,n,a,l){if(J("SDP_LOGGING"))return L.upload("exchanging ".concat(a," ").concat(n," SDP during DataChannelConnection.").concat(l,`
`),t),n==="offer"?u=>{this.logSDPExchange(u,"answer",a==="local"?"remote":"local",l)}:void 0}static resolvePCConfiguration(t){const n={iceServers:[]};return t.iceServers?n.iceServers=t.iceServers:t.turnServer&&t.turnServer.mode!=="off"&&(kh(t.turnServer.servers)?n.iceServers=t.turnServer.servers:(n.iceServers&&n.iceServers.push(...wr.turnServerConfigToIceServers(t.turnServer.servers)),J("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&t.turnServer.serversFromGateway&&n.iceServers.push(...wr.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),J("FORCE_TURN_TCP")?n.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(a=>{a.forceturn&&(n.iceTransportPolicy="relay")}))),n}static turnServerConfigToIceServers(t){const n=[];return t.forEach(a=>{a.security?a.tcpport&&n.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(eu(a.turnServerURL),":").concat(a.tcpport,"?transport=tcp")}):(a.udpport&&!J("FORCE_TURN_TCP")&&n.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.udpport,"?transport=udp")}),a.tcpport&&n.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}))}),n}bindPCEvents(){this._p2pConnection.onICEConnectionStateChange=t=>{var n;return(n=this.onICEConnectionStateChange)===null||n===void 0?void 0:n.call(this,t)},this._p2pConnection.onConnectionStateChange=t=>{var n;return(n=this.onConnectionStateChange)===null||n===void 0?void 0:n.call(this,t)},this._p2pConnection.onDTLSTransportStateChange=t=>{var n;return(n=this.onDTLSTransportStateChange)===null||n===void 0?void 0:n.call(this,t)},this._p2pConnection.onDTLSTransportError=t=>{var n;return(n=this.onDTLSTransportError)===null||n===void 0?void 0:n.call(this,t)},this._p2pConnection.onICETransportStateChange=t=>{var n;return(n=this.onICETransportStateChange)===null||n===void 0?void 0:n.call(this,t)},this._p2pConnection.onFirstAudioReceived=t=>{var n;return(n=this.onFirstAudioReceived)===null||n===void 0?void 0:n.call(this,t)},this._p2pConnection.onFirstVideoReceived=t=>{var n;return(n=this.onFirstVideoReceived)===null||n===void 0?void 0:n.call(this,t)},this._p2pConnection.onFirstAudioDecoded=t=>{var n;return(n=this.onFirstAudioDecoded)===null||n===void 0?void 0:n.call(this,t)},this._p2pConnection.onFirstVideoDecoded=(t,n,a)=>{var l;return(l=this.onFirstVideoDecoded)===null||l===void 0?void 0:l.call(this,t,n,a)},this._p2pConnection.onFirstVideoDecodedTimeout=t=>{var n;return(n=this.onFirstVideoDecodedTimeout)===null||n===void 0?void 0:n.call(this,t)},this._p2pConnection.onSelectedLocalCandidateChanged=(t,n)=>{var a;return(a=this.onSelectedLocalCandidateChanged)===null||a===void 0?void 0:a.call(this,t,n)},this._p2pConnection.onSelectedRemoteCandidateChanged=(t,n)=>{var a;return(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0?void 0:a.call(this,t,n)}}closeSignal(){this.dataChannel.close(),this.peerConnection.close()}unbindConnectionEvents(t){t.onConnectionStateChange=void 0,t.onICEConnectionStateChange=void 0,t.onICETransportStateChange=void 0,t.onDTLSTransportStateChange=void 0,t.onDTLSTransportError=void 0,t.onFirstAudioDecoded=void 0,t.onFirstAudioReceived=void 0,t.onFirstVideoDecoded=void 0,t.onFirstVideoReceived=void 0,t.onSelectedLocalCandidateChanged=void 0,t.onSelectedRemoteCandidateChanged=void 0,t.onFirstVideoDecodedTimeout=void 0}setConfiguration(t){this._p2pConnection.setConfiguration(t)}}function aa(i,t,n){const a=i[t];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return n.value=async function(){const l=this.mutex,u=await l.lock("From DataChannelConnection.".concat(t));try{for(var h=arguments.length,p=new Array(h),v=0;v<h;v++)p[v]=arguments[v];return await a.apply(this,p)}finally{u()}},n}function i4(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function fu(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?i4(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):i4(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}function o4(i){var t,n,a,l=2;for(typeof Symbol<"u"&&(n=GU,a=Symbol.iterator);l--;){if(n&&(t=i[n])!=null)return t.call(i);if(a&&(t=i[a])!=null)return new CE(t.call(i));n="@@asyncIterator",a="@@iterator"}throw new TypeError("Object is not async iterable")}function CE(i){function t(n){if(Object(n)!==n)return _e.reject(new TypeError(n+" is not an object."));var a=n.done;return _e.resolve(n.value).then(function(l){return{value:l,done:a}})}return CE=function(n){this.s=n,this.n=n.next},CE.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(n){var a=this.s.return;return a===void 0?_e.resolve({value:n,done:!0}):t(a.apply(this.s,arguments))},throw:function(n){var a=this.s.return;return a===void 0?_e.reject(n):t(a.apply(this.s,arguments))}},new CE(i)}Re([aa,H("design:type",Function),H("design:paramtypes",[Object,Object,Array,Object,String,String]),H("design:returntype",_e)],wr.prototype,"connect",null),Re([aa,H("design:type",Function),H("design:paramtypes",[Array,Array]),H("design:returntype",_e)],wr.prototype,"updateRemoteRTPCapabilities",null),Re([aa,H("design:type",Function),H("design:paramtypes",[Object,Array]),H("design:returntype",_e)],wr.prototype,"createDataChannels",null),Re([aa,H("design:type",Function),H("design:paramtypes",[String,Array,String,Object]),H("design:returntype",_e)],wr.prototype,"receive",null),Re([aa,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],wr.prototype,"stopReceiving",null),Re([aa,H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],wr.prototype,"muteRemote",null),Re([aa,H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],wr.prototype,"unmuteRemote",null),Re([aa,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],wr.prototype,"muteLocal",null),Re([aa,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],wr.prototype,"unmuteLocal",null),Re([aa,H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],wr.prototype,"close",null),Re([aa,H("design:type",Function),H("design:paramtypes",[String,ci]),H("design:returntype",_e)],wr.prototype,"updateEncoderConfig",null),Re([aa,H("design:type",Function),H("design:paramtypes",[String,ci]),H("design:returntype",_e)],wr.prototype,"updateSendParameters",null),Re([aa,H("design:type",Function),H("design:paramtypes",[ci,String]),H("design:returntype",_e)],wr.prototype,"replaceTrack",null),Re([aa,H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],wr.prototype,"getRemoteSSRC",null);class $r extends wn{get state(){return this._state}set state(t){const n=this._state;this._state=t,this.emit(Qe.StateChange,n,this._state)}constructor(t,n){super(),w(this,"store",void 0),w(this,"statsUploader",void 0),w(this,"connection",void 0),w(this,"localTrackMap",new Map),w(this,"remoteUserMap",new Map),w(this,"localDataChannels",[]),w(this,"remoteDataChannelMap",new Map),w(this,"pendingLocalTracks",[]),w(this,"pendingRemoteTracks",[]),w(this,"pendingLocalDataChannels",[]),w(this,"pendingRemoteDataChannels",[]),w(this,"statsCollector",void 0),w(this,"isPlanB",!1),w(this,"shouldForwardP2PCreation",void 0),w(this,"iceFailedCount",0),w(this,"dtlsFailedCount",0),w(this,"mutex",new Ur("P2PChannel-mutex")),w(this,"_state",tn.Disconnected),w(this,"_pcStatsUploadType",J("NEW_ICE_RESTART")?Ms.FIRST_CONNECTION:Ms.OLD_FIRST_CONNECTION),w(this,"_isInRestartIce",!1),w(this,"_isStartRestartIce",!1),w(this,"_restartStates",["disconnected","failed"]),w(this,"_restartTimer",void 0),w(this,"_isFirstConnected",!0),w(this,"handleMuteLocalTrack",async(a,l,u)=>{const h=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==tn.Connected)return void u(new Te(z.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const p=this.filterTobeMutedTracks(a);if(p.length===0)return void l();const v=p.find(y=>y[0]==="videoLowTrack");v&&v[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(p.map(y=>{let[,{id:C}]=y;return C}));const E=this.createMuteMessage(p);await hn(this,Qe.RequestMuteLocal,E),l()}catch(p){u(p)}finally{h()}}),w(this,"handleUnmuteLocalTrack",async(a,l,u)=>{const h=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==tn.Connected)return void u(new Te(z.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const p=this.filterTobeUnmutedTracks(a);if(p.length===0)return void l();const v=p.find(y=>y[0]==="videoLowTrack");if(v){const y=v[1];if(y.track._originMediaStreamTrack.stop(),!J("DISABLE_DUAL_STREAM_USE_ENCODING")&&cn().supportDualStreamEncoding){const C=a._mediaStreamTrack.clone();y.track._mediaStreamTrack=C,y.track._originMediaStreamTrack=C}else{const C=FR(a,sd(this,Qe.RequestLowStreamParameter));y.track._mediaStreamTrack=C,y.track._originMediaStreamTrack=C}await new _e((C,I)=>{this.handleReplaceTrack(y.track,C,I,!0)})}await this.connection.unmuteLocal(p.map(y=>{let[,{id:C}]=y;return C}));const E=this.createUnmuteMessage(p);await hn(this,Qe.RequestUnmuteLocal,E),l()}catch(p){u(p)}finally{h()}}),w(this,"handleUpdateVideoEncoder",async(a,l,u)=>{const h=await this.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{const p=this.localTrackMap.get(Ie.LocalVideoTrack);if(!this.connection||!p||p.track!==a||this.state!==tn.Connected)return void l();const{id:v,track:E}=p;await this.connection.updateSendParameters(v,E),await this.connection.updateEncoderConfig(v,E),this.emit(Qe.UpdateVideoEncoder,E),l()}catch(p){u(p)}finally{h()}}),w(this,"handleSetOptimizationMode",async(a,l,u)=>{const h=await this.mutex.lock("Locking from P2PChannel.handleSetOptimizationMode");try{const p=this.localTrackMap.get(Ie.LocalVideoTrack);if(!this.connection||!p||p.track!==a||this.state!==tn.Connected)return;const{id:v,track:E}=p;await this.connection.updateSendParameters(v,E),l()}catch(p){u(p)}finally{h()}}),w(this,"handleReplaceTrack",async(a,l,u,h)=>{let p;L.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(a.getTrackId(),"]")),typeof h=="boolean"&&h||(p=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var v;const y=Array.from(this.localTrackMap.entries()).find(C=>{let[,{track:I}]=C;return a===I});if(!this.connection||!y||this.state!==tn.Connected)return void l();if(await((v=this.connection)===null||v===void 0?void 0:v.replaceTrack(a,y[1].id)),this.isPlanB){const C=y[1];C.id=a._mediaStreamTrack.id,this.localTrackMap.set(y[0],C)}if(y[0]===Ie.LocalVideoTrack&&!J("DISABLE_DUAL_STREAM_USE_ENCODING")&&cn().supportDualStreamEncoding){const C=this.localTrackMap.get(Ie.LocalVideoLowTrack);if(C){const I=a._mediaStreamTrack.clone();C.track._originMediaStreamTrack.stop(),C.track._mediaStreamTrack=I,C.track._originMediaStreamTrack=I,await new _e((k,G)=>{this.handleReplaceTrack(C.track,k,G,!0)})}}l()}catch(y){u(y)}finally{var E;(E=p)===null||E===void 0||E()}}),w(this,"handleGetRTCStats",a=>{a(this.statsCollector.getRTCStats())}),w(this,"handleGetLocalVideoStats",a=>{a(this.statsCollector.getLocalVideoTrackStats())}),w(this,"handleGetLocalAudioStats",a=>{a(this.statsCollector.getLocalAudioTrackStats())}),w(this,"handleGetRemoteVideoStats",a=>this.statsCollector.getRemoteVideoTrackStats(a.uid)[a.uid]),w(this,"handleGetRemoteAudioStats",a=>this.statsCollector.getRemoteAudioTrackStats(a.uid)[a.uid]),this.store=t,this.statsCollector=n,this.statsCollector.addP2PChannel(this),this.statsUploader=new BU(this.store),this.bindStatsUploaderEvents(),this.isPlanB=!cn().supportUnifiedPlan||J("CHROME_FORCE_PLAN_B")&&Wl(),this.shouldForwardP2PCreation=J("FORWARD_P2P_CREATION")&&cn().supportPCSetConfiguration&&function(){const a=pv();return a===yr.ANDROID||a===yr.IOS||a===yr.HARMONY_OS}(),this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new wr({},this.store):this.isPlanB?new Vr({},this.store):new $n({},this.store),this.bindConnectionEvents(this.connection))}async startP2PConnection(t,n){var a;this.state=tn.New;const l=this.shouldForwardP2PCreation&&((a=this.connection)===null||a===void 0?void 0:a.peerConnectionState)==="closed";if(this.shouldForwardP2PCreation&&!l||(l&&this.connection&&(L.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.connection.close(),this.unbindConnectionEvents(this.connection)),this.connection=this.store.useDataChannel?new wr(t,this.store):this.isPlanB?new Vr(t,this.store):new $n(t,this.store),this.bindConnectionEvents(this.connection)),!this.connection)throw new Te(z.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=J("NEW_ICE_RESTART")?Ms.FIRST_CONNECTION:Ms.OLD_FIRST_CONNECTION,this._isFirstConnected=!0,this._isInRestartIce=!1,this._isStartRestartIce=!1,this.connection.setConfiguration(t),this.connection.establishPromise}async connect(t,n,a,l,u,h){if(!this.connection)throw new Te(z.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.connection instanceof wr?this.connection.updateRemoteConnect(l):(this.store.peerConnectionStart(),await this.connection.connect(t,n,a,l,u,h),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=tn.Connected)}updateRemoteRTPCapabilities(t){const n=Array.from(this.localTrackMap.entries()).filter(u=>{var h;let[p]=u;return Be(h=[Ie.LocalVideoLowTrack,Ie.LocalVideoTrack]).call(h,p)}),a=n.map(u=>{let[,{id:h}]=u;return h}),l=n.map(u=>{let[h]=u;return h});if(this.connection instanceof $n){if(We.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(l),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(t)}),!Be(t).call(t,this.store.codec)){const u=["vp8","h264"].find(h=>Be(t).call(t,h));u&&(this.store.codec=u,L.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(u,".")))}this.connection.updateRemoteRTPCapabilities(a,t)}}async preConnect(t,n,a,l,u,h){if(!this.connection)throw new Te(z.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.store.peerConnectionStart();const p=await this.connection.connect(t,n,a,l,u,h);return this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=tn.Connected,p}getEstablishParams(){if(this.connection instanceof wr)return this.connection.getP2PConnectionParams();throw new Error("Only DataChannelConnection needs to obtain establishParams")}async publishDataChannel(t){if(!this.connection){if(this.state===tn.Disconnected)throw new Te(z.UNEXPECTED_ERROR,"PeerConnection already disconnected.");const a=t.filter(l=>this.pendingLocalDataChannels.findIndex(u=>u.id===l.id)!==-1);return void(this.pendingLocalDataChannels=this.pendingLocalDataChannels.concat(a))}const n=this.filterTobePublishedDataChannels(t);n.length!==0&&(n.forEach(a=>{const l=Date.now();this.store.publish(a.id.toString(),"datachannel",l)}),await this.connection.createDataChannels(this.store.uid,n),n.forEach(a=>{this.localDataChannels.push(a);const l=Date.now();this.store.publish(a.id+"","datachannel",void 0,l)}))}publish(t,n,a){var l=this;return Do(function*(){const u=yield _t(l.mutex.lock("From P2PChannel.publish"));try{if(!l.connection||l.state!==tn.Connected){if(l.state===tn.Disconnected)throw new Te(z.UNEXPECTED_ERROR,"PeerConnection already disconnected.");l.throwIfTrackTypeNotMatch(t);const p=t.filter(v=>l.pendingLocalTracks.indexOf(v)===-1);return void(l.pendingLocalTracks=l.pendingLocalTracks.concat(p))}l.store.pubId=l.store.pubId+1,li.markPublishStart(l.store.clientId,l.store.pubId);const h=l.filterTobePublishedTracks(t,n,a);if(h.length===0)return void(yield _t(l.tryToUnmuteAudio(t)));yield*EE(o4(l.doPublish(l.connection,h)))}finally{u()}})()}doPublish(t,n){var a=this;return Do(function*(){n.forEach(y=>{let{track:C,type:I}=y;const k=Date.now();a.store.publish(C.getTrackId(),I===Ie.LocalAudioTrack?"audio":"video",k)}),a.bindLocalTrackEvents(n);const l=yield _t(t.send(n.map(y=>{let{track:C}=y;return C}),a.store.codec,a.store.audioCodec)),u=(yield _t(l.next())).value,h=a.createGatewayPublishMessage(n,u);let p;try{p=yield h}catch(y){throw l.throw(y),(y==null?void 0:y.code)===z.WS_ABORT&&n.forEach(C=>{let{track:I}=C;a.pendingLocalTracks.indexOf(I)===-1&&a.pendingLocalTracks.push(I)}),a.unbindLocalTrackEvents(n),y}const v=a.mapPubResToRemoteConfig(h,p),E=(yield _t(l.next(v))).value;n.forEach(y=>{let{type:C}=y;a.statsCollector.addLocalStats(C)}),a.assignLocalTracks(n,E),a.statsUploader.startUploadOutboundStats(),n.forEach(y=>{let{track:C,type:I}=y;const k=Date.now();a.store.publish(C.getTrackId(),I===Ie.LocalAudioTrack?"audio":"video",void 0,k)})})()}async updateVideoStreamParameter(t,n){const a=this.localTrackMap.get(n);if(!a)return;if(!(a.track instanceof Rt))return L.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");if(!(this.connection instanceof $n||this.connection instanceof Vr))return L.warn("[updateVideoStreamParameter]: connection is not P2PConnection or P2PConnectionPlanB");const{track:l}=a,u=function(h,p){const v={};return h.height&&h.width&&(v.scaleResolutionDownBy=PT(h,p)),v.maxFramerate=h.framerate?Jo(h.framerate):void 0,v.maxBitrate=h.bitrate?1e3*h.bitrate:void 0,v}(t,l);if(l._encoderConfig||(l._encoderConfig={}),n!==Ie.LocalVideoLowTrack||!J("DISABLE_DUAL_STREAM_USE_ENCODING")&&cn().supportDualStreamEncoding)u.scaleResolutionDownBy!=null&&(l._encoderConfig.scaleResolutionDownBy=u.scaleResolutionDownBy);else{const h=l._originMediaStreamTrack;if(!h.canvas)return L.warn("[".concat(l.getTrackId(),"] no canvas on track"));(function(p,v){const E=p.canvas;v.width&&(E.width=Jo(v.width)),v.height&&(E.height=Jo(v.height)),v.framerate&&(E.stopCapture&&E.stopCapture(),E.stopCapture=qT(()=>{!E.startCapture&&E.stopCapture&&E.stopCapture(),E.startCapture&&E.startCapture()},Jo(v.framerate)))})(h,t)}u.maxBitrate!=null&&(l._encoderConfig.bitrateMax=u.maxBitrate/1e3),u.maxFramerate!=null&&(l._encoderConfig.frameRate&&typeof l._encoderConfig.frameRate=="object"?l._encoderConfig.frameRate.max=u.maxFramerate:l._encoderConfig.frameRate={max:u.maxFramerate}),L.debug("[".concat(l.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(l._encoderConfig))),await this.connection.updateRtpSenderEncodings(l)}publishLowStream(t){var n=this;return Do(function*(){if(!n.connection||n.state!==tn.Connected)return;const a=yield _t(n.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const u=n.localTrackMap.get(Ie.LocalVideoTrack);if(!u)throw new Te(z.UNEXPECTED_ERROR,"Could not find high stream");if(n.localTrackMap.has(Ie.LocalVideoLowTrack))throw new Te(z.UNEXPECTED_ERROR,"[".concat(n.store.clientId,"] Can't publish low stream when stream already publish"));const h=[{track:n.getLowVideoTrack(u.track,t),type:Ie.LocalVideoLowTrack}];if(yield*EE(o4(n.doPublish(n.connection,h))),u.track.muted||!u.track.enabled){var l;const p=(l=n.localTrackMap.get(Ie.LocalVideoLowTrack))===null||l===void 0?void 0:l.id;p!==void 0&&(yield _t(n.connection.muteLocal([p])))}}finally{a()}})()}async republish(){this.pendingLocalTracks.length>0&&(L.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await cr(this,Qe.RequestRePublish,this.pendingLocalTracks),this.emit(Qe.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(L.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await cr(this,Qe.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[])}async reSubscribe(t){for(let n=this.pendingRemoteTracks.length-1;n>=0;n--){const{user:a,kind:l}=this.pendingRemoteTracks[n];(l!==je.AUDIO||a._audio_added_&&a._audioSSRC)&&(l!==je.VIDEO||a._video_added_&&a._videoSSRC)||this.pendingRemoteTracks.splice(n,1)}if(t)await cr(this,Qe.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:n,kind:a}of this.pendingRemoteTracks)await this.subscribe(n,a,a===je.VIDEO?n._videoSSRC:n._audioSSRC);this.pendingRemoteTracks.forEach(n=>{let{user:a}=n;this.emit(Qe.MediaReconnectEnd,a.uid)}),this.pendingRemoteTracks=[]}async unpublish(t){if(!this.connection||this.state!==tn.Connected)return void t.forEach(l=>{const u=this.pendingLocalTracks.indexOf(l);u!==-1&&this.pendingLocalTracks.splice(u,1)});const n=this.filterTobeUnpublishedTracks(t);if(n.length===0)return;const a=n.find(l=>l[0]==="videoLowTrack");return a&&a[1].track.close(),this.doUnpublish(this.connection,n)}async unpublishDataChannel(t){if(!this.connection||this.state!==tn.Connected)return void t.forEach(a=>{const l=this.pendingLocalDataChannels.indexOf(a);l!==-1&&this.pendingLocalDataChannels.splice(l,1)});const n=this.filterTobeUnpublishedDataChannels(t);return n.length!==0?(n.forEach(a=>{const l=this.localDataChannels.indexOf(a);l!==-1&&this.localDataChannels.splice(l,1)}),this.localDataChannels.length===0&&await this.connection.stopDataChannels(this.store.uid),n.map(a=>a.id)):void 0}async unpublishLowStream(){if(!this.connection||this.state!==tn.Connected)return;const t=this.localTrackMap.get(Ie.LocalVideoLowTrack);if(!t)return;t.track.close();const n=[[Ie.LocalVideoLowTrack,t]];return this.doUnpublish(this.connection,n)}async doUnpublish(t,n){const a=this.createGatewayUnpublishMessage(n);return await t.stopSending(n.map(l=>{let[,{id:u}]=l;return u})),this.withdrawLocalTracks(n),this.unbindLocalTrackEvents(n.map(l=>{let[u,{track:h}]=l;return{type:u,track:h}})),n.forEach(l=>{let[u]=l;this.statsCollector.removeLocalStats(u)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadOutboundStats(),a}async subscribeDataChannel(t,n){if(!this.connection||this.state!==tn.Connected)throw new Te(z.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const a=n.filter(l=>{var u;return!((u=this.remoteDataChannelMap.get(t))!==null&&u!==void 0&&u.get(l.id))});if(a.length!==0)return await this.connection.createDataChannels(t.uid,a),a.forEach(l=>{var u;this.remoteDataChannelMap.has(t)?(u=this.remoteDataChannelMap.get(t))===null||u===void 0||u.set(l.id,l):this.remoteDataChannelMap.set(t,new Map([[l.id,l]]));const h=this.pendingRemoteDataChannels.findIndex(p=>{let{user:v,id:E}=p;return v.uid===t.uid&&E===l.id});h!==-1&&this.pendingRemoteDataChannels.splice(h,1)}),a.map(l=>l.id)}async subscribe(t,n,a,l,u){var h;if(!this.connection||this.state!==tn.Connected)throw new Te(z.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((h=this.remoteUserMap.get(t))!==null&&h!==void 0&&h.has(n))return;let p,v,E;if(u){const I=u.find(G=>{let{stream_type:B}=G;return B===n});if(!I)throw new Te(z.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(n," for user: ").concat(t.uid," because subscribe answer from gateway does not contain stream_type: ").concat(n,"."));const k=await this.connection.receive(n,I.ssrcs,String(t._uintid),I.attributes);this.connection instanceof $n&&(E=k.transceiver),p=k.track,v=k.id}else{const I=await this.connection.receive(n,[{ssrcId:a,rtx:l}],String(t._uintid),void 0);this.connection instanceof $n&&(E=I.transceiver),p=I.track,v=I.id}n===je.AUDIO?(t._audioTrack?t._audioTrack._updateOriginMediaStreamTrack(p):(t._audioTrack=new is(p,t.uid,t._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(t._audioTrack.getTrackId()))),E&&t._audioTrack._updateRtpTransceiver(E),this.bindRemoteTrackEvents(t,t._audioTrack)):(t._videoTrack?t._videoTrack._updateOriginMediaStreamTrack(p):(t._videoTrack=new Cc(p,t.uid,t._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(t._videoTrack.getTrackId()))),E&&t._videoTrack._updateRtpTransceiver(E),this.bindRemoteTrackEvents(t,t._videoTrack));const y=this.remoteUserMap.get(t);y?y.set(n,v):this.remoteUserMap.set(t,new Map([[n,v]])),this.statsCollector.addRemoteStats(t.uid),this.statsUploader.startUploadInboundStats();const C=this.pendingRemoteTracks.findIndex(I=>{let{user:k,kind:G}=I;return k.uid===t.uid&&n===G});C!==-1&&(this.pendingRemoteTracks.splice(C,1),this.emit(Qe.MediaReconnectEnd,t.uid))}async massSubscribe(t){return this.massSubscribeNoLock(t)}async massSubscribeNoLock(t){if(!this.connection||this.state!==tn.Connected)throw new Te(z.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");t=t.filter(a=>{var l;let{user:u,mediaType:h}=a;return!((l=this.remoteUserMap.get(u))!==null&&l!==void 0&&l.has(h))});const n=await this.connection.batchReceive(t.map(a=>{let{user:l,mediaType:u,ssrcId:h,rtxSsrcId:p}=a;return{kind:u,ssrcMsg:[{ssrcId:h,rtx:p}],mslabel:String(l._uintid)}}));t.forEach((a,l)=>{let{user:u,mediaType:h}=a;const{track:p,id:v,transceiver:E}=n[l];h===je.AUDIO?(u._audioTrack?u._audioTrack._updateOriginMediaStreamTrack(p):(u._audioTrack=new is(p,u.uid,u._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(u._audioTrack.getTrackId()))),E&&u._audioTrack._updateRtpTransceiver(E),this.bindRemoteTrackEvents(u,u._audioTrack)):(u._videoTrack?u._videoTrack._updateOriginMediaStreamTrack(p):(u._videoTrack=new Cc(p,u.uid,u._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(u._videoTrack.getTrackId()))),E&&u._videoTrack._updateRtpTransceiver(E),this.bindRemoteTrackEvents(u,u._videoTrack));const y=this.remoteUserMap.get(u);y?y.set(h,v):this.remoteUserMap.set(u,new Map([[h,v]])),this.statsCollector.addRemoteStats(u.uid),this.statsUploader.startUploadInboundStats();const C=this.pendingRemoteTracks.findIndex(I=>{let{user:k,kind:G}=I;return k.uid===u.uid&&h===G});C!==-1&&(this.pendingRemoteTracks.splice(C,1),this.emit(Qe.MediaReconnectEnd,u.uid))})}async unsubscribe(t,n,a){const l=this.pendingRemoteTracks.filter(p=>{let{user:v,kind:E}=p;return n!==void 0?v.uid===t.uid&&n===E:v.uid===t.uid});if(l.forEach(p=>{const v=this.pendingRemoteTracks.indexOf(p);this.pendingRemoteTracks.splice(v,1)}),this.connection&&this.state===tn.Connected||a||l.forEach(p=>{let{kind:v}=p;var E;if(v===je.AUDIO)(E=t._audioTrack)===null||E===void 0||E._destroy(),t._audioTrack=void 0;else if(v===je.VIDEO){var y;(y=t._videoTrack)===null||y===void 0||y._destroy(),t._videoTrack=void 0}}),!this.connection||this.state!==tn.Connected)return;const u=this.filterTobeUnSubscribedTracks(t,n);if(u.length===0)return;await this.connection.stopReceiving(u.map(p=>{let[,{id:v}]=p;return v}));const h=this.createUnsubscribeMessage(u);return this.withdrawRemoteTracks(u),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),u.forEach(p=>{let[v,{kind:E}]=p;var y,C;if(E===je.VIDEO&&v._videoSSRC&&((y=this.connection)===null||y===void 0||y.setStatsRemoteVideoIsReady(v._videoSSRC,!1)),E===je.VIDEO)this.unbindRemoteTrackEvents(v._videoTrack),a||((C=v._videoTrack)===null||C===void 0||C._destroy(),v._videoTrack=void 0);else if(E===je.AUDIO){var I;this.unbindRemoteTrackEvents(v._audioTrack),!a&&((I=v._audioTrack)===null||I===void 0||I._destroy(),v._audioTrack=void 0)}}),h}async unsubscribeDataChannel(t,n){if(n.forEach(u=>{const h=this.pendingRemoteDataChannels.findIndex(p=>p.id===u.id);h!==-1&&this.pendingRemoteDataChannels.splice(h,1)}),!this.connection)return;const a=this.filterTobeUnSubscribedDataChannels(t,n);if(a.length===0)return;n.forEach(u=>{u._close()});const l=this.remoteDataChannelMap.get(t);return a.forEach(u=>{l&&l.delete(u.id)}),l&&l.size===0&&(this.remoteDataChannelMap.delete(t),await this.connection.stopDataChannels(t.uid)),a.map(u=>u.id)}async massUnsubscribe(t){return this.massUnsubscribeNoLock(t)}async massUnsubscribeNoLock(t){let n=[];for(const{user:u,mediaType:h}of t){const p=this.pendingRemoteTracks.filter(v=>{let{user:E,kind:y}=v;return h!==void 0?E.uid===u.uid&&h===y:E.uid===u.uid});p.forEach(v=>{const E=this.pendingRemoteTracks.indexOf(v);this.pendingRemoteTracks.splice(E,1)}),n=n.concat(p)}if(!this.connection||this.state!==tn.Connected)return void n.forEach(u=>{let{user:h,kind:p}=u;var v;if(p===je.AUDIO)(v=h._audioTrack)===null||v===void 0||v._destroy(),h._audioTrack=void 0;else if(p===je.VIDEO){var E;(E=h._videoTrack)===null||E===void 0||E._destroy(),h._videoTrack=void 0}});const a=ud(t).call(t,(u,h)=>{let{user:p,mediaType:v}=h;const E=this.filterTobeUnSubscribedTracks(p,v);return u.concat(E)},[]);if(a.length===0)return;await this.connection.stopReceiving(a.map(u=>{let[,{id:h}]=u;return h}));const l=this.createUnsubscribeAllMessage(a);return this.withdrawRemoteTracks(a),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),a.forEach(u=>{let[h,{kind:p}]=u;var v,E;if(p===je.VIDEO&&h._videoSSRC&&((v=this.connection)===null||v===void 0||v.setStatsRemoteVideoIsReady(h._videoSSRC,!1)),p===je.VIDEO)this.unbindRemoteTrackEvents(h._videoTrack),(E=h._videoTrack)===null||E===void 0||E._destroy(),h._videoTrack=void 0;else if(p===je.AUDIO){var y;this.unbindRemoteTrackEvents(h._audioTrack),(y=h._audioTrack)===null||y===void 0||y._destroy(),h._audioTrack=void 0}}),l}async muteRemote(t,n){if(!this.connection)return;const a=this.remoteUserMap.get(t);if(!a)return void L.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(t.uid,"."));if(!a.get(n))return void L.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(t.uid," media type ").concat(n,"."));const l=n===je.VIDEO?t._videoSSRC:t._audioSSRC;l!==void 0&&this.connection.setStatsRemoteVideoIsReady(l,!1)}async unmuteRemote(t,n){return this.unmuteRemoteNoLock(t,n)}async unmuteRemoteNoLock(t,n){if(!this.connection)return;const a=this.remoteUserMap.get(t);if(!a)return void L.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(t.uid,"."));a.get(n)||L.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(t.uid," media type ").concat(n,"."))}getAllTracks(t){const n=this.localTrackMap.get(Ie.LocalAudioTrack);if((n==null?void 0:n.track)instanceof dr){const a=n.track;return Array.from(this.localTrackMap.entries()).filter(l=>{let[u]=l;return u!==Ie.LocalAudioTrack}).filter(l=>{let[u]=l;return!(t&&u===Ie.LocalVideoLowTrack)}).map(l=>{let[,{track:u}]=l;return u}).concat(a.trackList)}return Array.from(this.localTrackMap.entries()).filter(a=>{let[l]=a;return!(t&&l===Ie.LocalVideoLowTrack)}).map(a=>{let[,{track:l}]=a;return l})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(t,n,a,l,u){if(t){const p=this.localTrackMap.get(Ie.LocalAudioTrack),v=l?this.localTrackMap.get(Ie.LocalVideoLowTrack):this.localTrackMap.get(Ie.LocalVideoTrack);We.publish(this.store.sessionId,{eventElapse:li.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:t,ec:n,audioName:p==null?void 0:p.track.getTrackLabel(),videoName:v==null?void 0:v.track.getTrackLabel(),screenshare:(v==null?void 0:v.track._hints.indexOf(mn.SCREEN_TRACK))!==-1,audio:!!p,video:!!v,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:u})}else{var h;a||(a=[]);const p=a.find(E=>E instanceof Xt),v=l?(h=this.localTrackMap.get(Ie.LocalVideoTrack))===null||h===void 0?void 0:h.track:a.find(E=>E instanceof Rt);We.publish(this.store.sessionId,{eventElapse:li.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:t,ec:n,audioName:p==null?void 0:p.getTrackLabel(),videoName:v==null?void 0:v.getTrackLabel(),screenshare:(v==null?void 0:v._hints.indexOf(mn.SCREEN_TRACK))!==-1,audio:!!p,video:!!v,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:u})}}reportSubscribeEvent(t,n,a,l){const u=l===je.VIDEO?a._videoSSRC:a._audioSSRC;u&&We.subscribe(this.store.sessionId,{succ:t,ec:n,video:l===je.VIDEO,audio:l===je.AUDIO,peerid:a.uid,subscribeRequestid:l===je.VIDEO?a._videoSSRC:a._audioSSRC,p2pid:this.store.p2pId,eventElapse:li.measureFromSubscribeStart(this.store.clientId,u)})}reset(){L.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new Ur("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new wr({},this.store):this.isPlanB?new Vr({},this.store):new $n({},this.store),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const t=this.localTrackMap.get(Ie.LocalAudioTrack);if((t==null?void 0:t.track)instanceof dr){if(t.track.trackList.length>0){const n=t.track;t.track.trackList.forEach(a=>{n.removeAudioTrack(a)})}t.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=tn.Disconnected}getStats(){var t;return(t=this.connection)===null||t===void 0?void 0:t.getStats()}getRemoteVideoIsReady(t){var n;return((n=this.connection)===null||n===void 0?void 0:n.getRemoteVideoIsReady(t))||!1}getLocalAudioVolume(){const t=this.localTrackMap.get(Ie.LocalAudioTrack);if(t)return t.track.getVolumeLevel()}getLocalVideoSize(){const t=this.localTrackMap.get(Ie.LocalVideoTrack);if(t)return{width:t.track._videoWidth||0,height:t.track._videoHeight||0}}getEncoderConfig(t){const n=this.localTrackMap.get(t);return n&&n.track instanceof Rt||n&&n.track instanceof Xt?n.track._encoderConfig:void 0}getLocalMedia(t){return this.localTrackMap.get(t)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(t,n){if(!t)return this.remoteUserMap.size>0;const a=this.remoteUserMap.get(t);return!!a&&(!n||a.has(n))}async hasRemoteMediaWithLock(t,n){if(!t)return this.remoteUserMap.size>0;const a=this.remoteUserMap.get(t);return!!a&&(!n||a.has(n))}getRemoteMedia(t){var n;const a=Array.from(zo(n=this.remoteUserMap).call(n)).find(l=>l.uid===t);return a?{audioTrack:a.audioTrack,audioSSRC:a._audioSSRC,videoTrack:a.videoTrack,videoSSRC:a._videoSSRC}:{}}getAudioLevels(){let t=Array.from(this.remoteUserMap.entries()).map(a=>{let[l]=a;return{uid:l.uid,level:l.audioTrack?100*l.audioTrack._source.getAccurateVolumeLevel():0}});const n=this.localTrackMap.get(Ie.LocalAudioTrack);return n&&t.push({level:100*n.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),t=zf(t).call(t,(a,l)=>a.level-l.level),t}async disconnectForReconnect(){this.connection&&(L.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=tn.Reconnecting,J("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(t=>{let[n]=t;var a;n._videoTrack&&n._videoTrack._player&&((a=n._videoTrack._player.getVideoElement())===null||a===void 0||a.pause(),n._videoTrack._player.isKeepLastFrame=!0,n._videoTrack._originMediaStreamTrack.stop())}),this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new wr({},this.store):this.isPlanB?new Vr({},this.store):new $n({},this.store),this.bindConnectionEvents(this.connection)),this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(t=>{var n;let[a,{track:l}]=t;switch(a){case Ie.LocalVideoTrack:Be(n=l._hints).call(n,mn.LOW_STREAM)?l.close():this.pendingLocalTracks.push(l);break;case Ie.LocalAudioTrack:l instanceof dr?this.pendingLocalTracks=this.pendingLocalTracks.concat(l.trackList):this.pendingLocalTracks.push(l);case Ie.LocalVideoLowTrack:}}),this.emit(Qe.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(t=>{let[n,a]=t;Array.from(zo(a).call(a)).forEach(l=>{this.setPendingRemoteMedia(n,l)}),this.emit(Qe.MediaReconnectStart,n.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.localDataChannels.length!==0&&(this.localDataChannels.forEach(t=>{this.pendingLocalDataChannels.push(t)}),this.localDataChannels.length=0),this.remoteDataChannelMap.size!==0&&(Array.from(this.remoteDataChannelMap.entries()).forEach(t=>{let[n,a]=t;Array.from(zo(a).call(a)).forEach(l=>{this.setPendingRemoteDataChannel(n,l)})}),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),L.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(t,n){for(const a of this.pendingRemoteDataChannels){const{user:l,id:u}=a;if((t instanceof Kr?t.uid:t)===l.uid&&u===n)return!0}return!1}setPendingRemoteDataChannel(t,n){this.hasPendingRemoteDataChannel(t,n)||this.pendingRemoteDataChannels.push({user:t,id:n})}hasPendingRemoteMedia(t,n){for(const a of this.pendingRemoteTracks){const{user:l,kind:u}=a;if((t instanceof Kr?t.uid:t)===l.uid&&n===u)return!0}return!1}setPendingRemoteMedia(t,n){this.hasPendingRemoteMedia(t,n)||this.pendingRemoteTracks.push({user:t,kind:n})}restartICE(t){var n=this;return Do(function*(){if(!n.connection||n.state!==tn.Connected||n.connection instanceof wr)return;const a=yield _t(n.mutex.lock("From P2PChannel.restartICE"));let l;try{l=yield _t(n.connection.restartICE(t));const h=yield _t(l.next());if(h.done)return;const p=h.value,v=yield p;switch(n.reportPCDisconnectedOrFailed(t),t){case si.TCP:n._pcStatsUploadType=Ms.TCP_RESTART;break;case si.RELAY:n._pcStatsUploadType=Ms.RELAY_RESTART;break;default:n._pcStatsUploadType=Ms.OLD_RESTART}n._isInRestartIce=!0,l.next(v)}catch(h){var u;(u=l)===null||u===void 0||u.throw(h)}finally{a()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const t=this.connection.getStats(),n=this.localTrackMap.get(Ie.LocalVideoTrack),a=this.localTrackMap.get(Ie.LocalAudioTrack),l=t.videoSend.find(G=>G.ssrc===(n==null?void 0:n.ssrcs[0].ssrcId)),u=t.audioSend.find(G=>G.ssrc===(a==null?void 0:a.ssrcs[0].ssrcId));if(!l||!u)return 1;const h=No(this,Qe.NeedSignalRTT),p=l?l.rttMs:void 0,v=u?u.rttMs:void 0,E=p&&v?(p+v)/2:p||v,y=(E&&h?(E+h)/2:E||h)||0,C=100*t.sendPacketLossRate*.7/50+.3*y/1500,I=C<.17?1:C<.36?2:C<.59?3:C<.1?4:5,k=n==null?void 0:n.track;if(k&&k._encoderConfig&&k._hints.indexOf(mn.SCREEN_TRACK)===-1){const G=k._encoderConfig.bitrateMax,B=t.bitrate.actualEncoded;if(G&&B){const j=(1e3*G-B)/(1e3*G);return iM[j<.15?0:j<.3?1:j<.45?2:j<.6?3:4][I]}}return I}getDownlinkNetworkQuality(){if(!this.connection)return 0;const t=this.connection.getStats();let n=0;return Array.from(this.remoteUserMap.entries()).forEach(a=>{let[l]=a;const u=l._audioSSRC,h=l._videoSSRC,p=t.audioRecv.find(B=>B.ssrc===u),v=t.videoRecv.find(B=>B.ssrc===h);if(!p&&!v)return void(n+=1);const E=No(this,Qe.NeedSignalRTT),y=t.rtt,C=(y&&E?(y+E)/2:y||E)||0,I=p?p.jitterMs:void 0,k=t.recvPacketLossRate;let G=.7*k*100/50+.3*C/1500;I&&(G=.6*k*100/50+.2*C/1500+.2*I/400),n+=G<.1?1:G<.17?2:G<.36?3:G<.59?4:5}),this.remoteUserMap.size>0?Math.round(n/this.remoteUserMap.size):n}async muteLocalTrack(t){return new _e((n,a)=>{this.handleMuteLocalTrack(t,n,a)})}filterTobePublishedTracks(t,n,a){const l=[],u=cn(),h=this.getAllTracks();t=Lh(t=t.filter(E=>h.indexOf(E)===-1));let p=!1,v=!1;for(const E of t){if(E instanceof Rt&&(this.localTrackMap.has(Ie.LocalVideoTrack)||p?new Te(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(l.push({track:E,type:Ie.LocalVideoTrack}),p=!0),n)){const y=this.getLowVideoTrack(E,a);l.push({track:y,type:Ie.LocalVideoLowTrack})}if(E instanceof Xt){const y=this.localTrackMap.get(Ie.LocalAudioTrack);if(y){if(!(y.track instanceof dr))throw new Te(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(E._bypassWebAudio)throw new Te(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");y.track.addAudioTrack(E),this.bindLocalAudioTrackEvents(E,!0)}else if(v){const C=l.find(I=>{let{type:k}=I;return k===Ie.LocalAudioTrack});if(!(C.track instanceof dr))throw new Te(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(E._bypassWebAudio)throw new Te(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");C.track.addAudioTrack(E)}else{if(!u.webAudioMediaStreamDest||E instanceof dr||E._bypassWebAudio)l.push({track:E,type:Ie.LocalAudioTrack});else{const C=new dr;C.addAudioTrack(E),l.push({track:C,type:Ie.LocalAudioTrack})}v=!0}}}return l}filterTobeUnpublishedTracks(t){const n=[],a=this.getAllTracks();t=Lh(t=t.filter(l=>a.indexOf(l)!==-1));for(const l of t){if(l instanceof Xt){const u=this.localTrackMap.get(Ie.LocalAudioTrack);if(!u)continue;u.track instanceof dr?(u.track.removeAudioTrack(l),this.unbindLocalAudioTrackEvents(l),u.track.trackList.length===0&&(n.push([Ie.LocalAudioTrack,u]),u.track.close())):n.push([Ie.LocalAudioTrack,u])}if(l instanceof Rt){const u=this.localTrackMap.get(Ie.LocalVideoTrack);if(!u)continue;n.push([Ie.LocalVideoTrack,u]);const h=this.localTrackMap.get(Ie.LocalVideoLowTrack);h&&n.push([Ie.LocalVideoLowTrack,h])}}return n}filterTobePublishedDataChannels(t){return t=(t=Lh(t)).filter(n=>this.localDataChannels.findIndex(a=>a.id===n.id)===-1)}filterTobeUnpublishedDataChannels(t){return t=(t=(t=Lh(t)).filter(n=>this.localDataChannels.indexOf(n)!==-1)).filter(n=>n._originDataChannel)}bindLocalTrackEvents(t){t.forEach(n=>{let{track:a,type:l}=n;switch(l){case Ie.LocalVideoTrack:a.addListener(Fe.GET_STATS,this.handleGetLocalVideoStats),a.addListener(Fe.GET_RTC_STATS,this.handleGetRTCStats),a.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.addListener(Fe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),a.addListener(Fe.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),a.addListener(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),a.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ie.LocalAudioTrack:this.bindLocalAudioTrackEvents(a);case Ie.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(t,n){t instanceof dr?t.trackList.forEach(a=>{a.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.addListener(Fe.GET_STATS,this.handleGetLocalAudioStats),a.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(t.addListener(Fe.GET_STATS,this.handleGetLocalAudioStats),t.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),n||t.addListener(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(t){t||(t=Array.from(this.localTrackMap.entries()).map(n=>{let[a,{track:l}]=n;return{track:l,type:a}})),t.forEach(n=>{let{track:a,type:l}=n;switch(l){case Ie.LocalVideoTrack:a.off(Fe.GET_STATS,this.handleGetLocalVideoStats),a.off(Fe.GET_RTC_STATS,this.handleGetRTCStats),a.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.off(Fe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),a.off(Fe.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),a.off(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),a.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ie.LocalAudioTrack:this.unbindLocalAudioTrackEvents(a);case Ie.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(t){t instanceof dr?t.trackList.forEach(n=>{n.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.off(Fe.GET_STATS,this.handleGetLocalAudioStats),n.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(t.off(Fe.GET_STATS,this.handleGetLocalAudioStats),t.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(t,n){n instanceof Cc&&n.addListener(Fe.GET_STATS,a=>{a(this.handleGetRemoteVideoStats(t))}),n instanceof is&&n.addListener(Fe.GET_STATS,a=>{a(this.handleGetRemoteAudioStats(t))})}unbindRemoteTrackEvents(t){t&&t.removeAllListeners(Fe.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(t=>{let[n,a]=t;a.has(je.AUDIO)&&this.unbindRemoteTrackEvents(n._audioTrack),a.has(je.VIDEO)&&this.unbindRemoteTrackEvents(n._videoTrack)})}createGatewayPublishMessage(t,n){return t.map((a,l)=>{var u;let h,p,{track:v,type:E}=a;switch(E){case Ie.LocalAudioTrack:h=Kt.Audio,p={dtx:v instanceof _d&&v._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case Ie.LocalVideoTrack:h=Be(u=v._hints).call(u,mn.SCREEN_TRACK)?Kt.Screen:Kt.High,p=fu(fu({},RM(v)),{},{codec:this.store.codec});break;case Ie.LocalVideoLowTrack:h=Kt.Low,p=fu(fu({},RM(v)),{},{codec:this.store.codec})}return{stream_type:h,attributes:p,ssrcs:n[l]}})}createGatewayUnpublishMessage(t){return t.map(n=>{var a;let l,[u,{track:h,ssrcs:p,id:v}]=n;switch(u){case Ie.LocalVideoTrack:l=Be(a=h._hints).call(a,mn.SCREEN_TRACK)?Kt.Screen:Kt.High;break;case Ie.LocalAudioTrack:l=Kt.Audio;break;case Ie.LocalVideoLowTrack:l=Kt.Low}return{stream_type:l,ssrcs:p,mid:v}})}assignLocalTracks(t,n){t.forEach((a,l)=>{let{track:u,type:h}=a;this.localTrackMap.set(h,{track:u,id:n[l].id,ssrcs:n[l].localSSRC})})}withdrawLocalTracks(t){t.forEach(n=>{let[a]=n;this.localTrackMap.delete(a)})}bindConnectionEvents(t){t.onConnectionStateChange=async n=>{if(L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(n,")")),this.emit(Qe.PeerConnectionStateChange,n),n!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),n==="connected"&&(this._restartTimer&&(clearTimeout(this._restartTimer),this._restartTimer=void 0),(this._isFirstConnected||this._isInRestartIce)&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isInRestartIce=!1,this._isFirstConnected=!1,this._isStartRestartIce=!1),J("NEW_ICE_RESTART")){var a;if(Be(a=this._restartStates).call(a,n)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const l=p=>{(t.iceConnectionState==="disconnected"||t.iceConnectionState==="checking"||t.iceConnectionState==="failed")&&(L.debug("[".concat(this.store.clientId,"] [P2PChannel] start use restartICE, type is ").concat(p)),No(this,Qe.QueryClientConnectionState)==="CONNECTED"&&this.emit(Qe.RequestRestartICE,p))},u=()=>{t.iceConnectionState!=="disconnected"&&t.iceConnectionState!=="checking"&&t.iceConnectionState!=="failed"||(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),L.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(Qe.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},h=J("ICE_RESTART_INTERVAL");return void(this._restartTimer=window.setTimeout(()=>{if(J("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&cn().supportPCSetConfiguration)l(si.RELAY),this._restartTimer=window.setTimeout(u,h);else if(un())l(si.UDP),this._restartTimer=window.setTimeout(u,4e3);else{if(l(si.TCP),cn().supportPCSetConfiguration)return void(this._restartTimer=window.setTimeout(()=>{l(si.RELAY),this._restartTimer=window.setTimeout(u,h)},h));this._restartTimer=window.setTimeout(u,h)}},800))}}else{if(n==="disconnected"&&t.iceConnectionState==="disconnected")return setTimeout(()=>{t.iceConnectionState==="disconnected"&&J("ICE_RESTART")&&No(this,Qe.QueryClientConnectionState)==="CONNECTED"&&this.emit(Qe.RequestRestartICE)},800),void setTimeout(()=>{t.peerConnectionState==="disconnected"&&(L.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isInRestartIce=!1,setTimeout(()=>this.emit(Qe.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);n==="failed"&&(L.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCDisconnectedOrFailed(),setTimeout(()=>this.emit(Qe.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},t.onICEConnectionStateChange=n=>{n!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(n,")")),We.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:n,tag:Pn.TRACER}).onSuccess(),this.emit(Qe.IceConnectionStateChange,n)},t.onICETransportStateChange=n=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(n,")"))},t.onDTLSTransportStateChange=n=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(n,")"))},t.onDTLSTransportError=n=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(n,")"))},t.onFirstAudioDecoded=n=>{var a;const l=Array.from(zo(a=this.remoteUserMap).call(a)).find(h=>h._audioSSRC===n);var u;l&&(this.store.subscribe(l.uid,"audio",void 0,void 0,void 0,Date.now()),(u=l.audioTrack)===null||u===void 0||u.emit(gd.FIRST_FRAME_DECODED),We.firstRemoteFrame(this.store.sessionId,Cr.FIRST_AUDIO_DECODE,yn.FIRST_AUDIO_DECODE,{peer:l._uintid,subscribeElapse:li.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId}))},t.onFirstAudioReceived=n=>{var a;const l=Array.from(zo(a=this.remoteUserMap).call(a)).find(u=>u._audioSSRC===n);l&&We.firstRemoteFrame(this.store.sessionId,Cr.FIRST_AUDIO_RECEIVED,yn.FIRST_AUDIO_RECEIVED,{peer:l._uintid,subscribeElapse:li.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId})},t.onFirstVideoDecoded=(n,a,l)=>{this.reportVideoFirstFrameDecoded(n,a,l)},t.onFirstVideoReceived=n=>{var a;const l=Array.from(zo(a=this.remoteUserMap).call(a)).find(u=>u._videoSSRC===n);l&&We.firstRemoteFrame(this.store.sessionId,Cr.FIRST_VIDEO_RECEIVED,yn.FIRST_VIDEO_RECEIVED,{peer:l._uintid,subscribeElapse:li.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId})},t.onSelectedLocalCandidateChanged=(n,a)=>{const l=n.candidateType==="relay",u=a.candidateType==="relay";a.candidateType!=="unknown"&&l===u||this.emit(Qe.ConnectionTypeChange,l),L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(tu(a))," -> ").concat(JSON.stringify(tu(n)),")"))},t.onSelectedRemoteCandidateChanged=(n,a)=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(tu(a))," -> ").concat(JSON.stringify(tu(n)),")"))},t.onFirstVideoDecodedTimeout=n=>{this.reportVideoFirstFrameDecoded(n,void 0,void 0,!0)}}unbindConnectionEvents(t){t.onConnectionStateChange=void 0,t.onICEConnectionStateChange=void 0,t.onICETransportStateChange=void 0,t.onDTLSTransportStateChange=void 0,t.onDTLSTransportError=void 0,t.onFirstAudioDecoded=void 0,t.onFirstAudioReceived=void 0,t.onFirstVideoDecoded=void 0,t.onFirstVideoReceived=void 0,t.onSelectedLocalCandidateChanged=void 0,t.onSelectedRemoteCandidateChanged=void 0,t.onFirstVideoDecodedTimeout=void 0}filterTobeMutedTracks(t){const n=[];if(this.getAllTracks().indexOf(t)===-1)return n;const a=this.localTrackMap.get(Ie.LocalAudioTrack);if(t instanceof Xt&&(a==null?void 0:a.track)instanceof dr)return a.track.isActive||n.push([Ie.LocalAudioTrack,a]),n;const l=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:h}]=u;return t===h});if(l&&(n.push(l),l[0]===Ie.LocalVideoTrack)){const u=this.localTrackMap.get(Ie.LocalVideoLowTrack);u&&n.push([Ie.LocalVideoLowTrack,u])}return n}filterTobeUnmutedTracks(t){const n=[],a=this.localTrackMap.get(Ie.LocalAudioTrack);if(t instanceof Xt&&(a==null?void 0:a.track)instanceof dr)return a.track.isActive&&n.push([Ie.LocalAudioTrack,a]),n;const l=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:h}]=u;return t===h});if(l)if(l[0]===Ie.LocalVideoTrack){n.push(l);const u=this.localTrackMap.get(Ie.LocalVideoLowTrack);u&&n.push([Ie.LocalVideoLowTrack,u])}else n.push(l);return n}createMuteMessage(t){return t.map(n=>{var a;let l,[u,{track:h,ssrcs:p,id:v}]=n;switch(u){case Ie.LocalAudioTrack:l=Kt.Audio;break;case Ie.LocalVideoTrack:l=Be(a=h._hints).call(a,mn.SCREEN_TRACK)?Kt.Screen:Kt.High;break;case Ie.LocalVideoLowTrack:l=Kt.Low}return{stream_type:l,ssrcs:p,mid:v}})}createUnmuteMessage(t){return t.map(n=>{var a;let l,[u,{track:h,ssrcs:p,id:v}]=n;switch(u){case Ie.LocalAudioTrack:l=Kt.Audio;break;case Ie.LocalVideoTrack:l=Be(a=h._hints).call(a,mn.SCREEN_TRACK)?Kt.Screen:Kt.High;break;case Ie.LocalVideoLowTrack:l=Kt.Low}return{stream_type:l,ssrcs:p,mid:v}})}filterTobeUnSubscribedTracks(t,n){const a=[],l=this.remoteUserMap.get(t);if(!l)return a;if(n){const u=l.get(n);if(!u)return a;a.push([t,{kind:n,id:u}])}else Array.from(l.entries()).forEach(u=>{let[h,p]=u;a.push([t,{kind:h,id:p}])});return a}filterTobeUnSubscribedDataChannels(t,n){const a=[];return n.forEach(l=>{var u;(u=this.remoteDataChannelMap.get(t))!==null&&u!==void 0&&u.has(l.id)&&a.push(l)}),a}createUnsubscribeMessage(t){const n=[];return t.forEach(a=>{let[l,{kind:u,id:h}]=a;switch(u){case je.VIDEO:return void(l._videoSSRC&&n.push({stream_type:je.VIDEO,ssrcId:l._videoSSRC}));case je.AUDIO:return void(l._audioSSRC&&n.push({stream_type:je.AUDIO,ssrcId:l._audioSSRC}))}}),n}createUnsubscribeAllMessage(t){const n=new Map;return t.forEach(a=>{let[l,{kind:u}]=a;if(n.has(l)){let h=n.get(l);u===je.VIDEO?h|=vr.Video:h|=vr.Audio,n.set(l,h)}else u===je.VIDEO?n.set(l,vr.Video):n.set(l,vr.Audio)}),{users:Array.from(n.entries()).map(a=>{let[l,u]=a;return{stream_id:l.uid,stream_type:u}})}}withdrawRemoteTracks(t){t.forEach(n=>{let[a,{kind:l}]=n;const u=this.remoteUserMap.get(a);u&&(u.delete(l),Array.from(u.entries()).length===0&&this.remoteUserMap.delete(a))})}async updateBitrateLimit(t){const n=this.localTrackMap.get(Ie.LocalVideoTrack),a=this.localTrackMap.get(Ie.LocalVideoLowTrack);n&&await n.track.setBitrateLimit(t.uplink),a&&t.low_stream_uplink&&await a.track.setBitrateLimit({max_bitrate:t.low_stream_uplink.bitrate,min_bitrate:t.low_stream_uplink.bitrate||0})}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}mapPubResToRemoteConfig(t,n){return t.map((a,l)=>{var u;let{stream_type:h}=a;return(u=n.find(p=>{let{stream_type:v}=p;return h===v}))===null||u===void 0?void 0:u.attributes})}async tryToUnmuteAudio(t){for(let a=0;a<t.length;a++)if(t[a]instanceof Xt){var n;const l=this.filterTobeUnmutedTracks(t[a]);if(l.length===0)continue;await((n=this.connection)===null||n===void 0?void 0:n.unmuteLocal(l.map(h=>{let[,{id:p}]=h;return p})));const u=this.createUnmuteMessage(l);return void await hn(this,Qe.RequestUnmuteLocal,u)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=t=>{var n;return!((n=this.connection)===null||n===void 0||!n.getRemoteVideoIsReady(t))},this.statsUploader.requestUpload=(t,n)=>this.emit(Qe.RequestUpload,t,n),this.statsUploader.requestUploadStats=t=>this.emit(Qe.RequestUploadStats,t),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Fr(Cv(this.dtlsFailedCount,ur)),this.emit(Qe.RequestReconnect)}async reconnectP2P(){const t=Array.from(this.localTrackMap.entries()),n=this.createGatewayUnpublishMessage(t);Array.from(this.remoteUserMap.entries()),n.length>0&&await cr(this,Qe.RequestUnpublishForReconnectPC,n),this.disconnectForReconnect(),this.emit(Qe.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(Ie.LocalVideoTrack)||this.pendingLocalTracks.some(t=>t instanceof Rt)}throwIfTrackTypeNotMatch(t){if(t.filter(n=>n instanceof Rt).length>1)throw new Te(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t.filter(n=>n instanceof Xt).length>1&&(t.some(n=>n instanceof Xt&&n._bypassWebAudio)||!cn().webAudioMediaStreamDest))throw new Te(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const n of t){if(n instanceof Rt&&this.pendingLocalTracks.some(a=>a instanceof Rt))throw new Te(z.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(n instanceof Xt&&this.pendingLocalTracks.some(a=>a instanceof Xt)&&(!cn().webAudioMediaStreamDest||n._bypassWebAudio||this.pendingLocalTracks.some(a=>a instanceof Xt&&a._bypassWebAudio)))throw new Te(z.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(t,n){const a=!J("DISABLE_DUAL_STREAM_USE_ENCODING")&&cn().supportDualStreamEncoding,l=fu(fu({},{width:160,height:120,framerate:15,bitrate:50}),n);let u;u=a?t._mediaStreamTrack.clone():FR(t,l);const h=pn(8,"track-low-"),p=new Rt(u,fu(fu({},a&&{scaleResolutionDownBy:PT(l,t)}),{},{frameRate:l.framerate,bitrateMax:l.bitrate,bitrateMin:l.bitrate}),void 0,void 0,h);return p.on(Yh.TRANSCEIVER_UPDATED,v=>{t._updateRtpTransceiver(v,nu.LOW_STREAM)}),p._hints.push(mn.LOW_STREAM),t.addListener(Fe.NEED_CLOSE,()=>{p.close()}),p}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(t,n,a){let l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(this.connection&&this.connection instanceof $n){var u,h,p,v;const E=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:y,dtlsTransportState:C,peerConnectionState:I}=this.connection,{local:k,remote:G}=await this.connection.getSelectedCandidatePair();We.pcStats(this.store.sessionId,{startTime:E,eventElapse:t-E||0,iceconnectionsate:y,dtlsstate:C,connectionstate:I,intSucc:n?1:2,error:l,selectedLocalCandidateProtocol:(u=k==null?void 0:k.protocol)!==null&&u!==void 0?u:"",selectedLocalCandidateType:(h=k.candidateType)!==null&&h!==void 0?h:"",selectedLocalCandidateAddress:"".concat(k.address,":").concat(k.port),selectedRemoteCandidateProtocol:(p=G.protocol)!==null&&p!==void 0?p:"",selectedRemoteCandidateType:(v=G.candidateType)!==null&&v!==void 0?v:"",selectedRemoteCandidateAddress:"".concat(G.address,":").concat(G.port),restartCnt:a})}}reportVideoFirstFrameDecoded(t,n,a,l){var u;const h=Array.from(zo(u=this.remoteUserMap).call(u)).find(p=>p._videoSSRC===t);if(h){l||this.store.subscribe(h.uid,"video",void 0,void 0,void 0,void 0,Date.now());const p=this.store.keyMetrics,v=p.subscribe.find(E=>E.userId===h.uid&&E.type==="video");We.firstRemoteVideoDecode(this.store.sessionId,Cr.FIRST_VIDEO_DECODE,yn.FIRST_VIDEO_DECODE,{peer:h._uintid,videowidth:n,videoheight:a,subscribeElapse:li.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId,apEnd:p.requestAPEnd||0,apStart:p.requestAPStart||0,joinGwEnd:p.joinGatewayEnd||0,joinGwStart:p.joinGatewayStart||0,pcEnd:p.peerConnectionEnd||0,pcStart:p.peerConnectionStart||0,subscriberEnd:(v==null?void 0:v.subscribeEnd)||0,subscriberStart:(v==null?void 0:v.subscribeStart)||0,videoAddNotify:(v==null?void 0:v.streamAdded)||0,state:l?1:0})}}async remoteMediaSsrcChanged(t,n,a){if(!this.connection)return!1;const l=this.remoteUserMap.get(t);if(!l)return!1;const u=l.get(n);if(!u)return!1;const h=await this.connection.getRemoteSSRC(u);return h!==void 0&&h!==a}resetConnection(t){L.debug("[".concat(this.store.clientId,"] [P2PChannel] reset connection to ").concat(t)),this.state===tn.Connected?(L.debug("[".concat(this.store.clientId,"] [P2PChannel] fallback to websocket but P2PChannel state still connected, disconnect first")),this.disconnectForReconnect()):(this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=t===kv.datachannel?new wr({},this.store):this.isPlanB?new Vr({},this.store):new $n({},this.store),this.bindConnectionEvents(this.connection)))}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(t=>{let[n,{track:a}]=t;n===Ie.LocalVideoLowTrack?a._updateRtpTransceiver(void 0,nu.LOW_STREAM):a._updateRtpTransceiver(void 0)})}reportPCDisconnectedOrFailed(t){this.connection&&this.connection instanceof $n&&(this.connection.iceConnectionState!=="disconnected"&&this.connection.iceConnectionState!=="checking"&&this.connection.iceConnectionState!=="failed"||(this._isFirstConnected?(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isFirstConnected=!1):this._pcStatsUploadType===Ms.TCP_RESTART&&t===si.RELAY?this.reportPCStats(Date.now(),!1,this._pcStatsUploadType):this.reportPCStats(Date.now(),!1,Ms.DISCONNECTED_OR_FAILED)))}}function Ci(i,t,n){const a=i[t];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return n.value=async function(){const l=this.mutex,u=await l.lock("From P2PChannel.".concat(t));try{for(var h=arguments.length,p=new Array(h),v=0;v<h;v++)p[v]=arguments[v];return await a.apply(this,p)}finally{u()}},n}function Jne(i){let t=c4();return function(n,a){let l=n.appId;l!==void 0&&(en(a,10),Ac(a,l));let u=n.cid;u!==void 0&&(en(a,16),en(a,u));let h=n.cname;h!==void 0&&(en(a,26),Ac(a,h));let p=n.deviceId;p!==void 0&&(en(a,34),Ac(a,p));let v=n.elapse;v!==void 0&&(en(a,40),mu(a,v));let E=n.fileSize;E!==void 0&&(en(a,48),mu(a,cp(E)));let y=n.height;y!==void 0&&(en(a,56),mu(a,cp(y)));let C=n.jpg;C!==void 0&&(en(a,66),en(a,C.length),function(Lo,we){let Pe=lp(Lo,we.length);Lo.bytes.set(we,Pe)}(a,C));let I=n.networkType;I!==void 0&&(en(a,72),mu(a,cp(I)));let k=n.osType;k!==void 0&&(en(a,80),mu(a,cp(k)));let G=n.requestId;G!==void 0&&(en(a,90),Ac(a,G));let B=n.sdkVersion;B!==void 0&&(en(a,98),Ac(a,B));let j=n.sequence;j!==void 0&&(en(a,104),mu(a,cp(j)));let q=n.sid;q!==void 0&&(en(a,114),Ac(a,q));let Z=n.timestamp;Z!==void 0&&(en(a,120),mu(a,Z));let re=n.uid;re!==void 0&&(en(a,128),en(a,re));let Ce=n.vid;Ce!==void 0&&(en(a,136),en(a,Ce));let pe=n.width;pe!==void 0&&(en(a,144),mu(a,cp(pe)));let fe=n.service;fe!==void 0&&(en(a,152),en(a,fe));let ye=n.callbackData;ye!==void 0&&(en(a,162),Ac(a,ye));let Ee=n.jpgEncryption;Ee!==void 0&&(en(a,168),en(a,Ee));let Ae=n.requestType;Ae!==void 0&&(en(a,176),en(a,Ae));let Ne=n.scorePorn;Ne!==void 0&&(en(a,185),zR(a,Ne));let it=n.scoreSexy;it!==void 0&&(en(a,193),zR(a,it));let yt=n.scoreNeutral;yt!==void 0&&(en(a,201),zR(a,yt));let gn=n.scene;gn!==void 0&&(en(a,208),en(a,gn));let Er=n.ossFilePrefix;Er!==void 0&&(en(a,218),Ac(a,Er));let Sn=n.serviceVendor;if(Sn!==void 0)for(let Lo of Sn){en(a,226);let we=c4();ere(Lo,we),en(a,we.limit),ire(a,we),rre(we)}}(i,t),function(n){let a=n.bytes,l=n.limit;return a.length===l?a:a.subarray(0,l)}(t)}function Qne(i){return function(n){let a={};e:for(;!l4(n);){let l=Oc(n);switch(l>>>3){case 0:break e;case 1:a.code=Oc(n);break;case 2:a.msg=u4(n,Oc(n));break;case 3:{let u=tre(n);a.data=Zne(n),n.limit=u;break}default:a4(n,7&l)}}return a}({bytes:t=i,offset:0,limit:t.length});var t}function Zne(i){let t={};e:for(;!l4(i);){let n=Oc(i);switch(n>>>3){case 0:break e;case 1:t.requestId=u4(i,Oc(i));break;case 2:t.requestType=Oc(i)>>>0;break;case 3:t.scorePorn=GR(i);break;case 4:t.scoreSexy=GR(i);break;case 5:t.scoreNeutral=GR(i);break;case 6:t.requestScene=Oc(i)>>>0;break;case 7:t.scene=Oc(i)>>>0;break;default:a4(i,7&n)}}return t}function ere(i,t){let n=i.service;n!==void 0&&(en(t,8),en(t,n));let a=i.vendor;a!==void 0&&(en(t,16),en(t,a));let l=i.token;l!==void 0&&(en(t,26),Ac(t,l));let u=i.callbackUrl;u!==void 0&&(en(t,34),Ac(t,u))}function tre(i){let t=Oc(i),n=i.limit;return i.limit=i.offset+t,n}function a4(i,t){switch(t){case 0:for(;128&d4(i););break;case 2:HR(i,Oc(i));break;case 5:HR(i,4);break;case 1:HR(i,8);break;default:throw new Error("Unimplemented type: "+t)}}Re([Ci,H("design:type",Function),H("design:paramtypes",[Object,Boolean]),H("design:returntype",_e)],$r.prototype,"startP2PConnection",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[Object,Object,Array,Object,String,String]),H("design:returntype",_e)],$r.prototype,"connect",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",void 0)],$r.prototype,"updateRemoteRTPCapabilities",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[Object,Object,Array,Object,String,String]),H("design:returntype",_e)],$r.prototype,"preConnect",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],$r.prototype,"publishDataChannel",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],$r.prototype,"unpublish",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],$r.prototype,"unpublishDataChannel",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",_e)],$r.prototype,"unpublishLowStream",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[Kr,Array]),H("design:returntype",_e)],$r.prototype,"subscribeDataChannel",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[Kr,String,Number,Number,Array]),H("design:returntype",_e)],$r.prototype,"subscribe",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],$r.prototype,"massSubscribe",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[Kr,String,Boolean]),H("design:returntype",_e)],$r.prototype,"unsubscribe",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[Kr,Array]),H("design:returntype",_e)],$r.prototype,"unsubscribeDataChannel",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],$r.prototype,"massUnsubscribe",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[Kr,String]),H("design:returntype",_e)],$r.prototype,"muteRemote",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[Kr,String]),H("design:returntype",_e)],$r.prototype,"unmuteRemote",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[Kr,String]),H("design:returntype",_e)],$r.prototype,"hasRemoteMediaWithLock",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",_e)],$r.prototype,"disconnectForReconnect",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",_e)],$r.prototype,"updateBitrateLimit",null),Re([Ci,H("design:type",Function),H("design:paramtypes",[Kr,String,Number]),H("design:returntype",_e)],$r.prototype,"remoteMediaSsrcChanged",null);let nre=new Float32Array(1);new Uint8Array(nre.buffer);let $R=new Float64Array(1),_o=new Uint8Array($R.buffer);function cp(i){return{low:i|=0,high:i>>31,unsigned:i>=0}}let s4=[];function c4(){const i=s4.pop();return i?(i.offset=i.limit=0,i):{bytes:new Uint8Array(64),offset:0,limit:0}}function rre(i){s4.push(i)}function HR(i,t){if(i.offset+t>i.limit)throw new Error("Skip past limit");i.offset+=t}function l4(i){return i.offset>=i.limit}function lp(i,t){let n=i.bytes,a=i.offset,l=i.limit,u=a+t;if(u>n.length){let h=new Uint8Array(2*u);h.set(n),i.bytes=h}return i.offset=u,u>l&&(i.limit=u),a}function WR(i,t){let n=i.offset;if(n+t>i.limit)throw new Error("Read past limit");return i.offset+=t,n}function u4(i,t){let n=WR(i,t),a=String.fromCharCode,l=i.bytes,u="ï¿½",h="";for(let p=0;p<t;p++){let v,E,y,C,I=l[p+n];128&I?(224&I)==192?p+1>=t?h+=u:(v=l[p+n+1],(192&v)!=128?h+=u:(C=(31&I)<<6|63&v,C<128?h+=u:(h+=a(C),p++))):(240&I)==224?p+2>=t?h+=u:(v=l[p+n+1],E=l[p+n+2],(49344&(v|E<<8))!=32896?h+=u:(C=(15&I)<<12|(63&v)<<6|63&E,C<2048||C>=55296&&C<=57343?h+=u:(h+=a(C),p+=2))):(248&I)==240?p+3>=t?h+=u:(v=l[p+n+1],E=l[p+n+2],y=l[p+n+3],(12632256&(v|E<<8|y<<16))!=8421504?h+=u:(C=(7&I)<<18|(63&v)<<12|(63&E)<<6|63&y,C<65536||C>1114111?h+=u:(C-=65536,h+=a(55296+(C>>10),56320+(1023&C)),p+=3))):h+=u:h+=a(I)}return h}function Ac(i,t){let n=t.length,a=0;for(let h=0;h<n;h++){let p=t.charCodeAt(h);p>=55296&&p<=56319&&h+1<n&&(p=(p<<10)+t.charCodeAt(++h)-56613888),a+=p<128?1:p<2048?2:p<65536?3:4}en(i,a);let l=lp(i,a),u=i.bytes;for(let h=0;h<n;h++){let p=t.charCodeAt(h);p>=55296&&p<=56319&&h+1<n&&(p=(p<<10)+t.charCodeAt(++h)-56613888),p<128?u[l++]=p:(p<2048?u[l++]=p>>6&31|192:(p<65536?u[l++]=p>>12&15|224:(u[l++]=p>>18&7|240,u[l++]=p>>12&63|128),u[l++]=p>>6&63|128),u[l++]=63&p|128)}}function ire(i,t){let n=lp(i,t.limit),a=i.bytes,l=t.bytes;for(let u=0,h=t.limit;u<h;u++)a[u+n]=l[u]}function d4(i){return i.bytes[WR(i,1)]}function h4(i,t){let n=lp(i,1);i.bytes[n]=t}function GR(i){let t=WR(i,8),n=i.bytes;return _o[0]=n[t++],_o[1]=n[t++],_o[2]=n[t++],_o[3]=n[t++],_o[4]=n[t++],_o[5]=n[t++],_o[6]=n[t++],_o[7]=n[t++],$R[0]}function zR(i,t){let n=lp(i,8),a=i.bytes;$R[0]=t,a[n++]=_o[0],a[n++]=_o[1],a[n++]=_o[2],a[n++]=_o[3],a[n++]=_o[4],a[n++]=_o[5],a[n++]=_o[6],a[n++]=_o[7]}function Oc(i){let t,n=0,a=0;do t=d4(i),n<32&&(a|=(127&t)<<n),n+=7;while(128&t);return a}function en(i,t){for(t>>>=0;t>=128;)h4(i,127&t|128),t>>>=7;h4(i,t)}function mu(i,t){let n=t.low>>>0,a=(t.low>>>28|t.high<<4)>>>0,l=t.high>>>24,u=l===0?a===0?n<16384?n<128?1:2:n<1<<21?3:4:a<16384?a<128?5:6:a<1<<21?7:8:l<128?9:10,h=lp(i,u),p=i.bytes;switch(u){case 10:p[h+9]=l>>>7&1;case 9:p[h+8]=u!==9?128|l:127&l;case 8:p[h+7]=u!==8?a>>>21|128:a>>>21&127;case 7:p[h+6]=u!==7?a>>>14|128:a>>>14&127;case 6:p[h+5]=u!==6?a>>>7|128:a>>>7&127;case 5:p[h+4]=u!==5?128|a:127&a;case 4:p[h+3]=u!==4?n>>>21|128:n>>>21&127;case 3:p[h+2]=u!==3?n>>>14|128:n>>>14&127;case 2:p[h+1]=u!==2?n>>>7|128:n>>>7&127;case 1:p[h]=u!==1?128|n:127&n}}function p4(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}const ore=new Map([["moderation",1],["supervise",2]]);class bE extends wn{get connectionState(){return this._connectionState}set connectionState(t){if(this._connectionState===t)return;const n=this._connectionState;this._connectionState=t,this.emit(Tr.CONNECTION_STATE_CHANGE,n,t)}get inspectType(){return this._inspectType}set inspectType(t){var n;this._inspectMode=ud(n=t.map(a=>ore.get(a)||0)).call(n,(a,l)=>a+l),this._inspectType=t}get quality(){return this._quality}set quality(t){this._quality=t>1?1:t<.1?.1:t,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(t){super(),w(this,"name","AgoraRTCVideoContentInspect"),w(this,"_connectionState",qo.CONNECTING),w(this,"_innerConnectionState",void 0),w(this,"sequence",0),w(this,"inspectStartTime",void 0),w(this,"workerManagerConnection",void 0),w(this,"workerConnection",void 0),w(this,"workerMessageLengthLimit",void 0),w(this,"inspectIntervalMinimum",void 0),w(this,"qualityRatio",void 0),w(this,"_connectInfo",void 0),w(this,"_cancelTokenSource",ho.CancelToken.source()),w(this,"_retryConfig",void 0),w(this,"wmSequence",0),w(this,"inspectInterval",void 0),w(this,"inspectTimer",null),w(this,"ossFilePrefix",void 0),w(this,"extraInfo",void 0),w(this,"_inspectType",void 0),w(this,"_inspectMode",void 0),w(this,"_quality",1),w(this,"qualityTimer",null),w(this,"_inspectId",void 0),w(this,"_needWorkUrlOnly",!1),w(this,"inspectImage",()=>{if(this.connectionState!==qo.CONNECTED)throw new ue(z.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===qo.CONNECTED?this.requestToInspectImage():L.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=pn(5,"inspect-"),this.workerMessageLengthLimit=J("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=J("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=J("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=t.interval,this.ossFilePrefix=t.ossFilePrefix,this.extraInfo=t.extraInfo,this.inspectType=t.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new d0("worker-manager-"+this._inspectId,ur),this.on(Tr.STATE_CHANGE,(n,a)=>{this._innerConnectionState=n,L.debug("[".concat(this._inspectId,"] Inspect operation :").concat(Xo[n]," ").concat(a||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new d0("worker-"+this._inspectId,ur),this.handleWorkerEvents()}async init(t,n){this.emit(Tr.STATE_CHANGE,Xo.CONNECT_AP),this._connectInfo=t;const a=this._cancelTokenSource.token;return this._retryConfig=n,new _e((l,u)=>{this.on(Tr.CONNECTION_STATE_CHANGE,(h,p)=>{p===qo.CONNECTED&&l()}),this.requestAP(t,a,n).then(h=>{this.connectWorkerManager(h)}).catch(h=>{u(h)})})}async requestAP(t,n,a){const l=J("WEBCS_DOMAIN").map(p=>"https://".concat(p,"/api/v1")),u=await function(p,v,E,y){let{appId:C,areaCode:I,cname:k,sid:G,token:B,uid:j}=v;Wh++;const q="image_moderation_api",Z={service_name:q,json_body:JSON.stringify({appId:C,areaCode:I,cname:k,command:"allocateEdge",requestId:Wh,seq:Wh,sid:G,token:B,ts:Date.now(),uid:j+""})};let re,Ce,pe=p[0];return Ds(async()=>{re=Date.now();const fe=await Zc(pe,{data:Z,cancelToken:E,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(Ce=Date.now()-re,fe.code!==0){const Ne=new ue(z.UNEXPECTED_RESPONSE,"image inspect ap error, code"+fe.code,{retry:!0,responseTime:Ce});throw L.error(Ne.toString()),Ne}const ye=JSON.parse(fe.json_body);if(ye.code!==200){const Ne=new ue(z.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(ye.code,", reason: ").concat(ye.reason),{code:ye.code,responseTime:Ce});throw L.error(Ne.toString()),Ne}if(!ye.servers||!Array.isArray(ye.servers)||ye.servers.length===0){const Ne=new ue(z.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:ye.code,responseTime:Ce});throw L.error(Ne.toString()),Ne}const Ee=J("VIDEO_INSPECT_WORKER_MANAGER_HOST"),Ae=J("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:ye.servers.map(Ne=>{let{address:it,wss:yt}=Ne;if(it&&yt)return"wss://".concat(it.replace(/\./g,"-"),".").concat(Ee,":").concat(Ae||yt)}).filter(Ne=>!!Ne),workerToken:ye.workerToken,vid:ye.vid,responseTime:Ce}},(fe,ye)=>(We.apworkerEvent(G,{success:!0,sc:200,serviceName:q,responseDetail:JSON.stringify(fe.addressList),firstSuccess:ye===0,responseTime:Ce,serverIp:p[ye%p.length]}),!1),(fe,ye)=>(We.apworkerEvent(G,{success:!1,sc:fe.data&&fe.data.code||200,serviceName:q,responseTime:Ce,serverIp:p[ye%p.length]}),!!(fe.code!==z.OPERATION_ABORTED&&fe.code!==z.UNEXPECTED_RESPONSE||fe.data&&fe.data.retry)&&(pe=p[(ye+1)%p.length],!0)),y)}(l,t,n,a);this.emit(Tr.STATE_CHANGE,Xo.AP_CONNECTED);const{addressList:h}=u;return this.wmSequence++,h}async connectWorkerManager(t){let n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=n,this.emit(Tr.STATE_CHANGE,Xo.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(t,1e4)}async connectWorker(t){await this.workerConnection.init([t])}handleWorkerManagerEvents(){this.workerManagerConnection.on(nt.CONNECTED,async()=>{this.emit(Tr.STATE_CHANGE,Xo.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.20.0",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(nt.CLOSED,()=>{this._innerConnectionState<Xo.GET_WORKER_MANAGER_RESPONSE&&L.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(nt.FAILED,()=>{this._innerConnectionState<Xo.GET_WORKER_MANAGER_RESPONSE&&L.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(nt.RECONNECTING,()=>{this._innerConnectionState<Xo.GET_WORKER_MANAGER_RESPONSE&&L.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(nt.ON_MESSAGE,async t=>{this.emit(Tr.STATE_CHANGE,Xo.GET_WORKER_MANAGER_RESPONSE);const n=this.workerManagerConnection.url;this.workerManagerConnection.close();const a=JSON.parse(t.data);if(a.code!==200)throw L.error("[".concat(this._inspectId,"] Unexpected code ").concat(a.code," from worker manager")),new ue(z.UNEXPECTED_RESPONSE,"response code of worker is unexpected",a);if(!(a.serverResponse&&a.serverResponse.portWss&&n))throw L.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(a))),new ue(z.UNEXPECTED_RESPONSE,"response content of worker is unexpected",a);{const l=J("VIDEO_INSPECT_WORKER_PORT")||a.serverResponse.portWss,u=n.replace(/:\d+\/?$/,":".concat(l));this.emit(Tr.STATE_CHANGE,Xo.CONNECT_WORKER,u),this._needWorkUrlOnly?this.emit(Tr.REQUEST_NEW_WORKER_URL,u):await this.connectWorker(u)}}),this.workerManagerConnection.on(nt.WILL_RECONNECT,(t,n,a)=>{a(t)}),this.workerManagerConnection.on(nt.REQUEST_NEW_URLS,(t,n)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(t).catch(n)})}handleWorkerEvents(){this.workerConnection.on(nt.CONNECTED,async()=>{this.emit(Tr.STATE_CHANGE,Xo.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=qo.CONNECTED}),this.workerConnection.on(nt.ON_MESSAGE,async t=>{if(t.data instanceof ArrayBuffer){const a=Qne(new Uint8Array(t.data));if(J("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&L.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(a)),a.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(Tr.INSPECT_RESULT,void 0,void 0);if(a.data&&a.data.scorePorn&&a.data.scoreSexy&&a.data.scoreNeutral){var n;const l={porn:a.data.scorePorn,sexy:a.data.scoreSexy,neutral:a.data.scoreNeutral},u=ud(n=Object.keys(l)).call(n,(p,v)=>l[p]>l[v]?p:v,"porn"),h=Object.keys(l).find(p=>p===u);this.emit(Tr.INSPECT_RESULT,h)}else this.emit(Tr.INSPECT_RESULT,void 0,new ue(z.UNEXPECTED_RESPONSE,a.code+"","There is an unexpected data on message"))}else this.emit(Tr.INSPECT_RESULT,void 0,new ue(z.UNEXPECTED_RESPONSE,a.code+"",a.msg))}else L.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(Tr.INSPECT_RESULT,void 0,new ue(z.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(nt.CLOSED,()=>{this.connectionState=qo.CLOSED}),this.workerConnection.on(nt.FAILED,()=>{this.connectionState=qo.CLOSED}),this.workerConnection.on(nt.RECONNECTING,()=>{this.connectionState=this.connectionState===qo.CONNECTED?qo.RECONNECTING:qo.CONNECTING}),this.workerConnection.on(nt.WILL_RECONNECT,(t,n,a)=>{t==="recover"&&a(t),a("tryNext")}),this.workerConnection.on(nt.REQUEST_NEW_URLS,(t,n)=>{this.workerManagerConnection.close(),this.once(Tr.REQUEST_NEW_WORKER_URL,a=>{t([a])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(a=>{this.connectWorkerManager(a,!0)}).catch(a=>{n(a)})})}static intToLong(t){return{low:t|=0,high:t>>31,unsigned:t>=0}}async requestToInspectImage(){this.sequence++;const t=No(this,Tr.CLIENT_LOCAL_VIDEO_TRACK),n={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(t){if(!t.isPlaying)return void this.emit(Tr.INSPECT_RESULT,void 0,new ue(z.INVALID_OPERATION,"Only the track being played can be inspected"));const a=await this.generateRequestData(t,n);this.workerConnection.sendMessage(a,!0,!0)}else this.emit(Tr.INSPECT_RESULT,void 0,new ue(z.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(t,n){let{appId:a,cname:l,cid:u,vid:h,sid:p,uid:v}=n;const E=Date.now(),y=await t.getCurrentFrameImage("image/jpeg",this.quality),C=await SF(y,a,l),I=this.sequence+"-"+u+"-"+v+"-"+E+"-"+pn(12,""),k={appId:a,cid:u,cname:l,deviceId:"",elapse:bE.intToLong(Number(E-this.inspectStartTime)),fileSize:C.byteLength,jpgEncryption:2,height:y.height,width:y.width,jpg:C,networkType:6,osType:7,requestId:I,sdkVersion:"4.20.0",sequence:this.sequence,sid:p,timestamp:bE.intToLong(E),uid:v,vid:h,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};this.extraInfo===void 0&&delete k.callbackData,this.ossFilePrefix===void 0&&delete k.ossFilePrefix;const G=Jne(k);if(G.byteLength<this.workerMessageLengthLimit){if(J("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const B=function(j){for(var q=1;q<arguments.length;q++){var Z=arguments[q]!=null?arguments[q]:{};q%2?p4(Object(Z),!0).forEach(function(re){w(j,re,Z[re])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(Z)):p4(Object(Z)).forEach(function(re){Object.defineProperty(j,re,Object.getOwnPropertyDescriptor(Z,re))})}return j}({},k);delete B.jpg,L.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(B))}return G}{const B=this.quality*this.qualityRatio;return this.quality=B,await this.generateRequestData(t,{appId:a,cname:l,cid:u,vid:h,sid:p,uid:v})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=ho.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=qo.CLOSED,this.emit(Tr.STATE_CHANGE,Xo.CLOSED)}}function are(i){let t=function(){const n=lre.pop();return n?(n.offset=n.limit=0,n):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(n,a){let l=n.appId;l!==void 0&&(rr(a,10),gu(a,l));let u=n.cid;u!==void 0&&(rr(a,16),rr(a,u));let h=n.cname;h!==void 0&&(rr(a,26),gu(a,h));let p=n.deviceId;p!==void 0&&(rr(a,34),gu(a,p));let v=n.elapse;v!==void 0&&(rr(a,40),vu(a,v));let E=n.fileSize;E!==void 0&&(rr(a,48),vu(a,up(E)));let y=n.height;y!==void 0&&(rr(a,56),vu(a,up(y)));let C=n.jpg;C!==void 0&&(rr(a,66),rr(a,C.length),m4(a,C));let I=n.networkType;I!==void 0&&(rr(a,72),vu(a,up(I)));let k=n.osType;k!==void 0&&(rr(a,80),vu(a,up(k)));let G=n.requestId;G!==void 0&&(rr(a,90),gu(a,G));let B=n.sdkVersion;B!==void 0&&(rr(a,98),gu(a,B));let j=n.sequence;j!==void 0&&(rr(a,104),vu(a,up(j)));let q=n.sid;q!==void 0&&(rr(a,114),gu(a,q));let Z=n.timestamp;Z!==void 0&&(rr(a,120),vu(a,Z));let re=n.uid;re!==void 0&&(rr(a,128),rr(a,re));let Ce=n.vid;Ce!==void 0&&(rr(a,136),rr(a,Ce));let pe=n.width;pe!==void 0&&(rr(a,144),vu(a,up(pe)));let fe=n.service;fe!==void 0&&(rr(a,152),rr(a,fe));let ye=n.callbackData;ye!==void 0&&(rr(a,162),rr(a,ye.length),m4(a,ye));let Ee=n.ticket;Ee!==void 0&&(rr(a,170),gu(a,Ee));let Ae=n.vendorConfigs;Ae!==void 0&&(rr(a,178),gu(a,Ae))}(i,t),function(n){let a=n.bytes,l=n.limit;return a.length===l?a:a.subarray(0,l)}(t)}function sre(i){return function(n){let a={};e:for(;!ure(n);){let l=B0(n);switch(l>>>3){case 0:break e;case 1:a.code=B0(n);break;case 2:a.msg=g4(n,B0(n));break;case 3:a.requestId=g4(n,B0(n));break;case 4:a.timestamp=dre(n,!1);break;default:cre(n,7&l)}}return a}({bytes:t=i,offset:0,limit:t.length});var t}function cre(i,t){switch(t){case 0:for(;128&us(i););break;case 2:KR(i,B0(i));break;case 5:KR(i,4);break;case 1:KR(i,8);break;default:throw new Error("Unimplemented type: "+t)}}function up(i){return{low:i|=0,high:i>>31,unsigned:i>=0}}let lre=[];function KR(i,t){if(i.offset+t>i.limit)throw new Error("Skip past limit");i.offset+=t}function ure(i){return i.offset>=i.limit}function TE(i,t){let n=i.bytes,a=i.offset,l=i.limit,u=a+t;if(u>n.length){let h=new Uint8Array(2*u);h.set(n),i.bytes=h}return i.offset=u,u>l&&(i.limit=u),a}function f4(i,t){let n=i.offset;if(n+t>i.limit)throw new Error("Read past limit");return i.offset+=t,n}function m4(i,t){let n=TE(i,t.length);i.bytes.set(t,n)}function g4(i,t){let n=f4(i,t),a=String.fromCharCode,l=i.bytes,u="ï¿½",h="";for(let p=0;p<t;p++){let v,E,y,C,I=l[p+n];128&I?(224&I)==192?p+1>=t?h+=u:(v=l[p+n+1],(192&v)!=128?h+=u:(C=(31&I)<<6|63&v,C<128?h+=u:(h+=a(C),p++))):(240&I)==224?p+2>=t?h+=u:(v=l[p+n+1],E=l[p+n+2],(49344&(v|E<<8))!=32896?h+=u:(C=(15&I)<<12|(63&v)<<6|63&E,C<2048||C>=55296&&C<=57343?h+=u:(h+=a(C),p+=2))):(248&I)==240?p+3>=t?h+=u:(v=l[p+n+1],E=l[p+n+2],y=l[p+n+3],(12632256&(v|E<<8|y<<16))!=8421504?h+=u:(C=(7&I)<<18|(63&v)<<12|(63&E)<<6|63&y,C<65536||C>1114111?h+=u:(C-=65536,h+=a(55296+(C>>10),56320+(1023&C)),p+=3))):h+=u:h+=a(I)}return h}function gu(i,t){let n=t.length,a=0;for(let h=0;h<n;h++){let p=t.charCodeAt(h);p>=55296&&p<=56319&&h+1<n&&(p=(p<<10)+t.charCodeAt(++h)-56613888),a+=p<128?1:p<2048?2:p<65536?3:4}rr(i,a);let l=TE(i,a),u=i.bytes;for(let h=0;h<n;h++){let p=t.charCodeAt(h);p>=55296&&p<=56319&&h+1<n&&(p=(p<<10)+t.charCodeAt(++h)-56613888),p<128?u[l++]=p:(p<2048?u[l++]=p>>6&31|192:(p<65536?u[l++]=p>>12&15|224:(u[l++]=p>>18&7|240,u[l++]=p>>12&63|128),u[l++]=p>>6&63|128),u[l++]=63&p|128)}}function us(i){return i.bytes[f4(i,1)]}function v4(i,t){let n=TE(i,1);i.bytes[n]=t}function B0(i){let t,n=0,a=0;do t=us(i),n<32&&(a|=(127&t)<<n),n+=7;while(128&t);return a}function rr(i,t){for(t>>>=0;t>=128;)v4(i,127&t|128),t>>>=7;v4(i,t)}function dre(i,t){let n,a=0,l=0,u=0;return n=us(i),a=127&n,128&n&&(n=us(i),a|=(127&n)<<7,128&n&&(n=us(i),a|=(127&n)<<14,128&n&&(n=us(i),a|=(127&n)<<21,128&n&&(n=us(i),l=127&n,128&n&&(n=us(i),l|=(127&n)<<7,128&n&&(n=us(i),l|=(127&n)<<14,128&n&&(n=us(i),l|=(127&n)<<21,128&n&&(n=us(i),u=127&n,128&n&&(n=us(i),u|=(127&n)<<7))))))))),{low:a|l<<28,high:l>>>4|u<<24,unsigned:t}}function vu(i,t){let n=t.low>>>0,a=(t.low>>>28|t.high<<4)>>>0,l=t.high>>>24,u=l===0?a===0?n<16384?n<128?1:2:n<1<<21?3:4:a<16384?a<128?5:6:a<1<<21?7:8:l<128?9:10,h=TE(i,u),p=i.bytes;switch(u){case 10:p[h+9]=l>>>7&1;case 9:p[h+8]=u!==9?128|l:127&l;case 8:p[h+7]=u!==8?a>>>21|128:a>>>21&127;case 7:p[h+6]=u!==7?a>>>14|128:a>>>14&127;case 6:p[h+5]=u!==6?a>>>7|128:a>>>7&127;case 5:p[h+4]=u!==5?128|a:127&a;case 4:p[h+3]=u!==4?n>>>21|128:n>>>21&127;case 3:p[h+2]=u!==3?n>>>14|128:n>>>14&127;case 2:p[h+1]=u!==2?n>>>7|128:n>>>7&127;case 1:p[h]=u!==1?128|n:127&n}}const E4={},_4={},RE=4294967296,y4=RE*RE,S4=y4/2,YR=b4(0,!0),C4=b4(0),hre=dp(0,-2147483648,!1),pre=dp(-1,2147483647,!1),fre=dp(-1,-1,!0);function b4(i,t){let n,a,l;return t?(l=0<=(i>>>=0)&&i<256)&&(a=_4[i],a)?a:(n=dp(i,0,!0),l&&(_4[i]=n),n):(l=-128<=(i|=0)&&i<128)&&(a=E4[i],a)?a:(n=dp(i,i<0?-1:0,!1),l&&(E4[i]=n),n)}function dp(i,t,n){return{low:0|i,high:0|t,unsigned:!!n}}function mre(i,t){if(isNaN(i))return t?YR:C4;if(t){if(i<0)return YR;if(i>=y4)return fre}else{if(i<=-S4)return hre;if(i+1>=S4)return pre}return i<0?t?YR:C4:dp(i%RE|0,i/RE|0,t)}function T4(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}class qR extends wn{get connectionState(){return this._connectionState}set connectionState(t){if(this._connectionState===t)return;const n=this._connectionState;this._connectionState=t,this.emit(wa.CONNECTION_STATE_CHANGE,t,n)}get quality(){return this._quality}set quality(t){this._quality=t>1?1:t<.1?.1:t,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(t){var n;super(),w(this,"name","AgoraRTCImageModeration"),w(this,"_connectionState",Po.CONNECTING),w(this,"_sequence",0),w(this,"_moderationStartTime",void 0),w(this,"_workerConnection",void 0),w(this,"_workerMessageLengthLimit",void 0),w(this,"_qualityRatio",void 0),w(this,"_connectInfo",void 0),w(this,"_cancelTokenSource",ho.CancelToken.source()),w(this,"_retryConfig",void 0),w(this,"_moderationInterval",void 0),w(this,"_moderationTimer",null),w(this,"_moderationMode",1),w(this,"_quality",1),w(this,"_qualityTimer",null),w(this,"_ticket",void 0),w(this,"_moderationIntervalMinimum",void 0),w(this,"_uploadFailedNum",0),w(this,"_uploadNum",0),w(this,"_uploadTimer",null),w(this,"_extraInfo",void 0),w(this,"_vendor",""),w(this,"_encoder",new TextEncoder),w(this,"_moderationId",void 0),w(this,"inspectImage",()=>{if(this.connectionState!==Po.CONNECTED)throw new ue(z.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===Po.CONNECTED?this.requestToInspectImage():L.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=pn(5,"image-moderation-"),this._workerMessageLengthLimit=J("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=J("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=(n=t.interval)!==null&&n!==void 0?n:1e3,t.extraInfo&&(this._extraInfo=this._encoder.encode(t.extraInfo)),t.vendor&&(this._vendor=t.vendor),this._qualityRatio=J("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new d0("worker-"+this._moderationId,ur),this.on(wa.STATE_CHANGE,(a,l)=>{L.debug("[".concat(this._moderationId,"] Moderation operation :").concat(Ql[a]," ").concat(l||""))}),this.handleWorkerEvents()}async init(t,n){this.emit(wa.STATE_CHANGE,Ql.CONNECT_AP),this._connectInfo=t;const a=this._cancelTokenSource.token;return this._retryConfig=n,new _e((l,u)=>{this.on(wa.CONNECTION_STATE_CHANGE,(h,p)=>{h===Po.CONNECTED&&l()}),this.requestAP(t,a,n).then(h=>{this.connectWorker(h)}).catch(h=>{u(h)})})}updateConfig(t){var n;this._moderationInterval=(n=t.interval)!==null&&n!==void 0?n:1e3,t.extraInfo&&(this._extraInfo=this._encoder.encode(t.extraInfo)),t.vendor&&(this._vendor=t.vendor),L.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(t))),this.connectionState===Po.CONNECTED&&this.inspectImage()}async requestAP(t,n,a){const l=J("WEBCS_DOMAIN").map(v=>"https://".concat(v,"/api/v1")),u=await function(v,E,y,C){let{appId:I,areaCode:k,cname:G,sid:B,token:j,uid:q}=E;Wh++;const Z="moderation_plugin",re={service_name:Z,json_body:JSON.stringify({appId:I,areaCode:k,cname:G,command:"allocateEdge",requestId:Wh,seq:Wh,sid:B,appToken:j,ts:Date.now(),uid:q+""})};let Ce,pe,fe=v[0];return Ds(async()=>{Ce=Date.now();const ye=await Zc(fe,{data:re,cancelToken:y,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(pe=Date.now()-Ce,ye.code!==0){const Ne=new ue(z.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+ye.code,{retry:!0,responseTime:pe});throw L.error(Ne.toString()),Ne}const Ee=JSON.parse(ye.json_body);if(Ee.code!==200){const Ne=new ue(z.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(Ee.code,", reason: ").concat(Ee.reason),{code:Ee.code,responseTime:pe});throw L.error(Ne.toString()),Ne}if(!Ee.servers||!Array.isArray(Ee.servers)||Ee.servers.length===0){const Ne=new ue(z.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:Ee.code,responseTime:pe});throw L.error(Ne.toString()),Ne}if(!Ee.servers.some(Ne=>!!Ne.wss)){const Ne=new ue(z.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:Ee.code,responseTime:pe});throw L.error(Ne.toString()),Ne}const Ae=J("IMAGE_MODERATION_WORKER_HOST");return{addressList:Ee.servers.map(Ne=>{let{address:it,wss:yt}=Ne;if(it&&yt)return"wss://".concat(it.replace(/\./g,"-"),".").concat(Ae,":").concat(yt,"/moderation")}).filter(Ne=>!!Ne),workerToken:Ee.workerToken,vid:Ee.vid,ticket:Ee.appTicket,responseTime:pe}},(ye,Ee)=>(We.apworkerEvent(B,{success:!0,sc:200,serviceName:Z,responseDetail:JSON.stringify(ye.addressList),firstSuccess:Ee===0,responseTime:pe,serverIp:v[Ee%v.length]}),!1),(ye,Ee)=>(We.apworkerEvent(B,{success:!1,sc:ye.data&&ye.data.code||200,serviceName:Z,responseTime:pe,serverIp:v[Ee%v.length]}),!!(ye.code!==z.OPERATION_ABORTED&&ye.code!==z.UNEXPECTED_RESPONSE||ye.data&&ye.data.retry)&&(fe=v[(Ee+1)%v.length],!0)),C)}(l,t,n,a);this.emit(wa.STATE_CHANGE,Ql.AP_CONNECTED);const{addressList:h,ticket:p}=u;return this._ticket=p,h}async connectWorker(t){this.emit(wa.STATE_CHANGE,Ql.CONNECT_WORKER),await this._workerConnection.init(t,1e4)}handleWorkerEvents(){this._workerConnection.on(nt.CONNECTED,async()=>{this.emit(wa.STATE_CHANGE,Ql.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=Po.CONNECTED}),this._workerConnection.on(nt.CLOSED,()=>{this.connectionState=Po.CLOSED}),this._workerConnection.on(nt.FAILED,()=>{this.connectionState=Po.CLOSED}),this._workerConnection.on(nt.RECONNECTING,()=>{this.connectionState=this.connectionState===Po.CONNECTED?Po.RECONNECTING:Po.CONNECTING}),this._workerConnection.on(nt.ON_MESSAGE,async t=>{if(t.data instanceof ArrayBuffer){const n=sre(new Uint8Array(t.data));J("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&L.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(n)),this._uploadNum++,n.code===void 0||n.code===0||(this._uploadFailedNum++,L.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(n.code,", msg is ").concat(n.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{We.reportApiInvoke(this._connectInfo.sid||null,{name:gr.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,n.code],tag:Pn.TRACER}).onError(new ue(z.IMAGE_MODERATION_UPLOAD_FAILED,n.msg)),this._uploadTimer=null},J("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else L.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(nt.WILL_RECONNECT,(t,n,a)=>{t==="recover"&&a(t),a("tryNext")}),this._workerConnection.on(nt.REQUEST_NEW_URLS,(t,n)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(t).catch(n)})}static intToLong(t){return{low:t|=0,high:t>>31,unsigned:t>=0}}async requestToInspectImage(){const t=No(this,wa.CLIENT_LOCAL_VIDEO_TRACK),n={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(t){if(!t.isPlaying)return void(J("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&L.debug("Only the track being played can be inspected"));this._sequence++;const a=await this.generateRequestData(t,n);this._workerConnection.sendMessage(a,!0,!0)}else J("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&L.debug("Only the track being published can be inspected")}async generateRequestData(t,n){let{appId:a,cname:l,cid:u,vid:h,sid:p,uid:v}=n;const E=Date.now(),y=await t.getCurrentFrameImage("image/jpeg",this.quality),C=await SF(y,a,l),I=this._sequence+"-"+u+"-"+v+"-"+E+"-"+pn(12,""),k={appId:a,cid:u,cname:l,deviceId:"",elapse:qR.intToLong(Number(E-this._moderationStartTime)),fileSize:y.buffer.byteLength,height:y.height,width:y.width,jpg:C,networkType:6,osType:7,requestId:I,sdkVersion:"4.20.0",sequence:this._sequence,sid:p,timestamp:mre(E),uid:v,vid:h,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};this._extraInfo===void 0&&delete k.callbackData;const G=are(k);if(G.byteLength<this._workerMessageLengthLimit){if(J("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const B=function(j){for(var q=1;q<arguments.length;q++){var Z=arguments[q]!=null?arguments[q]:{};q%2?T4(Object(Z),!0).forEach(function(re){w(j,re,Z[re])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(Z)):T4(Object(Z)).forEach(function(re){Object.defineProperty(j,re,Object.getOwnPropertyDescriptor(Z,re))})}return j}({},k);delete B.jpg,L.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(B))}return G}{const B=this.quality*this._qualityRatio;return this.quality=B,await this.generateRequestData(t,{appId:a,cname:l,cid:u,vid:h,sid:p,uid:v})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=ho.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=Po.CLOSED,this.emit(wa.STATE_CHANGE,Ql.CLOSED)}}function R4(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function w4(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?R4(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):R4(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}const gre=Date.now(),vre=20,XR=new Map,wE=new Map;async function I4(i){const t=XR.get(i),n=Array.isArray(t)&&t[t.length-1],a=wE.get(i);if(!n)return void(a.isSyncing=!1);const l={uid:n.uid,payload:_v(n.payload)};a.firstRecvTs===0&&(a.firstRecvTs=n.recvTs,a.firstSendTs=n.sendTs);const u=n.sendTs-a.firstSendTs,h=u-(Date.now()-a.firstRecvTs);h>0&&(a.firstRecvTs=Date.now()-u);let p=n.mediaDelay+h;p<=0?(t.pop(),A4(n.context,l),p=0):p=Math.min(p,vre),setTimeout(()=>t.length&&I4(i),p)}function A4(i,t){i.safeEmit(Nt.STREAM_MESSAGE,t.uid,t.payload),i.onStreamMessage&&i.onStreamMessage(t)}function Ere(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(!i.syncWithAudio)return A4(n,{uid:i.uid,payload:_v(i.payload)});const a="".concat(n.id,"-").concat(i.uid),l=XR.get(a)||[],u=l.findIndex(E=>i.sendTs>=E.sendTs),h=w4(w4({},i),{},{context:n,mediaDelay:t,recvTs:Date.now()});u===-1?l.push(h):l.splice(u,0,h),XR.set(a,l);let p=!1;var v;wE.has(a)?p=!((v=wE.get(a))===null||v===void 0||!v.isSyncing):wE.set(a,{isSyncing:p,firstRecvTs:0,firstSendTs:0}),p||I4(a)}const _re=Wt().name;function yre(){return!function(i,t,n){const a=Wt();if(a.os!==yr.IOS||!a.osVersion)return!1;const l=a.osVersion.split(".");return n?t&&Number(l[0])===i&&Number(l[1])<t||Number(l[0])<i:t?Number(l[0])===i&&Number(l[1])<=t||Number(l[0])<i:Number(l[0])<=i}(16,0,!0)&&!function(i,t,n){const a=Wt();if(a.name!==qt.SAFARI||!a.osVersion)return!1;const l=a.version.split(".");return n?t&&Number(l[0])===i&&Number(l[1])<t||Number(l[0])<i:t?Number(l[0])===i&&Number(l[1])<=t||Number(l[0])<i:Number(l[0])<=i}(16,0,!0)}function O4(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function sl(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?O4(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):O4(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}Ur.setLogger(L);class rn extends wn{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var t;return((t=this._config)===null||t===void 0?void 0:t.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(t){let n;if(super(),w(this,"store",void 0),w(this,"_uid",void 0),w(this,"_channelName",void 0),w(this,"_uintUid",void 0),w(this,"_users",[]),w(this,"_config",void 0),w(this,"_clientId",void 0),w(this,"_appId",void 0),w(this,"_sessionId",null),w(this,"_key",void 0),w(this,"_rtmConfig",{}),w(this,"_joinInfo",void 0),w(this,"_gateway",void 0),w(this,"_statsCollector",void 0),w(this,"_configDistribute",void 0),w(this,"_leaveMutex",new Ur("client-leave")),w(this,"_publishMutex",new Ur("client-publish")),w(this,"_renewTokenMutex",new Ur("client-renewtoken")),w(this,"_subscribeMutex",new Ur("client-subscribe")),w(this,"_encryptionMode","none"),w(this,"_encryptionSecret",null),w(this,"_encryptionSalt",null),w(this,"_proxyServer",void 0),w(this,"_turnServer",{servers:[],mode:"auto"}),w(this,"_cloudProxyServerMode","disabled"),w(this,"_isDualStreamEnabled",!1),w(this,"_defaultStreamFallbackType",void 0),w(this,"_lowStreamParameter",void 0),w(this,"_streamFallbackTypeCacheMap",new Map),w(this,"_remoteStreamTypeCacheMap",new Map),w(this,"_axiosCancelSource",ho.CancelToken.source()),w(this,"_audioVolumeIndicationInterval",void 0),w(this,"_networkQualityInterval",void 0),w(this,"_userOfflineTimeout",void 0),w(this,"_streamRemovedTimeout",void 0),w(this,"_injectStreamingClient",void 0),w(this,"_liveTranscodeStreamingClient",void 0),w(this,"_liveRawStreamingClient",void 0),w(this,"_channelMediaRelayClient",void 0),w(this,"_networkQualitySensitivity","normal"),w(this,"_p2pChannel",void 0),w(this,"_useLocalAccessPoint",!1),w(this,"_setLocalAPVersion",void 0),w(this,"_joinAndNotLeaveYet",!1),w(this,"_numberOfJoinCount",0),w(this,"_remoteDefaultVideoStreamType",void 0),w(this,"_inspect",void 0),w(this,"_moderation",void 0),w(this,"_license",void 0),w(this,"_pendingPublishedUsers",[]),w(this,"ntpAlignErrorCount",0),w(this,"remoteInboundOffset",0),w(this,"_handleLocalTrackEnable",(a,l,u)=>{this.publish(a,!1).then(l).catch(u)}),w(this,"_handleLocalTrackDisable",(a,l,u)=>{this.unpublish(a).then(l).catch(u)}),w(this,"_handleUserOnline",a=>{if(J("BLOCK_LOCAL_CLIENT")&&hd(a.uid,this.channelName))return void L.debug("[".concat(a.uid,"] will be ignored in local"));this.isStringUID&&typeof a.uid!="string"&&L.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const l=this._users.find(u=>u.uid===a.uid);if(l)l._trust_in_room_=!0,l._is_pre_created&&(l._is_pre_created=!1,this.safeEmit(Nt.USER_JOINED,l));else{const u=new Kr(a.uid,a.uint_id||a.uid);this._users.push(u),L.debug("[".concat(this._clientId,"] user online"),a.uid),this.safeEmit(Nt.USER_JOINED,u)}}),w(this,"_handleUserOffline",a=>{if(J("BLOCK_LOCAL_CLIENT")&&hd(a.uid,this.channelName))return;const l=this._users.find(u=>u.uid===a.uid);l&&(this._handleRemoveStream(a),this._handleRemoveDataChannels(a),l._audio_pre_subscribed||l._video_pre_subscribed?l._is_pre_created=!0:vv(this._users,l),this._remoteStreamTypeCacheMap.delete(l.uid),this._streamFallbackTypeCacheMap.delete(l.uid),L.debug("[".concat(this._clientId,"] user offline"),a.uid,"reason:",a.reason),this.safeEmit(Nt.USER_LEAVED,l,a.reason))}),w(this,"_handleAddAudioOrVideoStream",(a,l,u,h,p,v,E)=>{if(J("BLOCK_LOCAL_CLIENT")&&hd(l,this.channelName))return;const y=this._users.find(I=>I.uid===l);if(!y)return void L.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));L.debug("[".concat(this._clientId,"] stream added with uid ").concat(l,", type ").concat(a)),this.store.subscribe(y.uid,a,void 0,void 0,void 0,Date.now());const C=a==="audio"?y.hasAudio:y.hasVideo;y._uintid||(y._uintid=p||l),a==="audio"?y._trust_audio_stream_added_state_=!0:y._trust_video_stream_added_state_=!0,a==="audio"?(y._audio_added_=!0,u!==void 0&&(y._audioSSRC=u),h!==void 0&&(y._cname=h),v&&(y._audioOrtc=v)):(y._video_added_=!0,u!==void 0&&(y._videoSSRC=u),h!==void 0&&(y._cname=h),E!==void 0&&(y._rtxSsrcId=E),v&&(y._videoOrtc=v)),(a==="audio"?y.hasAudio:y.hasVideo)&&!C&&(L.info("[".concat(this._clientId,"] remote user ").concat(y.uid," published ").concat(a)),this.safeEmit(Nt.USER_PUBLISHED,y,a)),a==="video"?We.onGatewayStream(this._sessionId,Cr.ON_ADD_VIDEO_STREAM,yn.ON_ADD_VIDEO_STREAM,{peer:p||l,ssrc:y._videoSSRC}):We.onGatewayStream(this._sessionId,Cr.ON_ADD_AUDIO_STREAM,yn.ON_ADD_AUDIO_STREAM,{peer:p||l,ssrc:y._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(y,a,u).then(I=>{if(I&&(L.debug("[".concat(this._clientId,"] resubscribe ").concat(a," for user ").concat(y.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof $r))return this._p2pChannel.unsubscribe(y,a,!0).then(()=>this._subscribe(y,a,!0).catch(k=>{L.error("[".concat(this._clientId,"] resubscribe error"),k.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(y,a)&&(L.debug("[".concat(this._clientId,"] resubscribe ").concat(a," for user ").concat(y.uid," after reconnect.")),this._subscribe(y,a,!0).catch(I=>{L.error("[".concat(this._clientId,"] resubscribe error"),I.toString())}))}),w(this,"_handleRemoveStream",a=>{if(J("BLOCK_LOCAL_CLIENT")&&hd(a.uid,this.channelName))return;const l=this._users.find(h=>h.uid===a.uid);if(!l)return void L.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));L.debug("[".concat(this._clientId,"] stream removed with uid ").concat(a.uid));let u=()=>{};l.hasAudio&&l.hasVideo?u=()=>{L.info("[".concat(this._clientId,"] remote user ").concat(l.uid," unpublished audio track")),this.safeEmit(Nt.USER_UNPUBLISHED,l,"audio"),L.info("[".concat(this._clientId,"] remote user ").concat(l.uid," unpublished video track")),this.safeEmit(Nt.USER_UNPUBLISHED,l,"video")}:l.hasVideo?u=()=>{L.info("[".concat(this._clientId,"] remote user ").concat(l.uid," unpublished video track")),this.safeEmit(Nt.USER_UNPUBLISHED,l,"video")}:l.hasAudio&&(u=()=>{L.info("[".concat(this._clientId,"] remote user ").concat(l.uid," unpublished audio track")),this.safeEmit(Nt.USER_UNPUBLISHED,l,"audio")}),l._video_pre_subscribed||l._audio_pre_subscribed||(l._trust_audio_stream_added_state_=!0,l._trust_video_stream_added_state_=!0,l._audio_added_=!1,l._video_added_=!1,this._p2pChannel instanceof $r&&this._p2pChannel.unsubscribe(l).then(h=>{if(h)return this._gateway.unsubscribe(h,l.uid)}),l._audioSSRC=void 0,l._videoSSRC=void 0,l._audioOrtc=void 0,l._videoOrtc=void 0,l._rtxSsrcId=void 0),We.onGatewayStream(this._sessionId,Cr.ON_REMOVE_STREAM,yn.ON_REMOVE_STREAM,{peer:a.uint_id||a.uid}),u()}),w(this,"_handleSetStreamLocalEnable",(a,l,u)=>{if(J("BLOCK_LOCAL_CLIENT")&&hd(l,this.channelName))return;const h=this._users.find(E=>E.uid===l);if(!h)return void L.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));L.debug("[".concat(this._clientId,"] local ").concat(a," ").concat(u?"enabled":"disabled"," with uid ").concat(l));const p=a==="audio"?h.hasAudio:h.hasVideo;if(a==="audio"){h._trust_audio_enabled_state_=!0;const E=h._audio_enabled_;if(h._audio_enabled_=u,h._audio_enabled_===E)return;{const y=h._audio_enabled_?"enable-local-audio":"disable-local-audio";L.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(l,", msg: ").concat(y)),this.safeEmit(Nt.USER_INFO_UPDATED,l,y)}}else{h._trust_video_enabled_state_=!0;const E=h._video_enabled_;if(h._video_enabled_=u,h._video_enabled_===E)return;{const y=h._video_enabled_?"enable-local-video":"disable-local-video";L.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(l,", msg: ").concat(y)),this.safeEmit(Nt.USER_INFO_UPDATED,l,y)}}const v=a==="audio"?h.hasAudio:h.hasVideo;return p!==v?!p&&v?(L.info("[".concat(this._clientId,"] remote user ").concat(l," published ").concat(a)),void this.safeEmit(Nt.USER_PUBLISHED,h,a)):(a==="video"&&h._videoTrack&&h._videoTrack._destroy(),a==="audio"&&h._audioTrack,this._p2pChannel.muteRemote(h,a),L.info("[".concat(this._clientId,"] remote user ").concat(l," unpublished ").concat(a)),void this.safeEmit(Nt.USER_UNPUBLISHED,h,a)):void 0}),w(this,"_handleMuteStream",(a,l,u)=>{if(J("BLOCK_LOCAL_CLIENT")&&hd(a,this.channelName))return;L.debug("[".concat(this._clientId,"] receive mute message"),a,l,u);const h=this._users.find(E=>E.uid===a);if(!h)return void L.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(a));const p=l==="audio"?h.hasAudio:h.hasVideo;if(l==="audio"){h._trust_audio_mute_state_=!0;const E=h._audio_muted_;if(h._audio_muted_=u,h._audio_muted_===E)return;{const y=h._audio_muted_?"mute-audio":"unmute-audio";L.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(a,", msg: ").concat(y)),this.safeEmit(Nt.USER_INFO_UPDATED,a,y)}}else{h._trust_video_mute_state_=!0;const E=h._video_muted_;if(h._video_muted_=u,h._video_muted_===E)return;{const y=h._video_muted_?"mute-video":"unmute-video";L.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(a,", msg: ").concat(y)),this.safeEmit(Nt.USER_INFO_UPDATED,a,y)}}const v=l==="audio"?h.hasAudio:h.hasVideo;if(p!==v){if(!p&&v)return(l==="audio"?h._audioSSRC:h._videoSSRC)?(L.info("[".concat(this._clientId,"] remote user ").concat(a," published ").concat(l)),void this.safeEmit(Nt.USER_PUBLISHED,h,l)):void L.warning("[".concat(this._clientId,"] remote user ").concat(a," receive ").concat(l," unmute message  before add stream message, ").concat(l," SSRC doesn't exist yet."));l==="video"&&h._videoTrack&&!h._video_pre_subscribed&&h._videoTrack._destroy(),l==="audio"&&h._audioTrack,this._p2pChannel.muteRemote(h,l),L.info("[".concat(this._clientId,"] remote user ").concat(a," unpublished ").concat(l)),this.safeEmit(Nt.USER_UNPUBLISHED,h,l)}}),w(this,"_handleP2PLost",async a=>{L.debug("[".concat(this._clientId,"] receive p2p lost"),a),parseInt(a.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():L.warning("[".concat(this._clientId,"] P2PLost stream not found"),a)}),w(this,"_handleTokenWillExpire",()=>{L.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(Nt.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),w(this,"_handleBeforeUnload",a=>{a.type==="beforeunload"&&a.returnValue!==void 0&&a.returnValue!==""||(this.leave(),L.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),w(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.safeEmit(Nt.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const a={downlinkNetworkQuality:0,uplinkNetworkQuality:0};a.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),a.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(Nt.NETWORK_QUALITY,a)}),w(this,"_handleP2PAddAudioOrVideoStream",(a,l,u,h)=>{const p=this._users.find(E=>E.uid===l);if(!p)return void L.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));L.debug("[".concat(this._clientId,"] stream added with uid ").concat(l,", type ").concat(a)),this.store.subscribe(p.uid,a,void 0,void 0,void 0,Date.now());const v=a==="audio"?p.hasAudio:p.hasVideo;a==="audio"?p._trust_audio_stream_added_state_=!0:p._trust_video_stream_added_state_=!0,a==="audio"?(p._audio_added_=!0,u!==void 0&&(p._audioSSRC=u),h!==void 0&&(p._audioMid=h)):(p._video_added_=!0,u!==void 0&&(p._videoSSRC=u),h!==void 0&&(p._videoMid=h)),(a==="audio"?p.hasAudio:p.hasVideo)&&!v&&(L.info("[".concat(this._clientId,"] remote user ").concat(p.uid," published ").concat(a)),this.safeEmit(Nt.USER_PUBLISHED,p,a)),this._p2pChannel.hasPendingRemoteMedia(p,a)&&(L.debug("[".concat(this._clientId,"] resubscribe ").concat(a," for user ").concat(p.uid," after reconnect.")),this._subscribe(p,a,!0).catch(E=>{L.error("[".concat(this._clientId,"] resubscribe error"),E.toString())}))}),this._config=t,this._clientId=pn(5,"client-"),this.store=new fee(t.codec,t.audioCodec,t.mode,this._clientId),this.store.clientCreated(),t.proxyServer&&this.setProxyServer(t.proxyServer,!0),t.turnServer&&this.setTurnServer(t.turnServer,!0),L.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(Ta," build: ").concat(vT,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),t.clientRoleOptions)try{Gk(t.clientRoleOptions),n=Object.assign({},t.clientRoleOptions)}catch(a){L.warning("[".concat(this._clientId,"] ").concat(a.toString()))}this._statsCollector=new M0(this.store),this._statsCollector.onStatsException=(a,l,u)=>{L.debug("[".concat(this._clientId,"] receive exception msg, code: ").concat(a,", msg: ").concat(l,", uid: ").concat(u)),this.safeEmit(Nt.EXCEPTION,{code:a,msg:l,uid:u})},this._statsCollector.onUploadPublishDuration=(a,l,u,h)=>{const p=this._users.find(v=>v.uid===a);p&&We.peerPublishStatus(this._sessionId,{subscribeElapse:h,audioPublishDuration:l,videoPublishDuration:u,peer:p._uintid})},this.store.useDataChannel=cn().supportDataChannel&&J("SIGNAL_CHANNEL"),this.store.useP2P=t.mode==="p2p",this._gateway=new Xee(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:t.websocketRetryConfig||ur,httpRetryConfig:t.httpRetryConfig||ur,forceWaitGatewayResponse:t.forceWaitGatewayResponse===void 0||t.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:t.role,clientRoleOptions:n}),this._configDistribute=new ote,this.store.useP2P?(this._p2pChannel=new Rr(this.store,this._statsCollector),this._handleP2PEvents()):this._p2pChannel=new $r(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(t,n,a,l,u){let h=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],p=arguments.length>6&&arguments[6]!==void 0&&arguments[6];sn("JOIN_GATEWAY_USE_443PORT_ONLY",h),sn("JOIN_GATEWAY_USE_DUAL_DOMAIN",p);const v=this._gateway.signal.websocket;return v instanceof u0&&(v.use443PortOnly=h,v.tryDoubleDomain=p),async function(E,y,C){dv.get(E)||dv.set(E,[]),hv.get(E)||hv.set(E,y),gc.get(E)||gc.set(E,0);const I=dv.get(E),k=hv.get(E);if(!I||!k)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(gc.get(E)===k){const Z=t0();I.push(Z),await Z.promise}gc.set(E,gc.get(E)+1);for(var G=arguments.length,B=new Array(G>3?G-3:0),j=3;j<G;j++)B[j-3]=arguments[j];const q=await C(...B);return gc.set(E,gc.get(E)-1),gc.get(E)===k-1&&I.length>0&&(I[0].resolve(),I.shift()),gc.get(E)===0&&(dv.set(E,[]),hv.set(E,0),gc.set(E,0)),q}("client.join",J("JOIN_MAX_CONCURRENCY"),this.join.bind(this),t,n,a,l,u)}async join(t,n,a,l,u){const h=++this._numberOfJoinCount;this.store.joinStart(),l&&(this.store.uid=l);const p=pee(),v=qL()?window.isSecureContext:"Browser Not Support";if(!qL()&&!p||!window.isSecureContext){const B="The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser";L.warning(B)}const E=Yb();this.connectionState==="DISCONNECTED"&&(this.store.avoidJoinStart=Math.round(Date.now()),L.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart)));const y=We.reportApiInvoke(E,{name:gr.JOIN,options:[t,n,a,l],states:{isHttps:p,isSecureContext:v},tag:Pn.TRACER});We.setAppId(t);try{if(!a&&a!==null)throw new ue(z.INVALID_PARAMS,"Invalid token: ".concat(a,". If you don not use token, set it to null"));a&&ai(a,"token",1,2047),ai(t,"appid",1,2047),ST(n),l&&CT(l),u&&ai(u,"optionalInfo",1,2047)}catch(B){throw y.onError(B),B}if(L.info("[".concat(this._clientId,"] start join channel ").concat(n,", join number: ").concat(h)),this._leaveMutex.isLocked&&(L.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),L.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const B=new ue(z.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw y.onError(B),B}this._sessionId||(this._sessionId=E,this.store.sessionId=this._sessionId),this._gateway.state="CONNECTING";const C=sl(sl({},this._rtmConfig),{},{clientId:this._clientId,appId:t,sid:this._sessionId,cname:n,uid:typeof l!="string"?l:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:a||t,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:u,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType});if(this._useLocalAccessPoint&&(C.setLocalAPVersion=this._setLocalAPVersion),typeof l=="string"&&(C.stringUid=l,this._uintUid?(C.uid=this._uintUid,this._uintUid=void 0):C.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(C.aesmode=this._encryptionMode,C.aespassword=await CZ(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new ue(z.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(C.aessalt=this._encryptionSalt)}this._startSession(this._sessionId,{channel:n,appId:t,stringUid:C.stringUid});const I=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&I===this._sessionId&&We.joinChannelTimeout(this._sessionId,5)},5e3);try{var k;let B;const j=C.cloudProxyServer;if(Be(k=["proxy3","proxy4","proxy5"]).call(k,j)){const pe=J("PROXY_SERVER_TYPE3");Array.isArray(pe)?C.proxyServer=pe[0]:C.proxyServer=pe}if(We.setProxyServer(C.proxyServer),L.setProxyServer(C.proxyServer),this.store.requestAPStart(),C.stringUid&&!C.uid){let pe;[pe,B]=await _e.all([jM(C.stringUid,C,this._axiosCancelSource.token,this._config.httpRetryConfig||ur,this.store),BM(C,this._axiosCancelSource.token,this._config.httpRetryConfig||ur,!0,this.store)]),L.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(C.stringUid," => ").concat(pe)),C.uid=pe,B.gatewayInfo.uid=pe,B.gatewayInfo.res.uid=pe}else B=await BM(C,this._axiosCancelSource.token,this._config.httpRetryConfig||ur,!0,this.store);if(!this._joinAndNotLeaveYet)throw new ue(z.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(C,this._axiosCancelSource.token),this._configDistribute.on(l0.UPDATE_BITRATE_LIMIT,pe=>{this._p2pChannel.updateBitrateLimit(pe)})},0),this._key=a||t;const q=B.gatewayInfo,Z=C.uid?C.uid:q.uid;this._joinInfo=sl(sl({},C),{},{cid:q.cid,uid:Z,vid:q.vid,apResponse:q.res,uni_lbs_ip:q.uni_lbs_ip,gatewayAddrs:q.gatewayAddrs}),this.store.intUid=Z;const re=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new ue(z.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));y.onSuccess(re),this._appId=t,this._channelName=C.cname,this._uid=re,this.store.uid=re,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(Ni()?"beforeunload":"pagehide",this._handleBeforeUnload)},0);const Ce=C.stringUid?"string uid: ".concat(C.stringUid,",uid: ").concat(C.uid):"uid: ".concat(this._uid);return L.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(n,",").concat(Ce)),setTimeout(()=>{L.startUpload()},5e3),this.store.joinEnd(),G=this,Be(ql).call(ql,G)||ql.push(G),re}catch(B){const j=Array.isArray(B)?B[0]:B;throw j&&j.code===z.OPERATION_ABORTED?L.warning("[".concat(this._clientId,"] join number: ").concat(h,", Joining channel failed, rollback"),j):L.error("[".concat(this._clientId,"] join number: ").concat(h,", Joining channel failed, rollback"),j),j.code!==z.OPERATION_ABORTED&&this._numberOfJoinCount===h&&(this._gateway.state="DISCONNECTED",this._reset()),y.onError(j),j}var G}_joinGateway(){if(!this._joinInfo||!this._key)throw new ue(z.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!J("JOIN_WITH_FALLBACK_SIGNAL_PROXY"))).then(t=>t).catch(t=>{if(t.code===z.INIT_WEBSOCKET_TIMEOUT)return this._gateway.leave(!0,xt.FALLBACK),t;if(t.code===z.INIT_DATACHANNEL_TIMEOUT)return this._gateway.leave(!0,xt.FALLBACK),t;throw t}).then(t=>{if(t instanceof ue){if(t.code===z.INIT_WEBSOCKET_TIMEOUT){if(L.info("[".concat(this._clientId,"] join timeout, fallback to proxy")),!this._joinInfo||!this._key)throw new ue(z.INVALID_OPERATION);this._joinInfo.cloudProxyServer="fallback",this._cloudProxyServerMode="fallback",this.store.cloudProxyServerMode="fallback";const n=J("PROXY_SERVER_TYPE3");if(Array.isArray(n))if(this._joinInfo.apUrl){const l=/^https?:\/\/(.+?)(\/.*)?$/.exec(this._joinInfo.apUrl)[1].split("."),u=l.slice(l.length-2).join(".");n.forEach(h=>{this._joinInfo&&Be(h).call(h,u)&&(this._joinInfo.proxyServer=h)}),this._joinInfo.proxyServer||(this._joinInfo.proxyServer=n[0])}else this._joinInfo.proxyServer=n[0];else this._joinInfo.proxyServer=n;const a=J("LOG_UPLOAD_SERVER").match(/.+:(\d{1,5})$/);return a&&a[1]&&a[1]!=="443"&&L.setProxyServer(this._joinInfo.proxyServer),J("STATS_COLLECTOR_PORT").toString()!=="443"&&We.setProxyServer(this._joinInfo.proxyServer),We.reportApiInvoke(this._sessionId,{name:gr.JOIN_FALLBACK_TO_PROXY,options:[this._joinInfo.proxyServer],tag:Pn.TRACER}).onSuccess(),this.safeEmit(Nt.JOIN_FALLBACK_TO_PROXY,this._joinInfo.proxyServer),J("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&this._joinInfo.turnServer.servers.forEach(l=>{"forceturn"in l&&(l.forceturn=!0)}),this._gateway.join(this._joinInfo,this._key)}if(L.info("[".concat(this._clientId,"] join by datachannel timeout, fallback to websocket")),!this._joinInfo||!this._key)throw new ue(z.INVALID_OPERATION);return We.reportApiInvoke(this._sessionId,{name:gr.DATACHANNEL_FAILBACK,options:[this.store.clientId],tag:Pn.TRACER}).onSuccess(),this._joinGateway()}return t}).then(t=>t)}async leave(){L.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(Ni()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(n){const a=ql.indexOf(n);a!==-1&&ql.splice(a,1)}(this);const t=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return L.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void t();await this._gateway.leave(this.connectionState!=="CONNECTED"),L.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),t()}async publish(t){let n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!Array.isArray(t)){if(!(t instanceof ci))return this._publishDataChannel(t);t=[t]}if(t.length===0)throw new ue(z.INVALID_PARAMS,"param list is empty");const a=t;if(this._gateway.role==="audience")throw new ue(z.INVALID_OPERATION,"audience can not publish stream");for(const u of a){if(!(u instanceof ci))throw new ue(z.INVALID_PARAMS,"parameter is not local track");if(!u._enabled&&n)throw new ue(z.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(u.getTrackId()))}L.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(a.map(u=>"".concat(u.getTrackId()," "))));const l=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),n&&a.forEach(u=>{const h=this._configDistribute.getBitrateLimit();u instanceof Rt&&h&&u.setBitrateLimit(h.uplink)});try{await this._publishHighStream(a),L.info("[".concat(this._clientId,"] Publish success, id ").concat(a.map(u=>"".concat(u.getTrackId()," "))))}catch(u){throw L.error("[".concat(this._clientId,"] publish error"),u.toString()),u}finally{l()}}async _publishDataChannel(t){an(t.id,"id",0,65535,!0),Gl(t.ordered,"ordered"),ai(t.metadata,"metadata",0,512),L.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(t.id));const n=await this._publishMutex.lock();try{if(this._p2pChannel.getAllDataChannels().findIndex(l=>l.id===t.id)!==-1)throw new ue(z.INVALID_PARAMS,"Invalid id: ".concat(t.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||this._uid===void 0)throw new ue(z.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ue(z.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&J("FORCE_TURN")&&!J("TURN_ENABLE_TCP")&&!J("TURN_ENABLE_UDP"))throw new ue(z.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const a=new pU(t);await this._p2pChannel.publishDataChannel([a]);try{const l={streamId:t.id,ordered:t.ordered,maxRetransmits:J("DATASTREAM_MAX_RETRANSMITS"),metadata:t.metadata,channelId:a._originDataChannelId};await this._gateway.publishDataChannel(this._uid,l,!0)}catch(l){if(l.code!==z.DISCONNECT_P2P)throw l}return await a._waitTillOpen(),L.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(a.id)),a}catch(a){throw L.error("[".concat(this._clientId,"] publish datachannels error"),a.toString()),a}finally{n()}}async unpublish(t){if(!this._joinInfo||this._uid===void 0)throw new ue(z.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let n=[];if(t)if(Array.isArray(t))n=t;else{if(!(t instanceof ci))return this._unpublishDataChannel([t]);n=[t]}else this.store.useP2P||await this._unpublishDataChannel(),n=this._p2pChannel.getAllTracks(!0);L.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(n.map(l=>"".concat(l.getTrackId()," "))," "));const a=await this._publishMutex.lock();try{if(this._p2pChannel instanceof Rr){const l=await this._p2pChannel.unpublish(n);l&&await this._gateway.sendExtensionMessage(Mn.UNPUBLISH,{unpubMsg:l},!0)}else{const l=await this._p2pChannel.unpublish(n);l&&await this._gateway.unpublish(l,this._uid),L.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(n.map(u=>"".concat(u.getTrackId()))))}}catch(l){throw L.error("[".concat(this._clientId,"] unpublish error"),l.toString()),l}finally{a&&a()}}async _unpublishDataChannel(t){t!==void 0&&t.length!==0||(t=this._p2pChannel.getAllDataChannels()),L.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(t.map(a=>"".concat(a.id," "))," "));const n=await this._publishMutex.lock();try{const a=await this._p2pChannel.unpublishDataChannel(t);a&&await this._gateway.unpublishDataChannel(a),L.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(t.map(l=>"".concat(l.id))))}catch(a){throw L.error("[".concat(this._clientId,"] unpublish dataChannel error"),a.toString()),a}finally{n&&n()}}async subscribe(t,n,a){return n==="datachannel"?this._subscribeDataChannel(t,a):this._subscribe(t,n)}async presubscribe(t,n){if(Sr(n,"mediaType",["audio","video"]),this._p2pChannel instanceof Rr)throw new ue(z.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new ue(z.INVALID_OPERATION,"can't presub when not join");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ue(z.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));const a=n===je.AUDIO,l=n===je.VIDEO,u=await this._subscribeMutex.lock();try{const{ssrcId:h,ortc:p,rtxSsrcId:v,cname:E,uint_id:y}=await this._gateway.presubscribe(t,n,!0);if(h==null)throw new ue(z.UNEXPECTED_RESPONSE,"no ssrc id");let C=this._users.find(k=>k.uid===t);C||(C=new Kr(t,y||t),C._is_pre_created=!0,this._users.push(C)),E&&(C._cname=E),C._uintid||(C._uintid=y||t),a&&(C._audioSSRC=h,C._audio_pre_subscribed=!0,p&&(C._audioOrtc=p)),l&&(C._videoSSRC=h,C._video_pre_subscribed=!0,p&&(C._videoOrtc=p),v!=null&&(C._rtxSsrcId=v)),L.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(h)),await this._p2pChannel.subscribe(C,n,h,v,p);const I=a?C._audioTrack:C._videoTrack;if(!I)throw new ue(z.UNEXPECTED_ERROR,"can not find remote track in user");return a&&(C._trust_audio_stream_added_state_=!0,C._audio_added_=!0),l&&(C._trust_video_stream_added_state_=!0,C._video_added_=!0),I}catch(h){throw L.error("[".concat(this._clientId,"] presub user ").concat(t," error"),h),h}finally{u()}}async _subscribeDataChannel(t,n){var a;if(an(n,"channelId",0,65535,!0),!this._joinInfo)throw new ue(z.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ue(z.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));if(!this._users.find(p=>p===t))throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", this user is not in the channel")),new ue(z.INVALID_REMOTE_USER,"user is not in the channel");if(!t.hasAudio&&!t.hasVideo&&t._dataChannels.length===0)throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", user is not published")),new ue(z.INVALID_REMOTE_USER,"user is not published");const l=(a=t._dataChannels)===null||a===void 0?void 0:a.find(p=>p.id===n);if(!l)throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid," with mediaType datachannel, remote datachannel is not published")),new ue(z.REMOTE_USER_IS_NOT_PUBLISHED);const u=await this._subscribeMutex.lock();L.info("[".concat(this._clientId,"] subscribe user ").concat(t.uid,", mediaType: datachannel"));try{const p=await this._p2pChannel.subscribeDataChannel(t,[l]);if(p&&Be(p).call(p,l.id))try{var h;if(!l._originDataChannelId)throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid," with mediaType datachannel, cannot get RTCDatachannel")),new ue(z.REMOTE_USER_IS_NOT_PUBLISHED);const v={id:l.id,datachannelId:l._originDataChannelId,ordered:l.ordered,maxRetransmits:l.maxRetransmits,metadata:(h=l.metadata)!==null&&h!==void 0?h:""};await this._gateway.subscribeDataChannel(t.uid,v,!0)}catch(v){if((v==null?void 0:v.code)!==z.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(t,[l]),v;await this._p2pChannel.unsubscribeDataChannel(t,[l]),this._p2pChannel.setPendingRemoteDataChannel(t,l.id)}return await l._waitTillOpen(),L.info("[".concat(this._clientId,"] subscribe success user ").concat(t.uid,", mediaType: datachannel")),l}finally{u()}}async _p2pSubscribe(t,n,a){if(Sr(n,"mediaType",["audio","video"]),!this._joinInfo)throw new ue(z.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ue(z.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(u=>u===t)){const u=new ue(z.INVALID_REMOTE_USER,"user is not in the channel");throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", this user is not in the channel")),u}if(!t.hasAudio&&!t.hasVideo){const u=new ue(z.INVALID_REMOTE_USER,"user is not published");throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", user is not published")),u}if(!a&&(n==="audio"&&!t.hasAudio||n==="video"&&!t.hasVideo)){const u=new ue(z.REMOTE_USER_IS_NOT_PUBLISHED);throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid," with mediaType ").concat(n,", remote track is not published")),u}const l=await this._subscribeMutex.lock();L.info("[".concat(this._clientId,"] subscribe user ").concat(t.uid,", mediaType: ").concat(n));try{if(await this._p2pChannel.hasRemoteMediaWithLock(t,n))await this._p2pChannel.unmuteRemote(t,n);else try{const h=n==="audio"?t._audioSSRC:t._videoSSRC,p=n==="audio"?t._audioMid:t._videoMid;this.store.subscribe(t.uid,n,Date.now()),this._p2pChannel instanceof Rr&&await this._p2pChannel.subscribe(t,n,h,p)}catch(h){throw h}L.info("[".concat(this._clientId,"] subscribe success user ").concat(t.uid,", mediaType: ").concat(n)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(t.uid,this._defaultStreamFallbackType).catch(h=>{L.warning("[".concat(this._clientId,"] auto set fallback failed"),h)});const u=n==="audio"?t._audioTrack:t._videoTrack;if(!u)throw new ue(z.UNEXPECTED_ERROR,"can not find remote track in user object");return u}catch(u){throw L.error("[".concat(this._clientId,"] subscribe user ").concat(t.uid," error"),u),u}finally{l()}}async _subscribe(t,n,a){if(this._p2pChannel instanceof Rr)return this._p2pSubscribe(t,n);if(Sr(n,"mediaType",["audio","video"]),!this._joinInfo)throw new ue(z.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ue(z.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(E=>E===t)){const E=new ue(z.INVALID_REMOTE_USER,"user is not in the channel");throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", this user is not in the channel")),E}if(!t.hasAudio&&!t.hasVideo){const E=new ue(z.INVALID_REMOTE_USER,"user is not published");throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", user is not published")),E}if(!(a||(n!=="audio"||t.hasAudio&&t._audioSSRC!==void 0)&&(n!=="video"||t.hasVideo&&t._videoSSRC!==void 0))){const E=new ue(z.REMOTE_USER_IS_NOT_PUBLISHED);throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid," with mediaType ").concat(n,", remote track is not published")),E}let l=n==="audio"?t._audioSSRC:t._videoSSRC,u=n==="audio"?t._audioOrtc:t._videoOrtc,h=n==="video"?t._rtxSsrcId:void 0,p={stream_type:n==="audio"?je.AUDIO:je.VIDEO,ssrcId:l};const v=await this._subscribeMutex.lock();L.info("[".concat(this._clientId,"] subscribe user ").concat(t.uid,", mediaType: ").concat(n));try{if(await this._p2pChannel.hasRemoteMediaWithLock(t,n))await this._p2pChannel.unmuteRemote(t,n);else try{const y=n==="audio"?t._audioSSRC:t._videoSSRC;y!==void 0&&y!==l&&(l=y,u=n==="audio"?t._audioOrtc:t._videoOrtc,h=n==="video"?t._rtxSsrcId:void 0,p={stream_type:n==="audio"?je.AUDIO:je.VIDEO,ssrcId:l}),li.markSubscribeStart(this.store.clientId,l),this.store.subscribe(t.uid,n,Date.now()),await this._p2pChannel.subscribe(t,n,l,h,u);try{await this._gateway.subscribe(t.uid,p,!0)}catch(C){if((C==null?void 0:C.code)!==z.WS_ABORT)throw await this._p2pChannel.unsubscribe(t,n),C;await this._p2pChannel.unsubscribe(t,n,!0),this._p2pChannel.setPendingRemoteMedia(t,n)}this.store.subscribe(t.uid,n,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,t,n)}catch(y){throw this._p2pChannel.reportSubscribeEvent(!1,y==null?void 0:y.code,t,n),y}L.info("[".concat(this._clientId,"] subscribe success user ").concat(t.uid,", mediaType: ").concat(n)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(t.uid,this._defaultStreamFallbackType).catch(y=>{L.warning("[".concat(this._clientId,"] auto set fallback failed"),y)});const E=n==="audio"?t._audioTrack:t._videoTrack;if(!E)throw new ue(z.UNEXPECTED_ERROR,"can not find remote track in user object");return E}catch(E){throw L.error("[".concat(this._clientId,"] subscribe user ").concat(t.uid," error"),E),E}finally{v()}}async massSubscribe(t){if(Yc(t,"subscribeList"),!this._joinInfo)throw new ue(z.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ue(z.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const n=Date.now(),a=new Map,l=await this._subscribeMutex.lock();L.info("[".concat(this._clientId,"]start massSubscribe user ").concat(t.map(v=>{let{user:E,mediaType:y}=v;return"user: ".concat(E==null?void 0:E.uid,", mediaType: ").concat(y)}).join("; ")));const u=(t=[...t]).map(v=>{let{user:E,mediaType:y}=v;return{user:E,mediaType:y}}),h=await this._p2pChannel.globalLock();try{var p;for(let E=t.length-1;E>=0;E--){const y=t[E],{user:C,mediaType:I}=y;if(Sr(I,"mediaType",["audio","video"]),!C){const B=new ue(z.INVALID_PARAMS,"user property does not exist in subscribeList item");throw L.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),B}if(!this._users.find(B=>B===C)){const B=new ue(z.INVALID_REMOTE_USER,"user is not in the channel");L.error("[".concat(this._clientId,"] can not massSubscribe ").concat(C.uid,", this user is not in the channel")),u[E].error=B,t.splice(E,1);continue}if(I==="audio"&&(!C.hasAudio||C._audioSSRC===void 0)||I==="video"&&(!C.hasVideo||C._videoSSRC===void 0)){const B=new ue(z.REMOTE_USER_IS_NOT_PUBLISHED);L.error("[".concat(this._clientId,"] can not subscribe ").concat(C.uid," with mediaType ").concat(I,", remote user is not published")),u[E].error=B,t.splice(E,1);continue}const k=vr.Video|vr.LwoVideo,G=a.get(C);if(G){if(I==="video"?G&k:G&vr.Audio){t.splice(E,1),L.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(C.uid,", mediaType:").concat(I," twice"));continue}a.set(C,G|(I==="video"?k:vr.Audio))}else a.set(C,I==="video"?k:vr.Audio)}for(let E=t.length-1;E>=0;E--){const y=t[E],{user:C,mediaType:I}=y,k=vr.Video|vr.LwoVideo;if(this._p2pChannel.hasRemoteMedia(C,I)){await this._p2pChannel.unmuteRemoteNoLock(C,I);const G=a.get(C);a.set(C,I==="video"?G^k:G^vr.Audio),t.splice(E,1)}}this.store.massSubscribe(t.map(E=>({userId:E.user.uid,type:E.mediaType})),n);const v=ud(p=Array.from(a.entries())).call(p,(E,y)=>{let[C,I]=y;if(I===0)return E;const k={stream_id:C.uid,stream_type:I};return I&vr.Audio&&(k.audio_ssrc=C._audioSSRC),I&vr.Video&&(k.video_ssrc=C._videoSSRC),E.push(k),E},[]);try{t.length>0&&await this._p2pChannel.massSubscribeNoLock(t.map(y=>{let{user:C,mediaType:I}=y;return{user:C,mediaType:I,ssrcId:I===je.VIDEO?C._videoSSRC:C._audioSSRC,rtxSsrcId:I===je.VIDEO?C._rtxSsrcId:void 0}}));const E=new Map;if(v.length>0){const y=await this._gateway.subscribeAll(v,!0);((y==null?void 0:y.users)||[]).forEach(C=>{let{stream_id:I,video_error_code:k,audio_error_code:G,error_code:B}=C;(k||G||B)&&E.set(I,{video_error_code:k,audio_error_code:G,error_code:B})})}if(Array.from(E.entries()).length>0){const y=Array.from(E.entries()).map(C=>{let I,[k,G]=C;return G.error_code||G.video_error_code&&G.audio_error_code?I=void 0:G.video_error_code?I=je.VIDEO:G.audio_error_code&&(I=je.AUDIO),{user:this.remoteUsers.find(B=>B.uid===k),mediaType:I}});await this._p2pChannel.massUnsubscribeNoLock(y)}for(const y of u){const C=E.get(y.user.uid);if(C){const I=C.error_code||y.mediaType==="audio"&&C.audio_error_code||y.mediaType==="video"&&C.video_error_code;if(I){const k=fd(I);L.error("user:".concat(y.user.uid," mediaType:").concat(y.mediaType," has massSubscribe error ").concat(k.desc)),y.error=new ue(z.SUBSCRIBE_FAILED,"code ".concat(I,": ").concat(k.desc))}}y.error||(y.mediaType==="video"?y.track=y.user.videoTrack:y.track=y.user.audioTrack)}return this.store.massSubscribe(u.filter(y=>!y.error).map(y=>({userId:y.user.uid,type:y.mediaType})),void 0,Date.now()),u.forEach(y=>{var C;We.subscribe(this.store.sessionId,{succ:!!y.error,ec:((C=y.error)===null||C===void 0?void 0:C.code)||null,video:y.mediaType===je.VIDEO,audio:y.mediaType===je.AUDIO,peerid:y.user.uid,subscribeRequestid:y.mediaType===je.VIDEO?y.user._videoSSRC:y.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-n)},!0)}),L.info("[".concat(this._clientId,"] massSubscribe success ").concat(t.map(y=>{let{user:C,mediaType:I}=y;return"user: ".concat(C==null?void 0:C.uid,", mediaType: ").concat(I)}).join("; "))),u}catch(E){throw await this._p2pChannel.massUnsubscribeNoLock(t),E}}finally{h(),l()}}async unsubscribe(t,n,a){if(n||this.store.useP2P){if(n==="datachannel")return this._unsubscribeDataChannel(t,a)}else await this._unsubscribeDataChannel(t,a);if(n&&Sr(n,"mediaType",["audio","video"]),!this._joinInfo)throw new ue(z.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(u=>u===t)){const u=new ue(z.INVALID_REMOTE_USER,"user is not in the channel");throw L.error("[".concat(this._clientId,"] can not unsubscribe ").concat(t.uid,", user is not in the channel")),u}L.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(t.uid,", mediaType: ").concat(n));const l=await this._subscribeMutex.lock();try{if(this._p2pChannel instanceof Rr)await this._p2pChannel.unsubscribe(t,n);else{const u=await this._p2pChannel.unsubscribe(t,n);u&&await this._gateway.unsubscribe(u,t.uid),n&&n!=="audio"||(t._audio_pre_subscribed=!1),n&&n!=="video"||(t._video_pre_subscribed=!1),t._is_pre_created&&vv(this._users,t),L.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(t.uid,", mediaType: ").concat(n))}}catch(u){if(u.code===z.DISCONNECT_P2P)return void L.warning("disconnecting p2p, abort unsubscribe request.");throw L.error("[".concat(this._clientId,"] unsubscribe user ").concat(t.uid," error"),u.toString()),u}finally{l()}}async _unsubscribeDataChannel(t,n){if(n&&an(n,"id",0,65535,!0),!this._joinInfo)throw new ue(z.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!this._users.find(l=>l===t)){const l=new ue(z.INVALID_REMOTE_USER,"user is not in the channel");throw L.error("[".concat(this._clientId,"] can not unsubscribe ").concat(t.uid,", user is not in the channel")),l}let a;if(typeof n=="number"){const l=t._dataChannels.find(u=>u.id===n);l&&(a=[l])}else a=t._dataChannels;if(a===void 0){const l=new ue(z.REMOTE_USER_IS_NOT_PUBLISHED);throw L.error("[".concat(this._clientId,"] can not unsubscribe ").concat(t.uid," with channelId ").concat(n,", remote datachannel is not published")),l}L.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(t.uid,", mediaType: datachannel, ids: ").concat(a.map(l=>l.id)));try{const l=await this._p2pChannel.unsubscribeDataChannel(t,a);l&&await this._gateway.unsubscribeDataChannel(l,t.uid),L.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(t.uid,", mediaType: datachannel, ids: ").concat(l))}catch(l){if(l.code===z.DISCONNECT_P2P)return void L.warning("disconnecting p2p, abort unsubscribe request.");throw L.error("[".concat(this._clientId,"] unsubscribe user ").concat(t.uid," error"),l.toString()),l}}async massUnsubscribe(t){if(Yc(t,"unsubscribeList"),!this._joinInfo)throw new ue(z.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");L.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(t.map(a=>{let{user:l,mediaType:u}=a;return"user: ".concat(l==null?void 0:l.uid,", mediaType: ").concat(u,";")}).join())),t=[...t];const n=new Map;for(let a=t.length-1;a>=0;a--){const{user:l,mediaType:u}=t[a];if(!l){const p=new ue(z.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw L.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),p}if(Sr(u,"mediaType",["video","audio",void 0]),!this._users.find(p=>p===l)){L.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(l.uid,", user is not in the channel")),t.splice(a,1);continue}const h=vr.Video|vr.LwoVideo;if(n.has(l)){const p=n.get(l);let v;switch(u){case"video":v=p&h;break;case"audio":v=p&vr.Audio;break;default:v=p&(vr.Audio|h)}if(v){L.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(l.uid,",mediaType:").concat(u," twice.")),t.splice(a,1);continue}u?u==="audio"?n.set(l,p|vr.Audio):u==="video"&&n.set(l,p|h):n.set(l,p|vr.Audio|h)}else u?u==="audio"?n.set(l,vr.Audio):u==="video"&&n.set(l,h):n.set(l,vr.Audio|h)}try{const a=await this._p2pChannel.massUnsubscribe(t);a&&await this._gateway.massUnsubscribe(a),L.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(t.map(l=>{let{user:u,mediaType:h}=l;return"user: ".concat(u==null?void 0:u.uid,", mediaType: ").concat(h,";")}).join()))}catch(a){if(a.code===z.DISCONNECT_P2P)return void L.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw L.error("[".concat(this._clientId,"] massUnsubscribe error"),a.toString()),a}}async setLowStreamParameter(t){(function(a){if(!a)throw new Te(z.INVALID_PARAMS);Nn(a.width)||Wb(a.width,"streamParameter.width"),Nn(a.height)||Wb(a.height,"streamParameter.height"),Nn(a.framerate)||Wb(a.framerate,"streamParameter.framerate"),Nn(a.bitrate)||an(a.bitrate,"streamParameter.bitrate")})(t),(!t.width&&t.height||t.width&&!t.height)&&L.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),L.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(t));const n=this._configDistribute.getLowStreamConfigDistribute();if(n&&n.bitrate&&t.bitrate&&n.bitrate<t.bitrate&&(t.bitrate=n.bitrate),this._lowStreamParameter=t,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(t,Ie.LocalVideoLowTrack)}async enableDualStream(){if(!cn().supportDualStream)throw We.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new ue(z.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new ue(z.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(t){throw We.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),t}this._isDualStreamEnabled=!0,We.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),L.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new ue(z.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(Ie.LocalVideoLowTrack))try{const t=await this._p2pChannel.unpublishLowStream();t&&await this._gateway.unpublish(t,this._joinInfo.stringUid||this._joinInfo.uid)}catch(t){throw We.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),t}this._isDualStreamEnabled=!1,We.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),L.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(t,n){if(function(a){Sr(a,"role",["audience","host"])}(t),n&&Gk(n),this.mode==="rtc"||this.mode==="p2p")throw L.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new ue(z.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(n&&n.level&&t==="host")throw new ue(z.INVALID_OPERATION,"host mode can not set audience latency level");if(t==="audience"&&this._p2pChannel.hasLocalMedia())throw new ue(z.INVALID_OPERATION,"can not set client role to audience when publishing stream");await this._gateway.setClientRole(t,n),this._config.role=t,L.info("[".concat(this._clientId,"] set client role to ").concat(t,", level: ").concat(n&&n.level))}getRemoteInboundOffset(){var t;const n=(t=this._p2pChannel.getStats())===null||t===void 0?void 0:t.audioSend[0];if(!n||!n.timestamp)return 0;const a=n.timestamp-Date.now();return Math.abs(a)>1e3+n.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?a:0}getNtpWallTimeInMs(){return document.visibilityState==="visible"&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(t,n){if(ai(t,"proxyServer"),!n){if(this.connectionState!=="DISCONNECTED")throw new ue(z.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new ue(z.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=t,We.setProxyServer(this._proxyServer),L.setProxyServer(this._proxyServer),L.info("[".concat(this._clientId,"] Set proxy server ").concat(n?"by initialize call":""," success."))}setTurnServer(t,n){if(Array.isArray(t)||(t=[t]),!n){if(this.connectionState!=="DISCONNECTED")throw new ue(z.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new ue(z.INVALID_OPERATION,"You have already set the proxy")}if(kh(t))return this._turnServer={servers:t,mode:"original-manual"},void L.info("[".concat(this._clientId,"] Set original turnserver ").concat(n?"by initialize call":""," success: ").concat(t.map(a=>a.urls).join(","),"."));t.forEach(a=>Wk(a)),this._turnServer={servers:t,mode:"manual"},L.info("[".concat(this._clientId,"] Set turnserver ").concat(n?"by initialize call":""," success."))}setLicense(t){if(this.connectionState!=="DISCONNECTED")throw new ue(z.INVALID_OPERATION,"you should set license before join channel");if(ai(t,"license",32,32),!/^[A-Za-z\d]+$/.test(t))throw new ue(z.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=t,L.info("[".concat(this._clientId,"] set license success"),t)}startProxyServer(t){if(this.connectionState!=="DISCONNECTED")throw new ue(z.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new ue(z.INVALID_OPERATION,"You have already set the proxy");const n=[3,4,5];let a;switch(t===void 0&&(t=3),t){case 1:case 2:throw new ue(z.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:a="proxy3";break;case 4:a="proxy4";break;case 5:a="proxy5";break;default:throw new ue(z.INVALID_PARAMS,"proxy server mode must be ".concat(n.join("|")))}this._cloudProxyServerMode=a,this.store.cloudProxyServerMode=a,L.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new ue(z.INVALID_OPERATION,"Stop proxy server after leave channel");We.setProxyServer(),L.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",L.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(t){if(!t.accessPoints)throw new ue(z.INVALID_PARAMS,"accessPoints is required.");Yc(t.accessPoints.serverList,"accessPoints.serverList"),ai(t.accessPoints.domain,"accessPoints.domain");const n=(k,G)=>{an(k,G,0,65535,!0)};let a=443;if(t.accessPoints.port&&(n(t.accessPoints.port,"accessPoints.port"),a=t.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new ue(z.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");J("CLOSE_AFB_FOR_LOCAL_AP")&&(sn("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),sn("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const l=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,u=t.accessPoints.domain,h=t.accessPoints.serverList.map(k=>l.test(k)?"".concat(k.replace(/\./g,"-"),".").concat(u):k),p=h.map(k=>"".concat(k,":").concat(a));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,sn("WEBCS_DOMAIN",p),sn("WEBCS_DOMAIN_BACKUP_LIST",p),sn("GATEWAY_DOMAINS",[u]),t.report&&t.report.hostname&&Array.isArray(t.report.hostname)&&t.report.hostname.length?(Yc(t.report.hostname,"report.hostname"),sn("EVENT_REPORT_DOMAIN",t.report.hostname[0]),sn("EVENT_REPORT_BACKUP_DOMAIN",t.report.hostname[1]||t.report.hostname[0])):(sn("EVENT_REPORT_DOMAIN",h[0]),sn("EVENT_REPORT_BACKUP_DOMAIN",h[1]||h[0]));let v=6443;t.report&&t.report.port&&(n(t.report.port,"report.port"),v=t.report.port),sn("STATS_COLLECTOR_PORT",v),t.report?sn("ENABLE_EVENT_REPORT",!0):sn("ENABLE_EVENT_REPORT",!1);let E="";t.log&&t.log.hostname&&Array.isArray(t.log.hostname)&&t.log.hostname.length?(Yc(t.log.hostname,"log.hostname"),E=t.log.hostname[0]):E=h[0];let y=6444;t.log&&t.log.port&&(n(t.log.port,"log.port"),y=t.log.port),sn("LOG_UPLOAD_SERVER","".concat(E,":").concat(y));let C=[];t.cds&&t.cds.hostname&&Array.isArray(t.cds.hostname)&&t.cds.hostname.length?(Yc(t.cds.hostname,"cds.hostname"),C=t.cds.hostname):C=h;let I=443;t.cds&&t.cds.port&&(n(t.cds.port,"cds.port"),I=t.cds.port),sn("CDS_AP",C.map(k=>"".concat(k,":").concat(I))),t.cds?sn("ENABLE_CONFIG_DISTRIBUTE",!0):sn("ENABLE_CONFIG_DISTRIBUTE",!1),L.info("set local access point v2 success")}setLocalAccessPoints(t,n){if(Yc(t,"serverList"),ai(n,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new ue(z.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const a=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;t=t.map(l=>a.test(l)?"".concat(l.replace(/\./g,"-"),".").concat(n):l),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,sn("WEBCS_DOMAIN",t),sn("WEBCS_DOMAIN_BACKUP_LIST",t),sn("GATEWAY_DOMAINS",[n]),sn("EVENT_REPORT_DOMAIN",t[0]),sn("EVENT_REPORT_BACKUP_DOMAIN",t[1]||t[0]),sn("LOG_UPLOAD_SERVER","".concat(t[0],":6444")),L.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(t){if(Sr(t,"streamType",[0,1]),this._remoteDefaultVideoStreamType=t,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(t),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(n){throw L.error("[".concat(this._clientId,"] set default remote video stream type error"),n.toString()),n}else L.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(t))}async setRemoteVideoStreamType(t,n){Sr(n,"streamType",[0,1]);try{await this._gateway.setRemoteVideoStreamType(t,n),setTimeout(()=>{const a=this._users.find(l=>l.uid===t);a&&a.videoTrack&&a.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(a){throw L.error("[".concat(this._clientId,"] set remote video stream type error"),a.toString()),a}L.info("[".concat(this._clientId,"] set remote ").concat(t," video stream type to ").concat(n)),this._remoteStreamTypeCacheMap.set(t,n)}async setStreamFallbackOption(t,n){Sr(n,"fallbackType",[0,1,2]);try{await this._gateway.setStreamFallbackOption(t,n)}catch(a){throw L.error("[".concat(this._clientId,"] set stream fallback option"),a.toString()),a}L.info("[".concat(this._clientId,"] set remote ").concat(t," stream fallback type to ").concat(n)),this._streamFallbackTypeCacheMap.set(t,n)}setEncryptionConfig(t,n,a){(function(u){Sr(u,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])})(t),ai(n,"secret");const l=["aes-128-gcm2","aes-256-gcm2"];if(Be(l).call(l,t)){if(!a||!(a instanceof Uint8Array&&a.length===32))throw new ue(z.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(a)throw new ue(z.INVALID_PARAMS,"current encrypt mode does not need salt");new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(n)||L.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=t,this._encryptionSecret=n,a&&(this._encryptionSalt=Mh(a))}async renewToken(t){if(ai(t,"token",1,2047),!this._key||!this._joinInfo)throw new ue(z.INVALID_OPERATION,"renewToken should not be called before user join");const n=this._key;this._key=t,this._joinInfo&&(this._joinInfo.token=t);const a=await this._renewTokenMutex.lock();try{if(J("USE_NEW_TOKEN")){L.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const l=await ite(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||ur);L.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:t,ticket:l})}else L.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:t});L.debug("[".concat(this._clientId,"] renewToken success"))}catch(l){throw this._key=n,this._joinInfo.token=n,L.error("[".concat(this._clientId,"] renewToken failed"),l.toString()),l}finally{a()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?L.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const t=this._p2pChannel.getAudioLevels();this.safeEmit(Nt.VOLUME_INDICATOR,t)},J("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const t=this._statsCollector.getRTCStats(),n=this._gateway.getInChannelInfo();return t.Duration=Math.round(n.duration/1e3),t}async startLiveStreaming(t,n){if(!n){if(this.codec!=="h264")throw new ue(z.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new ue(z.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(t)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(t))throw new ue(z.LIVE_STREAMING_TASK_CONFLICT);const a=n?br.TRANSCODE:br.RAW;return this._createLiveStreamingClient(a).startLiveStreamingTask(t,a)}setLiveTranscoding(t){return this._createLiveStreamingClient(br.TRANSCODE).setTranscodingConfig(t)}async stopLiveStreaming(t){const n=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(a=>a&&a.hasUrl(t));if(!n.length)throw new ue(z.INVALID_PARAMS,"can not find live streaming url to stop");await _e.all(n.map(a=>a&&a.stopLiveStreamingTask(t)))}async addInjectStreamUrl(t,n){if(!this._joinInfo)throw new ue(z.INVALID_OPERATION,"can not addInjectStreamUrl, no joininfo");const a=this._createLiveStreamingClient(br.INJECT);a.setInjectStreamConfig(n,0),await a.startLiveStreamingTask(t,br.INJECT)}async removeInjectStreamUrl(){var t;const n=this._createLiveStreamingClient(br.INJECT),a=Array.from(ks(t=n.streamingTasks).call(t)).find(l=>l.mode===br.INJECT);if(!this._joinInfo||!a)throw new ue(z.INVALID_OPERATION,"can remove addInjectStreamUrl, no joininfo or inject task");await n.stopLiveStreamingTask(a.url)}async startChannelMediaRelay(t){WU(t),await this._createChannelMediaRelayClient().startChannelMediaRelay(t)}async updateChannelMediaRelay(t){WU(t),await this._createChannelMediaRelayClient().updateChannelMediaRelay(t)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}sendStreamMessage(t){let n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new ue(z.INVALID_OPERATION,"can not send data stream, not joined");if((typeof t=="string"||t instanceof Uint8Array)&&(t={payload:t}),typeof t.payload=="string"){const a=new TextEncoder;t.payload=a.encode(t.payload)}if(new Blob([t.payload]).size>1024)throw new ue(z.INVALID_PARAMS,"stream message out of range.");return this._gateway.signal.request(Ke.DATA_STREAM,{payload:Mh(t.payload),syncWithAudio:t.syncWithAudio,sendTs:Date.now()-gre},!n)}sendMetadata(t){if(!this._joinInfo)throw new ue(z.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([t]).size>1024)throw new ue(z.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(Ke.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:Mh(t)})}async sendCustomReportMessage(t){if(Array.isArray(t)||(t=[t]),t.forEach(gee),!this._joinInfo)throw new ue(z.INVALID_OPERATION,"can not send custom report, not joined");await We.sendCustomReportMessage(this._joinInfo.sid,t)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(t,n){Sr(n.spatialLayer,"spatialLayer",[0,1,2,3]),Sr(n.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(t,n)}catch(a){throw L.error("[".concat(this._clientId,"] pick SVC layer failed"),a.toString()),a}}async setRTMConfig(t){const{apRTM:n=!1,rtmFlag:a}=t;if(Gl(n,"apRTM"),an(a,"rtmFlag",0),this._rtmConfig.apRTM=n,this._rtmConfig.rtmFlag=a,L.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify(t)," in ").concat(this.connectionState," state")),(this.connectionState==="CONNECTED"||this.connectionState==="RECONNECTING")&&this._joinInfo)return this._joinInfo.apRTM=n,this._joinInfo.rtmFlag=a,this._gateway.setRTM2Flag(a)}_reset(){if(L.debug("[".concat(this._clientId,"] reset client")),this._axiosCancelSource.cancel(),this._axiosCancelSource=ho.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._pendingPublishedUsers=[],this._users.forEach(t=>{t._audioTrack&&t._audioTrack._destroy(),t._videoTrack&&t._videoTrack._destroy(),t._dataChannels&&(t._dataChannels.forEach(n=>n._close()),t._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new Ur("client-publish"),this._subscribeMutex=new Ur("client-subscribe"),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._injectStreamingClient&&(this._injectStreamingClient.terminate(),this._injectStreamingClient.removeAllListeners(),this._injectStreamingClient=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession(t,n){var a;const l=t||Yb();t?L.debug("[".concat(this._clientId,"] new Session ").concat(l)):L.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(l));const u=t?"":this._sessionId||"";this._sessionId=l,this.store.sessionId=l;const h={lts:new Date().getTime(),mode:this.mode,stringUid:(n==null?void 0:n.stringUid)||((a=this._joinInfo)===null||a===void 0?void 0:a.stringUid),channelProfile:this.mode==="live"?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:u,clientRole:this.role==="audience"?2:1};n?We.sessionInit(this._sessionId,sl({cname:n.channel,appid:n.appId},h)):this._joinInfo?We.sessionInit(this._sessionId,sl({cname:this._joinInfo.cname,appid:this._joinInfo.appId},h)):this._gateway.joinInfo&&We.sessionInit(this._sessionId,sl({cname:this._gateway.joinInfo.cname,appid:this._gateway.joinInfo.appId},h)),this._joinInfo&&(this._joinInfo.sid=l),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=l)}async _publishHighStream(t){if(!this._joinInfo||this._uid===void 0)throw new ue(z.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ue(z.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&J("FORCE_TURN")&&!J("TURN_ENABLE_TCP")&&!J("TURN_ENABLE_UDP"))throw new ue(z.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");L.debug("[".concat(this._clientId,"] publish high stream"));try{const a=await this._p2pChannel.publish(t,this._isDualStreamEnabled,this._lowStreamParameter);if(this._p2pChannel instanceof Rr){const l=(await a.next()).value;if(l){try{await this._gateway.sendExtensionMessage(Mn.PUBLISH,l,!0)}catch(u){throw a.throw(u),u}await a.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{const l=(await a.next()).value;if(l){var n;let u;try{u=await this._gateway.publish(this._uid,l,!0)}catch(h){if(h.code!==z.DISCONNECT_P2P)throw a.throw(h),h}await a.next(((n=u)===null||n===void 0?void 0:n.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const u of t)u instanceof Rt&&u._encoderConfig&&this._gateway.setVideoProfile(u._encoderConfig),!u.muted&&u.enabled||await this._p2pChannel.muteLocalTrack(u)}}catch(a){if(this._p2pChannel.reportPublishEvent(!1,a==null?void 0:a.code,t),(a==null?void 0:a.code)===z.WS_ABORT)return;throw a}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new ue(z.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ue(z.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));L.debug("[".concat(this._clientId,"] publish low stream"));const t=this._configDistribute.getLowStreamConfigDistribute();t&&t.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&t.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=t.bitrate));try{const a=await this._p2pChannel.publishLowStream(this._lowStreamParameter),l=(await a.next()).value;if(l){var n;let u;try{u=await this._gateway.publish(this._uid,l,!0)}catch(h){if(h.code!==z.DISCONNECT_P2P)throw a.throw(h),h}a.next(((n=u)===null||n===void 0?void 0:n.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(a){if(this._p2pChannel.reportPublishEvent(!1,a==null?void 0:a.code,void 0,!0),(a==null?void 0:a.code)===z.WS_ABORT)return;throw a}}_createLiveStreamingClient(t){if(!this._joinInfo||!this._appId)return new ue(z.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const n=()=>new Kne(this._joinInfo,this._config.websocketRetryConfig||ur,this._config.httpRetryConfig||ur),a=l=>{l.onLiveStreamError=(u,h)=>{We.reportApiInvoke(this._sessionId,{name:gr.ON_LIVE_STREAM_ERROR,options:[u,h],tag:Pn.TRACER}).onSuccess(),this.safeEmit(Nt.LIVE_STREAMING_ERROR,u,h)},l.onLiveStreamWarning=(u,h)=>{We.reportApiInvoke(this._sessionId,{name:gr.ON_LIVE_STREAM_WARNING,options:[u,h],tag:Pn.TRACER}).onSuccess(),this.safeEmit(Nt.LIVE_STREAMING_WARNING,u,h)},l.on(Hh.REQUEST_WORKER_MANAGER_LIST,(u,h,p)=>{if(!this._joinInfo)return p(new ue(z.INVALID_OPERATION,"can not find join info to get worker manager"));$M(u,this._joinInfo,this._axiosCancelSource.token,ur).then(h).catch(p)})};switch(t){case br.RAW:return this._liveRawStreamingClient||(this._liveRawStreamingClient=n(),a(this._liveRawStreamingClient)),this._liveRawStreamingClient;case br.TRANSCODE:return this._liveTranscodeStreamingClient||(this._liveTranscodeStreamingClient=n(),a(this._liveTranscodeStreamingClient)),this._liveTranscodeStreamingClient;case br.INJECT:return this._injectStreamingClient||(this._injectStreamingClient=n(),this._injectStreamingClient.on(Hh.REQUEST_WORKER_MANAGER_LIST,(l,u,h)=>{if(!this._joinInfo)return h(new ue(z.INVALID_OPERATION,"can not find join info to get worker manager"));$M(l,this._joinInfo,this._axiosCancelSource.token,ur).then(u).catch(h)}),this._injectStreamingClient.onInjectStatusChange=(l,u,h)=>{this.safeEmit(Nt.INJECT_STREAM_STATUS,l,u,h)}),this._injectStreamingClient}}_createChannelMediaRelayClient(){if(!this._joinInfo)return new ue(z.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:t,sendResolutionHeight:n}=this.getLocalVideoStats(),a={width:t,height:n};this._channelMediaRelayClient=new qne(this._joinInfo,this._clientId,this._config.websocketRetryConfig||ur,this._config.httpRetryConfig||ur,a),this._channelMediaRelayClient.on("state",l=>{l===Wi.RELAY_STATE_FAILURE&&this._channelMediaRelayClient&&this._channelMediaRelayClient.dispose(),this.safeEmit(Nt.CHANNEL_MEDIA_RELAY_STATE,l)}),this._channelMediaRelayClient.on("event",l=>{this.safeEmit(Nt.CHANNEL_MEDIA_RELAY_EVENT,l)}),this._statsCollector.onStatsChanged=(l,u)=>{var h;l==="resolution"&&((h=this._channelMediaRelayClient)===null||h===void 0||h.setVideoProfile(u))}}return this._channelMediaRelayClient}_handleUpdateDataChannel(t,n){const{added:a,deleted:l}=t,u=[];Array.isArray(a)&&a.length>0&&a.forEach(h=>{const{uid:p,stream_id:v,ordered:E,max_retrans_times:y,metadata:C}=h,I=this._users.find(k=>k._uintid===p);if(!I)return void L.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"));if(L.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(p)),Be(u).call(u,I)||u.push(I),I._uintid||(I._uintid=p),I._dataChannels.findIndex(k=>k.id===h.stream_id)===-1){const k={id:v,ordered:!!E,maxRetransmits:y,metadata:C},G=new Rne(k);I._dataChannels.push(G),L.info("[".concat(this._clientId,"] remote user ").concat(I.uid," published datachannel")),n||this.safeEmit(Nt.USER_PUBLISHED,I,"datachannel",k)}this._p2pChannel.hasPendingRemoteDataChannel(I,h.stream_id)&&(L.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(I.uid," after reconnect.")),this._subscribeDataChannel(I,h.stream_id).catch(k=>{L.error("[".concat(this._clientId,"] resubscribe datachannel error"),k.toString())}))}),n&&(this.safeEmit(Nt.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(l)&&l.length>0&&l.forEach(h=>{const{uid:p,stream_id:v}=h,E=this._users.find(C=>C._uintid===p);if(!E)return void L.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const y=E._dataChannels.find(C=>C.id===h.stream_id);y&&(L.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(p)),this._p2pChannel.unsubscribeDataChannel(E,[y]).then(C=>{if(E._dataChannels=E._dataChannels.filter(I=>I!==y),C)return this._gateway.unsubscribeDataChannel(C,E.uid)}),L.info("[".concat(this._clientId,"] remote user ").concat(p," unpublished datachannel ,id:").concat(y.id)),this.safeEmit(Nt.USER_UNPUBLISHED,E,"datachannel",y._config))})}_handleRemoveDataChannels(t){const n=this._users.find(a=>a.uid===t.uid);if(n){if(n._dataChannels!==void 0&&n._dataChannels.length>0){L.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(t.uid));const a=()=>{L.info("[".concat(this._clientId,"] remote user ").concat(n.uid," unpublished datachannel")),n._dataChannels.forEach(l=>{this.safeEmit(Nt.USER_UNPUBLISHED,n,"datachannel",l._config)})};this._p2pChannel.unsubscribeDataChannel(n,n._dataChannels).then(l=>{if(l)return this._gateway.unsubscribeDataChannel(l,n.uid)}),a()}}else L.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(Ln.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(Ln.CONNECTION_STATE_CHANGE,(t,n,a)=>{var l;if(a===xt.FALLBACK)return;const u=()=>{this.safeEmit(Nt.CONNECTION_STATE_CHANGE,t,n,a)};if(We.reportApiInvoke(this._sessionId||((l=this._gateway.joinInfo)===null||l===void 0?void 0:l.sid)||null,{name:gr.CONNECTION_STATE_CHANGE,options:[t,n,a],tag:Pn.TRACER}).onSuccess(JSON.stringify({cur:t,prev:n,reason:a})),L.info("[".concat(this._clientId,"] connection state change: ").concat(n," -> ").concat(t)),t==="DISCONNECTED")return this._reset(),void u();if(t==="RECONNECTING")this._users.forEach(p=>{p._trust_in_room_=!1,p._trust_audio_enabled_state_=!1,p._trust_video_enabled_state_=!1,p._trust_audio_mute_state_=!1,p._trust_video_mute_state_=!1,p._trust_audio_stream_added_state_=!1,p._trust_video_stream_added_state_=!1,p._is_pre_created||(p._audio_pre_subscribed||(p._audioSSRC=void 0,p._audioOrtc=void 0),p._video_pre_subscribed||(p._videoSSRC=void 0,p._videoOrtc=void 0,p._rtxSsrcId=void 0),p._cname=void 0)}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(t==="CONNECTED"){var h;this._streamFallbackTypeCacheMap.forEach((p,v)=>{this._gateway.setStreamFallbackOption(v,p).catch(E=>{L.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),E)})}),this._remoteStreamTypeCacheMap.forEach((p,v)=>{this._gateway.setRemoteVideoStreamType(v,p).catch(E=>{L.warning("[".concat(this._clientId,"] auto set remote stream type failed"),E)})}),this._remoteDefaultVideoStreamType!==void 0&&((h=this._joinInfo)===null||h===void 0?void 0:h.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{L.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(p=>{L.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(p))}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(p=>!p._trust_in_room_).forEach(p=>{L.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(p.uid)),this._handleUserOffline({uid:p.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(p=>{p._trust_audio_mute_state_||(L.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(p.uid)),this._handleMuteStream(p.uid,je.AUDIO,!1)),p._trust_video_mute_state_||(L.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(p.uid)),this._handleMuteStream(p.uid,je.VIDEO,!1)),p._trust_audio_enabled_state_||(L.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(p.uid)),this._handleSetStreamLocalEnable("audio",p.uid,!0)),p._trust_video_enabled_state_||(L.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(p.uid)),this._handleSetStreamLocalEnable("video",p.uid,!0)),p._trust_video_stream_added_state_||(L.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(p.uid)),this._handleResetAddStream(p,"video")),p._trust_audio_stream_added_state_||(L.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(p.uid)),this._handleResetAddStream(p,"audio")),p._video_added_||p._audio_added_||(L.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(p.uid)),this._handleRemoveStream({uid:p.uid,uint_id:p._uintid}))}))},1e3))}u()}),this._gateway.on(Ln.REQUEST_NEW_GATEWAY_LIST,(t,n)=>{if(!this._joinInfo)return n(new ue(z.UNEXPECTED_ERROR,"can not recover, no join info"));jT(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||ur,this.store).then(a=>{this._joinInfo&&(this._joinInfo.apResponse=a.gatewayInfo.res,this._joinInfo.gatewayAddrs=a.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=a.gatewayInfo.uni_lbs_ip);const l=[];a.gatewayInfo.gatewayAddrs.forEach(u=>{let{address:h}=u;const[p,v]=h.split(":");this._joinInfo&&this._joinInfo.proxyServer?l.push({proxy:this._joinInfo.proxyServer,host:p,port:v}):l.push({host:p,port:v})}),t(l)}).catch(n)}),this._gateway.on(Ln.NETWORK_QUALITY,t=>{this._networkQualitySensitivity==="normal"&&this.safeEmit(Nt.NETWORK_QUALITY,t)}),this._gateway.on(Ln.STREAM_TYPE_CHANGE,(t,n)=>{this.safeEmit(Nt.STREAM_TYPE_CHANGED,t,n),We.reportApiInvoke(this._sessionId,{name:gr.STREAM_TYPE_CHANGE,options:[t,n],tag:Pn.TRACER}).onSuccess(JSON.stringify({uid:t,streamType:n}))}),this._gateway.on(Ln.IS_P2P_DISCONNECTED,t=>{this._p2pChannel.isP2PDisconnected()?t(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?t(!1):t(!0)}),this._gateway.on(Ln.NEED_RENEW_SESSION,()=>{this._startSession()}),this._gateway.on(Ln.REQUEST_P2P_CONNECTION_PARAMS,async(t,n,a)=>{try{n(await this._p2pChannel.startP2PConnection(t))}catch(l){a(l)}}),this._gateway.on(Ln.JOIN_RESPONSE,(t,n)=>{if(this.store.useP2P)return;const{dtlsParameters:a,iceParameters:l,candidates:u,rtpCapabilities:h,setup:p,cname:v}=DU(t.ortc,n);this._p2pChannel.connect(l,a,u,h,p,v)}),this._gateway.on(Ln.REQUEST_DC_CONNECTION_PARAMS,t=>{t(this._p2pChannel.getEstablishParams())}),this._gateway.on(Ln.RESET_SIGNAL,t=>{this._p2pChannel.resetConnection(t),this._handleGatewaySignalEvents()}),this._gateway.on(Ln.DATACHANNEL_FAILBACK,()=>{this._joinGateway()}),this._gateway.on(Ln.DATACHANNEL_PRECONNECT,async(t,n,a,l)=>{var u,h,p,v,E,y;await this._p2pChannel.startP2PConnection({turnServer:(u=this._joinInfo)===null||u===void 0?void 0:u.turnServer},!0);const C=function(I,k){let G;return k&&k.ip&&typeof k.port=="number"?(G=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:k.ip,port:k.port.toString(),type:"host",extension:{}}],L.debug("Using remote candidate from AP ".concat(k.ip,":").concat(k.port)),k.ip6&&(G.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:k.ip6,port:k.port.toString(),type:"host",extension:{}}),L.debug("Using IPV6 remote candidate from AP ".concat(k.ip6,":").concat(k.port)))):G=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:I.ip,port:I.port.toString(),type:"host",extension:{}}],G}(t,n);return this._p2pChannel.preConnect({iceUfrag:"".concat((h=this._joinInfo)===null||h===void 0?void 0:h.apResponse.cid,"_").concat((p=this._joinInfo)===null||p===void 0?void 0:p.apResponse.cert),icePwd:"".concat((v=this._joinInfo)===null||v===void 0?void 0:v.apResponse.cid,"_").concat((E=this._joinInfo)===null||E===void 0?void 0:E.apResponse.cert)},{fingerprints:[{hashFunction:"sha-256",fingerprint:(y=J("FINGERPRINT"))!==null&&y!==void 0?y:t.fingerprint}]},C,{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},"active","o/i14u9pJrxRKAsu").then(a).catch(l)})}_handleGatewaySignalEvents(){this._gateway.signal.on(ot.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(ot.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(ot.ON_ADD_AUDIO_STREAM,t=>this._handleAddAudioOrVideoStream("audio",t.uid,t.ssrcId,t.cname,t.uint_id,t.ortc)),this._gateway.signal.on(ot.ON_ADD_VIDEO_STREAM,t=>this._handleAddAudioOrVideoStream("video",t.uid,t.ssrcId,t.cname,t.uint_id,t.ortc,t.rtxSsrcId)),this._gateway.signal.on(ot.ON_REMOTE_DATASTREAM_UPDATE,t=>{this._handleUpdateDataChannel(t)}),this._gateway.signal.on(ot.ON_REMOTE_FULL_DATASTREAM_INFO,t=>{this._handleUpdateDataChannel({added:t.datastreams,deleted:[]},!0)}),this._gateway.signal.on(ot.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(ot.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(ot.MUTE_AUDIO,t=>this._handleMuteStream(t.uid,je.AUDIO,!0)),this._gateway.signal.on(ot.UNMUTE_AUDIO,t=>this._handleMuteStream(t.uid,je.AUDIO,!1)),this._gateway.signal.on(ot.MUTE_VIDEO,t=>this._handleMuteStream(t.uid,je.VIDEO,!0)),this._gateway.signal.on(ot.UNMUTE_VIDEO,t=>this._handleMuteStream(t.uid,je.VIDEO,!1)),this._gateway.signal.on(ot.RECEIVE_METADATA,t=>{const n=_v(t.metadata);this.safeEmit(Nt.RECEIVE_METADATA,t.uid,n)}),this._gateway.signal.on(ot.ON_DATA_STREAM,async t=>{if(!t)return;let n=0;if(t.ordered||t.syncWithAudio){const a=this._p2pChannel.getStats(),l=this.remoteUsers.find(h=>h.uid===t.uid),u=a==null?void 0:a.audioRecv.find(h=>h.ssrc===(l==null?void 0:l._audioSSRC));n=u==null?void 0:u.jitterBufferMs}n==null&&(n=0),Ere(t,n,{id:this._clientId,onStreamMessage:typeof this.onStreamMessage=="function"?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})}),this._gateway.signal.on(ot.ON_CRYPT_ERROR,()=>{o0(()=>{L.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(Nt.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(ot.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(ot.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{L.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,xt.TOKEN_EXPIRE),this.safeEmit(Nt.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(ot.ON_STREAM_FALLBACK_UPDATE,t=>{L.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(t.stream_id,", attr: ").concat(t.stream_type)),this.safeEmit(Nt.STREAM_FALLBACK,t.stream_id,t.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(ot.ON_PUBLISH_STREAM,t=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:t.proxy})),L.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(t))))}),this._gateway.signal.on(ot.ENABLE_LOCAL_VIDEO,t=>{this._handleSetStreamLocalEnable("video",t.uid,!0)}),this._gateway.signal.on(ot.DISABLE_LOCAL_VIDEO,t=>{this._handleSetStreamLocalEnable("video",t.uid,!1)}),this._gateway.signal.on(Me.REQUEST_TIMEOUT,(t,n)=>{if(this._joinInfo)switch(t){case Ke.PUBLISH:{if(!n)return;const u=n.ortc;if(u){var a,l;const h=u.some(E=>{let{stream_type:y}=E;return y===Kt.Audio}),p=u.some(E=>{let{stream_type:y}=E;return y!==Kt.Audio}),v=u.some(E=>{let{stream_type:y}=E;return y===Kt.Screen||y===Kt.ScreenLow});n.state==="offer"&&We.publish(this._joinInfo.sid,{eventElapse:li.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:z.TIMEOUT,audio:h,video:p,p2pid:n.p2p_id,publishRequestid:this.store.pubId,screenshare:v,audioName:h?(a=u.find(E=>{let{stream_type:y}=E;return y===Kt.Audio}))===null||a===void 0||(a=a.ssrcs[0])===null||a===void 0?void 0:a.ssrcId.toString():void 0,videoName:p?(l=u.find(E=>{let{stream_type:y}=E;return y!==Kt.Audio}))===null||l===void 0||(l=l.ssrcs[0])===null||l===void 0?void 0:l.ssrcId.toString():void 0})}break}case Ke.SUBSCRIBE:n&&We.subscribe(this._joinInfo.sid,{succ:!1,ec:z.TIMEOUT,audio:n.stream_type===je.AUDIO,video:n.stream_type===je.VIDEO,peerid:n.stream_id,subscribeRequestid:n.ssrcId,p2pid:this.store.p2pId,eventElapse:li.measureFromSubscribeStart(this.store.clientId,n.ssrcId)})}}),this._gateway.signal.on(ot.ON_P2P_OK,t=>{this.uid,this._uid}),this._gateway.signal.on(ot.ON_PUBLISHED_USER_LIST,t=>{if(t==null||!t.users)return;J("BLOCK_LOCAL_CLIENT")&&(t.users=t.users.filter(l=>!hd(l.string_id||l.stream_id,this.channelName)));const n=[],a=[];for(const l of t.users){let u=this._users.find(C=>C._uintid===l.stream_id);u?u._trust_in_room_=!0:(u=new Kr(l.string_id||l.stream_id,l.stream_id),this._users.push(u),this.getListeners(Nt.PUBLISHED_USER_LIST).length===0&&(L.debug("[".concat(this._clientId,"] user online"),l.stream_id),this.safeEmit(Nt.USER_JOINED,u)));const h=vr.Audio&l.stream_type,p=(vr.Video|vr.LwoVideo)&l.stream_type,v=(65280&l.stream_type)!=0,E=h&&u.hasAudio,y=p&&u.hasVideo;p&&(u._trust_video_stream_added_state_=!0,u._video_added_=!0,u._videoSSRC=l.video_ssrc,u._rtxSsrcId=l.video_rtx),h&&(u._trust_audio_stream_added_state_=!0,u._audio_added_=!0,u._audioSSRC=l.audio_ssrc),h&&!E&&this.getListeners(Nt.PUBLISHED_USER_LIST).length===0&&(L.info("[".concat(this._clientId,"] remote user ").concat(u.uid," published audio")),this.safeEmit(Nt.USER_PUBLISHED,u,"audio")),p&&!y&&this.getListeners(Nt.PUBLISHED_USER_LIST).length===0&&(L.info("[".concat(this._clientId,"] remote user ").concat(u.uid," published video")),this.safeEmit(Nt.USER_PUBLISHED,u,"video")),(h&&!E||p&&!y||v)&&n.push(u),p&&this._p2pChannel.hasPendingRemoteMedia(u,"video")&&a.push({user:u,mediaType:"video"}),h&&this._p2pChannel.hasPendingRemoteMedia(u,"audio")&&a.push({user:u,mediaType:"audio"})}a.length>0&&(L.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(a.map(l=>"user: ".concat(l.user.uid,", mediaType: ").concat(l.mediaType)).join("; ")," ")),this.massSubscribe(a).catch(l=>{L.error("[".concat(this._clientId,"] mass resubscribe error"),l.toString())})),this.getListeners(Nt.PUBLISHED_USER_LIST).length>0?J("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=n:(L.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(n.map(l=>l.uid).join(", "))),this.safeEmit(Nt.PUBLISHED_USER_LIST,n)):L.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(n.map(l=>l.uid).join(", ")))}),this._gateway.signal.on(ot.ON_RTP_CAPABILITY_CHANGE,t=>{const{video_codec:n}=t;this._p2pChannel instanceof $r&&this._p2pChannel.updateRemoteRTPCapabilities(n.map(a=>a.toLowerCase()).filter(a=>{var l;return Be(l=Object.keys(Yl)).call(l,a)}))})}_handleP2PEvents(){this._gateway.signal.on(ot.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(Mn.PUBLISH,(t,n,a)=>{const{uid:l}=t;t.forEach(u=>{const{kind:h,ssrcs:p,mid:v,isMuted:E}=u;this._handleP2PAddAudioOrVideoStream(h,l,p[0].ssrcId,v);const y=this._users.find(C=>C.uid===l);return y&&this._p2pChannel instanceof Rr?this._p2pChannel.mockSubscribe(y,h,p[0].ssrcId,v).then(()=>{n()}).catch(a):n(),this._handleMuteStream(l,h,!!E)})}),this._gateway.signal.on(Mn.CALL,async(t,n,a)=>{if(this._p2pChannel instanceof Rr)try{var l;n(await this._p2pChannel.startP2P({turnServer:(l=this._joinInfo)===null||l===void 0?void 0:l.turnServer},t))}catch(u){a(u)}}),this._gateway.signal.on(Me.P2P_CONNECTION,async t=>{this._p2pChannel instanceof Rr&&await this._p2pChannel.p2pConnect(t)}),this._gateway.signal.on(Mn.UNPUBLISH,async(t,n,a)=>{if(this._p2pChannel instanceof Rr){const{unpubMsg:l,uid:u}=t,h=this._users.find(p=>p.uid===u);if(!h)return L.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(u)),void n();try{l.forEach(async p=>{let{stream_type:v}=p;const E=v===Kt.Audio?je.AUDIO:je.VIDEO;await this._p2pChannel.unsubscribe(h,E),this._handleMuteStream(u,E,!0)}),n()}catch(p){a(p)}}}),this._gateway.signal.on(Mn.CONTROL,async(t,n)=>{const{action:a}=t;switch(a){case yc.MUTE_LOCAL_VIDEO:this._handleMuteStream(n,je.VIDEO,!0);break;case yc.MUTE_LOCAL_AUDIO:this._handleMuteStream(n,je.AUDIO,!0);break;case yc.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",n),this._handleMuteStream(n,je.VIDEO,!1);break;case yc.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",n),this._handleMuteStream(n,je.AUDIO,!1)}}),this._gateway.signal.on(Mn.RESTART_ICE,async(t,n,a)=>{if(this._p2pChannel instanceof Rr)try{const{direction:l,iceParameter:u}=t;l!==vi.SEND_ONLY||u?n(await this._p2pChannel.restartICE(l,u)):(this._p2pChannel.handleDisconnect(l),n())}catch(l){a(l)}}),this._gateway.signal.on(Mn.CANDIDATE,t=>{if(this._p2pChannel instanceof Rr){const{candidate:n,direction:a}=t;this._p2pChannel.addRemoteCandidate(n,a)}}),this._p2pChannel.on(Qe.RequestP2PRestartICE,async(t,n,a)=>{try{const{direction:l}=t;n(await this._gateway.sendExtensionMessage(Mn.RESTART_ICE,t,l===vi.SEND_ONLY))}catch(l){a(l)}}),this._p2pChannel.on(Qe.LocalCandidate,t=>{this._gateway.sendExtensionMessage(Mn.CANDIDATE,JSON.stringify(t),!0)}),this._p2pChannel.on(Qe.RequestP2PMuteLocal,async(t,n,a)=>{try{await this._gateway.sendExtensionMessage(Mn.CONTROL,t,!0),n()}catch(l){a(l)}}),this._p2pChannel.on(Qe.RequestP2PUnmuteRemote,async(t,n,a)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(t,this._joinInfo.stringUid||this._joinInfo.uid),n()}catch(l){l.code===z.DISCONNECT_P2P?n():a(l)}else n()}),this._p2pChannel.on(Qe.RequestP2PMuteRemote,async(t,n,a)=>{if(this._joinInfo)try{await this._gateway.muteRemote(t,this._joinInfo.stringUid||this._joinInfo.uid),n()}catch(l){l.code===z.DISCONNECT_P2P?n():a(l)}else n()}),this._p2pChannel.on(Qe.StateChange,(t,n)=>{n===tn.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){this._p2pChannel.on(Qe.RequestMuteLocal,async(t,n,a)=>{if(this._joinInfo)try{await this._gateway.muteLocal(t,this._joinInfo.stringUid||this._joinInfo.uid),n()}catch(l){l.code===z.DISCONNECT_P2P?n():a(l)}else n()}),this._p2pChannel.on(Qe.RequestUnmuteLocal,async(t,n,a)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(t,this._joinInfo.stringUid||this._joinInfo.uid),n()}catch(l){l.code===z.DISCONNECT_P2P?n():a(l)}else n()}),this._p2pChannel.on(Qe.RequestRePublish,(t,n,a)=>{this.publish(t,!1).then(n).catch(a)}),this._p2pChannel.on(Qe.RequestRePublishDataChannel,(t,n,a)=>{_e.all(t.map(async l=>{await this._p2pChannel.publishDataChannel([l]);const u={streamId:l.id,ordered:l.ordered,maxRetransmits:l.maxRetransmits,metadata:l.metadata,channelId:l._originDataChannelId};try{await this._gateway.publishDataChannel(this._uid,u,!0)}catch(h){if(h.code!==z.DISCONNECT_P2P)throw h}})).then(n).catch(a)}),this._p2pChannel.on(Qe.RequestReSubscribe,async(t,n,a)=>{try{for(const{user:l,kind:u}of t)u===je.VIDEO?await this.subscribe(l,"video"):await this.subscribe(l,"audio");n()}catch(l){a(l)}}),this._p2pChannel.on(Qe.RequestUpload,(t,n)=>{this._gateway.upload(t,n)}),this._p2pChannel.on(Qe.RequestUploadStats,t=>{this._gateway.uploadWRTCStats(t)}),this._p2pChannel.on(Qe.MediaReconnectStart,t=>{this.safeEmit(Nt.MEDIA_RECONNECT_START,t)}),this._p2pChannel.on(Qe.MediaReconnectEnd,t=>{this.safeEmit(Nt.MEDIA_RECONNECT_END,t)}),this._p2pChannel.on(Qe.NeedSignalRTT,t=>{t(this._gateway.getSignalRTT())}),this._p2pChannel.on(Qe.RequestRestartICE,async t=>{if(this._p2pChannel instanceof Rr)return;const n=await this._p2pChannel.restartICE(t),a=await n.next();if(a.done)return;const l=a.value;let u;try{u=await this._gateway.restartICE({iceParameters:l})}catch(p){return void n.throw(p)}const{iceParameters:h}=function(p){const v=p.iceParameters;return{iceParameters:{iceUfrag:v.iceUfrag,icePwd:v.icePwd}}}(u);await n.next({remoteIceParameters:h})}),this._p2pChannel.on(Qe.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(Qe.RequestReconnectPC,async()=>{var t;const{iceParameters:n,dtlsParameters:a,rtpCapabilities:l}=await this._p2pChannel.startP2PConnection({turnServer:(t=this._joinInfo)===null||t===void 0?void 0:t.turnServer}),{gatewayEstablishParams:u,gatewayAddress:h}=await this._gateway.reconnectPC({iceParameters:n,dtlsParameters:a,rtpCapabilities:l}),{dtlsParameters:p,iceParameters:v,candidates:E,rtpCapabilities:y,setup:C,cname:I}=DU(u,h);await this._p2pChannel.connect(v,p,E,y,C,I),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(Qe.RequestUnpublishForReconnectPC,async(t,n,a)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(t,this._uid),n()):a()}),this._p2pChannel.on(Qe.P2PLost,()=>{this.safeEmit(Nt.P2P_LOST,this.store.uid)}),this._p2pChannel.on(Qe.UpdateVideoEncoder,t=>{t._encoderConfig&&this._gateway.setVideoProfile(t._encoderConfig)}),this._p2pChannel.on(Qe.ConnectionTypeChange,t=>{this.safeEmit(Nt.IS_USING_CLOUD_PROXY,t)}),this._p2pChannel.on(Qe.RequestLowStreamParameter,t=>{t(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(Qe.QueryClientConnectionState,t=>{t(this.connectionState)})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(t){if(this.connectionState!=="CONNECTED"||!this._joinInfo)throw new ue(z.INVALID_OPERATION,"[".concat(this._clientId,"] Client did not join channel"));if(this._inspect)throw new ue(z.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));if(!t)throw new ue(z.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig is necessary"));if(!t.inspectType||!Array.isArray(t.inspectType))throw new ue(z.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.inspectType is necessary and is an instance of Array."));{const n=[...new Set(t.inspectType)];n.forEach(a=>{var l;if(!Be(l=["supervise","moderation"]).call(l,a))throw new ue(z.INVALID_PARAMS,"[".concat(this._clientId,"] ").concat(a," is not a valid inspect type."))}),t.inspectType=n}if(t&&t.extraInfo&&t.extraInfo.length>1024)throw new ue(z.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.extraInfo length cannot exceed 1024 bytes"));try{const n=new bE(t);this._inspect=n,this.handleVideoInspectEvents(this._inspect),await n.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},ur)}catch(n){throw Array.isArray(n)?n[0]:n}}async disableContentInspect(){if(!this._inspect)throw new ue(z.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(t){throw Array.isArray(t)?t[0]:t}}async setImageModeration(t,n){if(Gl(t,"enabled"),t){if(!n)throw new ue(z.INVALID_PARAMS,"[".concat(this._clientId,"] config is necessary"));if(an(n.interval,"interval",1e3,1/0),n&&n.extraInfo&&n.extraInfo.length>1024)throw new ue(z.INVALID_PARAMS,"[".concat(this._clientId,"] config.extraInfo length cannot exceed 1024 bytes"));if(n&&n.vendor&&n.vendor.length>1024)throw new ue(z.INVALID_PARAMS,"[".concat(this._clientId,"] config.vendor length cannot exceed 1024 bytes"));if(this.connectionState!=="CONNECTED"||!this._joinInfo)throw new ue(z.INVALID_OPERATION,"[".concat(this._clientId,'] can not enable image moderation, not joined"'));try{if(this._moderation)return void this._moderation.updateConfig(n);const a=new qR(n);this._moderation=a,this.handleImageModerationEvents(this._moderation),await a.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},ur)}catch(a){throw Array.isArray(a)?a[0]:a}}else{if(!this._moderation)throw new ue(z.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(a){throw Array.isArray(a)?a[0]:a}}}setP2PTransport(t){if(function(n){Sr(n,"transport",["default","auto","relay","sd-rtn"])}(t),this.mode!=="p2p")throw new ue(z.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=t,L.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(t))}handleImageModerationEvents(t){t.on(wa.CONNECTION_STATE_CHANGE,(n,a)=>{if(this.safeEmit(Nt.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,n,a),n===Po.CONNECTED){if(this.connectionState!=="CONNECTED")throw this.setImageModeration(!1),new ue(z.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");t.inspectImage()}}),t.on(wa.CLIENT_LOCAL_VIDEO_TRACK,n=>{n(this.localTracks.filter(a=>a.trackMediaType==="video")[0])})}handleVideoInspectEvents(t){t.on(Tr.CONNECTION_STATE_CHANGE,(n,a)=>{if(this.safeEmit(Nt.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,n,a),a===qo.CONNECTED){if(this.connectionState!=="CONNECTED")return void this.safeEmit(Nt.CONTENT_INSPECT_ERROR,new ue(z.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));t.inspectImage()}}),t.on(Tr.INSPECT_RESULT,(n,a)=>{var l;if((a==null?void 0:a.code)===z.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return L.debug("Stop inspect content because that has left channel"),this==null||(l=this._inspect)===null||l===void 0||l.close(),void(this._inspect=void 0);this.safeEmit(Nt.CONTENT_INSPECT_RESULT,n,a)}),t.on(Tr.CLIENT_LOCAL_VIDEO_TRACK,n=>{n(this.localTracks.filter(a=>a.trackMediaType==="video")[0])})}getJoinChannelServiceRecords(){return L.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(t){Gl(t,"enabled"),sn("ENABLE_PUBLISH_AUDIO_FILTER",t),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(t)}_handleResetAddStream(t,n){switch(n){case"audio":t._audio_added_=!1,t._trust_audio_stream_added_state_=!0;break;case"video":t._video_added_=!1,t._trust_video_stream_added_state_=!0}}}Re([Je(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",_e)],rn.prototype,"leave",null),Re([Je({argsMap:(i,t)=>{if(!Array.isArray(t)){if(!(t instanceof ci))return[t];t=[t]}return t.map(n=>n?Object(n).toString():"null")}}),H("design:type",Function),H("design:paramtypes",[Object,Boolean]),H("design:returntype",_e)],rn.prototype,"publish",null),Re([Je({argsMap:(i,t)=>(t||(t=[]),t instanceof pU?[t.getChannelId()]:(Array.isArray(t)||(t=[t]),t.map(n=>n.getTrackId())))}),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",_e)],rn.prototype,"unpublish",null),Re([Je({argsMap:(i,t,n,a)=>[t.uid,n,a]}),H("design:type",Function),H("design:paramtypes",[Kr,String,Number]),H("design:returntype",_e)],rn.prototype,"subscribe",null),Re([Je({argsMap:(i,t,n)=>[t,n]}),H("design:type",Function),H("design:paramtypes",[Object,String]),H("design:returntype",_e)],rn.prototype,"presubscribe",null),Re([Je({argsMap:(i,t)=>t.map(n=>{let{user:a,mediaType:l}=n;return[a==null?void 0:a.uid,l]})}),H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],rn.prototype,"massSubscribe",null),Re([Je({argsMap:(i,t,n,a)=>[t.uid,n,a]}),H("design:type",Function),H("design:paramtypes",[Kr,String,Number]),H("design:returntype",_e)],rn.prototype,"unsubscribe",null),Re([Je({argsMap:(i,t)=>t.map(n=>{let{user:a,mediaType:l}=n;return{uid:a==null?void 0:a.uid,mediaType:l}})}),H("design:type",Function),H("design:paramtypes",[Array]),H("design:returntype",_e)],rn.prototype,"massUnsubscribe",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",_e)],rn.prototype,"setLowStreamParameter",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",_e)],rn.prototype,"enableDualStream",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",_e)],rn.prototype,"disableDualStream",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[String,Object]),H("design:returntype",_e)],rn.prototype,"setClientRole",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[String,Boolean]),H("design:returntype",void 0)],rn.prototype,"setProxyServer",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[Object,Boolean]),H("design:returntype",void 0)],rn.prototype,"setTurnServer",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",void 0)],rn.prototype,"setLicense",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[Number]),H("design:returntype",void 0)],rn.prototype,"startProxyServer",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],rn.prototype,"stopProxyServer",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",void 0)],rn.prototype,"setLocalAccessPointsV2",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[Array,String]),H("design:returntype",void 0)],rn.prototype,"setLocalAccessPoints",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[Number]),H("design:returntype",_e)],rn.prototype,"setRemoteDefaultVideoStreamType",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[Object,Number]),H("design:returntype",_e)],rn.prototype,"setRemoteVideoStreamType",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[Object,Number]),H("design:returntype",_e)],rn.prototype,"setStreamFallbackOption",null),Re([Je({argsMap:(i,t)=>[t]}),H("design:type",Function),H("design:paramtypes",[String,String,Uint8Array]),H("design:returntype",void 0)],rn.prototype,"setEncryptionConfig",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],rn.prototype,"renewToken",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",void 0)],rn.prototype,"enableAudioVolumeIndicator",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[String,Boolean]),H("design:returntype",_e)],rn.prototype,"startLiveStreaming",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",_e)],rn.prototype,"setLiveTranscoding",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",_e)],rn.prototype,"stopLiveStreaming",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[String,Object]),H("design:returntype",_e)],rn.prototype,"addInjectStreamUrl",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",_e)],rn.prototype,"removeInjectStreamUrl",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[vE]),H("design:returntype",_e)],rn.prototype,"startChannelMediaRelay",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[vE]),H("design:returntype",_e)],rn.prototype,"updateChannelMediaRelay",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",_e)],rn.prototype,"stopChannelMediaRelay",null),Re([Je({argsMap:(i,t)=>(Array.isArray(t)||(t=[t]),[JSON.stringify(t)])}),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",_e)],rn.prototype,"sendCustomReportMessage",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[Object,Object]),H("design:returntype",_e)],rn.prototype,"pickSVCLayer",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",_e)],rn.prototype,"setRTMConfig",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",_e)],rn.prototype,"enableContentInspect",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",_e)],rn.prototype,"disableContentInspect",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[Boolean,Object]),H("design:returntype",_e)],rn.prototype,"setImageModeration",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[String]),H("design:returntype",void 0)],rn.prototype,"setP2PTransport",null),Re([Je({reportResult:!0}),H("design:type",Function),H("design:paramtypes",[]),H("design:returntype",Array)],rn.prototype,"getJoinChannelServiceRecords",null),Re([Je(),H("design:type",Function),H("design:paramtypes",[Boolean]),H("design:returntype",_e)],rn.prototype,"setPublishAudioFilterEnabled",null);class j0{constructor(t,n){w(this,"id",0),w(this,"element",void 0),w(this,"peerPair",void 0),w(this,"context",void 0),w(this,"audioPlayerElement",void 0),w(this,"audioTrack",void 0),j0.count+=1,this.id=j0.count,this.element=t,this.context=n}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=t=>{const n=document.createElement("audio");n.srcObject=new MediaStream([t.track]),n.play(),this.audioPlayerElement=n}}async switchSdp(){if(!this.peerPair)return;const t=async(a,l)=>{const u=l==="offer"?await a.createOffer():await a.createAnswer();return await a.setLocalDescription(u),a.iceGatheringState==="complete"?a.localDescription:new _e(h=>{a.onicegatheringstatechange=()=>{a.iceGatheringState==="complete"&&h(a.localDescription)}})},n=async(a,l)=>await a.setRemoteDescription(l);try{const a=await t(this.peerPair[0],"offer");await n(this.peerPair[1],a);const l=await t(this.peerPair[1],"answer");await n(this.peerPair[0],l)}catch(a){throw new ue(z.LOCAL_AEC_ERROR,a.toString()).print()}}async getTracksFromMediaElement(t){if(this.audioTrack)return this.audioTrack;let n;try{t instanceof HTMLVideoElement&&(t.captureStream?t.captureStream():t.mozCaptureStream()),n=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(t).connect(n)}catch(l){throw new ue(z.LOCAL_AEC_ERROR,l.toString()).print()}if(!n)throw new ue(z.LOCAL_AEC_ERROR,"no dest node when local aec").print();const a=n.stream.getAudioTracks()[0];return this.audioTrack=a,a}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const t=this.element,n=await this.getTracksFromMediaElement(t);this.peerPair&&this.peerPair[0].addTrack(n),await this.switchSdp()}close(){L.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(t=>{t.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}w(j0,"count",0);const Sre=window.AudioContext||window.webkitAudioContext;class x4{constructor(){w(this,"units",[]),w(this,"context",void 0)}processExternalMediaAEC(t){if(!this._doesEnvironmentNeedAEC())return L.debug("the system does not need to process local aec"),-1;this.context||(this.context=new Sre);let n=this.units.find(a=>a&&a.getElement()===t);return n||(n=new j0(t,this.context),this.units.push(n)),n.startEchoCancellation(),L.debug("start processing local audio echo cancellation, id is",n.id),n.id}_doesEnvironmentNeedAEC(){return Wt().name!==qt.SAFARI}}Re([Je({report:We}),H("design:type",Function),H("design:paramtypes",[HTMLAudioElement]),H("design:returntype",Number)],x4.prototype,"processExternalMediaAEC",null);const Cre=new x4;function N4(i,t){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,a)}return n}function P4(i){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?N4(Object(n),!0).forEach(function(a){w(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):N4(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}const JR=window||document;function D4(i){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!JR)return;const n=hr._cspEventHandlerPointer;if(n&&t)return void console.error(n,t);const a=l=>{if(!(l&&l.blockedURI&&(hr.onSecurityPolicyViolation||hr.getListeners(ts.SECURITY_POLICY_VIOLATION).length>0)))return;const u=l.blockedURI;J("CSP_DETECTED_HOSTNAME_LIST").some(h=>Be(u).call(u,h))&&(hr.onSecurityPolicyViolation&&typeof hr.onSecurityPolicyViolation=="function"&&hr.onSecurityPolicyViolation(l),hr.getListeners(ts.SECURITY_POLICY_VIOLATION).length>0&&hr.safeEmit(ts.SECURITY_POLICY_VIOLATION,l))};n&&JR.removeEventListener("securitypolicyviolation",n),(t||i&&typeof i=="function"||hr.getListeners(ts.SECURITY_POLICY_VIOLATION).length>0)&&JR.addEventListener("securitypolicyviolation",a),hr._cspEventHandlerPointer=a}sn("PROCESS_ID","process-".concat(pn(8,""),"-").concat(pn(4,""),"-").concat(pn(4,""),"-").concat(pn(4,""),"-").concat(pn(12,""))),function(){let i;try{i=window.localStorage.getItem("websdk_ng_global_parameter")}catch(t){return void L.error("Error loading sdk config",t.message)}if(i)try{const t=JSON.parse(window.atob(i)),n=Date.now();L.debug("Loading global parameters from cache",t),Object.keys(t).forEach(a=>{if(Object.prototype.hasOwnProperty.call($i,a)){const{value:l,expires:u}=t[a];if(u&&u<=n)return;Kl[a]=l,$i[a]=l}})}catch(t){L.error("Error loading mutableParamsCache: ".concat(i),t.message)}}(),Array.isArray(Kl.AREAS)&&Kl.AREAS.length>0&&MT(Kl.AREAS,!0);const k4=(i,t,n)=>{L.debug("setParameter key:".concat(i,", value:").concat(JSON.stringify(t))),sn(i,t,n)},hr=function(i){const t=new wn,n=i,a={getListeners:t.getListeners.bind(t),on:(l,u)=>(function(h,p){h===ts.SECURITY_POLICY_VIOLATION&&D4(p,!0)}(l,u),t.on.bind(t)(l,u)),addListener:t.addListener.bind(t),once:t.once.bind(t),off:t.off.bind(t),removeAllListeners:t.removeAllListeners.bind(t),emit:t.emit.bind(t),safeEmit:t.safeEmit.bind(t)};return P4(P4({},n),a)}({__TRACK_LIST__:Kh,VERSION:Ta,BUILD:vT,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:k4,getParameter:J,getSupportedCodec:async function(){let i={audio:[],video:[]};try{let t=new RTCPeerConnection;t.addTransceiver("video",{direction:"recvonly"}),t.addTransceiver("audio",{direction:"recvonly"});const n=(await t.createOffer()).sdp;if(!n)return i;t.close(),t=null,i=function(a){const l={video:[],audio:[]};return a.match(/ VP8/i)&&l.video.push("VP8"),a.match(/ VP9/i)&&l.video.push("VP9"),a.match(/ AV1/i)&&l.video.push("AV1"),a.match(/ H264/i)&&l.video.push("H264"),a.match(/ H265/i)&&l.video.push("H265"),a.match(/ opus/i)&&l.audio.push("OPUS"),a.match(/ PCMU/i)&&l.audio.push("PCMU"),a.match(/ PCMA/i)&&l.audio.push("PCMA"),a.match(/ G722/i)&&l.audio.push("G722"),l}(n)}catch(t){throw new ue(z.CREATE_OFFER_FAILED,t.toString&&t.toString()).print()}return i},checkSystemRequirements:function(){const i=We.reportApiInvoke(null,{name:gr.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:Pn.TRACER});let t=!1;try{const u=window.RTCPeerConnection,h=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,p=window.WebSocket;t=!!(u&&h&&p)}catch(u){return L.error("check system requirement failed: ",u),!1}let n=!1;const a=Wt();a.name===qt.CHROME&&Number(a.version)>=58&&(!SZ()||yZ())&&(n=!0),a.name===qt.FIREFOX&&Number(a.version)>=56&&(n=!0),a.name===qt.OPERA&&Number(a.version)>=45&&(n=!0),a.name===qt.SAFARI&&Number(a.version)>=11&&(n=!0),(Lk()||Wt().name===qt.QQ)&&(n=!0),L.debug("checkSystemRequirements, api:",t,"browser",n);const l=t&&n;return i.onSuccess(l),l},getDevices:function(i){return ea.enumerateDevices(!0,!0,i)},getMicrophones:function(i){return ea.getRecordingDevices(i)},getCameras:function(i){return ea.getCamerasDevices(i)},getElectronScreenSources:tF,getPlaybackDevices:function(i){return ea.getSpeakers(i)},createClient:function(){var i;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const n=We.reportApiInvoke(null,{name:gr.CREATE_CLIENT,options:[t],tag:Pn.TRACER});try{(function(a){Sr(a.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),Sr(a.mode,"config.mode",["rtc","live","p2p"]),a.audioCodec!==void 0&&Sr(a.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),a.proxyServer!==void 0&&ai(a.proxyServer,"config.proxyServer",1,1e4),a.turnServer!==void 0&&Wk(a.turnServer),a.httpRetryConfig!==void 0&&Hk(a.httpRetryConfig),a.websocketRetryConfig!==void 0&&Hk(a.websocketRetryConfig)})(t)}catch(a){throw n.onError(a),a}return yre()||(t.codec==="vp9"&&(t.codec="vp8",L.debug("browser not support vp9, force use vp8")),sn("UNSUPPORTED_VIDEO_CODEC",["vp9"])),t.audioCodec===void 0&&(t.audioCodec="opus"),n.onSuccess(),new rn(sl(sl({forceWaitGatewayResponse:!0},t),{},{role:Be(i=["rtc","p2p"]).call(i,t.mode)?"host":t.role||"audience"}))},createCameraVideoTrack:async function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=We.reportApiInvoke(null,{tag:Pn.TRACER,name:gr.CREATE_CAM_VIDEO_TRACK,options:[Qv({},i)]}),n=Jv(i),a=pn(8,"track-cam-");let l=null;const u=i.encoderConfig==="720p_auto";L.info("start create camera video track with config",JSON.stringify(i),"trackId",a);try{l=(await Zo({video:n},a)).getVideoTracks()[0]||null}catch(p){throw t.onError(p),p}if(!l){const p=new Te(z.UNEXPECTED_ERROR,"can not find track in media stream");return t.onError(p),p.throw(L)}i.optimizationMode&&iR(a,l,i,Sc(i.encoderConfig));const h=new ou(l,i,n,i.scalabiltyMode?Wv(i.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},i.optimizationMode,a);return u&&h.startMonitorStats(),t.onSuccess(h.getTrackId()),L.info("create camera video success, trackId:",a),h},createCustomVideoTrack:function(i){const t=We.reportApiInvoke(null,{tag:Pn.TRACER,name:gr.CREATE_CUSTOM_VIDEO_TRACK,options:[i]}),n=new Rt(i.mediaStreamTrack,{width:i.width,height:i.height,frameRate:i.frameRate,bitrateMax:i.bitrateMax,bitrateMin:i.bitrateMin},i.scalabiltyMode?Wv(i.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},i.optimizationMode,pn(8,"track-cus-"),[mn.CUSTOM_TRACK]);return t.onSuccess(n.getTrackId()),L.info("create custom video track success with config",i,"trackId",n.getTrackId()),n},createScreenVideoTrack:async function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const n=We.reportApiInvoke(null,{tag:Pn.TRACER,name:gr.CREATE_SCREEN_VIDEO_TRACK,options:[Qv({},i),t]}),a=i.encoderConfig==="720p_auto";i.encoderConfig?typeof i.encoderConfig=="string"||i.encoderConfig.width&&i.encoderConfig.height||(i.encoderConfig.width={max:1920},i.encoderConfig.height={max:1080}):i.encoderConfig="1080p_2";const l=function(C){const I={};C.screenSourceType&&(I.mediaSource=C.screenSourceType),C.extensionId&&n0()&&(I.extensionId=C.extensionId);const{displaySurface:k,selfBrowserSurface:G,surfaceSwitching:B,systemAudio:j}=C;($b(107)||xk(107)||Nk(93))&&(k&&(Sr(k,"displaySurface",["browser","window","monitor"]),I.displaySurface=k),G?(Sr(G,"selfBrowserSurface",["exclude","include"]),I.selfBrowserSurface=G):I.selfBrowserSurface="include",B&&(Sr(B,"surfaceSwitching",["exclude","include"]),I.surfaceSwitching=B)),($b(105)||xk(105)||Nk(91))&&j&&(Sr(j,"systemAudio",["exclude","include"]),I.systemAudio=j),C.electronScreenSourceId&&(I.sourceId=C.electronScreenSourceId);const q=C.encoderConfig?$T(C.encoderConfig):null;return I.mandatory={chromeMediaSource:"desktop",maxWidth:q?q.width:void 0,maxHeight:q?q.height:void 0},q&&(q.frameRate&&(typeof q.frameRate=="number"?(I.mandatory.maxFrameRate=q.frameRate,I.mandatory.minFrameRate=q.frameRate):(I.mandatory.maxFrameRate=q.frameRate.max||q.frameRate.ideal||q.frameRate.exact||void 0,I.mandatory.minFrameRate=q.frameRate.min||q.frameRate.ideal||q.frameRate.exact||void 0),I.frameRate=q.frameRate),q.width&&(I.width=q.width),q.height&&(I.height=q.height)),I}(i),u=pn(8,"track-scr-v-");let h=null,p=null;const v=cn();if(!v.supportShareAudio&&t==="enable"){const C=new Te(z.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return n.onError(C),C.throw(L)}L.info("start create screen video track with config",i,"withAudio",t,"trackId",u);try{const C=await Zo({screen:l,screenAudio:t==="auto"?v.supportShareAudio:t==="enable"},u);h=C.getVideoTracks()[0]||null,p=C.getAudioTracks()[0]||null}catch(C){throw n.onError(C),C}if(!h){const C=new Te(z.UNEXPECTED_ERROR,"can not find track in media stream");return n.onError(C),C.throw(L)}if(!p&&t==="enable"){h&&h.stop();const C=new Te(z.SHARE_AUDIO_NOT_ALLOWED);return n.onError(C),C.throw(L)}i.optimizationMode||(i.optimizationMode="detail"),i.optimizationMode&&(iR(u,h,i,i.encoderConfig&&$T(i.encoderConfig)||void 0),i.encoderConfig&&typeof i.encoderConfig!="string"&&(i.encoderConfig.bitrateMin=i.encoderConfig.bitrateMax));const E=new Rt(h,i.encoderConfig?$T(i.encoderConfig):{},i.scalabiltyMode?Wv(i.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},i.optimizationMode,u,[mn.SCREEN_TRACK]);if(a&&E.startMonitorStats(),!p)return n.onSuccess(E.getTrackId()),L.info("create screen video track success","video:",E.getTrackId()),E;const y=new Xt(p,void 0,pn(8,"track-scr-a-"),!1,!0);return n.onSuccess([E.getTrackId(),y.getTrackId()]),L.info("create screen video track success","video:",E.getTrackId(),"audio:",y.getTrackId()),[E,y]},createMicrophoneAndCameraTracks:async function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=We.reportApiInvoke(null,{tag:Pn.TRACER,name:gr.CREATE_MIC_AND_CAM_TRACKS,options:[i,t]}),a=t.encoderConfig==="720p_auto",l=Jv(t),u=pF(i),h=pn(8,"track-mic-"),p=pn(8,"track-cam-");let v=null,E=null;L.info("start create camera video track(".concat(p,") and microphone audio track(").concat(h,") with config, audio: ").concat(JSON.stringify(i),", video: ").concat(JSON.stringify(t)));try{const I=await Zo({audio:u,video:l},"".concat(h,"-").concat(p));v=I.getAudioTracks()[0],E=I.getVideoTracks()[0]}catch(I){throw n.onError(I),I}if(!v||!E){const I=new Te(z.UNEXPECTED_ERROR,"can not find tracks in media stream");return n.onError(I),I.throw(L)}t.optimizationMode&&iR(p,E,t,Sc(t.encoderConfig));const y=new _d(v,i,u,h),C=new ou(E,t,l,t.scalabiltyMode?Wv(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,p);return a&&C.startMonitorStats(),n.onSuccess([y.getTrackId(),C.getTrackId()]),L.info("create camera video track(".concat(p,") and microphone audio track(").concat(h,") success")),[y,C]},createMicrophoneAudioTrack:async function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=We.reportApiInvoke(null,{tag:Pn.TRACER,name:gr.CREATE_MIC_AUDIO_TRACK,options:[i]}),n=pF(i),a=pn(8,"track-mic-");let l=null;L.info("start create microphone audio track with config",JSON.stringify(i),"trackId",a);try{l=(await Zo({audio:n},a)).getAudioTracks()[0]||null}catch(h){throw t.onError(h),h}if(!l){const h=new Te(z.UNEXPECTED_ERROR,"can not find track in media stream");return t.onError(h),h.throw(L)}const u=new _d(l,i,n,a);return t.onSuccess(u.getTrackId()),L.info("create microphone audio track success, trackId:",a),u},createCustomAudioTrack:function(i){const t=We.reportApiInvoke(null,{tag:Pn.TRACER,name:gr.CREATE_CUSTOM_AUDIO_TRACK,options:[i]}),n=new Xt(i.mediaStreamTrack,i.encoderConfig?Gv(i.encoderConfig):{},pn(8,"track-cus-"),!1,!0);return L.info("create custom audio track success with config",i,"trackId",n.getTrackId()),t.onSuccess(n.getTrackId()),n},createBufferSourceAudioTrack:async function(i){var t;const{cacheOnlineFile:n,encoderConfig:a}=i;let{source:l}=i;const u={source:l instanceof AudioBuffer?"AudioBuffer":l instanceof File?(t=File.name)!==null&&t!==void 0?t:"File":l,cacheOnlineFile:n,encoderConfig:a},h=We.reportApiInvoke(null,{tag:Pn.TRACER,name:gr.CREATE_BUFFER_AUDIO_TRACK,options:[u]});if(J("DISABLE_WEBAUDIO"))throw new Te(z.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");const p=pn(8,"track-buf-");L.info("start create buffer source audio track with config",JSON.stringify(u),"trackId",p);const v=l;if(!(l instanceof AudioBuffer))try{l=await Ete(l,n)}catch(C){return h.onError(C),C.throw(L)}const E=new vte(l),y=new iu(v,E,a?Gv(a):{},p);return L.info("create buffer source audio track success, trackId:",p),h.onSuccess(y.getTrackId()),y},setAppType:function(i){if(L.debug("setAppType: ".concat(i)),!(Number.isInteger(i)&&i>=0))throw L.debug("Invalid appType"),new ue(z.INVALID_PARAMS,"invalid app type",i);sn("APP_TYPE",Math.floor(i))},setLogLevel:function(i){L.setLogLevel(i)},enableLogUpload:function(){J("USE_NEW_LOG")?sn("UPLOAD_LOG",!0):L.enableLogUpload()},disableLogUpload:function(){J("USE_NEW_LOG")?sn("UPLOAD_LOG",!1):L.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new vE},checkAudioTrackIsActive:async function(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const n=We.reportApiInvoke(null,{tag:Pn.TRACER,name:gr.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[t]});if(!(i instanceof Xt||i instanceof is)){const v=new ue(z.INVALID_TRACK,"the parameter is not a audio track");return n.onError(v),v.throw()}t&&t<1e3&&(t=1e3);const a=i instanceof Xt?i.getTrackLabel():"remote_track",l=i.getVolumeLevel();let u=l,h=l;const p=Date.now();return new _e(v=>{const E=setInterval(()=>{const y=i.getVolumeLevel();u=y>u?y:u,h=y<h?y:h;const C=u-h>1e-4,I=Date.now()-p;if(C||I>t){clearInterval(E);const k=C,G={duration:I,deviceLabel:a,maxVolumeLevel:u,result:k};L.info("[track-".concat(i.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(G))),n.onSuccess(G),v(k)}},200)})},checkVideoTrackIsActive:async function(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const n=We.reportApiInvoke(null,{tag:Pn.TRACER,name:gr.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[t]});if(!(i instanceof Rt||i instanceof Cc)){const C=new ue(z.INVALID_TRACK,"the parameter is not a video track");return n.onError(C),C.throw()}t&&t<1e3&&(t=1e3);const a=i instanceof Rt?i.getTrackLabel():"remote_track",l=i.getMediaStreamTrack(!0),u=document.createElement("video");u.style.width="1px",u.style.height="1px",u.setAttribute("muted",""),u.muted=!0,u.setAttribute("playsinline",""),u.controls=!1,(Ni()||fv())&&(u.style.opacity="0.01",u.style.position="fixed",u.style.left="0",u.style.top="0",document.body.appendChild(u)),u.srcObject=new MediaStream([l]),u.play();const h=document.createElement("canvas");h.width=160,h.height=120;let p=0,v=0;try{const C=Date.now();p=await function(I,k,G,B){let j,q=0,Z=null;return new _e((re,Ce)=>{function pe(){q>B&&j&&(j(),re(q));const fe=G.getContext("2d");if(!fe){const Ae=new ue(z.UNEXPECTED_ERROR,"can not get canvas 2d context.");return L.error(Ae.toString()),void Ce(Ae)}fe.drawImage(I,0,0,160,120);const ye=fe.getImageData(0,0,G.width,G.height),Ee=Math.floor(ye.data.length/3);if(Z){for(let Ae=0;Ae<Ee;Ae+=3)if(ye.data[Ae]!==Z[Ae])return q+=1,void(Z=ye.data);Z=ye.data}else Z=ye.data}setTimeout(()=>{j&&(j(),re(q))},k),j=qT(()=>{pe()},30)})}(u,t,h,4),v=Date.now()-C}catch(C){throw n.onError(C),C}_re===qt.SAFARI&&(u.pause(),u.remove()),u.srcObject=null;const E=p>4,y={duration:v,changedPicNum:p,deviceLabel:a,result:E};return L.info("[track-".concat(i.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(y))),n.onSuccess(y),E},setArea:MT,audioElementPlayCenter:go,resumeAudioContext:function(){go.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(i){Cre.processExternalMediaAEC(i)},registerExtensions:function(i){const t=J("PLUGIN_INFO")||[];i.forEach(n=>{"name"in n&&!Be(t).call(t,n.name)&&t.push(n.name);const a=n;a.__registered__=!0,a.logger.hookLog=L.extLog,a.reporter.hookApiInvoke=We.extApiInvoke,a.parameters&&Object.keys(a.parameters).forEach(l=>{a.parameters[l]=J(l)})}),k4("PLUGIN_INFO",t)},ChannelMediaRelayError:Jl,ChannelMediaRelayEvent:Ls,ChannelMediaRelayState:Wi,RemoteStreamFallbackType:WT,RemoteStreamType:HT,ConnectionDisconnectedReason:xt,AudienceLatencyLevelType:Kb,AREAS:$t});return Object.defineProperties(hr,{onAudioAutoplayFailed:{get:()=>ta.onAudioAutoplayFailed,set:i=>{ta.onAudioAutoplayFailed=i}},onAutoplayFailed:{get:()=>ta.onAutoplayFailed,set:i=>{ta.onAutoplayFailed=i}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>hr._onSecurityPolicyViolation,set(i){hr._onSecurityPolicyViolation=i,D4(i)}},__CLIENT_LIST__:{get:()=>J("SHOW_GLOBAL_CLIENT_LIST")?ql:[]}}),ea.on(el.CAMERA_DEVICE_CHANGED,i=>{L.info("camera device changed",JSON.stringify(i)),hr.onCameraChanged&&hr.onCameraChanged(i),hr.safeEmit(ts.CAMERA_CHANGED,i)}),ea.on(el.RECORDING_DEVICE_CHANGED,i=>{L.info("microphone device changed",JSON.stringify(i)),hr.onMicrophoneChanged&&hr.onMicrophoneChanged(i),hr.safeEmit(ts.MICROPHONE_CHANGED,i)}),ea.on(el.PLAYOUT_DEVICE_CHANGED,i=>{L.debug("playout device changed",JSON.stringify(i)),hr.onPlaybackDeviceChanged&&hr.onPlaybackDeviceChanged(i),hr.safeEmit(ts.PLAYBACK_DEVICE_CHANGED,i)}),go.onAutoplayFailed=()=>{L.info("detect audio element autoplay failed"),ta.onAudioAutoplayFailed&&ta.onAudioAutoplayFailed()},nn.on("autoplay-failed",()=>{L.info("detect webaudio autoplay failed"),ta.onAudioAutoplayFailed&&ta.onAudioAutoplayFailed(),hr.safeEmit(ts.AUTOPLAY_FAILED)}),nn.on(Ar.STATE_CHANGE,(i,t)=>{L.info("audio context state changed: ".concat(t," => ").concat(i)),hr.onAudioContextStateChanged&&hr.onAudioContextStateChanged(i,t),hr.safeEmit(ts.AUDIO_CONTEXT_STATE_CHANGED,i,t)}),lr.on(qc.NETWORK_STATE_CHANGE,(i,t)=>{L.info("[network-indicator] network state changed, ".concat(t," => ").concat(i))}),window&&(window.__ARTC__=hr),hr})})(D8);var Kre=D8.exports;const _l=Ol(Kre);function Bo(e,r,o){return e.on(r,o),()=>e.off(r,o)}function Yre(e){try{return e()}catch(r){console.error(r)}}function th(e){return()=>e.forEach(Yre)}function rO(e,r){const o=setTimeout(e,r);return()=>clearTimeout(o)}function iO(){let e,r,o;function s(){if(r){const _=r;r=void 0,_()}}async function c(){if(o){const _=o;o=void 0;try{await _()}catch(S){console.error(S)}}}async function d(_){e=!0,await c();try{o=await _()}catch(S){console.error(S)}e=!1,s()}async function f(){e=!0,await c(),e=!1,s()}function m(_){e?r=()=>d(_):d(_)}function g(){e?r=f:f()}return{run:m,dispose:g}}const oO=typeof document<"u"?b.useLayoutEffect:b.useEffect;function qre(e){return e!=null&&typeof e.then=="function"}function Wu(){const e=b.useRef(!1);return b.useEffect(()=>(e.current=!1,()=>{e.current=!0}),[]),e}function Xre(){const e=Wu();function r(o,s){return new Promise(async(c,d)=>{try{const f=await o;e.current||c(f)}catch(f){e.current?s&&s(f):d(f)}})}return b.useCallback(r,[e])}function Hy(e){const r=Xre(),[o,s]=b.useState();return oO(()=>{qre(e)?r(e).then(s):s(e)},[e,r]),o}function nh(e,r){const o=b.useRef();b.useEffect(()=>{const{run:s,dispose:c}=o.current||(o.current=iO());return s(e),c},r)}function Jre(e,r){const o=e.split("."),s=r.split("."),c=Math.max(o.length,s.length);for(let d=0;d<c;d++){const f=parseInt(o[d]||"0"),m=parseInt(s[d]||"0");if(f>m)return 1;if(f<m)return-1}return 0}function k8(e,r,o){const s=b.useRef(o);oO(()=>{s.current=o},[o]),b.useEffect(()=>{if(e)return Bo(e,r,(...c)=>{s.current&&s.current(...c)})},[r,e])}const L8=b.createContext(null);function M8({client:e,children:r}){return ne.jsx(L8.Provider,{value:e,children:r})}function Qre(e){const r=b.useContext(L8);return e||r}function Cs(e){const r=Qre(e);if(!r)throw new Error("Agora RTC client not found. Should be wrapped in <AgoraRTCProvider value={client} />");return r}const Zre=b.createContext(null);function eie({client:e,children:r}){return ne.jsx(Zre.Provider,{value:e,children:r})}function tie(e){const r=Cs(e),[o,s]=b.useState(r?r.connectionState:"DISCONNECTED");return b.useEffect(()=>{if(r){s(r.connectionState);let c;return th([Bo(r,"connection-state-change",d=>{c==null||c(),d==="CONNECTED"?c=rO(()=>s(d),0):s(d)}),()=>c==null?void 0:c()])}else s("DISCONNECTED")},[r]),o}function bs(e){const r=Cs(e),[o,s]=b.useState(r?r.connectionState==="CONNECTED":!1);return b.useEffect(()=>{if(r){s(r.connectionState==="CONNECTED");let c;return th([Bo(r,"connection-state-change",d=>{c==null||c(),c=rO(()=>s(d==="CONNECTED"),0)}),()=>c==null?void 0:c()])}else s(!1)},[r]),o}function Wy(e){const r=Cs(e),[o,s]=b.useState(r==null?void 0:r.uid);return b.useEffect(()=>{if(r)return Bo(r,"connection-state-change",c=>{if(c==="CONNECTED")return rO(()=>s(r.uid),0);c==="DISCONNECTED"&&s(void 0)})},[r]),o}class la extends Error{constructor(o,s){var r=(...args)=>{super(...args);OE(this,"rtcMethod");OE(this,"rtcError");OE(this,"name","AgoraRTCReactException")};r(typeof s=="string"?s:s.message),this.rtcMethod=o,this.rtcError=s}log(o){console[o](this)}}function Ii(e,r=!0,o){const s=Cs(o),c=bs(o),d=b.useRef(),[f,m]=b.useState(!1),[g,_]=b.useState(0),[S,T]=b.useState(null),R=Wu();return nh(async()=>{if(R.current||(T(null),_(0),m(!1)),r&&s){try{R.current||m(!0);const{appid:A,channel:O,token:M,uid:x}=typeof e=="function"?await e():e,P=await s.join(A,O,M,x);R.current||_(P)}catch(A){console.error(A),R.current||T(new la("IAgoraRTCClient.join",A))}R.current||m(!1);const N=d.current||(d.current=iO());return th([()=>{N.dispose()},()=>{N.run(()=>s.unpublish(s.localTracks))},()=>{for(const A of s.localTracks)A.isPlaying&&A.stop(),A.close();N.run(()=>s.leave())}])}},[r,o]),{data:g,isLoading:f,isConnected:c,error:S}}const B4=()=>({uplinkNetworkQuality:0,downlinkNetworkQuality:0,delay:0});function nie(e){const r=Cs(e),[o,s]=b.useState(B4);return b.useEffect(()=>{if(r)return Bo(r,"network-quality",c=>s({uplinkNetworkQuality:c.uplinkNetworkQuality,downlinkNetworkQuality:c.downlinkNetworkQuality,delay:r.getRTCStats().RTT??0}));s(B4())},[r]),o}function Gu(e,r=!0,o){const s=Cs(o),c=bs(o),d=b.useRef([]),[f,m]=b.useState(!1),[g,_]=b.useState(null),S=Wu();return nh(async()=>{if(S.current||(m(!1),_(null)),!s||!c||!r)return;const T=e.filter(Boolean),R=O=>{const M=Jre(_l.VERSION,"4.18.2")>=0;return M||new la("usePublish","please check your agora-rtc-sdk-ng version in package.json, it's recommend upgrade to >= 4.18.2").log("warn"),M?s.mode!=="live"||s.role!=="audience":!0},N=O=>d.current.some(M=>M&&M.getTrackId()===O.getTrackId()),A=O=>R()&&O.enabled&&r&&!N(O);for(let O=0;O<T.length;O++){const M=T[O];if(M&&A(M)){await s.unpublish(d.current.filter(x=>(x==null?void 0:x.trackMediaType)===M.trackMediaType));try{S.current||m(!0),await s.publish(M)}catch(x){console.error(x),S.current||_(new la("IAgoraRTCClient.publish",x))}S.current||m(!1)}}d.current=T},[c,r,s,e]),{isLoading:f,error:g}}function hf(e=!0,r={ANS:!0,AEC:!0},o){const s=bs(o),[c,d]=b.useState(null),[f,m]=b.useState(!1),[g,_]=b.useState(null),S=Wu();return nh(async()=>{if(S.current||(m(!1),_(null)),s&&e&&!c){try{S.current||m(!0);const T=await _l.createMicrophoneAudioTrack(r);S.current||d(T)}catch(T){console.error(T),S.current||_(new la("IAgoraRTC.createMicrophoneAudioTrack",T))}S.current||m(!1)}!s&&!S.current&&d(null)},[s,e]),{localMicrophoneTrack:c,isLoading:f,error:g}}function pf(e=!0,r,o){const s=bs(o),[c,d]=b.useState(null),[f,m]=b.useState(!1),[g,_]=b.useState(null),S=Wu();return nh(async()=>{if(S.current||(m(!1),_(null)),s&&e&&!c){try{S.current||m(!0);const T=await _l.createCameraVideoTrack(r);S.current||d(T)}catch(T){console.error(T),S.current||_(new la("IAgoraRTC.createCameraVideoTrack",T))}S.current||m(!1)}!s&&!S.current&&d(null)},[s,e]),{localCameraTrack:c,isLoading:f,error:g}}function ff(e,r){const o=Cs(r),[s,c]=b.useState([]),d=bs(),f=b.useRef([]),[m,g]=b.useState(!1),[_,S]=b.useState(null),T=Wu();return nh(async()=>{if(T.current||S(null),!Array.isArray(e)||!d)return;const R=async O=>{if(!O.audioTrack&&e.some(({uid:M})=>O.uid===M)){try{T.current||g(!0),await o.subscribe(O,"audio")}catch(M){console.error(M),T.current||S(new la("IAgoraRTCClient.subscribe",M))}O.audioTrack&&!f.current.some(M=>M.getUserId()===O.uid)&&f.current.push(O.audioTrack),f.current=f.current.map(M=>O.audioTrack&&M.getUserId()===O.uid&&M.getTrackId()!==O.audioTrack.getTrackId()?O.audioTrack:M),T.current||(c(f.current),g(!1))}},N=async O=>{if(e.some(({uid:M})=>O.uid===M)){T.current||(f.current=f.current.filter(M=>M.getUserId()!==O.uid),c(f.current));try{T.current||g(!0),await o.unsubscribe(O,"audio")}catch(M){console.error(M),T.current||S(new la("IAgoraRTCClient.unsubscribe",M))}T.current||g(!1)}};e.map(O=>{!O.audioTrack&&O.hasAudio&&R(O)});const A=[];for(let O=0;O<f.current.length;O++){const M=f.current[O];if(!e.some(x=>x.uid===M.getUserId())){const x=o.remoteUsers.find(P=>P.uid===M.getUserId());x&&A.push({user:x,mediaType:"audio"}),f.current.splice(O,1),O--}}if(A.length>0){try{T.current||g(!0),await o.massUnsubscribe(A)}catch(O){console.error(O),T.current||S(new la("IAgoraRTCClient.massUnsubscribe",O))}T.current||(c(f.current.slice()),g(!1))}return th([Bo(o,"user-published",(O,M)=>{e.find(x=>x.uid===O.uid)&&M==="audio"&&R(O)}),Bo(o,"user-unpublished",(O,M)=>{e.find(x=>x.uid===O.uid)&&M==="audio"&&N(O)})])},[d,o,e]),{audioTracks:s,isLoading:m,error:_}}function mf(e,r){const o=Cs(r),[s,c]=b.useState([]),d=bs(),f=b.useRef([]),[m,g]=b.useState(!1),[_,S]=b.useState(null),T=Wu();return nh(async()=>{if(T.current||S(null),!Array.isArray(e)||!d)return;const R=async O=>{if(!O.videoTrack&&e.some(({uid:M})=>O.uid===M)){try{T.current||g(!0),await o.subscribe(O,"video")}catch(M){console.error(M),T.current||S(new la("IAgoraRTCClient.subscribe",M))}O.videoTrack&&!f.current.some(M=>M.getUserId()===O.uid)&&f.current.push(O.videoTrack),f.current=f.current.map(M=>O.videoTrack&&M.getUserId()===O.uid&&M.getTrackId()!==O.videoTrack.getTrackId()?O.videoTrack:M),T.current||(c(f.current),g(!1))}},N=async O=>{if(e.some(({uid:M})=>O.uid===M)){T.current||(f.current=f.current.filter(M=>M.getUserId()!==O.uid),c(f.current));try{T.current||g(!0),await o.unsubscribe(O,"video")}catch(M){console.error(M),T.current||S(new la("IAgoraRTCClient.unsubscribe",M))}T.current||g(!1)}};e.map(O=>{!O.videoTrack&&O.hasVideo&&R(O)});const A=[];for(let O=0;O<f.current.length;O++){const M=f.current[O];if(!e.some(x=>x.uid===M.getUserId())){const x=o.remoteUsers.find(P=>P.uid===M.getUserId());x&&A.push({user:x,mediaType:"video"}),f.current.splice(O,1),O--}}if(A.length>0){try{T.current||g(!0),await o.massUnsubscribe(A)}catch(O){console.error(O),T.current||S(new la("IAgoraRTCClient.massUnsubscribe",O))}T.current||(c(f.current.slice()),g(!1))}return th([Bo(o,"user-published",(O,M)=>{e.find(x=>x.uid===O.uid)&&M==="video"&&R(O)}),Bo(o,"user-unpublished",(O,M)=>{e.find(x=>x.uid===O.uid)&&M==="video"&&N(O)})])},[d,o,e]),{videoTracks:s,isLoading:m,error:_}}function j4(e,r,o){const s=Cs(o),c=r==="audio"?"audioTrack":"videoTrack",[d,f]=b.useState(e&&e[c]),m=bs(),g=b.useRef(),[_,S]=b.useState(!1),[T,R]=b.useState(null);return b.useEffect(()=>{if(!e||!m)return;let N=!1;N||R(null);const A=r==="audio"?"hasAudio":"hasVideo",O=e.uid,M=async(D,F)=>{if(D[c]&&s.remoteUsers.some(({uid:$})=>D.uid===$))try{N||S(!0),await s.unsubscribe(D,F)}catch($){N||R(new la("IAgoraRTCClient.unsubscribe",$)),console.error($)}N||(f(void 0),S(!1))},x=async(D,F)=>{try{!D[c]&&s.remoteUsers.some(({uid:$})=>D.uid===$)&&(N||S(!0),await s.subscribe(D,F)),N||f(D[c])}catch($){N||R(new la("IAgoraRTCClient.subscribe",$)),console.error($)}N||S(!1)},P=g.current||(g.current=iO());return!e[c]&&e[A]?P.run(()=>x(e,r)):f(e[c]),th([()=>{N=!0,P.dispose()},Bo(s,"user-published",(D,F)=>{D.uid===O&&F===r&&P.run(()=>x(D,r))}),Bo(s,"user-unpublished",(D,F)=>{D.uid===O&&F===r&&P.run(()=>M(D,r))})])},[m,s,e,r,c]),{track:d,isLoading:_,error:T}}function oc(e){const r=Cs(e),[o,s]=b.useState(r?r.remoteUsers:[]);return b.useEffect(()=>{if(r){const c=()=>s(r.remoteUsers.slice());return th([Bo(r,"user-joined",c),Bo(r,"user-left",c),Bo(r,"user-published",c),Bo(r,"user-unpublished",c)])}},[r]),o}function F8(e=!0,r,o,s){const c=bs(s),[d,f]=b.useState(null),[m,g]=b.useState(!1),[_,S]=b.useState(null),T=Wu();return nh(async()=>{if(T.current||(g(!1),S(null)),c&&e&&!d){try{T.current||g(!0);const R=await _l.createScreenVideoTrack(r,o);T.current||f(R)}catch(R){console.error(R),T.current||S(new la("IAgoraRTC.createScreenVideoTrack",R))}T.current||g(!1)}(!c||!e)&&!T.current&&f(null)},[c,e]),{screenTrack:d,isLoading:m,error:_}}const U8=b.createContext(void 0);function aO(e,r,o){const s=b.useContext(U8);b.useEffect(()=>{if(e)return o&&r?e.play(o):e.stop(),s?(s.onMount(e),()=>s.onUnmount(e)):()=>{e.isPlaying&&e.stop()}},[e,o,r,s])}function sO(e,r){const o=b.useContext(U8);oO(()=>{if(e)return r?e.play():e.stop(),o?(o.onMount(e),()=>o.onUnmount(e)):()=>{e.isPlaying&&e.stop()}},[e,r,o])}function Gy({track:e,play:r=!1,volume:o,disabled:s,muted:c,children:d}){const f=Hy(e);return sO(f,r),b.useEffect(()=>{f&&o!=null&&f.setVolume(o)},[f,o]),b.useEffect(()=>{f&&s!=null&&f.setEnabled(!s).catch(console.warn)},[s,f]),b.useEffect(()=>{f&&c!=null&&f.setMuted(c).catch(console.warn)},[c,f]),d?ne.jsx(ne.Fragment,{children:d}):null}const zy={position:"relative",width:"100%",height:"100%",overflow:"hidden",background:"#000"},B8={width:"100%",height:"100%"},og={position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",zIndex:2},gf=(e,r)=>b.useMemo(()=>({...e,...r}),[e,r]);function ag({track:e,play:r,disabled:o,muted:s,style:c,...d}){const f=gf(B8,c),[m,g]=b.useState(null),_=Hy(e);return aO(_,r,m),b.useEffect(()=>{_&&o!=null&&_.setEnabled(!o).catch(console.warn)},[o,_]),b.useEffect(()=>{_&&s!=null&&_.setMuted(s).catch(console.warn)},[s,_]),ne.jsx("div",{...d,ref:g,style:f})}const rie={width:"100%",height:"100%",background:"#1a1e21 center/cover no-repeat",filter:"blur(16px) brightness(0.4)"},iie={position:"absolute",top:"50%",left:"50%",maxWidth:"50%",maxHeight:"50%",aspectRatio:"1",transform:"translate(-50%, -50%)",borderRadius:"50%",overflow:"hidden",objectFit:"cover"};function Ky({cover:e}){return ne.jsx("div",{style:og,children:typeof e=="string"?ne.jsxs(ne.Fragment,{children:[ne.jsx("div",{style:{...rie,backgroundImage:`url(${e})`}}),ne.jsx("img",{src:e,style:iie})]}):e()})}function j8({micOn:e,cameraOn:r,audioTrack:o,videoTrack:s,playAudio:c,playVideo:d,volume:f,cover:m,children:g,style:_,...S}){const T=gf(zy,_);return d=d??!!r,c=c??!!e,ne.jsxs("div",{...S,style:T,children:[ne.jsx(ag,{disabled:!r,play:d,track:s}),ne.jsx(Gy,{disabled:!e,play:c,track:o,volume:f}),m&&!r&&ne.jsx(Ky,{cover:m}),ne.jsx("div",{style:og,children:g})]})}function V8({track:e,play:r=!1,playbackDeviceId:o,volume:s,children:c}){return sO(e,r),b.useEffect(()=>{e&&o!=null&&e.setPlaybackDevice(o).catch(console.warn)},[e,o]),b.useEffect(()=>{e&&s!=null&&e.setVolume(s)},[e,s]),c?ne.jsx(ne.Fragment,{children:c}):null}function cO({track:e,play:r,style:o,...s}){const c=gf(B8,o),[d,f]=b.useState(null);return aO(e,r,d),ne.jsx("div",{...s,ref:f,style:c})}function lO({user:e,playVideo:r,playAudio:o,playbackDeviceId:s,volume:c,cover:d,style:f,children:m,...g}){const _=gf(zy,f),{track:S}=j4(e,"video"),{track:T}=j4(e,"audio");return r=r??(e==null?void 0:e.hasVideo),o=o??(e==null?void 0:e.hasAudio),ne.jsxs("div",{...g,style:_,children:[ne.jsx(cO,{play:r,track:S}),ne.jsx(V8,{play:o,playbackDeviceId:s,track:T,volume:c}),d&&!r&&ne.jsx(Ky,{cover:d}),ne.jsx("div",{style:og,children:m})]})}var Qw={},$8={exports:{}},Wa={},H8={exports:{}},W8={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function r(ae,ge){var Se=ae.length;ae.push(ge);e:for(;0<Se;){var de=Se-1>>>1,he=ae[de];if(0<c(he,ge))ae[de]=ge,ae[Se]=he,Se=de;else break e}}function o(ae){return ae.length===0?null:ae[0]}function s(ae){if(ae.length===0)return null;var ge=ae[0],Se=ae.pop();if(Se!==ge){ae[0]=Se;e:for(var de=0,he=ae.length,be=he>>>1;de<be;){var ve=2*(de+1)-1,ke=ae[ve],Le=ve+1,$e=ae[Le];if(0>c(ke,Se))Le<he&&0>c($e,ke)?(ae[de]=$e,ae[Le]=Se,de=Le):(ae[de]=ke,ae[ve]=Se,de=ve);else if(Le<he&&0>c($e,Se))ae[de]=$e,ae[Le]=Se,de=Le;else break e}}return ge}function c(ae,ge){var Se=ae.sortIndex-ge.sortIndex;return Se!==0?Se:ae.id-ge.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;e.unstable_now=function(){return d.now()}}else{var f=Date,m=f.now();e.unstable_now=function(){return f.now()-m}}var g=[],_=[],S=1,T=null,R=3,N=!1,A=!1,O=!1,M=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(ae){for(var ge=o(_);ge!==null;){if(ge.callback===null)s(_);else if(ge.startTime<=ae)s(_),ge.sortIndex=ge.expirationTime,r(g,ge);else break;ge=o(_)}}function F(ae){if(O=!1,D(ae),!A)if(o(g)!==null)A=!0,ce($);else{var ge=o(_);ge!==null&&se(F,ge.startTime-ae)}}function $(ae,ge){A=!1,O&&(O=!1,x(K),K=-1),N=!0;var Se=R;try{for(D(ge),T=o(g);T!==null&&(!(T.expirationTime>ge)||ae&&!ee());){var de=T.callback;if(typeof de=="function"){T.callback=null,R=T.priorityLevel;var he=de(T.expirationTime<=ge);ge=e.unstable_now(),typeof he=="function"?T.callback=he:T===o(g)&&s(g),D(ge)}else s(g);T=o(g)}if(T!==null)var be=!0;else{var ve=o(_);ve!==null&&se(F,ve.startTime-ge),be=!1}return be}finally{T=null,R=Se,N=!1}}var V=!1,W=null,K=-1,Q=5,Y=-1;function ee(){return!(e.unstable_now()-Y<Q)}function te(){if(W!==null){var ae=e.unstable_now();Y=ae;var ge=!0;try{ge=W(!0,ae)}finally{ge?ie():(V=!1,W=null)}}else V=!1}var ie;if(typeof P=="function")ie=function(){P(te)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,me=le.port2;le.port1.onmessage=te,ie=function(){me.postMessage(null)}}else ie=function(){M(te,0)};function ce(ae){W=ae,V||(V=!0,ie())}function se(ae,ge){K=M(function(){ae(e.unstable_now())},ge)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ae){ae.callback=null},e.unstable_continueExecution=function(){A||N||(A=!0,ce($))},e.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<ae?Math.floor(1e3/ae):5},e.unstable_getCurrentPriorityLevel=function(){return R},e.unstable_getFirstCallbackNode=function(){return o(g)},e.unstable_next=function(ae){switch(R){case 1:case 2:case 3:var ge=3;break;default:ge=R}var Se=R;R=ge;try{return ae()}finally{R=Se}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ae,ge){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var Se=R;R=ae;try{return ge()}finally{R=Se}},e.unstable_scheduleCallback=function(ae,ge,Se){var de=e.unstable_now();switch(typeof Se=="object"&&Se!==null?(Se=Se.delay,Se=typeof Se=="number"&&0<Se?de+Se:de):Se=de,ae){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=Se+he,ae={id:S++,callback:ge,priorityLevel:ae,startTime:Se,expirationTime:he,sortIndex:-1},Se>de?(ae.sortIndex=Se,r(_,ae),o(g)===null&&ae===o(_)&&(O?(x(K),K=-1):O=!0,se(F,Se-de))):(ae.sortIndex=he,r(g,ae),A||N||(A=!0,ce($))),ae},e.unstable_shouldYield=ee,e.unstable_wrapCallback=function(ae){var ge=R;return function(){var Se=R;R=ge;try{return ae.apply(this,arguments)}finally{R=Se}}}})(W8);H8.exports=W8;var oie=H8.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G8=b,$a=oie;function Ye(e){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var z8=new Set,Am={};function rh(e,r){Qp(e,r),Qp(e+"Capture",r)}function Qp(e,r){for(Am[e]=r,e=0;e<r.length;e++)z8.add(r[e])}var yl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zw=Object.prototype.hasOwnProperty,aie=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,V4={},$4={};function sie(e){return Zw.call($4,e)?!0:Zw.call(V4,e)?!1:aie.test(e)?$4[e]=!0:(V4[e]=!0,!1)}function cie(e,r,o,s){if(o!==null&&o.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return s?!1:o!==null?!o.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function lie(e,r,o,s){if(r===null||typeof r>"u"||cie(e,r,o,s))return!0;if(s)return!1;if(o!==null)switch(o.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function $o(e,r,o,s,c,d,f){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=s,this.attributeNamespace=c,this.mustUseProperty=o,this.propertyName=e,this.type=r,this.sanitizeURL=d,this.removeEmptyString=f}var co={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){co[e]=new $o(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var r=e[0];co[r]=new $o(r,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){co[e]=new $o(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){co[e]=new $o(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){co[e]=new $o(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){co[e]=new $o(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){co[e]=new $o(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){co[e]=new $o(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){co[e]=new $o(e,5,!1,e.toLowerCase(),null,!1,!1)});var uO=/[\-:]([a-z])/g;function dO(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var r=e.replace(uO,dO);co[r]=new $o(r,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var r=e.replace(uO,dO);co[r]=new $o(r,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var r=e.replace(uO,dO);co[r]=new $o(r,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){co[e]=new $o(e,1,!1,e.toLowerCase(),null,!1,!1)});co.xlinkHref=new $o("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){co[e]=new $o(e,1,!1,e.toLowerCase(),null,!0,!0)});function hO(e,r,o,s){var c=co.hasOwnProperty(r)?co[r]:null;(c!==null?c.type!==0:s||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(lie(r,o,c,s)&&(o=null),s||c===null?sie(r)&&(o===null?e.removeAttribute(r):e.setAttribute(r,""+o)):c.mustUseProperty?e[c.propertyName]=o===null?c.type===3?!1:"":o:(r=c.attributeName,s=c.attributeNamespace,o===null?e.removeAttribute(r):(c=c.type,o=c===3||c===4&&o===!0?"":""+o,s?e.setAttributeNS(s,r,o):e.setAttribute(r,o))))}var xl=G8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,NE=Symbol.for("react.element"),Op=Symbol.for("react.portal"),xp=Symbol.for("react.fragment"),pO=Symbol.for("react.strict_mode"),eI=Symbol.for("react.profiler"),K8=Symbol.for("react.provider"),Y8=Symbol.for("react.context"),fO=Symbol.for("react.forward_ref"),tI=Symbol.for("react.suspense"),nI=Symbol.for("react.suspense_list"),mO=Symbol.for("react.memo"),bu=Symbol.for("react.lazy"),q8=Symbol.for("react.offscreen"),H4=Symbol.iterator;function V0(e){return e===null||typeof e!="object"?null:(e=H4&&e[H4]||e["@@iterator"],typeof e=="function"?e:null)}var Jr=Object.assign,ZR;function rm(e){if(ZR===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);ZR=r&&r[1]||""}return`
`+ZR+e}var e1=!1;function t1(e,r){if(!e||e1)return"";e1=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(_){var s=_}Reflect.construct(e,[],r)}else{try{r.call()}catch(_){s=_}e.call(r.prototype)}else{try{throw Error()}catch(_){s=_}e()}}catch(_){if(_&&s&&typeof _.stack=="string"){for(var c=_.stack.split(`
`),d=s.stack.split(`
`),f=c.length-1,m=d.length-1;1<=f&&0<=m&&c[f]!==d[m];)m--;for(;1<=f&&0<=m;f--,m--)if(c[f]!==d[m]){if(f!==1||m!==1)do if(f--,m--,0>m||c[f]!==d[m]){var g=`
`+c[f].replace(" at new "," at ");return e.displayName&&g.includes("<anonymous>")&&(g=g.replace("<anonymous>",e.displayName)),g}while(1<=f&&0<=m);break}}}finally{e1=!1,Error.prepareStackTrace=o}return(e=e?e.displayName||e.name:"")?rm(e):""}function uie(e){switch(e.tag){case 5:return rm(e.type);case 16:return rm("Lazy");case 13:return rm("Suspense");case 19:return rm("SuspenseList");case 0:case 2:case 15:return e=t1(e.type,!1),e;case 11:return e=t1(e.type.render,!1),e;case 1:return e=t1(e.type,!0),e;default:return""}}function rI(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case xp:return"Fragment";case Op:return"Portal";case eI:return"Profiler";case pO:return"StrictMode";case tI:return"Suspense";case nI:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Y8:return(e.displayName||"Context")+".Consumer";case K8:return(e._context.displayName||"Context")+".Provider";case fO:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case mO:return r=e.displayName||null,r!==null?r:rI(e.type)||"Memo";case bu:r=e._payload,e=e._init;try{return rI(e(r))}catch{}}return null}function die(e){var r=e.type;switch(e.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=r.render,e=e.displayName||e.name||"",r.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rI(r);case 8:return r===pO?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function ju(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function X8(e){var r=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function hie(e){var r=X8(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,r),s=""+e[r];if(!e.hasOwnProperty(r)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var c=o.get,d=o.set;return Object.defineProperty(e,r,{configurable:!0,get:function(){return c.call(this)},set:function(f){s=""+f,d.call(this,f)}}),Object.defineProperty(e,r,{enumerable:o.enumerable}),{getValue:function(){return s},setValue:function(f){s=""+f},stopTracking:function(){e._valueTracker=null,delete e[r]}}}}function PE(e){e._valueTracker||(e._valueTracker=hie(e))}function J8(e){if(!e)return!1;var r=e._valueTracker;if(!r)return!0;var o=r.getValue(),s="";return e&&(s=X8(e)?e.checked?"true":"false":e.value),e=s,e!==o?(r.setValue(e),!0):!1}function V_(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function iI(e,r){var o=r.checked;return Jr({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??e._wrapperState.initialChecked})}function W4(e,r){var o=r.defaultValue==null?"":r.defaultValue,s=r.checked!=null?r.checked:r.defaultChecked;o=ju(r.value!=null?r.value:o),e._wrapperState={initialChecked:s,initialValue:o,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function Q8(e,r){r=r.checked,r!=null&&hO(e,"checked",r,!1)}function oI(e,r){Q8(e,r);var o=ju(r.value),s=r.type;if(o!=null)s==="number"?(o===0&&e.value===""||e.value!=o)&&(e.value=""+o):e.value!==""+o&&(e.value=""+o);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}r.hasOwnProperty("value")?aI(e,r.type,o):r.hasOwnProperty("defaultValue")&&aI(e,r.type,ju(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(e.defaultChecked=!!r.defaultChecked)}function G4(e,r,o){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var s=r.type;if(!(s!=="submit"&&s!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+e._wrapperState.initialValue,o||r===e.value||(e.value=r),e.defaultValue=r}o=e.name,o!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,o!==""&&(e.name=o)}function aI(e,r,o){(r!=="number"||V_(e.ownerDocument)!==e)&&(o==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+o&&(e.defaultValue=""+o))}var im=Array.isArray;function Gp(e,r,o,s){if(e=e.options,r){r={};for(var c=0;c<o.length;c++)r["$"+o[c]]=!0;for(o=0;o<e.length;o++)c=r.hasOwnProperty("$"+e[o].value),e[o].selected!==c&&(e[o].selected=c),c&&s&&(e[o].defaultSelected=!0)}else{for(o=""+ju(o),r=null,c=0;c<e.length;c++){if(e[c].value===o){e[c].selected=!0,s&&(e[c].defaultSelected=!0);return}r!==null||e[c].disabled||(r=e[c])}r!==null&&(r.selected=!0)}}function sI(e,r){if(r.dangerouslySetInnerHTML!=null)throw Error(Ye(91));return Jr({},r,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function z4(e,r){var o=r.value;if(o==null){if(o=r.children,r=r.defaultValue,o!=null){if(r!=null)throw Error(Ye(92));if(im(o)){if(1<o.length)throw Error(Ye(93));o=o[0]}r=o}r==null&&(r=""),o=r}e._wrapperState={initialValue:ju(o)}}function Z8(e,r){var o=ju(r.value),s=ju(r.defaultValue);o!=null&&(o=""+o,o!==e.value&&(e.value=o),r.defaultValue==null&&e.defaultValue!==o&&(e.defaultValue=o)),s!=null&&(e.defaultValue=""+s)}function K4(e){var r=e.textContent;r===e._wrapperState.initialValue&&r!==""&&r!==null&&(e.value=r)}function ej(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cI(e,r){return e==null||e==="http://www.w3.org/1999/xhtml"?ej(r):e==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var DE,tj=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,o,s,c){MSApp.execUnsafeLocalFunction(function(){return e(r,o,s,c)})}:e}(function(e,r){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=r;else{for(DE=DE||document.createElement("div"),DE.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=DE.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;r.firstChild;)e.appendChild(r.firstChild)}});function Om(e,r){if(r){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=r;return}}e.textContent=r}var lm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pie=["Webkit","ms","Moz","O"];Object.keys(lm).forEach(function(e){pie.forEach(function(r){r=r+e.charAt(0).toUpperCase()+e.substring(1),lm[r]=lm[e]})});function nj(e,r,o){return r==null||typeof r=="boolean"||r===""?"":o||typeof r!="number"||r===0||lm.hasOwnProperty(e)&&lm[e]?(""+r).trim():r+"px"}function rj(e,r){e=e.style;for(var o in r)if(r.hasOwnProperty(o)){var s=o.indexOf("--")===0,c=nj(o,r[o],s);o==="float"&&(o="cssFloat"),s?e.setProperty(o,c):e[o]=c}}var fie=Jr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function lI(e,r){if(r){if(fie[e]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(Ye(137,e));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(Ye(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(Ye(61))}if(r.style!=null&&typeof r.style!="object")throw Error(Ye(62))}}function uI(e,r){if(e.indexOf("-")===-1)return typeof r.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dI=null;function gO(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var hI=null,zp=null,Kp=null;function Y4(e){if(e=lg(e)){if(typeof hI!="function")throw Error(Ye(280));var r=e.stateNode;r&&(r=Qy(r),hI(e.stateNode,e.type,r))}}function ij(e){zp?Kp?Kp.push(e):Kp=[e]:zp=e}function oj(){if(zp){var e=zp,r=Kp;if(Kp=zp=null,Y4(e),r)for(e=0;e<r.length;e++)Y4(r[e])}}function aj(e,r){return e(r)}function sj(){}var n1=!1;function cj(e,r,o){if(n1)return e(r,o);n1=!0;try{return aj(e,r,o)}finally{n1=!1,(zp!==null||Kp!==null)&&(sj(),oj())}}function xm(e,r){var o=e.stateNode;if(o===null)return null;var s=Qy(o);if(s===null)return null;o=s[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(Ye(231,r,typeof o));return o}var pI=!1;if(yl)try{var $0={};Object.defineProperty($0,"passive",{get:function(){pI=!0}}),window.addEventListener("test",$0,$0),window.removeEventListener("test",$0,$0)}catch{pI=!1}function mie(e,r,o,s,c,d,f,m,g){var _=Array.prototype.slice.call(arguments,3);try{r.apply(o,_)}catch(S){this.onError(S)}}var um=!1,$_=null,H_=!1,fI=null,gie={onError:function(e){um=!0,$_=e}};function vie(e,r,o,s,c,d,f,m,g){um=!1,$_=null,mie.apply(gie,arguments)}function Eie(e,r,o,s,c,d,f,m,g){if(vie.apply(this,arguments),um){if(um){var _=$_;um=!1,$_=null}else throw Error(Ye(198));H_||(H_=!0,fI=_)}}function ih(e){var r=e,o=e;if(e.alternate)for(;r.return;)r=r.return;else{e=r;do r=e,r.flags&4098&&(o=r.return),e=r.return;while(e)}return r.tag===3?o:null}function lj(e){if(e.tag===13){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function q4(e){if(ih(e)!==e)throw Error(Ye(188))}function _ie(e){var r=e.alternate;if(!r){if(r=ih(e),r===null)throw Error(Ye(188));return r!==e?null:e}for(var o=e,s=r;;){var c=o.return;if(c===null)break;var d=c.alternate;if(d===null){if(s=c.return,s!==null){o=s;continue}break}if(c.child===d.child){for(d=c.child;d;){if(d===o)return q4(c),e;if(d===s)return q4(c),r;d=d.sibling}throw Error(Ye(188))}if(o.return!==s.return)o=c,s=d;else{for(var f=!1,m=c.child;m;){if(m===o){f=!0,o=c,s=d;break}if(m===s){f=!0,s=c,o=d;break}m=m.sibling}if(!f){for(m=d.child;m;){if(m===o){f=!0,o=d,s=c;break}if(m===s){f=!0,s=d,o=c;break}m=m.sibling}if(!f)throw Error(Ye(189))}}if(o.alternate!==s)throw Error(Ye(190))}if(o.tag!==3)throw Error(Ye(188));return o.stateNode.current===o?e:r}function uj(e){return e=_ie(e),e!==null?dj(e):null}function dj(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var r=dj(e);if(r!==null)return r;e=e.sibling}return null}var hj=$a.unstable_scheduleCallback,X4=$a.unstable_cancelCallback,yie=$a.unstable_shouldYield,Sie=$a.unstable_requestPaint,fi=$a.unstable_now,Cie=$a.unstable_getCurrentPriorityLevel,vO=$a.unstable_ImmediatePriority,pj=$a.unstable_UserBlockingPriority,W_=$a.unstable_NormalPriority,bie=$a.unstable_LowPriority,fj=$a.unstable_IdlePriority,Yy=null,Mc=null;function Tie(e){if(Mc&&typeof Mc.onCommitFiberRoot=="function")try{Mc.onCommitFiberRoot(Yy,e,void 0,(e.current.flags&128)===128)}catch{}}var Js=Math.clz32?Math.clz32:Iie,Rie=Math.log,wie=Math.LN2;function Iie(e){return e>>>=0,e===0?32:31-(Rie(e)/wie|0)|0}var kE=64,LE=4194304;function om(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function G_(e,r){var o=e.pendingLanes;if(o===0)return 0;var s=0,c=e.suspendedLanes,d=e.pingedLanes,f=o&268435455;if(f!==0){var m=f&~c;m!==0?s=om(m):(d&=f,d!==0&&(s=om(d)))}else f=o&~c,f!==0?s=om(f):d!==0&&(s=om(d));if(s===0)return 0;if(r!==0&&r!==s&&!(r&c)&&(c=s&-s,d=r&-r,c>=d||c===16&&(d&4194240)!==0))return r;if(s&4&&(s|=o&16),r=e.entangledLanes,r!==0)for(e=e.entanglements,r&=s;0<r;)o=31-Js(r),c=1<<o,s|=e[o],r&=~c;return s}function Aie(e,r){switch(e){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Oie(e,r){for(var o=e.suspendedLanes,s=e.pingedLanes,c=e.expirationTimes,d=e.pendingLanes;0<d;){var f=31-Js(d),m=1<<f,g=c[f];g===-1?(!(m&o)||m&s)&&(c[f]=Aie(m,r)):g<=r&&(e.expiredLanes|=m),d&=~m}}function mI(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function mj(){var e=kE;return kE<<=1,!(kE&4194240)&&(kE=64),e}function r1(e){for(var r=[],o=0;31>o;o++)r.push(e);return r}function sg(e,r,o){e.pendingLanes|=r,r!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,r=31-Js(r),e[r]=o}function xie(e,r){var o=e.pendingLanes&~r;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=r,e.mutableReadLanes&=r,e.entangledLanes&=r,r=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<o;){var c=31-Js(o),d=1<<c;r[c]=0,s[c]=-1,e[c]=-1,o&=~d}}function EO(e,r){var o=e.entangledLanes|=r;for(e=e.entanglements;o;){var s=31-Js(o),c=1<<s;c&r|e[s]&r&&(e[s]|=r),o&=~c}}var ir=0;function gj(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var vj,_O,Ej,_j,yj,gI=!1,ME=[],Pu=null,Du=null,ku=null,Nm=new Map,Pm=new Map,Ru=[],Nie="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function J4(e,r){switch(e){case"focusin":case"focusout":Pu=null;break;case"dragenter":case"dragleave":Du=null;break;case"mouseover":case"mouseout":ku=null;break;case"pointerover":case"pointerout":Nm.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pm.delete(r.pointerId)}}function H0(e,r,o,s,c,d){return e===null||e.nativeEvent!==d?(e={blockedOn:r,domEventName:o,eventSystemFlags:s,nativeEvent:d,targetContainers:[c]},r!==null&&(r=lg(r),r!==null&&_O(r)),e):(e.eventSystemFlags|=s,r=e.targetContainers,c!==null&&r.indexOf(c)===-1&&r.push(c),e)}function Pie(e,r,o,s,c){switch(r){case"focusin":return Pu=H0(Pu,e,r,o,s,c),!0;case"dragenter":return Du=H0(Du,e,r,o,s,c),!0;case"mouseover":return ku=H0(ku,e,r,o,s,c),!0;case"pointerover":var d=c.pointerId;return Nm.set(d,H0(Nm.get(d)||null,e,r,o,s,c)),!0;case"gotpointercapture":return d=c.pointerId,Pm.set(d,H0(Pm.get(d)||null,e,r,o,s,c)),!0}return!1}function Sj(e){var r=Ld(e.target);if(r!==null){var o=ih(r);if(o!==null){if(r=o.tag,r===13){if(r=lj(o),r!==null){e.blockedOn=r,yj(e.priority,function(){Ej(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function __(e){if(e.blockedOn!==null)return!1;for(var r=e.targetContainers;0<r.length;){var o=vI(e.domEventName,e.eventSystemFlags,r[0],e.nativeEvent);if(o===null){o=e.nativeEvent;var s=new o.constructor(o.type,o);dI=s,o.target.dispatchEvent(s),dI=null}else return r=lg(o),r!==null&&_O(r),e.blockedOn=o,!1;r.shift()}return!0}function Q4(e,r,o){__(e)&&o.delete(r)}function Die(){gI=!1,Pu!==null&&__(Pu)&&(Pu=null),Du!==null&&__(Du)&&(Du=null),ku!==null&&__(ku)&&(ku=null),Nm.forEach(Q4),Pm.forEach(Q4)}function W0(e,r){e.blockedOn===r&&(e.blockedOn=null,gI||(gI=!0,$a.unstable_scheduleCallback($a.unstable_NormalPriority,Die)))}function Dm(e){function r(c){return W0(c,e)}if(0<ME.length){W0(ME[0],e);for(var o=1;o<ME.length;o++){var s=ME[o];s.blockedOn===e&&(s.blockedOn=null)}}for(Pu!==null&&W0(Pu,e),Du!==null&&W0(Du,e),ku!==null&&W0(ku,e),Nm.forEach(r),Pm.forEach(r),o=0;o<Ru.length;o++)s=Ru[o],s.blockedOn===e&&(s.blockedOn=null);for(;0<Ru.length&&(o=Ru[0],o.blockedOn===null);)Sj(o),o.blockedOn===null&&Ru.shift()}var Yp=xl.ReactCurrentBatchConfig,z_=!0;function kie(e,r,o,s){var c=ir,d=Yp.transition;Yp.transition=null;try{ir=1,yO(e,r,o,s)}finally{ir=c,Yp.transition=d}}function Lie(e,r,o,s){var c=ir,d=Yp.transition;Yp.transition=null;try{ir=4,yO(e,r,o,s)}finally{ir=c,Yp.transition=d}}function yO(e,r,o,s){if(z_){var c=vI(e,r,o,s);if(c===null)p1(e,r,s,K_,o),J4(e,s);else if(Pie(c,e,r,o,s))s.stopPropagation();else if(J4(e,s),r&4&&-1<Nie.indexOf(e)){for(;c!==null;){var d=lg(c);if(d!==null&&vj(d),d=vI(e,r,o,s),d===null&&p1(e,r,s,K_,o),d===c)break;c=d}c!==null&&s.stopPropagation()}else p1(e,r,s,null,o)}}var K_=null;function vI(e,r,o,s){if(K_=null,e=gO(s),e=Ld(e),e!==null)if(r=ih(e),r===null)e=null;else if(o=r.tag,o===13){if(e=lj(r),e!==null)return e;e=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;e=null}else r!==e&&(e=null);return K_=e,null}function Cj(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Cie()){case vO:return 1;case pj:return 4;case W_:case bie:return 16;case fj:return 536870912;default:return 16}default:return 16}}var Iu=null,SO=null,y_=null;function bj(){if(y_)return y_;var e,r=SO,o=r.length,s,c="value"in Iu?Iu.value:Iu.textContent,d=c.length;for(e=0;e<o&&r[e]===c[e];e++);var f=o-e;for(s=1;s<=f&&r[o-s]===c[d-s];s++);return y_=c.slice(e,1<s?1-s:void 0)}function S_(e){var r=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&r===13&&(e=13)):e=r,e===10&&(e=13),32<=e||e===13?e:0}function FE(){return!0}function Z4(){return!1}function Ga(e){function r(o,s,c,d,f){this._reactName=o,this._targetInst=c,this.type=s,this.nativeEvent=d,this.target=f,this.currentTarget=null;for(var m in e)e.hasOwnProperty(m)&&(o=e[m],this[m]=o?o(d):d[m]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?FE:Z4,this.isPropagationStopped=Z4,this}return Jr(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=FE)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=FE)},persist:function(){},isPersistent:FE}),r}var vf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},CO=Ga(vf),cg=Jr({},vf,{view:0,detail:0}),Mie=Ga(cg),i1,o1,G0,qy=Jr({},cg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bO,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==G0&&(G0&&e.type==="mousemove"?(i1=e.screenX-G0.screenX,o1=e.screenY-G0.screenY):o1=i1=0,G0=e),i1)},movementY:function(e){return"movementY"in e?e.movementY:o1}}),e3=Ga(qy),Fie=Jr({},qy,{dataTransfer:0}),Uie=Ga(Fie),Bie=Jr({},cg,{relatedTarget:0}),a1=Ga(Bie),jie=Jr({},vf,{animationName:0,elapsedTime:0,pseudoElement:0}),Vie=Ga(jie),$ie=Jr({},vf,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Hie=Ga($ie),Wie=Jr({},vf,{data:0}),t3=Ga(Wie),Gie={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zie={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Kie={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yie(e){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(e):(e=Kie[e])?!!r[e]:!1}function bO(){return Yie}var qie=Jr({},cg,{key:function(e){if(e.key){var r=Gie[e.key]||e.key;if(r!=="Unidentified")return r}return e.type==="keypress"?(e=S_(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?zie[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bO,charCode:function(e){return e.type==="keypress"?S_(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?S_(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Xie=Ga(qie),Jie=Jr({},qy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),n3=Ga(Jie),Qie=Jr({},cg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bO}),Zie=Ga(Qie),eoe=Jr({},vf,{propertyName:0,elapsedTime:0,pseudoElement:0}),toe=Ga(eoe),noe=Jr({},qy,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),roe=Ga(noe),ioe=[9,13,27,32],TO=yl&&"CompositionEvent"in window,dm=null;yl&&"documentMode"in document&&(dm=document.documentMode);var ooe=yl&&"TextEvent"in window&&!dm,Tj=yl&&(!TO||dm&&8<dm&&11>=dm),r3=String.fromCharCode(32),i3=!1;function Rj(e,r){switch(e){case"keyup":return ioe.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wj(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Np=!1;function aoe(e,r){switch(e){case"compositionend":return wj(r);case"keypress":return r.which!==32?null:(i3=!0,r3);case"textInput":return e=r.data,e===r3&&i3?null:e;default:return null}}function soe(e,r){if(Np)return e==="compositionend"||!TO&&Rj(e,r)?(e=bj(),y_=SO=Iu=null,Np=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Tj&&r.locale!=="ko"?null:r.data;default:return null}}var coe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function o3(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r==="input"?!!coe[e.type]:r==="textarea"}function Ij(e,r,o,s){ij(s),r=Y_(r,"onChange"),0<r.length&&(o=new CO("onChange","change",null,o,s),e.push({event:o,listeners:r}))}var hm=null,km=null;function loe(e){Uj(e,0)}function Xy(e){var r=kp(e);if(J8(r))return e}function uoe(e,r){if(e==="change")return r}var Aj=!1;if(yl){var s1;if(yl){var c1="oninput"in document;if(!c1){var a3=document.createElement("div");a3.setAttribute("oninput","return;"),c1=typeof a3.oninput=="function"}s1=c1}else s1=!1;Aj=s1&&(!document.documentMode||9<document.documentMode)}function s3(){hm&&(hm.detachEvent("onpropertychange",Oj),km=hm=null)}function Oj(e){if(e.propertyName==="value"&&Xy(km)){var r=[];Ij(r,km,e,gO(e)),cj(loe,r)}}function doe(e,r,o){e==="focusin"?(s3(),hm=r,km=o,hm.attachEvent("onpropertychange",Oj)):e==="focusout"&&s3()}function hoe(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Xy(km)}function poe(e,r){if(e==="click")return Xy(r)}function foe(e,r){if(e==="input"||e==="change")return Xy(r)}function moe(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var tc=typeof Object.is=="function"?Object.is:moe;function Lm(e,r){if(tc(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var o=Object.keys(e),s=Object.keys(r);if(o.length!==s.length)return!1;for(s=0;s<o.length;s++){var c=o[s];if(!Zw.call(r,c)||!tc(e[c],r[c]))return!1}return!0}function c3(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function l3(e,r){var o=c3(e);e=0;for(var s;o;){if(o.nodeType===3){if(s=e+o.textContent.length,e<=r&&s>=r)return{node:o,offset:r-e};e=s}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=c3(o)}}function xj(e,r){return e&&r?e===r?!0:e&&e.nodeType===3?!1:r&&r.nodeType===3?xj(e,r.parentNode):"contains"in e?e.contains(r):e.compareDocumentPosition?!!(e.compareDocumentPosition(r)&16):!1:!1}function Nj(){for(var e=window,r=V_();r instanceof e.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)e=r.contentWindow;else break;r=V_(e.document)}return r}function RO(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r&&(r==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||r==="textarea"||e.contentEditable==="true")}function goe(e){var r=Nj(),o=e.focusedElem,s=e.selectionRange;if(r!==o&&o&&o.ownerDocument&&xj(o.ownerDocument.documentElement,o)){if(s!==null&&RO(o)){if(r=s.start,e=s.end,e===void 0&&(e=r),"selectionStart"in o)o.selectionStart=r,o.selectionEnd=Math.min(e,o.value.length);else if(e=(r=o.ownerDocument||document)&&r.defaultView||window,e.getSelection){e=e.getSelection();var c=o.textContent.length,d=Math.min(s.start,c);s=s.end===void 0?d:Math.min(s.end,c),!e.extend&&d>s&&(c=s,s=d,d=c),c=l3(o,d);var f=l3(o,s);c&&f&&(e.rangeCount!==1||e.anchorNode!==c.node||e.anchorOffset!==c.offset||e.focusNode!==f.node||e.focusOffset!==f.offset)&&(r=r.createRange(),r.setStart(c.node,c.offset),e.removeAllRanges(),d>s?(e.addRange(r),e.extend(f.node,f.offset)):(r.setEnd(f.node,f.offset),e.addRange(r)))}}for(r=[],e=o;e=e.parentNode;)e.nodeType===1&&r.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<r.length;o++)e=r[o],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var voe=yl&&"documentMode"in document&&11>=document.documentMode,Pp=null,EI=null,pm=null,_I=!1;function u3(e,r,o){var s=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;_I||Pp==null||Pp!==V_(s)||(s=Pp,"selectionStart"in s&&RO(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),pm&&Lm(pm,s)||(pm=s,s=Y_(EI,"onSelect"),0<s.length&&(r=new CO("onSelect","select",null,r,o),e.push({event:r,listeners:s}),r.target=Pp)))}function UE(e,r){var o={};return o[e.toLowerCase()]=r.toLowerCase(),o["Webkit"+e]="webkit"+r,o["Moz"+e]="moz"+r,o}var Dp={animationend:UE("Animation","AnimationEnd"),animationiteration:UE("Animation","AnimationIteration"),animationstart:UE("Animation","AnimationStart"),transitionend:UE("Transition","TransitionEnd")},l1={},Pj={};yl&&(Pj=document.createElement("div").style,"AnimationEvent"in window||(delete Dp.animationend.animation,delete Dp.animationiteration.animation,delete Dp.animationstart.animation),"TransitionEvent"in window||delete Dp.transitionend.transition);function Jy(e){if(l1[e])return l1[e];if(!Dp[e])return e;var r=Dp[e],o;for(o in r)if(r.hasOwnProperty(o)&&o in Pj)return l1[e]=r[o];return e}var Dj=Jy("animationend"),kj=Jy("animationiteration"),Lj=Jy("animationstart"),Mj=Jy("transitionend"),Fj=new Map,d3="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zu(e,r){Fj.set(e,r),rh(r,[e])}for(var u1=0;u1<d3.length;u1++){var d1=d3[u1],Eoe=d1.toLowerCase(),_oe=d1[0].toUpperCase()+d1.slice(1);zu(Eoe,"on"+_oe)}zu(Dj,"onAnimationEnd");zu(kj,"onAnimationIteration");zu(Lj,"onAnimationStart");zu("dblclick","onDoubleClick");zu("focusin","onFocus");zu("focusout","onBlur");zu(Mj,"onTransitionEnd");Qp("onMouseEnter",["mouseout","mouseover"]);Qp("onMouseLeave",["mouseout","mouseover"]);Qp("onPointerEnter",["pointerout","pointerover"]);Qp("onPointerLeave",["pointerout","pointerover"]);rh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));rh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));rh("onBeforeInput",["compositionend","keypress","textInput","paste"]);rh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));rh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));rh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var am="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yoe=new Set("cancel close invalid load scroll toggle".split(" ").concat(am));function h3(e,r,o){var s=e.type||"unknown-event";e.currentTarget=o,Eie(s,r,void 0,e),e.currentTarget=null}function Uj(e,r){r=(r&4)!==0;for(var o=0;o<e.length;o++){var s=e[o],c=s.event;s=s.listeners;e:{var d=void 0;if(r)for(var f=s.length-1;0<=f;f--){var m=s[f],g=m.instance,_=m.currentTarget;if(m=m.listener,g!==d&&c.isPropagationStopped())break e;h3(c,m,_),d=g}else for(f=0;f<s.length;f++){if(m=s[f],g=m.instance,_=m.currentTarget,m=m.listener,g!==d&&c.isPropagationStopped())break e;h3(c,m,_),d=g}}}if(H_)throw e=fI,H_=!1,fI=null,e}function xr(e,r){var o=r[TI];o===void 0&&(o=r[TI]=new Set);var s=e+"__bubble";o.has(s)||(Bj(r,e,2,!1),o.add(s))}function h1(e,r,o){var s=0;r&&(s|=4),Bj(o,e,s,r)}var BE="_reactListening"+Math.random().toString(36).slice(2);function Mm(e){if(!e[BE]){e[BE]=!0,z8.forEach(function(o){o!=="selectionchange"&&(yoe.has(o)||h1(o,!1,e),h1(o,!0,e))});var r=e.nodeType===9?e:e.ownerDocument;r===null||r[BE]||(r[BE]=!0,h1("selectionchange",!1,r))}}function Bj(e,r,o,s){switch(Cj(r)){case 1:var c=kie;break;case 4:c=Lie;break;default:c=yO}o=c.bind(null,r,o,e),c=void 0,!pI||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(c=!0),s?c!==void 0?e.addEventListener(r,o,{capture:!0,passive:c}):e.addEventListener(r,o,!0):c!==void 0?e.addEventListener(r,o,{passive:c}):e.addEventListener(r,o,!1)}function p1(e,r,o,s,c){var d=s;if(!(r&1)&&!(r&2)&&s!==null)e:for(;;){if(s===null)return;var f=s.tag;if(f===3||f===4){var m=s.stateNode.containerInfo;if(m===c||m.nodeType===8&&m.parentNode===c)break;if(f===4)for(f=s.return;f!==null;){var g=f.tag;if((g===3||g===4)&&(g=f.stateNode.containerInfo,g===c||g.nodeType===8&&g.parentNode===c))return;f=f.return}for(;m!==null;){if(f=Ld(m),f===null)return;if(g=f.tag,g===5||g===6){s=d=f;continue e}m=m.parentNode}}s=s.return}cj(function(){var _=d,S=gO(o),T=[];e:{var R=Fj.get(e);if(R!==void 0){var N=CO,A=e;switch(e){case"keypress":if(S_(o)===0)break e;case"keydown":case"keyup":N=Xie;break;case"focusin":A="focus",N=a1;break;case"focusout":A="blur",N=a1;break;case"beforeblur":case"afterblur":N=a1;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":N=e3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":N=Uie;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":N=Zie;break;case Dj:case kj:case Lj:N=Vie;break;case Mj:N=toe;break;case"scroll":N=Mie;break;case"wheel":N=roe;break;case"copy":case"cut":case"paste":N=Hie;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":N=n3}var O=(r&4)!==0,M=!O&&e==="scroll",x=O?R!==null?R+"Capture":null:R;O=[];for(var P=_,D;P!==null;){D=P;var F=D.stateNode;if(D.tag===5&&F!==null&&(D=F,x!==null&&(F=xm(P,x),F!=null&&O.push(Fm(P,F,D)))),M)break;P=P.return}0<O.length&&(R=new N(R,A,null,o,S),T.push({event:R,listeners:O}))}}if(!(r&7)){e:{if(R=e==="mouseover"||e==="pointerover",N=e==="mouseout"||e==="pointerout",R&&o!==dI&&(A=o.relatedTarget||o.fromElement)&&(Ld(A)||A[Sl]))break e;if((N||R)&&(R=S.window===S?S:(R=S.ownerDocument)?R.defaultView||R.parentWindow:window,N?(A=o.relatedTarget||o.toElement,N=_,A=A?Ld(A):null,A!==null&&(M=ih(A),A!==M||A.tag!==5&&A.tag!==6)&&(A=null)):(N=null,A=_),N!==A)){if(O=e3,F="onMouseLeave",x="onMouseEnter",P="mouse",(e==="pointerout"||e==="pointerover")&&(O=n3,F="onPointerLeave",x="onPointerEnter",P="pointer"),M=N==null?R:kp(N),D=A==null?R:kp(A),R=new O(F,P+"leave",N,o,S),R.target=M,R.relatedTarget=D,F=null,Ld(S)===_&&(O=new O(x,P+"enter",A,o,S),O.target=D,O.relatedTarget=M,F=O),M=F,N&&A)t:{for(O=N,x=A,P=0,D=O;D;D=pp(D))P++;for(D=0,F=x;F;F=pp(F))D++;for(;0<P-D;)O=pp(O),P--;for(;0<D-P;)x=pp(x),D--;for(;P--;){if(O===x||x!==null&&O===x.alternate)break t;O=pp(O),x=pp(x)}O=null}else O=null;N!==null&&p3(T,R,N,O,!1),A!==null&&M!==null&&p3(T,M,A,O,!0)}}e:{if(R=_?kp(_):window,N=R.nodeName&&R.nodeName.toLowerCase(),N==="select"||N==="input"&&R.type==="file")var $=uoe;else if(o3(R))if(Aj)$=foe;else{$=hoe;var V=doe}else(N=R.nodeName)&&N.toLowerCase()==="input"&&(R.type==="checkbox"||R.type==="radio")&&($=poe);if($&&($=$(e,_))){Ij(T,$,o,S);break e}V&&V(e,R,_),e==="focusout"&&(V=R._wrapperState)&&V.controlled&&R.type==="number"&&aI(R,"number",R.value)}switch(V=_?kp(_):window,e){case"focusin":(o3(V)||V.contentEditable==="true")&&(Pp=V,EI=_,pm=null);break;case"focusout":pm=EI=Pp=null;break;case"mousedown":_I=!0;break;case"contextmenu":case"mouseup":case"dragend":_I=!1,u3(T,o,S);break;case"selectionchange":if(voe)break;case"keydown":case"keyup":u3(T,o,S)}var W;if(TO)e:{switch(e){case"compositionstart":var K="onCompositionStart";break e;case"compositionend":K="onCompositionEnd";break e;case"compositionupdate":K="onCompositionUpdate";break e}K=void 0}else Np?Rj(e,o)&&(K="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(K="onCompositionStart");K&&(Tj&&o.locale!=="ko"&&(Np||K!=="onCompositionStart"?K==="onCompositionEnd"&&Np&&(W=bj()):(Iu=S,SO="value"in Iu?Iu.value:Iu.textContent,Np=!0)),V=Y_(_,K),0<V.length&&(K=new t3(K,e,null,o,S),T.push({event:K,listeners:V}),W?K.data=W:(W=wj(o),W!==null&&(K.data=W)))),(W=ooe?aoe(e,o):soe(e,o))&&(_=Y_(_,"onBeforeInput"),0<_.length&&(S=new t3("onBeforeInput","beforeinput",null,o,S),T.push({event:S,listeners:_}),S.data=W))}Uj(T,r)})}function Fm(e,r,o){return{instance:e,listener:r,currentTarget:o}}function Y_(e,r){for(var o=r+"Capture",s=[];e!==null;){var c=e,d=c.stateNode;c.tag===5&&d!==null&&(c=d,d=xm(e,o),d!=null&&s.unshift(Fm(e,d,c)),d=xm(e,r),d!=null&&s.push(Fm(e,d,c))),e=e.return}return s}function pp(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function p3(e,r,o,s,c){for(var d=r._reactName,f=[];o!==null&&o!==s;){var m=o,g=m.alternate,_=m.stateNode;if(g!==null&&g===s)break;m.tag===5&&_!==null&&(m=_,c?(g=xm(o,d),g!=null&&f.unshift(Fm(o,g,m))):c||(g=xm(o,d),g!=null&&f.push(Fm(o,g,m)))),o=o.return}f.length!==0&&e.push({event:r,listeners:f})}var Soe=/\r\n?/g,Coe=/\u0000|\uFFFD/g;function f3(e){return(typeof e=="string"?e:""+e).replace(Soe,`
`).replace(Coe,"")}function jE(e,r,o){if(r=f3(r),f3(e)!==r&&o)throw Error(Ye(425))}function q_(){}var yI=null,SI=null;function CI(e,r){return e==="textarea"||e==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var bI=typeof setTimeout=="function"?setTimeout:void 0,boe=typeof clearTimeout=="function"?clearTimeout:void 0,m3=typeof Promise=="function"?Promise:void 0,Toe=typeof queueMicrotask=="function"?queueMicrotask:typeof m3<"u"?function(e){return m3.resolve(null).then(e).catch(Roe)}:bI;function Roe(e){setTimeout(function(){throw e})}function f1(e,r){var o=r,s=0;do{var c=o.nextSibling;if(e.removeChild(o),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0){e.removeChild(c),Dm(r);return}s--}else o!=="$"&&o!=="$?"&&o!=="$!"||s++;o=c}while(o);Dm(r)}function Lu(e){for(;e!=null;e=e.nextSibling){var r=e.nodeType;if(r===1||r===3)break;if(r===8){if(r=e.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return e}function g3(e){e=e.previousSibling;for(var r=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"){if(r===0)return e;r--}else o==="/$"&&r++}e=e.previousSibling}return null}var Ef=Math.random().toString(36).slice(2),Lc="__reactFiber$"+Ef,Um="__reactProps$"+Ef,Sl="__reactContainer$"+Ef,TI="__reactEvents$"+Ef,woe="__reactListeners$"+Ef,Ioe="__reactHandles$"+Ef;function Ld(e){var r=e[Lc];if(r)return r;for(var o=e.parentNode;o;){if(r=o[Sl]||o[Lc]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(e=g3(e);e!==null;){if(o=e[Lc])return o;e=g3(e)}return r}e=o,o=e.parentNode}return null}function lg(e){return e=e[Lc]||e[Sl],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function kp(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ye(33))}function Qy(e){return e[Um]||null}var RI=[],Lp=-1;function Ku(e){return{current:e}}function Nr(e){0>Lp||(e.current=RI[Lp],RI[Lp]=null,Lp--)}function Ir(e,r){Lp++,RI[Lp]=e.current,e.current=r}var Vu={},wo=Ku(Vu),ua=Ku(!1),qd=Vu;function Zp(e,r){var o=e.type.contextTypes;if(!o)return Vu;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===r)return s.__reactInternalMemoizedMaskedChildContext;var c={},d;for(d in o)c[d]=r[d];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=c),c}function da(e){return e=e.childContextTypes,e!=null}function X_(){Nr(ua),Nr(wo)}function v3(e,r,o){if(wo.current!==Vu)throw Error(Ye(168));Ir(wo,r),Ir(ua,o)}function jj(e,r,o){var s=e.stateNode;if(r=r.childContextTypes,typeof s.getChildContext!="function")return o;s=s.getChildContext();for(var c in s)if(!(c in r))throw Error(Ye(108,die(e)||"Unknown",c));return Jr({},o,s)}function J_(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vu,qd=wo.current,Ir(wo,e),Ir(ua,ua.current),!0}function E3(e,r,o){var s=e.stateNode;if(!s)throw Error(Ye(169));o?(e=jj(e,r,qd),s.__reactInternalMemoizedMergedChildContext=e,Nr(ua),Nr(wo),Ir(wo,e)):Nr(ua),Ir(ua,o)}var hl=null,Zy=!1,m1=!1;function Vj(e){hl===null?hl=[e]:hl.push(e)}function Aoe(e){Zy=!0,Vj(e)}function Yu(){if(!m1&&hl!==null){m1=!0;var e=0,r=ir;try{var o=hl;for(ir=1;e<o.length;e++){var s=o[e];do s=s(!0);while(s!==null)}hl=null,Zy=!1}catch(c){throw hl!==null&&(hl=hl.slice(e+1)),hj(vO,Yu),c}finally{ir=r,m1=!1}}return null}var Mp=[],Fp=0,Q_=null,Z_=0,fs=[],ms=0,Xd=null,fl=1,ml="";function xd(e,r){Mp[Fp++]=Z_,Mp[Fp++]=Q_,Q_=e,Z_=r}function $j(e,r,o){fs[ms++]=fl,fs[ms++]=ml,fs[ms++]=Xd,Xd=e;var s=fl;e=ml;var c=32-Js(s)-1;s&=~(1<<c),o+=1;var d=32-Js(r)+c;if(30<d){var f=c-c%5;d=(s&(1<<f)-1).toString(32),s>>=f,c-=f,fl=1<<32-Js(r)+c|o<<c|s,ml=d+e}else fl=1<<d|o<<c|s,ml=e}function wO(e){e.return!==null&&(xd(e,1),$j(e,1,0))}function IO(e){for(;e===Q_;)Q_=Mp[--Fp],Mp[Fp]=null,Z_=Mp[--Fp],Mp[Fp]=null;for(;e===Xd;)Xd=fs[--ms],fs[ms]=null,ml=fs[--ms],fs[ms]=null,fl=fs[--ms],fs[ms]=null}var ja=null,Ua=null,Hr=!1,Ys=null;function Hj(e,r){var o=gs(5,null,null,0);o.elementType="DELETED",o.stateNode=r,o.return=e,r=e.deletions,r===null?(e.deletions=[o],e.flags|=16):r.push(o)}function _3(e,r){switch(e.tag){case 5:var o=e.type;return r=r.nodeType!==1||o.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(e.stateNode=r,ja=e,Ua=Lu(r.firstChild),!0):!1;case 6:return r=e.pendingProps===""||r.nodeType!==3?null:r,r!==null?(e.stateNode=r,ja=e,Ua=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(o=Xd!==null?{id:fl,overflow:ml}:null,e.memoizedState={dehydrated:r,treeContext:o,retryLane:1073741824},o=gs(18,null,null,0),o.stateNode=r,o.return=e,e.child=o,ja=e,Ua=null,!0):!1;default:return!1}}function wI(e){return(e.mode&1)!==0&&(e.flags&128)===0}function II(e){if(Hr){var r=Ua;if(r){var o=r;if(!_3(e,r)){if(wI(e))throw Error(Ye(418));r=Lu(o.nextSibling);var s=ja;r&&_3(e,r)?Hj(s,o):(e.flags=e.flags&-4097|2,Hr=!1,ja=e)}}else{if(wI(e))throw Error(Ye(418));e.flags=e.flags&-4097|2,Hr=!1,ja=e}}}function y3(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ja=e}function VE(e){if(e!==ja)return!1;if(!Hr)return y3(e),Hr=!0,!1;var r;if((r=e.tag!==3)&&!(r=e.tag!==5)&&(r=e.type,r=r!=="head"&&r!=="body"&&!CI(e.type,e.memoizedProps)),r&&(r=Ua)){if(wI(e))throw Wj(),Error(Ye(418));for(;r;)Hj(e,r),r=Lu(r.nextSibling)}if(y3(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ye(317));e:{for(e=e.nextSibling,r=0;e;){if(e.nodeType===8){var o=e.data;if(o==="/$"){if(r===0){Ua=Lu(e.nextSibling);break e}r--}else o!=="$"&&o!=="$!"&&o!=="$?"||r++}e=e.nextSibling}Ua=null}}else Ua=ja?Lu(e.stateNode.nextSibling):null;return!0}function Wj(){for(var e=Ua;e;)e=Lu(e.nextSibling)}function ef(){Ua=ja=null,Hr=!1}function AO(e){Ys===null?Ys=[e]:Ys.push(e)}var Ooe=xl.ReactCurrentBatchConfig;function Hs(e,r){if(e&&e.defaultProps){r=Jr({},r),e=e.defaultProps;for(var o in e)r[o]===void 0&&(r[o]=e[o]);return r}return r}var ey=Ku(null),ty=null,Up=null,OO=null;function xO(){OO=Up=ty=null}function NO(e){var r=ey.current;Nr(ey),e._currentValue=r}function AI(e,r,o){for(;e!==null;){var s=e.alternate;if((e.childLanes&r)!==r?(e.childLanes|=r,s!==null&&(s.childLanes|=r)):s!==null&&(s.childLanes&r)!==r&&(s.childLanes|=r),e===o)break;e=e.return}}function qp(e,r){ty=e,OO=Up=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&r&&(ca=!0),e.firstContext=null)}function _s(e){var r=e._currentValue;if(OO!==e)if(e={context:e,memoizedValue:r,next:null},Up===null){if(ty===null)throw Error(Ye(308));Up=e,ty.dependencies={lanes:0,firstContext:e}}else Up=Up.next=e;return r}var Md=null;function PO(e){Md===null?Md=[e]:Md.push(e)}function Gj(e,r,o,s){var c=r.interleaved;return c===null?(o.next=o,PO(r)):(o.next=c.next,c.next=o),r.interleaved=o,Cl(e,s)}function Cl(e,r){e.lanes|=r;var o=e.alternate;for(o!==null&&(o.lanes|=r),o=e,e=e.return;e!==null;)e.childLanes|=r,o=e.alternate,o!==null&&(o.childLanes|=r),o=e,e=e.return;return o.tag===3?o.stateNode:null}var Tu=!1;function DO(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zj(e,r){e=e.updateQueue,r.updateQueue===e&&(r.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function gl(e,r){return{eventTime:e,lane:r,tag:0,payload:null,callback:null,next:null}}function Mu(e,r,o){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,Dn&2){var c=s.pending;return c===null?r.next=r:(r.next=c.next,c.next=r),s.pending=r,Cl(e,o)}return c=s.interleaved,c===null?(r.next=r,PO(s)):(r.next=c.next,c.next=r),s.interleaved=r,Cl(e,o)}function C_(e,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194240)!==0)){var s=r.lanes;s&=e.pendingLanes,o|=s,r.lanes=o,EO(e,o)}}function S3(e,r){var o=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,o===s)){var c=null,d=null;if(o=o.firstBaseUpdate,o!==null){do{var f={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};d===null?c=d=f:d=d.next=f,o=o.next}while(o!==null);d===null?c=d=r:d=d.next=r}else c=d=r;o={baseState:s.baseState,firstBaseUpdate:c,lastBaseUpdate:d,shared:s.shared,effects:s.effects},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=r:e.next=r,o.lastBaseUpdate=r}function ny(e,r,o,s){var c=e.updateQueue;Tu=!1;var d=c.firstBaseUpdate,f=c.lastBaseUpdate,m=c.shared.pending;if(m!==null){c.shared.pending=null;var g=m,_=g.next;g.next=null,f===null?d=_:f.next=_,f=g;var S=e.alternate;S!==null&&(S=S.updateQueue,m=S.lastBaseUpdate,m!==f&&(m===null?S.firstBaseUpdate=_:m.next=_,S.lastBaseUpdate=g))}if(d!==null){var T=c.baseState;f=0,S=_=g=null,m=d;do{var R=m.lane,N=m.eventTime;if((s&R)===R){S!==null&&(S=S.next={eventTime:N,lane:0,tag:m.tag,payload:m.payload,callback:m.callback,next:null});e:{var A=e,O=m;switch(R=r,N=o,O.tag){case 1:if(A=O.payload,typeof A=="function"){T=A.call(N,T,R);break e}T=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=O.payload,R=typeof A=="function"?A.call(N,T,R):A,R==null)break e;T=Jr({},T,R);break e;case 2:Tu=!0}}m.callback!==null&&m.lane!==0&&(e.flags|=64,R=c.effects,R===null?c.effects=[m]:R.push(m))}else N={eventTime:N,lane:R,tag:m.tag,payload:m.payload,callback:m.callback,next:null},S===null?(_=S=N,g=T):S=S.next=N,f|=R;if(m=m.next,m===null){if(m=c.shared.pending,m===null)break;R=m,m=R.next,R.next=null,c.lastBaseUpdate=R,c.shared.pending=null}}while(1);if(S===null&&(g=T),c.baseState=g,c.firstBaseUpdate=_,c.lastBaseUpdate=S,r=c.shared.interleaved,r!==null){c=r;do f|=c.lane,c=c.next;while(c!==r)}else d===null&&(c.shared.lanes=0);Qd|=f,e.lanes=f,e.memoizedState=T}}function C3(e,r,o){if(e=r.effects,r.effects=null,e!==null)for(r=0;r<e.length;r++){var s=e[r],c=s.callback;if(c!==null){if(s.callback=null,s=o,typeof c!="function")throw Error(Ye(191,c));c.call(s)}}}var Kj=new G8.Component().refs;function OI(e,r,o,s){r=e.memoizedState,o=o(s,r),o=o==null?r:Jr({},r,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var eS={isMounted:function(e){return(e=e._reactInternals)?ih(e)===e:!1},enqueueSetState:function(e,r,o){e=e._reactInternals;var s=jo(),c=Uu(e),d=gl(s,c);d.payload=r,o!=null&&(d.callback=o),r=Mu(e,d,c),r!==null&&(Qs(r,e,c,s),C_(r,e,c))},enqueueReplaceState:function(e,r,o){e=e._reactInternals;var s=jo(),c=Uu(e),d=gl(s,c);d.tag=1,d.payload=r,o!=null&&(d.callback=o),r=Mu(e,d,c),r!==null&&(Qs(r,e,c,s),C_(r,e,c))},enqueueForceUpdate:function(e,r){e=e._reactInternals;var o=jo(),s=Uu(e),c=gl(o,s);c.tag=2,r!=null&&(c.callback=r),r=Mu(e,c,s),r!==null&&(Qs(r,e,s,o),C_(r,e,s))}};function b3(e,r,o,s,c,d,f){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,d,f):r.prototype&&r.prototype.isPureReactComponent?!Lm(o,s)||!Lm(c,d):!0}function Yj(e,r,o){var s=!1,c=Vu,d=r.contextType;return typeof d=="object"&&d!==null?d=_s(d):(c=da(r)?qd:wo.current,s=r.contextTypes,d=(s=s!=null)?Zp(e,c):Vu),r=new r(o,d),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=eS,e.stateNode=r,r._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=c,e.__reactInternalMemoizedMaskedChildContext=d),r}function T3(e,r,o,s){e=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,s),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,s),r.state!==e&&eS.enqueueReplaceState(r,r.state,null)}function xI(e,r,o,s){var c=e.stateNode;c.props=o,c.state=e.memoizedState,c.refs=Kj,DO(e);var d=r.contextType;typeof d=="object"&&d!==null?c.context=_s(d):(d=da(r)?qd:wo.current,c.context=Zp(e,d)),c.state=e.memoizedState,d=r.getDerivedStateFromProps,typeof d=="function"&&(OI(e,r,d,o),c.state=e.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(r=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),r!==c.state&&eS.enqueueReplaceState(c,c.state,null),ny(e,o,c,s),c.state=e.memoizedState),typeof c.componentDidMount=="function"&&(e.flags|=4194308)}function z0(e,r,o){if(e=o.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(Ye(309));var s=o.stateNode}if(!s)throw Error(Ye(147,e));var c=s,d=""+e;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===d?r.ref:(r=function(f){var m=c.refs;m===Kj&&(m=c.refs={}),f===null?delete m[d]:m[d]=f},r._stringRef=d,r)}if(typeof e!="string")throw Error(Ye(284));if(!o._owner)throw Error(Ye(290,e))}return e}function $E(e,r){throw e=Object.prototype.toString.call(r),Error(Ye(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}function R3(e){var r=e._init;return r(e._payload)}function qj(e){function r(x,P){if(e){var D=x.deletions;D===null?(x.deletions=[P],x.flags|=16):D.push(P)}}function o(x,P){if(!e)return null;for(;P!==null;)r(x,P),P=P.sibling;return null}function s(x,P){for(x=new Map;P!==null;)P.key!==null?x.set(P.key,P):x.set(P.index,P),P=P.sibling;return x}function c(x,P){return x=Bu(x,P),x.index=0,x.sibling=null,x}function d(x,P,D){return x.index=D,e?(D=x.alternate,D!==null?(D=D.index,D<P?(x.flags|=2,P):D):(x.flags|=2,P)):(x.flags|=1048576,P)}function f(x){return e&&x.alternate===null&&(x.flags|=2),x}function m(x,P,D,F){return P===null||P.tag!==6?(P=C1(D,x.mode,F),P.return=x,P):(P=c(P,D),P.return=x,P)}function g(x,P,D,F){var $=D.type;return $===xp?S(x,P,D.props.children,F,D.key):P!==null&&(P.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===bu&&R3($)===P.type)?(F=c(P,D.props),F.ref=z0(x,P,D),F.return=x,F):(F=A_(D.type,D.key,D.props,null,x.mode,F),F.ref=z0(x,P,D),F.return=x,F)}function _(x,P,D,F){return P===null||P.tag!==4||P.stateNode.containerInfo!==D.containerInfo||P.stateNode.implementation!==D.implementation?(P=b1(D,x.mode,F),P.return=x,P):(P=c(P,D.children||[]),P.return=x,P)}function S(x,P,D,F,$){return P===null||P.tag!==7?(P=$d(D,x.mode,F,$),P.return=x,P):(P=c(P,D),P.return=x,P)}function T(x,P,D){if(typeof P=="string"&&P!==""||typeof P=="number")return P=C1(""+P,x.mode,D),P.return=x,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case NE:return D=A_(P.type,P.key,P.props,null,x.mode,D),D.ref=z0(x,null,P),D.return=x,D;case Op:return P=b1(P,x.mode,D),P.return=x,P;case bu:var F=P._init;return T(x,F(P._payload),D)}if(im(P)||V0(P))return P=$d(P,x.mode,D,null),P.return=x,P;$E(x,P)}return null}function R(x,P,D,F){var $=P!==null?P.key:null;if(typeof D=="string"&&D!==""||typeof D=="number")return $!==null?null:m(x,P,""+D,F);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case NE:return D.key===$?g(x,P,D,F):null;case Op:return D.key===$?_(x,P,D,F):null;case bu:return $=D._init,R(x,P,$(D._payload),F)}if(im(D)||V0(D))return $!==null?null:S(x,P,D,F,null);$E(x,D)}return null}function N(x,P,D,F,$){if(typeof F=="string"&&F!==""||typeof F=="number")return x=x.get(D)||null,m(P,x,""+F,$);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case NE:return x=x.get(F.key===null?D:F.key)||null,g(P,x,F,$);case Op:return x=x.get(F.key===null?D:F.key)||null,_(P,x,F,$);case bu:var V=F._init;return N(x,P,D,V(F._payload),$)}if(im(F)||V0(F))return x=x.get(D)||null,S(P,x,F,$,null);$E(P,F)}return null}function A(x,P,D,F){for(var $=null,V=null,W=P,K=P=0,Q=null;W!==null&&K<D.length;K++){W.index>K?(Q=W,W=null):Q=W.sibling;var Y=R(x,W,D[K],F);if(Y===null){W===null&&(W=Q);break}e&&W&&Y.alternate===null&&r(x,W),P=d(Y,P,K),V===null?$=Y:V.sibling=Y,V=Y,W=Q}if(K===D.length)return o(x,W),Hr&&xd(x,K),$;if(W===null){for(;K<D.length;K++)W=T(x,D[K],F),W!==null&&(P=d(W,P,K),V===null?$=W:V.sibling=W,V=W);return Hr&&xd(x,K),$}for(W=s(x,W);K<D.length;K++)Q=N(W,x,K,D[K],F),Q!==null&&(e&&Q.alternate!==null&&W.delete(Q.key===null?K:Q.key),P=d(Q,P,K),V===null?$=Q:V.sibling=Q,V=Q);return e&&W.forEach(function(ee){return r(x,ee)}),Hr&&xd(x,K),$}function O(x,P,D,F){var $=V0(D);if(typeof $!="function")throw Error(Ye(150));if(D=$.call(D),D==null)throw Error(Ye(151));for(var V=$=null,W=P,K=P=0,Q=null,Y=D.next();W!==null&&!Y.done;K++,Y=D.next()){W.index>K?(Q=W,W=null):Q=W.sibling;var ee=R(x,W,Y.value,F);if(ee===null){W===null&&(W=Q);break}e&&W&&ee.alternate===null&&r(x,W),P=d(ee,P,K),V===null?$=ee:V.sibling=ee,V=ee,W=Q}if(Y.done)return o(x,W),Hr&&xd(x,K),$;if(W===null){for(;!Y.done;K++,Y=D.next())Y=T(x,Y.value,F),Y!==null&&(P=d(Y,P,K),V===null?$=Y:V.sibling=Y,V=Y);return Hr&&xd(x,K),$}for(W=s(x,W);!Y.done;K++,Y=D.next())Y=N(W,x,K,Y.value,F),Y!==null&&(e&&Y.alternate!==null&&W.delete(Y.key===null?K:Y.key),P=d(Y,P,K),V===null?$=Y:V.sibling=Y,V=Y);return e&&W.forEach(function(te){return r(x,te)}),Hr&&xd(x,K),$}function M(x,P,D,F){if(typeof D=="object"&&D!==null&&D.type===xp&&D.key===null&&(D=D.props.children),typeof D=="object"&&D!==null){switch(D.$$typeof){case NE:e:{for(var $=D.key,V=P;V!==null;){if(V.key===$){if($=D.type,$===xp){if(V.tag===7){o(x,V.sibling),P=c(V,D.props.children),P.return=x,x=P;break e}}else if(V.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===bu&&R3($)===V.type){o(x,V.sibling),P=c(V,D.props),P.ref=z0(x,V,D),P.return=x,x=P;break e}o(x,V);break}else r(x,V);V=V.sibling}D.type===xp?(P=$d(D.props.children,x.mode,F,D.key),P.return=x,x=P):(F=A_(D.type,D.key,D.props,null,x.mode,F),F.ref=z0(x,P,D),F.return=x,x=F)}return f(x);case Op:e:{for(V=D.key;P!==null;){if(P.key===V)if(P.tag===4&&P.stateNode.containerInfo===D.containerInfo&&P.stateNode.implementation===D.implementation){o(x,P.sibling),P=c(P,D.children||[]),P.return=x,x=P;break e}else{o(x,P);break}else r(x,P);P=P.sibling}P=b1(D,x.mode,F),P.return=x,x=P}return f(x);case bu:return V=D._init,M(x,P,V(D._payload),F)}if(im(D))return A(x,P,D,F);if(V0(D))return O(x,P,D,F);$E(x,D)}return typeof D=="string"&&D!==""||typeof D=="number"?(D=""+D,P!==null&&P.tag===6?(o(x,P.sibling),P=c(P,D),P.return=x,x=P):(o(x,P),P=C1(D,x.mode,F),P.return=x,x=P),f(x)):o(x,P)}return M}var tf=qj(!0),Xj=qj(!1),ug={},Fc=Ku(ug),Bm=Ku(ug),jm=Ku(ug);function Fd(e){if(e===ug)throw Error(Ye(174));return e}function kO(e,r){switch(Ir(jm,r),Ir(Bm,e),Ir(Fc,ug),e=r.nodeType,e){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:cI(null,"");break;default:e=e===8?r.parentNode:r,r=e.namespaceURI||null,e=e.tagName,r=cI(r,e)}Nr(Fc),Ir(Fc,r)}function nf(){Nr(Fc),Nr(Bm),Nr(jm)}function Jj(e){Fd(jm.current);var r=Fd(Fc.current),o=cI(r,e.type);r!==o&&(Ir(Bm,e),Ir(Fc,o))}function LO(e){Bm.current===e&&(Nr(Fc),Nr(Bm))}var Yr=Ku(0);function ry(e){for(var r=e;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if(r.flags&128)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var g1=[];function MO(){for(var e=0;e<g1.length;e++)g1[e]._workInProgressVersionPrimary=null;g1.length=0}var b_=xl.ReactCurrentDispatcher,v1=xl.ReactCurrentBatchConfig,Jd=0,Xr=null,ki=null,zi=null,iy=!1,fm=!1,Vm=0,xoe=0;function So(){throw Error(Ye(321))}function FO(e,r){if(r===null)return!1;for(var o=0;o<r.length&&o<e.length;o++)if(!tc(e[o],r[o]))return!1;return!0}function UO(e,r,o,s,c,d){if(Jd=d,Xr=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,b_.current=e===null||e.memoizedState===null?koe:Loe,e=o(s,c),fm){d=0;do{if(fm=!1,Vm=0,25<=d)throw Error(Ye(301));d+=1,zi=ki=null,r.updateQueue=null,b_.current=Moe,e=o(s,c)}while(fm)}if(b_.current=oy,r=ki!==null&&ki.next!==null,Jd=0,zi=ki=Xr=null,iy=!1,r)throw Error(Ye(300));return e}function BO(){var e=Vm!==0;return Vm=0,e}function Pc(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zi===null?Xr.memoizedState=zi=e:zi=zi.next=e,zi}function ys(){if(ki===null){var e=Xr.alternate;e=e!==null?e.memoizedState:null}else e=ki.next;var r=zi===null?Xr.memoizedState:zi.next;if(r!==null)zi=r,ki=e;else{if(e===null)throw Error(Ye(310));ki=e,e={memoizedState:ki.memoizedState,baseState:ki.baseState,baseQueue:ki.baseQueue,queue:ki.queue,next:null},zi===null?Xr.memoizedState=zi=e:zi=zi.next=e}return zi}function $m(e,r){return typeof r=="function"?r(e):r}function E1(e){var r=ys(),o=r.queue;if(o===null)throw Error(Ye(311));o.lastRenderedReducer=e;var s=ki,c=s.baseQueue,d=o.pending;if(d!==null){if(c!==null){var f=c.next;c.next=d.next,d.next=f}s.baseQueue=c=d,o.pending=null}if(c!==null){d=c.next,s=s.baseState;var m=f=null,g=null,_=d;do{var S=_.lane;if((Jd&S)===S)g!==null&&(g=g.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),s=_.hasEagerState?_.eagerState:e(s,_.action);else{var T={lane:S,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};g===null?(m=g=T,f=s):g=g.next=T,Xr.lanes|=S,Qd|=S}_=_.next}while(_!==null&&_!==d);g===null?f=s:g.next=m,tc(s,r.memoizedState)||(ca=!0),r.memoizedState=s,r.baseState=f,r.baseQueue=g,o.lastRenderedState=s}if(e=o.interleaved,e!==null){c=e;do d=c.lane,Xr.lanes|=d,Qd|=d,c=c.next;while(c!==e)}else c===null&&(o.lanes=0);return[r.memoizedState,o.dispatch]}function _1(e){var r=ys(),o=r.queue;if(o===null)throw Error(Ye(311));o.lastRenderedReducer=e;var s=o.dispatch,c=o.pending,d=r.memoizedState;if(c!==null){o.pending=null;var f=c=c.next;do d=e(d,f.action),f=f.next;while(f!==c);tc(d,r.memoizedState)||(ca=!0),r.memoizedState=d,r.baseQueue===null&&(r.baseState=d),o.lastRenderedState=d}return[d,s]}function Qj(){}function Zj(e,r){var o=Xr,s=ys(),c=r(),d=!tc(s.memoizedState,c);if(d&&(s.memoizedState=c,ca=!0),s=s.queue,jO(nV.bind(null,o,s,e),[e]),s.getSnapshot!==r||d||zi!==null&&zi.memoizedState.tag&1){if(o.flags|=2048,Hm(9,tV.bind(null,o,s,c,r),void 0,null),Ki===null)throw Error(Ye(349));Jd&30||eV(o,r,c)}return c}function eV(e,r,o){e.flags|=16384,e={getSnapshot:r,value:o},r=Xr.updateQueue,r===null?(r={lastEffect:null,stores:null},Xr.updateQueue=r,r.stores=[e]):(o=r.stores,o===null?r.stores=[e]:o.push(e))}function tV(e,r,o,s){r.value=o,r.getSnapshot=s,rV(r)&&iV(e)}function nV(e,r,o){return o(function(){rV(r)&&iV(e)})}function rV(e){var r=e.getSnapshot;e=e.value;try{var o=r();return!tc(e,o)}catch{return!0}}function iV(e){var r=Cl(e,1);r!==null&&Qs(r,e,1,-1)}function w3(e){var r=Pc();return typeof e=="function"&&(e=e()),r.memoizedState=r.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$m,lastRenderedState:e},r.queue=e,e=e.dispatch=Doe.bind(null,Xr,e),[r.memoizedState,e]}function Hm(e,r,o,s){return e={tag:e,create:r,destroy:o,deps:s,next:null},r=Xr.updateQueue,r===null?(r={lastEffect:null,stores:null},Xr.updateQueue=r,r.lastEffect=e.next=e):(o=r.lastEffect,o===null?r.lastEffect=e.next=e:(s=o.next,o.next=e,e.next=s,r.lastEffect=e)),e}function oV(){return ys().memoizedState}function T_(e,r,o,s){var c=Pc();Xr.flags|=e,c.memoizedState=Hm(1|r,o,void 0,s===void 0?null:s)}function tS(e,r,o,s){var c=ys();s=s===void 0?null:s;var d=void 0;if(ki!==null){var f=ki.memoizedState;if(d=f.destroy,s!==null&&FO(s,f.deps)){c.memoizedState=Hm(r,o,d,s);return}}Xr.flags|=e,c.memoizedState=Hm(1|r,o,d,s)}function I3(e,r){return T_(8390656,8,e,r)}function jO(e,r){return tS(2048,8,e,r)}function aV(e,r){return tS(4,2,e,r)}function sV(e,r){return tS(4,4,e,r)}function cV(e,r){if(typeof r=="function")return e=e(),r(e),function(){r(null)};if(r!=null)return e=e(),r.current=e,function(){r.current=null}}function lV(e,r,o){return o=o!=null?o.concat([e]):null,tS(4,4,cV.bind(null,r,e),o)}function VO(){}function uV(e,r){var o=ys();r=r===void 0?null:r;var s=o.memoizedState;return s!==null&&r!==null&&FO(r,s[1])?s[0]:(o.memoizedState=[e,r],e)}function dV(e,r){var o=ys();r=r===void 0?null:r;var s=o.memoizedState;return s!==null&&r!==null&&FO(r,s[1])?s[0]:(e=e(),o.memoizedState=[e,r],e)}function hV(e,r,o){return Jd&21?(tc(o,r)||(o=mj(),Xr.lanes|=o,Qd|=o,e.baseState=!0),r):(e.baseState&&(e.baseState=!1,ca=!0),e.memoizedState=o)}function Noe(e,r){var o=ir;ir=o!==0&&4>o?o:4,e(!0);var s=v1.transition;v1.transition={};try{e(!1),r()}finally{ir=o,v1.transition=s}}function pV(){return ys().memoizedState}function Poe(e,r,o){var s=Uu(e);if(o={lane:s,action:o,hasEagerState:!1,eagerState:null,next:null},fV(e))mV(r,o);else if(o=Gj(e,r,o,s),o!==null){var c=jo();Qs(o,e,s,c),gV(o,r,s)}}function Doe(e,r,o){var s=Uu(e),c={lane:s,action:o,hasEagerState:!1,eagerState:null,next:null};if(fV(e))mV(r,c);else{var d=e.alternate;if(e.lanes===0&&(d===null||d.lanes===0)&&(d=r.lastRenderedReducer,d!==null))try{var f=r.lastRenderedState,m=d(f,o);if(c.hasEagerState=!0,c.eagerState=m,tc(m,f)){var g=r.interleaved;g===null?(c.next=c,PO(r)):(c.next=g.next,g.next=c),r.interleaved=c;return}}catch{}finally{}o=Gj(e,r,c,s),o!==null&&(c=jo(),Qs(o,e,s,c),gV(o,r,s))}}function fV(e){var r=e.alternate;return e===Xr||r!==null&&r===Xr}function mV(e,r){fm=iy=!0;var o=e.pending;o===null?r.next=r:(r.next=o.next,o.next=r),e.pending=r}function gV(e,r,o){if(o&4194240){var s=r.lanes;s&=e.pendingLanes,o|=s,r.lanes=o,EO(e,o)}}var oy={readContext:_s,useCallback:So,useContext:So,useEffect:So,useImperativeHandle:So,useInsertionEffect:So,useLayoutEffect:So,useMemo:So,useReducer:So,useRef:So,useState:So,useDebugValue:So,useDeferredValue:So,useTransition:So,useMutableSource:So,useSyncExternalStore:So,useId:So,unstable_isNewReconciler:!1},koe={readContext:_s,useCallback:function(e,r){return Pc().memoizedState=[e,r===void 0?null:r],e},useContext:_s,useEffect:I3,useImperativeHandle:function(e,r,o){return o=o!=null?o.concat([e]):null,T_(4194308,4,cV.bind(null,r,e),o)},useLayoutEffect:function(e,r){return T_(4194308,4,e,r)},useInsertionEffect:function(e,r){return T_(4,2,e,r)},useMemo:function(e,r){var o=Pc();return r=r===void 0?null:r,e=e(),o.memoizedState=[e,r],e},useReducer:function(e,r,o){var s=Pc();return r=o!==void 0?o(r):r,s.memoizedState=s.baseState=r,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},s.queue=e,e=e.dispatch=Poe.bind(null,Xr,e),[s.memoizedState,e]},useRef:function(e){var r=Pc();return e={current:e},r.memoizedState=e},useState:w3,useDebugValue:VO,useDeferredValue:function(e){return Pc().memoizedState=e},useTransition:function(){var e=w3(!1),r=e[0];return e=Noe.bind(null,e[1]),Pc().memoizedState=e,[r,e]},useMutableSource:function(){},useSyncExternalStore:function(e,r,o){var s=Xr,c=Pc();if(Hr){if(o===void 0)throw Error(Ye(407));o=o()}else{if(o=r(),Ki===null)throw Error(Ye(349));Jd&30||eV(s,r,o)}c.memoizedState=o;var d={value:o,getSnapshot:r};return c.queue=d,I3(nV.bind(null,s,d,e),[e]),s.flags|=2048,Hm(9,tV.bind(null,s,d,o,r),void 0,null),o},useId:function(){var e=Pc(),r=Ki.identifierPrefix;if(Hr){var o=ml,s=fl;o=(s&~(1<<32-Js(s)-1)).toString(32)+o,r=":"+r+"R"+o,o=Vm++,0<o&&(r+="H"+o.toString(32)),r+=":"}else o=xoe++,r=":"+r+"r"+o.toString(32)+":";return e.memoizedState=r},unstable_isNewReconciler:!1},Loe={readContext:_s,useCallback:uV,useContext:_s,useEffect:jO,useImperativeHandle:lV,useInsertionEffect:aV,useLayoutEffect:sV,useMemo:dV,useReducer:E1,useRef:oV,useState:function(){return E1($m)},useDebugValue:VO,useDeferredValue:function(e){var r=ys();return hV(r,ki.memoizedState,e)},useTransition:function(){var e=E1($m)[0],r=ys().memoizedState;return[e,r]},useMutableSource:Qj,useSyncExternalStore:Zj,useId:pV,unstable_isNewReconciler:!1},Moe={readContext:_s,useCallback:uV,useContext:_s,useEffect:jO,useImperativeHandle:lV,useInsertionEffect:aV,useLayoutEffect:sV,useMemo:dV,useReducer:_1,useRef:oV,useState:function(){return _1($m)},useDebugValue:VO,useDeferredValue:function(e){var r=ys();return ki===null?r.memoizedState=e:hV(r,ki.memoizedState,e)},useTransition:function(){var e=_1($m)[0],r=ys().memoizedState;return[e,r]},useMutableSource:Qj,useSyncExternalStore:Zj,useId:pV,unstable_isNewReconciler:!1};function rf(e,r){try{var o="",s=r;do o+=uie(s),s=s.return;while(s);var c=o}catch(d){c=`
Error generating stack: `+d.message+`
`+d.stack}return{value:e,source:r,stack:c,digest:null}}function y1(e,r,o){return{value:e,source:null,stack:o??null,digest:r??null}}function NI(e,r){try{console.error(r.value)}catch(o){setTimeout(function(){throw o})}}var Foe=typeof WeakMap=="function"?WeakMap:Map;function vV(e,r,o){o=gl(-1,o),o.tag=3,o.payload={element:null};var s=r.value;return o.callback=function(){sy||(sy=!0,VI=s),NI(e,r)},o}function EV(e,r,o){o=gl(-1,o),o.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var c=r.value;o.payload=function(){return s(c)},o.callback=function(){NI(e,r)}}var d=e.stateNode;return d!==null&&typeof d.componentDidCatch=="function"&&(o.callback=function(){NI(e,r),typeof s!="function"&&(Fu===null?Fu=new Set([this]):Fu.add(this));var f=r.stack;this.componentDidCatch(r.value,{componentStack:f!==null?f:""})}),o}function A3(e,r,o){var s=e.pingCache;if(s===null){s=e.pingCache=new Foe;var c=new Set;s.set(r,c)}else c=s.get(r),c===void 0&&(c=new Set,s.set(r,c));c.has(o)||(c.add(o),e=Joe.bind(null,e,r,o),r.then(e,e))}function O3(e){do{var r;if((r=e.tag===13)&&(r=e.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return e;e=e.return}while(e!==null);return null}function x3(e,r,o,s,c){return e.mode&1?(e.flags|=65536,e.lanes=c,e):(e===r?e.flags|=65536:(e.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(r=gl(-1,1),r.tag=2,Mu(o,r,1))),o.lanes|=1),e)}var Uoe=xl.ReactCurrentOwner,ca=!1;function Uo(e,r,o,s){r.child=e===null?Xj(r,null,o,s):tf(r,e.child,o,s)}function N3(e,r,o,s,c){o=o.render;var d=r.ref;return qp(r,c),s=UO(e,r,o,s,d,c),o=BO(),e!==null&&!ca?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~c,bl(e,r,c)):(Hr&&o&&wO(r),r.flags|=1,Uo(e,r,s,c),r.child)}function P3(e,r,o,s,c){if(e===null){var d=o.type;return typeof d=="function"&&!qO(d)&&d.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(r.tag=15,r.type=d,_V(e,r,d,s,c)):(e=A_(o.type,null,s,r,r.mode,c),e.ref=r.ref,e.return=r,r.child=e)}if(d=e.child,!(e.lanes&c)){var f=d.memoizedProps;if(o=o.compare,o=o!==null?o:Lm,o(f,s)&&e.ref===r.ref)return bl(e,r,c)}return r.flags|=1,e=Bu(d,s),e.ref=r.ref,e.return=r,r.child=e}function _V(e,r,o,s,c){if(e!==null){var d=e.memoizedProps;if(Lm(d,s)&&e.ref===r.ref)if(ca=!1,r.pendingProps=s=d,(e.lanes&c)!==0)e.flags&131072&&(ca=!0);else return r.lanes=e.lanes,bl(e,r,c)}return PI(e,r,o,s,c)}function yV(e,r,o){var s=r.pendingProps,c=s.children,d=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(r.mode&1))r.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ir(jp,Fa),Fa|=o;else{if(!(o&1073741824))return e=d!==null?d.baseLanes|o:o,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:e,cachePool:null,transitions:null},r.updateQueue=null,Ir(jp,Fa),Fa|=e,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=d!==null?d.baseLanes:o,Ir(jp,Fa),Fa|=s}else d!==null?(s=d.baseLanes|o,r.memoizedState=null):s=o,Ir(jp,Fa),Fa|=s;return Uo(e,r,c,o),r.child}function SV(e,r){var o=r.ref;(e===null&&o!==null||e!==null&&e.ref!==o)&&(r.flags|=512,r.flags|=2097152)}function PI(e,r,o,s,c){var d=da(o)?qd:wo.current;return d=Zp(r,d),qp(r,c),o=UO(e,r,o,s,d,c),s=BO(),e!==null&&!ca?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~c,bl(e,r,c)):(Hr&&s&&wO(r),r.flags|=1,Uo(e,r,o,c),r.child)}function D3(e,r,o,s,c){if(da(o)){var d=!0;J_(r)}else d=!1;if(qp(r,c),r.stateNode===null)R_(e,r),Yj(r,o,s),xI(r,o,s,c),s=!0;else if(e===null){var f=r.stateNode,m=r.memoizedProps;f.props=m;var g=f.context,_=o.contextType;typeof _=="object"&&_!==null?_=_s(_):(_=da(o)?qd:wo.current,_=Zp(r,_));var S=o.getDerivedStateFromProps,T=typeof S=="function"||typeof f.getSnapshotBeforeUpdate=="function";T||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(m!==s||g!==_)&&T3(r,f,s,_),Tu=!1;var R=r.memoizedState;f.state=R,ny(r,s,f,c),g=r.memoizedState,m!==s||R!==g||ua.current||Tu?(typeof S=="function"&&(OI(r,o,S,s),g=r.memoizedState),(m=Tu||b3(r,o,m,s,R,g,_))?(T||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(r.flags|=4194308)):(typeof f.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=s,r.memoizedState=g),f.props=s,f.state=g,f.context=_,s=m):(typeof f.componentDidMount=="function"&&(r.flags|=4194308),s=!1)}else{f=r.stateNode,zj(e,r),m=r.memoizedProps,_=r.type===r.elementType?m:Hs(r.type,m),f.props=_,T=r.pendingProps,R=f.context,g=o.contextType,typeof g=="object"&&g!==null?g=_s(g):(g=da(o)?qd:wo.current,g=Zp(r,g));var N=o.getDerivedStateFromProps;(S=typeof N=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(m!==T||R!==g)&&T3(r,f,s,g),Tu=!1,R=r.memoizedState,f.state=R,ny(r,s,f,c);var A=r.memoizedState;m!==T||R!==A||ua.current||Tu?(typeof N=="function"&&(OI(r,o,N,s),A=r.memoizedState),(_=Tu||b3(r,o,_,s,R,A,g)||!1)?(S||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(s,A,g),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(s,A,g)),typeof f.componentDidUpdate=="function"&&(r.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof f.componentDidUpdate!="function"||m===e.memoizedProps&&R===e.memoizedState||(r.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||m===e.memoizedProps&&R===e.memoizedState||(r.flags|=1024),r.memoizedProps=s,r.memoizedState=A),f.props=s,f.state=A,f.context=g,s=_):(typeof f.componentDidUpdate!="function"||m===e.memoizedProps&&R===e.memoizedState||(r.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||m===e.memoizedProps&&R===e.memoizedState||(r.flags|=1024),s=!1)}return DI(e,r,o,s,d,c)}function DI(e,r,o,s,c,d){SV(e,r);var f=(r.flags&128)!==0;if(!s&&!f)return c&&E3(r,o,!1),bl(e,r,d);s=r.stateNode,Uoe.current=r;var m=f&&typeof o.getDerivedStateFromError!="function"?null:s.render();return r.flags|=1,e!==null&&f?(r.child=tf(r,e.child,null,d),r.child=tf(r,null,m,d)):Uo(e,r,m,d),r.memoizedState=s.state,c&&E3(r,o,!0),r.child}function CV(e){var r=e.stateNode;r.pendingContext?v3(e,r.pendingContext,r.pendingContext!==r.context):r.context&&v3(e,r.context,!1),kO(e,r.containerInfo)}function k3(e,r,o,s,c){return ef(),AO(c),r.flags|=256,Uo(e,r,o,s),r.child}var kI={dehydrated:null,treeContext:null,retryLane:0};function LI(e){return{baseLanes:e,cachePool:null,transitions:null}}function bV(e,r,o){var s=r.pendingProps,c=Yr.current,d=!1,f=(r.flags&128)!==0,m;if((m=f)||(m=e!==null&&e.memoizedState===null?!1:(c&2)!==0),m?(d=!0,r.flags&=-129):(e===null||e.memoizedState!==null)&&(c|=1),Ir(Yr,c&1),e===null)return II(r),e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(r.mode&1?e.data==="$!"?r.lanes=8:r.lanes=1073741824:r.lanes=1,null):(f=s.children,e=s.fallback,d?(s=r.mode,d=r.child,f={mode:"hidden",children:f},!(s&1)&&d!==null?(d.childLanes=0,d.pendingProps=f):d=iS(f,s,0,null),e=$d(e,s,o,null),d.return=r,e.return=r,d.sibling=e,r.child=d,r.child.memoizedState=LI(o),r.memoizedState=kI,e):$O(r,f));if(c=e.memoizedState,c!==null&&(m=c.dehydrated,m!==null))return Boe(e,r,f,s,m,c,o);if(d){d=s.fallback,f=r.mode,c=e.child,m=c.sibling;var g={mode:"hidden",children:s.children};return!(f&1)&&r.child!==c?(s=r.child,s.childLanes=0,s.pendingProps=g,r.deletions=null):(s=Bu(c,g),s.subtreeFlags=c.subtreeFlags&14680064),m!==null?d=Bu(m,d):(d=$d(d,f,o,null),d.flags|=2),d.return=r,s.return=r,s.sibling=d,r.child=s,s=d,d=r.child,f=e.child.memoizedState,f=f===null?LI(o):{baseLanes:f.baseLanes|o,cachePool:null,transitions:f.transitions},d.memoizedState=f,d.childLanes=e.childLanes&~o,r.memoizedState=kI,s}return d=e.child,e=d.sibling,s=Bu(d,{mode:"visible",children:s.children}),!(r.mode&1)&&(s.lanes=o),s.return=r,s.sibling=null,e!==null&&(o=r.deletions,o===null?(r.deletions=[e],r.flags|=16):o.push(e)),r.child=s,r.memoizedState=null,s}function $O(e,r){return r=iS({mode:"visible",children:r},e.mode,0,null),r.return=e,e.child=r}function HE(e,r,o,s){return s!==null&&AO(s),tf(r,e.child,null,o),e=$O(r,r.pendingProps.children),e.flags|=2,r.memoizedState=null,e}function Boe(e,r,o,s,c,d,f){if(o)return r.flags&256?(r.flags&=-257,s=y1(Error(Ye(422))),HE(e,r,f,s)):r.memoizedState!==null?(r.child=e.child,r.flags|=128,null):(d=s.fallback,c=r.mode,s=iS({mode:"visible",children:s.children},c,0,null),d=$d(d,c,f,null),d.flags|=2,s.return=r,d.return=r,s.sibling=d,r.child=s,r.mode&1&&tf(r,e.child,null,f),r.child.memoizedState=LI(f),r.memoizedState=kI,d);if(!(r.mode&1))return HE(e,r,f,null);if(c.data==="$!"){if(s=c.nextSibling&&c.nextSibling.dataset,s)var m=s.dgst;return s=m,d=Error(Ye(419)),s=y1(d,s,void 0),HE(e,r,f,s)}if(m=(f&e.childLanes)!==0,ca||m){if(s=Ki,s!==null){switch(f&-f){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=c&(s.suspendedLanes|f)?0:c,c!==0&&c!==d.retryLane&&(d.retryLane=c,Cl(e,c),Qs(s,e,c,-1))}return YO(),s=y1(Error(Ye(421))),HE(e,r,f,s)}return c.data==="$?"?(r.flags|=128,r.child=e.child,r=Qoe.bind(null,e),c._reactRetry=r,null):(e=d.treeContext,Ua=Lu(c.nextSibling),ja=r,Hr=!0,Ys=null,e!==null&&(fs[ms++]=fl,fs[ms++]=ml,fs[ms++]=Xd,fl=e.id,ml=e.overflow,Xd=r),r=$O(r,s.children),r.flags|=4096,r)}function L3(e,r,o){e.lanes|=r;var s=e.alternate;s!==null&&(s.lanes|=r),AI(e.return,r,o)}function S1(e,r,o,s,c){var d=e.memoizedState;d===null?e.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:s,tail:o,tailMode:c}:(d.isBackwards=r,d.rendering=null,d.renderingStartTime=0,d.last=s,d.tail=o,d.tailMode=c)}function TV(e,r,o){var s=r.pendingProps,c=s.revealOrder,d=s.tail;if(Uo(e,r,s.children,o),s=Yr.current,s&2)s=s&1|2,r.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=r.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&L3(e,o,r);else if(e.tag===19)L3(e,o,r);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break e;for(;e.sibling===null;){if(e.return===null||e.return===r)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(Ir(Yr,s),!(r.mode&1))r.memoizedState=null;else switch(c){case"forwards":for(o=r.child,c=null;o!==null;)e=o.alternate,e!==null&&ry(e)===null&&(c=o),o=o.sibling;o=c,o===null?(c=r.child,r.child=null):(c=o.sibling,o.sibling=null),S1(r,!1,c,o,d);break;case"backwards":for(o=null,c=r.child,r.child=null;c!==null;){if(e=c.alternate,e!==null&&ry(e)===null){r.child=c;break}e=c.sibling,c.sibling=o,o=c,c=e}S1(r,!0,o,null,d);break;case"together":S1(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function R_(e,r){!(r.mode&1)&&e!==null&&(e.alternate=null,r.alternate=null,r.flags|=2)}function bl(e,r,o){if(e!==null&&(r.dependencies=e.dependencies),Qd|=r.lanes,!(o&r.childLanes))return null;if(e!==null&&r.child!==e.child)throw Error(Ye(153));if(r.child!==null){for(e=r.child,o=Bu(e,e.pendingProps),r.child=o,o.return=r;e.sibling!==null;)e=e.sibling,o=o.sibling=Bu(e,e.pendingProps),o.return=r;o.sibling=null}return r.child}function joe(e,r,o){switch(r.tag){case 3:CV(r),ef();break;case 5:Jj(r);break;case 1:da(r.type)&&J_(r);break;case 4:kO(r,r.stateNode.containerInfo);break;case 10:var s=r.type._context,c=r.memoizedProps.value;Ir(ey,s._currentValue),s._currentValue=c;break;case 13:if(s=r.memoizedState,s!==null)return s.dehydrated!==null?(Ir(Yr,Yr.current&1),r.flags|=128,null):o&r.child.childLanes?bV(e,r,o):(Ir(Yr,Yr.current&1),e=bl(e,r,o),e!==null?e.sibling:null);Ir(Yr,Yr.current&1);break;case 19:if(s=(o&r.childLanes)!==0,e.flags&128){if(s)return TV(e,r,o);r.flags|=128}if(c=r.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),Ir(Yr,Yr.current),s)break;return null;case 22:case 23:return r.lanes=0,yV(e,r,o)}return bl(e,r,o)}var RV,MI,wV,IV;RV=function(e,r){for(var o=r.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};MI=function(){};wV=function(e,r,o,s){var c=e.memoizedProps;if(c!==s){e=r.stateNode,Fd(Fc.current);var d=null;switch(o){case"input":c=iI(e,c),s=iI(e,s),d=[];break;case"select":c=Jr({},c,{value:void 0}),s=Jr({},s,{value:void 0}),d=[];break;case"textarea":c=sI(e,c),s=sI(e,s),d=[];break;default:typeof c.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=q_)}lI(o,s);var f;o=null;for(_ in c)if(!s.hasOwnProperty(_)&&c.hasOwnProperty(_)&&c[_]!=null)if(_==="style"){var m=c[_];for(f in m)m.hasOwnProperty(f)&&(o||(o={}),o[f]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(Am.hasOwnProperty(_)?d||(d=[]):(d=d||[]).push(_,null));for(_ in s){var g=s[_];if(m=c!=null?c[_]:void 0,s.hasOwnProperty(_)&&g!==m&&(g!=null||m!=null))if(_==="style")if(m){for(f in m)!m.hasOwnProperty(f)||g&&g.hasOwnProperty(f)||(o||(o={}),o[f]="");for(f in g)g.hasOwnProperty(f)&&m[f]!==g[f]&&(o||(o={}),o[f]=g[f])}else o||(d||(d=[]),d.push(_,o)),o=g;else _==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,m=m?m.__html:void 0,g!=null&&m!==g&&(d=d||[]).push(_,g)):_==="children"?typeof g!="string"&&typeof g!="number"||(d=d||[]).push(_,""+g):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&(Am.hasOwnProperty(_)?(g!=null&&_==="onScroll"&&xr("scroll",e),d||m===g||(d=[])):(d=d||[]).push(_,g))}o&&(d=d||[]).push("style",o);var _=d;(r.updateQueue=_)&&(r.flags|=4)}};IV=function(e,r,o,s){o!==s&&(r.flags|=4)};function K0(e,r){if(!Hr)switch(e.tailMode){case"hidden":r=e.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var s=null;o!==null;)o.alternate!==null&&(s=o),o=o.sibling;s===null?r||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Co(e){var r=e.alternate!==null&&e.alternate.child===e.child,o=0,s=0;if(r)for(var c=e.child;c!==null;)o|=c.lanes|c.childLanes,s|=c.subtreeFlags&14680064,s|=c.flags&14680064,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)o|=c.lanes|c.childLanes,s|=c.subtreeFlags,s|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=s,e.childLanes=o,r}function Voe(e,r,o){var s=r.pendingProps;switch(IO(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Co(r),null;case 1:return da(r.type)&&X_(),Co(r),null;case 3:return s=r.stateNode,nf(),Nr(ua),Nr(wo),MO(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(VE(r)?r.flags|=4:e===null||e.memoizedState.isDehydrated&&!(r.flags&256)||(r.flags|=1024,Ys!==null&&(WI(Ys),Ys=null))),MI(e,r),Co(r),null;case 5:LO(r);var c=Fd(jm.current);if(o=r.type,e!==null&&r.stateNode!=null)wV(e,r,o,s,c),e.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!s){if(r.stateNode===null)throw Error(Ye(166));return Co(r),null}if(e=Fd(Fc.current),VE(r)){s=r.stateNode,o=r.type;var d=r.memoizedProps;switch(s[Lc]=r,s[Um]=d,e=(r.mode&1)!==0,o){case"dialog":xr("cancel",s),xr("close",s);break;case"iframe":case"object":case"embed":xr("load",s);break;case"video":case"audio":for(c=0;c<am.length;c++)xr(am[c],s);break;case"source":xr("error",s);break;case"img":case"image":case"link":xr("error",s),xr("load",s);break;case"details":xr("toggle",s);break;case"input":W4(s,d),xr("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!d.multiple},xr("invalid",s);break;case"textarea":z4(s,d),xr("invalid",s)}lI(o,d),c=null;for(var f in d)if(d.hasOwnProperty(f)){var m=d[f];f==="children"?typeof m=="string"?s.textContent!==m&&(d.suppressHydrationWarning!==!0&&jE(s.textContent,m,e),c=["children",m]):typeof m=="number"&&s.textContent!==""+m&&(d.suppressHydrationWarning!==!0&&jE(s.textContent,m,e),c=["children",""+m]):Am.hasOwnProperty(f)&&m!=null&&f==="onScroll"&&xr("scroll",s)}switch(o){case"input":PE(s),G4(s,d,!0);break;case"textarea":PE(s),K4(s);break;case"select":case"option":break;default:typeof d.onClick=="function"&&(s.onclick=q_)}s=c,r.updateQueue=s,s!==null&&(r.flags|=4)}else{f=c.nodeType===9?c:c.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ej(o)),e==="http://www.w3.org/1999/xhtml"?o==="script"?(e=f.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=f.createElement(o,{is:s.is}):(e=f.createElement(o),o==="select"&&(f=e,s.multiple?f.multiple=!0:s.size&&(f.size=s.size))):e=f.createElementNS(e,o),e[Lc]=r,e[Um]=s,RV(e,r,!1,!1),r.stateNode=e;e:{switch(f=uI(o,s),o){case"dialog":xr("cancel",e),xr("close",e),c=s;break;case"iframe":case"object":case"embed":xr("load",e),c=s;break;case"video":case"audio":for(c=0;c<am.length;c++)xr(am[c],e);c=s;break;case"source":xr("error",e),c=s;break;case"img":case"image":case"link":xr("error",e),xr("load",e),c=s;break;case"details":xr("toggle",e),c=s;break;case"input":W4(e,s),c=iI(e,s),xr("invalid",e);break;case"option":c=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},c=Jr({},s,{value:void 0}),xr("invalid",e);break;case"textarea":z4(e,s),c=sI(e,s),xr("invalid",e);break;default:c=s}lI(o,c),m=c;for(d in m)if(m.hasOwnProperty(d)){var g=m[d];d==="style"?rj(e,g):d==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,g!=null&&tj(e,g)):d==="children"?typeof g=="string"?(o!=="textarea"||g!=="")&&Om(e,g):typeof g=="number"&&Om(e,""+g):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Am.hasOwnProperty(d)?g!=null&&d==="onScroll"&&xr("scroll",e):g!=null&&hO(e,d,g,f))}switch(o){case"input":PE(e),G4(e,s,!1);break;case"textarea":PE(e),K4(e);break;case"option":s.value!=null&&e.setAttribute("value",""+ju(s.value));break;case"select":e.multiple=!!s.multiple,d=s.value,d!=null?Gp(e,!!s.multiple,d,!1):s.defaultValue!=null&&Gp(e,!!s.multiple,s.defaultValue,!0);break;default:typeof c.onClick=="function"&&(e.onclick=q_)}switch(o){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return Co(r),null;case 6:if(e&&r.stateNode!=null)IV(e,r,e.memoizedProps,s);else{if(typeof s!="string"&&r.stateNode===null)throw Error(Ye(166));if(o=Fd(jm.current),Fd(Fc.current),VE(r)){if(s=r.stateNode,o=r.memoizedProps,s[Lc]=r,(d=s.nodeValue!==o)&&(e=ja,e!==null))switch(e.tag){case 3:jE(s.nodeValue,o,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&jE(s.nodeValue,o,(e.mode&1)!==0)}d&&(r.flags|=4)}else s=(o.nodeType===9?o:o.ownerDocument).createTextNode(s),s[Lc]=r,r.stateNode=s}return Co(r),null;case 13:if(Nr(Yr),s=r.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Hr&&Ua!==null&&r.mode&1&&!(r.flags&128))Wj(),ef(),r.flags|=98560,d=!1;else if(d=VE(r),s!==null&&s.dehydrated!==null){if(e===null){if(!d)throw Error(Ye(318));if(d=r.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(Ye(317));d[Lc]=r}else ef(),!(r.flags&128)&&(r.memoizedState=null),r.flags|=4;Co(r),d=!1}else Ys!==null&&(WI(Ys),Ys=null),d=!0;if(!d)return r.flags&65536?r:null}return r.flags&128?(r.lanes=o,r):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(r.child.flags|=8192,r.mode&1&&(e===null||Yr.current&1?Li===0&&(Li=3):YO())),r.updateQueue!==null&&(r.flags|=4),Co(r),null);case 4:return nf(),MI(e,r),e===null&&Mm(r.stateNode.containerInfo),Co(r),null;case 10:return NO(r.type._context),Co(r),null;case 17:return da(r.type)&&X_(),Co(r),null;case 19:if(Nr(Yr),d=r.memoizedState,d===null)return Co(r),null;if(s=(r.flags&128)!==0,f=d.rendering,f===null)if(s)K0(d,!1);else{if(Li!==0||e!==null&&e.flags&128)for(e=r.child;e!==null;){if(f=ry(e),f!==null){for(r.flags|=128,K0(d,!1),s=f.updateQueue,s!==null&&(r.updateQueue=s,r.flags|=4),r.subtreeFlags=0,s=o,o=r.child;o!==null;)d=o,e=s,d.flags&=14680066,f=d.alternate,f===null?(d.childLanes=0,d.lanes=e,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=f.childLanes,d.lanes=f.lanes,d.child=f.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=f.memoizedProps,d.memoizedState=f.memoizedState,d.updateQueue=f.updateQueue,d.type=f.type,e=f.dependencies,d.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),o=o.sibling;return Ir(Yr,Yr.current&1|2),r.child}e=e.sibling}d.tail!==null&&fi()>of&&(r.flags|=128,s=!0,K0(d,!1),r.lanes=4194304)}else{if(!s)if(e=ry(f),e!==null){if(r.flags|=128,s=!0,o=e.updateQueue,o!==null&&(r.updateQueue=o,r.flags|=4),K0(d,!0),d.tail===null&&d.tailMode==="hidden"&&!f.alternate&&!Hr)return Co(r),null}else 2*fi()-d.renderingStartTime>of&&o!==1073741824&&(r.flags|=128,s=!0,K0(d,!1),r.lanes=4194304);d.isBackwards?(f.sibling=r.child,r.child=f):(o=d.last,o!==null?o.sibling=f:r.child=f,d.last=f)}return d.tail!==null?(r=d.tail,d.rendering=r,d.tail=r.sibling,d.renderingStartTime=fi(),r.sibling=null,o=Yr.current,Ir(Yr,s?o&1|2:o&1),r):(Co(r),null);case 22:case 23:return KO(),s=r.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(r.flags|=8192),s&&r.mode&1?Fa&1073741824&&(Co(r),r.subtreeFlags&6&&(r.flags|=8192)):Co(r),null;case 24:return null;case 25:return null}throw Error(Ye(156,r.tag))}function $oe(e,r){switch(IO(r),r.tag){case 1:return da(r.type)&&X_(),e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 3:return nf(),Nr(ua),Nr(wo),MO(),e=r.flags,e&65536&&!(e&128)?(r.flags=e&-65537|128,r):null;case 5:return LO(r),null;case 13:if(Nr(Yr),e=r.memoizedState,e!==null&&e.dehydrated!==null){if(r.alternate===null)throw Error(Ye(340));ef()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 19:return Nr(Yr),null;case 4:return nf(),null;case 10:return NO(r.type._context),null;case 22:case 23:return KO(),null;case 24:return null;default:return null}}var WE=!1,Ro=!1,Hoe=typeof WeakSet=="function"?WeakSet:Set,mt=null;function Bp(e,r){var o=e.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(s){ei(e,r,s)}else o.current=null}function FI(e,r,o){try{o()}catch(s){ei(e,r,s)}}var M3=!1;function Woe(e,r){if(yI=z_,e=Nj(),RO(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var s=o.getSelection&&o.getSelection();if(s&&s.rangeCount!==0){o=s.anchorNode;var c=s.anchorOffset,d=s.focusNode;s=s.focusOffset;try{o.nodeType,d.nodeType}catch{o=null;break e}var f=0,m=-1,g=-1,_=0,S=0,T=e,R=null;t:for(;;){for(var N;T!==o||c!==0&&T.nodeType!==3||(m=f+c),T!==d||s!==0&&T.nodeType!==3||(g=f+s),T.nodeType===3&&(f+=T.nodeValue.length),(N=T.firstChild)!==null;)R=T,T=N;for(;;){if(T===e)break t;if(R===o&&++_===c&&(m=f),R===d&&++S===s&&(g=f),(N=T.nextSibling)!==null)break;T=R,R=T.parentNode}T=N}o=m===-1||g===-1?null:{start:m,end:g}}else o=null}o=o||{start:0,end:0}}else o=null;for(SI={focusedElem:e,selectionRange:o},z_=!1,mt=r;mt!==null;)if(r=mt,e=r.child,(r.subtreeFlags&1028)!==0&&e!==null)e.return=r,mt=e;else for(;mt!==null;){r=mt;try{var A=r.alternate;if(r.flags&1024)switch(r.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var O=A.memoizedProps,M=A.memoizedState,x=r.stateNode,P=x.getSnapshotBeforeUpdate(r.elementType===r.type?O:Hs(r.type,O),M);x.__reactInternalSnapshotBeforeUpdate=P}break;case 3:var D=r.stateNode.containerInfo;D.nodeType===1?D.textContent="":D.nodeType===9&&D.documentElement&&D.removeChild(D.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ye(163))}}catch(F){ei(r,r.return,F)}if(e=r.sibling,e!==null){e.return=r.return,mt=e;break}mt=r.return}return A=M3,M3=!1,A}function mm(e,r,o){var s=r.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var c=s=s.next;do{if((c.tag&e)===e){var d=c.destroy;c.destroy=void 0,d!==void 0&&FI(r,o,d)}c=c.next}while(c!==s)}}function nS(e,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var s=o.create;o.destroy=s()}o=o.next}while(o!==r)}}function UI(e){var r=e.ref;if(r!==null){var o=e.stateNode;switch(e.tag){case 5:e=o;break;default:e=o}typeof r=="function"?r(e):r.current=e}}function AV(e){var r=e.alternate;r!==null&&(e.alternate=null,AV(r)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(r=e.stateNode,r!==null&&(delete r[Lc],delete r[Um],delete r[TI],delete r[woe],delete r[Ioe])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function OV(e){return e.tag===5||e.tag===3||e.tag===4}function F3(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||OV(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function BI(e,r,o){var s=e.tag;if(s===5||s===6)e=e.stateNode,r?o.nodeType===8?o.parentNode.insertBefore(e,r):o.insertBefore(e,r):(o.nodeType===8?(r=o.parentNode,r.insertBefore(e,o)):(r=o,r.appendChild(e)),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=q_));else if(s!==4&&(e=e.child,e!==null))for(BI(e,r,o),e=e.sibling;e!==null;)BI(e,r,o),e=e.sibling}function jI(e,r,o){var s=e.tag;if(s===5||s===6)e=e.stateNode,r?o.insertBefore(e,r):o.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(jI(e,r,o),e=e.sibling;e!==null;)jI(e,r,o),e=e.sibling}var to=null,Ws=!1;function yu(e,r,o){for(o=o.child;o!==null;)xV(e,r,o),o=o.sibling}function xV(e,r,o){if(Mc&&typeof Mc.onCommitFiberUnmount=="function")try{Mc.onCommitFiberUnmount(Yy,o)}catch{}switch(o.tag){case 5:Ro||Bp(o,r);case 6:var s=to,c=Ws;to=null,yu(e,r,o),to=s,Ws=c,to!==null&&(Ws?(e=to,o=o.stateNode,e.nodeType===8?e.parentNode.removeChild(o):e.removeChild(o)):to.removeChild(o.stateNode));break;case 18:to!==null&&(Ws?(e=to,o=o.stateNode,e.nodeType===8?f1(e.parentNode,o):e.nodeType===1&&f1(e,o),Dm(e)):f1(to,o.stateNode));break;case 4:s=to,c=Ws,to=o.stateNode.containerInfo,Ws=!0,yu(e,r,o),to=s,Ws=c;break;case 0:case 11:case 14:case 15:if(!Ro&&(s=o.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){c=s=s.next;do{var d=c,f=d.destroy;d=d.tag,f!==void 0&&(d&2||d&4)&&FI(o,r,f),c=c.next}while(c!==s)}yu(e,r,o);break;case 1:if(!Ro&&(Bp(o,r),s=o.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=o.memoizedProps,s.state=o.memoizedState,s.componentWillUnmount()}catch(m){ei(o,r,m)}yu(e,r,o);break;case 21:yu(e,r,o);break;case 22:o.mode&1?(Ro=(s=Ro)||o.memoizedState!==null,yu(e,r,o),Ro=s):yu(e,r,o);break;default:yu(e,r,o)}}function U3(e){var r=e.updateQueue;if(r!==null){e.updateQueue=null;var o=e.stateNode;o===null&&(o=e.stateNode=new Hoe),r.forEach(function(s){var c=Zoe.bind(null,e,s);o.has(s)||(o.add(s),s.then(c,c))})}}function Vs(e,r){var o=r.deletions;if(o!==null)for(var s=0;s<o.length;s++){var c=o[s];try{var d=e,f=r,m=f;e:for(;m!==null;){switch(m.tag){case 5:to=m.stateNode,Ws=!1;break e;case 3:to=m.stateNode.containerInfo,Ws=!0;break e;case 4:to=m.stateNode.containerInfo,Ws=!0;break e}m=m.return}if(to===null)throw Error(Ye(160));xV(d,f,c),to=null,Ws=!1;var g=c.alternate;g!==null&&(g.return=null),c.return=null}catch(_){ei(c,r,_)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)NV(r,e),r=r.sibling}function NV(e,r){var o=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Vs(r,e),Nc(e),s&4){try{mm(3,e,e.return),nS(3,e)}catch(O){ei(e,e.return,O)}try{mm(5,e,e.return)}catch(O){ei(e,e.return,O)}}break;case 1:Vs(r,e),Nc(e),s&512&&o!==null&&Bp(o,o.return);break;case 5:if(Vs(r,e),Nc(e),s&512&&o!==null&&Bp(o,o.return),e.flags&32){var c=e.stateNode;try{Om(c,"")}catch(O){ei(e,e.return,O)}}if(s&4&&(c=e.stateNode,c!=null)){var d=e.memoizedProps,f=o!==null?o.memoizedProps:d,m=e.type,g=e.updateQueue;if(e.updateQueue=null,g!==null)try{m==="input"&&d.type==="radio"&&d.name!=null&&Q8(c,d),uI(m,f);var _=uI(m,d);for(f=0;f<g.length;f+=2){var S=g[f],T=g[f+1];S==="style"?rj(c,T):S==="dangerouslySetInnerHTML"?tj(c,T):S==="children"?Om(c,T):hO(c,S,T,_)}switch(m){case"input":oI(c,d);break;case"textarea":Z8(c,d);break;case"select":var R=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!d.multiple;var N=d.value;N!=null?Gp(c,!!d.multiple,N,!1):R!==!!d.multiple&&(d.defaultValue!=null?Gp(c,!!d.multiple,d.defaultValue,!0):Gp(c,!!d.multiple,d.multiple?[]:"",!1))}c[Um]=d}catch(O){ei(e,e.return,O)}}break;case 6:if(Vs(r,e),Nc(e),s&4){if(e.stateNode===null)throw Error(Ye(162));c=e.stateNode,d=e.memoizedProps;try{c.nodeValue=d}catch(O){ei(e,e.return,O)}}break;case 3:if(Vs(r,e),Nc(e),s&4&&o!==null&&o.memoizedState.isDehydrated)try{Dm(r.containerInfo)}catch(O){ei(e,e.return,O)}break;case 4:Vs(r,e),Nc(e);break;case 13:Vs(r,e),Nc(e),c=e.child,c.flags&8192&&(d=c.memoizedState!==null,c.stateNode.isHidden=d,!d||c.alternate!==null&&c.alternate.memoizedState!==null||(GO=fi())),s&4&&U3(e);break;case 22:if(S=o!==null&&o.memoizedState!==null,e.mode&1?(Ro=(_=Ro)||S,Vs(r,e),Ro=_):Vs(r,e),Nc(e),s&8192){if(_=e.memoizedState!==null,(e.stateNode.isHidden=_)&&!S&&e.mode&1)for(mt=e,S=e.child;S!==null;){for(T=mt=S;mt!==null;){switch(R=mt,N=R.child,R.tag){case 0:case 11:case 14:case 15:mm(4,R,R.return);break;case 1:Bp(R,R.return);var A=R.stateNode;if(typeof A.componentWillUnmount=="function"){s=R,o=R.return;try{r=s,A.props=r.memoizedProps,A.state=r.memoizedState,A.componentWillUnmount()}catch(O){ei(s,o,O)}}break;case 5:Bp(R,R.return);break;case 22:if(R.memoizedState!==null){j3(T);continue}}N!==null?(N.return=R,mt=N):j3(T)}S=S.sibling}e:for(S=null,T=e;;){if(T.tag===5){if(S===null){S=T;try{c=T.stateNode,_?(d=c.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none"):(m=T.stateNode,g=T.memoizedProps.style,f=g!=null&&g.hasOwnProperty("display")?g.display:null,m.style.display=nj("display",f))}catch(O){ei(e,e.return,O)}}}else if(T.tag===6){if(S===null)try{T.stateNode.nodeValue=_?"":T.memoizedProps}catch(O){ei(e,e.return,O)}}else if((T.tag!==22&&T.tag!==23||T.memoizedState===null||T===e)&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===e)break e;for(;T.sibling===null;){if(T.return===null||T.return===e)break e;S===T&&(S=null),T=T.return}S===T&&(S=null),T.sibling.return=T.return,T=T.sibling}}break;case 19:Vs(r,e),Nc(e),s&4&&U3(e);break;case 21:break;default:Vs(r,e),Nc(e)}}function Nc(e){var r=e.flags;if(r&2){try{e:{for(var o=e.return;o!==null;){if(OV(o)){var s=o;break e}o=o.return}throw Error(Ye(160))}switch(s.tag){case 5:var c=s.stateNode;s.flags&32&&(Om(c,""),s.flags&=-33);var d=F3(e);jI(e,d,c);break;case 3:case 4:var f=s.stateNode.containerInfo,m=F3(e);BI(e,m,f);break;default:throw Error(Ye(161))}}catch(g){ei(e,e.return,g)}e.flags&=-3}r&4096&&(e.flags&=-4097)}function Goe(e,r,o){mt=e,PV(e)}function PV(e,r,o){for(var s=(e.mode&1)!==0;mt!==null;){var c=mt,d=c.child;if(c.tag===22&&s){var f=c.memoizedState!==null||WE;if(!f){var m=c.alternate,g=m!==null&&m.memoizedState!==null||Ro;m=WE;var _=Ro;if(WE=f,(Ro=g)&&!_)for(mt=c;mt!==null;)f=mt,g=f.child,f.tag===22&&f.memoizedState!==null?V3(c):g!==null?(g.return=f,mt=g):V3(c);for(;d!==null;)mt=d,PV(d),d=d.sibling;mt=c,WE=m,Ro=_}B3(e)}else c.subtreeFlags&8772&&d!==null?(d.return=c,mt=d):B3(e)}}function B3(e){for(;mt!==null;){var r=mt;if(r.flags&8772){var o=r.alternate;try{if(r.flags&8772)switch(r.tag){case 0:case 11:case 15:Ro||nS(5,r);break;case 1:var s=r.stateNode;if(r.flags&4&&!Ro)if(o===null)s.componentDidMount();else{var c=r.elementType===r.type?o.memoizedProps:Hs(r.type,o.memoizedProps);s.componentDidUpdate(c,o.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var d=r.updateQueue;d!==null&&C3(r,d,s);break;case 3:var f=r.updateQueue;if(f!==null){if(o=null,r.child!==null)switch(r.child.tag){case 5:o=r.child.stateNode;break;case 1:o=r.child.stateNode}C3(r,f,o)}break;case 5:var m=r.stateNode;if(o===null&&r.flags&4){o=m;var g=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":g.autoFocus&&o.focus();break;case"img":g.src&&(o.src=g.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var _=r.alternate;if(_!==null){var S=_.memoizedState;if(S!==null){var T=S.dehydrated;T!==null&&Dm(T)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ye(163))}Ro||r.flags&512&&UI(r)}catch(R){ei(r,r.return,R)}}if(r===e){mt=null;break}if(o=r.sibling,o!==null){o.return=r.return,mt=o;break}mt=r.return}}function j3(e){for(;mt!==null;){var r=mt;if(r===e){mt=null;break}var o=r.sibling;if(o!==null){o.return=r.return,mt=o;break}mt=r.return}}function V3(e){for(;mt!==null;){var r=mt;try{switch(r.tag){case 0:case 11:case 15:var o=r.return;try{nS(4,r)}catch(g){ei(r,o,g)}break;case 1:var s=r.stateNode;if(typeof s.componentDidMount=="function"){var c=r.return;try{s.componentDidMount()}catch(g){ei(r,c,g)}}var d=r.return;try{UI(r)}catch(g){ei(r,d,g)}break;case 5:var f=r.return;try{UI(r)}catch(g){ei(r,f,g)}}}catch(g){ei(r,r.return,g)}if(r===e){mt=null;break}var m=r.sibling;if(m!==null){m.return=r.return,mt=m;break}mt=r.return}}var zoe=Math.ceil,ay=xl.ReactCurrentDispatcher,HO=xl.ReactCurrentOwner,vs=xl.ReactCurrentBatchConfig,Dn=0,Ki=null,Ri=null,oo=0,Fa=0,jp=Ku(0),Li=0,Wm=null,Qd=0,rS=0,WO=0,gm=null,sa=null,GO=0,of=1/0,dl=null,sy=!1,VI=null,Fu=null,GE=!1,Au=null,cy=0,vm=0,$I=null,w_=-1,I_=0;function jo(){return Dn&6?fi():w_!==-1?w_:w_=fi()}function Uu(e){return e.mode&1?Dn&2&&oo!==0?oo&-oo:Ooe.transition!==null?(I_===0&&(I_=mj()),I_):(e=ir,e!==0||(e=window.event,e=e===void 0?16:Cj(e.type)),e):1}function Qs(e,r,o,s){if(50<vm)throw vm=0,$I=null,Error(Ye(185));sg(e,o,s),(!(Dn&2)||e!==Ki)&&(e===Ki&&(!(Dn&2)&&(rS|=o),Li===4&&wu(e,oo)),ha(e,s),o===1&&Dn===0&&!(r.mode&1)&&(of=fi()+500,Zy&&Yu()))}function ha(e,r){var o=e.callbackNode;Oie(e,r);var s=G_(e,e===Ki?oo:0);if(s===0)o!==null&&X4(o),e.callbackNode=null,e.callbackPriority=0;else if(r=s&-s,e.callbackPriority!==r){if(o!=null&&X4(o),r===1)e.tag===0?Aoe($3.bind(null,e)):Vj($3.bind(null,e)),Toe(function(){!(Dn&6)&&Yu()}),o=null;else{switch(gj(s)){case 1:o=vO;break;case 4:o=pj;break;case 16:o=W_;break;case 536870912:o=fj;break;default:o=W_}o=jV(o,DV.bind(null,e))}e.callbackPriority=r,e.callbackNode=o}}function DV(e,r){if(w_=-1,I_=0,Dn&6)throw Error(Ye(327));var o=e.callbackNode;if(Xp()&&e.callbackNode!==o)return null;var s=G_(e,e===Ki?oo:0);if(s===0)return null;if(s&30||s&e.expiredLanes||r)r=ly(e,s);else{r=s;var c=Dn;Dn|=2;var d=LV();(Ki!==e||oo!==r)&&(dl=null,of=fi()+500,Vd(e,r));do try{qoe();break}catch(m){kV(e,m)}while(1);xO(),ay.current=d,Dn=c,Ri!==null?r=0:(Ki=null,oo=0,r=Li)}if(r!==0){if(r===2&&(c=mI(e),c!==0&&(s=c,r=HI(e,c))),r===1)throw o=Wm,Vd(e,0),wu(e,s),ha(e,fi()),o;if(r===6)wu(e,s);else{if(c=e.current.alternate,!(s&30)&&!Koe(c)&&(r=ly(e,s),r===2&&(d=mI(e),d!==0&&(s=d,r=HI(e,d))),r===1))throw o=Wm,Vd(e,0),wu(e,s),ha(e,fi()),o;switch(e.finishedWork=c,e.finishedLanes=s,r){case 0:case 1:throw Error(Ye(345));case 2:Nd(e,sa,dl);break;case 3:if(wu(e,s),(s&130023424)===s&&(r=GO+500-fi(),10<r)){if(G_(e,0)!==0)break;if(c=e.suspendedLanes,(c&s)!==s){jo(),e.pingedLanes|=e.suspendedLanes&c;break}e.timeoutHandle=bI(Nd.bind(null,e,sa,dl),r);break}Nd(e,sa,dl);break;case 4:if(wu(e,s),(s&4194240)===s)break;for(r=e.eventTimes,c=-1;0<s;){var f=31-Js(s);d=1<<f,f=r[f],f>c&&(c=f),s&=~d}if(s=c,s=fi()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*zoe(s/1960))-s,10<s){e.timeoutHandle=bI(Nd.bind(null,e,sa,dl),s);break}Nd(e,sa,dl);break;case 5:Nd(e,sa,dl);break;default:throw Error(Ye(329))}}}return ha(e,fi()),e.callbackNode===o?DV.bind(null,e):null}function HI(e,r){var o=gm;return e.current.memoizedState.isDehydrated&&(Vd(e,r).flags|=256),e=ly(e,r),e!==2&&(r=sa,sa=o,r!==null&&WI(r)),e}function WI(e){sa===null?sa=e:sa.push.apply(sa,e)}function Koe(e){for(var r=e;;){if(r.flags&16384){var o=r.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var s=0;s<o.length;s++){var c=o[s],d=c.getSnapshot;c=c.value;try{if(!tc(d(),c))return!1}catch{return!1}}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function wu(e,r){for(r&=~WO,r&=~rS,e.suspendedLanes|=r,e.pingedLanes&=~r,e=e.expirationTimes;0<r;){var o=31-Js(r),s=1<<o;e[o]=-1,r&=~s}}function $3(e){if(Dn&6)throw Error(Ye(327));Xp();var r=G_(e,0);if(!(r&1))return ha(e,fi()),null;var o=ly(e,r);if(e.tag!==0&&o===2){var s=mI(e);s!==0&&(r=s,o=HI(e,s))}if(o===1)throw o=Wm,Vd(e,0),wu(e,r),ha(e,fi()),o;if(o===6)throw Error(Ye(345));return e.finishedWork=e.current.alternate,e.finishedLanes=r,Nd(e,sa,dl),ha(e,fi()),null}function zO(e,r){var o=Dn;Dn|=1;try{return e(r)}finally{Dn=o,Dn===0&&(of=fi()+500,Zy&&Yu())}}function Zd(e){Au!==null&&Au.tag===0&&!(Dn&6)&&Xp();var r=Dn;Dn|=1;var o=vs.transition,s=ir;try{if(vs.transition=null,ir=1,e)return e()}finally{ir=s,vs.transition=o,Dn=r,!(Dn&6)&&Yu()}}function KO(){Fa=jp.current,Nr(jp)}function Vd(e,r){e.finishedWork=null,e.finishedLanes=0;var o=e.timeoutHandle;if(o!==-1&&(e.timeoutHandle=-1,boe(o)),Ri!==null)for(o=Ri.return;o!==null;){var s=o;switch(IO(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&X_();break;case 3:nf(),Nr(ua),Nr(wo),MO();break;case 5:LO(s);break;case 4:nf();break;case 13:Nr(Yr);break;case 19:Nr(Yr);break;case 10:NO(s.type._context);break;case 22:case 23:KO()}o=o.return}if(Ki=e,Ri=e=Bu(e.current,null),oo=Fa=r,Li=0,Wm=null,WO=rS=Qd=0,sa=gm=null,Md!==null){for(r=0;r<Md.length;r++)if(o=Md[r],s=o.interleaved,s!==null){o.interleaved=null;var c=s.next,d=o.pending;if(d!==null){var f=d.next;d.next=c,s.next=f}o.pending=s}Md=null}return e}function kV(e,r){do{var o=Ri;try{if(xO(),b_.current=oy,iy){for(var s=Xr.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}iy=!1}if(Jd=0,zi=ki=Xr=null,fm=!1,Vm=0,HO.current=null,o===null||o.return===null){Li=1,Wm=r,Ri=null;break}e:{var d=e,f=o.return,m=o,g=r;if(r=oo,m.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){var _=g,S=m,T=S.tag;if(!(S.mode&1)&&(T===0||T===11||T===15)){var R=S.alternate;R?(S.updateQueue=R.updateQueue,S.memoizedState=R.memoizedState,S.lanes=R.lanes):(S.updateQueue=null,S.memoizedState=null)}var N=O3(f);if(N!==null){N.flags&=-257,x3(N,f,m,d,r),N.mode&1&&A3(d,_,r),r=N,g=_;var A=r.updateQueue;if(A===null){var O=new Set;O.add(g),r.updateQueue=O}else A.add(g);break e}else{if(!(r&1)){A3(d,_,r),YO();break e}g=Error(Ye(426))}}else if(Hr&&m.mode&1){var M=O3(f);if(M!==null){!(M.flags&65536)&&(M.flags|=256),x3(M,f,m,d,r),AO(rf(g,m));break e}}d=g=rf(g,m),Li!==4&&(Li=2),gm===null?gm=[d]:gm.push(d),d=f;do{switch(d.tag){case 3:d.flags|=65536,r&=-r,d.lanes|=r;var x=vV(d,g,r);S3(d,x);break e;case 1:m=g;var P=d.type,D=d.stateNode;if(!(d.flags&128)&&(typeof P.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(Fu===null||!Fu.has(D)))){d.flags|=65536,r&=-r,d.lanes|=r;var F=EV(d,m,r);S3(d,F);break e}}d=d.return}while(d!==null)}FV(o)}catch($){r=$,Ri===o&&o!==null&&(Ri=o=o.return);continue}break}while(1)}function LV(){var e=ay.current;return ay.current=oy,e===null?oy:e}function YO(){(Li===0||Li===3||Li===2)&&(Li=4),Ki===null||!(Qd&268435455)&&!(rS&268435455)||wu(Ki,oo)}function ly(e,r){var o=Dn;Dn|=2;var s=LV();(Ki!==e||oo!==r)&&(dl=null,Vd(e,r));do try{Yoe();break}catch(c){kV(e,c)}while(1);if(xO(),Dn=o,ay.current=s,Ri!==null)throw Error(Ye(261));return Ki=null,oo=0,Li}function Yoe(){for(;Ri!==null;)MV(Ri)}function qoe(){for(;Ri!==null&&!yie();)MV(Ri)}function MV(e){var r=BV(e.alternate,e,Fa);e.memoizedProps=e.pendingProps,r===null?FV(e):Ri=r,HO.current=null}function FV(e){var r=e;do{var o=r.alternate;if(e=r.return,r.flags&32768){if(o=$oe(o,r),o!==null){o.flags&=32767,Ri=o;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Li=6,Ri=null;return}}else if(o=Voe(o,r,Fa),o!==null){Ri=o;return}if(r=r.sibling,r!==null){Ri=r;return}Ri=r=e}while(r!==null);Li===0&&(Li=5)}function Nd(e,r,o){var s=ir,c=vs.transition;try{vs.transition=null,ir=1,Xoe(e,r,o,s)}finally{vs.transition=c,ir=s}return null}function Xoe(e,r,o,s){do Xp();while(Au!==null);if(Dn&6)throw Error(Ye(327));o=e.finishedWork;var c=e.finishedLanes;if(o===null)return null;if(e.finishedWork=null,e.finishedLanes=0,o===e.current)throw Error(Ye(177));e.callbackNode=null,e.callbackPriority=0;var d=o.lanes|o.childLanes;if(xie(e,d),e===Ki&&(Ri=Ki=null,oo=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||GE||(GE=!0,jV(W_,function(){return Xp(),null})),d=(o.flags&15990)!==0,o.subtreeFlags&15990||d){d=vs.transition,vs.transition=null;var f=ir;ir=1;var m=Dn;Dn|=4,HO.current=null,Woe(e,o),NV(o,e),goe(SI),z_=!!yI,SI=yI=null,e.current=o,Goe(o),Sie(),Dn=m,ir=f,vs.transition=d}else e.current=o;if(GE&&(GE=!1,Au=e,cy=c),d=e.pendingLanes,d===0&&(Fu=null),Tie(o.stateNode),ha(e,fi()),r!==null)for(s=e.onRecoverableError,o=0;o<r.length;o++)c=r[o],s(c.value,{componentStack:c.stack,digest:c.digest});if(sy)throw sy=!1,e=VI,VI=null,e;return cy&1&&e.tag!==0&&Xp(),d=e.pendingLanes,d&1?e===$I?vm++:(vm=0,$I=e):vm=0,Yu(),null}function Xp(){if(Au!==null){var e=gj(cy),r=vs.transition,o=ir;try{if(vs.transition=null,ir=16>e?16:e,Au===null)var s=!1;else{if(e=Au,Au=null,cy=0,Dn&6)throw Error(Ye(331));var c=Dn;for(Dn|=4,mt=e.current;mt!==null;){var d=mt,f=d.child;if(mt.flags&16){var m=d.deletions;if(m!==null){for(var g=0;g<m.length;g++){var _=m[g];for(mt=_;mt!==null;){var S=mt;switch(S.tag){case 0:case 11:case 15:mm(8,S,d)}var T=S.child;if(T!==null)T.return=S,mt=T;else for(;mt!==null;){S=mt;var R=S.sibling,N=S.return;if(AV(S),S===_){mt=null;break}if(R!==null){R.return=N,mt=R;break}mt=N}}}var A=d.alternate;if(A!==null){var O=A.child;if(O!==null){A.child=null;do{var M=O.sibling;O.sibling=null,O=M}while(O!==null)}}mt=d}}if(d.subtreeFlags&2064&&f!==null)f.return=d,mt=f;else e:for(;mt!==null;){if(d=mt,d.flags&2048)switch(d.tag){case 0:case 11:case 15:mm(9,d,d.return)}var x=d.sibling;if(x!==null){x.return=d.return,mt=x;break e}mt=d.return}}var P=e.current;for(mt=P;mt!==null;){f=mt;var D=f.child;if(f.subtreeFlags&2064&&D!==null)D.return=f,mt=D;else e:for(f=P;mt!==null;){if(m=mt,m.flags&2048)try{switch(m.tag){case 0:case 11:case 15:nS(9,m)}}catch($){ei(m,m.return,$)}if(m===f){mt=null;break e}var F=m.sibling;if(F!==null){F.return=m.return,mt=F;break e}mt=m.return}}if(Dn=c,Yu(),Mc&&typeof Mc.onPostCommitFiberRoot=="function")try{Mc.onPostCommitFiberRoot(Yy,e)}catch{}s=!0}return s}finally{ir=o,vs.transition=r}}return!1}function H3(e,r,o){r=rf(o,r),r=vV(e,r,1),e=Mu(e,r,1),r=jo(),e!==null&&(sg(e,1,r),ha(e,r))}function ei(e,r,o){if(e.tag===3)H3(e,e,o);else for(;r!==null;){if(r.tag===3){H3(r,e,o);break}else if(r.tag===1){var s=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Fu===null||!Fu.has(s))){e=rf(o,e),e=EV(r,e,1),r=Mu(r,e,1),e=jo(),r!==null&&(sg(r,1,e),ha(r,e));break}}r=r.return}}function Joe(e,r,o){var s=e.pingCache;s!==null&&s.delete(r),r=jo(),e.pingedLanes|=e.suspendedLanes&o,Ki===e&&(oo&o)===o&&(Li===4||Li===3&&(oo&130023424)===oo&&500>fi()-GO?Vd(e,0):WO|=o),ha(e,r)}function UV(e,r){r===0&&(e.mode&1?(r=LE,LE<<=1,!(LE&130023424)&&(LE=4194304)):r=1);var o=jo();e=Cl(e,r),e!==null&&(sg(e,r,o),ha(e,o))}function Qoe(e){var r=e.memoizedState,o=0;r!==null&&(o=r.retryLane),UV(e,o)}function Zoe(e,r){var o=0;switch(e.tag){case 13:var s=e.stateNode,c=e.memoizedState;c!==null&&(o=c.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(Ye(314))}s!==null&&s.delete(r),UV(e,o)}var BV;BV=function(e,r,o){if(e!==null)if(e.memoizedProps!==r.pendingProps||ua.current)ca=!0;else{if(!(e.lanes&o)&&!(r.flags&128))return ca=!1,joe(e,r,o);ca=!!(e.flags&131072)}else ca=!1,Hr&&r.flags&1048576&&$j(r,Z_,r.index);switch(r.lanes=0,r.tag){case 2:var s=r.type;R_(e,r),e=r.pendingProps;var c=Zp(r,wo.current);qp(r,o),c=UO(null,r,s,e,c,o);var d=BO();return r.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,da(s)?(d=!0,J_(r)):d=!1,r.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,DO(r),c.updater=eS,r.stateNode=c,c._reactInternals=r,xI(r,s,e,o),r=DI(null,r,s,!0,d,o)):(r.tag=0,Hr&&d&&wO(r),Uo(null,r,c,o),r=r.child),r;case 16:s=r.elementType;e:{switch(R_(e,r),e=r.pendingProps,c=s._init,s=c(s._payload),r.type=s,c=r.tag=tae(s),e=Hs(s,e),c){case 0:r=PI(null,r,s,e,o);break e;case 1:r=D3(null,r,s,e,o);break e;case 11:r=N3(null,r,s,e,o);break e;case 14:r=P3(null,r,s,Hs(s.type,e),o);break e}throw Error(Ye(306,s,""))}return r;case 0:return s=r.type,c=r.pendingProps,c=r.elementType===s?c:Hs(s,c),PI(e,r,s,c,o);case 1:return s=r.type,c=r.pendingProps,c=r.elementType===s?c:Hs(s,c),D3(e,r,s,c,o);case 3:e:{if(CV(r),e===null)throw Error(Ye(387));s=r.pendingProps,d=r.memoizedState,c=d.element,zj(e,r),ny(r,s,null,o);var f=r.memoizedState;if(s=f.element,d.isDehydrated)if(d={element:s,isDehydrated:!1,cache:f.cache,pendingSuspenseBoundaries:f.pendingSuspenseBoundaries,transitions:f.transitions},r.updateQueue.baseState=d,r.memoizedState=d,r.flags&256){c=rf(Error(Ye(423)),r),r=k3(e,r,s,o,c);break e}else if(s!==c){c=rf(Error(Ye(424)),r),r=k3(e,r,s,o,c);break e}else for(Ua=Lu(r.stateNode.containerInfo.firstChild),ja=r,Hr=!0,Ys=null,o=Xj(r,null,s,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ef(),s===c){r=bl(e,r,o);break e}Uo(e,r,s,o)}r=r.child}return r;case 5:return Jj(r),e===null&&II(r),s=r.type,c=r.pendingProps,d=e!==null?e.memoizedProps:null,f=c.children,CI(s,c)?f=null:d!==null&&CI(s,d)&&(r.flags|=32),SV(e,r),Uo(e,r,f,o),r.child;case 6:return e===null&&II(r),null;case 13:return bV(e,r,o);case 4:return kO(r,r.stateNode.containerInfo),s=r.pendingProps,e===null?r.child=tf(r,null,s,o):Uo(e,r,s,o),r.child;case 11:return s=r.type,c=r.pendingProps,c=r.elementType===s?c:Hs(s,c),N3(e,r,s,c,o);case 7:return Uo(e,r,r.pendingProps,o),r.child;case 8:return Uo(e,r,r.pendingProps.children,o),r.child;case 12:return Uo(e,r,r.pendingProps.children,o),r.child;case 10:e:{if(s=r.type._context,c=r.pendingProps,d=r.memoizedProps,f=c.value,Ir(ey,s._currentValue),s._currentValue=f,d!==null)if(tc(d.value,f)){if(d.children===c.children&&!ua.current){r=bl(e,r,o);break e}}else for(d=r.child,d!==null&&(d.return=r);d!==null;){var m=d.dependencies;if(m!==null){f=d.child;for(var g=m.firstContext;g!==null;){if(g.context===s){if(d.tag===1){g=gl(-1,o&-o),g.tag=2;var _=d.updateQueue;if(_!==null){_=_.shared;var S=_.pending;S===null?g.next=g:(g.next=S.next,S.next=g),_.pending=g}}d.lanes|=o,g=d.alternate,g!==null&&(g.lanes|=o),AI(d.return,o,r),m.lanes|=o;break}g=g.next}}else if(d.tag===10)f=d.type===r.type?null:d.child;else if(d.tag===18){if(f=d.return,f===null)throw Error(Ye(341));f.lanes|=o,m=f.alternate,m!==null&&(m.lanes|=o),AI(f,o,r),f=d.sibling}else f=d.child;if(f!==null)f.return=d;else for(f=d;f!==null;){if(f===r){f=null;break}if(d=f.sibling,d!==null){d.return=f.return,f=d;break}f=f.return}d=f}Uo(e,r,c.children,o),r=r.child}return r;case 9:return c=r.type,s=r.pendingProps.children,qp(r,o),c=_s(c),s=s(c),r.flags|=1,Uo(e,r,s,o),r.child;case 14:return s=r.type,c=Hs(s,r.pendingProps),c=Hs(s.type,c),P3(e,r,s,c,o);case 15:return _V(e,r,r.type,r.pendingProps,o);case 17:return s=r.type,c=r.pendingProps,c=r.elementType===s?c:Hs(s,c),R_(e,r),r.tag=1,da(s)?(e=!0,J_(r)):e=!1,qp(r,o),Yj(r,s,c),xI(r,s,c,o),DI(null,r,s,!0,e,o);case 19:return TV(e,r,o);case 22:return yV(e,r,o)}throw Error(Ye(156,r.tag))};function jV(e,r){return hj(e,r)}function eae(e,r,o,s){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gs(e,r,o,s){return new eae(e,r,o,s)}function qO(e){return e=e.prototype,!(!e||!e.isReactComponent)}function tae(e){if(typeof e=="function")return qO(e)?1:0;if(e!=null){if(e=e.$$typeof,e===fO)return 11;if(e===mO)return 14}return 2}function Bu(e,r){var o=e.alternate;return o===null?(o=gs(e.tag,r,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=r,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&14680064,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,r=e.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o}function A_(e,r,o,s,c,d){var f=2;if(s=e,typeof e=="function")qO(e)&&(f=1);else if(typeof e=="string")f=5;else e:switch(e){case xp:return $d(o.children,c,d,r);case pO:f=8,c|=8;break;case eI:return e=gs(12,o,r,c|2),e.elementType=eI,e.lanes=d,e;case tI:return e=gs(13,o,r,c),e.elementType=tI,e.lanes=d,e;case nI:return e=gs(19,o,r,c),e.elementType=nI,e.lanes=d,e;case q8:return iS(o,c,d,r);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case K8:f=10;break e;case Y8:f=9;break e;case fO:f=11;break e;case mO:f=14;break e;case bu:f=16,s=null;break e}throw Error(Ye(130,e==null?e:typeof e,""))}return r=gs(f,o,r,c),r.elementType=e,r.type=s,r.lanes=d,r}function $d(e,r,o,s){return e=gs(7,e,s,r),e.lanes=o,e}function iS(e,r,o,s){return e=gs(22,e,s,r),e.elementType=q8,e.lanes=o,e.stateNode={isHidden:!1},e}function C1(e,r,o){return e=gs(6,e,null,r),e.lanes=o,e}function b1(e,r,o){return r=gs(4,e.children!==null?e.children:[],e.key,r),r.lanes=o,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}function nae(e,r,o,s,c){this.tag=r,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=r1(0),this.expirationTimes=r1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=r1(0),this.identifierPrefix=s,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function XO(e,r,o,s,c,d,f,m,g){return e=new nae(e,r,o,m,g),r===1?(r=1,d===!0&&(r|=8)):r=0,d=gs(3,null,null,r),e.current=d,d.stateNode=e,d.memoizedState={element:s,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},DO(d),e}function rae(e,r,o){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Op,key:s==null?null:""+s,children:e,containerInfo:r,implementation:o}}function VV(e){if(!e)return Vu;e=e._reactInternals;e:{if(ih(e)!==e||e.tag!==1)throw Error(Ye(170));var r=e;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(da(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(Ye(171))}if(e.tag===1){var o=e.type;if(da(o))return jj(e,o,r)}return r}function $V(e,r,o,s,c,d,f,m,g){return e=XO(o,s,!0,e,c,d,f,m,g),e.context=VV(null),o=e.current,s=jo(),c=Uu(o),d=gl(s,c),d.callback=r??null,Mu(o,d,c),e.current.lanes=c,sg(e,c,s),ha(e,s),e}function oS(e,r,o,s){var c=r.current,d=jo(),f=Uu(c);return o=VV(o),r.context===null?r.context=o:r.pendingContext=o,r=gl(d,f),r.payload={element:e},s=s===void 0?null:s,s!==null&&(r.callback=s),e=Mu(c,r,f),e!==null&&(Qs(e,c,f,d),C_(e,c,f)),f}function uy(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function W3(e,r){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<r?o:r}}function JO(e,r){W3(e,r),(e=e.alternate)&&W3(e,r)}function iae(){return null}var HV=typeof reportError=="function"?reportError:function(e){console.error(e)};function QO(e){this._internalRoot=e}aS.prototype.render=QO.prototype.render=function(e){var r=this._internalRoot;if(r===null)throw Error(Ye(409));oS(e,r,null,null)};aS.prototype.unmount=QO.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var r=e.containerInfo;Zd(function(){oS(null,e,null,null)}),r[Sl]=null}};function aS(e){this._internalRoot=e}aS.prototype.unstable_scheduleHydration=function(e){if(e){var r=_j();e={blockedOn:null,target:e,priority:r};for(var o=0;o<Ru.length&&r!==0&&r<Ru[o].priority;o++);Ru.splice(o,0,e),o===0&&Sj(e)}};function ZO(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function sS(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function G3(){}function oae(e,r,o,s,c){if(c){if(typeof s=="function"){var d=s;s=function(){var _=uy(f);d.call(_)}}var f=$V(r,s,e,0,null,!1,!1,"",G3);return e._reactRootContainer=f,e[Sl]=f.current,Mm(e.nodeType===8?e.parentNode:e),Zd(),f}for(;c=e.lastChild;)e.removeChild(c);if(typeof s=="function"){var m=s;s=function(){var _=uy(g);m.call(_)}}var g=XO(e,0,!1,null,null,!1,!1,"",G3);return e._reactRootContainer=g,e[Sl]=g.current,Mm(e.nodeType===8?e.parentNode:e),Zd(function(){oS(r,g,o,s)}),g}function cS(e,r,o,s,c){var d=o._reactRootContainer;if(d){var f=d;if(typeof c=="function"){var m=c;c=function(){var g=uy(f);m.call(g)}}oS(r,f,e,c)}else f=oae(o,r,e,c,s);return uy(f)}vj=function(e){switch(e.tag){case 3:var r=e.stateNode;if(r.current.memoizedState.isDehydrated){var o=om(r.pendingLanes);o!==0&&(EO(r,o|1),ha(r,fi()),!(Dn&6)&&(of=fi()+500,Yu()))}break;case 13:Zd(function(){var s=Cl(e,1);if(s!==null){var c=jo();Qs(s,e,1,c)}}),JO(e,1)}};_O=function(e){if(e.tag===13){var r=Cl(e,134217728);if(r!==null){var o=jo();Qs(r,e,134217728,o)}JO(e,134217728)}};Ej=function(e){if(e.tag===13){var r=Uu(e),o=Cl(e,r);if(o!==null){var s=jo();Qs(o,e,r,s)}JO(e,r)}};_j=function(){return ir};yj=function(e,r){var o=ir;try{return ir=e,r()}finally{ir=o}};hI=function(e,r,o){switch(r){case"input":if(oI(e,o),r=o.name,o.type==="radio"&&r!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<o.length;r++){var s=o[r];if(s!==e&&s.form===e.form){var c=Qy(s);if(!c)throw Error(Ye(90));J8(s),oI(s,c)}}}break;case"textarea":Z8(e,o);break;case"select":r=o.value,r!=null&&Gp(e,!!o.multiple,r,!1)}};aj=zO;sj=Zd;var aae={usingClientEntryPoint:!1,Events:[lg,kp,Qy,ij,oj,zO]},Y0={findFiberByHostInstance:Ld,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},sae={bundleType:Y0.bundleType,version:Y0.version,rendererPackageName:Y0.rendererPackageName,rendererConfig:Y0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xl.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=uj(e),e===null?null:e.stateNode},findFiberByHostInstance:Y0.findFiberByHostInstance||iae,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zE=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zE.isDisabled&&zE.supportsFiber)try{Yy=zE.inject(sae),Mc=zE}catch{}}Wa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aae;Wa.createPortal=function(e,r){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ZO(r))throw Error(Ye(200));return rae(e,r,null,o)};Wa.createRoot=function(e,r){if(!ZO(e))throw Error(Ye(299));var o=!1,s="",c=HV;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(c=r.onRecoverableError)),r=XO(e,1,!1,null,null,o,!1,s,c),e[Sl]=r.current,Mm(e.nodeType===8?e.parentNode:e),new QO(r)};Wa.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var r=e._reactInternals;if(r===void 0)throw typeof e.render=="function"?Error(Ye(188)):(e=Object.keys(e).join(","),Error(Ye(268,e)));return e=uj(r),e=e===null?null:e.stateNode,e};Wa.flushSync=function(e){return Zd(e)};Wa.hydrate=function(e,r,o){if(!sS(r))throw Error(Ye(200));return cS(null,e,r,!0,o)};Wa.hydrateRoot=function(e,r,o){if(!ZO(e))throw Error(Ye(405));var s=o!=null&&o.hydratedSources||null,c=!1,d="",f=HV;if(o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(d=o.identifierPrefix),o.onRecoverableError!==void 0&&(f=o.onRecoverableError)),r=$V(r,null,e,1,o??null,c,!1,d,f),e[Sl]=r.current,Mm(e),s)for(e=0;e<s.length;e++)o=s[e],c=o._getVersion,c=c(o._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[o,c]:r.mutableSourceEagerHydrationData.push(o,c);return new aS(r)};Wa.render=function(e,r,o){if(!sS(r))throw Error(Ye(200));return cS(null,e,r,!1,o)};Wa.unmountComponentAtNode=function(e){if(!sS(e))throw Error(Ye(40));return e._reactRootContainer?(Zd(function(){cS(null,null,e,!1,function(){e._reactRootContainer=null,e[Sl]=null})}),!0):!1};Wa.unstable_batchedUpdates=zO;Wa.unstable_renderSubtreeIntoContainer=function(e,r,o,s){if(!sS(o))throw Error(Ye(200));if(e==null||e._reactInternals===void 0)throw Error(Ye(38));return cS(e,r,o,!1,s)};Wa.version="18.2.0-next-9e3b772b8-20220608";function WV(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(WV)}catch(e){console.error(e)}}WV(),$8.exports=Wa;var Nl=$8.exports;const GV=Ol(Nl),cae=C8({__proto__:null,default:GV},[Nl]);var z3=Nl;Qw.createRoot=z3.createRoot,Qw.hydrateRoot=z3.hydrateRoot;/**
 * @remix-run/router v1.9.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gm(){return Gm=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},Gm.apply(this,arguments)}var Ou;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ou||(Ou={}));const K3="popstate";function lae(e){e===void 0&&(e={});function r(c,d){let{pathname:f="/",search:m="",hash:g=""}=oh(c.location.hash.substr(1));return!f.startsWith("/")&&!f.startsWith(".")&&(f="/"+f),GI("",{pathname:f,search:m,hash:g},d.state&&d.state.usr||null,d.state&&d.state.key||"default")}function o(c,d){let f=c.document.querySelector("base"),m="";if(f&&f.getAttribute("href")){let g=c.location.href,_=g.indexOf("#");m=_===-1?g:g.slice(0,_)}return m+"#"+(typeof d=="string"?d:zV(d))}function s(c,d){lS(c.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(d)+")")}return dae(r,o,s,e)}function Mi(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function lS(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function uae(){return Math.random().toString(36).substr(2,8)}function Y3(e,r){return{usr:e.state,key:e.key,idx:r}}function GI(e,r,o,s){return o===void 0&&(o=null),Gm({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof r=="string"?oh(r):r,{state:o,key:r&&r.key||s||uae()})}function zV(e){let{pathname:r="/",search:o="",hash:s=""}=e;return o&&o!=="?"&&(r+=o.charAt(0)==="?"?o:"?"+o),s&&s!=="#"&&(r+=s.charAt(0)==="#"?s:"#"+s),r}function oh(e){let r={};if(e){let o=e.indexOf("#");o>=0&&(r.hash=e.substr(o),e=e.substr(0,o));let s=e.indexOf("?");s>=0&&(r.search=e.substr(s),e=e.substr(0,s)),e&&(r.pathname=e)}return r}function dae(e,r,o,s){s===void 0&&(s={});let{window:c=document.defaultView,v5Compat:d=!1}=s,f=c.history,m=Ou.Pop,g=null,_=S();_==null&&(_=0,f.replaceState(Gm({},f.state,{idx:_}),""));function S(){return(f.state||{idx:null}).idx}function T(){m=Ou.Pop;let M=S(),x=M==null?null:M-_;_=M,g&&g({action:m,location:O.location,delta:x})}function R(M,x){m=Ou.Push;let P=GI(O.location,M,x);o&&o(P,M),_=S()+1;let D=Y3(P,_),F=O.createHref(P);try{f.pushState(D,"",F)}catch($){if($ instanceof DOMException&&$.name==="DataCloneError")throw $;c.location.assign(F)}d&&g&&g({action:m,location:O.location,delta:1})}function N(M,x){m=Ou.Replace;let P=GI(O.location,M,x);o&&o(P,M),_=S();let D=Y3(P,_),F=O.createHref(P);f.replaceState(D,"",F),d&&g&&g({action:m,location:O.location,delta:0})}function A(M){let x=c.location.origin!=="null"?c.location.origin:c.location.href,P=typeof M=="string"?M:zV(M);return Mi(x,"No window.location.(origin|href) available to create URL for href: "+P),new URL(P,x)}let O={get action(){return m},get location(){return e(c,f)},listen(M){if(g)throw new Error("A history only accepts one active listener");return c.addEventListener(K3,T),g=M,()=>{c.removeEventListener(K3,T),g=null}},createHref(M){return r(c,M)},createURL:A,encodeLocation(M){let x=A(M);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:R,replace:N,go(M){return f.go(M)}};return O}var q3;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(q3||(q3={}));function hae(e,r,o){o===void 0&&(o="/");let s=typeof r=="string"?oh(r):r,c=qV(s.pathname||"/",o);if(c==null)return null;let d=KV(e);pae(d);let f=null;for(let m=0;f==null&&m<d.length;++m)f=Cae(d[m],Rae(c));return f}function KV(e,r,o,s){r===void 0&&(r=[]),o===void 0&&(o=[]),s===void 0&&(s="");let c=(d,f,m)=>{let g={relativePath:m===void 0?d.path||"":m,caseSensitive:d.caseSensitive===!0,childrenIndex:f,route:d};g.relativePath.startsWith("/")&&(Mi(g.relativePath.startsWith(s),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(s.length));let _=Hd([s,g.relativePath]),S=o.concat(g);d.children&&d.children.length>0&&(Mi(d.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+_+'".')),KV(d.children,r,S,_)),!(d.path==null&&!d.index)&&r.push({path:_,score:yae(_,d.index),routesMeta:S})};return e.forEach((d,f)=>{var m;if(d.path===""||!((m=d.path)!=null&&m.includes("?")))c(d,f);else for(let g of YV(d.path))c(d,f,g)}),r}function YV(e){let r=e.split("/");if(r.length===0)return[];let[o,...s]=r,c=o.endsWith("?"),d=o.replace(/\?$/,"");if(s.length===0)return c?[d,""]:[d];let f=YV(s.join("/")),m=[];return m.push(...f.map(g=>g===""?d:[d,g].join("/"))),c&&m.push(...f),m.map(g=>e.startsWith("/")&&g===""?"/":g)}function pae(e){e.sort((r,o)=>r.score!==o.score?o.score-r.score:Sae(r.routesMeta.map(s=>s.childrenIndex),o.routesMeta.map(s=>s.childrenIndex)))}const fae=/^:\w+$/,mae=3,gae=2,vae=1,Eae=10,_ae=-2,X3=e=>e==="*";function yae(e,r){let o=e.split("/"),s=o.length;return o.some(X3)&&(s+=_ae),r&&(s+=gae),o.filter(c=>!X3(c)).reduce((c,d)=>c+(fae.test(d)?mae:d===""?vae:Eae),s)}function Sae(e,r){return e.length===r.length&&e.slice(0,-1).every((s,c)=>s===r[c])?e[e.length-1]-r[r.length-1]:0}function Cae(e,r){let{routesMeta:o}=e,s={},c="/",d=[];for(let f=0;f<o.length;++f){let m=o[f],g=f===o.length-1,_=c==="/"?r:r.slice(c.length)||"/",S=bae({path:m.relativePath,caseSensitive:m.caseSensitive,end:g},_);if(!S)return null;Object.assign(s,S.params);let T=m.route;d.push({params:s,pathname:Hd([c,S.pathname]),pathnameBase:Nae(Hd([c,S.pathnameBase])),route:T}),S.pathnameBase!=="/"&&(c=Hd([c,S.pathnameBase]))}return d}function bae(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[o,s]=Tae(e.path,e.caseSensitive,e.end),c=r.match(o);if(!c)return null;let d=c[0],f=d.replace(/(.)\/+$/,"$1"),m=c.slice(1);return{params:s.reduce((_,S,T)=>{if(S==="*"){let R=m[T]||"";f=d.slice(0,d.length-R.length).replace(/(.)\/+$/,"$1")}return _[S]=wae(m[T]||"",S),_},{}),pathname:d,pathnameBase:f,pattern:e}}function Tae(e,r,o){r===void 0&&(r=!1),o===void 0&&(o=!0),lS(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],c="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(f,m)=>(s.push(m),"/([^\\/]+)"));return e.endsWith("*")?(s.push("*"),c+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):o?c+="\\/*$":e!==""&&e!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,r?void 0:"i"),s]}function Rae(e){try{return decodeURI(e)}catch(r){return lS(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+r+").")),e}}function wae(e,r){try{return decodeURIComponent(e)}catch(o){return lS(!1,'The value for the URL param "'+r+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+o+").")),e}}function qV(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let o=r.endsWith("/")?r.length-1:r.length,s=e.charAt(o);return s&&s!=="/"?null:e.slice(o)||"/"}function Iae(e,r){r===void 0&&(r="/");let{pathname:o,search:s="",hash:c=""}=typeof e=="string"?oh(e):e;return{pathname:o?o.startsWith("/")?o:Aae(o,r):r,search:Pae(s),hash:Dae(c)}}function Aae(e,r){let o=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(c=>{c===".."?o.length>1&&o.pop():c!=="."&&o.push(c)}),o.length>1?o.join("/"):"/"}function T1(e,r,o,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+r+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+o+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Oae(e){return e.filter((r,o)=>o===0||r.route.path&&r.route.path.length>0)}function xae(e,r,o,s){s===void 0&&(s=!1);let c;typeof e=="string"?c=oh(e):(c=Gm({},e),Mi(!c.pathname||!c.pathname.includes("?"),T1("?","pathname","search",c)),Mi(!c.pathname||!c.pathname.includes("#"),T1("#","pathname","hash",c)),Mi(!c.search||!c.search.includes("#"),T1("#","search","hash",c)));let d=e===""||c.pathname==="",f=d?"/":c.pathname,m;if(s||f==null)m=o;else{let T=r.length-1;if(f.startsWith("..")){let R=f.split("/");for(;R[0]==="..";)R.shift(),T-=1;c.pathname=R.join("/")}m=T>=0?r[T]:"/"}let g=Iae(c,m),_=f&&f!=="/"&&f.endsWith("/"),S=(d||f===".")&&o.endsWith("/");return!g.pathname.endsWith("/")&&(_||S)&&(g.pathname+="/"),g}const Hd=e=>e.join("/").replace(/\/\/+/g,"/"),Nae=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Pae=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Dae=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function kae(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const XV=["post","put","patch","delete"];new Set(XV);const Lae=["get",...XV];new Set(Lae);/**
 * React Router v6.16.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function dy(){return dy=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},dy.apply(this,arguments)}const ex=b.createContext(null),Mae=b.createContext(null),uS=b.createContext(null),dS=b.createContext(null),_f=b.createContext({outlet:null,matches:[],isDataRoute:!1}),JV=b.createContext(null);function hS(){return b.useContext(dS)!=null}function QV(){return hS()||Mi(!1),b.useContext(dS).location}function ZV(e){b.useContext(uS).static||b.useLayoutEffect(e)}function Fae(){let{isDataRoute:e}=b.useContext(_f);return e?Xae():Uae()}function Uae(){hS()||Mi(!1);let e=b.useContext(ex),{basename:r,navigator:o}=b.useContext(uS),{matches:s}=b.useContext(_f),{pathname:c}=QV(),d=JSON.stringify(Oae(s).map(g=>g.pathnameBase)),f=b.useRef(!1);return ZV(()=>{f.current=!0}),b.useCallback(function(g,_){if(_===void 0&&(_={}),!f.current)return;if(typeof g=="number"){o.go(g);return}let S=xae(g,JSON.parse(d),c,_.relative==="path");e==null&&r!=="/"&&(S.pathname=S.pathname==="/"?r:Hd([r,S.pathname])),(_.replace?o.replace:o.push)(S,_.state,_)},[r,o,d,c,e])}function Bae(e,r){return jae(e,r)}function jae(e,r,o){hS()||Mi(!1);let{navigator:s}=b.useContext(uS),{matches:c}=b.useContext(_f),d=c[c.length-1],f=d?d.params:{};d&&d.pathname;let m=d?d.pathnameBase:"/";d&&d.route;let g=QV(),_;if(r){var S;let O=typeof r=="string"?oh(r):r;m==="/"||(S=O.pathname)!=null&&S.startsWith(m)||Mi(!1),_=O}else _=g;let T=_.pathname||"/",R=m==="/"?T:T.slice(m.length)||"/",N=hae(e,{pathname:R}),A=Gae(N&&N.map(O=>Object.assign({},O,{params:Object.assign({},f,O.params),pathname:Hd([m,s.encodeLocation?s.encodeLocation(O.pathname).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?m:Hd([m,s.encodeLocation?s.encodeLocation(O.pathnameBase).pathname:O.pathnameBase])})),c,o);return r&&A?b.createElement(dS.Provider,{value:{location:dy({pathname:"/",search:"",hash:"",state:null,key:"default"},_),navigationType:Ou.Pop}},A):A}function Vae(){let e=qae(),r=kae(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),o=e instanceof Error?e.stack:null,c={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},d=null;return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},r),o?b.createElement("pre",{style:c},o):null,d)}const $ae=b.createElement(Vae,null);class Hae extends b.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,o){return o.location!==r.location||o.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error||o.error,location:o.location,revalidation:r.revalidation||o.revalidation}}componentDidCatch(r,o){console.error("React Router caught the following error during render",r,o)}render(){return this.state.error?b.createElement(_f.Provider,{value:this.props.routeContext},b.createElement(JV.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Wae(e){let{routeContext:r,match:o,children:s}=e,c=b.useContext(ex);return c&&c.static&&c.staticContext&&(o.route.errorElement||o.route.ErrorBoundary)&&(c.staticContext._deepestRenderedBoundaryId=o.route.id),b.createElement(_f.Provider,{value:r},s)}function Gae(e,r,o){var s;if(r===void 0&&(r=[]),o===void 0&&(o=null),e==null){var c;if((c=o)!=null&&c.errors)e=o.matches;else return null}let d=e,f=(s=o)==null?void 0:s.errors;if(f!=null){let m=d.findIndex(g=>g.route.id&&(f==null?void 0:f[g.route.id]));m>=0||Mi(!1),d=d.slice(0,Math.min(d.length,m+1))}return d.reduceRight((m,g,_)=>{let S=g.route.id?f==null?void 0:f[g.route.id]:null,T=null;o&&(T=g.route.errorElement||$ae);let R=r.concat(d.slice(0,_+1)),N=()=>{let A;return S?A=T:g.route.Component?A=b.createElement(g.route.Component,null):g.route.element?A=g.route.element:A=m,b.createElement(Wae,{match:g,routeContext:{outlet:m,matches:R,isDataRoute:o!=null},children:A})};return o&&(g.route.ErrorBoundary||g.route.errorElement||_===0)?b.createElement(Hae,{location:o.location,revalidation:o.revalidation,component:T,error:S,children:N(),routeContext:{outlet:null,matches:R,isDataRoute:!0}}):N()},null)}var e$=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(e$||{}),hy=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(hy||{});function zae(e){let r=b.useContext(ex);return r||Mi(!1),r}function Kae(e){let r=b.useContext(Mae);return r||Mi(!1),r}function Yae(e){let r=b.useContext(_f);return r||Mi(!1),r}function t$(e){let r=Yae(),o=r.matches[r.matches.length-1];return o.route.id||Mi(!1),o.route.id}function qae(){var e;let r=b.useContext(JV),o=Kae(hy.UseRouteError),s=t$(hy.UseRouteError);return r||((e=o.errors)==null?void 0:e[s])}function Xae(){let{router:e}=zae(e$.UseNavigateStable),r=t$(hy.UseNavigateStable),o=b.useRef(!1);return ZV(()=>{o.current=!0}),b.useCallback(function(c,d){d===void 0&&(d={}),o.current&&(typeof c=="number"?e.navigate(c):e.navigate(c,dy({fromRouteId:r},d)))},[e,r])}function Pd(e){Mi(!1)}function Jae(e){let{basename:r="/",children:o=null,location:s,navigationType:c=Ou.Pop,navigator:d,static:f=!1}=e;hS()&&Mi(!1);let m=r.replace(/^\/*/,"/"),g=b.useMemo(()=>({basename:m,navigator:d,static:f}),[m,d,f]);typeof s=="string"&&(s=oh(s));let{pathname:_="/",search:S="",hash:T="",state:R=null,key:N="default"}=s,A=b.useMemo(()=>{let O=qV(_,m);return O==null?null:{location:{pathname:O,search:S,hash:T,state:R,key:N},navigationType:c}},[m,_,S,T,R,N,c]);return A==null?null:b.createElement(uS.Provider,{value:g},b.createElement(dS.Provider,{children:o,value:A}))}function Qae(e){let{children:r,location:o}=e;return Bae(zI(r),o)}new Promise(()=>{});function zI(e,r){r===void 0&&(r=[]);let o=[];return b.Children.forEach(e,(s,c)=>{if(!b.isValidElement(s))return;let d=[...r,c];if(s.type===b.Fragment){o.push.apply(o,zI(s.props.children,d));return}s.type!==Pd&&Mi(!1),!s.props.index||!s.props.children||Mi(!1);let f={id:s.props.id||d.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(f.children=zI(s.props.children,d)),o.push(f)}),o}/**
 * React Router DOM v6.16.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const Zae="startTransition",J3=Yd[Zae];function ese(e){let{basename:r,children:o,future:s,window:c}=e,d=b.useRef();d.current==null&&(d.current=lae({window:c,v5Compat:!0}));let f=d.current,[m,g]=b.useState({action:f.action,location:f.location}),{v7_startTransition:_}=s||{},S=b.useCallback(T=>{_&&J3?J3(()=>g(T)):g(T)},[g,_]);return b.useLayoutEffect(()=>f.listen(S),[f,S]),b.createElement(Jae,{basename:r,children:o,location:m.location,navigationType:m.action,navigator:f})}var Q3;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(Q3||(Q3={}));var Z3;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Z3||(Z3={}));function Ts(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Fn(e){"@babel/helpers - typeof";return Fn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Fn(e)}function tse(e,r){if(Fn(e)!=="object"||e===null)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var s=o.call(e,r||"default");if(Fn(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function n$(e){var r=tse(e,"string");return Fn(r)==="symbol"?r:String(r)}function e5(e,r){for(var o=0;o<r.length;o++){var s=r[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,n$(s.key),s)}}function Rs(e,r,o){return r&&e5(e.prototype,r),o&&e5(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function KI(e,r){return KI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,c){return s.__proto__=c,s},KI(e,r)}function yf(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&KI(e,r)}function py(e){return py=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},py(e)}function nse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fy(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rse(e,r){if(r&&(Fn(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fy(e)}function Sf(e){var r=nse();return function(){var s=py(e),c;if(r){var d=py(this).constructor;c=Reflect.construct(s,arguments,d)}else c=s.apply(this,arguments);return rse(this,c)}}var r$={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var r={}.hasOwnProperty;function o(){for(var s=[],c=0;c<arguments.length;c++){var d=arguments[c];if(d){var f=typeof d;if(f==="string"||f==="number")s.push(d);else if(Array.isArray(d)){if(d.length){var m=o.apply(null,d);m&&s.push(m)}}else if(f==="object"){if(d.toString!==Object.prototype.toString&&!d.toString.toString().includes("[native code]")){s.push(d.toString());continue}for(var g in d)r.call(d,g)&&d[g]&&s.push(g)}}}return s.join(" ")}e.exports?(o.default=o,e.exports=o):window.classNames=o})()})(r$);var ise=r$.exports;const Xe=Ol(ise);function Ze(){return Ze=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},Ze.apply(this,arguments)}var i$={exports:{}},ar={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tx=Symbol.for("react.element"),nx=Symbol.for("react.portal"),pS=Symbol.for("react.fragment"),fS=Symbol.for("react.strict_mode"),mS=Symbol.for("react.profiler"),gS=Symbol.for("react.provider"),vS=Symbol.for("react.context"),ose=Symbol.for("react.server_context"),ES=Symbol.for("react.forward_ref"),_S=Symbol.for("react.suspense"),yS=Symbol.for("react.suspense_list"),SS=Symbol.for("react.memo"),CS=Symbol.for("react.lazy"),ase=Symbol.for("react.offscreen"),o$;o$=Symbol.for("react.module.reference");function ws(e){if(typeof e=="object"&&e!==null){var r=e.$$typeof;switch(r){case tx:switch(e=e.type,e){case pS:case mS:case fS:case _S:case yS:return e;default:switch(e=e&&e.$$typeof,e){case ose:case vS:case ES:case CS:case SS:case gS:return e;default:return r}}case nx:return r}}}ar.ContextConsumer=vS;ar.ContextProvider=gS;ar.Element=tx;ar.ForwardRef=ES;ar.Fragment=pS;ar.Lazy=CS;ar.Memo=SS;ar.Portal=nx;ar.Profiler=mS;ar.StrictMode=fS;ar.Suspense=_S;ar.SuspenseList=yS;ar.isAsyncMode=function(){return!1};ar.isConcurrentMode=function(){return!1};ar.isContextConsumer=function(e){return ws(e)===vS};ar.isContextProvider=function(e){return ws(e)===gS};ar.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===tx};ar.isForwardRef=function(e){return ws(e)===ES};ar.isFragment=function(e){return ws(e)===pS};ar.isLazy=function(e){return ws(e)===CS};ar.isMemo=function(e){return ws(e)===SS};ar.isPortal=function(e){return ws(e)===nx};ar.isProfiler=function(e){return ws(e)===mS};ar.isStrictMode=function(e){return ws(e)===fS};ar.isSuspense=function(e){return ws(e)===_S};ar.isSuspenseList=function(e){return ws(e)===yS};ar.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===pS||e===mS||e===fS||e===_S||e===yS||e===ase||typeof e=="object"&&e!==null&&(e.$$typeof===CS||e.$$typeof===SS||e.$$typeof===gS||e.$$typeof===vS||e.$$typeof===ES||e.$$typeof===o$||e.getModuleId!==void 0)};ar.typeOf=ws;i$.exports=ar;var a$=i$.exports;function Tl(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=[];return St.Children.forEach(e,function(s){s==null&&!r.keepEmpty||(Array.isArray(s)?o=o.concat(Tl(s)):a$.isFragment(s)&&s.props?o=o.concat(Tl(s.props.children,r)):o.push(s))}),o}var YI={},sse=function(r){};function cse(e,r){}function lse(e,r){}function use(){YI={}}function s$(e,r,o){!r&&!YI[o]&&(e(!1,o),YI[o]=!0)}function pa(e,r){s$(cse,e,r)}function dse(e,r){s$(lse,e,r)}pa.preMessage=sse;pa.resetWarned=use;pa.noteOnce=dse;function ct(e,r,o){return r=n$(r),r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function t5(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Oe(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?t5(Object(o),!0).forEach(function(s){ct(e,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t5(Object(o)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(o,s))})}return e}function my(e){return e instanceof HTMLElement||e instanceof SVGElement}function O_(e){return my(e)?e:e instanceof St.Component?GV.findDOMNode(e):null}function bS(e,r,o){var s=b.useRef({});return(!("value"in s.current)||o(s.current.condition,r))&&(s.current.value=e(),s.current.condition=r),s.current.value}function rx(e,r){typeof e=="function"?e(r):Fn(e)==="object"&&e&&"current"in e&&(e.current=r)}function jc(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];var s=r.filter(function(c){return c});return s.length<=1?s[0]:function(c){r.forEach(function(d){rx(d,c)})}}function TS(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return bS(function(){return jc.apply(void 0,r)},r,function(s,c){return s.length!==c.length||s.every(function(d,f){return d!==c[f]})})}function Cf(e){var r,o,s=a$.isMemo(e)?e.type.type:e.type;return!(typeof s=="function"&&!((r=s.prototype)!==null&&r!==void 0&&r.render)||typeof e=="function"&&!((o=e.prototype)!==null&&o!==void 0&&o.render))}var qI=b.createContext(null);function hse(e){var r=e.children,o=e.onBatchResize,s=b.useRef(0),c=b.useRef([]),d=b.useContext(qI),f=b.useCallback(function(m,g,_){s.current+=1;var S=s.current;c.current.push({size:m,element:g,data:_}),Promise.resolve().then(function(){S===s.current&&(o==null||o(c.current),c.current=[])}),d==null||d(m,g,_)},[o,d]);return b.createElement(qI.Provider,{value:f},r)}var c$=function(){if(typeof Map<"u")return Map;function e(r,o){var s=-1;return r.some(function(c,d){return c[0]===o?(s=d,!0):!1}),s}return function(){function r(){this.__entries__=[]}return Object.defineProperty(r.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),r.prototype.get=function(o){var s=e(this.__entries__,o),c=this.__entries__[s];return c&&c[1]},r.prototype.set=function(o,s){var c=e(this.__entries__,o);~c?this.__entries__[c][1]=s:this.__entries__.push([o,s])},r.prototype.delete=function(o){var s=this.__entries__,c=e(s,o);~c&&s.splice(c,1)},r.prototype.has=function(o){return!!~e(this.__entries__,o)},r.prototype.clear=function(){this.__entries__.splice(0)},r.prototype.forEach=function(o,s){s===void 0&&(s=null);for(var c=0,d=this.__entries__;c<d.length;c++){var f=d[c];o.call(s,f[1],f[0])}},r}()}(),XI=typeof window<"u"&&typeof document<"u"&&window.document===document,gy=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),pse=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(gy):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}(),fse=2;function mse(e,r){var o=!1,s=!1,c=0;function d(){o&&(o=!1,e()),s&&m()}function f(){pse(d)}function m(){var g=Date.now();if(o){if(g-c<fse)return;s=!0}else o=!0,s=!1,setTimeout(f,r);c=g}return m}var gse=20,vse=["top","right","bottom","left","width","height","size","weight"],Ese=typeof MutationObserver<"u",_se=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=mse(this.refresh.bind(this),gse)}return e.prototype.addObserver=function(r){~this.observers_.indexOf(r)||this.observers_.push(r),this.connected_||this.connect_()},e.prototype.removeObserver=function(r){var o=this.observers_,s=o.indexOf(r);~s&&o.splice(s,1),!o.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){var r=this.updateObservers_();r&&this.refresh()},e.prototype.updateObservers_=function(){var r=this.observers_.filter(function(o){return o.gatherActive(),o.hasActive()});return r.forEach(function(o){return o.broadcastActive()}),r.length>0},e.prototype.connect_=function(){!XI||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Ese?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!XI||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(r){var o=r.propertyName,s=o===void 0?"":o,c=vse.some(function(d){return!!~s.indexOf(d)});c&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),l$=function(e,r){for(var o=0,s=Object.keys(r);o<s.length;o++){var c=s[o];Object.defineProperty(e,c,{value:r[c],enumerable:!1,writable:!1,configurable:!0})}return e},af=function(e){var r=e&&e.ownerDocument&&e.ownerDocument.defaultView;return r||gy},u$=RS(0,0,0,0);function vy(e){return parseFloat(e)||0}function n5(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return r.reduce(function(s,c){var d=e["border-"+c+"-width"];return s+vy(d)},0)}function yse(e){for(var r=["top","right","bottom","left"],o={},s=0,c=r;s<c.length;s++){var d=c[s],f=e["padding-"+d];o[d]=vy(f)}return o}function Sse(e){var r=e.getBBox();return RS(0,0,r.width,r.height)}function Cse(e){var r=e.clientWidth,o=e.clientHeight;if(!r&&!o)return u$;var s=af(e).getComputedStyle(e),c=yse(s),d=c.left+c.right,f=c.top+c.bottom,m=vy(s.width),g=vy(s.height);if(s.boxSizing==="border-box"&&(Math.round(m+d)!==r&&(m-=n5(s,"left","right")+d),Math.round(g+f)!==o&&(g-=n5(s,"top","bottom")+f)),!Tse(e)){var _=Math.round(m+d)-r,S=Math.round(g+f)-o;Math.abs(_)!==1&&(m-=_),Math.abs(S)!==1&&(g-=S)}return RS(c.left,c.top,m,g)}var bse=function(){return typeof SVGGraphicsElement<"u"?function(e){return e instanceof af(e).SVGGraphicsElement}:function(e){return e instanceof af(e).SVGElement&&typeof e.getBBox=="function"}}();function Tse(e){return e===af(e).document.documentElement}function Rse(e){return XI?bse(e)?Sse(e):Cse(e):u$}function wse(e){var r=e.x,o=e.y,s=e.width,c=e.height,d=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,f=Object.create(d.prototype);return l$(f,{x:r,y:o,width:s,height:c,top:o,right:r+s,bottom:c+o,left:r}),f}function RS(e,r,o,s){return{x:e,y:r,width:o,height:s}}var Ise=function(){function e(r){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=RS(0,0,0,0),this.target=r}return e.prototype.isActive=function(){var r=Rse(this.target);return this.contentRect_=r,r.width!==this.broadcastWidth||r.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var r=this.contentRect_;return this.broadcastWidth=r.width,this.broadcastHeight=r.height,r},e}(),Ase=function(){function e(r,o){var s=wse(o);l$(this,{target:r,contentRect:s})}return e}(),Ose=function(){function e(r,o,s){if(this.activeObservations_=[],this.observations_=new c$,typeof r!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=r,this.controller_=o,this.callbackCtx_=s}return e.prototype.observe=function(r){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(r instanceof af(r).Element))throw new TypeError('parameter 1 is not of type "Element".');var o=this.observations_;o.has(r)||(o.set(r,new Ise(r)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(r){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(r instanceof af(r).Element))throw new TypeError('parameter 1 is not of type "Element".');var o=this.observations_;o.has(r)&&(o.delete(r),o.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var r=this;this.clearActive(),this.observations_.forEach(function(o){o.isActive()&&r.activeObservations_.push(o)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var r=this.callbackCtx_,o=this.activeObservations_.map(function(s){return new Ase(s.target,s.broadcastRect())});this.callback_.call(r,o,r),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),d$=typeof WeakMap<"u"?new WeakMap:new c$,h$=function(){function e(r){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var o=_se.getInstance(),s=new Ose(r,o,this);d$.set(this,s)}return e}();["observe","unobserve","disconnect"].forEach(function(e){h$.prototype[e]=function(){var r;return(r=d$.get(this))[e].apply(r,arguments)}});var xse=function(){return typeof gy.ResizeObserver<"u"?gy.ResizeObserver:h$}(),xu=new Map;function Nse(e){e.forEach(function(r){var o,s=r.target;(o=xu.get(s))===null||o===void 0||o.forEach(function(c){return c(s)})})}var p$=new xse(Nse);function Pse(e,r){xu.has(e)||(xu.set(e,new Set),p$.observe(e)),xu.get(e).add(r)}function Dse(e,r){xu.has(e)&&(xu.get(e).delete(r),xu.get(e).size||(p$.unobserve(e),xu.delete(e)))}var kse=function(e){yf(o,e);var r=Sf(o);function o(){return Ts(this,o),r.apply(this,arguments)}return Rs(o,[{key:"render",value:function(){return this.props.children}}]),o}(b.Component);function Lse(e,r){var o=e.children,s=e.disabled,c=b.useRef(null),d=b.useRef(null),f=b.useContext(qI),m=typeof o=="function",g=m?o(c):o,_=b.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),S=!m&&b.isValidElement(g)&&Cf(g),T=S?g.ref:null,R=TS(T,c),N=function(){var x;return O_(c.current)||(c.current&&Fn(c.current)==="object"?O_((x=c.current)===null||x===void 0?void 0:x.nativeElement):null)||O_(d.current)};b.useImperativeHandle(r,function(){return N()});var A=b.useRef(e);A.current=e;var O=b.useCallback(function(M){var x=A.current,P=x.onResize,D=x.data,F=M.getBoundingClientRect(),$=F.width,V=F.height,W=M.offsetWidth,K=M.offsetHeight,Q=Math.floor($),Y=Math.floor(V);if(_.current.width!==Q||_.current.height!==Y||_.current.offsetWidth!==W||_.current.offsetHeight!==K){var ee={width:Q,height:Y,offsetWidth:W,offsetHeight:K};_.current=ee;var te=W===Math.round($)?$:W,ie=K===Math.round(V)?V:K,le=Oe(Oe({},ee),{},{offsetWidth:te,offsetHeight:ie});f==null||f(le,M,D),P&&Promise.resolve().then(function(){P(le,M)})}},[]);return b.useEffect(function(){var M=N();return M&&!s&&Pse(M,O),function(){return Dse(M,O)}},[c.current,s]),b.createElement(kse,{ref:d},S?b.cloneElement(g,{ref:R}):g)}var Mse=b.forwardRef(Lse),Fse="rc-observer-key";function Use(e,r){var o=e.children,s=typeof o=="function"?[o]:Tl(o);return s.map(function(c,d){var f=(c==null?void 0:c.key)||"".concat(Fse,"-").concat(d);return b.createElement(Mse,Ze({},e,{key:f,ref:d===0?r:void 0}),c)})}var ah=b.forwardRef(Use);ah.Collection=hse;function ma(e,r){var o=Oe({},e);return Array.isArray(r)&&r.forEach(function(s){delete o[s]}),o}function JI(e,r){(r==null||r>e.length)&&(r=e.length);for(var o=0,s=new Array(r);o<r;o++)s[o]=e[o];return s}function Bse(e){if(Array.isArray(e))return JI(e)}function f$(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ix(e,r){if(e){if(typeof e=="string")return JI(e,r);var o=Object.prototype.toString.call(e).slice(8,-1);if(o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set")return Array.from(e);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return JI(e,r)}}function jse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function at(e){return Bse(e)||f$(e)||ix(e)||jse()}var m$=function(r){return+setTimeout(r,16)},g$=function(r){return clearTimeout(r)};typeof window<"u"&&"requestAnimationFrame"in window&&(m$=function(r){return window.requestAnimationFrame(r)},g$=function(r){return window.cancelAnimationFrame(r)});var r5=0,ox=new Map;function v$(e){ox.delete(e)}var ao=function(r){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;r5+=1;var s=r5;function c(d){if(d===0)v$(s),r();else{var f=m$(function(){c(d-1)});ox.set(s,f)}}return c(o),s};ao.cancel=function(e){var r=ox.get(e);return v$(r),g$(r)};function ax(e){for(var r=0,o,s=0,c=e.length;c>=4;++s,c-=4)o=e.charCodeAt(s)&255|(e.charCodeAt(++s)&255)<<8|(e.charCodeAt(++s)&255)<<16|(e.charCodeAt(++s)&255)<<24,o=(o&65535)*1540483477+((o>>>16)*59797<<16),o^=o>>>24,r=(o&65535)*1540483477+((o>>>16)*59797<<16)^(r&65535)*1540483477+((r>>>16)*59797<<16);switch(c){case 3:r^=(e.charCodeAt(s+2)&255)<<16;case 2:r^=(e.charCodeAt(s+1)&255)<<8;case 1:r^=e.charCodeAt(s)&255,r=(r&65535)*1540483477+((r>>>16)*59797<<16)}return r^=r>>>13,r=(r&65535)*1540483477+((r>>>16)*59797<<16),((r^r>>>15)>>>0).toString(36)}function Vse(e,r){if(e==null)return{};var o={},s=Object.keys(e),c,d;for(d=0;d<s.length;d++)c=s[d],!(r.indexOf(c)>=0)&&(o[c]=e[c]);return o}function An(e,r){if(e==null)return{};var o=Vse(e,r),s,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)s=d[c],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(o[s]=e[s])}return o}function wS(e,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=new Set;function c(d,f){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,g=s.has(d);if(pa(!g,"Warning: There may be circular references"),g)return!1;if(d===f)return!0;if(o&&m>1)return!1;s.add(d);var _=m+1;if(Array.isArray(d)){if(!Array.isArray(f)||d.length!==f.length)return!1;for(var S=0;S<d.length;S++)if(!c(d[S],f[S],_))return!1;return!0}if(d&&f&&Fn(d)==="object"&&Fn(f)==="object"){var T=Object.keys(d);return T.length!==Object.keys(f).length?!1:T.every(function(R){return c(d[R],f[R],_)})}return!1}return c(e,r)}var i5="%",$se=function(){function e(r){Ts(this,e),ct(this,"instanceId",void 0),ct(this,"cache",new Map),this.instanceId=r}return Rs(e,[{key:"get",value:function(o){return this.cache.get(o.join(i5))||null}},{key:"update",value:function(o,s){var c=o.join(i5),d=this.cache.get(c),f=s(d);f===null?this.cache.delete(c):this.cache.set(c,f)}}]),e}(),QI="data-token-hash",Wd="data-css-hash",Vp="__cssinjs_instance__";function Hse(){var e=Math.random().toString(12).slice(2);if(typeof document<"u"&&document.head&&document.body){var r=document.body.querySelectorAll("style[".concat(Wd,"]"))||[],o=document.head.firstChild;Array.from(r).forEach(function(c){c[Vp]=c[Vp]||e,c[Vp]===e&&document.head.insertBefore(c,o)});var s={};Array.from(document.querySelectorAll("style[".concat(Wd,"]"))).forEach(function(c){var d=c.getAttribute(Wd);if(s[d]){if(c[Vp]===e){var f;(f=c.parentNode)===null||f===void 0||f.removeChild(c)}}else s[d]=!0})}return new $se(e)}var Wse=b.createContext({hashPriority:"low",cache:Hse(),defaultCache:!0});const sx=Wse;function Io(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function Gse(e,r){if(!e)return!1;if(e.contains)return e.contains(r);for(var o=r;o;){if(o===e)return!0;o=o.parentNode}return!1}var o5="data-rc-order",a5="data-rc-priority",zse="rc-util-key",ZI=new Map;function E$(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.mark;return r?r.startsWith("data-")?r:"data-".concat(r):zse}function IS(e){if(e.attachTo)return e.attachTo;var r=document.querySelector("head");return r||document.body}function Kse(e){return e==="queue"?"prependQueue":e?"prepend":"append"}function _$(e){return Array.from((ZI.get(e)||e).children).filter(function(r){return r.tagName==="STYLE"})}function y$(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Io())return null;var o=r.csp,s=r.prepend,c=r.priority,d=c===void 0?0:c,f=Kse(s),m=f==="prependQueue",g=document.createElement("style");g.setAttribute(o5,f),m&&d&&g.setAttribute(a5,"".concat(d)),o!=null&&o.nonce&&(g.nonce=o==null?void 0:o.nonce),g.innerHTML=e;var _=IS(r),S=_.firstChild;if(s){if(m){var T=_$(_).filter(function(R){if(!["prepend","prependQueue"].includes(R.getAttribute(o5)))return!1;var N=Number(R.getAttribute(a5)||0);return d>=N});if(T.length)return _.insertBefore(g,T[T.length-1].nextSibling),g}_.insertBefore(g,S)}else _.appendChild(g);return g}function S$(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=IS(r);return _$(o).find(function(s){return s.getAttribute(E$(r))===e})}function Ey(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=S$(e,r);if(o){var s=IS(r);s.removeChild(o)}}function Yse(e,r){var o=ZI.get(e);if(!o||!Gse(document,o)){var s=y$("",r),c=s.parentNode;ZI.set(e,c),e.removeChild(s)}}function zm(e,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=IS(o);Yse(s,o);var c=S$(r,o);if(c){var d,f;if((d=o.csp)!==null&&d!==void 0&&d.nonce&&c.nonce!==((f=o.csp)===null||f===void 0?void 0:f.nonce)){var m;c.nonce=(m=o.csp)===null||m===void 0?void 0:m.nonce}return c.innerHTML!==e&&(c.innerHTML=e),c}var g=y$(e,o);return g.setAttribute(E$(o),r),g}function C$(e){if(Array.isArray(e))return e}function qse(e,r){var o=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(o!=null){var s,c,d,f,m=[],g=!0,_=!1;try{if(d=(o=o.call(e)).next,r===0){if(Object(o)!==o)return;g=!1}else for(;!(g=(s=d.call(o)).done)&&(m.push(s.value),m.length!==r);g=!0);}catch(S){_=!0,c=S}finally{try{if(!g&&o.return!=null&&(f=o.return(),Object(f)!==f))return}finally{if(_)throw c}}return m}}function b$(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ge(e,r){return C$(e)||qse(e,r)||ix(e,r)||b$()}function Xse(e,r){if(e.length!==r.length)return!1;for(var o=0;o<e.length;o++)if(e[o]!==r[o])return!1;return!0}var cx=function(){function e(){Ts(this,e),ct(this,"cache",void 0),ct(this,"keys",void 0),ct(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return Rs(e,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(o){var s,c,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,f={map:this.cache};return o.forEach(function(m){if(!f)f=void 0;else{var g,_;f=(g=f)===null||g===void 0||(_=g.map)===null||_===void 0?void 0:_.get(m)}}),(s=f)!==null&&s!==void 0&&s.value&&d&&(f.value[1]=this.cacheCallTimes++),(c=f)===null||c===void 0?void 0:c.value}},{key:"get",value:function(o){var s;return(s=this.internalGet(o,!0))===null||s===void 0?void 0:s[0]}},{key:"has",value:function(o){return!!this.internalGet(o)}},{key:"set",value:function(o,s){var c=this;if(!this.has(o)){if(this.size()+1>e.MAX_CACHE_SIZE+e.MAX_CACHE_OFFSET){var d=this.keys.reduce(function(_,S){var T=Ge(_,2),R=T[1];return c.internalGet(S)[1]<R?[S,c.internalGet(S)[1]]:_},[this.keys[0],this.cacheCallTimes]),f=Ge(d,1),m=f[0];this.delete(m)}this.keys.push(o)}var g=this.cache;o.forEach(function(_,S){if(S===o.length-1)g.set(_,{value:[s,c.cacheCallTimes++]});else{var T=g.get(_);T?T.map||(T.map=new Map):g.set(_,{map:new Map}),g=g.get(_).map}})}},{key:"deleteByPath",value:function(o,s){var c=o.get(s[0]);if(s.length===1){var d;return c.map?o.set(s[0],{map:c.map}):o.delete(s[0]),(d=c.value)===null||d===void 0?void 0:d[0]}var f=this.deleteByPath(c.map,s.slice(1));return(!c.map||c.map.size===0)&&!c.value&&o.delete(s[0]),f}},{key:"delete",value:function(o){if(this.has(o))return this.keys=this.keys.filter(function(s){return!Xse(s,o)}),this.deleteByPath(this.cache,o)}}]),e}();ct(cx,"MAX_CACHE_SIZE",20);ct(cx,"MAX_CACHE_OFFSET",5);var s5=0,T$=function(){function e(r){Ts(this,e),ct(this,"derivatives",void 0),ct(this,"id",void 0),this.derivatives=Array.isArray(r)?r:[r],this.id=s5,r.length===0&&(r.length>0,void 0),s5+=1}return Rs(e,[{key:"getDerivativeToken",value:function(o){return this.derivatives.reduce(function(s,c){return c(o,s)},void 0)}}]),e}(),R1=new cx;function _y(e){var r=Array.isArray(e)?e:[e];return R1.has(r)||R1.set(r,new T$(r)),R1.get(r)}var Jse=new WeakMap,w1={};function Qse(e,r){for(var o=Jse,s=0;s<r.length;s+=1){var c=r[s];o.has(c)||o.set(c,new WeakMap),o=o.get(c)}return o.has(w1)||o.set(w1,e()),o.get(w1)}var c5=new WeakMap;function yy(e){var r=c5.get(e)||"";return r||(Object.keys(e).forEach(function(o){var s=e[o];r+=o,s instanceof T$?r+=s.id:s&&Fn(s)==="object"?r+=yy(s):r+=s}),c5.set(e,r)),r}function Zse(e,r){return ax("".concat(r,"_").concat(yy(e)))}var Em="random-".concat(Date.now(),"-").concat(Math.random()).replace(/\./g,""),R$="_bAmBoO_";function ece(e,r,o){if(Io()){var s,c;zm(e,Em);var d=document.createElement("div");d.style.position="fixed",d.style.left="0",d.style.top="0",r==null||r(d),document.body.appendChild(d);var f=o?o(d):(s=getComputedStyle(d).content)===null||s===void 0?void 0:s.includes(R$);return(c=d.parentNode)===null||c===void 0||c.removeChild(d),Ey(Em),f}return!1}var I1=void 0;function tce(){return I1===void 0&&(I1=ece("@layer ".concat(Em," { .").concat(Em,' { content: "').concat(R$,'"!important; } }'),function(e){e.className=Em})),I1}var l5=Io()?b.useLayoutEffect:b.useEffect,qr=function(r,o){var s=b.useRef(!0);l5(function(){return r(s.current)},o),l5(function(){return s.current=!1,function(){s.current=!0}},[])},u5=function(r,o){qr(function(s){if(!s)return r()},o)},nce=Oe({},Yd),d5=nce.useInsertionEffect,rce=function(r,o,s){b.useMemo(r,s),qr(function(){return o(!0)},s)},ice=d5?function(e,r,o){return d5(function(){return e(),r()},o)}:rce;const oce=ice;var ace=Oe({},Yd),sce=ace.useInsertionEffect,cce=function(r){var o=[],s=!1;function c(d){s||o.push(d)}return b.useEffect(function(){return s=!1,function(){s=!0,o.length&&o.forEach(function(d){return d()})}},r),c},lce=function(){return function(r){r()}},uce=typeof sce<"u"?cce:lce;const dce=uce;function w$(e,r,o,s,c){var d=b.useContext(sx),f=d.cache,m=[e].concat(at(r)),g=m.join("_"),_=dce([g]),S=function(A){f.update(m,function(O){var M=O||[],x=Ge(M,2),P=x[0],D=P===void 0?0:P,F=x[1],$=F,V=$||o(),W=[D,V];return A?A(W):W})};b.useMemo(function(){S()},[g]);var T=f.get(m),R=T[1];return oce(function(){c==null||c(R)},function(N){return S(function(A){var O=Ge(A,2),M=O[0],x=O[1];return N&&M===0&&(c==null||c(R)),[M+1,x]}),function(){f.update(m,function(A){var O=A||[],M=Ge(O,2),x=M[0],P=x===void 0?0:x,D=M[1],F=P-1;return F===0?(_(function(){return s==null?void 0:s(D,!1)}),null):[P-1,D]})}},[g]),R}var hce={},pce="css",kd=new Map;function fce(e){kd.set(e,(kd.get(e)||0)+1)}function mce(e,r){if(typeof document<"u"){var o=document.querySelectorAll("style[".concat(QI,'="').concat(e,'"]'));o.forEach(function(s){if(s[Vp]===r){var c;(c=s.parentNode)===null||c===void 0||c.removeChild(s)}})}}var gce=0;function vce(e,r){kd.set(e,(kd.get(e)||0)-1);var o=Array.from(kd.keys()),s=o.filter(function(c){var d=kd.get(c)||0;return d<=0});o.length-s.length>gce&&s.forEach(function(c){mce(c,r),kd.delete(c)})}var I$=function(r,o,s,c){var d=s.getDerivativeToken(r),f=Oe(Oe({},d),o);return c&&(f=c(f)),f};function Ece(e,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=b.useContext(sx),c=s.cache.instanceId,d=o.salt,f=d===void 0?"":d,m=o.override,g=m===void 0?hce:m,_=o.formatToken,S=o.getComputedToken,T=Qse(function(){return Object.assign.apply(Object,[{}].concat(at(r)))},r),R=yy(T),N=yy(g),A=w$("token",[f,e.id,R,N],function(){var O=S?S(T,g,e):I$(T,g,e,_),M=Zse(O,f);O._tokenKey=M,fce(M);var x="".concat(pce,"-").concat(ax(M));return O._hashId=x,[O,x]},function(O){vce(O[0]._tokenKey,c)});return A}var _ce={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},A$="comm",O$="rule",x$="decl",yce="@import",Sce="@keyframes",Cce="@layer",bce=Math.abs,lx=String.fromCharCode;function N$(e){return e.trim()}function x_(e,r,o){return e.replace(r,o)}function Tce(e,r){return e.indexOf(r)}function Km(e,r){return e.charCodeAt(r)|0}function Ym(e,r,o){return e.slice(r,o)}function pl(e){return e.length}function Rce(e){return e.length}function KE(e,r){return r.push(e),e}var AS=1,sf=1,P$=0,Ss=0,bi=0,bf="";function ux(e,r,o,s,c,d,f,m){return{value:e,root:r,parent:o,type:s,props:c,children:d,line:AS,column:sf,length:f,return:"",siblings:m}}function wce(){return bi}function Ice(){return bi=Ss>0?Km(bf,--Ss):0,sf--,bi===10&&(sf=1,AS--),bi}function Zs(){return bi=Ss<P$?Km(bf,Ss++):0,sf++,bi===10&&(sf=1,AS++),bi}function Gd(){return Km(bf,Ss)}function N_(){return Ss}function OS(e,r){return Ym(bf,e,r)}function eA(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Ace(e){return AS=sf=1,P$=pl(bf=e),Ss=0,[]}function Oce(e){return bf="",e}function A1(e){return N$(OS(Ss-1,tA(e===91?e+2:e===40?e+1:e)))}function xce(e){for(;(bi=Gd())&&bi<33;)Zs();return eA(e)>2||eA(bi)>3?"":" "}function Nce(e,r){for(;--r&&Zs()&&!(bi<48||bi>102||bi>57&&bi<65||bi>70&&bi<97););return OS(e,N_()+(r<6&&Gd()==32&&Zs()==32))}function tA(e){for(;Zs();)switch(bi){case e:return Ss;case 34:case 39:e!==34&&e!==39&&tA(bi);break;case 40:e===41&&tA(e);break;case 92:Zs();break}return Ss}function Pce(e,r){for(;Zs()&&e+bi!==47+10;)if(e+bi===42+42&&Gd()===47)break;return"/*"+OS(r,Ss-1)+"*"+lx(e===47?e:Zs())}function Dce(e){for(;!eA(Gd());)Zs();return OS(e,Ss)}function kce(e){return Oce(P_("",null,null,null,[""],e=Ace(e),0,[0],e))}function P_(e,r,o,s,c,d,f,m,g){for(var _=0,S=0,T=f,R=0,N=0,A=0,O=1,M=1,x=1,P=0,D="",F=c,$=d,V=s,W=D;M;)switch(A=P,P=Zs()){case 40:if(A!=108&&Km(W,T-1)==58){Tce(W+=x_(A1(P),"&","&\f"),"&\f")!=-1&&(x=-1);break}case 34:case 39:case 91:W+=A1(P);break;case 9:case 10:case 13:case 32:W+=xce(A);break;case 92:W+=Nce(N_()-1,7);continue;case 47:switch(Gd()){case 42:case 47:KE(Lce(Pce(Zs(),N_()),r,o,g),g);break;default:W+="/"}break;case 123*O:m[_++]=pl(W)*x;case 125*O:case 59:case 0:switch(P){case 0:case 125:M=0;case 59+S:x==-1&&(W=x_(W,/\f/g,"")),N>0&&pl(W)-T&&KE(N>32?p5(W+";",s,o,T-1,g):p5(x_(W," ","")+";",s,o,T-2,g),g);break;case 59:W+=";";default:if(KE(V=h5(W,r,o,_,S,c,m,D,F=[],$=[],T,d),d),P===123)if(S===0)P_(W,r,V,V,F,d,T,m,$);else switch(R===99&&Km(W,3)===110?100:R){case 100:case 108:case 109:case 115:P_(e,V,V,s&&KE(h5(e,V,V,0,0,c,m,D,c,F=[],T,$),$),c,$,T,m,s?F:$);break;default:P_(W,V,V,V,[""],$,0,m,$)}}_=S=N=0,O=x=1,D=W="",T=f;break;case 58:T=1+pl(W),N=A;default:if(O<1){if(P==123)--O;else if(P==125&&O++==0&&Ice()==125)continue}switch(W+=lx(P),P*O){case 38:x=S>0?1:(W+="\f",-1);break;case 44:m[_++]=(pl(W)-1)*x,x=1;break;case 64:Gd()===45&&(W+=A1(Zs())),R=Gd(),S=T=pl(D=W+=Dce(N_())),P++;break;case 45:A===45&&pl(W)==2&&(O=0)}}return d}function h5(e,r,o,s,c,d,f,m,g,_,S,T){for(var R=c-1,N=c===0?d:[""],A=Rce(N),O=0,M=0,x=0;O<s;++O)for(var P=0,D=Ym(e,R+1,R=bce(M=f[O])),F=e;P<A;++P)(F=N$(M>0?N[P]+" "+D:x_(D,/&\f/g,N[P])))&&(g[x++]=F);return ux(e,r,o,c===0?O$:m,g,_,S,T)}function Lce(e,r,o,s){return ux(e,r,o,A$,lx(wce()),Ym(e,2,-2),0,s)}function p5(e,r,o,s,c){return ux(e,r,o,x$,Ym(e,0,s),Ym(e,s+1,-1),s,c)}function nA(e,r){for(var o="",s=0;s<e.length;s++)o+=r(e[s],s,e,r)||"";return o}function Mce(e,r,o,s){switch(e.type){case Cce:if(e.children.length)break;case yce:case x$:return e.return=e.return||e.value;case A$:return"";case Sce:return e.return=e.value+"{"+nA(e.children,s)+"}";case O$:if(!pl(e.value=e.props.join(",")))return""}return pl(o=nA(e.children,s))?e.return=e.value+"{"+o+"}":""}var f5="data-ant-cssinjs-cache-path",D$="_FILE_STYLE__",zd,k$=!0;function Fce(){if(!zd&&(zd={},Io())){var e=document.createElement("div");e.className=f5,e.style.position="fixed",e.style.visibility="hidden",e.style.top="-9999px",document.body.appendChild(e);var r=getComputedStyle(e).content||"";r=r.replace(/^"/,"").replace(/"$/,""),r.split(";").forEach(function(c){var d=c.split(":"),f=Ge(d,2),m=f[0],g=f[1];zd[m]=g});var o=document.querySelector("style[".concat(f5,"]"));if(o){var s;k$=!1,(s=o.parentNode)===null||s===void 0||s.removeChild(o)}document.body.removeChild(e)}}function Uce(e){return Fce(),!!zd[e]}function Bce(e){var r=zd[e],o=null;if(r&&Io())if(k$)o=D$;else{var s=document.querySelector("style[".concat(Wd,'="').concat(zd[e],'"]'));s?o=s.innerHTML:delete zd[e]}return[o,r]}var m5=Io(),jce="_skip_check_",L$="_multi_value_";function g5(e){var r=nA(kce(e),Mce);return r.replace(/\{%%%\:[^;];}/g,";")}function Vce(e){return Fn(e)==="object"&&e&&(jce in e||L$ in e)}function $ce(e,r,o){if(!r)return e;var s=".".concat(r),c=o==="low"?":where(".concat(s,")"):s,d=e.split(",").map(function(f){var m,g=f.trim().split(/\s+/),_=g[0]||"",S=((m=_.match(/^\w+/))===null||m===void 0?void 0:m[0])||"";return _="".concat(S).concat(c).concat(_.slice(S.length)),[_].concat(at(g.slice(1))).join(" ")});return d.join(",")}var Hce=function e(r){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{root:!0,parentSelectors:[]},c=s.root,d=s.injectHash,f=s.parentSelectors,m=o.hashId,g=o.layer;o.path;var _=o.hashPriority,S=o.transformers,T=S===void 0?[]:S;o.linters;var R="",N={};function A(D){var F=D.getName(m);if(!N[F]){var $=e(D.style,o,{root:!1,parentSelectors:f}),V=Ge($,1),W=V[0];N[F]="@keyframes ".concat(D.getName(m)).concat(W)}}function O(D){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return D.forEach(function($){Array.isArray($)?O($,F):$&&F.push($)}),F}var M=O(Array.isArray(r)?r:[r]);if(M.forEach(function(D){var F=typeof D=="string"&&!c?{}:D;if(typeof F=="string")R+="".concat(F,`
`);else if(F._keyframe)A(F);else{var $=T.reduce(function(V,W){var K;return(W==null||(K=W.visit)===null||K===void 0?void 0:K.call(W,V))||V},F);Object.keys($).forEach(function(V){var W=$[V];if(Fn(W)==="object"&&W&&(V!=="animationName"||!W._keyframe)&&!Vce(W)){var K=!1,Q=V.trim(),Y=!1;(c||d)&&m?Q.startsWith("@")?K=!0:Q=$ce(V,m,_):c&&!m&&(Q==="&"||Q==="")&&(Q="",Y=!0);var ee=e(W,o,{root:Y,injectHash:K,parentSelectors:[].concat(at(f),[Q])}),te=Ge(ee,2),ie=te[0],le=te[1];N=Oe(Oe({},N),le),R+="".concat(Q).concat(ie)}else{let ae=function(ge,Se){var de=ge.replace(/[A-Z]/g,function(be){return"-".concat(be.toLowerCase())}),he=Se;!_ce[ge]&&typeof he=="number"&&he!==0&&(he="".concat(he,"px")),ge==="animationName"&&Se!==null&&Se!==void 0&&Se._keyframe&&(A(Se),he=Se.getName(m)),R+="".concat(de,":").concat(he,";")};var se=ae,me,ce=(me=W==null?void 0:W.value)!==null&&me!==void 0?me:W;Fn(W)==="object"&&W!==null&&W!==void 0&&W[L$]&&Array.isArray(ce)?ce.forEach(function(ge){ae(V,ge)}):ae(V,ce)}})}}),!c)R="{".concat(R,"}");else if(g&&tce()){var x=g.split(","),P=x[x.length-1].trim();R="@layer ".concat(P," {").concat(R,"}"),x.length>1&&(R="@layer ".concat(g,"{%%%:%}").concat(R))}return[R,N]};function Wce(e,r){return ax("".concat(e.join("%")).concat(r))}function Gce(){return null}function rA(e,r){var o=e.token,s=e.path,c=e.hashId,d=e.layer,f=e.nonce,m=e.clientOnly,g=e.order,_=g===void 0?0:g,S=b.useContext(sx),T=S.autoClear;S.mock;var R=S.defaultCache,N=S.hashPriority,A=S.container,O=S.ssrInline,M=S.transformers,x=S.linters,P=S.cache,D=o._tokenKey,F=[D].concat(at(s)),$=m5,V=w$("style",F,function(){var ee=F.join("|");if(Uce(ee)){var te=Bce(ee),ie=Ge(te,2),le=ie[0],me=ie[1];if(le)return[le,D,me,{},m,_]}var ce=r(),se=Hce(ce,{hashId:c,hashPriority:N,layer:d,path:s.join("-"),transformers:M,linters:x}),ae=Ge(se,2),ge=ae[0],Se=ae[1],de=g5(ge),he=Wce(F,de);return[de,D,he,Se,m,_]},function(ee,te){var ie=Ge(ee,3),le=ie[2];(te||T)&&m5&&Ey(le,{mark:Wd})},function(ee){var te=Ge(ee,4),ie=te[0];te[1];var le=te[2],me=te[3];if($&&ie!==D$){var ce={mark:Wd,prepend:"queue",attachTo:A,priority:_},se=typeof f=="function"?f():f;se&&(ce.csp={nonce:se});var ae=zm(ie,le,ce);ae[Vp]=P.instanceId,ae.setAttribute(QI,D),Object.keys(me).forEach(function(ge){zm(g5(me[ge]),"_effect-".concat(ge),ce)})}}),W=Ge(V,3),K=W[0],Q=W[1],Y=W[2];return function(ee){var te;if(!O||$||!R)te=b.createElement(Gce,null);else{var ie;te=b.createElement("style",Ze({},(ie={},ct(ie,QI,Q),ct(ie,Wd,Y),ie),{dangerouslySetInnerHTML:{__html:K}}))}return b.createElement(b.Fragment,null,te,ee)}}var Pr=function(){function e(r,o){Ts(this,e),ct(this,"name",void 0),ct(this,"style",void 0),ct(this,"_keyframe",!0),this.name=r,this.style=o}return Rs(e,[{key:"getName",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return o?"".concat(o,"-").concat(this.name):this.name}}]),e}();function fp(e){return e.notSplit=!0,e}fp(["borderTop","borderBottom"]),fp(["borderTop"]),fp(["borderBottom"]),fp(["borderLeft","borderRight"]),fp(["borderLeft"]),fp(["borderRight"]);var zce=b.createContext({});const dx=zce;function Kce(e){return C$(e)||f$(e)||ix(e)||b$()}function Xs(e,r){for(var o=e,s=0;s<r.length;s+=1){if(o==null)return;o=o[r[s]]}return o}function M$(e,r,o,s){if(!r.length)return o;var c=Kce(r),d=c[0],f=c.slice(1),m;return!e&&typeof d=="number"?m=[]:Array.isArray(e)?m=at(e):m=Oe({},e),s&&o===void 0&&f.length===1?delete m[d][f[0]]:m[d]=M$(m[d],f,o,s),m}function Gs(e,r,o){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return r.length&&s&&o===void 0&&!Xs(e,r.slice(0,-1))?e:M$(e,r,o,s)}function Yce(e){return Fn(e)==="object"&&e!==null&&Object.getPrototypeOf(e)===Object.prototype}function v5(e){return Array.isArray(e)?[]:{}}var qce=typeof Reflect>"u"?Object.keys:Reflect.ownKeys;function $p(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];var s=v5(r[0]);return r.forEach(function(c){function d(f,m){var g=new Set(m),_=Xs(c,f),S=Array.isArray(_);if(S||Yce(_)){if(!g.has(_)){g.add(_);var T=Xs(s,f);S?s=Gs(s,f,[]):(!T||Fn(T)!=="object")&&(s=Gs(s,f,v5(_))),qce(_).forEach(function(R){d([].concat(at(f),[R]),g)})}}else s=Gs(s,f,_)}d([])}),s}const F$=b.createContext(void 0),Xce={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"};var Jce={locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"};const Qce={placeholder:"Select time",rangePlaceholder:["Start time","End time"]},U$=Qce,Zce={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},Jce),timePickerLocale:Object.assign({},U$)},E5=Zce,ka="${label} is not a valid ${type}",ele={locale:"en",Pagination:Xce,DatePicker:E5,TimePicker:U$,Calendar:E5,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand"},PageHeader:{back:"Back"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:ka,method:ka,array:ka,object:ka,number:ka,date:ka,boolean:ka,integer:ka,float:ka,regexp:ka,email:ka,url:ka,hex:ka},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh"},ColorPicker:{presetEmpty:"Empty"}},cf=ele;let O1=Object.assign({},cf.Modal);function _5(e){e?O1=Object.assign(Object.assign({},O1),e):O1=Object.assign({},cf.Modal)}const tle=b.createContext(void 0),hx=tle,nle=(e,r)=>{const o=b.useContext(hx),s=b.useMemo(()=>{var d;const f=r||cf[e],m=(d=o==null?void 0:o[e])!==null&&d!==void 0?d:{};return Object.assign(Object.assign({},typeof f=="function"?f():f),m||{})},[e,r,o]),c=b.useMemo(()=>{const d=o==null?void 0:o.locale;return o!=null&&o.exist&&!d?cf.locale:d},[o]);return[s,c]},B$=nle,rle="internalMark",ile=e=>{const{locale:r={},children:o,_ANT_MARK__:s}=e;b.useEffect(()=>(_5(r&&r.Modal),()=>{_5()}),[r]);const c=b.useMemo(()=>Object.assign(Object.assign({},r),{exist:!0}),[r]);return b.createElement(hx.Provider,{value:c},o)},ole=ile,ale="5.6.4",Sy=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"];function so(e,r){sle(e)&&(e="100%");var o=cle(e);return e=r===360?e:Math.min(r,Math.max(0,parseFloat(e))),o&&(e=parseInt(String(e*r),10)/100),Math.abs(e-r)<1e-6?1:(r===360?e=(e<0?e%r+r:e%r)/parseFloat(String(r)):e=e%r/parseFloat(String(r)),e)}function YE(e){return Math.min(1,Math.max(0,e))}function sle(e){return typeof e=="string"&&e.indexOf(".")!==-1&&parseFloat(e)===1}function cle(e){return typeof e=="string"&&e.indexOf("%")!==-1}function j$(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function qE(e){return e<=1?"".concat(Number(e)*100,"%"):e}function Ud(e){return e.length===1?"0"+e:String(e)}function lle(e,r,o){return{r:so(e,255)*255,g:so(r,255)*255,b:so(o,255)*255}}function y5(e,r,o){e=so(e,255),r=so(r,255),o=so(o,255);var s=Math.max(e,r,o),c=Math.min(e,r,o),d=0,f=0,m=(s+c)/2;if(s===c)f=0,d=0;else{var g=s-c;switch(f=m>.5?g/(2-s-c):g/(s+c),s){case e:d=(r-o)/g+(r<o?6:0);break;case r:d=(o-e)/g+2;break;case o:d=(e-r)/g+4;break}d/=6}return{h:d,s:f,l:m}}function x1(e,r,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?e+(r-e)*(6*o):o<1/2?r:o<2/3?e+(r-e)*(2/3-o)*6:e}function ule(e,r,o){var s,c,d;if(e=so(e,360),r=so(r,100),o=so(o,100),r===0)c=o,d=o,s=o;else{var f=o<.5?o*(1+r):o+r-o*r,m=2*o-f;s=x1(m,f,e+1/3),c=x1(m,f,e),d=x1(m,f,e-1/3)}return{r:s*255,g:c*255,b:d*255}}function iA(e,r,o){e=so(e,255),r=so(r,255),o=so(o,255);var s=Math.max(e,r,o),c=Math.min(e,r,o),d=0,f=s,m=s-c,g=s===0?0:m/s;if(s===c)d=0;else{switch(s){case e:d=(r-o)/m+(r<o?6:0);break;case r:d=(o-e)/m+2;break;case o:d=(e-r)/m+4;break}d/=6}return{h:d,s:g,v:f}}function dle(e,r,o){e=so(e,360)*6,r=so(r,100),o=so(o,100);var s=Math.floor(e),c=e-s,d=o*(1-r),f=o*(1-c*r),m=o*(1-(1-c)*r),g=s%6,_=[o,f,d,d,m,o][g],S=[m,o,o,f,d,d][g],T=[d,d,m,o,o,f][g];return{r:_*255,g:S*255,b:T*255}}function oA(e,r,o,s){var c=[Ud(Math.round(e).toString(16)),Ud(Math.round(r).toString(16)),Ud(Math.round(o).toString(16))];return s&&c[0].startsWith(c[0].charAt(1))&&c[1].startsWith(c[1].charAt(1))&&c[2].startsWith(c[2].charAt(1))?c[0].charAt(0)+c[1].charAt(0)+c[2].charAt(0):c.join("")}function hle(e,r,o,s,c){var d=[Ud(Math.round(e).toString(16)),Ud(Math.round(r).toString(16)),Ud(Math.round(o).toString(16)),Ud(ple(s))];return c&&d[0].startsWith(d[0].charAt(1))&&d[1].startsWith(d[1].charAt(1))&&d[2].startsWith(d[2].charAt(1))&&d[3].startsWith(d[3].charAt(1))?d[0].charAt(0)+d[1].charAt(0)+d[2].charAt(0)+d[3].charAt(0):d.join("")}function ple(e){return Math.round(parseFloat(e)*255).toString(16)}function S5(e){return Ma(e)/255}function Ma(e){return parseInt(e,16)}function fle(e){return{r:e>>16,g:(e&65280)>>8,b:e&255}}var aA={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function wp(e){var r={r:0,g:0,b:0},o=1,s=null,c=null,d=null,f=!1,m=!1;return typeof e=="string"&&(e=vle(e)),typeof e=="object"&&(ll(e.r)&&ll(e.g)&&ll(e.b)?(r=lle(e.r,e.g,e.b),f=!0,m=String(e.r).substr(-1)==="%"?"prgb":"rgb"):ll(e.h)&&ll(e.s)&&ll(e.v)?(s=qE(e.s),c=qE(e.v),r=dle(e.h,s,c),f=!0,m="hsv"):ll(e.h)&&ll(e.s)&&ll(e.l)&&(s=qE(e.s),d=qE(e.l),r=ule(e.h,s,d),f=!0,m="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(o=e.a)),o=j$(o),{ok:f,format:e.format||m,r:Math.min(255,Math.max(r.r,0)),g:Math.min(255,Math.max(r.g,0)),b:Math.min(255,Math.max(r.b,0)),a:o}}var mle="[-\\+]?\\d+%?",gle="[-\\+]?\\d*\\.\\d+%?",Nu="(?:".concat(gle,")|(?:").concat(mle,")"),N1="[\\s|\\(]+(".concat(Nu,")[,|\\s]+(").concat(Nu,")[,|\\s]+(").concat(Nu,")\\s*\\)?"),P1="[\\s|\\(]+(".concat(Nu,")[,|\\s]+(").concat(Nu,")[,|\\s]+(").concat(Nu,")[,|\\s]+(").concat(Nu,")\\s*\\)?"),$s={CSS_UNIT:new RegExp(Nu),rgb:new RegExp("rgb"+N1),rgba:new RegExp("rgba"+P1),hsl:new RegExp("hsl"+N1),hsla:new RegExp("hsla"+P1),hsv:new RegExp("hsv"+N1),hsva:new RegExp("hsva"+P1),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function vle(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;var r=!1;if(aA[e])e=aA[e],r=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var o=$s.rgb.exec(e);return o?{r:o[1],g:o[2],b:o[3]}:(o=$s.rgba.exec(e),o?{r:o[1],g:o[2],b:o[3],a:o[4]}:(o=$s.hsl.exec(e),o?{h:o[1],s:o[2],l:o[3]}:(o=$s.hsla.exec(e),o?{h:o[1],s:o[2],l:o[3],a:o[4]}:(o=$s.hsv.exec(e),o?{h:o[1],s:o[2],v:o[3]}:(o=$s.hsva.exec(e),o?{h:o[1],s:o[2],v:o[3],a:o[4]}:(o=$s.hex8.exec(e),o?{r:Ma(o[1]),g:Ma(o[2]),b:Ma(o[3]),a:S5(o[4]),format:r?"name":"hex8"}:(o=$s.hex6.exec(e),o?{r:Ma(o[1]),g:Ma(o[2]),b:Ma(o[3]),format:r?"name":"hex"}:(o=$s.hex4.exec(e),o?{r:Ma(o[1]+o[1]),g:Ma(o[2]+o[2]),b:Ma(o[3]+o[3]),a:S5(o[4]+o[4]),format:r?"name":"hex8"}:(o=$s.hex3.exec(e),o?{r:Ma(o[1]+o[1]),g:Ma(o[2]+o[2]),b:Ma(o[3]+o[3]),format:r?"name":"hex"}:!1)))))))))}function ll(e){return!!$s.CSS_UNIT.exec(String(e))}var io=function(){function e(r,o){r===void 0&&(r=""),o===void 0&&(o={});var s;if(r instanceof e)return r;typeof r=="number"&&(r=fle(r)),this.originalInput=r;var c=wp(r);this.originalInput=r,this.r=c.r,this.g=c.g,this.b=c.b,this.a=c.a,this.roundA=Math.round(100*this.a)/100,this.format=(s=o.format)!==null&&s!==void 0?s:c.format,this.gradientType=o.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=c.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var r=this.toRgb();return(r.r*299+r.g*587+r.b*114)/1e3},e.prototype.getLuminance=function(){var r=this.toRgb(),o,s,c,d=r.r/255,f=r.g/255,m=r.b/255;return d<=.03928?o=d/12.92:o=Math.pow((d+.055)/1.055,2.4),f<=.03928?s=f/12.92:s=Math.pow((f+.055)/1.055,2.4),m<=.03928?c=m/12.92:c=Math.pow((m+.055)/1.055,2.4),.2126*o+.7152*s+.0722*c},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(r){return this.a=j$(r),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){var r=this.toHsl().s;return r===0},e.prototype.toHsv=function(){var r=iA(this.r,this.g,this.b);return{h:r.h*360,s:r.s,v:r.v,a:this.a}},e.prototype.toHsvString=function(){var r=iA(this.r,this.g,this.b),o=Math.round(r.h*360),s=Math.round(r.s*100),c=Math.round(r.v*100);return this.a===1?"hsv(".concat(o,", ").concat(s,"%, ").concat(c,"%)"):"hsva(".concat(o,", ").concat(s,"%, ").concat(c,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var r=y5(this.r,this.g,this.b);return{h:r.h*360,s:r.s,l:r.l,a:this.a}},e.prototype.toHslString=function(){var r=y5(this.r,this.g,this.b),o=Math.round(r.h*360),s=Math.round(r.s*100),c=Math.round(r.l*100);return this.a===1?"hsl(".concat(o,", ").concat(s,"%, ").concat(c,"%)"):"hsla(".concat(o,", ").concat(s,"%, ").concat(c,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(r){return r===void 0&&(r=!1),oA(this.r,this.g,this.b,r)},e.prototype.toHexString=function(r){return r===void 0&&(r=!1),"#"+this.toHex(r)},e.prototype.toHex8=function(r){return r===void 0&&(r=!1),hle(this.r,this.g,this.b,this.a,r)},e.prototype.toHex8String=function(r){return r===void 0&&(r=!1),"#"+this.toHex8(r)},e.prototype.toHexShortString=function(r){return r===void 0&&(r=!1),this.a===1?this.toHexString(r):this.toHex8String(r)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var r=Math.round(this.r),o=Math.round(this.g),s=Math.round(this.b);return this.a===1?"rgb(".concat(r,", ").concat(o,", ").concat(s,")"):"rgba(".concat(r,", ").concat(o,", ").concat(s,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var r=function(o){return"".concat(Math.round(so(o,255)*100),"%")};return{r:r(this.r),g:r(this.g),b:r(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var r=function(o){return Math.round(so(o,255)*100)};return this.a===1?"rgb(".concat(r(this.r),"%, ").concat(r(this.g),"%, ").concat(r(this.b),"%)"):"rgba(".concat(r(this.r),"%, ").concat(r(this.g),"%, ").concat(r(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var r="#"+oA(this.r,this.g,this.b,!1),o=0,s=Object.entries(aA);o<s.length;o++){var c=s[o],d=c[0],f=c[1];if(r===f)return d}return!1},e.prototype.toString=function(r){var o=!!r;r=r??this.format;var s=!1,c=this.a<1&&this.a>=0,d=!o&&c&&(r.startsWith("hex")||r==="name");return d?r==="name"&&this.a===0?this.toName():this.toRgbString():(r==="rgb"&&(s=this.toRgbString()),r==="prgb"&&(s=this.toPercentageRgbString()),(r==="hex"||r==="hex6")&&(s=this.toHexString()),r==="hex3"&&(s=this.toHexString(!0)),r==="hex4"&&(s=this.toHex8String(!0)),r==="hex8"&&(s=this.toHex8String()),r==="name"&&(s=this.toName()),r==="hsl"&&(s=this.toHslString()),r==="hsv"&&(s=this.toHsvString()),s||this.toHexString())},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(r){r===void 0&&(r=10);var o=this.toHsl();return o.l+=r/100,o.l=YE(o.l),new e(o)},e.prototype.brighten=function(r){r===void 0&&(r=10);var o=this.toRgb();return o.r=Math.max(0,Math.min(255,o.r-Math.round(255*-(r/100)))),o.g=Math.max(0,Math.min(255,o.g-Math.round(255*-(r/100)))),o.b=Math.max(0,Math.min(255,o.b-Math.round(255*-(r/100)))),new e(o)},e.prototype.darken=function(r){r===void 0&&(r=10);var o=this.toHsl();return o.l-=r/100,o.l=YE(o.l),new e(o)},e.prototype.tint=function(r){return r===void 0&&(r=10),this.mix("white",r)},e.prototype.shade=function(r){return r===void 0&&(r=10),this.mix("black",r)},e.prototype.desaturate=function(r){r===void 0&&(r=10);var o=this.toHsl();return o.s-=r/100,o.s=YE(o.s),new e(o)},e.prototype.saturate=function(r){r===void 0&&(r=10);var o=this.toHsl();return o.s+=r/100,o.s=YE(o.s),new e(o)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(r){var o=this.toHsl(),s=(o.h+r)%360;return o.h=s<0?360+s:s,new e(o)},e.prototype.mix=function(r,o){o===void 0&&(o=50);var s=this.toRgb(),c=new e(r).toRgb(),d=o/100,f={r:(c.r-s.r)*d+s.r,g:(c.g-s.g)*d+s.g,b:(c.b-s.b)*d+s.b,a:(c.a-s.a)*d+s.a};return new e(f)},e.prototype.analogous=function(r,o){r===void 0&&(r=6),o===void 0&&(o=30);var s=this.toHsl(),c=360/o,d=[this];for(s.h=(s.h-(c*r>>1)+720)%360;--r;)s.h=(s.h+c)%360,d.push(new e(s));return d},e.prototype.complement=function(){var r=this.toHsl();return r.h=(r.h+180)%360,new e(r)},e.prototype.monochromatic=function(r){r===void 0&&(r=6);for(var o=this.toHsv(),s=o.h,c=o.s,d=o.v,f=[],m=1/r;r--;)f.push(new e({h:s,s:c,v:d})),d=(d+m)%1;return f},e.prototype.splitcomplement=function(){var r=this.toHsl(),o=r.h;return[this,new e({h:(o+72)%360,s:r.s,l:r.l}),new e({h:(o+216)%360,s:r.s,l:r.l})]},e.prototype.onBackground=function(r){var o=this.toRgb(),s=new e(r).toRgb(),c=o.a+s.a*(1-o.a);return new e({r:(o.r*o.a+s.r*s.a*(1-o.a))/c,g:(o.g*o.a+s.g*s.a*(1-o.a))/c,b:(o.b*o.a+s.b*s.a*(1-o.a))/c,a:c})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(r){for(var o=this.toHsl(),s=o.h,c=[this],d=360/r,f=1;f<r;f++)c.push(new e({h:(s+f*d)%360,s:o.s,l:o.l}));return c},e.prototype.equals=function(r){return this.toRgbString()===new e(r).toRgbString()},e}(),XE=2,C5=.16,Ele=.05,_le=.05,yle=.15,V$=5,$$=4,Sle=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function b5(e){var r=e.r,o=e.g,s=e.b,c=iA(r,o,s);return{h:c.h*360,s:c.s,v:c.v}}function JE(e){var r=e.r,o=e.g,s=e.b;return"#".concat(oA(r,o,s,!1))}function Cle(e,r,o){var s=o/100,c={r:(r.r-e.r)*s+e.r,g:(r.g-e.g)*s+e.g,b:(r.b-e.b)*s+e.b};return c}function T5(e,r,o){var s;return Math.round(e.h)>=60&&Math.round(e.h)<=240?s=o?Math.round(e.h)-XE*r:Math.round(e.h)+XE*r:s=o?Math.round(e.h)+XE*r:Math.round(e.h)-XE*r,s<0?s+=360:s>=360&&(s-=360),s}function R5(e,r,o){if(e.h===0&&e.s===0)return e.s;var s;return o?s=e.s-C5*r:r===$$?s=e.s+C5:s=e.s+Ele*r,s>1&&(s=1),o&&r===V$&&s>.1&&(s=.1),s<.06&&(s=.06),Number(s.toFixed(2))}function w5(e,r,o){var s;return o?s=e.v+_le*r:s=e.v-yle*r,s>1&&(s=1),Number(s.toFixed(2))}function Rl(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=[],s=wp(e),c=V$;c>0;c-=1){var d=b5(s),f=JE(wp({h:T5(d,c,!0),s:R5(d,c,!0),v:w5(d,c,!0)}));o.push(f)}o.push(JE(s));for(var m=1;m<=$$;m+=1){var g=b5(s),_=JE(wp({h:T5(g,m),s:R5(g,m),v:w5(g,m)}));o.push(_)}return r.theme==="dark"?Sle.map(function(S){var T=S.index,R=S.opacity,N=JE(Cle(wp(r.backgroundColor||"#141414"),wp(o[T]),R*100));return N}):o}var D1={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},_m={},k1={};Object.keys(D1).forEach(function(e){_m[e]=Rl(D1[e]),_m[e].primary=_m[e][5],k1[e]=Rl(D1[e],{theme:"dark",backgroundColor:"#141414"}),k1[e].primary=k1[e][5]});var ble=_m.gold,Tle=_m.blue;const Rle=e=>{const{controlHeight:r}=e;return{controlHeightSM:r*.75,controlHeightXS:r*.5,controlHeightLG:r*1.25}},H$=Rle;function wle(e){const{sizeUnit:r,sizeStep:o}=e;return{sizeXXL:r*(o+8),sizeXL:r*(o+4),sizeLG:r*(o+2),sizeMD:r*(o+1),sizeMS:r*o,size:r*o,sizeSM:r*(o-1),sizeXS:r*(o-2),sizeXXS:r*(o-3)}}const px={blue:"#1677ff",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#eb2f96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},Ile=Object.assign(Object.assign({},px),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0}),dg=Ile;function W$(e,r){let{generateColorPalettes:o,generateNeutralColorPalettes:s}=r;const{colorSuccess:c,colorWarning:d,colorError:f,colorInfo:m,colorPrimary:g,colorBgBase:_,colorTextBase:S}=e,T=o(g),R=o(c),N=o(d),A=o(f),O=o(m),M=s(_,S);return Object.assign(Object.assign({},M),{colorPrimaryBg:T[1],colorPrimaryBgHover:T[2],colorPrimaryBorder:T[3],colorPrimaryBorderHover:T[4],colorPrimaryHover:T[5],colorPrimary:T[6],colorPrimaryActive:T[7],colorPrimaryTextHover:T[8],colorPrimaryText:T[9],colorPrimaryTextActive:T[10],colorSuccessBg:R[1],colorSuccessBgHover:R[2],colorSuccessBorder:R[3],colorSuccessBorderHover:R[4],colorSuccessHover:R[4],colorSuccess:R[6],colorSuccessActive:R[7],colorSuccessTextHover:R[8],colorSuccessText:R[9],colorSuccessTextActive:R[10],colorErrorBg:A[1],colorErrorBgHover:A[2],colorErrorBorder:A[3],colorErrorBorderHover:A[4],colorErrorHover:A[5],colorError:A[6],colorErrorActive:A[7],colorErrorTextHover:A[8],colorErrorText:A[9],colorErrorTextActive:A[10],colorWarningBg:N[1],colorWarningBgHover:N[2],colorWarningBorder:N[3],colorWarningBorderHover:N[4],colorWarningHover:N[4],colorWarning:N[6],colorWarningActive:N[7],colorWarningTextHover:N[8],colorWarningText:N[9],colorWarningTextActive:N[10],colorInfoBg:O[1],colorInfoBgHover:O[2],colorInfoBorder:O[3],colorInfoBorderHover:O[4],colorInfoHover:O[4],colorInfo:O[6],colorInfoActive:O[7],colorInfoTextHover:O[8],colorInfoText:O[9],colorInfoTextActive:O[10],colorBgMask:new io("#000").setAlpha(.45).toRgbString(),colorWhite:"#fff"})}const Ale=e=>{let r=e,o=e,s=e,c=e;return e<6&&e>=5?r=e+1:e<16&&e>=6?r=e+2:e>=16&&(r=16),e<7&&e>=5?o=4:e<8&&e>=7?o=5:e<14&&e>=8?o=6:e<16&&e>=14?o=7:e>=16&&(o=8),e<6&&e>=2?s=1:e>=6&&(s=2),e>4&&e<8?c=4:e>=8&&(c=6),{borderRadius:e>16?16:e,borderRadiusXS:s,borderRadiusSM:o,borderRadiusLG:r,borderRadiusOuter:c}},Ole=Ale;function xle(e){const{motionUnit:r,motionBase:o,borderRadius:s,lineWidth:c}=e;return Object.assign({motionDurationFast:`${(o+r).toFixed(1)}s`,motionDurationMid:`${(o+r*2).toFixed(1)}s`,motionDurationSlow:`${(o+r*3).toFixed(1)}s`,lineWidthBold:c+1},Ole(s))}const ul=(e,r)=>new io(e).setAlpha(r).toRgbString(),q0=(e,r)=>new io(e).darken(r).toHexString(),Nle=e=>{const r=Rl(e);return{1:r[0],2:r[1],3:r[2],4:r[3],5:r[4],6:r[5],7:r[6],8:r[4],9:r[5],10:r[6]}},Ple=(e,r)=>{const o=e||"#fff",s=r||"#000";return{colorBgBase:o,colorTextBase:s,colorText:ul(s,.88),colorTextSecondary:ul(s,.65),colorTextTertiary:ul(s,.45),colorTextQuaternary:ul(s,.25),colorFill:ul(s,.15),colorFillSecondary:ul(s,.06),colorFillTertiary:ul(s,.04),colorFillQuaternary:ul(s,.02),colorBgLayout:q0(o,4),colorBgContainer:q0(o,0),colorBgElevated:q0(o,0),colorBgSpotlight:ul(s,.85),colorBorder:q0(o,15),colorBorderSecondary:q0(o,6)}};function Dle(e){const r=new Array(10).fill(null).map((o,s)=>{const c=s-1,d=e*Math.pow(2.71828,c/5),f=s>1?Math.floor(d):Math.ceil(d);return Math.floor(f/2)*2});return r[1]=e,r.map(o=>{const s=o+8;return{size:o,lineHeight:s/o}})}const kle=e=>{const r=Dle(e),o=r.map(c=>c.size),s=r.map(c=>c.lineHeight);return{fontSizeSM:o[0],fontSize:o[1],fontSizeLG:o[2],fontSizeXL:o[3],fontSizeHeading1:o[6],fontSizeHeading2:o[5],fontSizeHeading3:o[4],fontSizeHeading4:o[3],fontSizeHeading5:o[2],lineHeight:s[1],lineHeightLG:s[2],lineHeightSM:s[0],lineHeightHeading1:s[6],lineHeightHeading2:s[5],lineHeightHeading3:s[4],lineHeightHeading4:s[3],lineHeightHeading5:s[2]}},G$=kle;function hg(e){const r=Object.keys(px).map(o=>{const s=Rl(e[o]);return new Array(10).fill(1).reduce((c,d,f)=>(c[`${o}-${f+1}`]=s[f],c[`${o}${f+1}`]=s[f],c),{})}).reduce((o,s)=>(o=Object.assign(Object.assign({},o),s),o),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),r),W$(e,{generateColorPalettes:Nle,generateNeutralColorPalettes:Ple})),G$(e.fontSize)),wle(e)),H$(e)),xle(e))}function L1(e){return e>=0&&e<=255}function QE(e,r){const{r:o,g:s,b:c,a:d}=new io(e).toRgb();if(d<1)return e;const{r:f,g:m,b:g}=new io(r).toRgb();for(let _=.01;_<=1;_+=.01){const S=Math.round((o-f*(1-_))/_),T=Math.round((s-m*(1-_))/_),R=Math.round((c-g*(1-_))/_);if(L1(S)&&L1(T)&&L1(R))return new io({r:S,g:T,b:R,a:Math.round(_*100)/100}).toRgbString()}return new io({r:o,g:s,b:c,a:1}).toRgbString()}var Lle=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function z$(e){const{override:r}=e,o=Lle(e,["override"]),s=Object.assign({},r);Object.keys(dg).forEach(R=>{delete s[R]});const c=Object.assign(Object.assign({},o),s),d=480,f=576,m=768,g=992,_=1200,S=1600;if(c.motion===!1){const R="0s";c.motionDurationFast=R,c.motionDurationMid=R,c.motionDurationSlow=R}return Object.assign(Object.assign(Object.assign({},c),{colorLink:c.colorInfoText,colorLinkHover:c.colorInfoHover,colorLinkActive:c.colorInfoActive,colorFillContent:c.colorFillSecondary,colorFillContentHover:c.colorFill,colorFillAlter:c.colorFillQuaternary,colorBgContainerDisabled:c.colorFillTertiary,colorBorderBg:c.colorBgContainer,colorSplit:QE(c.colorBorderSecondary,c.colorBgContainer),colorTextPlaceholder:c.colorTextQuaternary,colorTextDisabled:c.colorTextQuaternary,colorTextHeading:c.colorText,colorTextLabel:c.colorTextSecondary,colorTextDescription:c.colorTextTertiary,colorTextLightSolid:c.colorWhite,colorHighlight:c.colorError,colorBgTextHover:c.colorFillSecondary,colorBgTextActive:c.colorFill,colorIcon:c.colorTextTertiary,colorIconHover:c.colorText,colorErrorOutline:QE(c.colorErrorBg,c.colorBgContainer),colorWarningOutline:QE(c.colorWarningBg,c.colorBgContainer),fontSizeIcon:c.fontSizeSM,lineWidthFocus:c.lineWidth*4,lineWidth:c.lineWidth,controlOutlineWidth:c.lineWidth*2,controlInteractiveSize:c.controlHeight/2,controlItemBgHover:c.colorFillTertiary,controlItemBgActive:c.colorPrimaryBg,controlItemBgActiveHover:c.colorPrimaryBgHover,controlItemBgActiveDisabled:c.colorFill,controlTmpOutline:c.colorFillQuaternary,controlOutline:QE(c.colorPrimaryBg,c.colorBgContainer),lineType:c.lineType,borderRadius:c.borderRadius,borderRadiusXS:c.borderRadiusXS,borderRadiusSM:c.borderRadiusSM,borderRadiusLG:c.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:c.sizeXXS,paddingXS:c.sizeXS,paddingSM:c.sizeSM,padding:c.size,paddingMD:c.sizeMD,paddingLG:c.sizeLG,paddingXL:c.sizeXL,paddingContentHorizontalLG:c.sizeLG,paddingContentVerticalLG:c.sizeMS,paddingContentHorizontal:c.sizeMS,paddingContentVertical:c.sizeSM,paddingContentHorizontalSM:c.size,paddingContentVerticalSM:c.sizeXS,marginXXS:c.sizeXXS,marginXS:c.sizeXS,marginSM:c.sizeSM,margin:c.size,marginMD:c.sizeMD,marginLG:c.sizeLG,marginXL:c.sizeXL,marginXXL:c.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:d,screenXSMin:d,screenXSMax:f-1,screenSM:f,screenSMMin:f,screenSMMax:m-1,screenMD:m,screenMDMin:m,screenMDMax:g-1,screenLG:g,screenLGMin:g,screenLGMax:_-1,screenXL:_,screenXLMin:_,screenXLMax:S-1,screenXXL:S,screenXXLMin:S,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new io("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new io("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new io("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),s)}function qs(e){var r=b.useRef();r.current=e;var o=b.useCallback(function(){for(var s,c=arguments.length,d=new Array(c),f=0;f<c;f++)d[f]=arguments[f];return(s=r.current)===null||s===void 0?void 0:s.call.apply(s,[r].concat(d))},[]);return o}function Kd(e){var r=b.useRef(!1),o=b.useState(e),s=Ge(o,2),c=s[0],d=s[1];b.useEffect(function(){return r.current=!1,function(){r.current=!0}},[]);function f(m,g){g&&r.current||d(m)}return[c,f]}function M1(e){return e!==void 0}function vl(e,r){var o=r||{},s=o.defaultValue,c=o.value,d=o.onChange,f=o.postState,m=Kd(function(){return M1(c)?c:M1(s)?typeof s=="function"?s():s:typeof e=="function"?e():e}),g=Ge(m,2),_=g[0],S=g[1],T=c!==void 0?c:_,R=f?f(T):T,N=qs(d),A=Kd([T]),O=Ge(A,2),M=O[0],x=O[1];u5(function(){var D=M[0];_!==D&&N(_,D)},[M]),u5(function(){M1(c)||S(c)},[c]);var P=qs(function(D,F){S(D,F),x([T],F)});return[R,P]}const fx="anticon",Mle=(e,r)=>r||(e?`ant-${e}`:"ant"),or=b.createContext({getPrefixCls:Mle,iconPrefixCls:fx}),K$=e=>({color:e.colorLink,textDecoration:"none",outline:"none",cursor:"pointer",transition:`color ${e.motionDurationSlow}`,"&:focus, &:hover":{color:e.colorLinkHover},"&:active":{color:e.colorLinkActive}}),Fle=(e,r,o,s,c)=>{const d=e/2,f=0,m=d,g=o*1/Math.sqrt(2),_=d-o*(1-1/Math.sqrt(2)),S=d-r*(1/Math.sqrt(2)),T=o*(Math.sqrt(2)-1)+r*(1/Math.sqrt(2)),R=2*d-S,N=T,A=2*d-g,O=_,M=2*d-f,x=m,P=d*Math.sqrt(2)+o*(Math.sqrt(2)-2),D=o*(Math.sqrt(2)-1);return{pointerEvents:"none",width:e,height:e,overflow:"hidden","&::before":{position:"absolute",bottom:0,insetInlineStart:0,width:e,height:e/2,background:s,clipPath:{_multi_value_:!0,value:[`polygon(${D}px 100%, 50% ${D}px, ${2*d-D}px 100%, ${D}px 100%)`,`path('M ${f} ${m} A ${o} ${o} 0 0 0 ${g} ${_} L ${S} ${T} A ${r} ${r} 0 0 1 ${R} ${N} L ${A} ${O} A ${o} ${o} 0 0 0 ${M} ${x} Z')`]},content:'""'},"&::after":{content:'""',position:"absolute",width:P,height:P,bottom:0,insetInline:0,margin:"auto",borderRadius:{_skip_check_:!0,value:`0 0 ${r}px 0`},transform:"translateY(50%) rotate(-135deg)",boxShadow:c,zIndex:0,background:"transparent"}}},Ule={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},sh=e=>({boxSizing:"border-box",margin:0,padding:0,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight,listStyle:"none",fontFamily:e.fontFamily}),Y$=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),sA=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}}),Ble=e=>({a:{color:e.colorLink,textDecoration:e.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${e.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:e.colorLinkHover},"&:active":{color:e.colorLinkActive},"&:active,\n  &:hover":{textDecoration:e.linkHoverDecoration,outline:0},"&:focus":{textDecoration:e.linkFocusDecoration,outline:0},"&[disabled]":{color:e.colorTextDisabled,cursor:"not-allowed"}}}),jle=(e,r)=>{const{fontFamily:o,fontSize:s}=e,c=`[class^="${r}"], [class*=" ${r}"]`;return{[c]:{fontFamily:o,fontSize:s,boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"},[c]:{boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}}}}},q$=e=>({outline:`${e.lineWidthFocus}px solid ${e.colorPrimaryBorder}`,outlineOffset:1,transition:"outline-offset 0s, outline 0s"}),Vle=e=>({"&:focus-visible":Object.assign({},q$(e))});function ac(e,r,o,s){return c=>{const[d,f,m]=Tf(),{getPrefixCls:g,iconPrefixCls:_,csp:S}=b.useContext(or),T=g(),R={theme:d,token:f,hashId:m,nonce:()=>S==null?void 0:S.nonce};return rA(Object.assign(Object.assign({},R),{path:["Shared",T]}),()=>[{"&":Ble(f)}]),[rA(Object.assign(Object.assign({},R),{path:[e,c,_]}),()=>{const{token:N,flush:A}=Hle(f),O=Object.assign({},f[e]);if(s!=null&&s.deprecatedTokens){const{deprecatedTokens:$}=s;$.forEach(V=>{let[W,K]=V;var Q;(O!=null&&O[W]||O!=null&&O[K])&&((Q=O[K])!==null&&Q!==void 0||(O[K]=O==null?void 0:O[W]))})}const M=typeof o=="function"?o(lo(N,O??{})):o,x=Object.assign(Object.assign({},M),O),P=`.${c}`,D=lo(N,{componentCls:P,prefixCls:c,iconCls:`.${_}`,antCls:`.${T}`},x),F=r(D,{hashId:m,prefixCls:c,rootPrefixCls:T,iconPrefixCls:_,overrideComponentToken:O});return A(e,x),[(s==null?void 0:s.resetStyle)===!1?null:jle(f,c),F]}),m]}}const X$=typeof CSSINJS_STATISTIC<"u";let cA=!0;function lo(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];if(!X$)return Object.assign.apply(Object,[{}].concat(r));cA=!1;const s={};return r.forEach(c=>{Object.keys(c).forEach(f=>{Object.defineProperty(s,f,{configurable:!0,enumerable:!0,get:()=>c[f]})})}),cA=!0,s}function $le(){}function Hle(e){let r,o=e,s=$le;return X$&&(r=new Set,o=new Proxy(e,{get(c,d){return cA&&r.add(d),c[d]}}),s=(c,d)=>{Array.from(r)}),{token:o,keys:r,flush:s}}function Wle(e,r){return Sy.reduce((o,s)=>{const c=e[`${s}1`],d=e[`${s}3`],f=e[`${s}6`],m=e[`${s}7`];return Object.assign(Object.assign({},o),r(s,{lightColor:c,lightBorderColor:d,darkColor:f,textColor:m}))},{})}const Gle=_y(hg),Cy={token:dg,hashed:!0},J$=St.createContext(Cy);function Tf(){const{token:e,hashed:r,theme:o,components:s}=St.useContext(J$),c=`${ale}-${r||""}`,d=o||Gle,[f,m]=Ece(d,[dg,e],{salt:c,override:Object.assign({override:e},s),formatToken:z$});return[d,f,r?m:""]}const zle=`-ant-${Date.now()}-${Math.random()}`;function Kle(e,r){const o={},s=(f,m)=>{let g=f.clone();return g=(m==null?void 0:m(g))||g,g.toRgbString()},c=(f,m)=>{const g=new io(f),_=Rl(g.toRgbString());o[`${m}-color`]=s(g),o[`${m}-color-disabled`]=_[1],o[`${m}-color-hover`]=_[4],o[`${m}-color-active`]=_[6],o[`${m}-color-outline`]=g.clone().setAlpha(.2).toRgbString(),o[`${m}-color-deprecated-bg`]=_[0],o[`${m}-color-deprecated-border`]=_[2]};if(r.primaryColor){c(r.primaryColor,"primary");const f=new io(r.primaryColor),m=Rl(f.toRgbString());m.forEach((_,S)=>{o[`primary-${S+1}`]=_}),o["primary-color-deprecated-l-35"]=s(f,_=>_.lighten(35)),o["primary-color-deprecated-l-20"]=s(f,_=>_.lighten(20)),o["primary-color-deprecated-t-20"]=s(f,_=>_.tint(20)),o["primary-color-deprecated-t-50"]=s(f,_=>_.tint(50)),o["primary-color-deprecated-f-12"]=s(f,_=>_.setAlpha(_.getAlpha()*.12));const g=new io(m[0]);o["primary-color-active-deprecated-f-30"]=s(g,_=>_.setAlpha(_.getAlpha()*.3)),o["primary-color-active-deprecated-d-02"]=s(g,_=>_.darken(2))}return r.successColor&&c(r.successColor,"success"),r.warningColor&&c(r.warningColor,"warning"),r.errorColor&&c(r.errorColor,"error"),r.infoColor&&c(r.infoColor,"info"),`
  :root {
    ${Object.keys(o).map(f=>`--${e}-${f}: ${o[f]};`).join(`
`)}
  }
  `.trim()}function Yle(e,r){const o=Kle(e,r);Io()&&zm(o,`${zle}-dynamic-theme`)}const lA=b.createContext(!1),Q$=e=>{let{children:r,disabled:o}=e;const s=b.useContext(lA);return b.createElement(lA.Provider,{value:o??s},r)},pg=lA,qle=e=>{const r=St.useContext(xS);return St.useMemo(()=>e?typeof e=="string"?e??r:e instanceof Function?e(r):r:r,[e,r])},Rf=qle,Z$=b.createContext(void 0),e7=e=>{let{children:r,size:o}=e;const s=Rf(o);return b.createElement(Z$.Provider,{value:s},r)},xS=Z$;function Xle(){const e=b.useContext(pg),r=b.useContext(xS);return{componentDisabled:e,componentSize:r}}function Jle(e,r){const o=e||{},s=o.inherit===!1||!r?Cy:r;return bS(()=>{if(!e)return r;const d=Object.assign({},s.components);return Object.keys(e.components||{}).forEach(f=>{d[f]=Object.assign(Object.assign({},d[f]),e.components[f])}),Object.assign(Object.assign(Object.assign({},s),o),{token:Object.assign(Object.assign({},s.token),o.token),components:d})},[o,s],(d,f)=>d.some((m,g)=>{const _=f[g];return!wS(m,_,!0)}))}var Qle=["children"],t7=b.createContext({});function Zle(e){var r=e.children,o=An(e,Qle);return b.createElement(t7.Provider,{value:o},r)}var eue=function(e){yf(o,e);var r=Sf(o);function o(){return Ts(this,o),r.apply(this,arguments)}return Rs(o,[{key:"render",value:function(){return this.props.children}}]),o}(b.Component),Dd="none",ZE="appear",e_="enter",t_="leave",I5="none",zs="prepare",Hp="start",Wp="active",mx="end",n7="prepared";function A5(e,r){var o={};return o[e.toLowerCase()]=r.toLowerCase(),o["Webkit".concat(e)]="webkit".concat(r),o["Moz".concat(e)]="moz".concat(r),o["ms".concat(e)]="MS".concat(r),o["O".concat(e)]="o".concat(r.toLowerCase()),o}function tue(e,r){var o={animationend:A5("Animation","AnimationEnd"),transitionend:A5("Transition","TransitionEnd")};return e&&("AnimationEvent"in r||delete o.animationend.animation,"TransitionEvent"in r||delete o.transitionend.transition),o}var nue=tue(Io(),typeof window<"u"?window:{}),r7={};if(Io()){var rue=document.createElement("div");r7=rue.style}var n_={};function i7(e){if(n_[e])return n_[e];var r=nue[e];if(r)for(var o=Object.keys(r),s=o.length,c=0;c<s;c+=1){var d=o[c];if(Object.prototype.hasOwnProperty.call(r,d)&&d in r7)return n_[e]=r[d],n_[e]}return""}var o7=i7("animationend"),a7=i7("transitionend"),s7=!!(o7&&a7),O5=o7||"animationend",x5=a7||"transitionend";function N5(e,r){if(!e)return null;if(Fn(e)==="object"){var o=r.replace(/-\w/g,function(s){return s[1].toUpperCase()});return e[o]}return"".concat(e,"-").concat(r)}const iue=function(e){var r=b.useRef(),o=b.useRef(e);o.current=e;var s=b.useCallback(function(f){o.current(f)},[]);function c(f){f&&(f.removeEventListener(x5,s),f.removeEventListener(O5,s))}function d(f){r.current&&r.current!==f&&c(r.current),f&&f!==r.current&&(f.addEventListener(x5,s),f.addEventListener(O5,s),r.current=f)}return b.useEffect(function(){return function(){c(r.current)}},[]),[d,c]};var c7=Io()?b.useLayoutEffect:b.useEffect;const oue=function(){var e=b.useRef(null);function r(){ao.cancel(e.current)}function o(s){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;r();var d=ao(function(){c<=1?s({isCanceled:function(){return d!==e.current}}):o(s,c-1)});e.current=d}return b.useEffect(function(){return function(){r()}},[]),[o,r]};var aue=[zs,Hp,Wp,mx],sue=[zs,n7],l7=!1,cue=!0;function u7(e){return e===Wp||e===mx}const lue=function(e,r,o){var s=Kd(I5),c=Ge(s,2),d=c[0],f=c[1],m=oue(),g=Ge(m,2),_=g[0],S=g[1];function T(){f(zs,!0)}var R=r?sue:aue;return c7(function(){if(d!==I5&&d!==mx){var N=R.indexOf(d),A=R[N+1],O=o(d);O===l7?f(A,!0):A&&_(function(M){function x(){M.isCanceled()||f(A,!0)}O===!0?x():Promise.resolve(O).then(x)})}},[e,d]),b.useEffect(function(){return function(){S()}},[]),[T,d]};function uue(e,r,o,s){var c=s.motionEnter,d=c===void 0?!0:c,f=s.motionAppear,m=f===void 0?!0:f,g=s.motionLeave,_=g===void 0?!0:g,S=s.motionDeadline,T=s.motionLeaveImmediately,R=s.onAppearPrepare,N=s.onEnterPrepare,A=s.onLeavePrepare,O=s.onAppearStart,M=s.onEnterStart,x=s.onLeaveStart,P=s.onAppearActive,D=s.onEnterActive,F=s.onLeaveActive,$=s.onAppearEnd,V=s.onEnterEnd,W=s.onLeaveEnd,K=s.onVisibleChanged,Q=Kd(),Y=Ge(Q,2),ee=Y[0],te=Y[1],ie=Kd(Dd),le=Ge(ie,2),me=le[0],ce=le[1],se=Kd(null),ae=Ge(se,2),ge=ae[0],Se=ae[1],de=b.useRef(!1),he=b.useRef(null);function be(){return o()}var ve=b.useRef(!1);function ke(){ce(Dd,!0),Se(null,!0)}function Le(dt){var rt=be();if(!(dt&&!dt.deadline&&dt.target!==rt)){var et=ve.current,lt;me===ZE&&et?lt=$==null?void 0:$(rt,dt):me===e_&&et?lt=V==null?void 0:V(rt,dt):me===t_&&et&&(lt=W==null?void 0:W(rt,dt)),me!==Dd&&et&&lt!==!1&&ke()}}var $e=iue(Le),Ve=Ge($e,1),ut=Ve[0],ht=function(rt){var et,lt,Dt;switch(rt){case ZE:return et={},ct(et,zs,R),ct(et,Hp,O),ct(et,Wp,P),et;case e_:return lt={},ct(lt,zs,N),ct(lt,Hp,M),ct(lt,Wp,D),lt;case t_:return Dt={},ct(Dt,zs,A),ct(Dt,Hp,x),ct(Dt,Wp,F),Dt;default:return{}}},Ct=b.useMemo(function(){return ht(me)},[me]),gt=lue(me,!e,function(dt){if(dt===zs){var rt=Ct[zs];return rt?rt(be()):l7}if(Lt in Ct){var et;Se(((et=Ct[Lt])===null||et===void 0?void 0:et.call(Ct,be(),null))||null)}return Lt===Wp&&(ut(be()),S>0&&(clearTimeout(he.current),he.current=setTimeout(function(){Le({deadline:!0})},S))),Lt===n7&&ke(),cue}),kt=Ge(gt,2),It=kt[0],Lt=kt[1],Yt=u7(Lt);ve.current=Yt,c7(function(){te(r);var dt=de.current;de.current=!0;var rt;!dt&&r&&m&&(rt=ZE),dt&&r&&d&&(rt=e_),(dt&&!r&&_||!dt&&T&&!r&&_)&&(rt=t_);var et=ht(rt);rt&&(e||et[zs])?(ce(rt),It()):ce(Dd)},[r]),b.useEffect(function(){(me===ZE&&!m||me===e_&&!d||me===t_&&!_)&&ce(Dd)},[m,d,_]),b.useEffect(function(){return function(){de.current=!1,clearTimeout(he.current)}},[]);var jt=b.useRef(!1);b.useEffect(function(){ee&&(jt.current=!0),ee!==void 0&&me===Dd&&((jt.current||ee)&&(K==null||K(ee)),jt.current=!0)},[ee,me]);var He=ge;return Ct[zs]&&Lt===Hp&&(He=Oe({transition:"none"},He)),[me,Lt,He,ee??r]}function due(e){var r=e;Fn(e)==="object"&&(r=e.transitionSupport);function o(c,d){return!!(c.motionName&&r&&d!==!1)}var s=b.forwardRef(function(c,d){var f=c.visible,m=f===void 0?!0:f,g=c.removeOnLeave,_=g===void 0?!0:g,S=c.forceRender,T=c.children,R=c.motionName,N=c.leavedClassName,A=c.eventProps,O=b.useContext(t7),M=O.motion,x=o(c,M),P=b.useRef(),D=b.useRef();function F(){try{return P.current instanceof HTMLElement?P.current:O_(D.current)}catch{return null}}var $=uue(x,m,F,c),V=Ge($,4),W=V[0],K=V[1],Q=V[2],Y=V[3],ee=b.useRef(Y);Y&&(ee.current=!0);var te=b.useCallback(function(Se){P.current=Se,rx(d,Se)},[d]),ie,le=Oe(Oe({},A),{},{visible:m});if(!T)ie=null;else if(W===Dd)Y?ie=T(Oe({},le),te):!_&&ee.current&&N?ie=T(Oe(Oe({},le),{},{className:N}),te):S||!_&&!N?ie=T(Oe(Oe({},le),{},{style:{display:"none"}}),te):ie=null;else{var me,ce;K===zs?ce="prepare":u7(K)?ce="active":K===Hp&&(ce="start");var se=N5(R,"".concat(W,"-").concat(ce));ie=T(Oe(Oe({},le),{},{className:Xe(N5(R,W),(me={},ct(me,se,se&&ce),ct(me,R,typeof R=="string"),me)),style:Q}),te)}if(b.isValidElement(ie)&&Cf(ie)){var ae=ie,ge=ae.ref;ge||(ie=b.cloneElement(ie,{ref:te}))}return b.createElement(eue,{ref:D},ie)});return s.displayName="CSSMotion",s}const ch=due(s7);var uA="add",dA="keep",hA="remove",F1="removed";function hue(e){var r;return e&&Fn(e)==="object"&&"key"in e?r=e:r={key:e},Oe(Oe({},r),{},{key:String(r.key)})}function pA(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return e.map(hue)}function pue(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=[],s=0,c=r.length,d=pA(e),f=pA(r);d.forEach(function(_){for(var S=!1,T=s;T<c;T+=1){var R=f[T];if(R.key===_.key){s<T&&(o=o.concat(f.slice(s,T).map(function(N){return Oe(Oe({},N),{},{status:uA})})),s=T),o.push(Oe(Oe({},R),{},{status:dA})),s+=1,S=!0;break}}S||o.push(Oe(Oe({},_),{},{status:hA}))}),s<c&&(o=o.concat(f.slice(s).map(function(_){return Oe(Oe({},_),{},{status:uA})})));var m={};o.forEach(function(_){var S=_.key;m[S]=(m[S]||0)+1});var g=Object.keys(m).filter(function(_){return m[_]>1});return g.forEach(function(_){o=o.filter(function(S){var T=S.key,R=S.status;return T!==_||R!==hA}),o.forEach(function(S){S.key===_&&(S.status=dA)})}),o}var fue=["component","children","onVisibleChanged","onAllRemoved"],mue=["status"],gue=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function vue(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ch,o=function(s){yf(d,s);var c=Sf(d);function d(){var f;Ts(this,d);for(var m=arguments.length,g=new Array(m),_=0;_<m;_++)g[_]=arguments[_];return f=c.call.apply(c,[this].concat(g)),ct(fy(f),"state",{keyEntities:[]}),ct(fy(f),"removeKey",function(S){var T=f.state.keyEntities,R=T.map(function(N){return N.key!==S?N:Oe(Oe({},N),{},{status:F1})});return f.setState({keyEntities:R}),R.filter(function(N){var A=N.status;return A!==F1}).length}),f}return Rs(d,[{key:"render",value:function(){var m=this,g=this.state.keyEntities,_=this.props,S=_.component,T=_.children,R=_.onVisibleChanged,N=_.onAllRemoved,A=An(_,fue),O=S||b.Fragment,M={};return gue.forEach(function(x){M[x]=A[x],delete A[x]}),delete A.keys,b.createElement(O,A,g.map(function(x,P){var D=x.status,F=An(x,mue),$=D===uA||D===dA;return b.createElement(r,Ze({},M,{key:F.key,visible:$,eventProps:F,onVisibleChanged:function(W){if(R==null||R(W,{key:F.key}),!W){var K=m.removeKey(F.key);K===0&&N&&N()}}}),function(V,W){return T(Oe(Oe({},V),{},{index:P}),W)})}))}}],[{key:"getDerivedStateFromProps",value:function(m,g){var _=m.keys,S=g.keyEntities,T=pA(_),R=pue(S,T);return{keyEntities:R.filter(function(N){var A=S.find(function(O){var M=O.key;return N.key===M});return!(A&&A.status===F1&&N.status===hA)})}}}]),d}(b.Component);return ct(o,"defaultProps",{component:"div"}),o}const d7=vue(s7);function Eue(e){const{children:r}=e,[,o]=Tf(),{motion:s}=o,c=b.useRef(!1);return c.current=c.current||s===!1,c.current?b.createElement(Zle,{motion:s},r):r}const _ue=(e,r)=>{const[o,s]=Tf();return rA({theme:o,token:s,hashId:"",path:["ant-design-icons",e],nonce:()=>r==null?void 0:r.nonce},()=>[{[`.${e}`]:Object.assign(Object.assign({},Y$()),{[`.${e} .${e}-icon`]:{display:"block"}})}])},yue=_ue;var Sue=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const Cue=["getTargetContainer","getPopupContainer","renderEmpty","pageHeader","input","pagination","form","select","button"],bue="ant";let by,h7,p7;function D_(){return by||bue}function Tue(){return h7||fx}function Rue(e){return Object.keys(e).some(r=>r.endsWith("Color"))}const wue=e=>{let{prefixCls:r,iconPrefixCls:o,theme:s}=e;r!==void 0&&(by=r),o!==void 0&&(h7=o),s&&(Rue(s)?Yle(D_(),s):p7=s)},f7=()=>({getPrefixCls:(e,r)=>r||(e?`${D_()}-${e}`:D_()),getIconPrefixCls:Tue,getRootPrefixCls:()=>by||D_(),getTheme:()=>p7}),Iue=e=>{const{children:r,csp:o,autoInsertSpaceInButton:s,form:c,locale:d,componentSize:f,direction:m,space:g,virtual:_,dropdownMatchSelectWidth:S,popupMatchSelectWidth:T,popupOverflow:R,legacyLocale:N,parentContext:A,iconPrefixCls:O,theme:M,componentDisabled:x}=e,P=b.useCallback((me,ce)=>{const{prefixCls:se}=e;if(ce)return ce;const ae=se||A.getPrefixCls("");return me?`${ae}-${me}`:ae},[A.getPrefixCls,e.prefixCls]),D=O||A.iconPrefixCls||fx,F=D!==A.iconPrefixCls,$=o||A.csp,V=yue(D,$),W=Jle(M,A.theme),K={csp:$,autoInsertSpaceInButton:s,locale:d||N,direction:m,space:g,virtual:_,popupMatchSelectWidth:T??S,popupOverflow:R,getPrefixCls:P,iconPrefixCls:D,theme:W},Q=Object.assign({},A);Object.keys(K).forEach(me=>{K[me]!==void 0&&(Q[me]=K[me])}),Cue.forEach(me=>{const ce=e[me];ce&&(Q[me]=ce)});const Y=bS(()=>Q,Q,(me,ce)=>{const se=Object.keys(me),ae=Object.keys(ce);return se.length!==ae.length||se.some(ge=>me[ge]!==ce[ge])}),ee=b.useMemo(()=>({prefixCls:D,csp:$}),[D,$]);let te=F?V(r):r;const ie=b.useMemo(()=>{var me,ce,se;return $p(((me=cf.Form)===null||me===void 0?void 0:me.defaultValidateMessages)||{},((se=(ce=Y.locale)===null||ce===void 0?void 0:ce.Form)===null||se===void 0?void 0:se.defaultValidateMessages)||{},(c==null?void 0:c.validateMessages)||{})},[Y,c==null?void 0:c.validateMessages]);Object.keys(ie).length>0&&(te=b.createElement(F$.Provider,{value:ie},r)),d&&(te=b.createElement(ole,{locale:d,_ANT_MARK__:rle},te)),(D||$)&&(te=b.createElement(dx.Provider,{value:ee},te)),f&&(te=b.createElement(e7,{size:f},te)),te=b.createElement(Eue,null,te);const le=b.useMemo(()=>{const me=W||{},{algorithm:ce,token:se}=me,ae=Sue(me,["algorithm","token"]),ge=ce&&(!Array.isArray(ce)||ce.length>0)?_y(ce):void 0;return Object.assign(Object.assign({},ae),{theme:ge,token:Object.assign(Object.assign({},dg),se)})},[W]);return M&&(te=b.createElement(J$.Provider,{value:le},te)),x!==void 0&&(te=b.createElement(Q$,{disabled:x},te)),b.createElement(or.Provider,{value:Y},te)},wf=e=>{const r=b.useContext(or),o=b.useContext(hx);return b.createElement(Iue,Object.assign({parentContext:r,legacyLocale:o},e))};wf.ConfigContext=or;wf.SizeContext=xS;wf.config=wue;wf.useConfig=Xle;Object.defineProperty(wf,"SizeContext",{get:()=>xS});var m7={};Object.defineProperty(m7,"__esModule",{value:!0});var Aue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"},Oue=m7.default=Aue,xue=1/0,Nue="[object Symbol]",Pue=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Due=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,NS="\\ud800-\\udfff",g7="\\u0300-\\u036f\\ufe20-\\ufe23",v7="\\u20d0-\\u20f0",E7="\\u2700-\\u27bf",_7="a-z\\xdf-\\xf6\\xf8-\\xff",kue="\\xac\\xb1\\xd7\\xf7",Lue="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Mue="\\u2000-\\u206f",Fue=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",y7="A-Z\\xc0-\\xd6\\xd8-\\xde",S7="\\ufe0e\\ufe0f",C7=kue+Lue+Mue+Fue,gx="['â]",Uue="["+NS+"]",P5="["+C7+"]",Ty="["+g7+v7+"]",b7="\\d+",Bue="["+E7+"]",T7="["+_7+"]",R7="[^"+NS+C7+b7+E7+_7+y7+"]",fA="\\ud83c[\\udffb-\\udfff]",jue="(?:"+Ty+"|"+fA+")",w7="[^"+NS+"]",vx="(?:\\ud83c[\\udde6-\\uddff]){2}",Ex="[\\ud800-\\udbff][\\udc00-\\udfff]",Ip="["+y7+"]",I7="\\u200d",D5="(?:"+T7+"|"+R7+")",Vue="(?:"+Ip+"|"+R7+")",k5="(?:"+gx+"(?:d|ll|m|re|s|t|ve))?",L5="(?:"+gx+"(?:D|LL|M|RE|S|T|VE))?",A7=jue+"?",O7="["+S7+"]?",$ue="(?:"+I7+"(?:"+[w7,vx,Ex].join("|")+")"+O7+A7+")*",x7=O7+A7+$ue,Hue="(?:"+[Bue,vx,Ex].join("|")+")"+x7,Wue="(?:"+[w7+Ty+"?",Ty,vx,Ex,Uue].join("|")+")",Gue=RegExp(gx,"g"),zue=RegExp(Ty,"g"),Kue=RegExp(fA+"(?="+fA+")|"+Wue+x7,"g"),Yue=RegExp([Ip+"?"+T7+"+"+k5+"(?="+[P5,Ip,"$"].join("|")+")",Vue+"+"+L5+"(?="+[P5,Ip+D5,"$"].join("|")+")",Ip+"?"+D5+"+"+k5,Ip+"+"+L5,b7,Hue].join("|"),"g"),que=RegExp("["+I7+NS+g7+v7+S7+"]"),Xue=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Jue={Ã:"A",Ã:"A",Ã:"A",Ã:"A",Ã:"A",Ã:"A",Ã :"a",Ã¡:"a",Ã¢:"a",Ã£:"a",Ã¤:"a",Ã¥:"a",Ã:"C",Ã§:"c",Ã:"D",Ã°:"d",Ã:"E",Ã:"E",Ã:"E",Ã:"E",Ã¨:"e",Ã©:"e",Ãª:"e",Ã«:"e",Ã:"I",Ã:"I",Ã:"I",Ã:"I",Ã¬:"i",Ã­:"i",Ã®:"i",Ã¯:"i",Ã:"N",Ã±:"n",Ã:"O",Ã:"O",Ã:"O",Ã:"O",Ã:"O",Ã:"O",Ã²:"o",Ã³:"o",Ã´:"o",Ãµ:"o",Ã¶:"o",Ã¸:"o",Ã:"U",Ã:"U",Ã:"U",Ã:"U",Ã¹:"u",Ãº:"u",Ã»:"u",Ã¼:"u",Ã:"Y",Ã½:"y",Ã¿:"y",Ã:"Ae",Ã¦:"ae",Ã:"Th",Ã¾:"th",Ã:"ss",Ä:"A",Ä:"A",Ä:"A",Ä:"a",Ä:"a",Ä:"a",Ä:"C",Ä:"C",Ä:"C",Ä:"C",Ä:"c",Ä:"c",Ä:"c",Ä:"c",Ä:"D",Ä:"D",Ä:"d",Ä:"d",Ä:"E",Ä:"E",Ä:"E",Ä:"E",Ä:"E",Ä:"e",Ä:"e",Ä:"e",Ä:"e",Ä:"e",Ä:"G",Ä:"G",Ä :"G",Ä¢:"G",Ä:"g",Ä:"g",Ä¡:"g",Ä£:"g",Ä¤:"H",Ä¦:"H",Ä¥:"h",Ä§:"h",Ä¨:"I",Äª:"I",Ä¬:"I",Ä®:"I",Ä°:"I",Ä©:"i",Ä«:"i",Ä­:"i",Ä¯:"i",Ä±:"i",Ä´:"J",Äµ:"j",Ä¶:"K",Ä·:"k",Ä¸:"k",Ä¹:"L",Ä»:"L",Ä½:"L",Ä¿:"L",Å:"L",Äº:"l",Ä¼:"l",Ä¾:"l",Å:"l",Å:"l",Å:"N",Å:"N",Å:"N",Å:"N",Å:"n",Å:"n",Å:"n",Å:"n",Å:"O",Å:"O",Å:"O",Å:"o",Å:"o",Å:"o",Å:"R",Å:"R",Å:"R",Å:"r",Å:"r",Å:"r",Å:"S",Å:"S",Å:"S",Å :"S",Å:"s",Å:"s",Å:"s",Å¡:"s",Å¢:"T",Å¤:"T",Å¦:"T",Å£:"t",Å¥:"t",Å§:"t",Å¨:"U",Åª:"U",Å¬:"U",Å®:"U",Å°:"U",Å²:"U",Å©:"u",Å«:"u",Å­:"u",Å¯:"u",Å±:"u",Å³:"u",Å´:"W",Åµ:"w",Å¶:"Y",Å·:"y",Å¸:"Y",Å¹:"Z",Å»:"Z",Å½:"Z",Åº:"z",Å¼:"z",Å¾:"z",Ä²:"IJ",Ä³:"ij",Å:"Oe",Å:"oe",Å:"'n",Å¿:"ss"},Que=typeof Ft=="object"&&Ft&&Ft.Object===Object&&Ft,Zue=typeof self=="object"&&self&&self.Object===Object&&self,ede=Que||Zue||Function("return this")();function tde(e,r,o,s){var c=-1,d=e?e.length:0;for(s&&d&&(o=e[++c]);++c<d;)o=r(o,e[c],c,e);return o}function nde(e){return e.split("")}function rde(e){return e.match(Pue)||[]}function ide(e){return function(r){return e==null?void 0:e[r]}}var ode=ide(Jue);function N7(e){return que.test(e)}function ade(e){return Xue.test(e)}function sde(e){return N7(e)?cde(e):nde(e)}function cde(e){return e.match(Kue)||[]}function lde(e){return e.match(Yue)||[]}var ude=Object.prototype,dde=ude.toString,M5=ede.Symbol,F5=M5?M5.prototype:void 0,U5=F5?F5.toString:void 0;function hde(e,r,o){var s=-1,c=e.length;r<0&&(r=-r>c?0:c+r),o=o>c?c:o,o<0&&(o+=c),c=r>o?0:o-r>>>0,r>>>=0;for(var d=Array(c);++s<c;)d[s]=e[s+r];return d}function pde(e){if(typeof e=="string")return e;if(Ede(e))return U5?U5.call(e):"";var r=e+"";return r=="0"&&1/e==-xue?"-0":r}function fde(e,r,o){var s=e.length;return o=o===void 0?s:o,!r&&o>=s?e:hde(e,r,o)}function mde(e){return function(r){r=PS(r);var o=N7(r)?sde(r):void 0,s=o?o[0]:r.charAt(0),c=o?fde(o,1).join(""):r.slice(1);return s[e]()+c}}function gde(e){return function(r){return tde(bde(Sde(r).replace(Gue,"")),e,"")}}function vde(e){return!!e&&typeof e=="object"}function Ede(e){return typeof e=="symbol"||vde(e)&&dde.call(e)==Nue}function PS(e){return e==null?"":pde(e)}var _de=gde(function(e,r,o){return r=r.toLowerCase(),e+(o?yde(r):r)});function yde(e){return Cde(PS(e).toLowerCase())}function Sde(e){return e=PS(e),e&&e.replace(Due,ode).replace(zue,"")}var Cde=mde("toUpperCase");function bde(e,r,o){return e=PS(e),r=o?void 0:r,r===void 0?ade(e)?lde(e):rde(e):e.match(r)||[]}var Tde=_de;const Rde=Ol(Tde);var fg={},P7={exports:{}};(function(e){function r(o){return o&&o.__esModule?o:{default:o}}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(P7);var wde=P7.exports,_x={};Object.defineProperty(_x,"__esModule",{value:!0});_x.default=Ide;function Ide(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var yx={};Object.defineProperty(yx,"__esModule",{value:!0});yx.default=Ade;function Ade(e,r){if(!e)return!1;if(e.contains)return e.contains(r);for(var o=r;o;){if(o===e)return!0;o=o.parentNode}return!1}var D7=wde.default;Object.defineProperty(fg,"__esModule",{value:!0});fg.clearContainerCache=Mde;fg.injectCSS=Sx;fg.removeCSS=kde;var Ode=fg.updateCSS=Fde,xde=D7(_x),Nde=D7(yx),B5="data-rc-order",j5="data-rc-priority",Pde="rc-util-key",Ry=new Map;function k7(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.mark;return r?r.startsWith("data-")?r:"data-".concat(r):Pde}function DS(e){if(e.attachTo)return e.attachTo;var r=document.querySelector("head");return r||document.body}function Dde(e){return e==="queue"?"prependQueue":e?"prepend":"append"}function L7(e){return Array.from((Ry.get(e)||e).children).filter(function(r){return r.tagName==="STYLE"})}function Sx(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!(0,xde.default)())return null;var o=r.csp,s=r.prepend,c=r.priority,d=c===void 0?0:c,f=Dde(s),m=f==="prependQueue",g=document.createElement("style");g.setAttribute(B5,f),m&&d&&g.setAttribute(j5,"".concat(d)),o!=null&&o.nonce&&(g.nonce=o==null?void 0:o.nonce),g.innerHTML=e;var _=DS(r),S=_.firstChild;if(s){if(m){var T=L7(_).filter(function(R){if(!["prepend","prependQueue"].includes(R.getAttribute(B5)))return!1;var N=Number(R.getAttribute(j5)||0);return d>=N});if(T.length)return _.insertBefore(g,T[T.length-1].nextSibling),g}_.insertBefore(g,S)}else _.appendChild(g);return g}function M7(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=DS(r);return L7(o).find(function(s){return s.getAttribute(k7(r))===e})}function kde(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=M7(e,r);if(o){var s=DS(r);s.removeChild(o)}}function Lde(e,r){var o=Ry.get(e);if(!o||!(0,Nde.default)(document,o)){var s=Sx("",r),c=s.parentNode;Ry.set(e,c),e.removeChild(s)}}function Mde(){Ry.clear()}function Fde(e,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=DS(o);Lde(s,o);var c=M7(r,o);if(c){var d,f;if((d=o.csp)!==null&&d!==void 0&&d.nonce&&c.nonce!==((f=o.csp)===null||f===void 0?void 0:f.nonce)){var m;c.nonce=(m=o.csp)===null||m===void 0?void 0:m.nonce}return c.innerHTML!==e&&(c.innerHTML=e),c}var g=Sx(e,o);return g.setAttribute(k7(o),r),g}var Cx={};Object.defineProperty(Cx,"__esModule",{value:!0});var Ude=Cx.getShadowRoot=Bde;Cx.inShadow=U7;function F7(e){var r;return e==null||(r=e.getRootNode)===null||r===void 0?void 0:r.call(e)}function U7(e){return F7(e)instanceof ShadowRoot}function Bde(e){return U7(e)?F7(e):null}var sc={};Object.defineProperty(sc,"__esModule",{value:!0});sc.call=bx;var B7=sc.default=void 0;sc.note=$7;sc.noteOnce=W7;sc.preMessage=void 0;sc.resetWarned=H7;sc.warning=V7;sc.warningOnce=mg;var mA={},j7=function(r){};sc.preMessage=j7;function V7(e,r){}function $7(e,r){}function H7(){mA={}}function bx(e,r,o){!r&&!mA[o]&&(e(!1,o),mA[o]=!0)}function mg(e,r){bx(V7,e,r)}function W7(e,r){bx($7,e,r)}mg.preMessage=j7;mg.resetWarned=H7;mg.noteOnce=W7;var jde=mg;B7=sc.default=jde;function Vde(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function V5(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){Vde(e,c,o[c])})}return e}function $de(e,r){B7(e,"[@ant-design/icons] ".concat(r))}function $5(e){return typeof e=="object"&&typeof e.name=="string"&&typeof e.theme=="string"&&(typeof e.icon=="object"||typeof e.icon=="function")}function H5(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(e).reduce(function(r,o){var s=e[o];switch(o){case"class":r.className=s,delete r.class;break;default:delete r[o],r[Rde(o)]=s}return r},{})}function gA(e,r,o){return o?St.createElement(e.tag,V5({key:r},H5(e.attrs),o),(e.children||[]).map(function(s,c){return gA(s,"".concat(r,"-").concat(e.tag,"-").concat(c))})):St.createElement(e.tag,V5({key:r},H5(e.attrs)),(e.children||[]).map(function(s,c){return gA(s,"".concat(r,"-").concat(e.tag,"-").concat(c))}))}function G7(e){return Rl(e)[0]}function z7(e){return e?Array.isArray(e)?e:[e]:[]}var Hde=`
.anticon {
  display: inline-block;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,Wde=function(e){var r=b.useContext(dx),o=r.csp,s=r.prefixCls,c=Hde;s&&(c=c.replace(/anticon/g,s)),b.useEffect(function(){var d=e.current,f=Ude(d);Ode(c,"@ant-design-icons",{prepend:!0,csp:o,attachTo:f})},[])};function Gde(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function vA(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){Gde(e,c,o[c])})}return e}function zde(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function W5(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zde(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}function Kde(e,r){if(e==null)return{};var o=Yde(e,r),s,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)s=d[c],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(o[s]=e[s])}return o}function Yde(e,r){if(e==null)return{};var o={},s=Object.keys(e),c,d;for(d=0;d<s.length;d++)c=s[d],!(r.indexOf(c)>=0)&&(o[c]=e[c]);return o}var ym={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function qde(e){var r=e.primaryColor,o=e.secondaryColor;ym.primaryColor=r,ym.secondaryColor=o||G7(r),ym.calculated=!!o}function Xde(){return vA({},ym)}var kS=function(e){var r=e.icon,o=e.className,s=e.onClick,c=e.style,d=e.primaryColor,f=e.secondaryColor,m=Kde(e,["icon","className","onClick","style","primaryColor","secondaryColor"]),g=b.useRef(),_=ym;if(d&&(_={primaryColor:d,secondaryColor:f||G7(d)}),Wde(g),$de($5(r),"icon should be icon definiton, but got ".concat(r)),!$5(r))return null;var S=r;return S&&typeof S.icon=="function"&&(S=W5(vA({},S),{icon:S.icon(_.primaryColor,_.secondaryColor)})),gA(S.icon,"svg-".concat(S.name),W5(vA({className:o,onClick:s,style:c,"data-icon":S.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},m),{ref:g}))};kS.displayName="IconReact";kS.getTwoToneColors=Xde;kS.setTwoToneColors=qde;const Tx=kS;function G5(e,r){(r==null||r>e.length)&&(r=e.length);for(var o=0,s=new Array(r);o<r;o++)s[o]=e[o];return s}function Jde(e){if(Array.isArray(e))return e}function Qde(e,r){var o=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(o!=null){var s=[],c=!0,d=!1,f,m;try{for(o=o.call(e);!(c=(f=o.next()).done)&&(s.push(f.value),!(r&&s.length===r));c=!0);}catch(g){d=!0,m=g}finally{try{!c&&o.return!=null&&o.return()}finally{if(d)throw m}}return s}}function Zde(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ehe(e,r){return Jde(e)||Qde(e,r)||the(e,r)||Zde()}function the(e,r){if(e){if(typeof e=="string")return G5(e,r);var o=Object.prototype.toString.call(e).slice(8,-1);if(o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set")return Array.from(o);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return G5(e,r)}}function K7(e){var r=ehe(z7(e),2),o=r[0],s=r[1];return Tx.setTwoToneColors({primaryColor:o,secondaryColor:s})}function nhe(){var e=Tx.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor}function z5(e,r){(r==null||r>e.length)&&(r=e.length);for(var o=0,s=new Array(r);o<r;o++)s[o]=e[o];return s}function rhe(e){if(Array.isArray(e))return e}function EA(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function ihe(e,r){var o=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(o!=null){var s=[],c=!0,d=!1,f,m;try{for(o=o.call(e);!(c=(f=o.next()).done)&&(s.push(f.value),!(r&&s.length===r));c=!0);}catch(g){d=!0,m=g}finally{try{!c&&o.return!=null&&o.return()}finally{if(d)throw m}}return s}}function ohe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ahe(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){EA(e,c,o[c])})}return e}function she(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function che(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):she(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}function lhe(e,r){if(e==null)return{};var o=uhe(e,r),s,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)s=d[c],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(o[s]=e[s])}return o}function uhe(e,r){if(e==null)return{};var o={},s=Object.keys(e),c,d;for(d=0;d<s.length;d++)c=s[d],!(r.indexOf(c)>=0)&&(o[c]=e[c]);return o}function dhe(e,r){return rhe(e)||ihe(e,r)||hhe(e,r)||ohe()}function hhe(e,r){if(e){if(typeof e=="string")return z5(e,r);var o=Object.prototype.toString.call(e).slice(8,-1);if(o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set")return Array.from(o);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return z5(e,r)}}K7(Tle.primary);var LS=b.forwardRef(function(e,r){var o=e.className,s=e.icon,c=e.spin,d=e.rotate,f=e.tabIndex,m=e.onClick,g=e.twoToneColor,_=lhe(e,["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"]),S=b.useContext(dx),T=S.prefixCls,R=T===void 0?"anticon":T,N=S.rootClassName,A,O=Xe(N,R,(A={},EA(A,"".concat(R,"-").concat(s.name),!!s.name),EA(A,"".concat(R,"-spin"),!!c||s.name==="loading"),A),o),M=f;M===void 0&&m&&(M=-1);var x=d?{msTransform:"rotate(".concat(d,"deg)"),transform:"rotate(".concat(d,"deg)")}:void 0,P=dhe(z7(g),2),D=P[0],F=P[1];return b.createElement("span",che(ahe({role:"img","aria-label":s.name},_),{ref:r,tabIndex:M,onClick:m,className:O}),b.createElement(Tx,{icon:s,primaryColor:D,secondaryColor:F,style:x}))});LS.displayName="AntdIcon";LS.getTwoToneColor=nhe;LS.setTwoToneColor=K7;const Yi=LS;function phe(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function fhe(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){phe(e,c,o[c])})}return e}function mhe(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function ghe(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mhe(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var vhe=function(e,r){return b.createElement(Yi,ghe(fhe({},e),{ref:r,icon:Oue}))};const Y7=b.forwardRef(vhe);var q7={};Object.defineProperty(q7,"__esModule",{value:!0});var Ehe={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"},_he=q7.default=Ehe;function yhe(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function She(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){yhe(e,c,o[c])})}return e}function Che(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function bhe(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Che(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var The=function(e,r){return b.createElement(Yi,bhe(She({},e),{ref:r,icon:_he}))};const MS=b.forwardRef(The);var X7={};Object.defineProperty(X7,"__esModule",{value:!0});var Rhe={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z"}}]},name:"close",theme:"outlined"},whe=X7.default=Rhe;function Ihe(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function Ahe(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){Ihe(e,c,o[c])})}return e}function Ohe(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function xhe(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ohe(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var Nhe=function(e,r){return b.createElement(Yi,xhe(Ahe({},e),{ref:r,icon:whe}))};const Phe=b.forwardRef(Nhe);var J7={};Object.defineProperty(J7,"__esModule",{value:!0});var Dhe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"},khe=J7.default=Dhe;function Lhe(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function Mhe(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){Lhe(e,c,o[c])})}return e}function Fhe(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Uhe(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fhe(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var Bhe=function(e,r){return b.createElement(Yi,Uhe(Mhe({},e),{ref:r,icon:khe}))};const Q7=b.forwardRef(Bhe);var Z7={};Object.defineProperty(Z7,"__esModule",{value:!0});var jhe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"info-circle",theme:"filled"},Vhe=Z7.default=jhe;function $he(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function Hhe(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){$he(e,c,o[c])})}return e}function Whe(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Ghe(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Whe(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var zhe=function(e,r){return b.createElement(Yi,Ghe(Hhe({},e),{ref:r,icon:Vhe}))};const Khe=b.forwardRef(zhe),{isValidElement:$u}=Yd;function e9(e){return e&&$u(e)&&e.type===b.Fragment}function Yhe(e,r,o){return $u(e)?b.cloneElement(e,typeof o=="function"?o(e.props||{}):o):r}function nc(e,r){return Yhe(e,e,r)}const K5=e=>typeof e=="object"&&e!=null&&e.nodeType===1,Y5=(e,r)=>(!r||e!=="hidden")&&e!=="visible"&&e!=="clip",U1=(e,r)=>{if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){const o=getComputedStyle(e,null);return Y5(o.overflowY,r)||Y5(o.overflowX,r)||(s=>{const c=(d=>{if(!d.ownerDocument||!d.ownerDocument.defaultView)return null;try{return d.ownerDocument.defaultView.frameElement}catch{return null}})(s);return!!c&&(c.clientHeight<s.scrollHeight||c.clientWidth<s.scrollWidth)})(e)}return!1},r_=(e,r,o,s,c,d,f,m)=>d<e&&f>r||d>e&&f<r?0:d<=e&&m<=o||f>=r&&m>=o?d-e-s:f>r&&m<o||d<e&&m>o?f-r+c:0,qhe=e=>{const r=e.parentElement;return r??(e.getRootNode().host||null)},q5=(e,r)=>{var o,s,c,d;if(typeof document>"u")return[];const{scrollMode:f,block:m,inline:g,boundary:_,skipOverflowHiddenElements:S}=r,T=typeof _=="function"?_:ce=>ce!==_;if(!K5(e))throw new TypeError("Invalid target");const R=document.scrollingElement||document.documentElement,N=[];let A=e;for(;K5(A)&&T(A);){if(A=qhe(A),A===R){N.push(A);break}A!=null&&A===document.body&&U1(A)&&!U1(document.documentElement)||A!=null&&U1(A,S)&&N.push(A)}const O=(s=(o=window.visualViewport)==null?void 0:o.width)!=null?s:innerWidth,M=(d=(c=window.visualViewport)==null?void 0:c.height)!=null?d:innerHeight,{scrollX:x,scrollY:P}=window,{height:D,width:F,top:$,right:V,bottom:W,left:K}=e.getBoundingClientRect(),{top:Q,right:Y,bottom:ee,left:te}=(ce=>{const se=window.getComputedStyle(ce);return{top:parseFloat(se.scrollMarginTop)||0,right:parseFloat(se.scrollMarginRight)||0,bottom:parseFloat(se.scrollMarginBottom)||0,left:parseFloat(se.scrollMarginLeft)||0}})(e);let ie=m==="start"||m==="nearest"?$-Q:m==="end"?W+ee:$+D/2-Q+ee,le=g==="center"?K+F/2-te+Y:g==="end"?V+Y:K-te;const me=[];for(let ce=0;ce<N.length;ce++){const se=N[ce],{height:ae,width:ge,top:Se,right:de,bottom:he,left:be}=se.getBoundingClientRect();if(f==="if-needed"&&$>=0&&K>=0&&W<=M&&V<=O&&$>=Se&&W<=he&&K>=be&&V<=de)return me;const ve=getComputedStyle(se),ke=parseInt(ve.borderLeftWidth,10),Le=parseInt(ve.borderTopWidth,10),$e=parseInt(ve.borderRightWidth,10),Ve=parseInt(ve.borderBottomWidth,10);let ut=0,ht=0;const Ct="offsetWidth"in se?se.offsetWidth-se.clientWidth-ke-$e:0,gt="offsetHeight"in se?se.offsetHeight-se.clientHeight-Le-Ve:0,kt="offsetWidth"in se?se.offsetWidth===0?0:ge/se.offsetWidth:0,It="offsetHeight"in se?se.offsetHeight===0?0:ae/se.offsetHeight:0;if(R===se)ut=m==="start"?ie:m==="end"?ie-M:m==="nearest"?r_(P,P+M,M,Le,Ve,P+ie,P+ie+D,D):ie-M/2,ht=g==="start"?le:g==="center"?le-O/2:g==="end"?le-O:r_(x,x+O,O,ke,$e,x+le,x+le+F,F),ut=Math.max(0,ut+P),ht=Math.max(0,ht+x);else{ut=m==="start"?ie-Se-Le:m==="end"?ie-he+Ve+gt:m==="nearest"?r_(Se,he,ae,Le,Ve+gt,ie,ie+D,D):ie-(Se+ae/2)+gt/2,ht=g==="start"?le-be-ke:g==="center"?le-(be+ge/2)+Ct/2:g==="end"?le-de+$e+Ct:r_(be,de,ge,ke,$e+Ct,le,le+F,F);const{scrollLeft:Lt,scrollTop:Yt}=se;ut=It===0?0:Math.max(0,Math.min(Yt+ut/It,se.scrollHeight-ae/It+gt)),ht=kt===0?0:Math.max(0,Math.min(Lt+ht/kt,se.scrollWidth-ge/kt+Ct)),ie+=Yt-ut,le+=Lt-ht}me.push({el:se,top:ut,left:ht})}return me},Xhe=e=>e===!1?{block:"end",inline:"nearest"}:(r=>r===Object(r)&&Object.keys(r).length!==0)(e)?e:{block:"start",inline:"nearest"};function Jhe(e,r){if(!e.isConnected||!(c=>{let d=c;for(;d&&d.parentNode;){if(d.parentNode===document)return!0;d=d.parentNode instanceof ShadowRoot?d.parentNode.host:d.parentNode}return!1})(e))return;const o=(c=>{const d=window.getComputedStyle(c);return{top:parseFloat(d.scrollMarginTop)||0,right:parseFloat(d.scrollMarginRight)||0,bottom:parseFloat(d.scrollMarginBottom)||0,left:parseFloat(d.scrollMarginLeft)||0}})(e);if((c=>typeof c=="object"&&typeof c.behavior=="function")(r))return r.behavior(q5(e,r));const s=typeof r=="boolean"||r==null?void 0:r.behavior;for(const{el:c,top:d,left:f}of q5(e,Xhe(r))){const m=d-o.top+o.bottom,g=f-o.left+o.right;c.scroll({top:m,left:g,behavior:s})}}var bt={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(r){var o=r.keyCode;if(r.altKey&&!r.ctrlKey||r.metaKey||o>=bt.F1&&o<=bt.F12)return!1;switch(o){case bt.ALT:case bt.CAPS_LOCK:case bt.CONTEXT_MENU:case bt.CTRL:case bt.DOWN:case bt.END:case bt.ESC:case bt.HOME:case bt.INSERT:case bt.LEFT:case bt.MAC_FF_META:case bt.META:case bt.NUMLOCK:case bt.NUM_CENTER:case bt.PAGE_DOWN:case bt.PAGE_UP:case bt.PAUSE:case bt.PRINT_SCREEN:case bt.RIGHT:case bt.SHIFT:case bt.UP:case bt.WIN_KEY:case bt.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(r){if(r>=bt.ZERO&&r<=bt.NINE||r>=bt.NUM_ZERO&&r<=bt.NUM_MULTIPLY||r>=bt.A&&r<=bt.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&r===0)return!0;switch(r){case bt.SPACE:case bt.QUESTION_MARK:case bt.NUM_PLUS:case bt.NUM_MINUS:case bt.NUM_PERIOD:case bt.NUM_DIVISION:case bt.SEMICOLON:case bt.DASH:case bt.EQUALS:case bt.COMMA:case bt.PERIOD:case bt.SLASH:case bt.APOSTROPHE:case bt.SINGLE_QUOTE:case bt.OPEN_SQUARE_BRACKET:case bt.BACKSLASH:case bt.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},Qhe=b.forwardRef(function(e,r){var o=e.prefixCls,s=e.style,c=e.className,d=e.duration,f=d===void 0?4.5:d,m=e.eventKey,g=e.content,_=e.closable,S=e.closeIcon,T=S===void 0?"x":S,R=e.props,N=e.onClick,A=e.onNoticeClose,O=e.times,M=b.useState(!1),x=Ge(M,2),P=x[0],D=x[1],F=function(){A(m)},$=function(K){(K.key==="Enter"||K.code==="Enter"||K.keyCode===bt.ENTER)&&F()};b.useEffect(function(){if(!P&&f>0){var W=setTimeout(function(){F()},f*1e3);return function(){clearTimeout(W)}}},[f,P,O]);var V="".concat(o,"-notice");return b.createElement("div",Ze({},R,{ref:r,className:Xe(V,c,ct({},"".concat(V,"-closable"),_)),style:s,onMouseEnter:function(){D(!0)},onMouseLeave:function(){D(!1)},onClick:N}),b.createElement("div",{className:"".concat(V,"-content")},g),_&&b.createElement("a",{tabIndex:0,className:"".concat(V,"-close"),onKeyDown:$,onClick:function(K){K.preventDefault(),K.stopPropagation(),F()}},T))});const t9=Qhe;var Zhe=b.forwardRef(function(e,r){var o=e.prefixCls,s=o===void 0?"rc-notification":o,c=e.container,d=e.motion,f=e.maxCount,m=e.className,g=e.style,_=e.onAllRemoved,S=b.useState([]),T=Ge(S,2),R=T[0],N=T[1],A=function(W){var K,Q=R.find(function(Y){return Y.key===W});Q==null||(K=Q.onClose)===null||K===void 0||K.call(Q),N(function(Y){return Y.filter(function(ee){return ee.key!==W})})};b.useImperativeHandle(r,function(){return{open:function(W){N(function(K){var Q=at(K),Y=Q.findIndex(function(ie){return ie.key===W.key}),ee=Oe({},W);if(Y>=0){var te;ee.times=(((te=K[Y])===null||te===void 0?void 0:te.times)||0)+1,Q[Y]=ee}else ee.times=0,Q.push(ee);return f>0&&Q.length>f&&(Q=Q.slice(-f)),Q})},close:function(W){A(W)},destroy:function(){N([])}}});var O=b.useState({}),M=Ge(O,2),x=M[0],P=M[1];b.useEffect(function(){var V={};R.forEach(function(W){var K=W.placement,Q=K===void 0?"topRight":K;Q&&(V[Q]=V[Q]||[],V[Q].push(W))}),Object.keys(x).forEach(function(W){V[W]=V[W]||[]}),P(V)},[R]);var D=function(W){P(function(K){var Q=Oe({},K),Y=Q[W]||[];return Y.length||delete Q[W],Q})},F=b.useRef(!1);if(b.useEffect(function(){Object.keys(x).length>0?F.current=!0:F.current&&(_==null||_(),F.current=!1)},[x]),!c)return null;var $=Object.keys(x);return Nl.createPortal(b.createElement(b.Fragment,null,$.map(function(V){var W=x[V],K=W.map(function(Y){return{config:Y,key:Y.key}}),Q=typeof d=="function"?d(V):d;return b.createElement(d7,Ze({key:V,className:Xe(s,"".concat(s,"-").concat(V),m==null?void 0:m(V)),style:g==null?void 0:g(V),keys:K,motionAppear:!0},Q,{onAllRemoved:function(){D(V)}}),function(Y,ee){var te=Y.config,ie=Y.className,le=Y.style,me=te.key,ce=te.times,se=te.className,ae=te.style;return b.createElement(t9,Ze({},te,{ref:ee,prefixCls:s,className:Xe(ie,se),style:Oe(Oe({},le),ae),times:ce,key:me,eventKey:me,onNoticeClose:A}))})})),c)}),epe=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved"],tpe=function(){return document.body},X5=0;function npe(){for(var e={},r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return o.forEach(function(c){c&&Object.keys(c).forEach(function(d){var f=c[d];f!==void 0&&(e[d]=f)})}),e}function rpe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.getContainer,o=r===void 0?tpe:r,s=e.motion,c=e.prefixCls,d=e.maxCount,f=e.className,m=e.style,g=e.onAllRemoved,_=An(e,epe),S=b.useState(),T=Ge(S,2),R=T[0],N=T[1],A=b.useRef(),O=b.createElement(Zhe,{container:R,ref:A,prefixCls:c,motion:s,maxCount:d,className:f,style:m,onAllRemoved:g}),M=b.useState([]),x=Ge(M,2),P=x[0],D=x[1],F=b.useMemo(function(){return{open:function(V){var W=npe(_,V);(W.key===null||W.key===void 0)&&(W.key="rc-notification-".concat(X5),X5+=1),D(function(K){return[].concat(at(K),[{type:"open",config:W}])})},close:function(V){D(function(W){return[].concat(at(W),[{type:"close",key:V}])})},destroy:function(){D(function(V){return[].concat(at(V),[{type:"destroy"}])})}}},[]);return b.useEffect(function(){N(o())}),b.useEffect(function(){A.current&&P.length&&(P.forEach(function($){switch($.type){case"open":A.current.open($.config);break;case"close":A.current.close($.key);break;case"destroy":A.current.destroy();break}}),D(function($){return $.filter(function(V){return!P.includes(V)})}))},[P]),[F,O]}var n9={};Object.defineProperty(n9,"__esModule",{value:!0});var ipe={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"},ope=n9.default=ipe;function ape(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function spe(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){ape(e,c,o[c])})}return e}function cpe(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function lpe(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cpe(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var upe=function(e,r){return b.createElement(Yi,lpe(spe({},e),{ref:r,icon:ope}))};const r9=b.forwardRef(upe);function Ha(){Ha=function(){return r};var e,r={},o=Object.prototype,s=o.hasOwnProperty,c=Object.defineProperty||function(ce,se,ae){ce[se]=ae.value},d=typeof Symbol=="function"?Symbol:{},f=d.iterator||"@@iterator",m=d.asyncIterator||"@@asyncIterator",g=d.toStringTag||"@@toStringTag";function _(ce,se,ae){return Object.defineProperty(ce,se,{value:ae,enumerable:!0,configurable:!0,writable:!0}),ce[se]}try{_({},"")}catch{_=function(ae,ge,Se){return ae[ge]=Se}}function S(ce,se,ae,ge){var Se=se&&se.prototype instanceof x?se:x,de=Object.create(Se.prototype),he=new le(ge||[]);return c(de,"_invoke",{value:Y(ce,ae,he)}),de}function T(ce,se,ae){try{return{type:"normal",arg:ce.call(se,ae)}}catch(ge){return{type:"throw",arg:ge}}}r.wrap=S;var R="suspendedStart",N="suspendedYield",A="executing",O="completed",M={};function x(){}function P(){}function D(){}var F={};_(F,f,function(){return this});var $=Object.getPrototypeOf,V=$&&$($(me([])));V&&V!==o&&s.call(V,f)&&(F=V);var W=D.prototype=x.prototype=Object.create(F);function K(ce){["next","throw","return"].forEach(function(se){_(ce,se,function(ae){return this._invoke(se,ae)})})}function Q(ce,se){function ae(Se,de,he,be){var ve=T(ce[Se],ce,de);if(ve.type!=="throw"){var ke=ve.arg,Le=ke.value;return Le&&Fn(Le)=="object"&&s.call(Le,"__await")?se.resolve(Le.__await).then(function($e){ae("next",$e,he,be)},function($e){ae("throw",$e,he,be)}):se.resolve(Le).then(function($e){ke.value=$e,he(ke)},function($e){return ae("throw",$e,he,be)})}be(ve.arg)}var ge;c(this,"_invoke",{value:function(de,he){function be(){return new se(function(ve,ke){ae(de,he,ve,ke)})}return ge=ge?ge.then(be,be):be()}})}function Y(ce,se,ae){var ge=R;return function(Se,de){if(ge===A)throw new Error("Generator is already running");if(ge===O){if(Se==="throw")throw de;return{value:e,done:!0}}for(ae.method=Se,ae.arg=de;;){var he=ae.delegate;if(he){var be=ee(he,ae);if(be){if(be===M)continue;return be}}if(ae.method==="next")ae.sent=ae._sent=ae.arg;else if(ae.method==="throw"){if(ge===R)throw ge=O,ae.arg;ae.dispatchException(ae.arg)}else ae.method==="return"&&ae.abrupt("return",ae.arg);ge=A;var ve=T(ce,se,ae);if(ve.type==="normal"){if(ge=ae.done?O:N,ve.arg===M)continue;return{value:ve.arg,done:ae.done}}ve.type==="throw"&&(ge=O,ae.method="throw",ae.arg=ve.arg)}}}function ee(ce,se){var ae=se.method,ge=ce.iterator[ae];if(ge===e)return se.delegate=null,ae==="throw"&&ce.iterator.return&&(se.method="return",se.arg=e,ee(ce,se),se.method==="throw")||ae!=="return"&&(se.method="throw",se.arg=new TypeError("The iterator does not provide a '"+ae+"' method")),M;var Se=T(ge,ce.iterator,se.arg);if(Se.type==="throw")return se.method="throw",se.arg=Se.arg,se.delegate=null,M;var de=Se.arg;return de?de.done?(se[ce.resultName]=de.value,se.next=ce.nextLoc,se.method!=="return"&&(se.method="next",se.arg=e),se.delegate=null,M):de:(se.method="throw",se.arg=new TypeError("iterator result is not an object"),se.delegate=null,M)}function te(ce){var se={tryLoc:ce[0]};1 in ce&&(se.catchLoc=ce[1]),2 in ce&&(se.finallyLoc=ce[2],se.afterLoc=ce[3]),this.tryEntries.push(se)}function ie(ce){var se=ce.completion||{};se.type="normal",delete se.arg,ce.completion=se}function le(ce){this.tryEntries=[{tryLoc:"root"}],ce.forEach(te,this),this.reset(!0)}function me(ce){if(ce||ce===""){var se=ce[f];if(se)return se.call(ce);if(typeof ce.next=="function")return ce;if(!isNaN(ce.length)){var ae=-1,ge=function Se(){for(;++ae<ce.length;)if(s.call(ce,ae))return Se.value=ce[ae],Se.done=!1,Se;return Se.value=e,Se.done=!0,Se};return ge.next=ge}}throw new TypeError(Fn(ce)+" is not iterable")}return P.prototype=D,c(W,"constructor",{value:D,configurable:!0}),c(D,"constructor",{value:P,configurable:!0}),P.displayName=_(D,g,"GeneratorFunction"),r.isGeneratorFunction=function(ce){var se=typeof ce=="function"&&ce.constructor;return!!se&&(se===P||(se.displayName||se.name)==="GeneratorFunction")},r.mark=function(ce){return Object.setPrototypeOf?Object.setPrototypeOf(ce,D):(ce.__proto__=D,_(ce,g,"GeneratorFunction")),ce.prototype=Object.create(W),ce},r.awrap=function(ce){return{__await:ce}},K(Q.prototype),_(Q.prototype,m,function(){return this}),r.AsyncIterator=Q,r.async=function(ce,se,ae,ge,Se){Se===void 0&&(Se=Promise);var de=new Q(S(ce,se,ae,ge),Se);return r.isGeneratorFunction(se)?de:de.next().then(function(he){return he.done?he.value:de.next()})},K(W),_(W,g,"Generator"),_(W,f,function(){return this}),_(W,"toString",function(){return"[object Generator]"}),r.keys=function(ce){var se=Object(ce),ae=[];for(var ge in se)ae.push(ge);return ae.reverse(),function Se(){for(;ae.length;){var de=ae.pop();if(de in se)return Se.value=de,Se.done=!1,Se}return Se.done=!0,Se}},r.values=me,le.prototype={constructor:le,reset:function(se){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(ie),!se)for(var ae in this)ae.charAt(0)==="t"&&s.call(this,ae)&&!isNaN(+ae.slice(1))&&(this[ae]=e)},stop:function(){this.done=!0;var se=this.tryEntries[0].completion;if(se.type==="throw")throw se.arg;return this.rval},dispatchException:function(se){if(this.done)throw se;var ae=this;function ge(ke,Le){return he.type="throw",he.arg=se,ae.next=ke,Le&&(ae.method="next",ae.arg=e),!!Le}for(var Se=this.tryEntries.length-1;Se>=0;--Se){var de=this.tryEntries[Se],he=de.completion;if(de.tryLoc==="root")return ge("end");if(de.tryLoc<=this.prev){var be=s.call(de,"catchLoc"),ve=s.call(de,"finallyLoc");if(be&&ve){if(this.prev<de.catchLoc)return ge(de.catchLoc,!0);if(this.prev<de.finallyLoc)return ge(de.finallyLoc)}else if(be){if(this.prev<de.catchLoc)return ge(de.catchLoc,!0)}else{if(!ve)throw new Error("try statement without catch or finally");if(this.prev<de.finallyLoc)return ge(de.finallyLoc)}}}},abrupt:function(se,ae){for(var ge=this.tryEntries.length-1;ge>=0;--ge){var Se=this.tryEntries[ge];if(Se.tryLoc<=this.prev&&s.call(Se,"finallyLoc")&&this.prev<Se.finallyLoc){var de=Se;break}}de&&(se==="break"||se==="continue")&&de.tryLoc<=ae&&ae<=de.finallyLoc&&(de=null);var he=de?de.completion:{};return he.type=se,he.arg=ae,de?(this.method="next",this.next=de.finallyLoc,M):this.complete(he)},complete:function(se,ae){if(se.type==="throw")throw se.arg;return se.type==="break"||se.type==="continue"?this.next=se.arg:se.type==="return"?(this.rval=this.arg=se.arg,this.method="return",this.next="end"):se.type==="normal"&&ae&&(this.next=ae),M},finish:function(se){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var ge=this.tryEntries[ae];if(ge.finallyLoc===se)return this.complete(ge.completion,ge.afterLoc),ie(ge),M}},catch:function(se){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var ge=this.tryEntries[ae];if(ge.tryLoc===se){var Se=ge.completion;if(Se.type==="throw"){var de=Se.arg;ie(ge)}return de}}throw new Error("illegal catch attempt")},delegateYield:function(se,ae,ge){return this.delegate={iterator:me(se),resultName:ae,nextLoc:ge},this.method==="next"&&(this.arg=e),M}},r}function J5(e,r,o,s,c,d,f){try{var m=e[d](f),g=m.value}catch(_){o(_);return}m.done?r(g):Promise.resolve(g).then(s,c)}function If(e){return function(){var r=this,o=arguments;return new Promise(function(s,c){var d=e.apply(r,o);function f(g){J5(d,s,c,f,m,"next",g)}function m(g){J5(d,s,c,f,m,"throw",g)}f(void 0)})}}var gg=Oe({},cae),dpe=gg.version,hpe=gg.render,ppe=gg.unmountComponentAtNode,FS;try{var fpe=Number((dpe||"").split(".")[0]);fpe>=18&&(FS=gg.createRoot)}catch{}function Q5(e){var r=gg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;r&&Fn(r)==="object"&&(r.usingClientEntryPoint=e)}var wy="__rc_react_root__";function mpe(e,r){Q5(!0);var o=r[wy]||FS(r);Q5(!1),o.render(e),r[wy]=o}function gpe(e,r){hpe(e,r)}function i9(e,r){if(FS){mpe(e,r);return}gpe(e,r)}function vpe(e){return _A.apply(this,arguments)}function _A(){return _A=If(Ha().mark(function e(r){return Ha().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",Promise.resolve().then(function(){var c;(c=r[wy])===null||c===void 0||c.unmount(),delete r[wy]}));case 1:case"end":return s.stop()}},e)})),_A.apply(this,arguments)}function Epe(e){ppe(e)}function _pe(e){return yA.apply(this,arguments)}function yA(){return yA=If(Ha().mark(function e(r){return Ha().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(FS===void 0){s.next=2;break}return s.abrupt("return",vpe(r));case 2:Epe(r);case 3:case"end":return s.stop()}},e)})),yA.apply(this,arguments)}const US=function(e){if(!e)return!1;if(e instanceof Element){if(e.offsetParent)return!0;if(e.getBBox){var r=e.getBBox(),o=r.width,s=r.height;if(o||s)return!0}if(e.getBoundingClientRect){var c=e.getBoundingClientRect(),d=c.width,f=c.height;if(d||f)return!0}}return!1},ype=e=>{const{componentCls:r,colorPrimary:o}=e;return{[r]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${o})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${e.motionEaseOutCirc}`,`opacity 2s ${e.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0}}}}},Spe=ac("Wave",e=>[ype(e)]);function Cpe(e){const r=(e||"").match(/rgba?\((\d*), (\d*), (\d*)(, [\d.]*)?\)/);return r&&r[1]&&r[2]&&r[3]?!(r[1]===r[2]&&r[2]===r[3]):!0}function B1(e){return e&&e!=="#fff"&&e!=="#ffffff"&&e!=="rgb(255, 255, 255)"&&e!=="rgba(255, 255, 255, 1)"&&Cpe(e)&&!/rgba\((?:\d*, ){3}0\)/.test(e)&&e!=="transparent"}function bpe(e){const{borderTopColor:r,borderColor:o,backgroundColor:s}=getComputedStyle(e);return B1(r)?r:B1(o)?o:B1(s)?s:null}function j1(e){return Number.isNaN(e)?0:e}const Tpe=e=>{const{className:r,target:o}=e,s=b.useRef(null),[c,d]=b.useState(null),[f,m]=b.useState([]),[g,_]=b.useState(0),[S,T]=b.useState(0),[R,N]=b.useState(0),[A,O]=b.useState(0),[M,x]=b.useState(!1),P={left:g,top:S,width:R,height:A,borderRadius:f.map(F=>`${F}px`).join(" ")};c&&(P["--wave-color"]=c);function D(){const F=getComputedStyle(o);d(bpe(o));const $=F.position==="static",{borderLeftWidth:V,borderTopWidth:W}=F;_($?o.offsetLeft:j1(-parseFloat(V))),T($?o.offsetTop:j1(-parseFloat(W))),N(o.offsetWidth),O(o.offsetHeight);const{borderTopLeftRadius:K,borderTopRightRadius:Q,borderBottomLeftRadius:Y,borderBottomRightRadius:ee}=F;m([K,Q,ee,Y].map(te=>j1(parseFloat(te))))}return b.useEffect(()=>{if(o){const F=ao(()=>{D(),x(!0)});let $;return typeof ResizeObserver<"u"&&($=new ResizeObserver(D),$.observe(o)),()=>{ao.cancel(F),$==null||$.disconnect()}}},[]),M?b.createElement(ch,{visible:!0,motionAppear:!0,motionName:"wave-motion",motionDeadline:5e3,onAppearEnd:(F,$)=>{var V;if($.deadline||$.propertyName==="opacity"){const W=(V=s.current)===null||V===void 0?void 0:V.parentElement;_pe(W).then(()=>{W==null||W.remove()})}return!1}},F=>{let{className:$}=F;return b.createElement("div",{ref:s,className:Xe(r,$),style:P})}):null};function Rpe(e,r){const o=document.createElement("div");o.style.position="absolute",o.style.left="0px",o.style.top="0px",e==null||e.insertBefore(o,e==null?void 0:e.firstChild),i9(b.createElement(Tpe,{target:e,className:r}),o)}function wpe(e,r){function o(){const s=e.current;Rpe(s,r)}return o}const Ipe=e=>{const{children:r,disabled:o}=e,{getPrefixCls:s}=b.useContext(or),c=b.useRef(null),d=s("wave"),[,f]=Spe(d),m=wpe(c,Xe(d,f));if(St.useEffect(()=>{const _=c.current;if(!_||_.nodeType!==1||o)return;const S=T=>{T.target.tagName==="INPUT"||!US(T.target)||!_.getAttribute||_.getAttribute("disabled")||_.disabled||_.className.includes("disabled")||_.className.includes("-leave")||m()};return _.addEventListener("click",S,!0),()=>{_.removeEventListener("click",S,!0)}},[o]),!St.isValidElement(r))return r??null;const g=Cf(r)?jc(r.ref,c):c;return nc(r,{ref:g})},Ape=Ipe;globalThis&&globalThis.__rest;const o9=b.createContext(null),Rx=(e,r)=>{const o=b.useContext(o9),s=b.useMemo(()=>{if(!o)return"";const{compactDirection:c,isFirstItem:d,isLastItem:f}=o,m=c==="vertical"?"-vertical-":"-";return Xe({[`${e}-compact${m}item`]:!0,[`${e}-compact${m}first-item`]:d,[`${e}-compact${m}last-item`]:f,[`${e}-compact${m}item-rtl`]:r==="rtl"})},[e,r,o]);return{compactSize:o==null?void 0:o.compactSize,compactDirection:o==null?void 0:o.compactDirection,compactItemClassnames:s}},SA=e=>{let{children:r}=e;return b.createElement(o9.Provider,{value:null},r)},Ope=b.forwardRef((e,r)=>{const{className:o,style:s,children:c,prefixCls:d}=e,f=Xe(`${d}-icon`,o);return St.createElement("span",{ref:r,className:f,style:s},c)}),a9=Ope,Z5=b.forwardRef((e,r)=>{let{prefixCls:o,className:s,style:c,iconClassName:d}=e;const f=Xe(`${o}-loading-icon`,s);return St.createElement(a9,{prefixCls:o,className:f,style:c,ref:r},St.createElement(r9,{className:d}))}),V1=()=>({width:0,opacity:0,transform:"scale(0)"}),$1=e=>({width:e.scrollWidth,opacity:1,transform:"scale(1)"}),xpe=e=>{let{prefixCls:r,loading:o,existIcon:s,className:c,style:d}=e;const f=!!o;return s?St.createElement(Z5,{prefixCls:r,className:c,style:d}):St.createElement(ch,{visible:f,motionName:`${r}-loading-icon-motion`,removeOnLeave:!0,onAppearStart:V1,onAppearActive:$1,onEnterStart:V1,onEnterActive:$1,onLeaveStart:$1,onLeaveActive:V1},(m,g)=>{let{className:_,style:S}=m;return St.createElement(Z5,{prefixCls:r,className:c,style:Object.assign(Object.assign({},d),S),ref:g,iconClassName:_})})},Npe=xpe;var Ppe=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const s9=b.createContext(void 0),Dpe=e=>{const{getPrefixCls:r,direction:o}=b.useContext(or),{prefixCls:s,size:c,className:d}=e,f=Ppe(e,["prefixCls","size","className"]),m=r("btn-group",s),[,,g]=Tf();let _="";switch(c){case"large":_="lg";break;case"small":_="sm";break}const S=Xe(m,{[`${m}-${_}`]:_,[`${m}-rtl`]:o==="rtl"},d,g);return b.createElement(s9.Provider,{value:c},b.createElement("div",Object.assign({},f,{className:S})))},kpe=Dpe,eB=/^[\u4e00-\u9fa5]{2}$/,CA=eB.test.bind(eB);function Lpe(e){return typeof e=="string"}function H1(e){return e==="text"||e==="link"}function Mpe(e,r){if(e==null)return;const o=r?" ":"";return typeof e!="string"&&typeof e!="number"&&Lpe(e.type)&&CA(e.props.children)?nc(e,{children:e.props.children.split("").join(o)}):typeof e=="string"?CA(e)?St.createElement("span",null,e.split("").join(o)):St.createElement("span",null,e):e9(e)?St.createElement("span",null,e):e}function Fpe(e,r){let o=!1;const s=[];return St.Children.forEach(e,c=>{const d=typeof c,f=d==="string"||d==="number";if(o&&f){const m=s.length-1,g=s[m];s[m]=`${g}${c}`}else s.push(c);o=f}),St.Children.map(s,c=>Mpe(c,r))}function Upe(e,r,o){const{focusElCls:s,focus:c,borderElCls:d}=o,f=d?"> *":"",m=["hover",c?"focus":null,"active"].filter(Boolean).map(g=>`&:${g} ${f}`).join(",");return{[`&-item:not(${r}-last-item)`]:{marginInlineEnd:-e.lineWidth},"&-item":Object.assign(Object.assign({[m]:{zIndex:2}},s?{[`&${s}`]:{zIndex:2}}:{}),{[`&[disabled] ${f}`]:{zIndex:0}})}}function Bpe(e,r,o){const{borderElCls:s}=o,c=s?`> ${s}`:"";return{[`&-item:not(${r}-first-item):not(${r}-last-item) ${c}`]:{borderRadius:0},[`&-item:not(${r}-last-item)${r}-first-item`]:{[`& ${c}, &${e}-sm ${c}, &${e}-lg ${c}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${r}-first-item)${r}-last-item`]:{[`& ${c}, &${e}-sm ${c}, &${e}-lg ${c}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function c9(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{focus:!0};const{componentCls:o}=e,s=`${o}-compact`;return{[s]:Object.assign(Object.assign({},Upe(e,s,r)),Bpe(o,s,r))}}function jpe(e,r){return{[`&-item:not(${r}-last-item)`]:{marginBottom:-e.lineWidth},"&-item":{"&:hover,&:focus,&:active":{zIndex:2},"&[disabled]":{zIndex:0}}}}function Vpe(e,r){return{[`&-item:not(${r}-first-item):not(${r}-last-item)`]:{borderRadius:0},[`&-item${r}-first-item:not(${r}-last-item)`]:{[`&, &${e}-sm, &${e}-lg`]:{borderEndEndRadius:0,borderEndStartRadius:0}},[`&-item${r}-last-item:not(${r}-first-item)`]:{[`&, &${e}-sm, &${e}-lg`]:{borderStartStartRadius:0,borderStartEndRadius:0}}}}function $pe(e){const r=`${e.componentCls}-compact-vertical`;return{[r]:Object.assign(Object.assign({},jpe(e,r)),Vpe(e.componentCls,r))}}const tB=(e,r)=>({[`> span, > ${e}`]:{"&:not(:last-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineEndColor:r}}},"&:not(:first-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineStartColor:r}}}}}),Hpe=e=>{const{componentCls:r,fontSize:o,lineWidth:s,colorPrimaryHover:c,colorErrorHover:d}=e;return{[`${r}-group`]:[{position:"relative",display:"inline-flex",[`> span, > ${r}`]:{"&:not(:last-child)":{[`&, & > ${r}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},"&:not(:first-child)":{marginInlineStart:-s,[`&, & > ${r}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}},[r]:{position:"relative",zIndex:1,"&:hover,\n          &:focus,\n          &:active":{zIndex:2},"&[disabled]":{zIndex:0}},[`${r}-icon-only`]:{fontSize:o}},tB(`${r}-primary`,c),tB(`${r}-danger`,d)]}},Wpe=Hpe,Gpe=e=>{const{componentCls:r,iconCls:o,buttonFontWeight:s}=e;return{[r]:{outline:"none",position:"relative",display:"inline-block",fontWeight:s,whiteSpace:"nowrap",textAlign:"center",backgroundImage:"none",backgroundColor:"transparent",border:`${e.lineWidth}px ${e.lineType} transparent`,cursor:"pointer",transition:`all ${e.motionDurationMid} ${e.motionEaseInOut}`,userSelect:"none",touchAction:"manipulation",lineHeight:e.lineHeight,color:e.colorText,"&:disabled > *":{pointerEvents:"none"},"> span":{display:"inline-block"},[`${r}-icon`]:{lineHeight:0},[`> ${o} + span, > span + ${o}`]:{marginInlineStart:e.marginXS},[`&:not(${r}-icon-only) > ${r}-icon`]:{[`&${r}-loading-icon, &:not(:last-child)`]:{marginInlineEnd:e.marginXS}},"> a":{color:"currentColor"},"&:not(:disabled)":Object.assign({},Vle(e)),[`&-icon-only${r}-compact-item`]:{flex:"none"},[`&-compact-item${r}-primary`]:{[`&:not([disabled]) + ${r}-compact-item${r}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:-e.lineWidth,insetInlineStart:-e.lineWidth,display:"inline-block",width:e.lineWidth,height:`calc(100% + ${e.lineWidth*2}px)`,backgroundColor:e.colorPrimaryHover,content:'""'}}},"&-compact-vertical-item":{[`&${r}-primary`]:{[`&:not([disabled]) + ${r}-compact-vertical-item${r}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:-e.lineWidth,insetInlineStart:-e.lineWidth,display:"inline-block",width:`calc(100% + ${e.lineWidth*2}px)`,height:e.lineWidth,backgroundColor:e.colorPrimaryHover,content:'""'}}}}}}},wl=(e,r,o)=>({[`&:not(:disabled):not(${e}-disabled)`]:{"&:hover":r,"&:active":o}}),zpe=e=>({minWidth:e.controlHeight,paddingInlineStart:0,paddingInlineEnd:0,borderRadius:"50%"}),Kpe=e=>({borderRadius:e.controlHeight,paddingInlineStart:e.controlHeight/2,paddingInlineEnd:e.controlHeight/2}),Ype=e=>({cursor:"not-allowed",borderColor:e.colorBorder,color:e.colorTextDisabled,backgroundColor:e.colorBgContainerDisabled,boxShadow:"none"}),Iy=(e,r,o,s,c,d,f)=>({[`&${e}-background-ghost`]:Object.assign(Object.assign({color:r||void 0,backgroundColor:"transparent",borderColor:o||void 0,boxShadow:"none"},wl(e,Object.assign({backgroundColor:"transparent"},d),Object.assign({backgroundColor:"transparent"},f))),{"&:disabled":{cursor:"not-allowed",color:s||void 0,borderColor:c||void 0}})}),wx=e=>({[`&:disabled, &${e.componentCls}-disabled`]:Object.assign({},Ype(e))}),l9=e=>Object.assign({},wx(e)),Ay=e=>({[`&:disabled, &${e.componentCls}-disabled`]:{cursor:"not-allowed",color:e.colorTextDisabled}}),u9=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l9(e)),{backgroundColor:e.colorBgContainer,borderColor:e.colorBorder,boxShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlTmpOutline}`}),wl(e.componentCls,{color:e.colorPrimaryHover,borderColor:e.colorPrimaryHover},{color:e.colorPrimaryActive,borderColor:e.colorPrimaryActive})),Iy(e.componentCls,e.colorBgContainer,e.colorBgContainer,e.colorTextDisabled,e.colorBorder)),{[`&${e.componentCls}-dangerous`]:Object.assign(Object.assign(Object.assign({color:e.colorError,borderColor:e.colorError},wl(e.componentCls,{color:e.colorErrorHover,borderColor:e.colorErrorBorderHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),Iy(e.componentCls,e.colorError,e.colorError,e.colorTextDisabled,e.colorBorder)),wx(e))}),qpe=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l9(e)),{color:e.colorTextLightSolid,backgroundColor:e.colorPrimary,boxShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlOutline}`}),wl(e.componentCls,{color:e.colorTextLightSolid,backgroundColor:e.colorPrimaryHover},{color:e.colorTextLightSolid,backgroundColor:e.colorPrimaryActive})),Iy(e.componentCls,e.colorPrimary,e.colorPrimary,e.colorTextDisabled,e.colorBorder,{color:e.colorPrimaryHover,borderColor:e.colorPrimaryHover},{color:e.colorPrimaryActive,borderColor:e.colorPrimaryActive})),{[`&${e.componentCls}-dangerous`]:Object.assign(Object.assign(Object.assign({backgroundColor:e.colorError,boxShadow:`0 ${e.controlOutlineWidth}px 0 ${e.colorErrorOutline}`},wl(e.componentCls,{backgroundColor:e.colorErrorHover},{backgroundColor:e.colorErrorActive})),Iy(e.componentCls,e.colorError,e.colorError,e.colorTextDisabled,e.colorBorder,{color:e.colorErrorHover,borderColor:e.colorErrorHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),wx(e))}),Xpe=e=>Object.assign(Object.assign({},u9(e)),{borderStyle:"dashed"}),Jpe=e=>Object.assign(Object.assign(Object.assign({color:e.colorLink},wl(e.componentCls,{color:e.colorLinkHover},{color:e.colorLinkActive})),Ay(e)),{[`&${e.componentCls}-dangerous`]:Object.assign(Object.assign({color:e.colorError},wl(e.componentCls,{color:e.colorErrorHover},{color:e.colorErrorActive})),Ay(e))}),Qpe=e=>Object.assign(Object.assign(Object.assign({},wl(e.componentCls,{color:e.colorText,backgroundColor:e.colorBgTextHover},{color:e.colorText,backgroundColor:e.colorBgTextActive})),Ay(e)),{[`&${e.componentCls}-dangerous`]:Object.assign(Object.assign({color:e.colorError},Ay(e)),wl(e.componentCls,{color:e.colorErrorHover,backgroundColor:e.colorErrorBg},{color:e.colorErrorHover,backgroundColor:e.colorErrorBg}))}),Zpe=e=>{const{componentCls:r}=e;return{[`${r}-default`]:u9(e),[`${r}-primary`]:qpe(e),[`${r}-dashed`]:Xpe(e),[`${r}-link`]:Jpe(e),[`${r}-text`]:Qpe(e)}},Ix=function(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const{componentCls:o,controlHeight:s,fontSize:c,lineHeight:d,lineWidth:f,borderRadius:m,buttonPaddingHorizontal:g,iconCls:_}=e,S=Math.max(0,(s-c*d)/2-f),T=g-f,R=`${o}-icon-only`;return[{[`${o}${r}`]:{fontSize:c,height:s,padding:`${S}px ${T}px`,borderRadius:m,[`&${R}`]:{width:s,paddingInlineStart:0,paddingInlineEnd:0,[`&${o}-round`]:{width:"auto"},[_]:{fontSize:e.buttonIconOnlyFontSize}},[`&${o}-loading`]:{opacity:e.opacityLoading,cursor:"default"},[`${o}-loading-icon`]:{transition:`width ${e.motionDurationSlow} ${e.motionEaseInOut}, opacity ${e.motionDurationSlow} ${e.motionEaseInOut}`}}},{[`${o}${o}-circle${r}`]:zpe(e)},{[`${o}${o}-round${r}`]:Kpe(e)}]},efe=e=>Ix(e),tfe=e=>{const r=lo(e,{controlHeight:e.controlHeightSM,padding:e.paddingXS,buttonPaddingHorizontal:8,borderRadius:e.borderRadiusSM,buttonIconOnlyFontSize:e.fontSizeLG-2});return Ix(r,`${e.componentCls}-sm`)},nfe=e=>{const r=lo(e,{controlHeight:e.controlHeightLG,fontSize:e.fontSizeLG,borderRadius:e.borderRadiusLG,buttonIconOnlyFontSize:e.fontSizeLG+2});return Ix(r,`${e.componentCls}-lg`)},rfe=e=>{const{componentCls:r}=e;return{[r]:{[`&${r}-block`]:{width:"100%"}}}},ife=ac("Button",e=>{const{controlTmpOutline:r,paddingContentHorizontal:o}=e,s=lo(e,{colorOutlineDefault:r,buttonPaddingHorizontal:o,buttonIconOnlyFontSize:e.fontSizeLG,buttonFontWeight:400});return[Gpe(s),tfe(s),efe(s),nfe(s),rfe(s),Zpe(s),Wpe(s),c9(e),$pe(e)]});var ofe=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function afe(e){if(typeof e=="object"&&e){const r=e==null?void 0:e.delay;return{loading:!1,delay:!Number.isNaN(r)&&typeof r=="number"?r:0}}return{loading:!!e,delay:0}}const sfe=(e,r)=>{var o,s;const{loading:c=!1,prefixCls:d,type:f="default",danger:m,shape:g="default",size:_,styles:S,disabled:T,className:R,rootClassName:N,children:A,icon:O,ghost:M=!1,block:x=!1,htmlType:P="button",classNames:D,style:F={}}=e,$=ofe(e,["loading","prefixCls","type","danger","shape","size","styles","disabled","className","rootClassName","children","icon","ghost","block","htmlType","classNames","style"]),{getPrefixCls:V,autoInsertSpaceInButton:W,direction:K,button:Q}=b.useContext(or),Y=V("btn",d),[ee,te]=ife(Y),ie=b.useContext(pg),le=T??ie,me=b.useContext(s9),ce=b.useMemo(()=>afe(c),[c]),[se,ae]=b.useState(ce.loading),[ge,Se]=b.useState(!1),he=jc(r,b.createRef()),be=b.Children.count(A)===1&&!O&&!H1(f);b.useEffect(()=>{let rt=null;ce.delay>0?rt=setTimeout(()=>{rt=null,ae(!0)},ce.delay):ae(ce.loading);function et(){rt&&(clearTimeout(rt),rt=null)}return et},[ce]),b.useEffect(()=>{if(!he||!he.current||W===!1)return;const rt=he.current.textContent;be&&CA(rt)?ge||Se(!0):ge&&Se(!1)},[he]);const ve=rt=>{const{onClick:et}=e;if(se||le){rt.preventDefault();return}et==null||et(rt)},ke=W!==!1,{compactSize:Le,compactItemClassnames:$e}=Rx(Y,K),Ve={large:"lg",small:"sm",middle:void 0},ut=Rf(rt=>{var et,lt;return(lt=(et=_??Le)!==null&&et!==void 0?et:me)!==null&&lt!==void 0?lt:rt}),ht=ut&&Ve[ut]||"",Ct=se?"loading":O,gt=ma($,["navigate"]),kt=Xe(Y,te,{[`${Y}-${g}`]:g!=="default"&&g,[`${Y}-${f}`]:f,[`${Y}-${ht}`]:ht,[`${Y}-icon-only`]:!A&&A!==0&&!!Ct,[`${Y}-background-ghost`]:M&&!H1(f),[`${Y}-loading`]:se,[`${Y}-two-chinese-chars`]:ge&&ke&&!se,[`${Y}-block`]:x,[`${Y}-dangerous`]:!!m,[`${Y}-rtl`]:K==="rtl"},$e,R,N,Q==null?void 0:Q.className),It=Object.assign(Object.assign({},Q==null?void 0:Q.style),F),Lt=Xe(D==null?void 0:D.icon,(o=Q==null?void 0:Q.classNames)===null||o===void 0?void 0:o.icon),Yt=Object.assign(Object.assign({},(S==null?void 0:S.icon)||{}),((s=Q==null?void 0:Q.styles)===null||s===void 0?void 0:s.icon)||{}),jt=O&&!se?St.createElement(a9,{prefixCls:Y,className:Lt,style:Yt},O):St.createElement(Npe,{existIcon:!!O,prefixCls:Y,loading:!!se}),He=A||A===0?Fpe(A,be&&ke):null;if(gt.href!==void 0)return ee(St.createElement("a",Object.assign({},gt,{className:Xe(kt,{[`${Y}-disabled`]:le}),style:It,onClick:ve,ref:he}),jt,He));let dt=St.createElement("button",Object.assign({},$,{type:P,className:kt,style:It,onClick:ve,disabled:le,ref:he}),jt,He);return H1(f)||(dt=St.createElement(Ape,{disabled:!!se},dt)),ee(dt)},Ax=b.forwardRef(sfe);Ax.Group=kpe;Ax.__ANT_BUTTON=!0;const wi=Ax,W1=()=>({height:0,opacity:0}),nB=e=>{const{scrollHeight:r}=e;return{height:r,opacity:1}},cfe=e=>({height:e?e.offsetHeight:0}),G1=(e,r)=>(r==null?void 0:r.deadline)===!0||r.propertyName==="height",lfe=function(){return{motionName:`${arguments.length>0&&arguments[0]!==void 0?arguments[0]:"ant"}-motion-collapse`,onAppearStart:W1,onEnterStart:W1,onAppearActive:nB,onEnterActive:nB,onLeaveStart:cfe,onLeaveActive:W1,onAppearEnd:G1,onEnterEnd:G1,onLeaveEnd:G1,motionDeadline:500}},ufe=(e,r,o)=>o!==void 0?o:`${e}-${r}`,bA=lfe;var d9=b.createContext(null),rB=[];function dfe(e,r){var o=b.useState(function(){if(!Io())return null;var A=document.createElement("div");return A}),s=Ge(o,1),c=s[0],d=b.useRef(!1),f=b.useContext(d9),m=b.useState(rB),g=Ge(m,2),_=g[0],S=g[1],T=f||(d.current?void 0:function(A){S(function(O){var M=[A].concat(at(O));return M})});function R(){c.parentElement||document.body.appendChild(c),d.current=!0}function N(){var A;(A=c.parentElement)===null||A===void 0||A.removeChild(c),d.current=!1}return qr(function(){return e?f?f(R):R():N(),N},[e]),qr(function(){_.length&&(_.forEach(function(A){return A()}),S(rB))},[_]),[c,T]}var z1;function hfe(e){if(typeof document>"u")return 0;if(e||z1===void 0){var r=document.createElement("div");r.style.width="100%",r.style.height="200px";var o=document.createElement("div"),s=o.style;s.position="absolute",s.top="0",s.left="0",s.pointerEvents="none",s.visibility="hidden",s.width="200px",s.height="150px",s.overflow="hidden",o.appendChild(r),document.body.appendChild(o);var c=r.offsetWidth;o.style.overflow="scroll";var d=r.offsetWidth;c===d&&(d=o.clientWidth),document.body.removeChild(o),z1=c-d}return z1}function iB(e){var r=e.match(/^(.*)px$/),o=Number(r==null?void 0:r[1]);return Number.isNaN(o)?hfe():o}function pfe(e){if(typeof document>"u"||!e||!(e instanceof Element))return{width:0,height:0};var r=getComputedStyle(e,"::-webkit-scrollbar"),o=r.width,s=r.height;return{width:iB(o),height:iB(s)}}function ffe(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth}var mfe="rc-util-locker-".concat(Date.now()),oB=0;function gfe(e){var r=!!e,o=b.useState(function(){return oB+=1,"".concat(mfe,"_").concat(oB)}),s=Ge(o,1),c=s[0];qr(function(){if(r){var d=pfe(document.body).width,f=ffe();zm(`
html body {
  overflow-y: hidden;
  `.concat(f?"width: calc(100% - ".concat(d,"px);"):"",`
}`),c)}else Ey(c);return function(){Ey(c)}},[r,c])}var aB=!1;function vfe(e){return typeof e=="boolean"&&(aB=e),aB}var sB=function(r){return r===!1?!1:!Io()||!r?null:typeof r=="string"?document.querySelector(r):typeof r=="function"?r():r},h9=b.forwardRef(function(e,r){var o=e.open,s=e.autoLock,c=e.getContainer;e.debug;var d=e.autoDestroy,f=d===void 0?!0:d,m=e.children,g=b.useState(o),_=Ge(g,2),S=_[0],T=_[1],R=S||o;b.useEffect(function(){(f||o)&&T(o)},[o,f]);var N=b.useState(function(){return sB(c)}),A=Ge(N,2),O=A[0],M=A[1];b.useEffect(function(){var ee=sB(c);M(ee??null)});var x=dfe(R&&!O),P=Ge(x,2),D=P[0],F=P[1],$=O??D;gfe(s&&o&&Io()&&($===D||$===document.body));var V=null;if(m&&Cf(m)&&r){var W=m;V=W.ref}var K=TS(V,r);if(!R||!Io()||O===void 0)return null;var Q=$===!1||vfe(),Y=m;return r&&(Y=b.cloneElement(m,{ref:K})),b.createElement(d9.Provider,{value:F},Q?Y:Nl.createPortal(Y,$))});function Efe(){var e=Oe({},Yd);return e.useId}var cB=0,lB=Efe();const _fe=lB?function(r){var o=lB();return r||o}:function(r){var o=b.useState("ssr-id"),s=Ge(o,2),c=s[0],d=s[1];return b.useEffect(function(){var f=cB;cB+=1,d("rc_unique_".concat(f))},[]),r||c};var p9=function(r){if(Io()&&window.document.documentElement){var o=Array.isArray(r)?r:[r],s=window.document.documentElement;return o.some(function(c){return c in s.style})}return!1},yfe=function(r,o){if(!p9(r))return!1;var s=document.createElement("div"),c=s.style[r];return s.style[r]=o,s.style[r]!==c};function uB(e,r){return!Array.isArray(e)&&r!==void 0?yfe(e,r):p9(e)}const Sfe=()=>Io()&&window.document.documentElement;let i_;const Cfe=()=>{if(!Sfe())return!1;if(i_!==void 0)return i_;const e=document.createElement("div");return e.style.display="flex",e.style.flexDirection="column",e.style.rowGap="1px",e.appendChild(document.createElement("div")),e.appendChild(document.createElement("div")),document.body.appendChild(e),i_=e.scrollHeight===1,document.body.removeChild(e),i_};var Bd="RC_FORM_INTERNAL_HOOKS",pr=function(){pa(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},eh=b.createContext({getFieldValue:pr,getFieldsValue:pr,getFieldError:pr,getFieldWarning:pr,getFieldsError:pr,isFieldsTouched:pr,isFieldTouched:pr,isFieldValidating:pr,isFieldsValidating:pr,resetFields:pr,setFields:pr,setFieldValue:pr,setFieldsValue:pr,validateFields:pr,submit:pr,getInternalHooks:function(){return pr(),{dispatch:pr,initEntityValue:pr,registerField:pr,useSubscribe:pr,setInitialValues:pr,destroyForm:pr,setCallbacks:pr,registerWatch:pr,getFields:pr,setValidateMessages:pr,setPreserve:pr,getInitialValue:pr}}}),qm=b.createContext(null);function TA(e){return e==null?[]:Array.isArray(e)?e:[e]}function bfe(e){return e&&!!e._init}function jd(){return jd=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},jd.apply(this,arguments)}function Tfe(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,Xm(e,r)}function RA(e){return RA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},RA(e)}function Xm(e,r){return Xm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,c){return s.__proto__=c,s},Xm(e,r)}function Rfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function k_(e,r,o){return Rfe()?k_=Reflect.construct.bind():k_=function(c,d,f){var m=[null];m.push.apply(m,d);var g=Function.bind.apply(c,m),_=new g;return f&&Xm(_,f.prototype),_},k_.apply(null,arguments)}function wfe(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function wA(e){var r=typeof Map=="function"?new Map:void 0;return wA=function(s){if(s===null||!wfe(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof r<"u"){if(r.has(s))return r.get(s);r.set(s,c)}function c(){return k_(s,arguments,RA(this).constructor)}return c.prototype=Object.create(s.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),Xm(c,s)},wA(e)}var Ife=/%[sdj%]/g,Afe=function(){};typeof process<"u"&&process.env;function IA(e){if(!e||!e.length)return null;var r={};return e.forEach(function(o){var s=o.field;r[s]=r[s]||[],r[s].push(o)}),r}function Ba(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];var c=0,d=o.length;if(typeof e=="function")return e.apply(null,o);if(typeof e=="string"){var f=e.replace(Ife,function(m){if(m==="%%")return"%";if(c>=d)return m;switch(m){case"%s":return String(o[c++]);case"%d":return Number(o[c++]);case"%j":try{return JSON.stringify(o[c++])}catch{return"[Circular]"}break;default:return m}});return f}return e}function Ofe(e){return e==="string"||e==="url"||e==="hex"||e==="email"||e==="date"||e==="pattern"}function Fi(e,r){return!!(e==null||r==="array"&&Array.isArray(e)&&!e.length||Ofe(r)&&typeof e=="string"&&!e)}function xfe(e,r,o){var s=[],c=0,d=e.length;function f(m){s.push.apply(s,m||[]),c++,c===d&&o(s)}e.forEach(function(m){r(m,f)})}function dB(e,r,o){var s=0,c=e.length;function d(f){if(f&&f.length){o(f);return}var m=s;s=s+1,m<c?r(e[m],d):o([])}d([])}function Nfe(e){var r=[];return Object.keys(e).forEach(function(o){r.push.apply(r,e[o]||[])}),r}var hB=function(e){Tfe(r,e);function r(o,s){var c;return c=e.call(this,"Async Validation Error")||this,c.errors=o,c.fields=s,c}return r}(wA(Error));function Pfe(e,r,o,s,c){if(r.first){var d=new Promise(function(R,N){var A=function(x){return s(x),x.length?N(new hB(x,IA(x))):R(c)},O=Nfe(e);dB(O,o,A)});return d.catch(function(R){return R}),d}var f=r.firstFields===!0?Object.keys(e):r.firstFields||[],m=Object.keys(e),g=m.length,_=0,S=[],T=new Promise(function(R,N){var A=function(M){if(S.push.apply(S,M),_++,_===g)return s(S),S.length?N(new hB(S,IA(S))):R(c)};m.length||(s(S),R(c)),m.forEach(function(O){var M=e[O];f.indexOf(O)!==-1?dB(M,o,A):xfe(M,o,A)})});return T.catch(function(R){return R}),T}function Dfe(e){return!!(e&&e.message!==void 0)}function kfe(e,r){for(var o=e,s=0;s<r.length;s++){if(o==null)return o;o=o[r[s]]}return o}function pB(e,r){return function(o){var s;return e.fullFields?s=kfe(r,e.fullFields):s=r[o.field||e.fullField],Dfe(o)?(o.field=o.field||e.fullField,o.fieldValue=s,o):{message:typeof o=="function"?o():o,fieldValue:s,field:o.field||e.fullField}}}function fB(e,r){if(r){for(var o in r)if(r.hasOwnProperty(o)){var s=r[o];typeof s=="object"&&typeof e[o]=="object"?e[o]=jd({},e[o],s):e[o]=s}}return e}var f9=function(r,o,s,c,d,f){r.required&&(!s.hasOwnProperty(r.field)||Fi(o,f||r.type))&&c.push(Ba(d.messages.required,r.fullField))},Lfe=function(r,o,s,c,d){(/^\s+$/.test(o)||o==="")&&c.push(Ba(d.messages.whitespace,r.fullField))},o_,Mfe=function(){if(o_)return o_;var e="[a-fA-F\\d:]",r=function(F){return F&&F.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},o="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",s="[a-fA-F\\d]{1,4}",c=(`
(?:
(?:`+s+":){7}(?:"+s+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+s+":){6}(?:"+o+"|:"+s+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+s+":){5}(?::"+o+"|(?::"+s+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+s+":){4}(?:(?::"+s+"){0,1}:"+o+"|(?::"+s+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+s+":){3}(?:(?::"+s+"){0,2}:"+o+"|(?::"+s+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+s+":){2}(?:(?::"+s+"){0,3}:"+o+"|(?::"+s+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+s+":){1}(?:(?::"+s+"){0,4}:"+o+"|(?::"+s+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+s+"){0,5}:"+o+"|(?::"+s+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),d=new RegExp("(?:^"+o+"$)|(?:^"+c+"$)"),f=new RegExp("^"+o+"$"),m=new RegExp("^"+c+"$"),g=function(F){return F&&F.exact?d:new RegExp("(?:"+r(F)+o+r(F)+")|(?:"+r(F)+c+r(F)+")","g")};g.v4=function(D){return D&&D.exact?f:new RegExp(""+r(D)+o+r(D),"g")},g.v6=function(D){return D&&D.exact?m:new RegExp(""+r(D)+c+r(D),"g")};var _="(?:(?:[a-z]+:)?//)",S="(?:\\S+(?::\\S*)?@)?",T=g.v4().source,R=g.v6().source,N="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",A="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",O="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",M="(?::\\d{2,5})?",x='(?:[/?#][^\\s"]*)?',P="(?:"+_+"|www\\.)"+S+"(?:localhost|"+T+"|"+R+"|"+N+A+O+")"+M+x;return o_=new RegExp("(?:^"+P+"$)","i"),o_},mB={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},sm={integer:function(r){return sm.number(r)&&parseInt(r,10)===r},float:function(r){return sm.number(r)&&!sm.integer(r)},array:function(r){return Array.isArray(r)},regexp:function(r){if(r instanceof RegExp)return!0;try{return!!new RegExp(r)}catch{return!1}},date:function(r){return typeof r.getTime=="function"&&typeof r.getMonth=="function"&&typeof r.getYear=="function"&&!isNaN(r.getTime())},number:function(r){return isNaN(r)?!1:typeof r=="number"},object:function(r){return typeof r=="object"&&!sm.array(r)},method:function(r){return typeof r=="function"},email:function(r){return typeof r=="string"&&r.length<=320&&!!r.match(mB.email)},url:function(r){return typeof r=="string"&&r.length<=2048&&!!r.match(Mfe())},hex:function(r){return typeof r=="string"&&!!r.match(mB.hex)}},Ffe=function(r,o,s,c,d){if(r.required&&o===void 0){f9(r,o,s,c,d);return}var f=["integer","float","array","regexp","object","method","email","number","date","url","hex"],m=r.type;f.indexOf(m)>-1?sm[m](o)||c.push(Ba(d.messages.types[m],r.fullField,r.type)):m&&typeof o!==r.type&&c.push(Ba(d.messages.types[m],r.fullField,r.type))},Ufe=function(r,o,s,c,d){var f=typeof r.len=="number",m=typeof r.min=="number",g=typeof r.max=="number",_=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,S=o,T=null,R=typeof o=="number",N=typeof o=="string",A=Array.isArray(o);if(R?T="number":N?T="string":A&&(T="array"),!T)return!1;A&&(S=o.length),N&&(S=o.replace(_,"_").length),f?S!==r.len&&c.push(Ba(d.messages[T].len,r.fullField,r.len)):m&&!g&&S<r.min?c.push(Ba(d.messages[T].min,r.fullField,r.min)):g&&!m&&S>r.max?c.push(Ba(d.messages[T].max,r.fullField,r.max)):m&&g&&(S<r.min||S>r.max)&&c.push(Ba(d.messages[T].range,r.fullField,r.min,r.max))},mp="enum",Bfe=function(r,o,s,c,d){r[mp]=Array.isArray(r[mp])?r[mp]:[],r[mp].indexOf(o)===-1&&c.push(Ba(d.messages[mp],r.fullField,r[mp].join(", ")))},jfe=function(r,o,s,c,d){if(r.pattern){if(r.pattern instanceof RegExp)r.pattern.lastIndex=0,r.pattern.test(o)||c.push(Ba(d.messages.pattern.mismatch,r.fullField,o,r.pattern));else if(typeof r.pattern=="string"){var f=new RegExp(r.pattern);f.test(o)||c.push(Ba(d.messages.pattern.mismatch,r.fullField,o,r.pattern))}}},bn={required:f9,whitespace:Lfe,type:Ffe,range:Ufe,enum:Bfe,pattern:jfe},Vfe=function(r,o,s,c,d){var f=[],m=r.required||!r.required&&c.hasOwnProperty(r.field);if(m){if(Fi(o,"string")&&!r.required)return s();bn.required(r,o,c,f,d,"string"),Fi(o,"string")||(bn.type(r,o,c,f,d),bn.range(r,o,c,f,d),bn.pattern(r,o,c,f,d),r.whitespace===!0&&bn.whitespace(r,o,c,f,d))}s(f)},$fe=function(r,o,s,c,d){var f=[],m=r.required||!r.required&&c.hasOwnProperty(r.field);if(m){if(Fi(o)&&!r.required)return s();bn.required(r,o,c,f,d),o!==void 0&&bn.type(r,o,c,f,d)}s(f)},Hfe=function(r,o,s,c,d){var f=[],m=r.required||!r.required&&c.hasOwnProperty(r.field);if(m){if(o===""&&(o=void 0),Fi(o)&&!r.required)return s();bn.required(r,o,c,f,d),o!==void 0&&(bn.type(r,o,c,f,d),bn.range(r,o,c,f,d))}s(f)},Wfe=function(r,o,s,c,d){var f=[],m=r.required||!r.required&&c.hasOwnProperty(r.field);if(m){if(Fi(o)&&!r.required)return s();bn.required(r,o,c,f,d),o!==void 0&&bn.type(r,o,c,f,d)}s(f)},Gfe=function(r,o,s,c,d){var f=[],m=r.required||!r.required&&c.hasOwnProperty(r.field);if(m){if(Fi(o)&&!r.required)return s();bn.required(r,o,c,f,d),Fi(o)||bn.type(r,o,c,f,d)}s(f)},zfe=function(r,o,s,c,d){var f=[],m=r.required||!r.required&&c.hasOwnProperty(r.field);if(m){if(Fi(o)&&!r.required)return s();bn.required(r,o,c,f,d),o!==void 0&&(bn.type(r,o,c,f,d),bn.range(r,o,c,f,d))}s(f)},Kfe=function(r,o,s,c,d){var f=[],m=r.required||!r.required&&c.hasOwnProperty(r.field);if(m){if(Fi(o)&&!r.required)return s();bn.required(r,o,c,f,d),o!==void 0&&(bn.type(r,o,c,f,d),bn.range(r,o,c,f,d))}s(f)},Yfe=function(r,o,s,c,d){var f=[],m=r.required||!r.required&&c.hasOwnProperty(r.field);if(m){if(o==null&&!r.required)return s();bn.required(r,o,c,f,d,"array"),o!=null&&(bn.type(r,o,c,f,d),bn.range(r,o,c,f,d))}s(f)},qfe=function(r,o,s,c,d){var f=[],m=r.required||!r.required&&c.hasOwnProperty(r.field);if(m){if(Fi(o)&&!r.required)return s();bn.required(r,o,c,f,d),o!==void 0&&bn.type(r,o,c,f,d)}s(f)},Xfe="enum",Jfe=function(r,o,s,c,d){var f=[],m=r.required||!r.required&&c.hasOwnProperty(r.field);if(m){if(Fi(o)&&!r.required)return s();bn.required(r,o,c,f,d),o!==void 0&&bn[Xfe](r,o,c,f,d)}s(f)},Qfe=function(r,o,s,c,d){var f=[],m=r.required||!r.required&&c.hasOwnProperty(r.field);if(m){if(Fi(o,"string")&&!r.required)return s();bn.required(r,o,c,f,d),Fi(o,"string")||bn.pattern(r,o,c,f,d)}s(f)},Zfe=function(r,o,s,c,d){var f=[],m=r.required||!r.required&&c.hasOwnProperty(r.field);if(m){if(Fi(o,"date")&&!r.required)return s();if(bn.required(r,o,c,f,d),!Fi(o,"date")){var g;o instanceof Date?g=o:g=new Date(o),bn.type(r,g,c,f,d),g&&bn.range(r,g.getTime(),c,f,d)}}s(f)},e0e=function(r,o,s,c,d){var f=[],m=Array.isArray(o)?"array":typeof o;bn.required(r,o,c,f,d,m),s(f)},K1=function(r,o,s,c,d){var f=r.type,m=[],g=r.required||!r.required&&c.hasOwnProperty(r.field);if(g){if(Fi(o,f)&&!r.required)return s();bn.required(r,o,c,m,d,f),Fi(o,f)||bn.type(r,o,c,m,d)}s(m)},t0e=function(r,o,s,c,d){var f=[],m=r.required||!r.required&&c.hasOwnProperty(r.field);if(m){if(Fi(o)&&!r.required)return s();bn.required(r,o,c,f,d)}s(f)},Sm={string:Vfe,method:$fe,number:Hfe,boolean:Wfe,regexp:Gfe,integer:zfe,float:Kfe,array:Yfe,object:qfe,enum:Jfe,pattern:Qfe,date:Zfe,url:K1,hex:K1,email:K1,required:e0e,any:t0e};function AA(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var r=JSON.parse(JSON.stringify(this));return r.clone=this.clone,r}}}var OA=AA(),vg=function(){function e(o){this.rules=null,this._messages=OA,this.define(o)}var r=e.prototype;return r.define=function(s){var c=this;if(!s)throw new Error("Cannot configure a schema with no rules");if(typeof s!="object"||Array.isArray(s))throw new Error("Rules must be an object");this.rules={},Object.keys(s).forEach(function(d){var f=s[d];c.rules[d]=Array.isArray(f)?f:[f]})},r.messages=function(s){return s&&(this._messages=fB(AA(),s)),this._messages},r.validate=function(s,c,d){var f=this;c===void 0&&(c={}),d===void 0&&(d=function(){});var m=s,g=c,_=d;if(typeof g=="function"&&(_=g,g={}),!this.rules||Object.keys(this.rules).length===0)return _&&_(null,m),Promise.resolve(m);function S(O){var M=[],x={};function P(F){if(Array.isArray(F)){var $;M=($=M).concat.apply($,F)}else M.push(F)}for(var D=0;D<O.length;D++)P(O[D]);M.length?(x=IA(M),_(M,x)):_(null,m)}if(g.messages){var T=this.messages();T===OA&&(T=AA()),fB(T,g.messages),g.messages=T}else g.messages=this.messages();var R={},N=g.keys||Object.keys(this.rules);N.forEach(function(O){var M=f.rules[O],x=m[O];M.forEach(function(P){var D=P;typeof D.transform=="function"&&(m===s&&(m=jd({},m)),x=m[O]=D.transform(x)),typeof D=="function"?D={validator:D}:D=jd({},D),D.validator=f.getValidationMethod(D),D.validator&&(D.field=O,D.fullField=D.fullField||O,D.type=f.getType(D),R[O]=R[O]||[],R[O].push({rule:D,value:x,source:m,field:O}))})});var A={};return Pfe(R,g,function(O,M){var x=O.rule,P=(x.type==="object"||x.type==="array")&&(typeof x.fields=="object"||typeof x.defaultField=="object");P=P&&(x.required||!x.required&&O.value),x.field=O.field;function D(V,W){return jd({},W,{fullField:x.fullField+"."+V,fullFields:x.fullFields?[].concat(x.fullFields,[V]):[V]})}function F(V){V===void 0&&(V=[]);var W=Array.isArray(V)?V:[V];!g.suppressWarning&&W.length&&e.warning("async-validator:",W),W.length&&x.message!==void 0&&(W=[].concat(x.message));var K=W.map(pB(x,m));if(g.first&&K.length)return A[x.field]=1,M(K);if(!P)M(K);else{if(x.required&&!O.value)return x.message!==void 0?K=[].concat(x.message).map(pB(x,m)):g.error&&(K=[g.error(x,Ba(g.messages.required,x.field))]),M(K);var Q={};x.defaultField&&Object.keys(O.value).map(function(te){Q[te]=x.defaultField}),Q=jd({},Q,O.rule.fields);var Y={};Object.keys(Q).forEach(function(te){var ie=Q[te],le=Array.isArray(ie)?ie:[ie];Y[te]=le.map(D.bind(null,te))});var ee=new e(Y);ee.messages(g.messages),O.rule.options&&(O.rule.options.messages=g.messages,O.rule.options.error=g.error),ee.validate(O.value,O.rule.options||g,function(te){var ie=[];K&&K.length&&ie.push.apply(ie,K),te&&te.length&&ie.push.apply(ie,te),M(ie.length?ie:null)})}}var $;if(x.asyncValidator)$=x.asyncValidator(x,O.value,F,O.source,g);else if(x.validator){try{$=x.validator(x,O.value,F,O.source,g)}catch(V){console.error==null||console.error(V),g.suppressValidatorError||setTimeout(function(){throw V},0),F(V.message)}$===!0?F():$===!1?F(typeof x.message=="function"?x.message(x.fullField||x.field):x.message||(x.fullField||x.field)+" fails"):$ instanceof Array?F($):$ instanceof Error&&F($.message)}$&&$.then&&$.then(function(){return F()},function(V){return F(V)})},function(O){S(O)},m)},r.getType=function(s){if(s.type===void 0&&s.pattern instanceof RegExp&&(s.type="pattern"),typeof s.validator!="function"&&s.type&&!Sm.hasOwnProperty(s.type))throw new Error(Ba("Unknown rule type %s",s.type));return s.type||"string"},r.getValidationMethod=function(s){if(typeof s.validator=="function")return s.validator;var c=Object.keys(s),d=c.indexOf("message");return d!==-1&&c.splice(d,1),c.length===1&&c[0]==="required"?Sm.required:Sm[this.getType(s)]||void 0},e}();vg.register=function(r,o){if(typeof o!="function")throw new Error("Cannot register a validator by type, validator is not a function");Sm[r]=o};vg.warning=Afe;vg.messages=OA;vg.validators=Sm;var La="'${name}' is not a valid ${type}",m9={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:La,method:La,array:La,object:La,number:La,date:La,boolean:La,integer:La,float:La,regexp:La,email:La,url:La,hex:La},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},gB=vg;function n0e(e,r){return e.replace(/\$\{\w+\}/g,function(o){var s=o.slice(2,-1);return r[s]})}var vB="CODE_LOGIC_ERROR";function xA(e,r,o,s,c){return NA.apply(this,arguments)}function NA(){return NA=If(Ha().mark(function e(r,o,s,c,d){var f,m,g,_,S,T,R,N,A;return Ha().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return f=Oe({},s),delete f.ruleIndex,gB.warning=function(){},f.validator&&(m=f.validator,f.validator=function(){try{return m.apply(void 0,arguments)}catch(x){return console.error(x),Promise.reject(vB)}}),g=null,f&&f.type==="array"&&f.defaultField&&(g=f.defaultField,delete f.defaultField),_=new gB(ct({},r,[f])),S=$p(m9,c.validateMessages),_.messages(S),T=[],M.prev=10,M.next=13,Promise.resolve(_.validate(ct({},r,o),Oe({},c)));case 13:M.next=18;break;case 15:M.prev=15,M.t0=M.catch(10),M.t0.errors&&(T=M.t0.errors.map(function(x,P){var D=x.message,F=D===vB?S.default:D;return b.isValidElement(F)?b.cloneElement(F,{key:"error_".concat(P)}):F}));case 18:if(!(!T.length&&g)){M.next=23;break}return M.next=21,Promise.all(o.map(function(x,P){return xA("".concat(r,".").concat(P),x,g,c,d)}));case 21:return R=M.sent,M.abrupt("return",R.reduce(function(x,P){return[].concat(at(x),at(P))},[]));case 23:return N=Oe(Oe({},s),{},{name:r,enum:(s.enum||[]).join(", ")},d),A=T.map(function(x){return typeof x=="string"?n0e(x,N):x}),M.abrupt("return",A);case 26:case"end":return M.stop()}},e,null,[[10,15]])})),NA.apply(this,arguments)}function r0e(e,r,o,s,c,d){var f=e.join("."),m=o.map(function(S,T){var R=S.validator,N=Oe(Oe({},S),{},{ruleIndex:T});return R&&(N.validator=function(A,O,M){var x=!1,P=function(){for(var $=arguments.length,V=new Array($),W=0;W<$;W++)V[W]=arguments[W];Promise.resolve().then(function(){pa(!x,"Your validator function has already return a promise. `callback` will be ignored."),x||M.apply(void 0,V)})},D=R(A,O,P);x=D&&typeof D.then=="function"&&typeof D.catch=="function",pa(x,"`callback` is deprecated. Please return a promise instead."),x&&D.then(function(){M()}).catch(function(F){M(F||" ")})}),N}).sort(function(S,T){var R=S.warningOnly,N=S.ruleIndex,A=T.warningOnly,O=T.ruleIndex;return!!R==!!A?N-O:R?1:-1}),g;if(c===!0)g=new Promise(function(){var S=If(Ha().mark(function T(R,N){var A,O,M;return Ha().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:A=0;case 1:if(!(A<m.length)){P.next=12;break}return O=m[A],P.next=5,xA(f,r,O,s,d);case 5:if(M=P.sent,!M.length){P.next=9;break}return N([{errors:M,rule:O}]),P.abrupt("return");case 9:A+=1,P.next=1;break;case 12:R([]);case 13:case"end":return P.stop()}},T)}));return function(T,R){return S.apply(this,arguments)}}());else{var _=m.map(function(S){return xA(f,r,S,s,d).then(function(T){return{errors:T,rule:S}})});g=(c?o0e(_):i0e(_)).then(function(S){return Promise.reject(S)})}return g.catch(function(S){return S}),g}function i0e(e){return PA.apply(this,arguments)}function PA(){return PA=If(Ha().mark(function e(r){return Ha().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",Promise.all(r).then(function(c){var d,f=(d=[]).concat.apply(d,at(c));return f}));case 1:case"end":return s.stop()}},e)})),PA.apply(this,arguments)}function o0e(e){return DA.apply(this,arguments)}function DA(){return DA=If(Ha().mark(function e(r){var o;return Ha().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=0,c.abrupt("return",new Promise(function(d){r.forEach(function(f){f.then(function(m){m.errors.length&&d([m]),o+=1,o===r.length&&d([])})})}));case 2:case"end":return c.stop()}},e)})),DA.apply(this,arguments)}function pi(e){return TA(e)}function EB(e,r){var o={};return r.forEach(function(s){var c=Xs(e,s);o=Gs(o,s,c)}),o}function Cm(e,r){return e&&e.some(function(o){return g9(o,r)})}function g9(e,r){return!e||!r||e.length!==r.length?!1:e.every(function(o,s){return r[s]===o})}function a0e(e,r){if(e===r)return!0;if(!e&&r||e&&!r||!e||!r||Fn(e)!=="object"||Fn(r)!=="object")return!1;var o=Object.keys(e),s=Object.keys(r),c=new Set([].concat(o,s));return at(c).every(function(d){var f=e[d],m=r[d];return typeof f=="function"&&typeof m=="function"?!0:f===m})}function s0e(e){var r=arguments.length<=1?void 0:arguments[1];return r&&r.target&&Fn(r.target)==="object"&&e in r.target?r.target[e]:r}function _B(e,r,o){var s=e.length;if(r<0||r>=s||o<0||o>=s)return e;var c=e[r],d=r-o;return d>0?[].concat(at(e.slice(0,o)),[c],at(e.slice(o,r)),at(e.slice(r+1,s))):d<0?[].concat(at(e.slice(0,r)),at(e.slice(r+1,o+1)),[c],at(e.slice(o+1,s))):e}var c0e=["name"],ds=[];function yB(e,r,o,s,c,d){return typeof e=="function"?e(r,o,"source"in d?{source:d.source}:{}):s!==c}var Ox=function(e){yf(o,e);var r=Sf(o);function o(s){var c;if(Ts(this,o),c=r.call(this,s),c.state={resetCount:0},c.cancelRegisterFunc=null,c.mounted=!1,c.touched=!1,c.dirty=!1,c.validatePromise=void 0,c.prevValidating=void 0,c.errors=ds,c.warnings=ds,c.cancelRegister=function(){var g=c.props,_=g.preserve,S=g.isListField,T=g.name;c.cancelRegisterFunc&&c.cancelRegisterFunc(S,_,pi(T)),c.cancelRegisterFunc=null},c.getNamePath=function(){var g=c.props,_=g.name,S=g.fieldContext,T=S.prefixName,R=T===void 0?[]:T;return _!==void 0?[].concat(at(R),at(_)):[]},c.getRules=function(){var g=c.props,_=g.rules,S=_===void 0?[]:_,T=g.fieldContext;return S.map(function(R){return typeof R=="function"?R(T):R})},c.refresh=function(){c.mounted&&c.setState(function(g){var _=g.resetCount;return{resetCount:_+1}})},c.metaCache=null,c.triggerMetaEvent=function(g){var _=c.props.onMetaChange;if(_){var S=Oe(Oe({},c.getMeta()),{},{destroy:g});wS(c.metaCache,S)||_(S),c.metaCache=S}else c.metaCache=null},c.onStoreChange=function(g,_,S){var T=c.props,R=T.shouldUpdate,N=T.dependencies,A=N===void 0?[]:N,O=T.onReset,M=S.store,x=c.getNamePath(),P=c.getValue(g),D=c.getValue(M),F=_&&Cm(_,x);switch(S.type==="valueUpdate"&&S.source==="external"&&P!==D&&(c.touched=!0,c.dirty=!0,c.validatePromise=null,c.errors=ds,c.warnings=ds,c.triggerMetaEvent()),S.type){case"reset":if(!_||F){c.touched=!1,c.dirty=!1,c.validatePromise=void 0,c.errors=ds,c.warnings=ds,c.triggerMetaEvent(),O==null||O(),c.refresh();return}break;case"remove":{if(R){c.reRender();return}break}case"setField":{if(F){var $=S.data;"touched"in $&&(c.touched=$.touched),"validating"in $&&!("originRCField"in $)&&(c.validatePromise=$.validating?Promise.resolve([]):null),"errors"in $&&(c.errors=$.errors||ds),"warnings"in $&&(c.warnings=$.warnings||ds),c.dirty=!0,c.triggerMetaEvent(),c.reRender();return}if(R&&!x.length&&yB(R,g,M,P,D,S)){c.reRender();return}break}case"dependenciesUpdate":{var V=A.map(pi);if(V.some(function(W){return Cm(S.relatedFields,W)})){c.reRender();return}break}default:if(F||(!A.length||x.length||R)&&yB(R,g,M,P,D,S)){c.reRender();return}break}R===!0&&c.reRender()},c.validateRules=function(g){var _=c.getNamePath(),S=c.getValue(),T=g||{},R=T.triggerName,N=T.validateOnly,A=N===void 0?!1:N,O=Promise.resolve().then(function(){if(!c.mounted)return[];var M=c.props,x=M.validateFirst,P=x===void 0?!1:x,D=M.messageVariables,F=c.getRules();R&&(F=F.filter(function(V){return V}).filter(function(V){var W=V.validateTrigger;if(!W)return!0;var K=TA(W);return K.includes(R)}));var $=r0e(_,S,F,g,P,D);return $.catch(function(V){return V}).then(function(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ds;if(c.validatePromise===O){var W;c.validatePromise=null;var K=[],Q=[];(W=V.forEach)===null||W===void 0||W.call(V,function(Y){var ee=Y.rule.warningOnly,te=Y.errors,ie=te===void 0?ds:te;ee?Q.push.apply(Q,at(ie)):K.push.apply(K,at(ie))}),c.errors=K,c.warnings=Q,c.triggerMetaEvent(),c.reRender()}}),$});return A||(c.validatePromise=O,c.dirty=!0,c.errors=ds,c.warnings=ds,c.triggerMetaEvent(),c.reRender()),O},c.isFieldValidating=function(){return!!c.validatePromise},c.isFieldTouched=function(){return c.touched},c.isFieldDirty=function(){if(c.dirty||c.props.initialValue!==void 0)return!0;var g=c.props.fieldContext,_=g.getInternalHooks(Bd),S=_.getInitialValue;return S(c.getNamePath())!==void 0},c.getErrors=function(){return c.errors},c.getWarnings=function(){return c.warnings},c.isListField=function(){return c.props.isListField},c.isList=function(){return c.props.isList},c.isPreserve=function(){return c.props.preserve},c.getMeta=function(){c.prevValidating=c.isFieldValidating();var g={touched:c.isFieldTouched(),validating:c.prevValidating,errors:c.errors,warnings:c.warnings,name:c.getNamePath(),validated:c.validatePromise===null};return g},c.getOnlyChild=function(g){if(typeof g=="function"){var _=c.getMeta();return Oe(Oe({},c.getOnlyChild(g(c.getControlled(),_,c.props.fieldContext))),{},{isFunction:!0})}var S=Tl(g);return S.length!==1||!b.isValidElement(S[0])?{child:S,isFunction:!1}:{child:S[0],isFunction:!1}},c.getValue=function(g){var _=c.props.fieldContext.getFieldsValue,S=c.getNamePath();return Xs(g||_(!0),S)},c.getControlled=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=c.props,S=_.trigger,T=_.validateTrigger,R=_.getValueFromEvent,N=_.normalize,A=_.valuePropName,O=_.getValueProps,M=_.fieldContext,x=T!==void 0?T:M.validateTrigger,P=c.getNamePath(),D=M.getInternalHooks,F=M.getFieldsValue,$=D(Bd),V=$.dispatch,W=c.getValue(),K=O||function(te){return ct({},A,te)},Q=g[S],Y=Oe(Oe({},g),K(W));Y[S]=function(){c.touched=!0,c.dirty=!0,c.triggerMetaEvent();for(var te,ie=arguments.length,le=new Array(ie),me=0;me<ie;me++)le[me]=arguments[me];R?te=R.apply(void 0,le):te=s0e.apply(void 0,[A].concat(le)),N&&(te=N(te,W,F(!0))),V({type:"updateValue",namePath:P,value:te}),Q&&Q.apply(void 0,le)};var ee=TA(x||[]);return ee.forEach(function(te){var ie=Y[te];Y[te]=function(){ie&&ie.apply(void 0,arguments);var le=c.props.rules;le&&le.length&&V({type:"validateField",namePath:P,triggerName:te})}}),Y},s.fieldContext){var d=s.fieldContext.getInternalHooks,f=d(Bd),m=f.initEntityValue;m(fy(c))}return c}return Rs(o,[{key:"componentDidMount",value:function(){var c=this.props,d=c.shouldUpdate,f=c.fieldContext;if(this.mounted=!0,f){var m=f.getInternalHooks,g=m(Bd),_=g.registerField;this.cancelRegisterFunc=_(this)}d===!0&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.triggerMetaEvent(!0),this.mounted=!1}},{key:"reRender",value:function(){this.mounted&&this.forceUpdate()}},{key:"render",value:function(){var c=this.state.resetCount,d=this.props.children,f=this.getOnlyChild(d),m=f.child,g=f.isFunction,_;return g?_=m:b.isValidElement(m)?_=b.cloneElement(m,this.getControlled(m.props)):(pa(!m,"`children` of Field is not validate ReactElement."),_=m),b.createElement(b.Fragment,{key:c},_)}}]),o}(b.Component);Ox.contextType=eh;Ox.defaultProps={trigger:"onChange",valuePropName:"value"};function xx(e){var r=e.name,o=An(e,c0e),s=b.useContext(eh),c=b.useContext(qm),d=r!==void 0?pi(r):void 0,f="keep";return o.isListField||(f="_".concat((d||[]).join("_"))),b.createElement(Ox,Ze({key:f,name:d,isListField:!!c},o,{fieldContext:s}))}var v9=function(r){var o=r.name,s=r.initialValue,c=r.children,d=r.rules,f=r.validateTrigger,m=r.isListField,g=b.useContext(eh),_=b.useContext(qm),S=b.useRef({keys:[],id:0}),T=S.current,R=b.useMemo(function(){var M=pi(g.prefixName)||[];return[].concat(at(M),at(pi(o)))},[g.prefixName,o]),N=b.useMemo(function(){return Oe(Oe({},g),{},{prefixName:R})},[g,R]),A=b.useMemo(function(){return{getKey:function(x){var P=R.length,D=x[P];return[T.keys[D],x.slice(P+1)]}}},[R]);if(typeof c!="function")return pa(!1,"Form.List only accepts function as children."),null;var O=function(x,P,D){var F=D.source;return F==="internal"?!1:x!==P};return b.createElement(qm.Provider,{value:A},b.createElement(eh.Provider,{value:N},b.createElement(xx,{name:[],shouldUpdate:O,rules:d,validateTrigger:f,initialValue:s,isList:!0,isListField:m??!!_},function(M,x){var P=M.value,D=P===void 0?[]:P,F=M.onChange,$=g.getFieldValue,V=function(){var Y=$(R||[]);return Y||[]},W={add:function(Y,ee){var te=V();ee>=0&&ee<=te.length?(T.keys=[].concat(at(T.keys.slice(0,ee)),[T.id],at(T.keys.slice(ee))),F([].concat(at(te.slice(0,ee)),[Y],at(te.slice(ee))))):(T.keys=[].concat(at(T.keys),[T.id]),F([].concat(at(te),[Y]))),T.id+=1},remove:function(Y){var ee=V(),te=new Set(Array.isArray(Y)?Y:[Y]);te.size<=0||(T.keys=T.keys.filter(function(ie,le){return!te.has(le)}),F(ee.filter(function(ie,le){return!te.has(le)})))},move:function(Y,ee){if(Y!==ee){var te=V();Y<0||Y>=te.length||ee<0||ee>=te.length||(T.keys=_B(T.keys,Y,ee),F(_B(te,Y,ee)))}}},K=D||[];return Array.isArray(K)||(K=[]),c(K.map(function(Q,Y){var ee=T.keys[Y];return ee===void 0&&(T.keys[Y]=T.id,ee=T.keys[Y],T.id+=1),{name:Y,key:ee,isListField:!0}}),W,x)})))};function l0e(e){var r=!1,o=e.length,s=[];return e.length?new Promise(function(c,d){e.forEach(function(f,m){f.catch(function(g){return r=!0,g}).then(function(g){o-=1,s[m]=g,!(o>0)&&(r&&d(s),c(s))})})}):Promise.resolve([])}var E9="__@field_split__";function Y1(e){return e.map(function(r){return"".concat(Fn(r),":").concat(r)}).join(E9)}var gp=function(){function e(){Ts(this,e),this.kvs=new Map}return Rs(e,[{key:"set",value:function(o,s){this.kvs.set(Y1(o),s)}},{key:"get",value:function(o){return this.kvs.get(Y1(o))}},{key:"update",value:function(o,s){var c=this.get(o),d=s(c);d?this.set(o,d):this.delete(o)}},{key:"delete",value:function(o){this.kvs.delete(Y1(o))}},{key:"map",value:function(o){return at(this.kvs.entries()).map(function(s){var c=Ge(s,2),d=c[0],f=c[1],m=d.split(E9);return o({key:m.map(function(g){var _=g.match(/^([^:]*):(.*)$/),S=Ge(_,3),T=S[1],R=S[2];return T==="number"?Number(R):R}),value:f})})}},{key:"toJSON",value:function(){var o={};return this.map(function(s){var c=s.key,d=s.value;return o[c.join(".")]=d,null}),o}}]),e}(),u0e=["name"],d0e=Rs(function e(r){var o=this;Ts(this,e),this.formHooked=!1,this.forceRootUpdate=void 0,this.subscribable=!0,this.store={},this.fieldEntities=[],this.initialValues={},this.callbacks={},this.validateMessages=null,this.preserve=null,this.lastValidatePromise=null,this.getForm=function(){return{getFieldValue:o.getFieldValue,getFieldsValue:o.getFieldsValue,getFieldError:o.getFieldError,getFieldWarning:o.getFieldWarning,getFieldsError:o.getFieldsError,isFieldsTouched:o.isFieldsTouched,isFieldTouched:o.isFieldTouched,isFieldValidating:o.isFieldValidating,isFieldsValidating:o.isFieldsValidating,resetFields:o.resetFields,setFields:o.setFields,setFieldValue:o.setFieldValue,setFieldsValue:o.setFieldsValue,validateFields:o.validateFields,submit:o.submit,_init:!0,getInternalHooks:o.getInternalHooks}},this.getInternalHooks=function(s){return s===Bd?(o.formHooked=!0,{dispatch:o.dispatch,initEntityValue:o.initEntityValue,registerField:o.registerField,useSubscribe:o.useSubscribe,setInitialValues:o.setInitialValues,destroyForm:o.destroyForm,setCallbacks:o.setCallbacks,setValidateMessages:o.setValidateMessages,getFields:o.getFields,setPreserve:o.setPreserve,getInitialValue:o.getInitialValue,registerWatch:o.registerWatch}):(pa(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)},this.useSubscribe=function(s){o.subscribable=s},this.prevWithoutPreserves=null,this.setInitialValues=function(s,c){if(o.initialValues=s||{},c){var d,f=$p(s,o.store);(d=o.prevWithoutPreserves)===null||d===void 0||d.map(function(m){var g=m.key;f=Gs(f,g,Xs(s,g))}),o.prevWithoutPreserves=null,o.updateStore(f)}},this.destroyForm=function(){var s=new gp;o.getFieldEntities(!0).forEach(function(c){o.isMergedPreserve(c.isPreserve())||s.set(c.getNamePath(),!0)}),o.prevWithoutPreserves=s},this.getInitialValue=function(s){var c=Xs(o.initialValues,s);return s.length?$p(c):c},this.setCallbacks=function(s){o.callbacks=s},this.setValidateMessages=function(s){o.validateMessages=s},this.setPreserve=function(s){o.preserve=s},this.watchList=[],this.registerWatch=function(s){return o.watchList.push(s),function(){o.watchList=o.watchList.filter(function(c){return c!==s})}},this.notifyWatch=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(o.watchList.length){var c=o.getFieldsValue(),d=o.getFieldsValue(!0);o.watchList.forEach(function(f){f(c,d,s)})}},this.timeoutId=null,this.warningUnhooked=function(){},this.updateStore=function(s){o.store=s},this.getFieldEntities=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return s?o.fieldEntities.filter(function(c){return c.getNamePath().length}):o.fieldEntities},this.getFieldsMap=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,c=new gp;return o.getFieldEntities(s).forEach(function(d){var f=d.getNamePath();c.set(f,d)}),c},this.getFieldEntitiesForNamePathList=function(s){if(!s)return o.getFieldEntities(!0);var c=o.getFieldsMap(!0);return s.map(function(d){var f=pi(d);return c.get(f)||{INVALIDATE_NAME_PATH:pi(d)}})},this.getFieldsValue=function(s,c){if(o.warningUnhooked(),s===!0&&!c)return o.store;var d=o.getFieldEntitiesForNamePathList(Array.isArray(s)?s:null),f=[];return d.forEach(function(m){var g,_="INVALIDATE_NAME_PATH"in m?m.INVALIDATE_NAME_PATH:m.getNamePath();if(!(!s&&(!((g=m.isListField)===null||g===void 0)&&g.call(m))))if(!c)f.push(_);else{var S="getMeta"in m?m.getMeta():null;c(S)&&f.push(_)}}),EB(o.store,f.map(pi))},this.getFieldValue=function(s){o.warningUnhooked();var c=pi(s);return Xs(o.store,c)},this.getFieldsError=function(s){o.warningUnhooked();var c=o.getFieldEntitiesForNamePathList(s);return c.map(function(d,f){return d&&!("INVALIDATE_NAME_PATH"in d)?{name:d.getNamePath(),errors:d.getErrors(),warnings:d.getWarnings()}:{name:pi(s[f]),errors:[],warnings:[]}})},this.getFieldError=function(s){o.warningUnhooked();var c=pi(s),d=o.getFieldsError([c])[0];return d.errors},this.getFieldWarning=function(s){o.warningUnhooked();var c=pi(s),d=o.getFieldsError([c])[0];return d.warnings},this.isFieldsTouched=function(){o.warningUnhooked();for(var s=arguments.length,c=new Array(s),d=0;d<s;d++)c[d]=arguments[d];var f=c[0],m=c[1],g,_=!1;c.length===0?g=null:c.length===1?Array.isArray(f)?(g=f.map(pi),_=!1):(g=null,_=f):(g=f.map(pi),_=m);var S=o.getFieldEntities(!0),T=function(M){return M.isFieldTouched()};if(!g)return _?S.every(T):S.some(T);var R=new gp;g.forEach(function(O){R.set(O,[])}),S.forEach(function(O){var M=O.getNamePath();g.forEach(function(x){x.every(function(P,D){return M[D]===P})&&R.update(x,function(P){return[].concat(at(P),[O])})})});var N=function(M){return M.some(T)},A=R.map(function(O){var M=O.value;return M});return _?A.every(N):A.some(N)},this.isFieldTouched=function(s){return o.warningUnhooked(),o.isFieldsTouched([s])},this.isFieldsValidating=function(s){o.warningUnhooked();var c=o.getFieldEntities();if(!s)return c.some(function(f){return f.isFieldValidating()});var d=s.map(pi);return c.some(function(f){var m=f.getNamePath();return Cm(d,m)&&f.isFieldValidating()})},this.isFieldValidating=function(s){return o.warningUnhooked(),o.isFieldsValidating([s])},this.resetWithFieldInitialValue=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=new gp,d=o.getFieldEntities(!0);d.forEach(function(g){var _=g.props.initialValue,S=g.getNamePath();if(_!==void 0){var T=c.get(S)||new Set;T.add({entity:g,value:_}),c.set(S,T)}});var f=function(_){_.forEach(function(S){var T=S.props.initialValue;if(T!==void 0){var R=S.getNamePath(),N=o.getInitialValue(R);if(N!==void 0)pa(!1,"Form already set 'initialValues' with path '".concat(R.join("."),"'. Field can not overwrite it."));else{var A=c.get(R);if(A&&A.size>1)pa(!1,"Multiple Field with path '".concat(R.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(A){var O=o.getFieldValue(R);(!s.skipExist||O===void 0)&&o.updateStore(Gs(o.store,R,at(A)[0].value))}}}})},m;s.entities?m=s.entities:s.namePathList?(m=[],s.namePathList.forEach(function(g){var _=c.get(g);if(_){var S;(S=m).push.apply(S,at(at(_).map(function(T){return T.entity})))}})):m=d,f(m)},this.resetFields=function(s){o.warningUnhooked();var c=o.store;if(!s){o.updateStore($p(o.initialValues)),o.resetWithFieldInitialValue(),o.notifyObservers(c,null,{type:"reset"}),o.notifyWatch();return}var d=s.map(pi);d.forEach(function(f){var m=o.getInitialValue(f);o.updateStore(Gs(o.store,f,m))}),o.resetWithFieldInitialValue({namePathList:d}),o.notifyObservers(c,d,{type:"reset"}),o.notifyWatch(d)},this.setFields=function(s){o.warningUnhooked();var c=o.store,d=[];s.forEach(function(f){var m=f.name,g=An(f,u0e),_=pi(m);d.push(_),"value"in g&&o.updateStore(Gs(o.store,_,g.value)),o.notifyObservers(c,[_],{type:"setField",data:f})}),o.notifyWatch(d)},this.getFields=function(){var s=o.getFieldEntities(!0),c=s.map(function(d){var f=d.getNamePath(),m=d.getMeta(),g=Oe(Oe({},m),{},{name:f,value:o.getFieldValue(f)});return Object.defineProperty(g,"originRCField",{value:!0}),g});return c},this.initEntityValue=function(s){var c=s.props.initialValue;if(c!==void 0){var d=s.getNamePath(),f=Xs(o.store,d);f===void 0&&o.updateStore(Gs(o.store,d,c))}},this.isMergedPreserve=function(s){var c=s!==void 0?s:o.preserve;return c??!0},this.registerField=function(s){o.fieldEntities.push(s);var c=s.getNamePath();if(o.notifyWatch([c]),s.props.initialValue!==void 0){var d=o.store;o.resetWithFieldInitialValue({entities:[s],skipExist:!0}),o.notifyObservers(d,[s.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(f,m){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(o.fieldEntities=o.fieldEntities.filter(function(T){return T!==s}),!o.isMergedPreserve(m)&&(!f||g.length>1)){var _=f?void 0:o.getInitialValue(c);if(c.length&&o.getFieldValue(c)!==_&&o.fieldEntities.every(function(T){return!g9(T.getNamePath(),c)})){var S=o.store;o.updateStore(Gs(S,c,_,!0)),o.notifyObservers(S,[c],{type:"remove"}),o.triggerDependenciesUpdate(S,c)}}o.notifyWatch([c])}},this.dispatch=function(s){switch(s.type){case"updateValue":{var c=s.namePath,d=s.value;o.updateValue(c,d);break}case"validateField":{var f=s.namePath,m=s.triggerName;o.validateFields([f],{triggerName:m});break}}},this.notifyObservers=function(s,c,d){if(o.subscribable){var f=Oe(Oe({},d),{},{store:o.getFieldsValue(!0)});o.getFieldEntities().forEach(function(m){var g=m.onStoreChange;g(s,c,f)})}else o.forceRootUpdate()},this.triggerDependenciesUpdate=function(s,c){var d=o.getDependencyChildrenFields(c);return d.length&&o.validateFields(d),o.notifyObservers(s,d,{type:"dependenciesUpdate",relatedFields:[c].concat(at(d))}),d},this.updateValue=function(s,c){var d=pi(s),f=o.store;o.updateStore(Gs(o.store,d,c)),o.notifyObservers(f,[d],{type:"valueUpdate",source:"internal"}),o.notifyWatch([d]);var m=o.triggerDependenciesUpdate(f,d),g=o.callbacks.onValuesChange;if(g){var _=EB(o.store,[d]);g(_,o.getFieldsValue())}o.triggerOnFieldsChange([d].concat(at(m)))},this.setFieldsValue=function(s){o.warningUnhooked();var c=o.store;if(s){var d=$p(o.store,s);o.updateStore(d)}o.notifyObservers(c,null,{type:"valueUpdate",source:"external"}),o.notifyWatch()},this.setFieldValue=function(s,c){o.setFields([{name:s,value:c}])},this.getDependencyChildrenFields=function(s){var c=new Set,d=[],f=new gp;o.getFieldEntities().forEach(function(g){var _=g.props.dependencies;(_||[]).forEach(function(S){var T=pi(S);f.update(T,function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Set;return R.add(g),R})})});var m=function g(_){var S=f.get(_)||new Set;S.forEach(function(T){if(!c.has(T)){c.add(T);var R=T.getNamePath();T.isFieldDirty()&&R.length&&(d.push(R),g(R))}})};return m(s),d},this.triggerOnFieldsChange=function(s,c){var d=o.callbacks.onFieldsChange;if(d){var f=o.getFields();if(c){var m=new gp;c.forEach(function(_){var S=_.name,T=_.errors;m.set(S,T)}),f.forEach(function(_){_.errors=m.get(_.name)||_.errors})}var g=f.filter(function(_){var S=_.name;return Cm(s,S)});g.length&&d(g,f)}},this.validateFields=function(s,c){o.warningUnhooked();var d,f;Array.isArray(s)||typeof s=="string"||typeof c=="string"?(d=s,f=c):f=s;var m=!!d,g=m?d.map(pi):[],_=[],S=String(Date.now()),T=new Set;o.getFieldEntities(!0).forEach(function(O){var M;if(m||g.push(O.getNamePath()),!((M=f)===null||M===void 0)&&M.recursive&&m){var x=O.getNamePath();x.every(function(F,$){return d[$]===F||d[$]===void 0})&&g.push(x)}if(!(!O.props.rules||!O.props.rules.length)){var P=O.getNamePath();if(T.add(P.join(S)),!m||Cm(g,P)){var D=O.validateRules(Oe({validateMessages:Oe(Oe({},m9),o.validateMessages)},f));_.push(D.then(function(){return{name:P,errors:[],warnings:[]}}).catch(function(F){var $,V=[],W=[];return($=F.forEach)===null||$===void 0||$.call(F,function(K){var Q=K.rule.warningOnly,Y=K.errors;Q?W.push.apply(W,at(Y)):V.push.apply(V,at(Y))}),V.length?Promise.reject({name:P,errors:V,warnings:W}):{name:P,errors:V,warnings:W}}))}}});var R=l0e(_);o.lastValidatePromise=R,R.catch(function(O){return O}).then(function(O){var M=O.map(function(x){var P=x.name;return P});o.notifyObservers(o.store,M,{type:"validateFinish"}),o.triggerOnFieldsChange(M,O)});var N=R.then(function(){return o.lastValidatePromise===R?Promise.resolve(o.getFieldsValue(g)):Promise.reject([])}).catch(function(O){var M=O.filter(function(x){return x&&x.errors.length});return Promise.reject({values:o.getFieldsValue(g),errorFields:M,outOfDate:o.lastValidatePromise!==R})});N.catch(function(O){return O});var A=g.filter(function(O){return T.has(O.join(S))});return o.triggerOnFieldsChange(A),N},this.submit=function(){o.warningUnhooked(),o.validateFields().then(function(s){var c=o.callbacks.onFinish;if(c)try{c(s)}catch(d){console.error(d)}}).catch(function(s){var c=o.callbacks.onFinishFailed;c&&c(s)})},this.forceRootUpdate=r});function Nx(e){var r=b.useRef(),o=b.useState({}),s=Ge(o,2),c=s[1];if(!r.current)if(e)r.current=e;else{var d=function(){c({})},f=new d0e(d);r.current=f.getForm()}return[r.current]}var kA=b.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),_9=function(r){var o=r.validateMessages,s=r.onFormChange,c=r.onFormFinish,d=r.children,f=b.useContext(kA),m=b.useRef({});return b.createElement(kA.Provider,{value:Oe(Oe({},f),{},{validateMessages:Oe(Oe({},f.validateMessages),o),triggerFormChange:function(_,S){s&&s(_,{changedFields:S,forms:m.current}),f.triggerFormChange(_,S)},triggerFormFinish:function(_,S){c&&c(_,{values:S,forms:m.current}),f.triggerFormFinish(_,S)},registerForm:function(_,S){_&&(m.current=Oe(Oe({},m.current),{},ct({},_,S))),f.registerForm(_,S)},unregisterForm:function(_){var S=Oe({},m.current);delete S[_],m.current=S,f.unregisterForm(_)}})},d)},h0e=["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed"],p0e=function(r,o){var s=r.name,c=r.initialValues,d=r.fields,f=r.form,m=r.preserve,g=r.children,_=r.component,S=_===void 0?"form":_,T=r.validateMessages,R=r.validateTrigger,N=R===void 0?"onChange":R,A=r.onValuesChange,O=r.onFieldsChange,M=r.onFinish,x=r.onFinishFailed,P=An(r,h0e),D=b.useContext(kA),F=Nx(f),$=Ge(F,1),V=$[0],W=V.getInternalHooks(Bd),K=W.useSubscribe,Q=W.setInitialValues,Y=W.setCallbacks,ee=W.setValidateMessages,te=W.setPreserve,ie=W.destroyForm;b.useImperativeHandle(o,function(){return V}),b.useEffect(function(){return D.registerForm(s,V),function(){D.unregisterForm(s)}},[D,V,s]),ee(Oe(Oe({},D.validateMessages),T)),Y({onValuesChange:A,onFieldsChange:function(he){if(D.triggerFormChange(s,he),O){for(var be=arguments.length,ve=new Array(be>1?be-1:0),ke=1;ke<be;ke++)ve[ke-1]=arguments[ke];O.apply(void 0,[he].concat(ve))}},onFinish:function(he){D.triggerFormFinish(s,he),M&&M(he)},onFinishFailed:x}),te(m);var le=b.useRef(null);Q(c,!le.current),le.current||(le.current=!0),b.useEffect(function(){return ie},[]);var me,ce=typeof g=="function";if(ce){var se=V.getFieldsValue(!0);me=g(se,V)}else me=g;K(!ce);var ae=b.useRef();b.useEffect(function(){a0e(ae.current||[],d||[])||V.setFields(d||[]),ae.current=d},[d,V]);var ge=b.useMemo(function(){return Oe(Oe({},V),{},{validateTrigger:N})},[V,N]),Se=b.createElement(qm.Provider,{value:null},b.createElement(eh.Provider,{value:ge},me));return S===!1?Se:b.createElement(S,Ze({},P,{onSubmit:function(he){he.preventDefault(),he.stopPropagation(),V.submit()},onReset:function(he){var be;he.preventDefault(),V.resetFields(),(be=P.onReset)===null||be===void 0||be.call(P,he)}}),Se)};function SB(e){try{return JSON.stringify(e)}catch{return Math.random()}}function y9(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];var s=r[0],c=s===void 0?[]:s,d=r[1],f=d===void 0?{}:d,m=bfe(f)?{form:f}:f,g=m.form,_=b.useState(),S=Ge(_,2),T=S[0],R=S[1],N=b.useMemo(function(){return SB(T)},[T]),A=b.useRef(N);A.current=N;var O=b.useContext(eh),M=g||O,x=M&&M._init,P=pi(c),D=b.useRef(P);return D.current=P,b.useEffect(function(){if(x){var F=M.getFieldsValue,$=M.getInternalHooks,V=$(Bd),W=V.registerWatch,K=W(function(Y,ee){var te=Xs(m.preserve?ee:Y,D.current),ie=SB(te);A.current!==ie&&(A.current=ie,R(te))}),Q=Xs(m.preserve?F(!0):F(),D.current);return R(Q),K}},[x]),T}var f0e=b.forwardRef(p0e),Af=f0e;Af.FormProvider=_9;Af.Field=xx;Af.List=v9;Af.useForm=Nx;Af.useWatch=y9;const Hu=b.createContext({labelAlign:"right",vertical:!1,itemRef:()=>{}}),S9=b.createContext(null),C9=e=>{const r=ma(e,["prefixCls"]);return b.createElement(_9,Object.assign({},r))},Px=b.createContext({prefixCls:""}),Il=b.createContext({}),CB=e=>{let{children:r,status:o,override:s}=e;const c=b.useContext(Il),d=b.useMemo(()=>{const f=Object.assign({},c);return s&&delete f.isFormItemInput,o&&(delete f.status,delete f.hasFeedback,delete f.feedbackIcon),f},[o,s,c]);return b.createElement(Il.Provider,{value:d},r)},m0e=e=>({animationDuration:e,animationFillMode:"both"}),g0e=e=>({animationDuration:e,animationFillMode:"both"}),b9=function(e,r,o,s){const d=(arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1)?"&":"";return{[`
      ${d}${e}-enter,
      ${d}${e}-appear
    `]:Object.assign(Object.assign({},m0e(s)),{animationPlayState:"paused"}),[`${d}${e}-leave`]:Object.assign(Object.assign({},g0e(s)),{animationPlayState:"paused"}),[`
      ${d}${e}-enter${e}-enter-active,
      ${d}${e}-appear${e}-appear-active
    `]:{animationName:r,animationPlayState:"running"},[`${d}${e}-leave${e}-leave-active`]:{animationName:o,animationPlayState:"running",pointerEvents:"none"}}},v0e=new Pr("antSlideUpIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1}}),E0e=new Pr("antSlideUpOut",{"0%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0}}),_0e=new Pr("antSlideDownIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1}}),y0e=new Pr("antSlideDownOut",{"0%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0}}),S0e=new Pr("antSlideLeftIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1}}),C0e=new Pr("antSlideLeftOut",{"0%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0}}),b0e=new Pr("antSlideRightIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1}}),T0e=new Pr("antSlideRightOut",{"0%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0}}),R0e={"slide-up":{inKeyframes:v0e,outKeyframes:E0e},"slide-down":{inKeyframes:_0e,outKeyframes:y0e},"slide-left":{inKeyframes:S0e,outKeyframes:C0e},"slide-right":{inKeyframes:b0e,outKeyframes:T0e}},bB=(e,r)=>{const{antCls:o}=e,s=`${o}-${r}`,{inKeyframes:c,outKeyframes:d}=R0e[r];return[b9(s,c,d,e.motionDurationMid),{[`
      ${s}-enter,
      ${s}-appear
    `]:{transform:"scale(0)",transformOrigin:"0% 0%",opacity:0,animationTimingFunction:e.motionEaseOutQuint,"&-prepare":{transform:"scale(1)"}},[`${s}-leave`]:{animationTimingFunction:e.motionEaseInQuint}}]},Dx=new Pr("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),w0e=new Pr("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),TB=new Pr("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),RB=new Pr("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),I0e=new Pr("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),A0e=new Pr("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),O0e=new Pr("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),x0e=new Pr("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}}),N0e=new Pr("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),P0e=new Pr("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}}),D0e=new Pr("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),k0e=new Pr("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}}),L0e={zoom:{inKeyframes:Dx,outKeyframes:w0e},"zoom-big":{inKeyframes:TB,outKeyframes:RB},"zoom-big-fast":{inKeyframes:TB,outKeyframes:RB},"zoom-left":{inKeyframes:O0e,outKeyframes:x0e},"zoom-right":{inKeyframes:N0e,outKeyframes:P0e},"zoom-up":{inKeyframes:I0e,outKeyframes:A0e},"zoom-down":{inKeyframes:D0e,outKeyframes:k0e}},T9=(e,r)=>{const{antCls:o}=e,s=`${o}-${r}`,{inKeyframes:c,outKeyframes:d}=L0e[r];return[b9(s,c,d,r==="zoom-big-fast"?e.motionDurationFast:e.motionDurationMid),{[`
        ${s}-enter,
        ${s}-appear
      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:e.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${s}-leave`]:{animationTimingFunction:e.motionEaseInOutCirc}}]},M0e=e=>({[e.componentCls]:{[`${e.antCls}-motion-collapse-legacy`]:{overflow:"hidden","&-active":{transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},
        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}},[`${e.antCls}-motion-collapse`]:{overflow:"hidden",transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},
        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}}}),R9=M0e,F0e=e=>{const{componentCls:r,width:o,notificationMarginEdge:s}=e,c=new Pr("antNotificationTopFadeIn",{"0%":{marginTop:"-100%",opacity:0},"100%":{marginTop:0,opacity:1}}),d=new Pr("antNotificationBottomFadeIn",{"0%":{marginBottom:"-100%",opacity:0},"100%":{marginBottom:0,opacity:1}}),f=new Pr("antNotificationLeftFadeIn",{"0%":{right:{_skip_check_:!0,value:o},opacity:0},"100%":{right:{_skip_check_:!0,value:0},opacity:1}});return{[`&${r}-top, &${r}-bottom`]:{marginInline:0},[`&${r}-top`]:{[`${r}-fade-enter${r}-fade-enter-active, ${r}-fade-appear${r}-fade-appear-active`]:{animationName:c}},[`&${r}-bottom`]:{[`${r}-fade-enter${r}-fade-enter-active, ${r}-fade-appear${r}-fade-appear-active`]:{animationName:d}},[`&${r}-topLeft, &${r}-bottomLeft`]:{marginInlineEnd:0,marginInlineStart:s,[`${r}-fade-enter${r}-fade-enter-active, ${r}-fade-appear${r}-fade-appear-active`]:{animationName:f}}}},U0e=F0e,B0e=e=>{const{iconCls:r,componentCls:o,boxShadow:s,fontSizeLG:c,notificationMarginBottom:d,borderRadiusLG:f,colorSuccess:m,colorInfo:g,colorWarning:_,colorError:S,colorTextHeading:T,notificationBg:R,notificationPadding:N,notificationMarginEdge:A,motionDurationMid:O,motionEaseInOut:M,fontSize:x,lineHeight:P,width:D,notificationIconSize:F,colorText:$}=e,V=`${o}-notice`,W=new Pr("antNotificationFadeIn",{"0%":{left:{_skip_check_:!0,value:D},opacity:0},"100%":{left:{_skip_check_:!0,value:0},opacity:1}}),K=new Pr("antNotificationFadeOut",{"0%":{maxHeight:e.animationMaxHeight,marginBottom:d,opacity:1},"100%":{maxHeight:0,marginBottom:0,paddingTop:0,paddingBottom:0,opacity:0}}),Q={position:"relative",width:D,maxWidth:`calc(100vw - ${A*2}px)`,marginBottom:d,marginInlineStart:"auto",padding:N,overflow:"hidden",lineHeight:P,wordWrap:"break-word",background:R,borderRadius:f,boxShadow:s,[`${o}-close-icon`]:{fontSize:x,cursor:"pointer"},[`${V}-message`]:{marginBottom:e.marginXS,color:T,fontSize:c,lineHeight:e.lineHeightLG},[`${V}-description`]:{fontSize:x,color:$},[`&${V}-closable ${V}-message`]:{paddingInlineEnd:e.paddingLG},[`${V}-with-icon ${V}-message`]:{marginBottom:e.marginXS,marginInlineStart:e.marginSM+F,fontSize:c},[`${V}-with-icon ${V}-description`]:{marginInlineStart:e.marginSM+F,fontSize:x},[`${V}-icon`]:{position:"absolute",fontSize:F,lineHeight:0,[`&-success${r}`]:{color:m},[`&-info${r}`]:{color:g},[`&-warning${r}`]:{color:_},[`&-error${r}`]:{color:S}},[`${V}-close`]:{position:"absolute",top:e.notificationPaddingVertical,insetInlineEnd:e.notificationPaddingHorizontal,color:e.colorIcon,outline:"none",width:e.notificationCloseButtonSize,height:e.notificationCloseButtonSize,borderRadius:e.borderRadiusSM,transition:`background-color ${e.motionDurationMid}, color ${e.motionDurationMid}`,display:"flex",alignItems:"center",justifyContent:"center","&:hover":{color:e.colorIconHover,backgroundColor:e.wireframe?"transparent":e.colorFillContent}},[`${V}-btn`]:{float:"right",marginTop:e.marginSM}};return[{[o]:Object.assign(Object.assign(Object.assign(Object.assign({},sh(e)),{position:"fixed",zIndex:e.zIndexPopup,marginInlineEnd:A,[`${o}-hook-holder`]:{position:"relative"},[`&${o}-top, &${o}-bottom`]:{[V]:{marginInline:"auto auto"}},[`&${o}-topLeft, &${o}-bottomLeft`]:{[V]:{marginInlineEnd:"auto",marginInlineStart:0}},[`${o}-fade-enter, ${o}-fade-appear`]:{animationDuration:e.motionDurationMid,animationTimingFunction:M,animationFillMode:"both",opacity:0,animationPlayState:"paused"},[`${o}-fade-leave`]:{animationTimingFunction:M,animationFillMode:"both",animationDuration:O,animationPlayState:"paused"},[`${o}-fade-enter${o}-fade-enter-active, ${o}-fade-appear${o}-fade-appear-active`]:{animationName:W,animationPlayState:"running"},[`${o}-fade-leave${o}-fade-leave-active`]:{animationName:K,animationPlayState:"running"}}),U0e(e)),{"&-rtl":{direction:"rtl",[`${V}-btn`]:{float:"left"}}})},{[o]:{[V]:Object.assign({},Q)}},{[`${V}-pure-panel`]:Object.assign(Object.assign({},Q),{margin:0})}]},w9=ac("Notification",e=>{const r=e.paddingMD,o=e.paddingLG,s=lo(e,{notificationBg:e.colorBgElevated,notificationPaddingVertical:r,notificationPaddingHorizontal:o,notificationIconSize:e.fontSizeLG*e.lineHeightLG,notificationCloseButtonSize:e.controlHeightLG*.55,notificationMarginBottom:e.margin,notificationPadding:`${e.paddingMD}px ${e.paddingContentHorizontalLG}px`,notificationMarginEdge:e.marginLG,animationMaxHeight:150});return[B0e(s)]},e=>({zIndexPopup:e.zIndexPopupBase+50,width:384}));var j0e=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function I9(e,r){return r||b.createElement("span",{className:`${e}-close-x`},b.createElement(Phe,{className:`${e}-close-icon`}))}const V0e={success:Y7,info:Khe,error:MS,warning:Q7};function A9(e){let{prefixCls:r,icon:o,type:s,message:c,description:d,btn:f,role:m="alert"}=e,g=null;return o?g=b.createElement("span",{className:`${r}-icon`},o):s&&(g=b.createElement(V0e[s]||null,{className:Xe(`${r}-icon`,`${r}-icon-${s}`)})),b.createElement("div",{className:Xe({[`${r}-with-icon`]:g}),role:m},g,b.createElement("div",{className:`${r}-message`},c),b.createElement("div",{className:`${r}-description`},d),f&&b.createElement("div",{className:`${r}-btn`},f))}function $0e(e){const{prefixCls:r,className:o,icon:s,type:c,message:d,description:f,btn:m,closable:g=!0,closeIcon:_}=e,S=j0e(e,["prefixCls","className","icon","type","message","description","btn","closable","closeIcon"]),{getPrefixCls:T}=b.useContext(or),R=r||T("notification"),N=`${R}-notice`,[,A]=w9(R);return b.createElement(t9,Object.assign({},S,{prefixCls:R,className:Xe(o,A,`${N}-pure-panel`),eventKey:"pure",duration:null,closable:g,closeIcon:I9(R,_),content:b.createElement(A9,{prefixCls:N,icon:s,type:c,message:d,description:f,btn:m})}))}function H0e(e,r,o){let s;switch(e){case"top":s={left:"50%",transform:"translateX(-50%)",right:"auto",top:r,bottom:"auto"};break;case"topLeft":s={left:0,top:r,bottom:"auto"};break;case"topRight":s={right:0,top:r,bottom:"auto"};break;case"bottom":s={left:"50%",transform:"translateX(-50%)",right:"auto",top:"auto",bottom:o};break;case"bottomLeft":s={left:0,top:"auto",bottom:o};break;default:s={right:0,top:"auto",bottom:o};break}return s}function W0e(e){return{motionName:`${e}-fade`}}var G0e=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const wB=24,z0e=4.5,K0e=b.forwardRef((e,r)=>{const{top:o,bottom:s,prefixCls:c,getContainer:d,maxCount:f,rtl:m,onAllRemoved:g}=e,{getPrefixCls:_,getPopupContainer:S}=b.useContext(or),T=c||_("notification"),R=P=>H0e(P,o??wB,s??wB),[,N]=w9(T),A=()=>Xe(N,{[`${T}-rtl`]:m}),O=()=>W0e(T),[M,x]=rpe({prefixCls:T,style:R,className:A,motion:O,closable:!0,closeIcon:I9(T),duration:z0e,getContainer:()=>(d==null?void 0:d())||(S==null?void 0:S())||document.body,maxCount:f,onAllRemoved:g});return b.useImperativeHandle(r,()=>Object.assign(Object.assign({},M),{prefixCls:T,hashId:N})),x});function O9(e){const r=b.useRef(null);return[b.useMemo(()=>{const s=m=>{if(!r.current)return;const{open:g,prefixCls:_,hashId:S}=r.current,T=`${_}-notice`,{message:R,description:N,icon:A,type:O,btn:M,className:x,role:P="alert"}=m,D=G0e(m,["message","description","icon","type","btn","className","role"]);return g(Object.assign(Object.assign({placement:"topRight"},D),{content:b.createElement(A9,{prefixCls:T,icon:A,type:O,message:R,description:N,btn:M,role:P}),className:Xe(O&&`${T}-${O}`,S,x)}))},d={open:s,destroy:m=>{var g,_;m!==void 0?(g=r.current)===null||g===void 0||g.close(m):(_=r.current)===null||_===void 0||_.destroy()}};return["success","info","warning","error"].forEach(m=>{d[m]=g=>s(Object.assign(Object.assign({},g),{type:m}))}),d},[]),b.createElement(K0e,Object.assign({key:"notification-holder"},e,{ref:r}))]}function Y0e(e){return O9(e)}const q0e=function(){if(typeof navigator>"u"||typeof window>"u")return!1;var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e==null?void 0:e.substr(0,4))};var X0e=["prefixCls","invalidate","item","renderItem","responsive","responsiveDisabled","registerSize","itemKey","className","style","children","display","order","component"],vp=void 0;function J0e(e,r){var o=e.prefixCls,s=e.invalidate,c=e.item,d=e.renderItem,f=e.responsive,m=e.responsiveDisabled,g=e.registerSize,_=e.itemKey,S=e.className,T=e.style,R=e.children,N=e.display,A=e.order,O=e.component,M=O===void 0?"div":O,x=An(e,X0e),P=f&&!N;function D(K){g(_,K)}b.useEffect(function(){return function(){D(null)}},[]);var F=d&&c!==vp?d(c):R,$;s||($={opacity:P?0:1,height:P?0:vp,overflowY:P?"hidden":vp,order:f?A:vp,pointerEvents:P?"none":vp,position:P?"absolute":vp});var V={};P&&(V["aria-hidden"]=!0);var W=b.createElement(M,Ze({className:Xe(!s&&o,S),style:Oe(Oe({},$),T)},V,x,{ref:r}),F);return f&&(W=b.createElement(ah,{onResize:function(Q){var Y=Q.offsetWidth;D(Y)},disabled:m},W)),W}var bm=b.forwardRef(J0e);bm.displayName="Item";function Q0e(e){if(typeof MessageChannel>"u")ao(e);else{var r=new MessageChannel;r.port1.onmessage=function(){return e()},r.port2.postMessage(void 0)}}function Z0e(){var e=b.useRef(null),r=function(s){e.current||(e.current=[],Q0e(function(){Nl.unstable_batchedUpdates(function(){e.current.forEach(function(c){c()}),e.current=null})})),e.current.push(s)};return r}function X0(e,r){var o=b.useState(r),s=Ge(o,2),c=s[0],d=s[1],f=qs(function(m){e(function(){d(m)})});return[c,f]}var Oy=St.createContext(null),eme=["component"],tme=["className"],nme=["className"],rme=function(r,o){var s=b.useContext(Oy);if(!s){var c=r.component,d=c===void 0?"div":c,f=An(r,eme);return b.createElement(d,Ze({},f,{ref:o}))}var m=s.className,g=An(s,tme),_=r.className,S=An(r,nme);return b.createElement(Oy.Provider,{value:null},b.createElement(bm,Ze({ref:o,className:Xe(m,_)},g,S)))},x9=b.forwardRef(rme);x9.displayName="RawItem";var ime=["prefixCls","data","renderItem","renderRawItem","itemKey","itemWidth","ssr","style","className","maxCount","renderRest","renderRawRest","suffix","component","itemComponent","onVisibleChange"],N9="responsive",P9="invalidate";function ome(e){return"+ ".concat(e.length," ...")}function ame(e,r){var o=e.prefixCls,s=o===void 0?"rc-overflow":o,c=e.data,d=c===void 0?[]:c,f=e.renderItem,m=e.renderRawItem,g=e.itemKey,_=e.itemWidth,S=_===void 0?10:_,T=e.ssr,R=e.style,N=e.className,A=e.maxCount,O=e.renderRest,M=e.renderRawRest,x=e.suffix,P=e.component,D=P===void 0?"div":P,F=e.itemComponent,$=e.onVisibleChange,V=An(e,ime),W=T==="full",K=Z0e(),Q=X0(K,null),Y=Ge(Q,2),ee=Y[0],te=Y[1],ie=ee||0,le=X0(K,new Map),me=Ge(le,2),ce=me[0],se=me[1],ae=X0(K,0),ge=Ge(ae,2),Se=ge[0],de=ge[1],he=X0(K,0),be=Ge(he,2),ve=be[0],ke=be[1],Le=X0(K,0),$e=Ge(Le,2),Ve=$e[0],ut=$e[1],ht=b.useState(null),Ct=Ge(ht,2),gt=Ct[0],kt=Ct[1],It=b.useState(null),Lt=Ge(It,2),Yt=Lt[0],jt=Lt[1],He=b.useMemo(function(){return Yt===null&&W?Number.MAX_SAFE_INTEGER:Yt||0},[Yt,ee]),dt=b.useState(!1),rt=Ge(dt,2),et=rt[0],lt=rt[1],Dt="".concat(s,"-item"),Ht=Math.max(Se,ve),En=A===N9,Vt=d.length&&En,vn=A===P9,Un=Vt||typeof A=="number"&&d.length>A,xn=b.useMemo(function(){var Mt=d;return Vt?ee===null&&W?Mt=d:Mt=d.slice(0,Math.min(d.length,ie/S)):typeof A=="number"&&(Mt=d.slice(0,A)),Mt},[d,S,ee,A,Vt]),Dr=b.useMemo(function(){return Vt?d.slice(He+1):d.slice(xn.length)},[d,xn,Vt,He]),ln=b.useCallback(function(Mt,dn){var kn;return typeof g=="function"?g(Mt):(kn=g&&(Mt==null?void 0:Mt[g]))!==null&&kn!==void 0?kn:dn},[g]),Wr=b.useCallback(f||function(Mt){return Mt},[f]);function Gn(Mt,dn,kn){Yt===Mt&&(dn===void 0||dn===gt)||(jt(Mt),kn||(lt(Mt<d.length-1),$==null||$(Mt)),dn!==void 0&&kt(dn))}function zn(Mt,dn){te(dn.clientWidth)}function on(Mt,dn){se(function(kn){var er=new Map(kn);return dn===null?er.delete(Mt):er.set(Mt,dn),er})}function Ai(Mt,dn){ke(dn),de(ve)}function va(Mt,dn){ut(dn)}function kr(Mt){return ce.get(ln(xn[Mt],Mt))}qr(function(){if(ie&&typeof Ht=="number"&&xn){var Mt=Ve,dn=xn.length,kn=dn-1;if(!dn){Gn(0,null);return}for(var er=0;er<dn;er+=1){var Yn=kr(er);if(W&&(Yn=Yn||0),Yn===void 0){Gn(er-1,void 0,!0);break}if(Mt+=Yn,kn===0&&Mt<=ie||er===kn-1&&Mt+kr(kn)<=ie){Gn(kn,null);break}else if(Mt+Ht>ie){Gn(er-1,Mt-Yn-Ve+ve);break}}x&&kr(0)+Ve>ie&&kt(null)}},[ie,ce,ve,Ve,ln,xn]);var Zn=et&&!!Dr.length,tt={};gt!==null&&Vt&&(tt={position:"absolute",left:gt,top:0});var Tt={prefixCls:Dt,responsive:Vt,component:F,invalidate:vn},Rn=m?function(Mt,dn){var kn=ln(Mt,dn);return b.createElement(Oy.Provider,{key:kn,value:Oe(Oe({},Tt),{},{order:dn,item:Mt,itemKey:kn,registerSize:on,display:dn<=He})},m(Mt,dn))}:function(Mt,dn){var kn=ln(Mt,dn);return b.createElement(bm,Ze({},Tt,{order:dn,key:kn,item:Mt,renderItem:Wr,itemKey:kn,registerSize:on,display:dn<=He}))},Jt,Qt={order:Zn?He:Number.MAX_SAFE_INTEGER,className:"".concat(Dt,"-rest"),registerSize:Ai,display:Zn};if(M)M&&(Jt=b.createElement(Oy.Provider,{value:Oe(Oe({},Tt),Qt)},M(Dr)));else{var fr=O||ome;Jt=b.createElement(bm,Ze({},Tt,Qt),typeof fr=="function"?fr(Dr):fr)}var Kn=b.createElement(D,Ze({className:Xe(!vn&&s,N),style:R,ref:r},V),xn.map(Rn),Un?Jt:null,x&&b.createElement(bm,Ze({},Tt,{responsive:En,responsiveDisabled:!Vt,order:He,className:"".concat(Dt,"-suffix"),registerSize:va,display:!0,style:tt}),x));return En&&(Kn=b.createElement(ah,{onResize:zn,disabled:!Vt},Kn)),Kn}var El=b.forwardRef(ame);El.displayName="Overflow";El.Item=x9;El.RESPONSIVE=N9;El.INVALIDATE=P9;function D9(e){var r;return e==null||(r=e.getRootNode)===null||r===void 0?void 0:r.call(e)}function sme(e){return D9(e)instanceof ShadowRoot}function LA(e){return sme(e)?D9(e):null}var IB=b.createContext(null);function AB(e){return e?Array.isArray(e)?e:[e]:[]}function cme(e,r,o,s){return b.useMemo(function(){var c=AB(o??r),d=AB(s??r),f=new Set(c),m=new Set(d);return e&&(f.has("hover")&&(f.delete("hover"),f.add("click")),m.has("hover")&&(m.delete("hover"),m.add("click"))),[f,m]},[e,r,o,s])}function lme(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;return o?e[0]===r[0]:e[0]===r[0]&&e[1]===r[1]}function ume(e,r,o,s){for(var c=o.points,d=Object.keys(e),f=0;f<d.length;f+=1){var m,g=d[f];if(lme((m=e[g])===null||m===void 0?void 0:m.points,c,s))return"".concat(r,"-placement-").concat(g)}return""}function OB(e,r,o,s){return r||(o?{motionName:"".concat(e,"-").concat(o)}:s?{motionName:s}:null)}function Eg(e){return e.ownerDocument.defaultView}function MA(e){for(var r=[],o=e==null?void 0:e.parentElement,s=["hidden","scroll","clip","auto"];o;){var c=Eg(o).getComputedStyle(o),d=c.overflowX,f=c.overflowY,m=c.overflow;[d,f,m].some(function(g){return s.includes(g)})&&r.push(o),o=o.parentElement}return r}function Jm(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return Number.isNaN(e)?r:e}function J0(e){return Jm(parseFloat(e),0)}function xB(e,r){var o=Oe({},e);return(r||[]).forEach(function(s){if(!(s instanceof HTMLBodyElement||s instanceof HTMLHtmlElement)){var c=Eg(s).getComputedStyle(s),d=c.overflow,f=c.overflowClipMargin,m=c.borderTopWidth,g=c.borderBottomWidth,_=c.borderLeftWidth,S=c.borderRightWidth,T=s.getBoundingClientRect(),R=s.offsetHeight,N=s.clientHeight,A=s.offsetWidth,O=s.clientWidth,M=J0(m),x=J0(g),P=J0(_),D=J0(S),F=Jm(Math.round(T.width/A*1e3)/1e3),$=Jm(Math.round(T.height/R*1e3)/1e3),V=(A-O-P-D)*F,W=(R-N-M-x)*$,K=M*$,Q=x*$,Y=P*F,ee=D*F,te=0,ie=0;if(d==="clip"){var le=J0(f);te=le*F,ie=le*$}var me=T.x+Y-te,ce=T.y+K-ie,se=me+T.width+2*te-Y-ee-V,ae=ce+T.height+2*ie-K-Q-W;o.left=Math.max(o.left,me),o.top=Math.max(o.top,ce),o.right=Math.min(o.right,se),o.bottom=Math.min(o.bottom,ae)}}),o}function NB(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o="".concat(r),s=o.match(/^(.*)\%$/);return s?e*(parseFloat(s[1])/100):parseFloat(o)}function PB(e,r){var o=r||[],s=Ge(o,2),c=s[0],d=s[1];return[NB(e.width,c),NB(e.height,d)]}function DB(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return[e[0],e[1]]}function Ep(e,r){var o=r[0],s=r[1],c,d;return o==="t"?d=e.y:o==="b"?d=e.y+e.height:d=e.y+e.height/2,s==="l"?c=e.x:s==="r"?c=e.x+e.width:c=e.x+e.width/2,{x:c,y:d}}function Su(e,r){var o={t:"b",b:"t",l:"r",r:"l"};return e.map(function(s,c){return c===r?o[s]||"c":s}).join("")}function dme(e,r,o,s,c,d,f){var m=b.useState({ready:!1,offsetX:0,offsetY:0,offsetR:0,offsetB:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:c[s]||{}}),g=Ge(m,2),_=g[0],S=g[1],T=b.useRef(0),R=b.useMemo(function(){return r?MA(r):[]},[r]),N=b.useRef({}),A=function(){N.current={}};e||A();var O=qs(function(){if(r&&o&&e){let xo=function(Fl,xs){var pc=arguments.length>2&&arguments[2]!==void 0?arguments[2]:dt,Qu=ge.x+Fl,ph=ge.y+xs,kf=Qu+Ve,Lf=ph+$e,Mf=Math.max(Qu,pc.left),vt=Math.max(ph,pc.top),Zt=Math.min(kf,pc.right),mr=Math.min(Lf,pc.bottom);return Math.max(0,(Zt-Mf)*(mr-vt))},Hc=function(){ri=ge.y+Qt,Ya=ri+$e,_a=ge.x+Jt,qa=_a+Ve};var Df=xo,Os=Hc,P,D,F=r,$=F.ownerDocument,V=Eg(F),W=V.getComputedStyle(F),K=W.width,Q=W.height,Y=W.position,ee=F.style.left,te=F.style.top,ie=F.style.right,le=F.style.bottom,me=Oe(Oe({},c[s]),d),ce=$.createElement("div");(P=F.parentElement)===null||P===void 0||P.appendChild(ce),ce.style.left="".concat(F.offsetLeft,"px"),ce.style.top="".concat(F.offsetTop,"px"),ce.style.position=Y,ce.style.height="".concat(F.offsetHeight,"px"),ce.style.width="".concat(F.offsetWidth,"px"),F.style.left="0",F.style.top="0",F.style.right="auto",F.style.bottom="auto";var se;if(Array.isArray(o))se={x:o[0],y:o[1],width:0,height:0};else{var ae=o.getBoundingClientRect();se={x:ae.x,y:ae.y,width:ae.width,height:ae.height}}var ge=F.getBoundingClientRect(),Se=$.documentElement,de=Se.clientWidth,he=Se.clientHeight,be=Se.scrollWidth,ve=Se.scrollHeight,ke=Se.scrollTop,Le=Se.scrollLeft,$e=ge.height,Ve=ge.width,ut=se.height,ht=se.width,Ct={left:0,top:0,right:de,bottom:he},gt={left:-Le,top:-ke,right:be-Le,bottom:ve-ke},kt=me.htmlRegion,It="visible",Lt="visibleFirst";kt!=="scroll"&&kt!==Lt&&(kt=It);var Yt=kt===Lt,jt=xB(gt,R),He=xB(Ct,R),dt=kt===It?He:jt,rt=Yt?He:dt;F.style.left="auto",F.style.top="auto",F.style.right="0",F.style.bottom="0";var et=F.getBoundingClientRect();F.style.left=ee,F.style.top=te,F.style.right=ie,F.style.bottom=le,(D=F.parentElement)===null||D===void 0||D.removeChild(ce);var lt=Jm(Math.round(Ve/parseFloat(K)*1e3)/1e3),Dt=Jm(Math.round($e/parseFloat(Q)*1e3)/1e3);if(lt===0||Dt===0||my(o)&&!US(o))return;var Ht=me.offset,En=me.targetOffset,Vt=PB(ge,Ht),vn=Ge(Vt,2),Un=vn[0],xn=vn[1],Dr=PB(se,En),ln=Ge(Dr,2),Wr=ln[0],Gn=ln[1];se.x-=Wr,se.y-=Gn;var zn=me.points||[],on=Ge(zn,2),Ai=on[0],va=on[1],kr=DB(va),Zn=DB(Ai),tt=Ep(se,kr),Tt=Ep(ge,Zn),Rn=Oe({},me),Jt=tt.x-Tt.x+Un,Qt=tt.y-Tt.y+xn,fr=xo(Jt,Qt),Kn=xo(Jt,Qt,He),Mt=Ep(se,["t","l"]),dn=Ep(ge,["t","l"]),kn=Ep(se,["b","r"]),er=Ep(ge,["b","r"]),Yn=me.overflow||{},Qr=Yn.adjustX,Oi=Yn.adjustY,Ji=Yn.shiftX,Ka=Yn.shiftY,Ea=function(xs){return typeof xs=="boolean"?xs:xs>=0},ri,Ya,_a,qa;Hc();var cc=Ea(Oi),Dl=Zn[0]===kr[0];if(cc&&Zn[0]==="t"&&(Ya>rt.bottom||N.current.bt)){var Oo=Qt;Dl?Oo-=$e-ut:Oo=Mt.y-er.y-xn;var lc=xo(Jt,Oo),Ui=xo(Jt,Oo,He);lc>fr||lc===fr&&(!Yt||Ui>=Kn)?(N.current.bt=!0,Qt=Oo,xn=-xn,Rn.points=[Su(Zn,0),Su(kr,0)]):N.current.bt=!1}if(cc&&Zn[0]==="b"&&(ri<rt.top||N.current.tb)){var uo=Qt;Dl?uo+=$e-ut:uo=kn.y-dn.y-xn;var kl=xo(Jt,uo),Ll=xo(Jt,uo,He);kl>fr||kl===fr&&(!Yt||Ll>=Kn)?(N.current.tb=!0,Qt=uo,xn=-xn,Rn.points=[Su(Zn,0),Su(kr,0)]):N.current.tb=!1}var xi=Ea(Qr),uc=Zn[1]===kr[1];if(xi&&Zn[1]==="l"&&(qa>rt.right||N.current.rl)){var Is=Jt;uc?Is-=Ve-ht:Is=Mt.x-er.x-Un;var Gr=xo(Is,Qt),Xu=xo(Is,Qt,He);Gr>fr||Gr===fr&&(!Yt||Xu>=Kn)?(N.current.rl=!0,Jt=Is,Un=-Un,Rn.points=[Su(Zn,1),Su(kr,1)]):N.current.rl=!1}if(xi&&Zn[1]==="r"&&(_a<rt.left||N.current.lr)){var Xa=Jt;uc?Xa+=Ve-ht:Xa=kn.x-dn.x-Un;var Ho=xo(Xa,Qt),Vc=xo(Xa,Qt,He);Ho>fr||Ho===fr&&(!Yt||Vc>=Kn)?(N.current.lr=!0,Jt=Xa,Un=-Un,Rn.points=[Su(Zn,1),Su(kr,1)]):N.current.lr=!1}Hc();var ya=Ji===!0?0:Ji;typeof ya=="number"&&(_a<He.left&&(Jt-=_a-He.left-Un,se.x+ht<He.left+ya&&(Jt+=se.x-He.left+ht-ya)),qa>He.right&&(Jt-=qa-He.right-Un,se.x>He.right-ya&&(Jt+=se.x-He.right+ya)));var Ja=Ka===!0?0:Ka;typeof Ja=="number"&&(ri<He.top&&(Qt-=ri-He.top-xn,se.y+ut<He.top+Ja&&(Qt+=se.y-He.top+ut-Ja)),Ya>He.bottom&&(Qt-=Ya-He.bottom-xn,se.y>He.bottom-Ja&&(Qt+=se.y-He.bottom+Ja)));var Wo=ge.x+Jt,As=Wo+Ve,dc=ge.y+Qt,hc=dc+$e,Bi=se.x,$c=Bi+ht,tr=se.y,Pt=tr+ut,Bn=Math.max(Wo,Bi),ii=Math.min(As,$c),mi=(Bn+ii)/2,Sa=mi-Wo,Qa=Math.max(dc,tr),Ju=Math.min(hc,Pt),Nf=(Qa+Ju)/2,hh=Nf-dc;f==null||f(r,Rn);var Pf=et.right-ge.x-(Jt+ge.width),Ml=et.bottom-ge.y-(Qt+ge.height);S({ready:!0,offsetX:Jt/lt,offsetY:Qt/Dt,offsetR:Pf/lt,offsetB:Ml/Dt,arrowX:Sa/lt,arrowY:hh/Dt,scaleX:lt,scaleY:Dt,align:Rn})}}),M=function(){T.current+=1;var D=T.current;Promise.resolve().then(function(){T.current===D&&O()})},x=function(){S(function(D){return Oe(Oe({},D),{},{ready:!1})})};return qr(x,[s]),qr(function(){e||x()},[e]),[_.ready,_.offsetX,_.offsetY,_.offsetR,_.offsetB,_.arrowX,_.arrowY,_.scaleX,_.scaleY,_.align,M]}function hme(e,r,o,s,c){qr(function(){if(e&&r&&o){let R=function(){s(),c()};var T=R,d=r,f=o,m=MA(d),g=MA(f),_=Eg(f),S=new Set([_].concat(at(m),at(g)));return S.forEach(function(N){N.addEventListener("scroll",R,{passive:!0})}),_.addEventListener("resize",R,{passive:!0}),s(),function(){S.forEach(function(N){N.removeEventListener("scroll",R),_.removeEventListener("resize",R)})}}},[e,r,o])}function pme(e,r,o,s,c,d,f,m){var g=b.useRef(e),_=b.useRef(!1);g.current!==e&&(_.current=!0,g.current=e),b.useEffect(function(){var S=ao(function(){_.current=!1});return function(){ao.cancel(S)}},[e]),b.useEffect(function(){if(r&&s&&(!c||d)){var S=function(){var V=!1,W=function(Y){var ee=Y.target;V=f(ee)},K=function(Y){var ee=Y.target;!_.current&&g.current&&!V&&!f(ee)&&m(!1)};return[W,K]},T=S(),R=Ge(T,2),N=R[0],A=R[1],O=S(),M=Ge(O,2),x=M[0],P=M[1],D=Eg(s);D.addEventListener("mousedown",N,!0),D.addEventListener("click",A,!0),D.addEventListener("contextmenu",A,!0);var F=LA(o);return F&&(F.addEventListener("mousedown",x,!0),F.addEventListener("click",P,!0),F.addEventListener("contextmenu",P,!0)),function(){D.removeEventListener("mousedown",N,!0),D.removeEventListener("click",A,!0),D.removeEventListener("contextmenu",A,!0),F&&(F.removeEventListener("mousedown",x,!0),F.removeEventListener("click",P,!0),F.removeEventListener("contextmenu",P,!0))}}},[r,o,s,c,d])}function fme(e){var r=e.prefixCls,o=e.align,s=e.arrow,c=e.arrowPos,d=s||{},f=d.className,m=d.content,g=c.x,_=g===void 0?0:g,S=c.y,T=S===void 0?0:S,R=b.useRef();if(!o||!o.points)return null;var N={position:"absolute"};if(o.autoArrow!==!1){var A=o.points[0],O=o.points[1],M=A[0],x=A[1],P=O[0],D=O[1];M===P||!["t","b"].includes(M)?N.top=T:M==="t"?N.top=0:N.bottom=0,x===D||!["l","r"].includes(x)?N.left=_:x==="l"?N.left=0:N.right=0}return b.createElement("div",{ref:R,className:Xe("".concat(r,"-arrow"),f),style:N},m)}function mme(e){var r=e.prefixCls,o=e.open,s=e.zIndex,c=e.mask,d=e.motion;return c?b.createElement(ch,Ze({},d,{motionAppear:!0,visible:o,removeOnLeave:!0}),function(f){var m=f.className;return b.createElement("div",{style:{zIndex:s},className:Xe("".concat(r,"-mask"),m)})}):null}var gme=b.memo(function(e){var r=e.children;return r},function(e,r){return r.cache}),vme=b.forwardRef(function(e,r){var o=e.popup,s=e.className,c=e.prefixCls,d=e.style,f=e.target,m=e.onVisibleChanged,g=e.open,_=e.keepDom,S=e.fresh,T=e.onClick,R=e.mask,N=e.arrow,A=e.arrowPos,O=e.align,M=e.motion,x=e.maskMotion,P=e.forceRender,D=e.getPopupContainer,F=e.autoDestroy,$=e.portal,V=e.zIndex,W=e.onMouseEnter,K=e.onMouseLeave,Q=e.onPointerEnter,Y=e.ready,ee=e.offsetX,te=e.offsetY,ie=e.offsetR,le=e.offsetB,me=e.onAlign,ce=e.onPrepare,se=e.stretch,ae=e.targetWidth,ge=e.targetHeight,Se=typeof o=="function"?o():o,de=g||_,he=(D==null?void 0:D.length)>0,be=b.useState(!D||!he),ve=Ge(be,2),ke=ve[0],Le=ve[1];if(qr(function(){!ke&&he&&f&&Le(!0)},[ke,he,f]),!ke)return null;var $e="auto",Ve={left:"-1000vw",top:"-1000vh",right:$e,bottom:$e};if(Y||!g){var ut,ht=O.points,Ct=O.dynamicInset||((ut=O._experimental)===null||ut===void 0?void 0:ut.dynamicInset),gt=Ct&&ht[0][1]==="r",kt=Ct&&ht[0][0]==="b";gt?(Ve.right=ie,Ve.left=$e):(Ve.left=ee,Ve.right=$e),kt?(Ve.bottom=le,Ve.top=$e):(Ve.top=te,Ve.bottom=$e)}var It={};return se&&(se.includes("height")&&ge?It.height=ge:se.includes("minHeight")&&ge&&(It.minHeight=ge),se.includes("width")&&ae?It.width=ae:se.includes("minWidth")&&ae&&(It.minWidth=ae)),g||(It.pointerEvents="none"),b.createElement($,{open:P||de,getContainer:D&&function(){return D(f)},autoDestroy:F},b.createElement(mme,{prefixCls:c,open:g,zIndex:V,mask:R,motion:x}),b.createElement(ah,{onResize:me,disabled:!g},function(Lt){return b.createElement(ch,Ze({motionAppear:!0,motionEnter:!0,motionLeave:!0,removeOnLeave:!1,forceRender:P,leavedClassName:"".concat(c,"-hidden")},M,{onAppearPrepare:ce,onEnterPrepare:ce,visible:g,onVisibleChanged:function(jt){var He;M==null||(He=M.onVisibleChanged)===null||He===void 0||He.call(M,jt),m(jt)}}),function(Yt,jt){var He=Yt.className,dt=Yt.style,rt=Xe(c,He,s);return b.createElement("div",{ref:jc(Lt,r,jt),className:rt,style:Oe(Oe(Oe(Oe({"--arrow-x":"".concat(A.x||0,"px"),"--arrow-y":"".concat(A.y||0,"px")},Ve),It),dt),{},{boxSizing:"border-box",zIndex:V},d),onMouseEnter:W,onMouseLeave:K,onPointerEnter:Q,onClick:T},N&&b.createElement(fme,{prefixCls:c,arrow:N,arrowPos:A,align:O}),b.createElement(gme,{cache:!g&&!S},Se))})}))}),Eme=b.forwardRef(function(e,r){var o=e.children,s=e.getTriggerDOMNode,c=Cf(o),d=b.useCallback(function(m){rx(r,s?s(m):m)},[s]),f=TS(d,o.ref);return c?b.cloneElement(o,{ref:f}):o}),_me=["prefixCls","children","action","showAction","hideAction","popupVisible","defaultPopupVisible","onPopupVisibleChange","afterPopupVisibleChange","mouseEnterDelay","mouseLeaveDelay","focusDelay","blurDelay","mask","maskClosable","getPopupContainer","forceRender","autoDestroy","destroyPopupOnHide","popup","popupClassName","popupStyle","popupPlacement","builtinPlacements","popupAlign","zIndex","stretch","getPopupClassNameFromAlign","fresh","alignPoint","onPopupClick","onPopupAlign","arrow","popupMotion","maskMotion","popupTransitionName","popupAnimation","maskTransitionName","maskAnimation","className","getTriggerDOMNode"];function yme(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:h9,r=b.forwardRef(function(o,s){var c=o.prefixCls,d=c===void 0?"rc-trigger-popup":c,f=o.children,m=o.action,g=m===void 0?"hover":m,_=o.showAction,S=o.hideAction,T=o.popupVisible,R=o.defaultPopupVisible,N=o.onPopupVisibleChange,A=o.afterPopupVisibleChange,O=o.mouseEnterDelay,M=o.mouseLeaveDelay,x=M===void 0?.1:M,P=o.focusDelay,D=o.blurDelay,F=o.mask,$=o.maskClosable,V=$===void 0?!0:$,W=o.getPopupContainer,K=o.forceRender,Q=o.autoDestroy,Y=o.destroyPopupOnHide,ee=o.popup,te=o.popupClassName,ie=o.popupStyle,le=o.popupPlacement,me=o.builtinPlacements,ce=me===void 0?{}:me,se=o.popupAlign,ae=o.zIndex,ge=o.stretch,Se=o.getPopupClassNameFromAlign,de=o.fresh,he=o.alignPoint,be=o.onPopupClick,ve=o.onPopupAlign,ke=o.arrow,Le=o.popupMotion,$e=o.maskMotion,Ve=o.popupTransitionName,ut=o.popupAnimation,ht=o.maskTransitionName,Ct=o.maskAnimation,gt=o.className,kt=o.getTriggerDOMNode,It=An(o,_me),Lt=Q||Y||!1,Yt=b.useState(!1),jt=Ge(Yt,2),He=jt[0],dt=jt[1];qr(function(){dt(q0e())},[]);var rt=b.useRef({}),et=b.useContext(IB),lt=b.useMemo(function(){return{registerSubPopup:function(Zt,mr){rt.current[Zt]=mr,et==null||et.registerSubPopup(Zt,mr)}}},[et]),Dt=_fe(),Ht=b.useState(null),En=Ge(Ht,2),Vt=En[0],vn=En[1],Un=qs(function(vt){my(vt)&&Vt!==vt&&vn(vt),et==null||et.registerSubPopup(Dt,vt)}),xn=b.useState(null),Dr=Ge(xn,2),ln=Dr[0],Wr=Dr[1],Gn=qs(function(vt){my(vt)&&ln!==vt&&Wr(vt)}),zn=b.Children.only(f),on=(zn==null?void 0:zn.props)||{},Ai={},va=qs(function(vt){var Zt,mr,oi=ln;return(oi==null?void 0:oi.contains(vt))||((Zt=LA(oi))===null||Zt===void 0?void 0:Zt.host)===vt||vt===oi||(Vt==null?void 0:Vt.contains(vt))||((mr=LA(Vt))===null||mr===void 0?void 0:mr.host)===vt||vt===Vt||Object.values(rt.current).some(function(Lr){return(Lr==null?void 0:Lr.contains(vt))||vt===Lr})}),kr=OB(d,Le,ut,Ve),Zn=OB(d,$e,Ct,ht),tt=b.useState(R||!1),Tt=Ge(tt,2),Rn=Tt[0],Jt=Tt[1],Qt=T??Rn,fr=qs(function(vt){T===void 0&&Jt(vt)});qr(function(){Jt(T||!1)},[T]);var Kn=b.useRef(Qt);Kn.current=Qt;var Mt=qs(function(vt){Nl.flushSync(function(){Qt!==vt&&(fr(vt),N==null||N(vt))})}),dn=b.useRef(),kn=function(){clearTimeout(dn.current)},er=function(Zt){var mr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;kn(),mr===0?Mt(Zt):dn.current=setTimeout(function(){Mt(Zt)},mr*1e3)};b.useEffect(function(){return kn},[]);var Yn=b.useState(!1),Qr=Ge(Yn,2),Oi=Qr[0],Ji=Qr[1];qr(function(vt){(!vt||Qt)&&Ji(!0)},[Qt]);var Ka=b.useState(null),Ea=Ge(Ka,2),ri=Ea[0],Ya=Ea[1],_a=b.useState([0,0]),qa=Ge(_a,2),cc=qa[0],Dl=qa[1],Oo=function(Zt){Dl([Zt.clientX,Zt.clientY])},lc=dme(Qt,Vt,he?cc:ln,le,ce,se,ve),Ui=Ge(lc,11),uo=Ui[0],kl=Ui[1],Ll=Ui[2],xi=Ui[3],uc=Ui[4],Is=Ui[5],Gr=Ui[6],Xu=Ui[7],Xa=Ui[8],Ho=Ui[9],Vc=Ui[10],ya=cme(He,g,_,S),Ja=Ge(ya,2),Wo=Ja[0],As=Ja[1],dc=Wo.has("click"),hc=As.has("click")||As.has("contextMenu"),Bi=qs(function(){Oi||Vc()}),$c=function(){Kn.current&&he&&hc&&er(!1)};hme(Qt,ln,Vt,Bi,$c),qr(function(){Bi()},[cc,le]),qr(function(){Qt&&!(ce!=null&&ce[le])&&Bi()},[JSON.stringify(se)]);var tr=b.useMemo(function(){var vt=ume(ce,d,Ho,he);return Xe(vt,Se==null?void 0:Se(Ho))},[Ho,Se,ce,d,he]);b.useImperativeHandle(s,function(){return{forceAlign:Bi}});var Pt=b.useState(0),Bn=Ge(Pt,2),ii=Bn[0],mi=Bn[1],Sa=b.useState(0),Qa=Ge(Sa,2),Ju=Qa[0],Nf=Qa[1],hh=function(){if(ge&&ln){var Zt=ln.getBoundingClientRect();mi(Zt.width),Nf(Zt.height)}},Pf=function(){hh(),Bi()},Ml=function(Zt){Ji(!1),Vc(),A==null||A(Zt)},Df=function(){return new Promise(function(Zt){hh(),Ya(function(){return Zt})})};qr(function(){ri&&(Vc(),ri(),Ya(null))},[ri]);function Os(vt,Zt,mr,oi){Ai[vt]=function(Lr){var fh;oi==null||oi(Lr),er(Zt,mr);for(var Wc=arguments.length,wg=new Array(Wc>1?Wc-1:0),mh=1;mh<Wc;mh++)wg[mh-1]=arguments[mh];(fh=on[vt])===null||fh===void 0||fh.call.apply(fh,[on,Lr].concat(wg))}}(dc||hc)&&(Ai.onClick=function(vt){var Zt;Kn.current&&hc?er(!1):!Kn.current&&dc&&(Oo(vt),er(!0));for(var mr=arguments.length,oi=new Array(mr>1?mr-1:0),Lr=1;Lr<mr;Lr++)oi[Lr-1]=arguments[Lr];(Zt=on.onClick)===null||Zt===void 0||Zt.call.apply(Zt,[on,vt].concat(oi))}),pme(Qt,hc,ln,Vt,F,V,va,er);var xo=Wo.has("hover"),Hc=As.has("hover"),Fl,xs;xo&&(Os("onMouseEnter",!0,O,function(vt){Oo(vt)}),Os("onPointerEnter",!0,O,function(vt){Oo(vt)}),Fl=function(){(Qt||Oi)&&er(!0,O)},he&&(Ai.onMouseMove=function(vt){var Zt;(Zt=on.onMouseMove)===null||Zt===void 0||Zt.call(on,vt)})),Hc&&(Os("onMouseLeave",!1,x),Os("onPointerLeave",!1,x),xs=function(){er(!1,x)}),Wo.has("focus")&&Os("onFocus",!0,P),As.has("focus")&&Os("onBlur",!1,D),Wo.has("contextMenu")&&(Ai.onContextMenu=function(vt){var Zt;Kn.current&&As.has("contextMenu")?er(!1):(Oo(vt),er(!0)),vt.preventDefault();for(var mr=arguments.length,oi=new Array(mr>1?mr-1:0),Lr=1;Lr<mr;Lr++)oi[Lr-1]=arguments[Lr];(Zt=on.onContextMenu)===null||Zt===void 0||Zt.call.apply(Zt,[on,vt].concat(oi))}),gt&&(Ai.className=Xe(on.className,gt));var pc=Oe(Oe({},on),Ai),Qu={},ph=["onContextMenu","onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"];ph.forEach(function(vt){It[vt]&&(Qu[vt]=function(){for(var Zt,mr=arguments.length,oi=new Array(mr),Lr=0;Lr<mr;Lr++)oi[Lr]=arguments[Lr];(Zt=pc[vt])===null||Zt===void 0||Zt.call.apply(Zt,[pc].concat(oi)),It[vt].apply(It,oi)})});var kf=b.cloneElement(zn,Oe(Oe({},pc),Qu)),Lf={x:Is,y:Gr},Mf=ke?Oe({},ke!==!0?ke:{}):null;return b.createElement(b.Fragment,null,b.createElement(ah,{disabled:!Qt,ref:Gn,onResize:Pf},b.createElement(Eme,{getTriggerDOMNode:kt},kf)),b.createElement(IB.Provider,{value:lt},b.createElement(vme,{portal:e,ref:Un,prefixCls:d,popup:ee,className:Xe(te,tr),style:ie,target:ln,onMouseEnter:Fl,onMouseLeave:xs,onPointerEnter:Fl,zIndex:ae,open:Qt,keepDom:Oi,fresh:de,onClick:be,mask:F,motion:kr,maskMotion:Zn,onVisibleChanged:Ml,onPrepare:Df,forceRender:K,autoDestroy:Lt,getPopupContainer:W,align:Ho,arrow:Mf,arrowPos:Lf,ready:uo,offsetX:kl,offsetY:Ll,offsetR:xi,offsetB:uc,onAlign:Bi,stretch:ge,targetWidth:ii/Xu,targetHeight:Ju/Xa})))});return r}const k9=yme(h9);function Tm(e,r,o){return Xe({[`${e}-status-success`]:r==="success",[`${e}-status-warning`]:r==="warning",[`${e}-status-error`]:r==="error",[`${e}-status-validating`]:r==="validating",[`${e}-has-feedback`]:o})}const L9=(e,r)=>r||e;var M9={};Object.defineProperty(M9,"__esModule",{value:!0});var Sme={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"},Cme=M9.default=Sme;function bme(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function Tme(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){bme(e,c,o[c])})}return e}function Rme(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function wme(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rme(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var Ime=function(e,r){return b.createElement(Yi,wme(Tme({},e),{ref:r,icon:Cme}))};const Ame=b.forwardRef(Ime);var F9={};Object.defineProperty(F9,"__esModule",{value:!0});var Ome={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"},xme=F9.default=Ome;function Nme(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function Pme(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){Nme(e,c,o[c])})}return e}function Dme(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function kme(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dme(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var Lme=function(e,r){return b.createElement(Yi,kme(Pme({},e),{ref:r,icon:xme}))};const Mme=b.forwardRef(Lme),Qm=["xxl","xl","lg","md","sm","xs"],Fme=e=>({xs:`(max-width: ${e.screenXSMax}px)`,sm:`(min-width: ${e.screenSM}px)`,md:`(min-width: ${e.screenMD}px)`,lg:`(min-width: ${e.screenLG}px)`,xl:`(min-width: ${e.screenXL}px)`,xxl:`(min-width: ${e.screenXXL}px)`}),Ume=e=>{const r=e,o=[].concat(Qm).reverse();return o.forEach((s,c)=>{const d=s.toUpperCase(),f=`screen${d}Min`,m=`screen${d}`;if(!(r[f]<=r[m]))throw new Error(`${f}<=${m} fails : !(${r[f]}<=${r[m]})`);if(c<o.length-1){const g=`screen${d}Max`;if(!(r[m]<=r[g]))throw new Error(`${m}<=${g} fails : !(${r[m]}<=${r[g]})`);const S=`screen${o[c+1].toUpperCase()}Min`;if(!(r[g]<=r[S]))throw new Error(`${g}<=${S} fails : !(${r[g]}<=${r[S]})`)}}),e};function Bme(){const[,e]=Tf(),r=Fme(Ume(e));return St.useMemo(()=>{const o=new Map;let s=-1,c={};return{matchHandlers:{},dispatch(d){return c=d,o.forEach(f=>f(c)),o.size>=1},subscribe(d){return o.size||this.register(),s+=1,o.set(s,d),d(c),s},unsubscribe(d){o.delete(d),o.size||this.unregister()},unregister(){Object.keys(r).forEach(d=>{const f=r[d],m=this.matchHandlers[f];m==null||m.mql.removeListener(m==null?void 0:m.listener)}),o.clear()},register(){Object.keys(r).forEach(d=>{const f=r[d],m=_=>{let{matches:S}=_;this.dispatch(Object.assign(Object.assign({},c),{[d]:S}))},g=window.matchMedia(f);g.addListener(m),this.matchHandlers[f]={mql:g,listener:m},m(g)})},responsiveMap:r}},[e])}var _p={shiftX:64,adjustY:1},yp={adjustX:1,shiftY:!0},hs=[0,0],jme={left:{points:["cr","cl"],overflow:yp,offset:[-4,0],targetOffset:hs},right:{points:["cl","cr"],overflow:yp,offset:[4,0],targetOffset:hs},top:{points:["bc","tc"],overflow:_p,offset:[0,-4],targetOffset:hs},bottom:{points:["tc","bc"],overflow:_p,offset:[0,4],targetOffset:hs},topLeft:{points:["bl","tl"],overflow:_p,offset:[0,-4],targetOffset:hs},leftTop:{points:["tr","tl"],overflow:yp,offset:[-4,0],targetOffset:hs},topRight:{points:["br","tr"],overflow:_p,offset:[0,-4],targetOffset:hs},rightTop:{points:["tl","tr"],overflow:yp,offset:[4,0],targetOffset:hs},bottomRight:{points:["tr","br"],overflow:_p,offset:[0,4],targetOffset:hs},rightBottom:{points:["bl","br"],overflow:yp,offset:[4,0],targetOffset:hs},bottomLeft:{points:["tl","bl"],overflow:_p,offset:[0,4],targetOffset:hs},leftBottom:{points:["br","bl"],overflow:yp,offset:[-4,0],targetOffset:hs}};function U9(e){var r=e.children,o=e.prefixCls,s=e.id,c=e.overlayInnerStyle,d=e.className,f=e.style;return b.createElement("div",{className:Xe("".concat(o,"-content"),d),style:f},b.createElement("div",{className:"".concat(o,"-inner"),id:s,role:"tooltip",style:c},typeof r=="function"?r():r))}var Vme=["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","afterVisibleChange","transitionName","animation","motion","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer","overlayInnerStyle","arrowContent","overlay","id","showArrow"],$me=function(r,o){var s=r.overlayClassName,c=r.trigger,d=c===void 0?["hover"]:c,f=r.mouseEnterDelay,m=f===void 0?0:f,g=r.mouseLeaveDelay,_=g===void 0?.1:g,S=r.overlayStyle,T=r.prefixCls,R=T===void 0?"rc-tooltip":T,N=r.children,A=r.onVisibleChange,O=r.afterVisibleChange,M=r.transitionName,x=r.animation,P=r.motion,D=r.placement,F=D===void 0?"right":D,$=r.align,V=$===void 0?{}:$,W=r.destroyTooltipOnHide,K=W===void 0?!1:W,Q=r.defaultVisible,Y=r.getTooltipContainer,ee=r.overlayInnerStyle;r.arrowContent;var te=r.overlay,ie=r.id,le=r.showArrow,me=le===void 0?!0:le,ce=An(r,Vme),se=b.useRef(null);b.useImperativeHandle(o,function(){return se.current});var ae=Oe({},ce);"visible"in r&&(ae.popupVisible=r.visible);var ge=function(){return b.createElement(U9,{key:"content",prefixCls:R,id:ie,overlayInnerStyle:ee},te)};return b.createElement(k9,Ze({popupClassName:s,prefixCls:R,popup:ge,action:d,builtinPlacements:jme,popupPlacement:F,ref:se,popupAlign:V,getPopupContainer:Y,onPopupVisibleChange:A,afterPopupVisibleChange:O,popupTransitionName:M,popupAnimation:x,popupMotion:P,defaultPopupVisible:Q,autoDestroy:K,mouseLeaveDelay:_,popupStyle:S,mouseEnterDelay:m,arrow:me},ae),N)};const Hme=b.forwardRef($me),B9=8;function j9(e){const r=B9,{contentRadius:o,limitVerticalRadius:s}=e,c=o>12?o+2:12;return{dropdownArrowOffset:c,dropdownArrowOffsetVertical:s?r:c}}function a_(e,r){return e?r:{}}function Wme(e,r){const{componentCls:o,sizePopupArrow:s,borderRadiusXS:c,borderRadiusOuter:d,boxShadowPopoverArrow:f}=e,{colorBg:m,contentRadius:g=e.borderRadiusLG,limitVerticalRadius:_,arrowDistance:S=0,arrowPlacement:T={left:!0,right:!0,top:!0,bottom:!0}}=r,{dropdownArrowOffsetVertical:R,dropdownArrowOffset:N}=j9({contentRadius:g,limitVerticalRadius:_});return{[o]:Object.assign(Object.assign(Object.assign(Object.assign({[`${o}-arrow`]:[Object.assign(Object.assign({position:"absolute",zIndex:1,display:"block"},Fle(s,c,d,m,f)),{"&:before":{background:m}})]},a_(!!T.top,{[[`&-placement-top ${o}-arrow`,`&-placement-topLeft ${o}-arrow`,`&-placement-topRight ${o}-arrow`].join(",")]:{bottom:S,transform:"translateY(100%) rotate(180deg)"},[`&-placement-top ${o}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(100%) rotate(180deg)"},[`&-placement-topLeft ${o}-arrow`]:{left:{_skip_check_:!0,value:N}},[`&-placement-topRight ${o}-arrow`]:{right:{_skip_check_:!0,value:N}}})),a_(!!T.bottom,{[[`&-placement-bottom ${o}-arrow`,`&-placement-bottomLeft ${o}-arrow`,`&-placement-bottomRight ${o}-arrow`].join(",")]:{top:S,transform:"translateY(-100%)"},[`&-placement-bottom ${o}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(-100%)"},[`&-placement-bottomLeft ${o}-arrow`]:{left:{_skip_check_:!0,value:N}},[`&-placement-bottomRight ${o}-arrow`]:{right:{_skip_check_:!0,value:N}}})),a_(!!T.left,{[[`&-placement-left ${o}-arrow`,`&-placement-leftTop ${o}-arrow`,`&-placement-leftBottom ${o}-arrow`].join(",")]:{right:{_skip_check_:!0,value:S},transform:"translateX(100%) rotate(90deg)"},[`&-placement-left ${o}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(100%) rotate(90deg)"},[`&-placement-leftTop ${o}-arrow`]:{top:R},[`&-placement-leftBottom ${o}-arrow`]:{bottom:R}})),a_(!!T.right,{[[`&-placement-right ${o}-arrow`,`&-placement-rightTop ${o}-arrow`,`&-placement-rightBottom ${o}-arrow`].join(",")]:{left:{_skip_check_:!0,value:S},transform:"translateX(-100%) rotate(-90deg)"},[`&-placement-right ${o}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(-100%) rotate(-90deg)"},[`&-placement-rightTop ${o}-arrow`]:{top:R},[`&-placement-rightBottom ${o}-arrow`]:{bottom:R}}))}}function Gme(e,r,o,s){if(s===!1)return{adjustX:!1,adjustY:!1};const c=s&&typeof s=="object"?s:{},d={};switch(e){case"top":case"bottom":d.shiftX=r.dropdownArrowOffset*2+o;break;case"left":case"right":d.shiftY=r.dropdownArrowOffsetVertical*2+o;break}const f=Object.assign(Object.assign({},d),c);return f.shiftX||(f.adjustX=!0),f.shiftY||(f.adjustY=!0),f}const kB={left:{points:["cr","cl"]},right:{points:["cl","cr"]},top:{points:["bc","tc"]},bottom:{points:["tc","bc"]},topLeft:{points:["bl","tl"]},leftTop:{points:["tr","tl"]},topRight:{points:["br","tr"]},rightTop:{points:["tl","tr"]},bottomRight:{points:["tr","br"]},rightBottom:{points:["bl","br"]},bottomLeft:{points:["tl","bl"]},leftBottom:{points:["br","bl"]}},zme={topLeft:{points:["bl","tc"]},leftTop:{points:["tr","cl"]},topRight:{points:["br","tc"]},rightTop:{points:["tl","cr"]},bottomRight:{points:["tr","bc"]},rightBottom:{points:["bl","cr"]},bottomLeft:{points:["tl","bc"]},leftBottom:{points:["br","cl"]}},Kme=new Set(["topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"]);function Yme(e){const{arrowWidth:r,autoAdjustOverflow:o,arrowPointAtCenter:s,offset:c,borderRadius:d,visibleFirst:f}=e,m=r/2,g={};return Object.keys(kB).forEach(_=>{const S=s&&zme[_]||kB[_],T=Object.assign(Object.assign({},S),{offset:[0,0]});switch(g[_]=T,Kme.has(_)&&(T.autoArrow=!1),_){case"top":case"topLeft":case"topRight":T.offset[1]=-m-c;break;case"bottom":case"bottomLeft":case"bottomRight":T.offset[1]=m+c;break;case"left":case"leftTop":case"leftBottom":T.offset[0]=-m-c;break;case"right":case"rightTop":case"rightBottom":T.offset[0]=m+c;break}const R=j9({contentRadius:d,limitVerticalRadius:!0});if(s)switch(_){case"topLeft":case"bottomLeft":T.offset[0]=-R.dropdownArrowOffset-m;break;case"topRight":case"bottomRight":T.offset[0]=R.dropdownArrowOffset+m;break;case"leftTop":case"rightTop":T.offset[1]=-R.dropdownArrowOffset-m;break;case"leftBottom":case"rightBottom":T.offset[1]=R.dropdownArrowOffset+m;break}T.overflow=Gme(_,R,r,o),f&&(T.htmlRegion="visibleFirst")}),g}const qme=e=>{const r=e!=null&&e.algorithm?_y(e.algorithm):_y(hg),o=Object.assign(Object.assign({},dg),e==null?void 0:e.token);return I$(o,{override:e==null?void 0:e.token},r,z$)},Xme=qme;function Jme(e){const{sizeUnit:r,sizeStep:o}=e,s=o-2;return{sizeXXL:r*(s+10),sizeXL:r*(s+6),sizeLG:r*(s+2),sizeMD:r*(s+2),sizeMS:r*(s+1),size:r*s,sizeSM:r*s,sizeXS:r*(s-1),sizeXXS:r*(s-1)}}const Qme=(e,r)=>{const o=r??hg(e),s=o.fontSizeSM,c=o.controlHeight-4;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o),Jme(r??e)),G$(s)),{controlHeight:c}),H$(Object.assign(Object.assign({},o),{controlHeight:c})))},Zme=Qme,Cu=(e,r)=>new io(e).setAlpha(r).toRgbString(),Sp=(e,r)=>new io(e).lighten(r).toHexString(),ege=e=>{const r=Rl(e,{theme:"dark"});return{1:r[0],2:r[1],3:r[2],4:r[3],5:r[6],6:r[5],7:r[4],8:r[6],9:r[5],10:r[4]}},tge=(e,r)=>{const o=e||"#000",s=r||"#fff";return{colorBgBase:o,colorTextBase:s,colorText:Cu(s,.85),colorTextSecondary:Cu(s,.65),colorTextTertiary:Cu(s,.45),colorTextQuaternary:Cu(s,.25),colorFill:Cu(s,.18),colorFillSecondary:Cu(s,.12),colorFillTertiary:Cu(s,.08),colorFillQuaternary:Cu(s,.04),colorBgElevated:Sp(o,12),colorBgContainer:Sp(o,8),colorBgLayout:Sp(o,0),colorBgSpotlight:Sp(o,26),colorBorder:Sp(o,26),colorBorderSecondary:Sp(o,19)}},nge=(e,r)=>{const o=Object.keys(px).map(c=>{const d=Rl(e[c],{theme:"dark"});return new Array(10).fill(1).reduce((f,m,g)=>(f[`${c}-${g+1}`]=d[g],f[`${c}${g+1}`]=d[g],f),{})}).reduce((c,d)=>(c=Object.assign(Object.assign({},c),d),c),{}),s=r??hg(e);return Object.assign(Object.assign(Object.assign({},s),o),W$(e,{generateColorPalettes:ege,generateNeutralColorPalettes:tge}))},rge=nge;function ige(){const[e,r,o]=Tf();return{theme:e,token:r,hashId:o}}const oge={defaultConfig:Cy,defaultSeed:Cy.token,useToken:ige,defaultAlgorithm:hg,darkAlgorithm:rge,compactAlgorithm:Zme,getDesignToken:Xme},age=e=>{const{componentCls:r,tooltipMaxWidth:o,tooltipColor:s,tooltipBg:c,tooltipBorderRadius:d,zIndexPopup:f,controlHeight:m,boxShadowSecondary:g,paddingSM:_,paddingXS:S,tooltipRadiusOuter:T}=e;return[{[r]:Object.assign(Object.assign(Object.assign(Object.assign({},sh(e)),{position:"absolute",zIndex:f,display:"block",width:"max-content",maxWidth:o,visibility:"visible",transformOrigin:"var(--arrow-x, 50%) var(--arrow-y, 50%)","&-hidden":{display:"none"},"--antd-arrow-background-color":c,[`${r}-inner`]:{minWidth:m,minHeight:m,padding:`${_/2}px ${S}px`,color:s,textAlign:"start",textDecoration:"none",wordWrap:"break-word",backgroundColor:c,borderRadius:d,boxShadow:g,boxSizing:"border-box"},[["&-placement-left","&-placement-leftTop","&-placement-leftBottom","&-placement-right","&-placement-rightTop","&-placement-rightBottom"].join(",")]:{[`${r}-inner`]:{borderRadius:Math.min(d,B9)}},[`${r}-content`]:{position:"relative"}}),Wle(e,(R,N)=>{let{darkColor:A}=N;return{[`&${r}-${R}`]:{[`${r}-inner`]:{backgroundColor:A},[`${r}-arrow`]:{"--antd-arrow-background-color":A}}}})),{"&-rtl":{direction:"rtl"}})},Wme(lo(e,{borderRadiusOuter:T}),{colorBg:"var(--antd-arrow-background-color)",contentRadius:d,limitVerticalRadius:!0}),{[`${r}-pure`]:{position:"relative",maxWidth:"none",margin:e.sizePopupArrow}}]},V9=(e,r)=>ac("Tooltip",s=>{if(r===!1)return[];const{borderRadius:c,colorTextLightSolid:d,colorBgDefault:f,borderRadiusOuter:m}=s,g=lo(s,{tooltipMaxWidth:250,tooltipColor:d,tooltipBorderRadius:c,tooltipBg:f,tooltipRadiusOuter:m>4?4:m});return[age(g),T9(s,"zoom-big-fast")]},s=>{let{zIndexPopupBase:c,colorBgSpotlight:d}=s;return{zIndexPopup:c+70,colorBgDefault:d}},{resetStyle:!1})(e),sge=Sy.map(e=>`${e}-inverse`);function cge(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?[].concat(at(sge),at(Sy)).includes(e):Sy.includes(e)}function $9(e,r){const o=cge(r),s=Xe({[`${e}-${r}`]:r&&o}),c={},d={};return r&&!o&&(c.background=r,d["--antd-arrow-background-color"]=r),{className:s,overlayStyle:c,arrowStyle:d}}function lge(e){const{prefixCls:r,className:o,placement:s="top",title:c,color:d,overlayInnerStyle:f}=e,{getPrefixCls:m}=b.useContext(or),g=m("tooltip",r),[_,S]=V9(g,!0),T=$9(g,d),R=Object.assign(Object.assign({},f),T.overlayStyle),N=T.arrowStyle;return _(b.createElement("div",{className:Xe(S,g,`${g}-pure`,`${g}-placement-${s}`,o,T.className),style:N},b.createElement("div",{className:`${g}-arrow`}),b.createElement(U9,Object.assign({},e,{className:S,prefixCls:g,overlayInnerStyle:R}),c)))}var uge=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const{useToken:dge}=oge,hge=(e,r)=>{const o={},s=Object.assign({},e);return r.forEach(c=>{e&&c in e&&(o[c]=e[c],delete s[c])}),{picked:o,omitted:s}};function pge(e,r){const o=e.type;if((o.__ANT_BUTTON===!0||e.type==="button")&&e.props.disabled||o.__ANT_SWITCH===!0&&(e.props.disabled||e.props.loading)||o.__ANT_RADIO===!0&&e.props.disabled){const{picked:s,omitted:c}=hge(e.props.style,["position","left","right","top","bottom","float","display","zIndex"]),d=Object.assign(Object.assign({display:"inline-block"},s),{cursor:"not-allowed",width:e.props.block?"100%":void 0}),f=Object.assign(Object.assign({},c),{pointerEvents:"none"}),m=nc(e,{style:f,className:null});return b.createElement("span",{style:d,className:Xe(e.props.className,`${r}-disabled-compatible-wrapper`)},m)}return e}const H9=b.forwardRef((e,r)=>{var o,s;const{prefixCls:c,openClassName:d,getTooltipContainer:f,overlayClassName:m,color:g,overlayInnerStyle:_,children:S,afterOpenChange:T,afterVisibleChange:R,destroyTooltipOnHide:N,arrow:A=!0,title:O,overlay:M,builtinPlacements:x,arrowPointAtCenter:P=!1,autoAdjustOverflow:D=!0}=e,F=!!A,{token:$}=dge(),{getPopupContainer:V,getPrefixCls:W,direction:K}=b.useContext(or),Q=b.useRef(null),Y=()=>{var He;(He=Q.current)===null||He===void 0||He.forceAlign()};b.useImperativeHandle(r,()=>({forceAlign:Y,forcePopupAlign:()=>{Y()}}));const[ee,te]=vl(!1,{value:(o=e.open)!==null&&o!==void 0?o:e.visible,defaultValue:(s=e.defaultOpen)!==null&&s!==void 0?s:e.defaultVisible}),ie=!O&&!M&&O!==0,le=He=>{var dt,rt;te(ie?!1:He),ie||((dt=e.onOpenChange)===null||dt===void 0||dt.call(e,He),(rt=e.onVisibleChange)===null||rt===void 0||rt.call(e,He))},me=b.useMemo(()=>{var He,dt;let rt=P;return typeof A=="object"&&(rt=(dt=(He=A.pointAtCenter)!==null&&He!==void 0?He:A.arrowPointAtCenter)!==null&&dt!==void 0?dt:P),x||Yme({arrowPointAtCenter:rt,autoAdjustOverflow:D,arrowWidth:F?$.sizePopupArrow:0,borderRadius:$.borderRadius,offset:$.marginXXS,visibleFirst:!0})},[P,A,x,$]),ce=b.useMemo(()=>O===0?O:M||O||"",[M,O]),se=b.createElement(SA,null,typeof ce=="function"?ce():ce),{getPopupContainer:ae,placement:ge="top",mouseEnterDelay:Se=.1,mouseLeaveDelay:de=.1,overlayStyle:he,rootClassName:be}=e,ve=uge(e,["getPopupContainer","placement","mouseEnterDelay","mouseLeaveDelay","overlayStyle","rootClassName"]),ke=W("tooltip",c),Le=W(),$e=e["data-popover-inject"];let Ve=ee;!("open"in e)&&!("visible"in e)&&ie&&(Ve=!1);const ut=pge($u(S)&&!e9(S)?S:b.createElement("span",null,S),ke),ht=ut.props,Ct=!ht.className||typeof ht.className=="string"?Xe(ht.className,{[d||`${ke}-open`]:!0}):ht.className,[gt,kt]=V9(ke,!$e),It=$9(ke,g),Lt=Object.assign(Object.assign({},_),It.overlayStyle),Yt=It.arrowStyle,jt=Xe(m,{[`${ke}-rtl`]:K==="rtl"},It.className,be,kt);return gt(b.createElement(Hme,Object.assign({},ve,{showArrow:F,placement:ge,mouseEnterDelay:Se,mouseLeaveDelay:de,prefixCls:ke,overlayClassName:jt,overlayStyle:Object.assign(Object.assign({},Yt),he),getTooltipContainer:ae||f||V,ref:Q,builtinPlacements:me,overlay:se,visible:Ve,onVisibleChange:le,afterVisibleChange:T??R,overlayInnerStyle:Lt,arrowContent:b.createElement("span",{className:`${ke}-arrow-content`}),motion:{motionName:ufe(Le,"zoom-big-fast",e.transitionName),motionDeadline:1e3},destroyTooltipOnHide:!!N}),Ve?nc(ut,{className:Ct}):ut))});H9._InternalPanelDoNotUseOrYouWillBeFired=lge;const Zm=H9;var W9={};Object.defineProperty(W9,"__esModule",{value:!0});var fge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"},mge=W9.default=fge;function gge(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function vge(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){gge(e,c,o[c])})}return e}function Ege(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function _ge(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ege(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var yge=function(e,r){return b.createElement(Yi,_ge(vge({},e),{ref:r,icon:mge}))};const LB=b.forwardRef(yge);var G9=b.createContext(null);function kx(e,r){return e===void 0?null:"".concat(e,"-").concat(r)}function z9(e){var r=b.useContext(G9);return kx(r,e)}var Sge=["children","locked"],rc=b.createContext(null);function Cge(e,r){var o=Oe({},e);return Object.keys(r).forEach(function(s){var c=r[s];c!==void 0&&(o[s]=c)}),o}function eg(e){var r=e.children,o=e.locked,s=An(e,Sge),c=b.useContext(rc),d=bS(function(){return Cge(c,s)},[c,s],function(f,m){return!o&&(f[0]!==m[0]||!wS(f[1],m[1],!0))});return b.createElement(rc.Provider,{value:d},r)}var bge=[],K9=b.createContext(null);function BS(){return b.useContext(K9)}var Y9=b.createContext(bge);function Of(e){var r=b.useContext(Y9);return b.useMemo(function(){return e!==void 0?[].concat(at(r),[e]):r},[r,e])}var q9=b.createContext(null),Lx=b.createContext({});function MB(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(US(e)){var o=e.nodeName.toLowerCase(),s=["input","select","textarea","button"].includes(o)||e.isContentEditable||o==="a"&&!!e.getAttribute("href"),c=e.getAttribute("tabindex"),d=Number(c),f=null;return c&&!Number.isNaN(d)?f=d:s&&f===null&&(f=0),s&&e.disabled&&(f=null),f!==null&&(f>=0||r&&f<0)}return!1}function Tge(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=at(e.querySelectorAll("*")).filter(function(s){return MB(s,r)});return MB(e,r)&&o.unshift(e),o}var FA=bt.LEFT,UA=bt.RIGHT,BA=bt.UP,L_=bt.DOWN,M_=bt.ENTER,X9=bt.ESC,Q0=bt.HOME,Z0=bt.END,FB=[BA,L_,FA,UA];function Rge(e,r,o,s){var c,d,f,m,g="prev",_="next",S="children",T="parent";if(e==="inline"&&s===M_)return{inlineTrigger:!0};var R=(c={},ct(c,BA,g),ct(c,L_,_),c),N=(d={},ct(d,FA,o?_:g),ct(d,UA,o?g:_),ct(d,L_,S),ct(d,M_,S),d),A=(f={},ct(f,BA,g),ct(f,L_,_),ct(f,M_,S),ct(f,X9,T),ct(f,FA,o?S:T),ct(f,UA,o?T:S),f),O={inline:R,horizontal:N,vertical:A,inlineSub:R,horizontalSub:A,verticalSub:A},M=(m=O["".concat(e).concat(r?"":"Sub")])===null||m===void 0?void 0:m[s];switch(M){case g:return{offset:-1,sibling:!0};case _:return{offset:1,sibling:!0};case T:return{offset:-1,sibling:!1};case S:return{offset:1,sibling:!1};default:return null}}function wge(e){for(var r=e;r;){if(r.getAttribute("data-menu-list"))return r;r=r.parentElement}return null}function Ige(e,r){for(var o=e||document.activeElement;o;){if(r.has(o))return o;o=o.parentElement}return null}function J9(e,r){var o=Tge(e,!0);return o.filter(function(s){return r.has(s)})}function UB(e,r,o){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;if(!e)return null;var c=J9(e,r),d=c.length,f=c.findIndex(function(m){return o===m});return s<0?f===-1?f=d-1:f-=1:s>0&&(f+=1),f=(f+d)%d,c[f]}function Age(e,r,o,s,c,d,f,m,g,_){var S=b.useRef(),T=b.useRef();T.current=r;var R=function(){ao.cancel(S.current)};return b.useEffect(function(){return function(){R()}},[]),function(N){var A=N.which;if([].concat(FB,[M_,X9,Q0,Z0]).includes(A)){var O,M,x,P=function(){O=new Set,M=new Map,x=new Map;var me=d();return me.forEach(function(ce){var se=document.querySelector("[data-menu-id='".concat(kx(s,ce),"']"));se&&(O.add(se),x.set(se,ce),M.set(ce,se))}),O};P();var D=M.get(r),F=Ige(D,O),$=x.get(F),V=Rge(e,f($,!0).length===1,o,A);if(!V&&A!==Q0&&A!==Z0)return;(FB.includes(A)||[Q0,Z0].includes(A))&&N.preventDefault();var W=function(me){if(me){var ce=me,se=me.querySelector("a");se!=null&&se.getAttribute("href")&&(ce=se);var ae=x.get(me);m(ae),R(),S.current=ao(function(){T.current===ae&&ce.focus()})}};if([Q0,Z0].includes(A)||V.sibling||!F){var K;!F||e==="inline"?K=c.current:K=wge(F);var Q,Y=J9(K,O);A===Q0?Q=Y[0]:A===Z0?Q=Y[Y.length-1]:Q=UB(K,O,F,V.offset),W(Q)}else if(V.inlineTrigger)g($);else if(V.offset>0)g($,!0),R(),S.current=ao(function(){P();var le=F.getAttribute("aria-controls"),me=document.getElementById(le),ce=UB(me,O);W(ce)},5);else if(V.offset<0){var ee=f($,!0),te=ee[ee.length-2],ie=M.get(te);g(te,!1),W(ie)}}_==null||_(N)}}function Oge(e){Promise.resolve().then(e)}var Mx="__RC_UTIL_PATH_SPLIT__",BB=function(r){return r.join(Mx)},xge=function(r){return r.split(Mx)},jA="rc-menu-more";function Nge(){var e=b.useState({}),r=Ge(e,2),o=r[1],s=b.useRef(new Map),c=b.useRef(new Map),d=b.useState([]),f=Ge(d,2),m=f[0],g=f[1],_=b.useRef(0),S=b.useRef(!1),T=function(){S.current||o({})},R=b.useCallback(function(D,F){var $=BB(F);c.current.set($,D),s.current.set(D,$),_.current+=1;var V=_.current;Oge(function(){V===_.current&&T()})},[]),N=b.useCallback(function(D,F){var $=BB(F);c.current.delete($),s.current.delete(D)},[]),A=b.useCallback(function(D){g(D)},[]),O=b.useCallback(function(D,F){var $=s.current.get(D)||"",V=xge($);return F&&m.includes(V[0])&&V.unshift(jA),V},[m]),M=b.useCallback(function(D,F){return D.some(function($){var V=O($,!0);return V.includes(F)})},[O]),x=function(){var F=at(s.current.keys());return m.length&&F.push(jA),F},P=b.useCallback(function(D){var F="".concat(s.current.get(D)).concat(Mx),$=new Set;return at(c.current.keys()).forEach(function(V){V.startsWith(F)&&$.add(c.current.get(V))}),$},[]);return b.useEffect(function(){return function(){S.current=!0}},[]),{registerPath:R,unregisterPath:N,refreshOverflowKeys:A,isSubPathKey:M,getKeyPath:O,getKeys:x,getSubPathKeys:P}}function cm(e){var r=b.useRef(e);r.current=e;var o=b.useCallback(function(){for(var s,c=arguments.length,d=new Array(c),f=0;f<c;f++)d[f]=arguments[f];return(s=r.current)===null||s===void 0?void 0:s.call.apply(s,[r].concat(d))},[]);return e?o:void 0}var Pge=Math.random().toFixed(5).toString().slice(2),jB=0;function Dge(e){var r=vl(e,{value:e}),o=Ge(r,2),s=o[0],c=o[1];return b.useEffect(function(){jB+=1;var d="".concat(Pge,"-").concat(jB);c("rc-menu-uuid-".concat(d))},[]),s}function Q9(e,r,o,s){var c=b.useContext(rc),d=c.activeKey,f=c.onActive,m=c.onInactive,g={active:d===e};return r||(g.onMouseEnter=function(_){o==null||o({key:e,domEvent:_}),f(e)},g.onMouseLeave=function(_){s==null||s({key:e,domEvent:_}),m(e)}),g}function Z9(e){var r=b.useContext(rc),o=r.mode,s=r.rtl,c=r.inlineIndent;if(o!=="inline")return null;var d=e;return s?{paddingRight:d*c}:{paddingLeft:d*c}}function eH(e){var r=e.icon,o=e.props,s=e.children,c;return typeof r=="function"?c=b.createElement(r,Oe({},o)):c=r,c||s||null}var kge=["item"];function xy(e){var r=e.item,o=An(e,kge);return Object.defineProperty(o,"item",{get:function(){return pa(!1,"`info.item` is deprecated since we will move to function component that not provides React Node instance in future."),r}}),o}var Lge=["title","attribute","elementRef"],Mge=["style","className","eventKey","warnKey","disabled","itemIcon","children","role","onMouseEnter","onMouseLeave","onClick","onKeyDown","onFocus"],Fge=["active"],Uge=function(e){yf(o,e);var r=Sf(o);function o(){return Ts(this,o),r.apply(this,arguments)}return Rs(o,[{key:"render",value:function(){var c=this.props,d=c.title,f=c.attribute,m=c.elementRef,g=An(c,Lge),_=ma(g,["eventKey","popupClassName","popupOffset","onTitleClick"]);return pa(!f,"`attribute` of Menu.Item is deprecated. Please pass attribute directly."),b.createElement(El.Item,Ze({},f,{title:typeof d=="string"?d:void 0},_,{ref:m}))}}]),o}(b.Component),Bge=b.forwardRef(function(e,r){var o,s=e.style,c=e.className,d=e.eventKey;e.warnKey;var f=e.disabled,m=e.itemIcon,g=e.children,_=e.role,S=e.onMouseEnter,T=e.onMouseLeave,R=e.onClick,N=e.onKeyDown,A=e.onFocus,O=An(e,Mge),M=z9(d),x=b.useContext(rc),P=x.prefixCls,D=x.onItemClick,F=x.disabled,$=x.overflowDisabled,V=x.itemIcon,W=x.selectedKeys,K=x.onActive,Q=b.useContext(Lx),Y=Q._internalRenderMenuItem,ee="".concat(P,"-item"),te=b.useRef(),ie=b.useRef(),le=F||f,me=TS(r,ie),ce=Of(d),se=function(ht){return{key:d,keyPath:at(ce).reverse(),item:te.current,domEvent:ht}},ae=m||V,ge=Q9(d,le,S,T),Se=ge.active,de=An(ge,Fge),he=W.includes(d),be=Z9(ce.length),ve=function(ht){if(!le){var Ct=se(ht);R==null||R(xy(Ct)),D(Ct)}},ke=function(ht){if(N==null||N(ht),ht.which===bt.ENTER){var Ct=se(ht);R==null||R(xy(Ct)),D(Ct)}},Le=function(ht){K(d),A==null||A(ht)},$e={};e.role==="option"&&($e["aria-selected"]=he);var Ve=b.createElement(Uge,Ze({ref:te,elementRef:me,role:_===null?"none":_||"menuitem",tabIndex:f?null:-1,"data-menu-id":$&&M?null:M},O,de,$e,{component:"li","aria-disabled":f,style:Oe(Oe({},be),s),className:Xe(ee,(o={},ct(o,"".concat(ee,"-active"),Se),ct(o,"".concat(ee,"-selected"),he),ct(o,"".concat(ee,"-disabled"),le),o),c),onClick:ve,onKeyDown:ke,onFocus:Le}),g,b.createElement(eH,{props:Oe(Oe({},e),{},{isSelected:he}),icon:ae}));return Y&&(Ve=Y(Ve,e,{selected:he})),Ve});function jge(e,r){var o=e.eventKey,s=BS(),c=Of(o);return b.useEffect(function(){if(s)return s.registerPath(o,c),function(){s.unregisterPath(o,c)}},[c]),s?null:b.createElement(Bge,Ze({},e,{ref:r}))}const jS=b.forwardRef(jge);var Vge=["className","children"],$ge=function(r,o){var s=r.className,c=r.children,d=An(r,Vge),f=b.useContext(rc),m=f.prefixCls,g=f.mode,_=f.rtl;return b.createElement("ul",Ze({className:Xe(m,_&&"".concat(m,"-rtl"),"".concat(m,"-sub"),"".concat(m,"-").concat(g==="inline"?"inline":"vertical"),s),role:"menu"},d,{"data-menu-list":!0,ref:o}),c)},Fx=b.forwardRef($ge);Fx.displayName="SubMenuList";var Hge=["label","children","key","type"];function Ux(e,r){return Tl(e).map(function(o,s){if(b.isValidElement(o)){var c,d,f=o.key,m=(c=(d=o.props)===null||d===void 0?void 0:d.eventKey)!==null&&c!==void 0?c:f,g=m==null;g&&(m="tmp_key-".concat([].concat(at(r),[s]).join("-")));var _={key:m,eventKey:m};return b.cloneElement(o,_)}return o})}function VA(e){return(e||[]).map(function(r,o){if(r&&Fn(r)==="object"){var s=r,c=s.label,d=s.children,f=s.key,m=s.type,g=An(s,Hge),_=f??"tmp-".concat(o);return d||m==="group"?m==="group"?b.createElement($S,Ze({key:_},g,{title:c}),VA(d)):b.createElement(VS,Ze({key:_},g,{title:c}),VA(d)):m==="divider"?b.createElement(Bx,Ze({key:_},g)):b.createElement(jS,Ze({key:_},g),c)}return null}).filter(function(r){return r})}function Wge(e,r,o){var s=e;return r&&(s=VA(r)),Ux(s,o)}var To={adjustX:1,adjustY:1},Gge={topLeft:{points:["bl","tl"],overflow:To},topRight:{points:["br","tr"],overflow:To},bottomLeft:{points:["tl","bl"],overflow:To},bottomRight:{points:["tr","br"],overflow:To},leftTop:{points:["tr","tl"],overflow:To},leftBottom:{points:["br","bl"],overflow:To},rightTop:{points:["tl","tr"],overflow:To},rightBottom:{points:["bl","br"],overflow:To}},zge={topLeft:{points:["bl","tl"],overflow:To},topRight:{points:["br","tr"],overflow:To},bottomLeft:{points:["tl","bl"],overflow:To},bottomRight:{points:["tr","br"],overflow:To},rightTop:{points:["tr","tl"],overflow:To},rightBottom:{points:["br","bl"],overflow:To},leftTop:{points:["tl","tr"],overflow:To},leftBottom:{points:["bl","br"],overflow:To}};function tH(e,r,o){if(r)return r;if(o)return o[e]||o.other}var Kge={horizontal:"bottomLeft",vertical:"rightTop","vertical-left":"rightTop","vertical-right":"leftTop"};function Yge(e){var r=e.prefixCls,o=e.visible,s=e.children,c=e.popup,d=e.popupClassName,f=e.popupOffset,m=e.disabled,g=e.mode,_=e.onVisibleChange,S=b.useContext(rc),T=S.getPopupContainer,R=S.rtl,N=S.subMenuOpenDelay,A=S.subMenuCloseDelay,O=S.builtinPlacements,M=S.triggerSubMenuAction,x=S.forceSubMenuRender,P=S.rootClassName,D=S.motion,F=S.defaultMotions,$=b.useState(!1),V=Ge($,2),W=V[0],K=V[1],Q=Oe(R?Oe({},zge):Oe({},Gge),O),Y=Kge[g],ee=tH(g,D,F),te=b.useRef(ee);g!=="inline"&&(te.current=ee);var ie=Oe(Oe({},te.current),{},{leavedClassName:"".concat(r,"-hidden"),removeOnLeave:!1,motionAppear:!0}),le=b.useRef();return b.useEffect(function(){return le.current=ao(function(){K(o)}),function(){ao.cancel(le.current)}},[o]),b.createElement(k9,{prefixCls:r,popupClassName:Xe("".concat(r,"-popup"),ct({},"".concat(r,"-rtl"),R),d,P),stretch:g==="horizontal"?"minWidth":null,getPopupContainer:T,builtinPlacements:Q,popupPlacement:Y,popupVisible:W,popup:c,popupAlign:f&&{offset:f},action:m?[]:[M],mouseEnterDelay:N,mouseLeaveDelay:A,onPopupVisibleChange:_,forceRender:x,popupMotion:ie},s)}function qge(e){var r=e.id,o=e.open,s=e.keyPath,c=e.children,d="inline",f=b.useContext(rc),m=f.prefixCls,g=f.forceSubMenuRender,_=f.motion,S=f.defaultMotions,T=f.mode,R=b.useRef(!1);R.current=T===d;var N=b.useState(!R.current),A=Ge(N,2),O=A[0],M=A[1],x=R.current?o:!1;b.useEffect(function(){R.current&&M(!1)},[T]);var P=Oe({},tH(d,_,S));s.length>1&&(P.motionAppear=!1);var D=P.onVisibleChanged;return P.onVisibleChanged=function(F){return!R.current&&!F&&M(!0),D==null?void 0:D(F)},O?null:b.createElement(eg,{mode:d,locked:!R.current},b.createElement(ch,Ze({visible:x},P,{forceRender:g,removeOnLeave:!1,leavedClassName:"".concat(m,"-hidden")}),function(F){var $=F.className,V=F.style;return b.createElement(Fx,{id:r,className:$,style:V},c)}))}var Xge=["style","className","title","eventKey","warnKey","disabled","internalPopupClose","children","itemIcon","expandIcon","popupClassName","popupOffset","onClick","onMouseEnter","onMouseLeave","onTitleClick","onTitleMouseEnter","onTitleMouseLeave"],Jge=["active"],Qge=function(r){var o,s=r.style,c=r.className,d=r.title,f=r.eventKey;r.warnKey;var m=r.disabled,g=r.internalPopupClose,_=r.children,S=r.itemIcon,T=r.expandIcon,R=r.popupClassName,N=r.popupOffset,A=r.onClick,O=r.onMouseEnter,M=r.onMouseLeave,x=r.onTitleClick,P=r.onTitleMouseEnter,D=r.onTitleMouseLeave,F=An(r,Xge),$=z9(f),V=b.useContext(rc),W=V.prefixCls,K=V.mode,Q=V.openKeys,Y=V.disabled,ee=V.overflowDisabled,te=V.activeKey,ie=V.selectedKeys,le=V.itemIcon,me=V.expandIcon,ce=V.onItemClick,se=V.onOpenChange,ae=V.onActive,ge=b.useContext(Lx),Se=ge._internalRenderSubMenuItem,de=b.useContext(q9),he=de.isSubPathKey,be=Of(),ve="".concat(W,"-submenu"),ke=Y||m,Le=b.useRef(),$e=b.useRef(),Ve=S||le,ut=T||me,ht=Q.includes(f),Ct=!ee&&ht,gt=he(ie,f),kt=Q9(f,ke,P,D),It=kt.active,Lt=An(kt,Jge),Yt=b.useState(!1),jt=Ge(Yt,2),He=jt[0],dt=jt[1],rt=function(on){ke||dt(on)},et=function(on){rt(!0),O==null||O({key:f,domEvent:on})},lt=function(on){rt(!1),M==null||M({key:f,domEvent:on})},Dt=b.useMemo(function(){return It||(K!=="inline"?He||he([te],f):!1)},[K,It,te,He,f,he]),Ht=Z9(be.length),En=function(on){ke||(x==null||x({key:f,domEvent:on}),K==="inline"&&se(f,!ht))},Vt=cm(function(zn){A==null||A(xy(zn)),ce(zn)}),vn=function(on){K!=="inline"&&se(f,on)},Un=function(){ae(f)},xn=$&&"".concat($,"-popup"),Dr=b.createElement("div",Ze({role:"menuitem",style:Ht,className:"".concat(ve,"-title"),tabIndex:ke?null:-1,ref:Le,title:typeof d=="string"?d:null,"data-menu-id":ee&&$?null:$,"aria-expanded":Ct,"aria-haspopup":!0,"aria-controls":xn,"aria-disabled":ke,onClick:En,onFocus:Un},Lt),d,b.createElement(eH,{icon:K!=="horizontal"?ut:null,props:Oe(Oe({},r),{},{isOpen:Ct,isSubMenu:!0})},b.createElement("i",{className:"".concat(ve,"-arrow")}))),ln=b.useRef(K);if(K!=="inline"&&be.length>1?ln.current="vertical":ln.current=K,!ee){var Wr=ln.current;Dr=b.createElement(Yge,{mode:Wr,prefixCls:ve,visible:!g&&Ct&&K!=="inline",popupClassName:R,popupOffset:N,popup:b.createElement(eg,{mode:Wr==="horizontal"?"vertical":Wr},b.createElement(Fx,{id:xn,ref:$e},_)),disabled:ke,onVisibleChange:vn},Dr)}var Gn=b.createElement(El.Item,Ze({role:"none"},F,{component:"li",style:s,className:Xe(ve,"".concat(ve,"-").concat(K),c,(o={},ct(o,"".concat(ve,"-open"),Ct),ct(o,"".concat(ve,"-active"),Dt),ct(o,"".concat(ve,"-selected"),gt),ct(o,"".concat(ve,"-disabled"),ke),o)),onMouseEnter:et,onMouseLeave:lt}),Dr,!ee&&b.createElement(qge,{id:xn,open:Ct,keyPath:be},_));return Se&&(Gn=Se(Gn,r,{selected:gt,active:Dt,open:Ct,disabled:ke})),b.createElement(eg,{onItemClick:Vt,mode:K==="horizontal"?"vertical":K,itemIcon:Ve,expandIcon:ut},Gn)};function VS(e){var r=e.eventKey,o=e.children,s=Of(r),c=Ux(o,s),d=BS();b.useEffect(function(){if(d)return d.registerPath(r,s),function(){d.unregisterPath(r,s)}},[s]);var f;return d?f=c:f=b.createElement(Qge,e,c),b.createElement(Y9.Provider,{value:s},f)}var Zge=["prefixCls","rootClassName","style","className","tabIndex","items","children","direction","id","mode","inlineCollapsed","disabled","disabledOverflow","subMenuOpenDelay","subMenuCloseDelay","forceSubMenuRender","defaultOpenKeys","openKeys","activeKey","defaultActiveFirst","selectable","multiple","defaultSelectedKeys","selectedKeys","onSelect","onDeselect","inlineIndent","motion","defaultMotions","triggerSubMenuAction","builtinPlacements","itemIcon","expandIcon","overflowedIndicator","overflowedIndicatorPopupClassName","getPopupContainer","onClick","onOpenChange","onKeyDown","openAnimation","openTransitionName","_internalRenderMenuItem","_internalRenderSubMenuItem"],Cp=[],eve=b.forwardRef(function(e,r){var o,s,c=e,d=c.prefixCls,f=d===void 0?"rc-menu":d,m=c.rootClassName,g=c.style,_=c.className,S=c.tabIndex,T=S===void 0?0:S,R=c.items,N=c.children,A=c.direction,O=c.id,M=c.mode,x=M===void 0?"vertical":M,P=c.inlineCollapsed,D=c.disabled,F=c.disabledOverflow,$=c.subMenuOpenDelay,V=$===void 0?.1:$,W=c.subMenuCloseDelay,K=W===void 0?.1:W,Q=c.forceSubMenuRender,Y=c.defaultOpenKeys,ee=c.openKeys,te=c.activeKey,ie=c.defaultActiveFirst,le=c.selectable,me=le===void 0?!0:le,ce=c.multiple,se=ce===void 0?!1:ce,ae=c.defaultSelectedKeys,ge=c.selectedKeys,Se=c.onSelect,de=c.onDeselect,he=c.inlineIndent,be=he===void 0?24:he,ve=c.motion,ke=c.defaultMotions,Le=c.triggerSubMenuAction,$e=Le===void 0?"hover":Le,Ve=c.builtinPlacements,ut=c.itemIcon,ht=c.expandIcon,Ct=c.overflowedIndicator,gt=Ct===void 0?"...":Ct,kt=c.overflowedIndicatorPopupClassName,It=c.getPopupContainer,Lt=c.onClick,Yt=c.onOpenChange,jt=c.onKeyDown;c.openAnimation,c.openTransitionName;var He=c._internalRenderMenuItem,dt=c._internalRenderSubMenuItem,rt=An(c,Zge),et=b.useMemo(function(){return Wge(N,R,Cp)},[N,R]),lt=b.useState(!1),Dt=Ge(lt,2),Ht=Dt[0],En=Dt[1],Vt=b.useRef(),vn=Dge(O),Un=A==="rtl",xn=vl(Y,{value:ee,postState:function(Pt){return Pt||Cp}}),Dr=Ge(xn,2),ln=Dr[0],Wr=Dr[1],Gn=function(Pt){var Bn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;function ii(){Wr(Pt),Yt==null||Yt(Pt)}Bn?Nl.flushSync(ii):ii()},zn=b.useState(ln),on=Ge(zn,2),Ai=on[0],va=on[1],kr=b.useRef(!1),Zn=b.useMemo(function(){return(x==="inline"||x==="vertical")&&P?["vertical",P]:[x,!1]},[x,P]),tt=Ge(Zn,2),Tt=tt[0],Rn=tt[1],Jt=Tt==="inline",Qt=b.useState(Tt),fr=Ge(Qt,2),Kn=fr[0],Mt=fr[1],dn=b.useState(Rn),kn=Ge(dn,2),er=kn[0],Yn=kn[1];b.useEffect(function(){Mt(Tt),Yn(Rn),kr.current&&(Jt?Wr(Ai):Gn(Cp))},[Tt,Rn]);var Qr=b.useState(0),Oi=Ge(Qr,2),Ji=Oi[0],Ka=Oi[1],Ea=Ji>=et.length-1||Kn!=="horizontal"||F;b.useEffect(function(){Jt&&va(ln)},[ln]),b.useEffect(function(){return kr.current=!0,function(){kr.current=!1}},[]);var ri=Nge(),Ya=ri.registerPath,_a=ri.unregisterPath,qa=ri.refreshOverflowKeys,cc=ri.isSubPathKey,Dl=ri.getKeyPath,Oo=ri.getKeys,lc=ri.getSubPathKeys,Ui=b.useMemo(function(){return{registerPath:Ya,unregisterPath:_a}},[Ya,_a]),uo=b.useMemo(function(){return{isSubPathKey:cc}},[cc]);b.useEffect(function(){qa(Ea?Cp:et.slice(Ji+1).map(function(tr){return tr.key}))},[Ji,Ea]);var kl=vl(te||ie&&((o=et[0])===null||o===void 0?void 0:o.key),{value:te}),Ll=Ge(kl,2),xi=Ll[0],uc=Ll[1],Is=cm(function(tr){uc(tr)}),Gr=cm(function(){uc(void 0)});b.useImperativeHandle(r,function(){return{list:Vt.current,focus:function(Pt){var Bn,ii=xi??((Bn=et.find(function(Ju){return!Ju.props.disabled}))===null||Bn===void 0?void 0:Bn.key);if(ii){var mi,Sa,Qa;(mi=Vt.current)===null||mi===void 0||(Sa=mi.querySelector("li[data-menu-id='".concat(kx(vn,ii),"']")))===null||Sa===void 0||(Qa=Sa.focus)===null||Qa===void 0||Qa.call(Sa,Pt)}}}});var Xu=vl(ae||[],{value:ge,postState:function(Pt){return Array.isArray(Pt)?Pt:Pt==null?Cp:[Pt]}}),Xa=Ge(Xu,2),Ho=Xa[0],Vc=Xa[1],ya=function(Pt){if(me){var Bn=Pt.key,ii=Ho.includes(Bn),mi;se?ii?mi=Ho.filter(function(Qa){return Qa!==Bn}):mi=[].concat(at(Ho),[Bn]):mi=[Bn],Vc(mi);var Sa=Oe(Oe({},Pt),{},{selectedKeys:mi});ii?de==null||de(Sa):Se==null||Se(Sa)}!se&&ln.length&&Kn!=="inline"&&Gn(Cp)},Ja=cm(function(tr){Lt==null||Lt(xy(tr)),ya(tr)}),Wo=cm(function(tr,Pt){var Bn=ln.filter(function(mi){return mi!==tr});if(Pt)Bn.push(tr);else if(Kn!=="inline"){var ii=lc(tr);Bn=Bn.filter(function(mi){return!ii.has(mi)})}wS(ln,Bn,!0)||Gn(Bn,!0)}),As=function(Pt,Bn){var ii=Bn??!ln.includes(Pt);Wo(Pt,ii)},dc=Age(Kn,xi,Un,vn,Vt,Oo,Dl,uc,As,jt);b.useEffect(function(){En(!0)},[]);var hc=b.useMemo(function(){return{_internalRenderMenuItem:He,_internalRenderSubMenuItem:dt}},[He,dt]),Bi=Kn!=="horizontal"||F?et:et.map(function(tr,Pt){return b.createElement(eg,{key:tr.key,overflowDisabled:Pt>Ji},tr)}),$c=b.createElement(El,Ze({id:O,ref:Vt,prefixCls:"".concat(f,"-overflow"),component:"ul",itemComponent:jS,className:Xe(f,"".concat(f,"-root"),"".concat(f,"-").concat(Kn),_,(s={},ct(s,"".concat(f,"-inline-collapsed"),er),ct(s,"".concat(f,"-rtl"),Un),s),m),dir:A,style:g,role:"menu",tabIndex:T,data:Bi,renderRawItem:function(Pt){return Pt},renderRawRest:function(Pt){var Bn=Pt.length,ii=Bn?et.slice(-Bn):null;return b.createElement(VS,{eventKey:jA,title:gt,disabled:Ea,internalPopupClose:Bn===0,popupClassName:kt},ii)},maxCount:Kn!=="horizontal"||F?El.INVALIDATE:El.RESPONSIVE,ssr:"full","data-menu-list":!0,onVisibleChange:function(Pt){Ka(Pt)},onKeyDown:dc},rt));return b.createElement(Lx.Provider,{value:hc},b.createElement(G9.Provider,{value:vn},b.createElement(eg,{prefixCls:f,rootClassName:m,mode:Kn,openKeys:ln,rtl:Un,disabled:D,motion:Ht?ve:null,defaultMotions:Ht?ke:null,activeKey:xi,onActive:Is,onInactive:Gr,selectedKeys:Ho,inlineIndent:be,subMenuOpenDelay:V,subMenuCloseDelay:K,forceSubMenuRender:Q,builtinPlacements:Ve,triggerSubMenuAction:$e,getPopupContainer:It,itemIcon:ut,expandIcon:ht,onItemClick:Ja,onOpenChange:Wo},b.createElement(q9.Provider,{value:uo},$c),b.createElement("div",{style:{display:"none"},"aria-hidden":!0},b.createElement(K9.Provider,{value:Ui},et)))))}),tve=["className","title","eventKey","children"],nve=["children"],rve=function(r){var o=r.className,s=r.title;r.eventKey;var c=r.children,d=An(r,tve),f=b.useContext(rc),m=f.prefixCls,g="".concat(m,"-item-group");return b.createElement("li",Ze({role:"presentation"},d,{onClick:function(S){return S.stopPropagation()},className:Xe(g,o)}),b.createElement("div",{role:"presentation",className:"".concat(g,"-title"),title:typeof s=="string"?s:void 0},s),b.createElement("ul",{role:"group",className:"".concat(g,"-list")},c))};function $S(e){var r=e.children,o=An(e,nve),s=Of(o.eventKey),c=Ux(r,s),d=BS();return d?c:b.createElement(rve,ma(o,["warnKey"]),c)}function Bx(e){var r=e.className,o=e.style,s=b.useContext(rc),c=s.prefixCls,d=BS();return d?null:b.createElement("li",{className:Xe("".concat(c,"-item-divider"),r),style:o})}var _g=eve;_g.Item=jS;_g.SubMenu=VS;_g.ItemGroup=$S;_g.Divider=Bx;var nH={};Object.defineProperty(nH,"__esModule",{value:!0});var ive={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"ellipsis",theme:"outlined"},ove=nH.default=ive;function ave(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function sve(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){ave(e,c,o[c])})}return e}function cve(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function lve(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cve(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var uve=function(e,r){return b.createElement(Yi,lve(sve({},e),{ref:r,icon:ove}))};const dve=b.forwardRef(uve),hve=b.createContext({prefixCls:"",firstLevel:!0,inlineCollapsed:!1}),Ny=hve;globalThis&&globalThis.__rest;const pve=b.createContext(null),VB=pve;var fve=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const mve=e=>{const{prefixCls:r,className:o,dashed:s}=e,c=fve(e,["prefixCls","className","dashed"]),{getPrefixCls:d}=b.useContext(or),f=d("menu",r),m=Xe({[`${f}-item-divider-dashed`]:!!s},o);return b.createElement(Bx,Object.assign({className:m},c))},rH=mve;var iH={};Object.defineProperty(iH,"__esModule",{value:!0});var gve={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"bars",theme:"outlined"},vve=iH.default=gve;function Eve(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function _ve(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){Eve(e,c,o[c])})}return e}function yve(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Sve(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yve(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var Cve=function(e,r){return b.createElement(Yi,Sve(_ve({},e),{ref:r,icon:vve}))};const bve=b.forwardRef(Cve);var oH={};Object.defineProperty(oH,"__esModule",{value:!0});var Tve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}}]},name:"left",theme:"outlined"},Rve=oH.default=Tve;function wve(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function Ive(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){wve(e,c,o[c])})}return e}function Ave(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Ove(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ave(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var xve=function(e,r){return b.createElement(Yi,Ove(Ive({},e),{ref:r,icon:Rve}))};const $B=b.forwardRef(xve),Nve=e=>!isNaN(parseFloat(e))&&isFinite(e),Pve=Nve,Dve=e=>{const{componentCls:r,colorBgContainer:o,colorBgBody:s,colorText:c}=e;return{[`${r}-sider-light`]:{background:o,[`${r}-sider-trigger`]:{color:c,background:o},[`${r}-sider-zero-width-trigger`]:{color:c,background:o,border:`1px solid ${s}`,borderInlineStart:0}}}},kve=Dve,Lve=e=>{const{antCls:r,componentCls:o,colorText:s,colorTextLightSolid:c,colorBgHeader:d,colorBgBody:f,colorBgTrigger:m,layoutHeaderHeight:g,layoutHeaderPaddingInline:_,layoutHeaderColor:S,layoutFooterPadding:T,layoutTriggerHeight:R,layoutZeroTriggerSize:N,motionDurationMid:A,motionDurationSlow:O,fontSize:M,borderRadius:x}=e;return{[o]:Object.assign(Object.assign({display:"flex",flex:"auto",flexDirection:"column",minHeight:0,background:f,"&, *":{boxSizing:"border-box"},[`&${o}-has-sider`]:{flexDirection:"row",[`> ${o}, > ${o}-content`]:{width:0}},[`${o}-header, &${o}-footer`]:{flex:"0 0 auto"},[`${o}-sider`]:{position:"relative",minWidth:0,background:d,transition:`all ${A}, background 0s`,"&-children":{height:"100%",marginTop:-.1,paddingTop:.1,[`${r}-menu${r}-menu-inline-collapsed`]:{width:"auto"}},"&-has-trigger":{paddingBottom:R},"&-right":{order:1},"&-trigger":{position:"fixed",bottom:0,zIndex:1,height:R,color:c,lineHeight:`${R}px`,textAlign:"center",background:m,cursor:"pointer",transition:`all ${A}`},"&-zero-width":{"> *":{overflow:"hidden"},"&-trigger":{position:"absolute",top:g,insetInlineEnd:-N,zIndex:1,width:N,height:N,color:c,fontSize:e.fontSizeXL,display:"flex",alignItems:"center",justifyContent:"center",background:d,borderStartStartRadius:0,borderStartEndRadius:x,borderEndEndRadius:x,borderEndStartRadius:0,cursor:"pointer",transition:`background ${O} ease`,"&::after":{position:"absolute",inset:0,background:"transparent",transition:`all ${O}`,content:'""'},"&:hover::after":{background:"rgba(255, 255, 255, 0.2)"},"&-right":{insetInlineStart:-N,borderStartStartRadius:x,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:x}}}}},kve(e)),{"&-rtl":{direction:"rtl"}}),[`${o}-header`]:{height:g,paddingInline:_,color:S,lineHeight:`${g}px`,background:d,[`${r}-menu`]:{lineHeight:"inherit"}},[`${o}-footer`]:{padding:T,color:s,fontSize:M,background:f},[`${o}-content`]:{flex:"auto",minHeight:0}}},aH=ac("Layout",e=>{const{colorText:r,controlHeightSM:o,controlHeight:s,controlHeightLG:c,marginXXS:d}=e,f=c*1.25,m=lo(e,{layoutHeaderHeight:s*2,layoutHeaderPaddingInline:f,layoutHeaderColor:r,layoutFooterPadding:`${o}px ${f}px`,layoutTriggerHeight:c+d*2,layoutZeroTriggerSize:c});return[Lve(m)]},e=>{const{colorBgLayout:r}=e;return{colorBgHeader:"#001529",colorBgBody:r,colorBgTrigger:"#002140"}});var sH=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const cH=b.createContext({siderHook:{addSider:()=>null,removeSider:()=>null}});function HS(e){let{suffixCls:r,tagName:o,displayName:s}=e;return c=>b.forwardRef((f,m)=>b.createElement(c,Object.assign({ref:m,suffixCls:r,tagName:o},f)))}const jx=b.forwardRef((e,r)=>{const{prefixCls:o,suffixCls:s,className:c,tagName:d}=e,f=sH(e,["prefixCls","suffixCls","className","tagName"]),{getPrefixCls:m}=b.useContext(or),g=m("layout",o),[_,S]=aH(g),T=s?`${g}-${s}`:g;return _(b.createElement(d,Object.assign({className:Xe(o||T,c,S),ref:r},f)))}),Mve=b.forwardRef((e,r)=>{const{direction:o}=b.useContext(or),[s,c]=b.useState([]),{prefixCls:d,className:f,rootClassName:m,children:g,hasSider:_,tagName:S}=e,T=sH(e,["prefixCls","className","rootClassName","children","hasSider","tagName"]),R=ma(T,["suffixCls"]),{getPrefixCls:N}=b.useContext(or),A=N("layout",d),[O,M]=aH(A),x=Xe(A,{[`${A}-has-sider`]:typeof _=="boolean"?_:s.length>0,[`${A}-rtl`]:o==="rtl"},f,m,M),P=b.useMemo(()=>({siderHook:{addSider:D=>{c(F=>[].concat(at(F),[D]))},removeSider:D=>{c(F=>F.filter($=>$!==D))}}}),[]);return O(b.createElement(cH.Provider,{value:P},b.createElement(S,Object.assign({ref:r,className:x},R),g)))}),Fve=HS({tagName:"section",displayName:"Layout"})(Mve),Uve=HS({suffixCls:"header",tagName:"header",displayName:"Header"})(jx),Bve=HS({suffixCls:"footer",tagName:"footer",displayName:"Footer"})(jx),jve=HS({suffixCls:"content",tagName:"main",displayName:"Content"})(jx),Vve=Fve;var $ve=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const HB={xs:"479.98px",sm:"575.98px",md:"767.98px",lg:"991.98px",xl:"1199.98px",xxl:"1599.98px"},Vx=b.createContext({}),Hve=(()=>{let e=0;return function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return e+=1,`${r}${e}`}})(),Wve=b.forwardRef((e,r)=>{var{prefixCls:o,className:s,trigger:c,children:d,defaultCollapsed:f=!1,theme:m="dark",style:g={},collapsible:_=!1,reverseArrow:S=!1,width:T=200,collapsedWidth:R=80,zeroWidthTriggerStyle:N,breakpoint:A,onCollapse:O,onBreakpoint:M}=e,x=$ve(e,["prefixCls","className","trigger","children","defaultCollapsed","theme","style","collapsible","reverseArrow","width","collapsedWidth","zeroWidthTriggerStyle","breakpoint","onCollapse","onBreakpoint"]);const{siderHook:P}=b.useContext(cH),[D,F]=b.useState("collapsed"in x?x.collapsed:f),[$,V]=b.useState(!1);b.useEffect(()=>{"collapsed"in x&&F(x.collapsed)},[x.collapsed]);const W=(ie,le)=>{"collapsed"in x||F(ie),O==null||O(ie,le)},K=b.useRef();K.current=ie=>{V(ie.matches),M==null||M(ie.matches),D!==ie.matches&&W(ie.matches,"responsive")},b.useEffect(()=>{function ie(me){return K.current(me)}let le;if(typeof window<"u"){const{matchMedia:me}=window;if(me&&A&&A in HB){le=me(`(max-width: ${HB[A]})`);try{le.addEventListener("change",ie)}catch{le.addListener(ie)}ie(le)}}return()=>{try{le==null||le.removeEventListener("change",ie)}catch{le==null||le.removeListener(ie)}}},[A]),b.useEffect(()=>{const ie=Hve("ant-sider-");return P.addSider(ie),()=>P.removeSider(ie)},[]);const Q=()=>{W(!D,"clickTrigger")},{getPrefixCls:Y}=b.useContext(or),ee=()=>{const ie=Y("layout-sider",o),le=ma(x,["collapsed"]),me=D?R:T,ce=Pve(me)?`${me}px`:String(me),se=parseFloat(String(R||0))===0?b.createElement("span",{onClick:Q,className:Xe(`${ie}-zero-width-trigger`,`${ie}-zero-width-trigger-${S?"right":"left"}`),style:N},c||b.createElement(bve,null)):null,Se={expanded:S?b.createElement(LB,null):b.createElement($B,null),collapsed:S?b.createElement($B,null):b.createElement(LB,null)}[D?"collapsed":"expanded"],de=c!==null?se||b.createElement("div",{className:`${ie}-trigger`,onClick:Q,style:{width:ce}},c||Se):null,he=Object.assign(Object.assign({},g),{flex:`0 0 ${ce}`,maxWidth:ce,minWidth:ce,width:ce}),be=Xe(ie,`${ie}-${m}`,{[`${ie}-collapsed`]:!!D,[`${ie}-has-trigger`]:_&&c!==null&&!se,[`${ie}-below`]:!!$,[`${ie}-zero-width`]:parseFloat(ce)===0},s);return b.createElement("aside",Object.assign({className:be},le,{style:he,ref:r}),b.createElement("div",{className:`${ie}-children`},d),_||$&&se?de:null)},te=b.useMemo(()=>({siderCollapsed:D}),[D]);return b.createElement(Vx.Provider,{value:te},ee())}),Gve=Wve,zve=e=>{var r;const{className:o,children:s,icon:c,title:d,danger:f}=e,{prefixCls:m,firstLevel:g,direction:_,disableMenuItemTitleTooltip:S,inlineCollapsed:T}=b.useContext(Ny),R=P=>{const D=b.createElement("span",{className:`${m}-title-content`},s);return(!c||$u(s)&&s.type==="span")&&s&&P&&g&&typeof s=="string"?b.createElement("div",{className:`${m}-inline-collapsed-noicon`},s.charAt(0)):D},{siderCollapsed:N}=b.useContext(Vx);let A=d;typeof d>"u"?A=g?s:"":d===!1&&(A="");const O={title:A};!N&&!T&&(O.title=null,O.open=!1);const M=Tl(s).length;let x=b.createElement(jS,Object.assign({},ma(e,["title","icon","danger"]),{className:Xe({[`${m}-item-danger`]:f,[`${m}-item-only-child`]:(c?M+1:M)===1},o),title:typeof d=="string"?d:void 0}),nc(c,{className:Xe($u(c)?(r=c.props)===null||r===void 0?void 0:r.className:"",`${m}-item-icon`)}),R(T));return S||(x=b.createElement(Zm,Object.assign({},O,{placement:_==="rtl"?"left":"right",overlayClassName:`${m}-inline-collapsed-tooltip`}),x)),x},lH=zve,Kve=e=>{var r;const{popupClassName:o,icon:s,title:c,theme:d}=e,f=b.useContext(Ny),{prefixCls:m,inlineCollapsed:g,theme:_}=f,S=Of();let T;if(!s)T=g&&!S.length&&c&&typeof c=="string"?b.createElement("div",{className:`${m}-inline-collapsed-noicon`},c.charAt(0)):b.createElement("span",{className:`${m}-title-content`},c);else{const N=$u(c)&&c.type==="span";T=b.createElement(b.Fragment,null,nc(s,{className:Xe($u(s)?(r=s.props)===null||r===void 0?void 0:r.className:"",`${m}-item-icon`)}),N?c:b.createElement("span",{className:`${m}-title-content`},c))}const R=b.useMemo(()=>Object.assign(Object.assign({},f),{firstLevel:!1}),[f]);return b.createElement(Ny.Provider,{value:R},b.createElement(VS,Object.assign({},ma(e,["icon"]),{title:T,popupClassName:Xe(m,o,`${m}-${d||_}`)})))},uH=Kve;var Yve=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function $A(e){return(e||[]).map((r,o)=>{if(r&&typeof r=="object"){const s=r,{label:c,children:d,key:f,type:m}=s,g=Yve(s,["label","children","key","type"]),_=f??`tmp-${o}`;return d||m==="group"?m==="group"?b.createElement($S,Object.assign({key:_},g,{title:c}),$A(d)):b.createElement(uH,Object.assign({key:_},g,{title:c}),$A(d)):m==="divider"?b.createElement(rH,Object.assign({key:_},g)):b.createElement(lH,Object.assign({key:_},g),c)}return null}).filter(r=>r)}function qve(e){return b.useMemo(()=>e&&$A(e),[e])}const Xve=e=>{const{componentCls:r,motionDurationSlow:o,menuHorizontalHeight:s,colorSplit:c,lineWidth:d,lineType:f,menuItemPaddingInline:m}=e;return{[`${r}-horizontal`]:{lineHeight:`${s}px`,border:0,borderBottom:`${d}px ${f} ${c}`,boxShadow:"none","&::after":{display:"block",clear:"both",height:0,content:'"\\20"'},[`${r}-item, ${r}-submenu`]:{position:"relative",display:"inline-block",verticalAlign:"bottom",paddingInline:m},[`> ${r}-item:hover,
        > ${r}-item-active,
        > ${r}-submenu ${r}-submenu-title:hover`]:{backgroundColor:"transparent"},[`${r}-item, ${r}-submenu-title`]:{transition:[`border-color ${o}`,`background ${o}`].join(",")},[`${r}-submenu-arrow`]:{display:"none"}}}},Jve=Xve,Qve=e=>{let{componentCls:r,menuArrowOffset:o}=e;return{[`${r}-rtl`]:{direction:"rtl"},[`${r}-submenu-rtl`]:{transformOrigin:"100% 0"},[`${r}-rtl${r}-vertical,
    ${r}-submenu-rtl ${r}-vertical`]:{[`${r}-submenu-arrow`]:{"&::before":{transform:`rotate(-45deg) translateY(-${o})`},"&::after":{transform:`rotate(45deg) translateY(${o})`}}}}},Zve=Qve,WB=e=>Object.assign({},q$(e)),eEe=(e,r)=>{const{componentCls:o,itemColor:s,itemSelectedColor:c,groupTitleColor:d,itemBg:f,subMenuItemBg:m,itemSelectedBg:g,activeBarHeight:_,activeBarWidth:S,activeBarBorderWidth:T,motionDurationSlow:R,motionEaseInOut:N,motionEaseOut:A,menuItemPaddingInline:O,motionDurationMid:M,itemHoverColor:x,lineType:P,colorSplit:D,itemDisabledColor:F,dangerItemColor:$,dangerItemHoverColor:V,dangerItemSelectedColor:W,dangerItemActiveBg:K,dangerItemSelectedBg:Q,itemHoverBg:Y,menuSubMenuBg:ee,horizontalItemSelectedColor:te,horizontalItemSelectedBg:ie,horizontalItemBorderRadius:le,horizontalItemHoverBg:me}=e;return{[`${o}-${r}, ${o}-${r} > ${o}`]:{color:s,background:f,[`&${o}-root:focus-visible`]:Object.assign({},WB(e)),[`${o}-item-group-title`]:{color:d},[`${o}-submenu-selected`]:{[`> ${o}-submenu-title`]:{color:c}},[`${o}-item-disabled, ${o}-submenu-disabled`]:{color:`${F} !important`},[`${o}-item:hover, ${o}-submenu-title:hover`]:{[`&:not(${o}-item-selected):not(${o}-submenu-selected)`]:{color:x}},[`&:not(${o}-horizontal)`]:{[`${o}-item:not(${o}-item-selected)`]:{"&:hover":{backgroundColor:Y},"&:active":{backgroundColor:g}},[`${o}-submenu-title`]:{"&:hover":{backgroundColor:Y},"&:active":{backgroundColor:g}}},[`${o}-item-danger`]:{color:$,[`&${o}-item:hover`]:{[`&:not(${o}-item-selected):not(${o}-submenu-selected)`]:{color:V}},[`&${o}-item:active`]:{background:K}},[`${o}-item a`]:{"&, &:hover":{color:"inherit"}},[`${o}-item-selected`]:{color:c,[`&${o}-item-danger`]:{color:W},"a, a:hover":{color:"inherit"}},[`& ${o}-item-selected`]:{backgroundColor:g,[`&${o}-item-danger`]:{backgroundColor:Q}},[`${o}-item, ${o}-submenu-title`]:{[`&:not(${o}-item-disabled):focus-visible`]:Object.assign({},WB(e))},[`&${o}-submenu > ${o}`]:{backgroundColor:ee},[`&${o}-popup > ${o}`]:{backgroundColor:f},[`&${o}-horizontal`]:Object.assign(Object.assign({},r==="dark"?{borderBottom:0}:{}),{[`> ${o}-item, > ${o}-submenu`]:{top:T,marginTop:-T,marginBottom:0,borderRadius:le,"&::after":{position:"absolute",insetInline:O,bottom:0,borderBottom:`${_}px solid transparent`,transition:`border-color ${R} ${N}`,content:'""'},"&:hover, &-active, &-open":{background:me,"&::after":{borderBottomWidth:_,borderBottomColor:te}},"&-selected":{color:te,backgroundColor:ie,"&::after":{borderBottomWidth:_,borderBottomColor:te}}}}),[`&${o}-root`]:{[`&${o}-inline, &${o}-vertical`]:{borderInlineEnd:`${T}px ${P} ${D}`}},[`&${o}-inline`]:{[`${o}-sub${o}-inline`]:{background:m},[`${o}-item, ${o}-submenu-title`]:T&&S?{width:`calc(100% + ${T}px)`}:{},[`${o}-item`]:{position:"relative","&::after":{position:"absolute",insetBlock:0,insetInlineEnd:0,borderInlineEnd:`${S}px solid ${c}`,transform:"scaleY(0.0001)",opacity:0,transition:[`transform ${M} ${A}`,`opacity ${M} ${A}`].join(","),content:'""'},[`&${o}-item-danger`]:{"&::after":{borderInlineEndColor:W}}},[`${o}-selected, ${o}-item-selected`]:{"&::after":{transform:"scaleY(1)",opacity:1,transition:[`transform ${M} ${N}`,`opacity ${M} ${N}`].join(",")}}}}}},GB=eEe,zB=e=>{const{componentCls:r,menuItemHeight:o,itemMarginInline:s,padding:c,menuArrowSize:d,marginXS:f,marginXXS:m}=e,g=c+d+f;return{[`${r}-item`]:{position:"relative",overflow:"hidden"},[`${r}-item, ${r}-submenu-title`]:{height:o,lineHeight:`${o}px`,paddingInline:c,overflow:"hidden",textOverflow:"ellipsis",marginInline:s,marginBlock:m,width:`calc(100% - ${s*2}px)`},[`> ${r}-item,
            > ${r}-submenu > ${r}-submenu-title`]:{height:o,lineHeight:`${o}px`},[`${r}-item-group-list ${r}-submenu-title,
            ${r}-submenu-title`]:{paddingInlineEnd:g}}},tEe=e=>{const{componentCls:r,iconCls:o,menuItemHeight:s,colorTextLightSolid:c,dropdownWidth:d,controlHeightLG:f,motionDurationMid:m,motionEaseOut:g,paddingXL:_,itemMarginInline:S,fontSizeLG:T,motionDurationSlow:R,paddingXS:N,boxShadowSecondary:A}=e,O={height:s,lineHeight:`${s}px`,listStylePosition:"inside",listStyleType:"disc"};return[{[r]:{"&-inline, &-vertical":Object.assign({[`&${r}-root`]:{boxShadow:"none"}},zB(e))},[`${r}-submenu-popup`]:{[`${r}-vertical`]:Object.assign(Object.assign({},zB(e)),{boxShadow:A})}},{[`${r}-submenu-popup ${r}-vertical${r}-sub`]:{minWidth:d,maxHeight:`calc(100vh - ${f*2.5}px)`,padding:"0",overflow:"hidden",borderInlineEnd:0,"&:not([class*='-active'])":{overflowX:"hidden",overflowY:"auto"}}},{[`${r}-inline`]:{width:"100%",[`&${r}-root`]:{[`${r}-item, ${r}-submenu-title`]:{display:"flex",alignItems:"center",transition:[`border-color ${R}`,`background ${R}`,`padding ${m} ${g}`].join(","),[`> ${r}-title-content`]:{flex:"auto",minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},"> *":{flex:"none"}}},[`${r}-sub${r}-inline`]:{padding:0,border:0,borderRadius:0,boxShadow:"none",[`& > ${r}-submenu > ${r}-submenu-title`]:O,[`& ${r}-item-group-title`]:{paddingInlineStart:_}},[`${r}-item`]:O}},{[`${r}-inline-collapsed`]:{width:s*2,[`&${r}-root`]:{[`${r}-item, ${r}-submenu ${r}-submenu-title`]:{[`> ${r}-inline-collapsed-noicon`]:{fontSize:T,textAlign:"center"}}},[`> ${r}-item,
          > ${r}-item-group > ${r}-item-group-list > ${r}-item,
          > ${r}-item-group > ${r}-item-group-list > ${r}-submenu > ${r}-submenu-title,
          > ${r}-submenu > ${r}-submenu-title`]:{insetInlineStart:0,paddingInline:`calc(50% - ${T/2}px - ${S}px)`,textOverflow:"clip",[`
            ${r}-submenu-arrow,
            ${r}-submenu-expand-icon
          `]:{opacity:0},[`${r}-item-icon, ${o}`]:{margin:0,fontSize:T,lineHeight:`${s}px`,"+ span":{display:"inline-block",opacity:0}}},[`${r}-item-icon, ${o}`]:{display:"inline-block"},"&-tooltip":{pointerEvents:"none",[`${r}-item-icon, ${o}`]:{display:"none"},"a, a:hover":{color:c}},[`${r}-item-group-title`]:Object.assign(Object.assign({},Ule),{paddingInline:N})}}]},nEe=tEe,KB=e=>{const{componentCls:r,fontSize:o,motionDurationSlow:s,motionDurationMid:c,motionEaseInOut:d,motionEaseOut:f,iconCls:m,controlHeightSM:g}=e;return{[`${r}-item, ${r}-submenu-title`]:{position:"relative",display:"block",margin:0,whiteSpace:"nowrap",cursor:"pointer",transition:[`border-color ${s}`,`background ${s}`,`padding ${s} ${d}`].join(","),[`${r}-item-icon, ${m}`]:{minWidth:o,fontSize:o,transition:[`font-size ${c} ${f}`,`margin ${s} ${d}`,`color ${s}`].join(","),"+ span":{marginInlineStart:g-o,opacity:1,transition:[`opacity ${s} ${d}`,`margin ${s}`,`color ${s}`].join(",")}},[`${r}-item-icon`]:Object.assign({},Y$()),[`&${r}-item-only-child`]:{[`> ${m}, > ${r}-item-icon`]:{marginInlineEnd:0}}},[`${r}-item-disabled, ${r}-submenu-disabled`]:{background:"none !important",cursor:"not-allowed","&::after":{borderColor:"transparent !important"},a:{color:"inherit !important"},[`> ${r}-submenu-title`]:{color:"inherit !important",cursor:"not-allowed"}}}},YB=e=>{const{componentCls:r,motionDurationSlow:o,motionEaseInOut:s,borderRadius:c,menuArrowSize:d,menuArrowOffset:f}=e;return{[`${r}-submenu`]:{"&-expand-icon, &-arrow":{position:"absolute",top:"50%",insetInlineEnd:e.margin,width:d,color:"currentcolor",transform:"translateY(-50%)",transition:`transform ${o} ${s}, opacity ${o}`},"&-arrow":{"&::before, &::after":{position:"absolute",width:d*.6,height:d*.15,backgroundColor:"currentcolor",borderRadius:c,transition:[`background ${o} ${s}`,`transform ${o} ${s}`,`top ${o} ${s}`,`color ${o} ${s}`].join(","),content:'""'},"&::before":{transform:`rotate(45deg) translateY(-${f})`},"&::after":{transform:`rotate(-45deg) translateY(${f})`}}}}},rEe=e=>{const{antCls:r,componentCls:o,fontSize:s,motionDurationSlow:c,motionDurationMid:d,motionEaseInOut:f,lineHeight:m,paddingXS:g,padding:_,colorSplit:S,lineWidth:T,zIndexPopup:R,borderRadiusLG:N,subMenuItemBorderRadius:A,menuArrowSize:O,menuArrowOffset:M,lineType:x,menuPanelMaskInset:P}=e;return[{"":{[`${o}`]:Object.assign(Object.assign({},sA()),{"&-hidden":{display:"none"}})},[`${o}-submenu-hidden`]:{display:"none"}},{[o]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},sh(e)),sA()),{marginBottom:0,paddingInlineStart:0,fontSize:s,lineHeight:0,listStyle:"none",outline:"none",transition:`width ${c} cubic-bezier(0.2, 0, 0, 1) 0s`,"ul, ol":{margin:0,padding:0,listStyle:"none"},"&-overflow":{display:"flex",[`${o}-item`]:{flex:"none"}},[`${o}-item, ${o}-submenu, ${o}-submenu-title`]:{borderRadius:e.itemBorderRadius},[`${o}-item-group-title`]:{padding:`${g}px ${_}px`,fontSize:s,lineHeight:m,transition:`all ${c}`},[`&-horizontal ${o}-submenu`]:{transition:[`border-color ${c} ${f}`,`background ${c} ${f}`].join(",")},[`${o}-submenu, ${o}-submenu-inline`]:{transition:[`border-color ${c} ${f}`,`background ${c} ${f}`,`padding ${d} ${f}`].join(",")},[`${o}-submenu ${o}-sub`]:{cursor:"initial",transition:[`background ${c} ${f}`,`padding ${c} ${f}`].join(",")},[`${o}-title-content`]:{transition:`color ${c}`},[`${o}-item a`]:{"&::before":{position:"absolute",inset:0,backgroundColor:"transparent",content:'""'}},[`${o}-item-divider`]:{overflow:"hidden",lineHeight:0,borderColor:S,borderStyle:x,borderWidth:0,borderTopWidth:T,marginBlock:T,padding:0,"&-dashed":{borderStyle:"dashed"}}}),KB(e)),{[`${o}-item-group`]:{[`${o}-item-group-list`]:{margin:0,padding:0,[`${o}-item, ${o}-submenu-title`]:{paddingInline:`${s*2}px ${_}px`}}},"&-submenu":{"&-popup":{position:"absolute",zIndex:R,borderRadius:N,boxShadow:"none",transformOrigin:"0 0",[`&${o}-submenu`]:{background:"transparent"},"&::before":{position:"absolute",inset:`${P}px 0 0`,zIndex:-1,width:"100%",height:"100%",opacity:0,content:'""'}},"&-placement-rightTop::before":{top:0,insetInlineStart:P},"\n          &-placement-leftTop,\n          &-placement-bottomRight,\n          ":{transformOrigin:"100% 0"},"\n          &-placement-leftBottom,\n          &-placement-topRight,\n          ":{transformOrigin:"100% 100%"},"\n          &-placement-rightBottom,\n          &-placement-topLeft,\n          ":{transformOrigin:"0 100%"},"\n          &-placement-bottomLeft,\n          &-placement-rightTop,\n          ":{transformOrigin:"0 0"},"\n          &-placement-leftTop,\n          &-placement-leftBottom\n          ":{paddingInlineEnd:e.paddingXS},"\n          &-placement-rightTop,\n          &-placement-rightBottom\n          ":{paddingInlineStart:e.paddingXS},"\n          &-placement-topRight,\n          &-placement-topLeft\n          ":{paddingBottom:e.paddingXS},"\n          &-placement-bottomRight,\n          &-placement-bottomLeft\n          ":{paddingTop:e.paddingXS},[`> ${o}`]:Object.assign(Object.assign(Object.assign({borderRadius:N},KB(e)),YB(e)),{[`${o}-item, ${o}-submenu > ${o}-submenu-title`]:{borderRadius:A},[`${o}-submenu-title::after`]:{transition:`transform ${c} ${f}`}})}}),YB(e)),{[`&-inline-collapsed ${o}-submenu-arrow,
        &-inline ${o}-submenu-arrow`]:{"&::before":{transform:`rotate(-45deg) translateX(${M})`},"&::after":{transform:`rotate(45deg) translateX(-${M})`}},[`${o}-submenu-open${o}-submenu-inline > ${o}-submenu-title > ${o}-submenu-arrow`]:{transform:`translateY(-${O*.2}px)`,"&::after":{transform:`rotate(-45deg) translateX(-${M})`},"&::before":{transform:`rotate(45deg) translateX(${M})`}}})},{[`${r}-layout-header`]:{[o]:{lineHeight:"inherit"}}}]},iEe=(e,r)=>ac("Menu",(s,c)=>{let{overrideComponentToken:d}=c;if(r===!1)return[];const{colorBgElevated:f,colorPrimary:m,colorError:g,colorErrorHover:_,colorTextLightSolid:S,controlHeightLG:T,fontSize:R}=s,N=R/7*5,A=lo(s,{menuItemHeight:T,menuItemPaddingInline:s.margin,menuArrowSize:N,menuHorizontalHeight:T*1.15,menuArrowOffset:`${N*.25}px`,menuPanelMaskInset:-7,menuSubMenuBg:f}),O=new io(S).setAlpha(.65).toRgbString(),M=lo(A,{itemColor:O,itemHoverColor:S,groupTitleColor:O,itemSelectedColor:S,itemBg:"#001529",subMenuItemBg:"#000c17",itemActiveBg:"transparent",itemSelectedBg:m,activeBarWidth:0,activeBarHeight:0,activeBarBorderWidth:0,itemDisabledColor:new io(S).setAlpha(.25).toRgbString(),dangerItemColor:g,dangerItemHoverColor:_,dangerItemSelectedColor:S,dangerItemActiveBg:g,dangerItemSelectedBg:g,menuSubMenuBg:"#001529",horizontalItemSelectedColor:S,horizontalItemSelectedBg:m},Object.assign({},d));return[rEe(A),Jve(A),nEe(A),GB(A,"light"),GB(M,"dark"),Zve(A),R9(A),bB(A,"slide-up"),bB(A,"slide-down"),T9(A,"zoom-big")]},s=>{const{colorPrimary:c,colorError:d,colorTextDisabled:f,colorErrorBg:m,colorText:g,colorTextDescription:_,colorBgContainer:S,colorFillAlter:T,colorFillContent:R,lineWidth:N,lineWidthBold:A,controlItemBgActive:O,colorBgTextHover:M}=s;return{dropdownWidth:160,zIndexPopup:s.zIndexPopupBase+50,radiusItem:s.borderRadiusLG,itemBorderRadius:s.borderRadiusLG,radiusSubMenuItem:s.borderRadiusSM,subMenuItemBorderRadius:s.borderRadiusSM,colorItemText:g,itemColor:g,colorItemTextHover:g,itemHoverColor:g,colorItemTextHoverHorizontal:c,horizontalItemHoverColor:c,colorGroupTitle:_,groupTitleColor:_,colorItemTextSelected:c,itemSelectedColor:c,colorItemTextSelectedHorizontal:c,horizontalItemSelectedColor:c,colorItemBg:S,itemBg:S,colorItemBgHover:M,itemHoverBg:M,colorItemBgActive:R,itemActiveBg:R,colorSubItemBg:T,subMenuItemBg:T,colorItemBgSelected:O,itemSelectedBg:O,colorItemBgSelectedHorizontal:"transparent",horizontalItemSelectedBg:"transparent",colorActiveBarWidth:0,activeBarWidth:0,colorActiveBarHeight:A,activeBarHeight:A,colorActiveBarBorderSize:N,activeBarBorderWidth:N,colorItemTextDisabled:f,itemDisabledColor:f,colorDangerItemText:d,dangerItemColor:d,colorDangerItemTextHover:d,dangerItemHoverColor:d,colorDangerItemTextSelected:d,dangerItemSelectedColor:d,colorDangerItemBgActive:m,dangerItemActiveBg:m,colorDangerItemBgSelected:m,dangerItemSelectedBg:m,itemMarginInline:s.marginXXS,horizontalItemBorderRadius:0,horizontalItemHoverBg:"transparent"}},{deprecatedTokens:[["colorGroupTitle","groupTitleColor"],["radiusItem","itemBorderRadius"],["radiusSubMenuItem","subMenuItemBorderRadius"],["colorItemText","itemColor"],["colorItemTextHover","itemHoverColor"],["colorItemTextHoverHorizontal","horizontalItemHoverColor"],["colorItemTextSelected","itemSelectedColor"],["colorItemTextSelectedHorizontal","horizontalItemSelectedColor"],["colorItemTextDisabled","itemDisabledColor"],["colorDangerItemText","dangerItemColor"],["colorDangerItemTextHover","dangerItemHoverColor"],["colorDangerItemTextSelected","dangerItemSelectedColor"],["colorDangerItemBgActive","dangerItemActiveBg"],["colorDangerItemBgSelected","dangerItemSelectedBg"],["colorItemBg","itemBg"],["colorItemBgHover","itemHoverBg"],["colorSubItemBg","subMenuItemBg"],["colorItemBgActive","itemActiveBg"],["colorItemBgSelectedHorizontal","horizontalItemSelectedBg"],["colorActiveBarWidth","activeBarWidth"],["colorActiveBarHeight","activeBarHeight"],["colorActiveBarBorderSize","activeBarBorderWidth"]]})(e);var oEe=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const aEe=b.forwardRef((e,r)=>{var o,s;const c=b.useContext(VB),d=c||{},{getPrefixCls:f,getPopupContainer:m,direction:g}=b.useContext(or),_=f(),{prefixCls:S,className:T,theme:R="light",expandIcon:N,_internalDisableMenuItemTitleTooltip:A,inlineCollapsed:O,siderCollapsed:M,items:x,children:P,rootClassName:D,mode:F,selectable:$,onClick:V,overflowedIndicatorPopupClassName:W}=e,K=oEe(e,["prefixCls","className","theme","expandIcon","_internalDisableMenuItemTitleTooltip","inlineCollapsed","siderCollapsed","items","children","rootClassName","mode","selectable","onClick","overflowedIndicatorPopupClassName"]),Q=ma(K,["collapsedWidth"]),Y=qve(x)||P;(o=d.validator)===null||o===void 0||o.call(d,{mode:F});const ee=qs(function(){var he;V==null||V.apply(void 0,arguments),(he=d.onClick)===null||he===void 0||he.call(d)}),te=d.mode||F,ie=$??d.selectable,le=b.useMemo(()=>M!==void 0?M:O,[O,M]),me={horizontal:{motionName:`${_}-slide-up`},inline:bA(_),other:{motionName:`${_}-zoom-big`}},ce=f("menu",S||d.prefixCls),[se,ae]=iEe(ce,!c),ge=Xe(`${ce}-${R}`,T);let Se;if(typeof N=="function")Se=N;else{const he=N||d.expandIcon;Se=nc(he,{className:Xe(`${ce}-submenu-expand-icon`,(s=he==null?void 0:he.props)===null||s===void 0?void 0:s.className)})}const de=b.useMemo(()=>({prefixCls:ce,inlineCollapsed:le||!1,direction:g,firstLevel:!0,theme:R,mode:te,disableMenuItemTitleTooltip:A}),[ce,le,g,A,R]);return se(b.createElement(VB.Provider,{value:null},b.createElement(Ny.Provider,{value:de},b.createElement(_g,Object.assign({getPopupContainer:m,overflowedIndicator:b.createElement(dve,null),overflowedIndicatorPopupClassName:Xe(ce,`${ce}-${R}`,W),mode:te,selectable:ie,onClick:ee},Q,{inlineCollapsed:le,className:ge,prefixCls:ce,direction:g,defaultMotions:me,expandIcon:Se,ref:r,rootClassName:Xe(D,ae)}),Y))))}),sEe=aEe,yg=b.forwardRef((e,r)=>{const o=b.useRef(null),s=b.useContext(Vx);return b.useImperativeHandle(r,()=>({menu:o.current,focus:c=>{var d;(d=o.current)===null||d===void 0||d.focus(c)}})),b.createElement(sEe,Object.assign({ref:o},e,s))});yg.Item=lH;yg.SubMenu=uH;yg.Divider=rH;yg.ItemGroup=$S;const cEe=yg,lEe=e=>({"&::-moz-placeholder":{opacity:1},"&::placeholder":{color:e,userSelect:"none"},"&:placeholder-shown":{textOverflow:"ellipsis"}}),$x=e=>({borderColor:e.inputBorderHoverColor,borderInlineEndWidth:e.lineWidth}),HA=e=>({borderColor:e.inputBorderHoverColor,boxShadow:`0 0 0 ${e.controlOutlineWidth}px ${e.controlOutline}`,borderInlineEndWidth:e.lineWidth,outline:0}),dH=e=>({color:e.colorTextDisabled,backgroundColor:e.colorBgContainerDisabled,borderColor:e.colorBorder,boxShadow:"none",cursor:"not-allowed",opacity:1,"&:hover":Object.assign({},$x(lo(e,{inputBorderHoverColor:e.colorBorder})))}),hH=e=>{const{inputPaddingVerticalLG:r,fontSizeLG:o,lineHeightLG:s,borderRadiusLG:c,inputPaddingHorizontalLG:d}=e;return{padding:`${r}px ${d}px`,fontSize:o,lineHeight:s,borderRadius:c}},pH=e=>({padding:`${e.inputPaddingVerticalSM}px ${e.controlPaddingHorizontalSM-1}px`,borderRadius:e.borderRadiusSM}),fH=(e,r)=>{const{componentCls:o,colorError:s,colorWarning:c,colorErrorOutline:d,colorWarningOutline:f,colorErrorBorderHover:m,colorWarningBorderHover:g}=e;return{[`&-status-error:not(${r}-disabled):not(${r}-borderless)${r}`]:{borderColor:s,"&:hover":{borderColor:m},"&:focus, &-focused":Object.assign({},HA(lo(e,{inputBorderActiveColor:s,inputBorderHoverColor:s,controlOutline:d}))),[`${o}-prefix, ${o}-suffix`]:{color:s}},[`&-status-warning:not(${r}-disabled):not(${r}-borderless)${r}`]:{borderColor:c,"&:hover":{borderColor:g},"&:focus, &-focused":Object.assign({},HA(lo(e,{inputBorderActiveColor:c,inputBorderHoverColor:c,controlOutline:f}))),[`${o}-prefix, ${o}-suffix`]:{color:c}}}},mH=e=>Object.assign(Object.assign({position:"relative",display:"inline-block",width:"100%",minWidth:0,padding:`${e.inputPaddingVertical}px ${e.inputPaddingHorizontal}px`,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight,backgroundColor:e.colorBgContainer,backgroundImage:"none",borderWidth:e.lineWidth,borderStyle:e.lineType,borderColor:e.colorBorder,borderRadius:e.borderRadius,transition:`all ${e.motionDurationMid}`},lEe(e.colorTextPlaceholder)),{"&:hover":Object.assign({},$x(e)),"&:focus, &-focused":Object.assign({},HA(e)),"&-disabled, &[disabled]":Object.assign({},dH(e)),"&-borderless":{"&, &:hover, &:focus, &-focused, &-disabled, &[disabled]":{backgroundColor:"transparent",border:"none",boxShadow:"none"}},"textarea&":{maxWidth:"100%",height:"auto",minHeight:e.controlHeight,lineHeight:e.lineHeight,verticalAlign:"bottom",transition:`all ${e.motionDurationSlow}, height 0s`,resize:"vertical"},"&-lg":Object.assign({},hH(e)),"&-sm":Object.assign({},pH(e)),"&-rtl":{direction:"rtl"},"&-textarea-rtl":{direction:"rtl"}}),uEe=e=>{const{componentCls:r,antCls:o}=e;return{position:"relative",display:"table",width:"100%",borderCollapse:"separate",borderSpacing:0,"&[class*='col-']":{paddingInlineEnd:e.paddingXS,"&:last-child":{paddingInlineEnd:0}},[`&-lg ${r}, &-lg > ${r}-group-addon`]:Object.assign({},hH(e)),[`&-sm ${r}, &-sm > ${r}-group-addon`]:Object.assign({},pH(e)),[`&-lg ${o}-select-single ${o}-select-selector`]:{height:e.controlHeightLG},[`&-sm ${o}-select-single ${o}-select-selector`]:{height:e.controlHeightSM},[`> ${r}`]:{display:"table-cell","&:not(:first-child):not(:last-child)":{borderRadius:0}},[`${r}-group`]:{"&-addon, &-wrap":{display:"table-cell",width:1,whiteSpace:"nowrap",verticalAlign:"middle","&:not(:first-child):not(:last-child)":{borderRadius:0}},"&-wrap > *":{display:"block !important"},"&-addon":{position:"relative",padding:`0 ${e.inputPaddingHorizontal}px`,color:e.colorText,fontWeight:"normal",fontSize:e.fontSize,textAlign:"center",backgroundColor:e.colorFillAlter,border:`${e.lineWidth}px ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadius,transition:`all ${e.motionDurationSlow}`,lineHeight:1,[`${o}-select`]:{margin:`-${e.inputPaddingVertical+1}px -${e.inputPaddingHorizontal}px`,[`&${o}-select-single:not(${o}-select-customize-input)`]:{[`${o}-select-selector`]:{backgroundColor:"inherit",border:`${e.lineWidth}px ${e.lineType} transparent`,boxShadow:"none"}},"&-open, &-focused":{[`${o}-select-selector`]:{color:e.colorPrimary}}},[`${o}-cascader-picker`]:{margin:`-9px -${e.inputPaddingHorizontal}px`,backgroundColor:"transparent",[`${o}-cascader-input`]:{textAlign:"start",border:0,boxShadow:"none"}}},"&-addon:first-child":{borderInlineEnd:0},"&-addon:last-child":{borderInlineStart:0}},[`${r}`]:{width:"100%",marginBottom:0,textAlign:"inherit","&:focus":{zIndex:1,borderInlineEndWidth:1},"&:hover":{zIndex:1,borderInlineEndWidth:1,[`${r}-search-with-button &`]:{zIndex:0}}},[`> ${r}:first-child, ${r}-group-addon:first-child`]:{borderStartEndRadius:0,borderEndEndRadius:0,[`${o}-select ${o}-select-selector`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${r}-affix-wrapper`]:{[`&:not(:first-child) ${r}`]:{borderStartStartRadius:0,borderEndStartRadius:0},[`&:not(:last-child) ${r}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${r}:last-child, ${r}-group-addon:last-child`]:{borderStartStartRadius:0,borderEndStartRadius:0,[`${o}-select ${o}-select-selector`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`${r}-affix-wrapper`]:{"&:not(:last-child)":{borderStartEndRadius:0,borderEndEndRadius:0,[`${r}-search &`]:{borderStartStartRadius:e.borderRadius,borderEndStartRadius:e.borderRadius}},[`&:not(:first-child), ${r}-search &:not(:first-child)`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&${r}-group-compact`]:Object.assign(Object.assign({display:"block"},sA()),{[`${r}-group-addon, ${r}-group-wrap, > ${r}`]:{"&:not(:first-child):not(:last-child)":{borderInlineEndWidth:e.lineWidth,"&:hover":{zIndex:1},"&:focus":{zIndex:1}}},"& > *":{display:"inline-block",float:"none",verticalAlign:"top",borderRadius:0},[`
        & > ${r}-affix-wrapper,
        & > ${r}-number-affix-wrapper,
        & > ${o}-picker-range
      `]:{display:"inline-flex"},"& > *:not(:last-child)":{marginInlineEnd:-e.lineWidth,borderInlineEndWidth:e.lineWidth},[`${r}`]:{float:"none"},[`& > ${o}-select > ${o}-select-selector,
      & > ${o}-select-auto-complete ${r},
      & > ${o}-cascader-picker ${r},
      & > ${r}-group-wrapper ${r}`]:{borderInlineEndWidth:e.lineWidth,borderRadius:0,"&:hover":{zIndex:1},"&:focus":{zIndex:1}},[`& > ${o}-select-focused`]:{zIndex:1},[`& > ${o}-select > ${o}-select-arrow`]:{zIndex:1},[`& > *:first-child,
      & > ${o}-select:first-child > ${o}-select-selector,
      & > ${o}-select-auto-complete:first-child ${r},
      & > ${o}-cascader-picker:first-child ${r}`]:{borderStartStartRadius:e.borderRadius,borderEndStartRadius:e.borderRadius},[`& > *:last-child,
      & > ${o}-select:last-child > ${o}-select-selector,
      & > ${o}-cascader-picker:last-child ${r},
      & > ${o}-cascader-picker-focused:last-child ${r}`]:{borderInlineEndWidth:e.lineWidth,borderStartEndRadius:e.borderRadius,borderEndEndRadius:e.borderRadius},[`& > ${o}-select-auto-complete ${r}`]:{verticalAlign:"top"},[`${r}-group-wrapper + ${r}-group-wrapper`]:{marginInlineStart:-e.lineWidth,[`${r}-affix-wrapper`]:{borderRadius:0}},[`${r}-group-wrapper:not(:last-child)`]:{[`&${r}-search > ${r}-group`]:{[`& > ${r}-group-addon > ${r}-search-button`]:{borderRadius:0},[`& > ${r}`]:{borderStartStartRadius:e.borderRadius,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:e.borderRadius}}}})}},dEe=e=>{const{componentCls:r,controlHeightSM:o,lineWidth:s}=e,c=16,d=(o-s*2-c)/2;return{[r]:Object.assign(Object.assign(Object.assign(Object.assign({},sh(e)),mH(e)),fH(e,r)),{'&[type="color"]':{height:e.controlHeight,[`&${r}-lg`]:{height:e.controlHeightLG},[`&${r}-sm`]:{height:o,paddingTop:d,paddingBottom:d}},'&[type="search"]::-webkit-search-cancel-button, &[type="search"]::-webkit-search-decoration':{"-webkit-appearance":"none"}})}},hEe=e=>{const{componentCls:r}=e;return{[`${r}-clear-icon`]:{margin:0,color:e.colorTextQuaternary,fontSize:e.fontSizeIcon,verticalAlign:-1,cursor:"pointer",transition:`color ${e.motionDurationSlow}`,"&:hover":{color:e.colorTextTertiary},"&:active":{color:e.colorText},"&-hidden":{visibility:"hidden"},"&-has-suffix":{margin:`0 ${e.inputAffixPadding}px`}}}},pEe=e=>{const{componentCls:r,inputAffixPadding:o,colorTextDescription:s,motionDurationSlow:c,colorIcon:d,colorIconHover:f,iconCls:m}=e;return{[`${r}-affix-wrapper`]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},mH(e)),{display:"inline-flex",[`&:not(${r}-affix-wrapper-disabled):hover`]:Object.assign(Object.assign({},$x(e)),{zIndex:1,[`${r}-search-with-button &`]:{zIndex:0}}),"&-focused, &:focus":{zIndex:1},"&-disabled":{[`${r}[disabled]`]:{background:"transparent"}},[`> input${r}`]:{padding:0,fontSize:"inherit",border:"none",borderRadius:0,outline:"none","&::-ms-reveal":{display:"none"},"&:focus":{boxShadow:"none !important"}},"&::before":{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'},[`${r}`]:{"&-prefix, &-suffix":{display:"flex",flex:"none",alignItems:"center","> *:not(:last-child)":{marginInlineEnd:e.paddingXS}},"&-show-count-suffix":{color:s},"&-show-count-has-suffix":{marginInlineEnd:e.paddingXXS},"&-prefix":{marginInlineEnd:o},"&-suffix":{marginInlineStart:o}}}),hEe(e)),{[`${m}${r}-password-icon`]:{color:d,cursor:"pointer",transition:`all ${c}`,"&:hover":{color:f}}}),fH(e,`${r}-affix-wrapper`))}},fEe=e=>{const{componentCls:r,colorError:o,colorWarning:s,borderRadiusLG:c,borderRadiusSM:d}=e;return{[`${r}-group`]:Object.assign(Object.assign(Object.assign({},sh(e)),uEe(e)),{"&-rtl":{direction:"rtl"},"&-wrapper":{display:"inline-block",width:"100%",textAlign:"start",verticalAlign:"top","&-rtl":{direction:"rtl"},"&-lg":{[`${r}-group-addon`]:{borderRadius:c}},"&-sm":{[`${r}-group-addon`]:{borderRadius:d}},"&-status-error":{[`${r}-group-addon`]:{color:o,borderColor:o}},"&-status-warning":{[`${r}-group-addon`]:{color:s,borderColor:s}},"&-disabled":{[`${r}-group-addon`]:Object.assign({},dH(e))},[`&:not(${r}-compact-first-item):not(${r}-compact-last-item)${r}-compact-item`]:{[`${r}, ${r}-group-addon`]:{borderRadius:0}},[`&:not(${r}-compact-last-item)${r}-compact-first-item`]:{[`${r}, ${r}-group-addon`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&:not(${r}-compact-first-item)${r}-compact-last-item`]:{[`${r}, ${r}-group-addon`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}})}},mEe=e=>{const{componentCls:r,antCls:o}=e,s=`${r}-search`;return{[s]:{[`${r}`]:{"&:hover, &:focus":{borderColor:e.colorPrimaryHover,[`+ ${r}-group-addon ${s}-button:not(${o}-btn-primary)`]:{borderInlineStartColor:e.colorPrimaryHover}}},[`${r}-affix-wrapper`]:{borderRadius:0},[`${r}-lg`]:{lineHeight:e.lineHeightLG-2e-4},[`> ${r}-group`]:{[`> ${r}-group-addon:last-child`]:{insetInlineStart:-1,padding:0,border:0,[`${s}-button`]:{paddingTop:0,paddingBottom:0,borderStartStartRadius:0,borderStartEndRadius:e.borderRadius,borderEndEndRadius:e.borderRadius,borderEndStartRadius:0},[`${s}-button:not(${o}-btn-primary)`]:{color:e.colorTextDescription,"&:hover":{color:e.colorPrimaryHover},"&:active":{color:e.colorPrimaryActive},[`&${o}-btn-loading::before`]:{insetInlineStart:0,insetInlineEnd:0,insetBlockStart:0,insetBlockEnd:0}}}},[`${s}-button`]:{height:e.controlHeight,"&:hover, &:focus":{zIndex:1}},[`&-large ${s}-button`]:{height:e.controlHeightLG},[`&-small ${s}-button`]:{height:e.controlHeightSM},"&-rtl":{direction:"rtl"},[`&${r}-compact-item`]:{[`&:not(${r}-compact-last-item)`]:{[`${r}-group-addon`]:{[`${r}-search-button`]:{marginInlineEnd:-e.lineWidth,borderRadius:0}}},[`&:not(${r}-compact-first-item)`]:{[`${r},${r}-affix-wrapper`]:{borderRadius:0}},[`> ${r}-group-addon ${r}-search-button,
        > ${r},
        ${r}-affix-wrapper`]:{"&:hover,&:focus,&:active":{zIndex:2}},[`> ${r}-affix-wrapper-focused`]:{zIndex:2}}}}};function gH(e){return lo(e,{inputAffixPadding:e.paddingXXS,inputPaddingVertical:Math.max(Math.round((e.controlHeight-e.fontSize*e.lineHeight)/2*10)/10-e.lineWidth,3),inputPaddingVerticalLG:Math.ceil((e.controlHeightLG-e.fontSizeLG*e.lineHeightLG)/2*10)/10-e.lineWidth,inputPaddingVerticalSM:Math.max(Math.round((e.controlHeightSM-e.fontSize*e.lineHeight)/2*10)/10-e.lineWidth,0),inputPaddingHorizontal:e.paddingSM-e.lineWidth,inputPaddingHorizontalSM:e.paddingXS-e.lineWidth,inputPaddingHorizontalLG:e.controlPaddingHorizontal-e.lineWidth,inputBorderHoverColor:e.colorPrimaryHover,inputBorderActiveColor:e.colorPrimaryHover})}const gEe=e=>{const{componentCls:r,paddingLG:o}=e,s=`${r}-textarea`;return{[s]:{position:"relative","&-show-count":{[`> ${r}`]:{height:"100%"},[`${r}-data-count`]:{position:"absolute",bottom:-e.fontSize*e.lineHeight,insetInlineEnd:0,color:e.colorTextDescription,whiteSpace:"nowrap",pointerEvents:"none"}},"&-allow-clear":{[`> ${r}`]:{paddingInlineEnd:o}},[`&-affix-wrapper${s}-has-feedback`]:{[`${r}`]:{paddingInlineEnd:o}},[`&-affix-wrapper${r}-affix-wrapper`]:{padding:0,[`> textarea${r}`]:{fontSize:"inherit",border:"none",outline:"none","&:focus":{boxShadow:"none !important"}},[`${r}-suffix`]:{margin:0,"> *:not(:last-child)":{marginInline:0},[`${r}-clear-icon`]:{position:"absolute",insetInlineEnd:e.paddingXS,insetBlockStart:e.paddingXS},[`${s}-suffix`]:{position:"absolute",top:0,insetInlineEnd:e.inputPaddingHorizontal,bottom:0,zIndex:1,display:"inline-flex",alignItems:"center",margin:"auto",pointerEvents:"none"}}}}}},Hx=ac("Input",e=>{const r=gH(e);return[dEe(r),gEe(r),pEe(r),fEe(r),mEe(r),c9(r)]}),vEe=b.createContext({}),vH=vEe,EEe=e=>{const{componentCls:r}=e;return{[r]:{display:"flex",flexFlow:"row wrap",minWidth:0,"&::before, &::after":{display:"flex"},"&-no-wrap":{flexWrap:"nowrap"},"&-start":{justifyContent:"flex-start"},"&-center":{justifyContent:"center"},"&-end":{justifyContent:"flex-end"},"&-space-between":{justifyContent:"space-between"},"&-space-around":{justifyContent:"space-around"},"&-space-evenly":{justifyContent:"space-evenly"},"&-top":{alignItems:"flex-start"},"&-middle":{alignItems:"center"},"&-bottom":{alignItems:"flex-end"}}}},_Ee=e=>{const{componentCls:r}=e;return{[r]:{position:"relative",maxWidth:"100%",minHeight:1}}},yEe=(e,r)=>{const{componentCls:o,gridColumns:s}=e,c={};for(let d=s;d>=0;d--)d===0?(c[`${o}${r}-${d}`]={display:"none"},c[`${o}-push-${d}`]={insetInlineStart:"auto"},c[`${o}-pull-${d}`]={insetInlineEnd:"auto"},c[`${o}${r}-push-${d}`]={insetInlineStart:"auto"},c[`${o}${r}-pull-${d}`]={insetInlineEnd:"auto"},c[`${o}${r}-offset-${d}`]={marginInlineStart:0},c[`${o}${r}-order-${d}`]={order:0}):(c[`${o}${r}-${d}`]={display:"block",flex:`0 0 ${d/s*100}%`,maxWidth:`${d/s*100}%`},c[`${o}${r}-push-${d}`]={insetInlineStart:`${d/s*100}%`},c[`${o}${r}-pull-${d}`]={insetInlineEnd:`${d/s*100}%`},c[`${o}${r}-offset-${d}`]={marginInlineStart:`${d/s*100}%`},c[`${o}${r}-order-${d}`]={order:d});return c},WA=(e,r)=>yEe(e,r),SEe=(e,r,o)=>({[`@media (min-width: ${r}px)`]:Object.assign({},WA(e,o))}),CEe=ac("Grid",e=>[EEe(e)]),bEe=ac("Grid",e=>{const r=lo(e,{gridColumns:24}),o={"-sm":r.screenSMMin,"-md":r.screenMDMin,"-lg":r.screenLGMin,"-xl":r.screenXLMin,"-xxl":r.screenXXLMin};return[_Ee(r),WA(r,""),WA(r,"-xs"),Object.keys(o).map(s=>SEe(r,o[s],s)).reduce((s,c)=>Object.assign(Object.assign({},s),c),{})]});var TEe=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function REe(e){return typeof e=="number"?`${e} ${e} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(e)?`0 0 ${e}`:e}const wEe=["xs","sm","md","lg","xl","xxl"],IEe=b.forwardRef((e,r)=>{const{getPrefixCls:o,direction:s}=b.useContext(or),{gutter:c,wrap:d,supportFlexGap:f}=b.useContext(vH),{prefixCls:m,span:g,order:_,offset:S,push:T,pull:R,className:N,children:A,flex:O,style:M}=e,x=TEe(e,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),P=o("col",m),[D,F]=bEe(P);let $={};wEe.forEach(K=>{let Q={};const Y=e[K];typeof Y=="number"?Q.span=Y:typeof Y=="object"&&(Q=Y||{}),delete x[K],$=Object.assign(Object.assign({},$),{[`${P}-${K}-${Q.span}`]:Q.span!==void 0,[`${P}-${K}-order-${Q.order}`]:Q.order||Q.order===0,[`${P}-${K}-offset-${Q.offset}`]:Q.offset||Q.offset===0,[`${P}-${K}-push-${Q.push}`]:Q.push||Q.push===0,[`${P}-${K}-pull-${Q.pull}`]:Q.pull||Q.pull===0,[`${P}-${K}-flex-${Q.flex}`]:Q.flex||Q.flex==="auto",[`${P}-rtl`]:s==="rtl"})});const V=Xe(P,{[`${P}-${g}`]:g!==void 0,[`${P}-order-${_}`]:_,[`${P}-offset-${S}`]:S,[`${P}-push-${T}`]:T,[`${P}-pull-${R}`]:R},N,$,F),W={};if(c&&c[0]>0){const K=c[0]/2;W.paddingLeft=K,W.paddingRight=K}if(c&&c[1]>0&&!f){const K=c[1]/2;W.paddingTop=K,W.paddingBottom=K}return O&&(W.flex=REe(O),d===!1&&!W.minWidth&&(W.minWidth=0)),D(b.createElement("div",Object.assign({},x,{style:Object.assign(Object.assign({},W),M),className:V,ref:r}),A))}),EH=IEe,AEe=()=>{const[e,r]=b.useState(!1);return b.useEffect(()=>{r(Cfe())},[]),e};var OEe=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function qB(e,r){const[o,s]=b.useState(typeof e=="string"?e:""),c=()=>{if(typeof e=="string"&&s(e),typeof e=="object")for(let d=0;d<Qm.length;d++){const f=Qm[d];if(!r[f])continue;const m=e[f];if(m!==void 0){s(m);return}}};return b.useEffect(()=>{c()},[JSON.stringify(e),r]),o}const xEe=b.forwardRef((e,r)=>{const{prefixCls:o,justify:s,align:c,className:d,style:f,children:m,gutter:g=0,wrap:_}=e,S=OEe(e,["prefixCls","justify","align","className","style","children","gutter","wrap"]),{getPrefixCls:T,direction:R}=b.useContext(or),[N,A]=b.useState({xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0}),[O,M]=b.useState({xs:!1,sm:!1,md:!1,lg:!1,xl:!1,xxl:!1}),x=qB(c,O),P=qB(s,O),D=AEe(),F=b.useRef(g),$=Bme();b.useEffect(()=>{const ae=$.subscribe(ge=>{M(ge);const Se=F.current||0;(!Array.isArray(Se)&&typeof Se=="object"||Array.isArray(Se)&&(typeof Se[0]=="object"||typeof Se[1]=="object"))&&A(ge)});return()=>$.unsubscribe(ae)},[]);const V=()=>{const ae=[void 0,void 0];return(Array.isArray(g)?g:[g,void 0]).forEach((Se,de)=>{if(typeof Se=="object")for(let he=0;he<Qm.length;he++){const be=Qm[he];if(N[be]&&Se[be]!==void 0){ae[de]=Se[be];break}}else ae[de]=Se}),ae},W=T("row",o),[K,Q]=CEe(W),Y=V(),ee=Xe(W,{[`${W}-no-wrap`]:_===!1,[`${W}-${P}`]:P,[`${W}-${x}`]:x,[`${W}-rtl`]:R==="rtl"},d,Q),te={},ie=Y[0]!=null&&Y[0]>0?Y[0]/-2:void 0,le=Y[1]!=null&&Y[1]>0?Y[1]/-2:void 0;ie&&(te.marginLeft=ie,te.marginRight=ie),D?[,te.rowGap]=Y:le&&(te.marginTop=le,te.marginBottom=le);const[me,ce]=Y,se=b.useMemo(()=>({gutter:[me,ce],wrap:_,supportFlexGap:D}),[me,ce,_,D]);return K(b.createElement(vH.Provider,{value:se},b.createElement("div",Object.assign({},S,{className:ee,style:Object.assign(Object.assign({},te),f),ref:r}),m)))}),NEe=xEe,PEe=e=>{const{getPrefixCls:r,direction:o}=b.useContext(or),{prefixCls:s,className:c=""}=e,d=r("input-group",s),f=r("input"),[m,g]=Hx(f),_=Xe(d,{[`${d}-lg`]:e.size==="large",[`${d}-sm`]:e.size==="small",[`${d}-compact`]:e.compact,[`${d}-rtl`]:o==="rtl"},g,c),S=b.useContext(Il),T=b.useMemo(()=>Object.assign(Object.assign({},S),{isFormItemInput:!1}),[S]);return m(b.createElement("span",{className:_,style:e.style,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onFocus:e.onFocus,onBlur:e.onBlur},b.createElement(Il.Provider,{value:T},e.children)))},DEe=PEe;function bp(e){return!!(e.addonBefore||e.addonAfter)}function q1(e){return!!(e.prefix||e.suffix||e.allowClear)}function Rm(e,r,o,s){if(o){var c=r;if(r.type==="click"){var d=e.cloneNode(!0);c=Object.create(r,{target:{value:d},currentTarget:{value:d}}),d.value="",o(c);return}if(s!==void 0){c=Object.create(r,{target:{value:e},currentTarget:{value:e}}),e.value=s,o(c);return}o(c)}}function kEe(e,r){if(e){e.focus(r);var o=r||{},s=o.cursor;if(s){var c=e.value.length;switch(s){case"start":e.setSelectionRange(0,0);break;case"end":e.setSelectionRange(c,c);break;default:e.setSelectionRange(0,c)}}}}function GA(e){return typeof e>"u"||e===null?"":String(e)}var _H=function(r){var o,s,c=r.inputElement,d=r.prefixCls,f=r.prefix,m=r.suffix,g=r.addonBefore,_=r.addonAfter,S=r.className,T=r.style,R=r.disabled,N=r.readOnly,A=r.focused,O=r.triggerFocus,M=r.allowClear,x=r.value,P=r.handleReset,D=r.hidden,F=r.classes,$=r.classNames,V=r.dataAttrs,W=r.styles,K=b.useRef(null),Q=function(de){var he;(he=K.current)!==null&&he!==void 0&&he.contains(de.target)&&(O==null||O())},Y=function(){var de;if(!M)return null;var he=!R&&!N&&x,be="".concat(d,"-clear-icon"),ve=Fn(M)==="object"&&M!==null&&M!==void 0&&M.clearIcon?M.clearIcon:"â";return St.createElement("span",{onClick:P,onMouseDown:function(Le){return Le.preventDefault()},className:Xe(be,(de={},ct(de,"".concat(be,"-hidden"),!he),ct(de,"".concat(be,"-has-suffix"),!!m),de)),role:"button",tabIndex:-1},ve)},ee=b.cloneElement(c,{value:x,hidden:D,className:Xe((o=c.props)===null||o===void 0?void 0:o.className,!q1(r)&&!bp(r)&&S)||null,style:Oe(Oe({},(s=c.props)===null||s===void 0?void 0:s.style),!q1(r)&&!bp(r)?T:{})});if(q1(r)){var te,ie="".concat(d,"-affix-wrapper"),le=Xe(ie,(te={},ct(te,"".concat(ie,"-disabled"),R),ct(te,"".concat(ie,"-focused"),A),ct(te,"".concat(ie,"-readonly"),N),ct(te,"".concat(ie,"-input-with-clear-btn"),m&&M&&x),te),!bp(r)&&S,F==null?void 0:F.affixWrapper),me=(m||M)&&St.createElement("span",{className:Xe("".concat(d,"-suffix"),$==null?void 0:$.suffix),style:W==null?void 0:W.suffix},Y(),m);ee=St.createElement("span",Ze({className:le,style:bp(r)?void 0:T,hidden:!bp(r)&&D,onClick:Q},V==null?void 0:V.affixWrapper,{ref:K}),f&&St.createElement("span",{className:Xe("".concat(d,"-prefix"),$==null?void 0:$.prefix),style:W==null?void 0:W.prefix},f),b.cloneElement(c,{value:x,hidden:null}),me)}if(bp(r)){var ce="".concat(d,"-group"),se="".concat(ce,"-addon"),ae=Xe("".concat(d,"-wrapper"),ce,F==null?void 0:F.wrapper),ge=Xe("".concat(d,"-group-wrapper"),S,F==null?void 0:F.group);return St.createElement("span",{className:ge,style:T,hidden:D},St.createElement("span",{className:ae},g&&St.createElement("span",{className:se},g),b.cloneElement(ee,{hidden:null}),_&&St.createElement("span",{className:se},_)))}return ee},LEe=["autoComplete","onChange","onFocus","onBlur","onPressEnter","onKeyDown","prefixCls","disabled","htmlSize","className","maxLength","suffix","showCount","type","classes","classNames","styles"],MEe=b.forwardRef(function(e,r){var o=e.autoComplete,s=e.onChange,c=e.onFocus,d=e.onBlur,f=e.onPressEnter,m=e.onKeyDown,g=e.prefixCls,_=g===void 0?"rc-input":g,S=e.disabled,T=e.htmlSize,R=e.className,N=e.maxLength,A=e.suffix,O=e.showCount,M=e.type,x=M===void 0?"text":M,P=e.classes,D=e.classNames,F=e.styles,$=An(e,LEe),V=vl(e.defaultValue,{value:e.value}),W=Ge(V,2),K=W[0],Q=W[1],Y=b.useState(!1),ee=Ge(Y,2),te=ee[0],ie=ee[1],le=b.useRef(null),me=function(ve){le.current&&kEe(le.current,ve)};b.useImperativeHandle(r,function(){return{focus:me,blur:function(){var ve;(ve=le.current)===null||ve===void 0||ve.blur()},setSelectionRange:function(ve,ke,Le){var $e;($e=le.current)===null||$e===void 0||$e.setSelectionRange(ve,ke,Le)},select:function(){var ve;(ve=le.current)===null||ve===void 0||ve.select()},input:le.current}}),b.useEffect(function(){ie(function(be){return be&&S?!1:be})},[S]);var ce=function(ve){e.value===void 0&&Q(ve.target.value),le.current&&Rm(le.current,ve,s)},se=function(ve){f&&ve.key==="Enter"&&f(ve),m==null||m(ve)},ae=function(ve){ie(!0),c==null||c(ve)},ge=function(ve){ie(!1),d==null||d(ve)},Se=function(ve){Q(""),me(),le.current&&Rm(le.current,ve,s)},de=function(){var ve=ma(e,["prefixCls","onPressEnter","addonBefore","addonAfter","prefix","suffix","allowClear","defaultValue","showCount","classes","htmlSize","styles","classNames"]);return St.createElement("input",Ze({autoComplete:o},ve,{onChange:ce,onFocus:ae,onBlur:ge,onKeyDown:se,className:Xe(_,ct({},"".concat(_,"-disabled"),S),D==null?void 0:D.input),style:F==null?void 0:F.input,ref:le,size:T,type:x}))},he=function(){var ve=Number(N)>0;if(A||O){var ke=GA(K),Le=at(ke).length,$e=Fn(O)==="object"?O.formatter({value:ke,count:Le,maxLength:N}):"".concat(Le).concat(ve?" / ".concat(N):"");return St.createElement(St.Fragment,null,!!O&&St.createElement("span",{className:Xe("".concat(_,"-show-count-suffix"),ct({},"".concat(_,"-show-count-has-suffix"),!!A),D==null?void 0:D.count),style:Oe({},F==null?void 0:F.count)},$e),A)}return null};return St.createElement(_H,Ze({},$,{prefixCls:_,className:R,inputElement:de(),handleReset:Se,value:GA(K),focused:te,triggerFocus:me,suffix:he(),disabled:S,classes:P,classNames:D,styles:F}))});function yH(e,r){const o=b.useRef([]),s=()=>{o.current.push(setTimeout(()=>{var c,d,f,m;!((c=e.current)===null||c===void 0)&&c.input&&((d=e.current)===null||d===void 0?void 0:d.input.getAttribute("type"))==="password"&&(!((f=e.current)===null||f===void 0)&&f.input.hasAttribute("value"))&&((m=e.current)===null||m===void 0||m.input.removeAttribute("value"))}))};return b.useEffect(()=>(r&&s(),()=>o.current.forEach(c=>{c&&clearTimeout(c)})),[]),s}function FEe(e){return!!(e.prefix||e.suffix||e.allowClear)}var UEe=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function BEe(e,r){if(!e)return;e.focus(r);const{cursor:o}=r||{};if(o){const s=e.value.length;switch(o){case"start":e.setSelectionRange(0,0);break;case"end":e.setSelectionRange(s,s);break;default:e.setSelectionRange(0,s);break}}}const jEe=b.forwardRef((e,r)=>{const{prefixCls:o,bordered:s=!0,status:c,size:d,disabled:f,onBlur:m,onFocus:g,suffix:_,allowClear:S,addonAfter:T,addonBefore:R,className:N,rootClassName:A,onChange:O,classNames:M}=e,x=UEe(e,["prefixCls","bordered","status","size","disabled","onBlur","onFocus","suffix","allowClear","addonAfter","addonBefore","className","rootClassName","onChange","classNames"]),{getPrefixCls:P,direction:D,input:F}=St.useContext(or),$=P("input",o),V=b.useRef(null),[W,K]=Hx($),{compactSize:Q,compactItemClassnames:Y}=Rx($,D),ee=Rf(Le=>{var $e;return($e=d??Q)!==null&&$e!==void 0?$e:Le}),te=St.useContext(pg),ie=f??te,{status:le,hasFeedback:me,feedbackIcon:ce}=b.useContext(Il),se=L9(le,c),ae=FEe(e)||!!me,ge=b.useRef(ae);b.useEffect(()=>{ae&&ge.current,ge.current=ae},[ae]);const Se=yH(V,!0),de=Le=>{Se(),m==null||m(Le)},he=Le=>{Se(),g==null||g(Le)},be=Le=>{Se(),O==null||O(Le)},ve=(me||_)&&St.createElement(St.Fragment,null,_,me&&ce);let ke;return typeof S=="object"&&(S!=null&&S.clearIcon)?ke=S:S&&(ke={clearIcon:St.createElement(MS,null)}),W(St.createElement(MEe,Object.assign({ref:jc(r,V),prefixCls:$,autoComplete:F==null?void 0:F.autoComplete},x,{disabled:ie,onBlur:de,onFocus:he,suffix:ve,allowClear:ke,className:Xe(N,A,Y),onChange:be,addonAfter:T&&St.createElement(SA,null,St.createElement(CB,{override:!0,status:!0},T)),addonBefore:R&&St.createElement(SA,null,St.createElement(CB,{override:!0,status:!0},R)),classNames:Object.assign(Object.assign({},M),{input:Xe({[`${$}-sm`]:ee==="small",[`${$}-lg`]:ee==="large",[`${$}-rtl`]:D==="rtl",[`${$}-borderless`]:!s},!ae&&Tm($,se),M==null?void 0:M.input,K)}),classes:{affixWrapper:Xe({[`${$}-affix-wrapper-sm`]:ee==="small",[`${$}-affix-wrapper-lg`]:ee==="large",[`${$}-affix-wrapper-rtl`]:D==="rtl",[`${$}-affix-wrapper-borderless`]:!s},Tm(`${$}-affix-wrapper`,se,me),K),wrapper:Xe({[`${$}-group-rtl`]:D==="rtl"},K),group:Xe({[`${$}-group-wrapper-sm`]:ee==="small",[`${$}-group-wrapper-lg`]:ee==="large",[`${$}-group-wrapper-rtl`]:D==="rtl",[`${$}-group-wrapper-disabled`]:ie},Tm(`${$}-group-wrapper`,se,me),K)}})))}),Wx=jEe;var SH={};Object.defineProperty(SH,"__esModule",{value:!0});var VEe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}},{tag:"path",attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}}]},name:"eye-invisible",theme:"outlined"},$Ee=SH.default=VEe;function HEe(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function WEe(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){HEe(e,c,o[c])})}return e}function GEe(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function zEe(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GEe(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var KEe=function(e,r){return b.createElement(Yi,zEe(WEe({},e),{ref:r,icon:$Ee}))};const YEe=b.forwardRef(KEe);var CH={};Object.defineProperty(CH,"__esModule",{value:!0});var qEe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"},XEe=CH.default=qEe;function JEe(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function QEe(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){JEe(e,c,o[c])})}return e}function ZEe(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function e_e(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZEe(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var t_e=function(e,r){return b.createElement(Yi,e_e(QEe({},e),{ref:r,icon:XEe}))};const n_e=b.forwardRef(t_e);var r_e=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const i_e=e=>e?b.createElement(n_e,null):b.createElement(YEe,null),o_e={click:"onClick",hover:"onMouseOver"},a_e=b.forwardRef((e,r)=>{const{visibilityToggle:o=!0}=e,s=typeof o=="object"&&o.visible!==void 0,[c,d]=b.useState(()=>s?o.visible:!1),f=b.useRef(null);b.useEffect(()=>{s&&d(o.visible)},[s,o]);const m=yH(f),g=()=>{const{disabled:$}=e;$||(c&&m(),d(V=>{var W;const K=!V;return typeof o=="object"&&((W=o.onVisibleChange)===null||W===void 0||W.call(o,K)),K}))},_=$=>{const{action:V="click",iconRender:W=i_e}=e,K=o_e[V]||"",Q=W(c),Y={[K]:g,className:`${$}-icon`,key:"passwordIcon",onMouseDown:ee=>{ee.preventDefault()},onMouseUp:ee=>{ee.preventDefault()}};return b.cloneElement(b.isValidElement(Q)?Q:b.createElement("span",null,Q),Y)},{className:S,prefixCls:T,inputPrefixCls:R,size:N}=e,A=r_e(e,["className","prefixCls","inputPrefixCls","size"]),{getPrefixCls:O}=b.useContext(or),M=O("input",R),x=O("input-password",T),P=o&&_(x),D=Xe(x,S,{[`${x}-${N}`]:!!N}),F=Object.assign(Object.assign({},ma(A,["suffix","iconRender","visibilityToggle"])),{type:c?"text":"password",className:D,prefixCls:M,suffix:P});return N&&(F.size=N),b.createElement(Wx,Object.assign({ref:jc(r,f)},F))}),s_e=a_e;var c_e=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const l_e=b.forwardRef((e,r)=>{const{prefixCls:o,inputPrefixCls:s,className:c,size:d,suffix:f,enterButton:m=!1,addonAfter:g,loading:_,disabled:S,onSearch:T,onChange:R,onCompositionStart:N,onCompositionEnd:A}=e,O=c_e(e,["prefixCls","inputPrefixCls","className","size","suffix","enterButton","addonAfter","loading","disabled","onSearch","onChange","onCompositionStart","onCompositionEnd"]),{getPrefixCls:M,direction:x}=b.useContext(or),P=b.useRef(!1),D=M("input-search",o),F=M("input",s),{compactSize:$}=Rx(D,x),V=Rf(Se=>{var de;return(de=d??$)!==null&&de!==void 0?de:Se}),W=b.useRef(null),K=Se=>{Se&&Se.target&&Se.type==="click"&&T&&T(Se.target.value,Se),R&&R(Se)},Q=Se=>{var de;document.activeElement===((de=W.current)===null||de===void 0?void 0:de.input)&&Se.preventDefault()},Y=Se=>{var de,he;T&&T((he=(de=W.current)===null||de===void 0?void 0:de.input)===null||he===void 0?void 0:he.value,Se)},ee=Se=>{P.current||_||Y(Se)},te=typeof m=="boolean"?b.createElement(Mme,null):null,ie=`${D}-button`;let le;const me=m||{},ce=me.type&&me.type.__ANT_BUTTON===!0;ce||me.type==="button"?le=nc(me,Object.assign({onMouseDown:Q,onClick:Se=>{var de,he;(he=(de=me==null?void 0:me.props)===null||de===void 0?void 0:de.onClick)===null||he===void 0||he.call(de,Se),Y(Se)},key:"enterButton"},ce?{className:ie,size:V}:{})):le=b.createElement(wi,{className:ie,type:m?"primary":void 0,size:V,disabled:S,key:"enterButton",onMouseDown:Q,onClick:Y,loading:_,icon:te},m),g&&(le=[le,nc(g,{key:"addonAfter"})]);const se=Xe(D,{[`${D}-rtl`]:x==="rtl",[`${D}-${V}`]:!!V,[`${D}-with-button`]:!!m},c),ae=Se=>{P.current=!0,N==null||N(Se)},ge=Se=>{P.current=!1,A==null||A(Se)};return b.createElement(Wx,Object.assign({ref:jc(W,r),onPressEnter:ee},O,{size:V,onCompositionStart:ae,onCompositionEnd:ge,prefixCls:F,addonAfter:le,suffix:f,onChange:K,className:se,disabled:S}))}),u_e=l_e;var d_e=`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
  pointer-events: none !important;
`,h_e=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break","white-space"],X1={},ps;function p_e(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=e.getAttribute("id")||e.getAttribute("data-reactid")||e.getAttribute("name");if(r&&X1[o])return X1[o];var s=window.getComputedStyle(e),c=s.getPropertyValue("box-sizing")||s.getPropertyValue("-moz-box-sizing")||s.getPropertyValue("-webkit-box-sizing"),d=parseFloat(s.getPropertyValue("padding-bottom"))+parseFloat(s.getPropertyValue("padding-top")),f=parseFloat(s.getPropertyValue("border-bottom-width"))+parseFloat(s.getPropertyValue("border-top-width")),m=h_e.map(function(_){return"".concat(_,":").concat(s.getPropertyValue(_))}).join(";"),g={sizingStyle:m,paddingSize:d,borderSize:f,boxSizing:c};return r&&o&&(X1[o]=g),g}function f_e(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;ps||(ps=document.createElement("textarea"),ps.setAttribute("tab-index","-1"),ps.setAttribute("aria-hidden","true"),document.body.appendChild(ps)),e.getAttribute("wrap")?ps.setAttribute("wrap",e.getAttribute("wrap")):ps.removeAttribute("wrap");var c=p_e(e,r),d=c.paddingSize,f=c.borderSize,m=c.boxSizing,g=c.sizingStyle;ps.setAttribute("style","".concat(g,";").concat(d_e)),ps.value=e.value||e.placeholder||"";var _=void 0,S=void 0,T,R=ps.scrollHeight;if(m==="border-box"?R+=f:m==="content-box"&&(R-=d),o!==null||s!==null){ps.value=" ";var N=ps.scrollHeight-d;o!==null&&(_=N*o,m==="border-box"&&(_=_+d+f),R=Math.max(_,R)),s!==null&&(S=N*s,m==="border-box"&&(S=S+d+f),T=R>S?"":"hidden",R=Math.min(S,R))}var A={height:R,overflowY:T,resize:"none"};return _&&(A.minHeight=_),S&&(A.maxHeight=S),A}var m_e=["prefixCls","onPressEnter","defaultValue","value","autoSize","onResize","className","style","disabled","onChange","onInternalAutoSize"],J1=0,Q1=1,Z1=2,g_e=b.forwardRef(function(e,r){var o=e,s=o.prefixCls;o.onPressEnter;var c=o.defaultValue,d=o.value,f=o.autoSize,m=o.onResize,g=o.className,_=o.style,S=o.disabled,T=o.onChange;o.onInternalAutoSize;var R=An(o,m_e),N=vl(c,{value:d,postState:function(ve){return ve??""}}),A=Ge(N,2),O=A[0],M=A[1],x=function(ve){M(ve.target.value),T==null||T(ve)},P=b.useRef();b.useImperativeHandle(r,function(){return{textArea:P.current}});var D=b.useMemo(function(){return f&&Fn(f)==="object"?[f.minRows,f.maxRows]:[]},[f]),F=Ge(D,2),$=F[0],V=F[1],W=!!f,K=function(){try{if(document.activeElement===P.current){var ve=P.current,ke=ve.selectionStart,Le=ve.selectionEnd,$e=ve.scrollTop;P.current.setSelectionRange(ke,Le),P.current.scrollTop=$e}}catch{}},Q=b.useState(Z1),Y=Ge(Q,2),ee=Y[0],te=Y[1],ie=b.useState(),le=Ge(ie,2),me=le[0],ce=le[1],se=function(){te(J1)};qr(function(){W&&se()},[d,$,V,W]),qr(function(){if(ee===J1)te(Q1);else if(ee===Q1){var be=f_e(P.current,!1,$,V);te(Z1),ce(be)}else K()},[ee]);var ae=b.useRef(),ge=function(){ao.cancel(ae.current)},Se=function(ve){ee===Z1&&(m==null||m(ve),f&&(ge(),ae.current=ao(function(){se()})))};b.useEffect(function(){return ge},[]);var de=W?me:null,he=Oe(Oe({},_),de);return(ee===J1||ee===Q1)&&(he.overflowY="hidden",he.overflowX="hidden"),b.createElement(ah,{onResize:Se,disabled:!(f||m)},b.createElement("textarea",Ze({},R,{ref:P,style:he,className:Xe(s,g,ct({},"".concat(s,"-disabled"),S)),disabled:S,value:O,onChange:x})))}),v_e=["defaultValue","value","onFocus","onBlur","onChange","allowClear","maxLength","onCompositionStart","onCompositionEnd","suffix","prefixCls","classes","showCount","className","style","disabled","hidden","classNames","styles","onResize"];function bH(e,r){return at(e||"").slice(0,r).join("")}function XB(e,r,o,s){var c=o;return e?c=bH(o,s):at(r||"").length<o.length&&at(o||"").length>s&&(c=r),c}var E_e=St.forwardRef(function(e,r){var o,s=e.defaultValue,c=e.value,d=e.onFocus,f=e.onBlur,m=e.onChange,g=e.allowClear,_=e.maxLength,S=e.onCompositionStart,T=e.onCompositionEnd,R=e.suffix,N=e.prefixCls,A=N===void 0?"rc-textarea":N,O=e.classes,M=e.showCount,x=e.className,P=e.style,D=e.disabled,F=e.hidden,$=e.classNames,V=e.styles,W=e.onResize,K=An(e,v_e),Q=vl(s,{value:c,defaultValue:s}),Y=Ge(Q,2),ee=Y[0],te=Y[1],ie=b.useRef(null),le=St.useState(!1),me=Ge(le,2),ce=me[0],se=me[1],ae=St.useState(!1),ge=Ge(ae,2),Se=ge[0],de=ge[1],he=St.useRef(),be=St.useRef(0),ve=St.useState(null),ke=Ge(ve,2),Le=ke[0],$e=ke[1],Ve=function(){ie.current.textArea.focus()};b.useImperativeHandle(r,function(){return{resizableTextArea:ie.current,focus:Ve,blur:function(){ie.current.textArea.blur()}}}),b.useEffect(function(){se(function(Dt){return!D&&Dt})},[D]);var ut=Number(_)>0,ht=function(Ht){de(!0),he.current=ee,be.current=Ht.currentTarget.selectionStart,S==null||S(Ht)},Ct=function(Ht){de(!1);var En=Ht.currentTarget.value;if(ut){var Vt,vn=be.current>=_+1||be.current===((Vt=he.current)===null||Vt===void 0?void 0:Vt.length);En=XB(vn,he.current,En,_)}En!==ee&&(te(En),Rm(Ht.currentTarget,Ht,m,En)),T==null||T(Ht)},gt=function(Ht){var En=Ht.target.value;if(!Se&&ut){var Vt=Ht.target.selectionStart>=_+1||Ht.target.selectionStart===En.length||!Ht.target.selectionStart;En=XB(Vt,ee,En,_)}te(En),Rm(Ht.currentTarget,Ht,m,En)},kt=function(Ht){var En=K.onPressEnter,Vt=K.onKeyDown;Ht.key==="Enter"&&En&&En(Ht),Vt==null||Vt(Ht)},It=function(Ht){se(!0),d==null||d(Ht)},Lt=function(Ht){se(!1),f==null||f(Ht)},Yt=function(Ht){te(""),Ve(),Rm(ie.current.textArea,Ht,m)},jt=GA(ee);!Se&&ut&&c==null&&(jt=bH(jt,_));var He=R,dt;if(M){var rt=at(jt).length;Fn(M)==="object"?dt=M.formatter({value:jt,count:rt,maxLength:_}):dt="".concat(rt).concat(ut?" / ".concat(_):""),He=St.createElement(St.Fragment,null,He,St.createElement("span",{className:Xe("".concat(A,"-data-count"),$==null?void 0:$.count),style:V==null?void 0:V.count},dt))}var et=function(Ht){W==null||W(Ht),Le===null?$e("mounted"):Le==="mounted"&&$e("resized")},lt=St.createElement(_H,{value:jt,allowClear:g,handleReset:Yt,suffix:He,prefixCls:A,classes:{affixWrapper:Xe(O==null?void 0:O.affixWrapper,(o={},ct(o,"".concat(A,"-show-count"),M),ct(o,"".concat(A,"-textarea-allow-clear"),g),o))},disabled:D,focused:ce,className:x,style:Oe(Oe({},P),Le==="resized"?{height:"auto"}:{}),dataAttrs:{affixWrapper:{"data-count":typeof dt=="string"?dt:void 0}},hidden:F,inputElement:St.createElement(g_e,Ze({},K,{onKeyDown:kt,onChange:gt,onFocus:It,onBlur:Lt,onCompositionStart:ht,onCompositionEnd:Ct,className:$==null?void 0:$.textarea,style:Oe(Oe({},V==null?void 0:V.textarea),{},{resize:P==null?void 0:P.resize}),disabled:D,prefixCls:A,onResize:et,ref:ie}))});return lt}),__e=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const y_e=b.forwardRef((e,r)=>{var{prefixCls:o,bordered:s=!0,size:c,disabled:d,status:f,allowClear:m,showCount:g,classNames:_}=e,S=__e(e,["prefixCls","bordered","size","disabled","status","allowClear","showCount","classNames"]);const{getPrefixCls:T,direction:R}=b.useContext(or),N=Rf(c),A=b.useContext(pg),O=d??A,{status:M,hasFeedback:x,feedbackIcon:P}=b.useContext(Il),D=L9(M,f),F=b.useRef(null);b.useImperativeHandle(r,()=>{var Q;return{resizableTextArea:(Q=F.current)===null||Q===void 0?void 0:Q.resizableTextArea,focus:Y=>{var ee,te;BEe((te=(ee=F.current)===null||ee===void 0?void 0:ee.resizableTextArea)===null||te===void 0?void 0:te.textArea,Y)},blur:()=>{var Y;return(Y=F.current)===null||Y===void 0?void 0:Y.blur()}}});const $=T("input",o);let V;typeof m=="object"&&(m!=null&&m.clearIcon)?V=m:m&&(V={clearIcon:b.createElement(MS,null)});const[W,K]=Hx($);return W(b.createElement(E_e,Object.assign({},S,{disabled:O,allowClear:V,classes:{affixWrapper:Xe(`${$}-textarea-affix-wrapper`,{[`${$}-affix-wrapper-rtl`]:R==="rtl",[`${$}-affix-wrapper-borderless`]:!s,[`${$}-affix-wrapper-sm`]:N==="small",[`${$}-affix-wrapper-lg`]:N==="large",[`${$}-textarea-show-count`]:g},Tm(`${$}-affix-wrapper`,D),K)},classNames:Object.assign(Object.assign({},_),{textarea:Xe({[`${$}-borderless`]:!s,[`${$}-sm`]:N==="small",[`${$}-lg`]:N==="large"},Tm($,D),K,_==null?void 0:_.textarea)}),prefixCls:$,suffix:x&&b.createElement("span",{className:`${$}-textarea-suffix`},P),showCount:g,ref:F})))}),TH=y_e,Sg=Wx;Sg.Group=DEe;Sg.Search=u_e;Sg.TextArea=TH;Sg.Password=s_e;const S_e=Sg;function Py(e){const[r,o]=b.useState(e);return b.useEffect(()=>{const s=setTimeout(()=>{o(e)},e.length?0:10);return()=>{clearTimeout(s)}},[e]),r}const C_e=e=>{const{componentCls:r}=e,o=`${r}-show-help`,s=`${r}-show-help-item`;return{[o]:{transition:`opacity ${e.motionDurationSlow} ${e.motionEaseInOut}`,"&-appear, &-enter":{opacity:0,"&-active":{opacity:1}},"&-leave":{opacity:1,"&-active":{opacity:0}},[s]:{overflow:"hidden",transition:`height ${e.motionDurationSlow} ${e.motionEaseInOut},
                     opacity ${e.motionDurationSlow} ${e.motionEaseInOut},
                     transform ${e.motionDurationSlow} ${e.motionEaseInOut} !important`,[`&${s}-appear, &${s}-enter`]:{transform:"translateY(-5px)",opacity:0,"&-active":{transform:"translateY(0)",opacity:1}},[`&${s}-leave-active`]:{transform:"translateY(-5px)"}}}}},b_e=C_e,T_e=e=>({legend:{display:"block",width:"100%",marginBottom:e.marginLG,padding:0,color:e.colorTextDescription,fontSize:e.fontSizeLG,lineHeight:"inherit",border:0,borderBottom:`${e.lineWidth}px ${e.lineType} ${e.colorBorder}`},label:{fontSize:e.fontSize},'input[type="search"]':{boxSizing:"border-box"},'input[type="radio"], input[type="checkbox"]':{lineHeight:"normal"},'input[type="file"]':{display:"block"},'input[type="range"]':{display:"block",width:"100%"},"select[multiple], select[size]":{height:"auto"},"input[type='file']:focus,\n  input[type='radio']:focus,\n  input[type='checkbox']:focus":{outline:0,boxShadow:`0 0 0 ${e.controlOutlineWidth}px ${e.controlOutline}`},output:{display:"block",paddingTop:15,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight}}),JB=(e,r)=>{const{formItemCls:o}=e;return{[o]:{[`${o}-label > label`]:{height:r},[`${o}-control-input`]:{minHeight:r}}}},R_e=e=>{const{componentCls:r}=e;return{[e.componentCls]:Object.assign(Object.assign(Object.assign({},sh(e)),T_e(e)),{[`${r}-text`]:{display:"inline-block",paddingInlineEnd:e.paddingSM},"&-small":Object.assign({},JB(e,e.controlHeightSM)),"&-large":Object.assign({},JB(e,e.controlHeightLG))})}},w_e=e=>{const{formItemCls:r,iconCls:o,componentCls:s,rootPrefixCls:c}=e;return{[r]:Object.assign(Object.assign({},sh(e)),{marginBottom:e.marginLG,verticalAlign:"top","&-with-help":{transition:"none"},[`&-hidden,
        &-hidden.${c}-row`]:{display:"none"},"&-has-warning":{[`${r}-split`]:{color:e.colorError}},"&-has-error":{[`${r}-split`]:{color:e.colorWarning}},[`${r}-label`]:{display:"inline-block",flexGrow:0,overflow:"hidden",whiteSpace:"nowrap",textAlign:"end",verticalAlign:"middle","&-left":{textAlign:"start"},"&-wrap":{overflow:"unset",lineHeight:`${e.lineHeight} - 0.25em`,whiteSpace:"unset"},"> label":{position:"relative",display:"inline-flex",alignItems:"center",maxWidth:"100%",height:e.controlHeight,color:e.colorTextHeading,fontSize:e.fontSize,[`> ${o}`]:{fontSize:e.fontSize,verticalAlign:"top"},[`&${r}-required:not(${r}-required-mark-optional)::before`]:{display:"inline-block",marginInlineEnd:e.marginXXS,color:e.colorError,fontSize:e.fontSize,fontFamily:"SimSun, sans-serif",lineHeight:1,content:'"*"',[`${s}-hide-required-mark &`]:{display:"none"}},[`${r}-optional`]:{display:"inline-block",marginInlineStart:e.marginXXS,color:e.colorTextDescription,[`${s}-hide-required-mark &`]:{display:"none"}},[`${r}-tooltip`]:{color:e.colorTextDescription,cursor:"help",writingMode:"horizontal-tb",marginInlineStart:e.marginXXS},"&::after":{content:'":"',position:"relative",marginBlock:0,marginInlineStart:e.marginXXS/2,marginInlineEnd:e.marginXS},[`&${r}-no-colon::after`]:{content:'" "'}}},[`${r}-control`]:{display:"flex",flexDirection:"column",flexGrow:1,[`&:first-child:not([class^="'${c}-col-'"]):not([class*="' ${c}-col-'"])`]:{width:"100%"},"&-input":{position:"relative",display:"flex",alignItems:"center",minHeight:e.controlHeight,"&-content":{flex:"auto",maxWidth:"100%"}}},[r]:{"&-explain, &-extra":{clear:"both",color:e.colorTextDescription,fontSize:e.fontSize,lineHeight:e.lineHeight},"&-explain-connected":{width:"100%"},"&-extra":{minHeight:e.controlHeightSM,transition:`color ${e.motionDurationMid} ${e.motionEaseOut}`},"&-explain":{"&-error":{color:e.colorError},"&-warning":{color:e.colorWarning}}},[`&-with-help ${r}-explain`]:{height:"auto",opacity:1},[`${r}-feedback-icon`]:{fontSize:e.fontSize,textAlign:"center",visibility:"visible",animationName:Dx,animationDuration:e.motionDurationMid,animationTimingFunction:e.motionEaseOutBack,pointerEvents:"none","&-success":{color:e.colorSuccess},"&-error":{color:e.colorError},"&-warning":{color:e.colorWarning},"&-validating":{color:e.colorPrimary}}})}},I_e=e=>{const{componentCls:r,formItemCls:o,rootPrefixCls:s}=e;return{[`${r}-horizontal`]:{[`${o}-label`]:{flexGrow:0},[`${o}-control`]:{flex:"1 1 0",minWidth:0},[`${o}-label.${s}-col-24 + ${o}-control`]:{minWidth:"unset"}}}},A_e=e=>{const{componentCls:r,formItemCls:o}=e;return{[`${r}-inline`]:{display:"flex",flexWrap:"wrap",[o]:{flex:"none",marginInlineEnd:e.margin,marginBottom:0,"&-row":{flexWrap:"nowrap"},"&-with-help":{marginBottom:e.marginLG},[`> ${o}-label,
        > ${o}-control`]:{display:"inline-block",verticalAlign:"top"},[`> ${o}-label`]:{flex:"none"},[`${r}-text`]:{display:"inline-block"},[`${o}-has-feedback`]:{display:"inline-block"}}}}},Ap=e=>({padding:`0 0 ${e.paddingXS}px`,whiteSpace:"initial",textAlign:"start","> label":{margin:0,"&::after":{display:"none"}}}),O_e=e=>{const{componentCls:r,formItemCls:o}=e;return{[`${o} ${o}-label`]:Ap(e),[r]:{[o]:{flexWrap:"wrap",[`${o}-label,
          ${o}-control`]:{flex:"0 0 100%",maxWidth:"100%"}}}}},x_e=e=>{const{componentCls:r,formItemCls:o,rootPrefixCls:s}=e;return{[`${r}-vertical`]:{[o]:{"&-row":{flexDirection:"column"},"&-label > label":{height:"auto"},[`${r}-item-control`]:{width:"100%"}}},[`${r}-vertical ${o}-label,
      .${s}-col-24${o}-label,
      .${s}-col-xl-24${o}-label`]:Ap(e),[`@media (max-width: ${e.screenXSMax}px)`]:[O_e(e),{[r]:{[`.${s}-col-xs-24${o}-label`]:Ap(e)}}],[`@media (max-width: ${e.screenSMMax}px)`]:{[r]:{[`.${s}-col-sm-24${o}-label`]:Ap(e)}},[`@media (max-width: ${e.screenMDMax}px)`]:{[r]:{[`.${s}-col-md-24${o}-label`]:Ap(e)}},[`@media (max-width: ${e.screenLGMax}px)`]:{[r]:{[`.${s}-col-lg-24${o}-label`]:Ap(e)}}}},Gx=ac("Form",(e,r)=>{let{rootPrefixCls:o}=r;const s=lo(e,{formItemCls:`${e.componentCls}-item`,rootPrefixCls:o});return[R_e(s),w_e(s),b_e(s),I_e(s),A_e(s),x_e(s),R9(s),Dx]}),QB=[];function ew(e,r,o){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{key:typeof e=="string"?e:`${r}-${s}`,error:e,errorStatus:o}}function RH(e){let{help:r,helpStatus:o,errors:s=QB,warnings:c=QB,className:d,fieldId:f,onVisibleChanged:m}=e;const{prefixCls:g}=b.useContext(Px),_=`${g}-item-explain`,[,S]=Gx(g),T=b.useMemo(()=>bA(g),[g]),R=Py(s),N=Py(c),A=b.useMemo(()=>r!=null?[ew(r,"help",o)]:[].concat(at(R.map((M,x)=>ew(M,"error","error",x))),at(N.map((M,x)=>ew(M,"warning","warning",x)))),[r,o,R,N]),O={};return f&&(O.id=`${f}_help`),b.createElement(ch,{motionDeadline:T.motionDeadline,motionName:`${g}-show-help`,visible:!!A.length,onVisibleChanged:m},M=>{const{className:x,style:P}=M;return b.createElement("div",Object.assign({},O,{className:Xe(_,x,d,S),style:P,role:"alert"}),b.createElement(d7,Object.assign({keys:A},bA(g),{motionName:`${g}-show-help-item`,component:!1}),D=>{const{key:F,error:$,errorStatus:V,className:W,style:K}=D;return b.createElement("div",{key:F,className:Xe(W,{[`${_}-${V}`]:V}),style:K},$)}))})}const N_e=["parentNode"],P_e="form_item";function wm(e){return e===void 0||e===!1?[]:Array.isArray(e)?e:[e]}function wH(e,r){if(!e.length)return;const o=e.join("_");return r?`${r}_${o}`:N_e.includes(o)?`${P_e}_${o}`:o}function ZB(e){return wm(e).join("_")}function IH(e){const[r]=Nx(),o=b.useRef({}),s=b.useMemo(()=>e??Object.assign(Object.assign({},r),{__INTERNAL__:{itemRef:c=>d=>{const f=ZB(c);d?o.current[f]=d:delete o.current[f]}},scrollToField:function(c){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const f=wm(c),m=wH(f,s.__INTERNAL__.name),g=m?document.getElementById(m):null;g&&Jhe(g,Object.assign({scrollMode:"if-needed",block:"nearest"},d))},getFieldInstance:c=>{const d=ZB(c);return o.current[d]}}),[e,r]);return[s]}var D_e=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const k_e=(e,r)=>{const o=b.useContext(pg),{getPrefixCls:s,direction:c,form:d}=b.useContext(or),{prefixCls:f,className:m,rootClassName:g,size:_,disabled:S=o,form:T,colon:R,labelAlign:N,labelWrap:A,labelCol:O,wrapperCol:M,hideRequiredMark:x,layout:P="horizontal",scrollToFirstError:D,requiredMark:F,onFinishFailed:$,name:V}=e,W=D_e(e,["prefixCls","className","rootClassName","size","disabled","form","colon","labelAlign","labelWrap","labelCol","wrapperCol","hideRequiredMark","layout","scrollToFirstError","requiredMark","onFinishFailed","name"]),K=Rf(_),Q=b.useContext(F$),Y=b.useMemo(()=>F!==void 0?F:d&&d.requiredMark!==void 0?d.requiredMark:!x,[x,F,d]),ee=R??(d==null?void 0:d.colon),te=s("form",f),[ie,le]=Gx(te),me=Xe(te,{[`${te}-${P}`]:!0,[`${te}-hide-required-mark`]:Y===!1,[`${te}-rtl`]:c==="rtl",[`${te}-${K}`]:K},le,m,g),[ce]=IH(T),{__INTERNAL__:se}=ce;se.name=V;const ae=b.useMemo(()=>({name:V,labelAlign:N,labelCol:O,labelWrap:A,wrapperCol:M,vertical:P==="vertical",colon:ee,requiredMark:Y,itemRef:se.itemRef,form:ce}),[V,N,O,M,P,ee,Y,ce]);b.useImperativeHandle(r,()=>ce);const ge=(de,he)=>{if(de){let be={block:"nearest"};typeof de=="object"&&(be=de),ce.scrollToField(he,be)}},Se=de=>{if($==null||$(de),de.errorFields.length){const he=de.errorFields[0].name;if(D!==void 0){ge(D,he);return}d&&d.scrollToFirstError!==void 0&&ge(d.scrollToFirstError,he)}};return ie(b.createElement(Q$,{disabled:S},b.createElement(e7,{size:K},b.createElement(C9,{validateMessages:Q},b.createElement(Hu.Provider,{value:ae},b.createElement(Af,Object.assign({id:V},W,{name:V,onFinishFailed:Se,form:ce,className:me})))))))},L_e=b.forwardRef(k_e),M_e=L_e,AH=()=>{const{status:e,errors:r=[],warnings:o=[]}=b.useContext(Il);return{status:e,errors:r,warnings:o}};AH.Context=Il;const F_e=AH;function U_e(e){const[r,o]=b.useState(e),s=b.useRef(null),c=b.useRef([]),d=b.useRef(!1);b.useEffect(()=>(d.current=!1,()=>{d.current=!0,ao.cancel(s.current),s.current=null}),[]);function f(m){d.current||(s.current===null&&(c.current=[],s.current=ao(()=>{s.current=null,o(g=>{let _=g;return c.current.forEach(S=>{_=S(_)}),_})})),c.current.push(m))}return[r,f]}function B_e(){const{itemRef:e}=b.useContext(Hu),r=b.useRef({});function o(s,c){const d=c&&typeof c=="object"&&c.ref,f=s.join("_");return(r.current.name!==f||r.current.originRef!==d)&&(r.current.name=f,r.current.originRef=d,r.current.ref=jc(e(s),d)),r.current.ref}return o}const j_e=e=>{const{prefixCls:r,status:o,wrapperCol:s,children:c,errors:d,warnings:f,_internalItemRender:m,extra:g,help:_,fieldId:S,marginBottom:T,onErrorVisibleChanged:R}=e,N=`${r}-item`,A=b.useContext(Hu),O=s||A.wrapperCol||{},M=Xe(`${N}-control`,O.className),x=b.useMemo(()=>Object.assign({},A),[A]);delete x.labelCol,delete x.wrapperCol;const P=b.createElement("div",{className:`${N}-control-input`},b.createElement("div",{className:`${N}-control-input-content`},c)),D=b.useMemo(()=>({prefixCls:r,status:o}),[r,o]),F=T!==null||d.length||f.length?b.createElement("div",{style:{display:"flex",flexWrap:"nowrap"}},b.createElement(Px.Provider,{value:D},b.createElement(RH,{fieldId:S,errors:d,warnings:f,help:_,helpStatus:o,className:`${N}-explain-connected`,onVisibleChanged:R})),!!T&&b.createElement("div",{style:{width:0,height:T}})):null,$={};S&&($.id=`${S}_extra`);const V=g?b.createElement("div",Object.assign({},$,{className:`${N}-extra`}),g):null,W=m&&m.mark==="pro_table_render"&&m.render?m.render(e,{input:P,errorList:F,extra:V}):b.createElement(b.Fragment,null,P,F,V);return b.createElement(Hu.Provider,{value:x},b.createElement(EH,Object.assign({},O,{className:M}),W))},V_e=j_e;var OH={};Object.defineProperty(OH,"__esModule",{value:!0});var $_e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"question-circle",theme:"outlined"},H_e=OH.default=$_e;function W_e(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function G_e(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){W_e(e,c,o[c])})}return e}function z_e(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function K_e(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z_e(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var Y_e=function(e,r){return b.createElement(Yi,K_e(G_e({},e),{ref:r,icon:H_e}))};const q_e=b.forwardRef(Y_e);var X_e=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function J_e(e){return e?typeof e=="object"&&!b.isValidElement(e)?e:{title:e}:null}const Q_e=e=>{let{prefixCls:r,label:o,htmlFor:s,labelCol:c,labelAlign:d,colon:f,required:m,requiredMark:g,tooltip:_}=e;var S;const[T]=B$("Form"),{vertical:R,labelAlign:N,labelCol:A,labelWrap:O,colon:M}=b.useContext(Hu);if(!o)return null;const x=c||A||{},P=d||N,D=`${r}-item-label`,F=Xe(D,P==="left"&&`${D}-left`,x.className,{[`${D}-wrap`]:!!O});let $=o;const V=f===!0||M!==!1&&f!==!1;V&&!R&&typeof o=="string"&&o.trim()!==""&&($=o.replace(/[:|ï¼]\s*$/,""));const K=J_e(_);if(K){const{icon:Y=b.createElement(q_e,null)}=K,ee=X_e(K,["icon"]),te=b.createElement(Zm,Object.assign({},ee),b.cloneElement(Y,{className:`${r}-item-tooltip`,title:""}));$=b.createElement(b.Fragment,null,$,te)}g==="optional"&&!m&&($=b.createElement(b.Fragment,null,$,b.createElement("span",{className:`${r}-item-optional`,title:""},(T==null?void 0:T.optional)||((S=cf.Form)===null||S===void 0?void 0:S.optional))));const Q=Xe({[`${r}-item-required`]:m,[`${r}-item-required-mark-optional`]:g==="optional",[`${r}-item-no-colon`]:!V});return b.createElement(EH,Object.assign({},x,{className:F}),b.createElement("label",{htmlFor:s,className:Q,title:typeof o=="string"?o:""},$))},Z_e=Q_e;var eye=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const tye={success:Y7,warning:Q7,error:MS,validating:r9};function nye(e){const{prefixCls:r,className:o,rootClassName:s,style:c,help:d,errors:f,warnings:m,validateStatus:g,meta:_,hasFeedback:S,hidden:T,children:R,fieldId:N,required:A,isRequired:O,onSubItemMetaChange:M}=e,x=eye(e,["prefixCls","className","rootClassName","style","help","errors","warnings","validateStatus","meta","hasFeedback","hidden","children","fieldId","required","isRequired","onSubItemMetaChange"]),P=`${r}-item`,{requiredMark:D}=b.useContext(Hu),F=b.useRef(null),$=Py(f),V=Py(m),W=d!=null,K=!!(W||f.length||m.length),Q=!!F.current&&US(F.current),[Y,ee]=b.useState(null);qr(()=>{if(K&&F.current){const se=getComputedStyle(F.current);ee(parseInt(se.marginBottom,10))}},[K,Q]);const te=se=>{se||ee(null)},le=function(){let se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,ae="";const ge=se?$:_.errors,Se=se?V:_.warnings;return g!==void 0?ae=g:_.validating?ae="validating":ge.length?ae="error":Se.length?ae="warning":(_.touched||S&&_.validated)&&(ae="success"),ae}(),me=b.useMemo(()=>{let se;if(S){const ae=le&&tye[le];se=ae?b.createElement("span",{className:Xe(`${P}-feedback-icon`,`${P}-feedback-icon-${le}`)},b.createElement(ae,null)):null}return{status:le,errors:f,warnings:m,hasFeedback:S,feedbackIcon:se,isFormItemInput:!0}},[le,S]),ce=Xe(P,o,s,{[`${P}-with-help`]:W||$.length||V.length,[`${P}-has-feedback`]:le&&S,[`${P}-has-success`]:le==="success",[`${P}-has-warning`]:le==="warning",[`${P}-has-error`]:le==="error",[`${P}-is-validating`]:le==="validating",[`${P}-hidden`]:T});return b.createElement("div",{className:ce,style:c,ref:F},b.createElement(NEe,Object.assign({className:`${P}-row`},ma(x,["_internalItemRender","colon","dependencies","extra","fieldKey","getValueFromEvent","getValueProps","htmlFor","id","initialValue","isListField","label","labelAlign","labelCol","labelWrap","messageVariables","name","normalize","noStyle","preserve","requiredMark","rules","shouldUpdate","trigger","tooltip","validateFirst","validateTrigger","valuePropName","wrapperCol"])),b.createElement(Z_e,Object.assign({htmlFor:N},e,{requiredMark:D,required:A??O,prefixCls:r})),b.createElement(V_e,Object.assign({},e,_,{errors:$,warnings:V,prefixCls:r,status:le,help:d,marginBottom:Y,onErrorVisibleChanged:te}),b.createElement(S9.Provider,{value:M},b.createElement(Il.Provider,{value:me},R)))),!!Y&&b.createElement("div",{className:`${P}-margin-offset`,style:{marginBottom:-Y}}))}function rye(e){if(typeof e=="function")return e;const r=Tl(e);return r.length<=1?r[0]:r}const iye="__SPLIT__",oye=b.memo(e=>{let{children:r}=e;return r},(e,r)=>e.value===r.value&&e.update===r.update&&e.childProps.length===r.childProps.length&&e.childProps.every((o,s)=>o===r.childProps[s]));function aye(e){return e!=null}function e6(){return{errors:[],warnings:[],touched:!1,validating:!1,name:[],validated:!1}}function sye(e){const{name:r,noStyle:o,className:s,dependencies:c,prefixCls:d,shouldUpdate:f,rules:m,children:g,required:_,label:S,messageVariables:T,trigger:R="onChange",validateTrigger:N,hidden:A,help:O}=e,{getPrefixCls:M}=b.useContext(or),{name:x}=b.useContext(Hu),P=rye(g),D=typeof P=="function",F=b.useContext(S9),{validateTrigger:$}=b.useContext(eh),V=N!==void 0?N:$,W=aye(r),K=M("form",d),[Q,Y]=Gx(K),ee=b.useContext(qm),te=b.useRef(),[ie,le]=U_e({}),[me,ce]=Kd(()=>e6()),se=ve=>{const ke=ee==null?void 0:ee.getKey(ve.name);if(ce(ve.destroy?e6():ve,!0),o&&O!==!1&&F){let Le=ve.name;if(ve.destroy)Le=te.current||Le;else if(ke!==void 0){const[$e,Ve]=ke;Le=[$e].concat(at(Ve)),te.current=Le}F(ve,Le)}},ae=(ve,ke)=>{le(Le=>{const $e=Object.assign({},Le),ut=[].concat(at(ve.name.slice(0,-1)),at(ke)).join(iye);return ve.destroy?delete $e[ut]:$e[ut]=ve,$e})},[ge,Se]=b.useMemo(()=>{const ve=at(me.errors),ke=at(me.warnings);return Object.values(ie).forEach(Le=>{ve.push.apply(ve,at(Le.errors||[])),ke.push.apply(ke,at(Le.warnings||[]))}),[ve,ke]},[ie,me.errors,me.warnings]),de=B_e();function he(ve,ke,Le){return o&&!A?ve:b.createElement(nye,Object.assign({key:"row"},e,{className:Xe(s,Y),prefixCls:K,fieldId:ke,isRequired:Le,errors:ge,warnings:Se,meta:me,onSubItemMetaChange:ae}),ve)}if(!W&&!D&&!c)return Q(he(P));let be={};return typeof S=="string"?be.label=S:r&&(be.label=String(r)),T&&(be=Object.assign(Object.assign({},be),T)),Q(b.createElement(xx,Object.assign({},e,{messageVariables:be,trigger:R,validateTrigger:V,onMetaChange:se}),(ve,ke,Le)=>{const $e=wm(r).length&&ke?ke.name:[],Ve=wH($e,x),ut=_!==void 0?_:!!(m&&m.some(gt=>{if(gt&&typeof gt=="object"&&gt.required&&!gt.warningOnly)return!0;if(typeof gt=="function"){const kt=gt(Le);return kt&&kt.required&&!kt.warningOnly}return!1})),ht=Object.assign({},ve);let Ct=null;if(Array.isArray(P)&&W)Ct=P;else if(!(D&&(!(f||c)||W))){if(!(c&&!D&&!W))if($u(P)){const gt=Object.assign(Object.assign({},P.props),ht);if(gt.id||(gt.id=Ve),O||ge.length>0||Se.length>0||e.extra){const Lt=[];(O||ge.length>0)&&Lt.push(`${Ve}_help`),e.extra&&Lt.push(`${Ve}_extra`),gt["aria-describedby"]=Lt.join(" ")}ge.length>0&&(gt["aria-invalid"]="true"),ut&&(gt["aria-required"]="true"),Cf(P)&&(gt.ref=de($e,P)),new Set([].concat(at(wm(R)),at(wm(V)))).forEach(Lt=>{gt[Lt]=function(){for(var Yt,jt,He,dt,rt,et=arguments.length,lt=new Array(et),Dt=0;Dt<et;Dt++)lt[Dt]=arguments[Dt];(He=ht[Lt])===null||He===void 0||(Yt=He).call.apply(Yt,[ht].concat(lt)),(rt=(dt=P.props)[Lt])===null||rt===void 0||(jt=rt).call.apply(jt,[dt].concat(lt))}});const It=[gt["aria-required"],gt["aria-invalid"],gt["aria-describedby"]];Ct=b.createElement(oye,{value:ht[e.valuePropName||"value"],update:P,childProps:It},nc(P,gt))}else D&&(f||c)&&!W?Ct=P(Le):Ct=P}return he(Ct,Ve,ut)}))}const xH=sye;xH.useStatus=F_e;const cye=xH;var lye=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const uye=e=>{var{prefixCls:r,children:o}=e,s=lye(e,["prefixCls","children"]);const{getPrefixCls:c}=b.useContext(or),d=c("form",r),f=b.useMemo(()=>({prefixCls:d,status:"error"}),[d]);return b.createElement(v9,Object.assign({},s),(m,g,_)=>b.createElement(Px.Provider,{value:f},o(m.map(S=>Object.assign(Object.assign({},S),{fieldKey:S.key})),g,{errors:_.errors,warnings:_.warnings})))},dye=uye;function hye(){const{form:e}=b.useContext(Hu);return e}const Pl=M_e;Pl.Item=cye;Pl.List=dye;Pl.ErrorList=RH;Pl.useForm=IH;Pl.useFormInstance=hye;Pl.useWatch=y9;Pl.Provider=C9;Pl.create=()=>{};const t6=Pl,Cg=Vve;Cg.Header=Uve;Cg.Footer=Bve;Cg.Content=jve;Cg.Sider=Gve;const zA=Cg;let Ks=null,F_=e=>e(),Dy=[],ky={};function pye(){const{prefixCls:e,getContainer:r,rtl:o,maxCount:s,top:c,bottom:d}=ky,f=e??f7().getPrefixCls("notification"),m=(r==null?void 0:r())||document.body;return{prefixCls:f,container:m,rtl:o,maxCount:s,top:c,bottom:d}}const fye=b.forwardRef((e,r)=>{const[o,s]=b.useState(),[c,d]=b.useState(),[f,m]=b.useState(),[g,_]=b.useState(),[S,T]=b.useState(),[R,N]=b.useState(),[A,O]=O9({prefixCls:o,getContainer:()=>c,maxCount:f,rtl:g,top:S,bottom:R}),M=f7(),x=M.getRootPrefixCls(),P=M.getIconPrefixCls(),D=M.getTheme(),F=()=>{const{prefixCls:$,container:V,maxCount:W,rtl:K,top:Q,bottom:Y}=pye();s($),d(V),m(W),_(K),T(Q),N(Y)};return b.useEffect(F,[]),b.useImperativeHandle(r,()=>{const $=Object.assign({},A);return Object.keys($).forEach(V=>{$[V]=function(){return F(),A[V].apply(A,arguments)}}),{instance:$,sync:F}}),b.createElement(wf,{prefixCls:x,iconPrefixCls:P,theme:D},O)});function zx(){if(!Ks){const e=document.createDocumentFragment(),r={fragment:e};Ks=r,F_(()=>{i9(b.createElement(fye,{ref:o=>{const{instance:s,sync:c}=o||{};Promise.resolve().then(()=>{!r.instance&&s&&(r.instance=s,r.sync=c,zx())})}}),e)});return}Ks.instance&&(Dy.forEach(e=>{switch(e.type){case"open":{F_(()=>{Ks.instance.open(Object.assign(Object.assign({},ky),e.config))});break}case"destroy":F_(()=>{Ks==null||Ks.instance.destroy(e.key)});break}}),Dy=[])}function mye(e){ky=Object.assign(Object.assign({},ky),e),F_(()=>{var r;(r=Ks==null?void 0:Ks.sync)===null||r===void 0||r.call(Ks)})}function NH(e){Dy.push({type:"open",config:e}),zx()}function gye(e){Dy.push({type:"destroy",key:e}),zx()}const vye=["success","info","warning","error"],Eye={open:NH,destroy:gye,config:mye,useNotification:Y0e,_InternalPanelDoNotUseOrYouWillBeFired:$0e},PH=Eye;vye.forEach(e=>{PH[e]=r=>NH(Object.assign(Object.assign({},r),{type:e}))});const _ye=PH;var DH={};Object.defineProperty(DH,"__esModule",{value:!0});var yye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"},Sye=DH.default=yye;function Cye(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function bye(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){Cye(e,c,o[c])})}return e}function Tye(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Rye(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tye(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var wye=function(e,r){return b.createElement(Yi,Rye(bye({},e),{ref:r,icon:Sye}))};const Iye=b.forwardRef(wye);var kH={};Object.defineProperty(kH,"__esModule",{value:!0});var Aye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"},Oye=kH.default=Aye;function xye(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function Nye(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){xye(e,c,o[c])})}return e}function Pye(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Dye(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pye(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var kye=function(e,r){return b.createElement(Yi,Dye(Nye({},e),{ref:r,icon:Oye}))};const Lye=b.forwardRef(kye);var LH={};Object.defineProperty(LH,"__esModule",{value:!0});var Mye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 170h-60c-4.4 0-8 3.6-8 8v518H310v-73c0-6.7-7.8-10.5-13-6.3l-141.9 112a8 8 0 000 12.6l141.9 112c5.3 4.2 13 .4 13-6.3v-75h498c35.3 0 64-28.7 64-64V178c0-4.4-3.6-8-8-8z"}}]},name:"enter",theme:"outlined"},Fye=LH.default=Mye;function Uye(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function Bye(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){Uye(e,c,o[c])})}return e}function jye(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Vye(e,r){return r=r??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jye(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}),e}var $ye=function(e,r){return b.createElement(Yi,Vye(Bye({},e),{ref:r,icon:Fye}))};const Hye=b.forwardRef($ye);var Wye=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const Gye={border:0,background:"transparent",padding:0,lineHeight:"inherit",display:"inline-block"},zye=b.forwardRef((e,r)=>{const o=_=>{const{keyCode:S}=_;S===bt.ENTER&&_.preventDefault()},s=_=>{const{keyCode:S}=_,{onClick:T}=e;S===bt.ENTER&&T&&T()},{style:c,noStyle:d,disabled:f}=e,m=Wye(e,["style","noStyle","disabled"]);let g={};return d||(g=Object.assign({},Gye)),f&&(g.pointerEvents="none"),g=Object.assign(Object.assign({},g),c),b.createElement("div",Object.assign({role:"button",tabIndex:0,ref:r},m,{onKeyDown:o,onKeyUp:s,style:g}))}),n6=zye;var Kye=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var r=document.activeElement,o=[],s=0;s<e.rangeCount;s++)o.push(e.getRangeAt(s));switch(r.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":r.blur();break;default:r=null;break}return e.removeAllRanges(),function(){e.type==="Caret"&&e.removeAllRanges(),e.rangeCount||o.forEach(function(c){e.addRange(c)}),r&&r.focus()}},Yye=Kye,r6={"text/plain":"Text","text/html":"Url",default:"Text"},qye="Copy to clipboard: #{key}, Enter";function Xye(e){var r=(/mac os x/i.test(navigator.userAgent)?"â":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,r)}function Jye(e,r){var o,s,c,d,f,m,g=!1;r||(r={}),o=r.debug||!1;try{c=Yye(),d=document.createRange(),f=document.getSelection(),m=document.createElement("span"),m.textContent=e,m.ariaHidden="true",m.style.all="unset",m.style.position="fixed",m.style.top=0,m.style.clip="rect(0, 0, 0, 0)",m.style.whiteSpace="pre",m.style.webkitUserSelect="text",m.style.MozUserSelect="text",m.style.msUserSelect="text",m.style.userSelect="text",m.addEventListener("copy",function(S){if(S.stopPropagation(),r.format)if(S.preventDefault(),typeof S.clipboardData>"u"){o&&console.warn("unable to use e.clipboardData"),o&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var T=r6[r.format]||r6.default;window.clipboardData.setData(T,e)}else S.clipboardData.clearData(),S.clipboardData.setData(r.format,e);r.onCopy&&(S.preventDefault(),r.onCopy(S.clipboardData))}),document.body.appendChild(m),d.selectNodeContents(m),f.addRange(d);var _=document.execCommand("copy");if(!_)throw new Error("copy command was unsuccessful");g=!0}catch(S){o&&console.error("unable to copy using execCommand: ",S),o&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(r.format||"text",e),r.onCopy&&r.onCopy(window.clipboardData),g=!0}catch(T){o&&console.error("unable to copy using clipboardData: ",T),o&&console.error("falling back to prompt"),s=Xye("message"in r?r.message:qye),window.prompt(s,e)}}finally{f&&(typeof f.removeRange=="function"?f.removeRange(d):f.removeAllRanges()),m&&document.body.removeChild(m),c()}return g}var Qye=Jye;const Zye=Ol(Qye),eSe=(e,r,o,s)=>{const{titleMarginBottom:c,fontWeightStrong:d}=s;return{marginBottom:c,color:o,fontWeight:d,fontSize:e,lineHeight:r}},tSe=e=>{const r=[1,2,3,4,5],o={};return r.forEach(s=>{o[`
      h${s}&,
      div&-h${s},
      div&-h${s} > textarea,
      h${s}
    `]=eSe(e[`fontSizeHeading${s}`],e[`lineHeightHeading${s}`],e.colorTextHeading,e)}),o},nSe=e=>{const{componentCls:r}=e;return{"a&, a":Object.assign(Object.assign({},K$(e)),{textDecoration:e.linkDecoration,"&:active, &:hover":{textDecoration:e.linkHoverDecoration},[`&[disabled], &${r}-disabled`]:{color:e.colorTextDisabled,cursor:"not-allowed","&:active, &:hover":{color:e.colorTextDisabled},"&:active":{pointerEvents:"none"}}})}},rSe=e=>({code:{margin:"0 0.2em",paddingInline:"0.4em",paddingBlock:"0.2em 0.1em",fontSize:"85%",fontFamily:e.fontFamilyCode,background:"rgba(150, 150, 150, 0.1)",border:"1px solid rgba(100, 100, 100, 0.2)",borderRadius:3},kbd:{margin:"0 0.2em",paddingInline:"0.4em",paddingBlock:"0.15em 0.1em",fontSize:"90%",fontFamily:e.fontFamilyCode,background:"rgba(150, 150, 150, 0.06)",border:"1px solid rgba(100, 100, 100, 0.2)",borderBottomWidth:2,borderRadius:3},mark:{padding:0,backgroundColor:ble[2]},"u, ins":{textDecoration:"underline",textDecorationSkipInk:"auto"},"s, del":{textDecoration:"line-through"},strong:{fontWeight:600},"ul, ol":{marginInline:0,marginBlock:"0 1em",padding:0,li:{marginInline:"20px 0",marginBlock:0,paddingInline:"4px 0",paddingBlock:0}},ul:{listStyleType:"circle",ul:{listStyleType:"disc"}},ol:{listStyleType:"decimal"},"pre, blockquote":{margin:"1em 0"},pre:{padding:"0.4em 0.6em",whiteSpace:"pre-wrap",wordWrap:"break-word",background:"rgba(150, 150, 150, 0.1)",border:"1px solid rgba(100, 100, 100, 0.2)",borderRadius:3,fontFamily:e.fontFamilyCode,code:{display:"inline",margin:0,padding:0,fontSize:"inherit",fontFamily:"inherit",background:"transparent",border:0}},blockquote:{paddingInline:"0.6em 0",paddingBlock:0,borderInlineStart:"4px solid rgba(100, 100, 100, 0.2)",opacity:.85}}),iSe=e=>{const{componentCls:r}=e,s=gH(e).inputPaddingVertical+1;return{"&-edit-content":{position:"relative","div&":{insetInlineStart:-e.paddingSM,marginTop:-s,marginBottom:`calc(1em - ${s}px)`},[`${r}-edit-content-confirm`]:{position:"absolute",insetInlineEnd:e.marginXS+2,insetBlockEnd:e.marginXS,color:e.colorTextDescription,fontWeight:"normal",fontSize:e.fontSize,fontStyle:"normal",pointerEvents:"none"},textarea:{margin:"0!important",MozTransition:"none",height:"1em"}}}},oSe=e=>({"&-copy-success":{"\n    &,\n    &:hover,\n    &:focus":{color:e.colorSuccess}}}),aSe=()=>({"\n  a&-ellipsis,\n  span&-ellipsis\n  ":{display:"inline-block",maxWidth:"100%"},"&-single-line":{whiteSpace:"nowrap"},"&-ellipsis-single-line":{overflow:"hidden",textOverflow:"ellipsis","a&, span&":{verticalAlign:"bottom"}},"&-ellipsis-multiple-line":{display:"-webkit-box",overflow:"hidden",WebkitLineClamp:3,WebkitBoxOrient:"vertical"}}),sSe=e=>{const{componentCls:r,titleMarginTop:o}=e;return{[r]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:e.colorText,wordBreak:"break-word",lineHeight:e.lineHeight,[`&${r}-secondary`]:{color:e.colorTextDescription},[`&${r}-success`]:{color:e.colorSuccess},[`&${r}-warning`]:{color:e.colorWarning},[`&${r}-danger`]:{color:e.colorError,"a&:active, a&:focus":{color:e.colorErrorActive},"a&:hover":{color:e.colorErrorHover}},[`&${r}-disabled`]:{color:e.colorTextDisabled,cursor:"not-allowed",userSelect:"none"},"\n        div&,\n        p\n      ":{marginBottom:"1em"}},tSe(e)),{[`
      & + h1${r},
      & + h2${r},
      & + h3${r},
      & + h4${r},
      & + h5${r}
      `]:{marginTop:o},"\n      div,\n      ul,\n      li,\n      p,\n      h1,\n      h2,\n      h3,\n      h4,\n      h5":{"\n        + h1,\n        + h2,\n        + h3,\n        + h4,\n        + h5\n        ":{marginTop:o}}}),rSe(e)),nSe(e)),{[`
        ${r}-expand,
        ${r}-edit,
        ${r}-copy
      `]:Object.assign(Object.assign({},K$(e)),{marginInlineStart:e.marginXXS})}),iSe(e)),oSe(e)),aSe()),{"&-rtl":{direction:"rtl"}})}},MH=ac("Typography",e=>[sSe(e)],e=>({titleMarginTop:"1.2em",titleMarginBottom:"0.5em",fontWeightStrong:e.fontWeightStrong})),cSe=e=>{let{prefixCls:r,"aria-label":o,className:s,style:c,direction:d,maxLength:f,autoSize:m=!0,value:g,onSave:_,onCancel:S,onEnd:T,component:R,enterIcon:N=b.createElement(Hye,null)}=e;const A=b.useRef(null),O=b.useRef(!1),M=b.useRef(),[x,P]=b.useState(g);b.useEffect(()=>{P(g)},[g]),b.useEffect(()=>{if(A.current&&A.current.resizableTextArea){const{textArea:le}=A.current.resizableTextArea;le.focus();const{length:me}=le.value;le.setSelectionRange(me,me)}},[]);const D=le=>{let{target:me}=le;P(me.value.replace(/[\n\r]/g,""))},F=()=>{O.current=!0},$=()=>{O.current=!1},V=le=>{let{keyCode:me}=le;O.current||(M.current=me)},W=()=>{_(x.trim())},K=le=>{let{keyCode:me,ctrlKey:ce,altKey:se,metaKey:ae,shiftKey:ge}=le;M.current===me&&!O.current&&!ce&&!se&&!ae&&!ge&&(me===bt.ENTER?(W(),T==null||T()):me===bt.ESC&&S())},Q=()=>{W()},Y=R?`${r}-${R}`:"",[ee,te]=MH(r),ie=Xe(r,`${r}-edit-content`,{[`${r}-rtl`]:d==="rtl"},s,Y,te);return ee(b.createElement("div",{className:ie,style:c},b.createElement(TH,{ref:A,maxLength:f,value:x,onChange:D,onKeyDown:V,onKeyUp:K,onCompositionStart:F,onCompositionEnd:$,onBlur:Q,"aria-label":o,rows:1,autoSize:m}),N!==null?nc(N,{className:`${r}-edit-content-confirm`}):null))},lSe=cSe;var uSe=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const dSe=b.forwardRef((e,r)=>{var{prefixCls:o,component:s="article",className:c,rootClassName:d,setContentRef:f,children:m,direction:g}=e,_=uSe(e,["prefixCls","component","className","rootClassName","setContentRef","children","direction"]);const{getPrefixCls:S,direction:T}=b.useContext(or),R=g??T;let N=r;f&&(N=jc(r,f));const A=S("typography",o),[O,M]=MH(A),x=Xe(A,{[`${A}-rtl`]:R==="rtl"},c,d,M);return O(b.createElement(s,Object.assign({className:x,ref:N},_),m))}),FH=dSe;function tw(e,r){return b.useMemo(()=>{const o=!!e;return[o,Object.assign(Object.assign({},r),o&&typeof e=="object"?e:null)]},[e])}const hSe=(e,r)=>{const o=b.useRef(!1);b.useEffect(()=>{o.current?e():o.current=!0},r)},pSe=hSe;function UH(e){const r=typeof e;return r==="string"||r==="number"}function fSe(e){let r=0;return e.forEach(o=>{UH(o)?r+=String(o).length:r+=1}),r}function i6(e,r){let o=0;const s=[];for(let c=0;c<e.length;c+=1){if(o===r)return s;const d=e[c],m=UH(d)?String(d).length:1,g=o+m;if(g>r){const _=r-o;return s.push(String(d).slice(0,_)),s}s.push(d),o=g}return e}const mSe=0,s_=1,o6=2,nw=3,a6=4,gSe=e=>{let{enabledMeasure:r,children:o,text:s,width:c,fontSize:d,rows:f,onEllipsis:m}=e;const[[g,_,S],T]=b.useState([0,0,0]),[R,N]=b.useState(mSe),[A,O]=b.useState(0),M=b.useRef(null),x=b.useRef(null),P=b.useMemo(()=>Tl(s),[s]),D=b.useMemo(()=>fSe(P),[P]),F=b.useMemo(()=>!r||R!==nw?o(P,!1):o(i6(P,_),_<D),[r,R,o,P,_,D]);qr(()=>{r&&c&&d&&D&&(N(s_),T([0,Math.ceil(D/2),D]))},[r,c,d,s,D,f]),qr(()=>{var K;R===s_&&O(((K=M.current)===null||K===void 0?void 0:K.offsetHeight)||0)},[R]),qr(()=>{var K,Q;if(A){if(R===s_){const Y=((K=x.current)===null||K===void 0?void 0:K.offsetHeight)||0,ee=f*A;Y<=ee?(N(a6),m(!1)):N(o6)}else if(R===o6)if(g!==S){const Y=((Q=x.current)===null||Q===void 0?void 0:Q.offsetHeight)||0,ee=f*A;let te=g,ie=S;g===S-1?ie=g:Y<=ee?te=_:ie=_;const le=Math.ceil((te+ie)/2);T([te,le,ie])}else N(nw),m(!0)}},[R,g,S,f,A]);const $={width:c,whiteSpace:"normal",margin:0,padding:0},V=(K,Q,Y)=>b.createElement("span",{"aria-hidden":!0,ref:Q,style:Object.assign({position:"fixed",display:"block",left:0,top:0,zIndex:-9999,visibility:"hidden",pointerEvents:"none",fontSize:Math.floor(d/2)*2},Y)},K),W=(K,Q)=>{const Y=i6(P,K);return V(o(Y,!0),Q,$)};return b.createElement(b.Fragment,null,F,r&&R!==nw&&R!==a6&&b.createElement(b.Fragment,null,V("lg",M,{wordBreak:"keep-all",whiteSpace:"nowrap"}),R===s_?V(o(P,!1),x,$):W(_,x)))},vSe=gSe,ESe=e=>{let{enabledEllipsis:r,isEllipsis:o,children:s,tooltipProps:c}=e;return!(c!=null&&c.title)||!r?s:b.createElement(Zm,Object.assign({open:o?void 0:!1},c),s)},_Se=ESe;var ySe=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function SSe(e,r){let{mark:o,code:s,underline:c,delete:d,strong:f,keyboard:m,italic:g}=e,_=r;function S(T,R){R&&(_=b.createElement(T,{},_))}return S("strong",f),S("u",c),S("del",d),S("code",s),S("mark",o),S("kbd",m),S("i",g),_}function c_(e,r,o){return e===!0||e===void 0?r:e||o&&r}function s6(e){return e===!1?[!1,!1]:Array.isArray(e)?e:[e]}const CSe="...",bSe=b.forwardRef((e,r)=>{var o,s,c;const{prefixCls:d,className:f,style:m,type:g,disabled:_,children:S,ellipsis:T,editable:R,copyable:N,component:A,title:O}=e,M=ySe(e,["prefixCls","className","style","type","disabled","children","ellipsis","editable","copyable","component","title"]),{getPrefixCls:x,direction:P}=b.useContext(or),[D]=B$("Text"),F=b.useRef(null),$=b.useRef(null),V=x("typography",d),W=ma(M,["mark","code","delete","underline","strong","keyboard","italic"]),[K,Q]=tw(R),[Y,ee]=vl(!1,{value:Q.editing}),{triggerType:te=["icon"]}=Q,ie=tt=>{var Tt;tt&&((Tt=Q.onStart)===null||Tt===void 0||Tt.call(Q)),ee(tt)};pSe(()=>{var tt;Y||(tt=$.current)===null||tt===void 0||tt.focus()},[Y]);const le=tt=>{tt==null||tt.preventDefault(),ie(!0)},me=tt=>{var Tt;(Tt=Q.onChange)===null||Tt===void 0||Tt.call(Q,tt),ie(!1)},ce=()=>{var tt;(tt=Q.onCancel)===null||tt===void 0||tt.call(Q),ie(!1)},[se,ae]=tw(N),[ge,Se]=b.useState(!1),de=b.useRef(null),he={};ae.format&&(he.format=ae.format);const be=()=>{de.current&&clearTimeout(de.current)},ve=tt=>{var Tt;tt==null||tt.preventDefault(),tt==null||tt.stopPropagation(),Zye(ae.text||String(S)||"",he),Se(!0),be(),de.current=setTimeout(()=>{Se(!1)},3e3),(Tt=ae.onCopy)===null||Tt===void 0||Tt.call(ae,tt)};b.useEffect(()=>be,[]);const[ke,Le]=b.useState(!1),[$e,Ve]=b.useState(!1),[ut,ht]=b.useState(!1),[Ct,gt]=b.useState(!1),[kt,It]=b.useState(!1),[Lt,Yt]=b.useState(!0),[jt,He]=tw(T,{expandable:!1}),dt=jt&&!ut,{rows:rt=1}=He,et=b.useMemo(()=>!dt||He.suffix!==void 0||He.onEllipsis||He.expandable||K||se,[dt,He,K,se]);qr(()=>{jt&&!et&&(Le(uB("webkitLineClamp")),Ve(uB("textOverflow")))},[et,jt]);const lt=b.useMemo(()=>et?!1:rt===1?$e:ke,[et,$e,ke]),Dt=dt&&(lt?kt:Ct),Ht=dt&&rt===1&&lt,En=dt&&rt>1&&lt,Vt=tt=>{var Tt;ht(!0),(Tt=He.onExpand)===null||Tt===void 0||Tt.call(He,tt)},[vn,Un]=b.useState(0),[xn,Dr]=b.useState(0),ln=(tt,Tt)=>{let{offsetWidth:Rn}=tt;var Jt;Un(Rn),Dr(parseInt((Jt=window.getComputedStyle)===null||Jt===void 0?void 0:Jt.call(window,Tt).fontSize,10)||0)},Wr=tt=>{var Tt;gt(tt),Ct!==tt&&((Tt=He.onEllipsis)===null||Tt===void 0||Tt.call(He,tt))};b.useEffect(()=>{const tt=F.current;if(jt&&lt&&tt){const Tt=En?tt.offsetHeight<tt.scrollHeight:tt.offsetWidth<tt.scrollWidth;kt!==Tt&&It(Tt)}},[jt,lt,S,En,Lt]),b.useEffect(()=>{const tt=F.current;if(typeof IntersectionObserver>"u"||!tt||!lt||!dt)return;const Tt=new IntersectionObserver(()=>{Yt(!!tt.offsetParent)});return Tt.observe(tt),()=>{Tt.disconnect()}},[lt,dt]);let Gn={};He.tooltip===!0?Gn={title:(o=Q.text)!==null&&o!==void 0?o:S}:b.isValidElement(He.tooltip)?Gn={title:He.tooltip}:typeof He.tooltip=="object"?Gn=Object.assign({title:(s=Q.text)!==null&&s!==void 0?s:S},He.tooltip):Gn={title:He.tooltip};const zn=b.useMemo(()=>{const tt=Tt=>["string","number"].includes(typeof Tt);if(!(!jt||lt)){if(tt(Q.text))return Q.text;if(tt(S))return S;if(tt(O))return O;if(tt(Gn.title))return Gn.title}},[jt,lt,O,Gn.title,Dt]);if(Y)return b.createElement(lSe,{value:(c=Q.text)!==null&&c!==void 0?c:typeof S=="string"?S:"",onSave:me,onCancel:ce,onEnd:Q.onEnd,prefixCls:V,className:f,style:m,direction:P,component:A,maxLength:Q.maxLength,autoSize:Q.autoSize,enterIcon:Q.enterIcon});const on=()=>{const{expandable:tt,symbol:Tt}=He;if(!tt)return null;let Rn;return Tt?Rn=Tt:Rn=D==null?void 0:D.expand,b.createElement("a",{key:"expand",className:`${V}-expand`,onClick:Vt,"aria-label":D==null?void 0:D.expand},Rn)},Ai=()=>{if(!K)return;const{icon:tt,tooltip:Tt}=Q,Rn=Tl(Tt)[0]||(D==null?void 0:D.edit),Jt=typeof Rn=="string"?Rn:"";return te.includes("icon")?b.createElement(Zm,{key:"edit",title:Tt===!1?"":Rn},b.createElement(n6,{ref:$,className:`${V}-edit`,onClick:le,"aria-label":Jt},tt||b.createElement(Lye,{role:"button"}))):null},va=()=>{if(!se)return;const{tooltips:tt,icon:Tt}=ae,Rn=s6(tt),Jt=s6(Tt),Qt=ge?c_(Rn[1],D==null?void 0:D.copied):c_(Rn[0],D==null?void 0:D.copy),fr=ge?D==null?void 0:D.copied:D==null?void 0:D.copy,Kn=typeof Qt=="string"?Qt:fr;return b.createElement(Zm,{key:"copy",title:Qt},b.createElement(n6,{className:Xe(`${V}-copy`,ge&&`${V}-copy-success`),onClick:ve,"aria-label":Kn},ge?c_(Jt[1],b.createElement(Ame,null),!0):c_(Jt[0],b.createElement(Iye,null),!0)))},kr=tt=>[tt&&on(),Ai(),va()],Zn=tt=>[tt&&b.createElement("span",{"aria-hidden":!0,key:"ellipsis"},CSe),He.suffix,kr(tt)];return b.createElement(ah,{onResize:ln,disabled:!dt||lt},tt=>b.createElement(_Se,{tooltipProps:Gn,enabledEllipsis:dt,isEllipsis:Dt},b.createElement(FH,Object.assign({className:Xe({[`${V}-${g}`]:g,[`${V}-disabled`]:_,[`${V}-ellipsis`]:jt,[`${V}-single-line`]:dt&&rt===1,[`${V}-ellipsis-single-line`]:Ht,[`${V}-ellipsis-multiple-line`]:En},f),prefixCls:d,style:Object.assign(Object.assign({},m),{WebkitLineClamp:En?rt:void 0}),component:A,ref:jc(tt,F,r),direction:P,onClick:te.includes("text")?le:void 0,"aria-label":zn==null?void 0:zn.toString(),title:O},W),b.createElement(vSe,{enabledMeasure:dt&&!lt,text:S,rows:rt,width:vn,fontSize:xn,onEllipsis:Wr},(Tt,Rn)=>{let Jt=Tt;return Tt.length&&Rn&&zn&&(Jt=b.createElement("span",{key:"show-content","aria-hidden":!0},Jt)),SSe(e,b.createElement(b.Fragment,null,Jt,Zn(Rn)))}))))}),WS=bSe;var TSe=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const RSe=b.forwardRef((e,r)=>{var{ellipsis:o,rel:s}=e,c=TSe(e,["ellipsis","rel"]);const d=Object.assign(Object.assign({},c),{rel:s===void 0&&c.target==="_blank"?"noopener noreferrer":s});return delete d.navigate,b.createElement(WS,Object.assign({},d,{ref:r,ellipsis:!!o,component:"a"}))}),wSe=RSe,ISe=b.forwardRef((e,r)=>b.createElement(WS,Object.assign({ref:r},e,{component:"div"}))),ASe=ISe;var OSe=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const xSe=(e,r)=>{var{ellipsis:o}=e,s=OSe(e,["ellipsis"]);const c=b.useMemo(()=>o&&typeof o=="object"?ma(o,["expandable","rows"]):o,[o]);return b.createElement(WS,Object.assign({ref:r},s,{ellipsis:c,component:"span"}))},NSe=b.forwardRef(xSe);var PSe=globalThis&&globalThis.__rest||function(e,r){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)r.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const DSe=[1,2,3,4,5],kSe=b.forwardRef((e,r)=>{const{level:o=1}=e,s=PSe(e,["level"]);let c;return DSe.includes(o)?c=`h${o}`:c="h1",b.createElement(WS,Object.assign({ref:r},s,{component:c}))}),LSe=kSe,bg=FH;bg.Text=NSe;bg.Link=wSe;bg.Title=LSe;bg.Paragraph=ASe;const Ao=bg;function BH(e){var r,o,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e))for(r=0;r<e.length;r++)e[r]&&(o=BH(e[r]))&&(s&&(s+=" "),s+=o);else for(r in e)e[r]&&(s&&(s+=" "),s+=r);return s}function Kx(){for(var e,r,o=0,s="";o<arguments.length;)(e=arguments[o++])&&(r=BH(e))&&(s&&(s+=" "),s+=r);return s}const MSe=b.forwardRef(({className:e,children:r},o)=>ne.jsx("div",{className:Kx(e,"b-1 b-solid b-coolgray-6 rd of-hidden relative"),ref:o,style:{width:288,height:216},children:r})),Es=Object.assign(b.forwardRef(({className:e,children:r},o)=>ne.jsx("div",{className:Kx(e,"flex-1 p-10 p-t-4 flex gap-5"),ref:o,children:r})),{Item:MSe}),ni=({children:e})=>ne.jsx("div",{className:"h-screen flex flex-col",children:e}),Al=({children:e})=>ne.jsx("samp",{className:"z-2 inline-flex items-center gap-1 absolute bottom-0 bg-black c-white px-1 text-sm",children:e}),l_=14,u_=8,rw=8,iw=4;function FSe({volumeLevel:e=0,noise:r=.075,...o}){const[s,c]=b.useState(0);return b.useEffect(()=>{if(e&&r){const d=Math.max(0,Math.min(1,r)),f=setInterval(()=>{c(e+Math.random()*d*(Math.random()>.5?1:-1))},50);return()=>clearInterval(f)}},[e,r]),ne.jsxs("svg",{fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...o,children:[ne.jsx("defs",{children:ne.jsx("clipPath",{id:"icon-mic-v-clip",children:ne.jsx("rect",{height:l_,rx:u_/2,width:u_,x:rw,y:iw})})}),ne.jsx("path",{d:"M0 0h24v24H0z",fill:"#999CA3",opacity:".01"}),ne.jsx("rect",{clipPath:"url(#icon-mic-v-clip)",fill:"#fff",height:l_,width:u_,x:rw,y:iw}),ne.jsx("path",{d:"M4 16.625h2v-1.25H4v1.25Zm6 4h4v-1.25h-4v1.25Zm8-4h2v-1.25h-2v1.25Zm-4 4A4.625 4.625 0 0 0 18.625 16h-1.25A3.375 3.375 0 0 1 14 19.375v1.25ZM5.375 16A4.625 4.625 0 0 0 10 20.625v-1.25A3.375 3.375 0 0 1 6.625 16h-1.25Z",fill:"#fff"}),ne.jsx("g",{clipPath:"url(#icon-mic-v-clip)",children:ne.jsx("rect",{fill:"#44AD00",height:l_*2,style:{transform:`translateY(${(1-s)*l_}px)`,transition:"transform .1s"},width:u_,x:rw,y:iw})})]})}const USe=b.memo(function(r){return ne.jsxs("svg",{fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...r,children:[ne.jsx("path",{d:"m5 5 14 14",stroke:"rgb(225, 225, 225, 0.35)",strokeLinejoin:"round",strokeWidth:"1.25"}),ne.jsx("path",{clipRule:"evenodd",d:"M19.277 16.625H20v-1.25h-1.973l1.25 1.25Zm-3.239 2.065.89.89a4.602 4.602 0 0 1-2.716 1.04l-.212.005h-4a4.626 4.626 0 0 1-4.55-3.787l-.033-.213H4v-1.25h2c.345 0 .625.28.625.625a3.375 3.375 0 0 0 3.19 3.37l.185.005h4a3.36 3.36 0 0 0 2.038-.685Zm.587-4.717V8a4.625 4.625 0 0 0-8.5-2.526l.911.91a3.374 3.374 0 0 1 6.281.991H14v1.25h1.375v.75H14v1.25h1.375v.75h-1.348l1.25 1.25h.098v.098l1.25 1.25Zm-2.587 2.717.89.89A4.625 4.625 0 0 1 7.375 14v-3.973l1.25 1.25v.098h.098l1.25 1.25H8.625V14a3.375 3.375 0 0 0 5.413 2.69Z",fill:"rgb(225, 225, 225, 0.35)",fillRule:"evenodd"})]})}),BSe=b.memo(function(r){return ne.jsxs("svg",{fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...r,children:[ne.jsx("circle",{cx:"12",cy:"11",r:"7",stroke:"#fff",strokeLinejoin:"round",strokeWidth:"1.25"}),ne.jsx("circle",{cx:"12",cy:"11",r:"3",stroke:"#fff",strokeLinejoin:"round",strokeWidth:"1.25"}),ne.jsx("circle",{cx:"14.625",cy:"6.625",fill:"#fff",r:".625"}),ne.jsx("path",{d:"M7 18.25a8.004 8.004 0 0 0 10 0",stroke:"#fff",strokeLinejoin:"round",strokeWidth:"1.25"})]})}),jSe=b.memo(function(r){return ne.jsxs("svg",{fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...r,children:[ne.jsx("path",{d:"m5 5 14 14",stroke:"rgb(225, 225, 225, 0.35)",strokeLinejoin:"round",strokeWidth:"1.25"}),ne.jsx("path",{clipRule:"evenodd",d:"m15.72 18.373.91.909a8.63 8.63 0 0 1-9.788-.364l-.232-.18.78-.976a7.38 7.38 0 0 0 8.33.61Zm2.434-2.87A7.625 7.625 0 0 0 7.497 4.846l.897.896a6.375 6.375 0 0 1 8.864 8.864l.896.897Zm-3.857 1.446.952.951A7.625 7.625 0 0 1 5.1 7.751l.951.952a6.375 6.375 0 0 0 8.246 8.246Zm.956-4.348a3.625 3.625 0 0 0-4.854-4.854l.964.964a2.378 2.378 0 0 1 2.926 2.926l.964.964Zm-.628-5.351a.625.625 0 1 0 0-1.25.625.625 0 0 0 0 1.25Z",fill:"rgb(225, 225, 225, 0.35)",fillRule:"evenodd"})]})});function VSe({track:e,deviceId:r,...o}){const s=Hy(e);return b.useEffect(()=>{s&&r!=null&&s.setDevice(r).catch(console.warn)},[r,s]),ne.jsx(Gy,{track:e,...o})}function $Se({track:e,deviceId:r,...o}){const s=Hy(e);return b.useEffect(()=>{s&&r!=null&&s.setDevice(r).catch(console.warn)},[r,s]),ne.jsx(ag,{track:e,...o})}function Yx({micOn:e,cameraOn:r,audioTrack:o,videoTrack:s,playAudio:c=!1,playVideo:d,micDeviceId:f,cameraDeviceId:m,volume:g,cover:_,children:S,style:T,...R}){const N=gf(zy,T);return d=d??!!r,c=c??!!e,ne.jsxs("div",{...R,style:N,children:[ne.jsx($Se,{deviceId:m,disabled:!r,play:d,track:s}),ne.jsx(VSe,{deviceId:f,disabled:!e,play:c,track:o,volume:g}),_&&!r&&ne.jsx(Ky,{cover:_}),ne.jsx("div",{style:og,children:S})]})}function Tg({track:e,playVideo:r,cover:o,client:s,style:c,children:d,...f}){var S,T;const m=gf(zy,c),_=(T=(S=Cs(s).remoteUsers)==null?void 0:S.find(R=>R.uid===(e==null?void 0:e.getUserId())))==null?void 0:T.hasVideo;return r=r??_,ne.jsxs("div",{...f,style:m,children:[ne.jsx(cO,{play:r,track:e}),o&&!r&&ne.jsx(Ky,{cover:o}),ne.jsx("div",{style:og,children:d})]})}const qx=({published:e,total:r})=>ne.jsx("div",{className:"p-4 text-xl",children:ne.jsxs("span",{className:"inline-flex items-center gap-1 py-2 px-3 rd b-1 b-solid",children:[ne.jsx("i",{className:"i-lucide-users"}),ne.jsxs("samp",{className:"text-base",children:[e,"/",r]})]})});var Xx={exports:{}};Xx.exports;(function(e){(function(r,o,s){function c(g){var _=this,S=m();_.next=function(){var T=2091639*_.s0+_.c*23283064365386963e-26;return _.s0=_.s1,_.s1=_.s2,_.s2=T-(_.c=T|0)},_.c=1,_.s0=S(" "),_.s1=S(" "),_.s2=S(" "),_.s0-=S(g),_.s0<0&&(_.s0+=1),_.s1-=S(g),_.s1<0&&(_.s1+=1),_.s2-=S(g),_.s2<0&&(_.s2+=1),S=null}function d(g,_){return _.c=g.c,_.s0=g.s0,_.s1=g.s1,_.s2=g.s2,_}function f(g,_){var S=new c(g),T=_&&_.state,R=S.next;return R.int32=function(){return S.next()*4294967296|0},R.double=function(){return R()+(R()*2097152|0)*11102230246251565e-32},R.quick=R,T&&(typeof T=="object"&&d(T,S),R.state=function(){return d(S,{})}),R}function m(){var g=4022871197,_=function(S){S=String(S);for(var T=0;T<S.length;T++){g+=S.charCodeAt(T);var R=.02519603282416938*g;g=R>>>0,R-=g,R*=g,g=R>>>0,R-=g,g+=R*4294967296}return(g>>>0)*23283064365386963e-26};return _}o&&o.exports?o.exports=f:s&&s.amd?s(function(){return f}):this.alea=f})(Ft,e,!1)})(Xx);var HSe=Xx.exports,Jx={exports:{}};Jx.exports;(function(e){(function(r,o,s){function c(m){var g=this,_="";g.x=0,g.y=0,g.z=0,g.w=0,g.next=function(){var T=g.x^g.x<<11;return g.x=g.y,g.y=g.z,g.z=g.w,g.w^=g.w>>>19^T^T>>>8},m===(m|0)?g.x=m:_+=m;for(var S=0;S<_.length+64;S++)g.x^=_.charCodeAt(S)|0,g.next()}function d(m,g){return g.x=m.x,g.y=m.y,g.z=m.z,g.w=m.w,g}function f(m,g){var _=new c(m),S=g&&g.state,T=function(){return(_.next()>>>0)/4294967296};return T.double=function(){do var R=_.next()>>>11,N=(_.next()>>>0)/4294967296,A=(R+N)/(1<<21);while(A===0);return A},T.int32=_.next,T.quick=T,S&&(typeof S=="object"&&d(S,_),T.state=function(){return d(_,{})}),T}o&&o.exports?o.exports=f:s&&s.amd?s(function(){return f}):this.xor128=f})(Ft,e,!1)})(Jx);var WSe=Jx.exports,Qx={exports:{}};Qx.exports;(function(e){(function(r,o,s){function c(m){var g=this,_="";g.next=function(){var T=g.x^g.x>>>2;return g.x=g.y,g.y=g.z,g.z=g.w,g.w=g.v,(g.d=g.d+362437|0)+(g.v=g.v^g.v<<4^(T^T<<1))|0},g.x=0,g.y=0,g.z=0,g.w=0,g.v=0,m===(m|0)?g.x=m:_+=m;for(var S=0;S<_.length+64;S++)g.x^=_.charCodeAt(S)|0,S==_.length&&(g.d=g.x<<10^g.x>>>4),g.next()}function d(m,g){return g.x=m.x,g.y=m.y,g.z=m.z,g.w=m.w,g.v=m.v,g.d=m.d,g}function f(m,g){var _=new c(m),S=g&&g.state,T=function(){return(_.next()>>>0)/4294967296};return T.double=function(){do var R=_.next()>>>11,N=(_.next()>>>0)/4294967296,A=(R+N)/(1<<21);while(A===0);return A},T.int32=_.next,T.quick=T,S&&(typeof S=="object"&&d(S,_),T.state=function(){return d(_,{})}),T}o&&o.exports?o.exports=f:s&&s.amd?s(function(){return f}):this.xorwow=f})(Ft,e,!1)})(Qx);var GSe=Qx.exports,Zx={exports:{}};Zx.exports;(function(e){(function(r,o,s){function c(m){var g=this;g.next=function(){var S=g.x,T=g.i,R,N;return R=S[T],R^=R>>>7,N=R^R<<24,R=S[T+1&7],N^=R^R>>>10,R=S[T+3&7],N^=R^R>>>3,R=S[T+4&7],N^=R^R<<7,R=S[T+7&7],R=R^R<<13,N^=R^R<<9,S[T]=N,g.i=T+1&7,N};function _(S,T){var R,N=[];if(T===(T|0))N[0]=T;else for(T=""+T,R=0;R<T.length;++R)N[R&7]=N[R&7]<<15^T.charCodeAt(R)+N[R+1&7]<<13;for(;N.length<8;)N.push(0);for(R=0;R<8&&N[R]===0;++R);for(R==8?N[7]=-1:N[R],S.x=N,S.i=0,R=256;R>0;--R)S.next()}_(g,m)}function d(m,g){return g.x=m.x.slice(),g.i=m.i,g}function f(m,g){m==null&&(m=+new Date);var _=new c(m),S=g&&g.state,T=function(){return(_.next()>>>0)/4294967296};return T.double=function(){do var R=_.next()>>>11,N=(_.next()>>>0)/4294967296,A=(R+N)/(1<<21);while(A===0);return A},T.int32=_.next,T.quick=T,S&&(S.x&&d(S,_),T.state=function(){return d(_,{})}),T}o&&o.exports?o.exports=f:s&&s.amd?s(function(){return f}):this.xorshift7=f})(Ft,e,!1)})(Zx);var zSe=Zx.exports,eN={exports:{}};eN.exports;(function(e){(function(r,o,s){function c(m){var g=this;g.next=function(){var S=g.w,T=g.X,R=g.i,N,A;return g.w=S=S+1640531527|0,A=T[R+34&127],N=T[R=R+1&127],A^=A<<13,N^=N<<17,A^=A>>>15,N^=N>>>12,A=T[R]=A^N,g.i=R,A+(S^S>>>16)|0};function _(S,T){var R,N,A,O,M,x=[],P=128;for(T===(T|0)?(N=T,T=null):(T=T+"\0",N=0,P=Math.max(P,T.length)),A=0,O=-32;O<P;++O)T&&(N^=T.charCodeAt((O+32)%T.length)),O===0&&(M=N),N^=N<<10,N^=N>>>15,N^=N<<4,N^=N>>>13,O>=0&&(M=M+1640531527|0,R=x[O&127]^=N+M,A=R==0?A+1:0);for(A>=128&&(x[(T&&T.length||0)&127]=-1),A=127,O=4*128;O>0;--O)N=x[A+34&127],R=x[A=A+1&127],N^=N<<13,R^=R<<17,N^=N>>>15,R^=R>>>12,x[A]=N^R;S.w=M,S.X=x,S.i=A}_(g,m)}function d(m,g){return g.i=m.i,g.w=m.w,g.X=m.X.slice(),g}function f(m,g){m==null&&(m=+new Date);var _=new c(m),S=g&&g.state,T=function(){return(_.next()>>>0)/4294967296};return T.double=function(){do var R=_.next()>>>11,N=(_.next()>>>0)/4294967296,A=(R+N)/(1<<21);while(A===0);return A},T.int32=_.next,T.quick=T,S&&(S.X&&d(S,_),T.state=function(){return d(_,{})}),T}o&&o.exports?o.exports=f:s&&s.amd?s(function(){return f}):this.xor4096=f})(Ft,e,!1)})(eN);var KSe=eN.exports,tN={exports:{}};tN.exports;(function(e){(function(r,o,s){function c(m){var g=this,_="";g.next=function(){var T=g.b,R=g.c,N=g.d,A=g.a;return T=T<<25^T>>>7^R,R=R-N|0,N=N<<24^N>>>8^A,A=A-T|0,g.b=T=T<<20^T>>>12^R,g.c=R=R-N|0,g.d=N<<16^R>>>16^A,g.a=A-T|0},g.a=0,g.b=0,g.c=-1640531527,g.d=1367130551,m===Math.floor(m)?(g.a=m/4294967296|0,g.b=m|0):_+=m;for(var S=0;S<_.length+20;S++)g.b^=_.charCodeAt(S)|0,g.next()}function d(m,g){return g.a=m.a,g.b=m.b,g.c=m.c,g.d=m.d,g}function f(m,g){var _=new c(m),S=g&&g.state,T=function(){return(_.next()>>>0)/4294967296};return T.double=function(){do var R=_.next()>>>11,N=(_.next()>>>0)/4294967296,A=(R+N)/(1<<21);while(A===0);return A},T.int32=_.next,T.quick=T,S&&(typeof S=="object"&&d(S,_),T.state=function(){return d(_,{})}),T}o&&o.exports?o.exports=f:s&&s.amd?s(function(){return f}):this.tychei=f})(Ft,e,!1)})(tN);var YSe=tN.exports,jH={exports:{}};(function(e){(function(r,o,s){var c=256,d=6,f=52,m="random",g=s.pow(c,d),_=s.pow(2,f),S=_*2,T=c-1,R;function N(F,$,V){var W=[];$=$==!0?{entropy:!0}:$||{};var K=x(M($.entropy?[F,D(o)]:F??P(),3),W),Q=new A(W),Y=function(){for(var ee=Q.g(d),te=g,ie=0;ee<_;)ee=(ee+ie)*c,te*=c,ie=Q.g(1);for(;ee>=S;)ee/=2,te/=2,ie>>>=1;return(ee+ie)/te};return Y.int32=function(){return Q.g(4)|0},Y.quick=function(){return Q.g(4)/4294967296},Y.double=Y,x(D(Q.S),o),($.pass||V||function(ee,te,ie,le){return le&&(le.S&&O(le,Q),ee.state=function(){return O(Q,{})}),ie?(s[m]=ee,te):ee})(Y,K,"global"in $?$.global:this==s,$.state)}function A(F){var $,V=F.length,W=this,K=0,Q=W.i=W.j=0,Y=W.S=[];for(V||(F=[V++]);K<c;)Y[K]=K++;for(K=0;K<c;K++)Y[K]=Y[Q=T&Q+F[K%V]+($=Y[K])],Y[Q]=$;(W.g=function(ee){for(var te,ie=0,le=W.i,me=W.j,ce=W.S;ee--;)te=ce[le=T&le+1],ie=ie*c+ce[T&(ce[le]=ce[me=T&me+te])+(ce[me]=te)];return W.i=le,W.j=me,ie})(c)}function O(F,$){return $.i=F.i,$.j=F.j,$.S=F.S.slice(),$}function M(F,$){var V=[],W=typeof F,K;if($&&W=="object")for(K in F)try{V.push(M(F[K],$-1))}catch{}return V.length?V:W=="string"?F:F+"\0"}function x(F,$){for(var V=F+"",W,K=0;K<V.length;)$[T&K]=T&(W^=$[T&K]*19)+V.charCodeAt(K++);return D($)}function P(){try{var F;return R&&(F=R.randomBytes)||(F=new Uint8Array(c),(r.crypto||r.msCrypto).getRandomValues(F)),D(F)}catch{var $=r.navigator,V=$&&$.plugins;return[+new Date,r,V,r.screen,D(o)]}}function D(F){return String.fromCharCode.apply(0,F)}x(s.random(),o),e.exports?e.exports=N:s["seed"+m]=N})(typeof self<"u"?self:Ft,[],Math)})(jH);var qSe=jH.exports,XSe=HSe,JSe=WSe,QSe=GSe,ZSe=zSe,eCe=KSe,tCe=YSe,lh=qSe;lh.alea=XSe;lh.xor128=JSe;lh.xorwow=QSe;lh.xorshift7=ZSe;lh.xor4096=eCe;lh.tychei=tCe;var nCe=lh;const VH=Ol(nCe);let $H=VH();function rCe(){return $H()}function c6(e){$H=VH(e)}function HH(e,r){const o=Array.isArray(e)?()=>iCe(e):e;return(r==null?void 0:r.length)===void 0?o(0):Array.from({length:r.length},(s,c)=>o(c))}function iCe(e){return e[Math.floor(rCe()*e.length)]}function oCe(e,r){return HH(e,r)}var l6={withAccents:{male:["AdriÃ¡n","Ãgir","Ãlvaro","AndrÃ©","AndrÃ©s","Ãrni","AsbjÃ¸rn","BjÃ¶rn","CÃ©sar","DanÃ­el","DavÃ­Ã°","EmÃ­lio","FaÃ±ch","FranÃ§ois","FrantiÅ¡ek","GÃ­sli","GÃ¶tz","GuÃ°jÃ³n","GuÃ°mundur","GÃ¼nter","HalldÃ³r","Hans-JÃ¶rg","Hans-JÃ¼rgen","HÃ¼seyin","IÃ±aki","JÃ¡nos","JesÃºs","JiÅÃ­","JÃ³hann","JÃ³hannes","JokÅ«bas","JÃ³n","JosÃ©","JÃ¶rn","JuliÃ£o","JÃ¼rgen","KristjÃ¡n","MaÃ«l","MagnÃºs","MathÃ©o","MÃ¡tyÃ¡s","MichaÅ","NoÃ«l","NuÃ±ez","Ãlafur","Ãscar","Ãyvind","PÃ¡ll","PaweÅ","PÃ©tur","RamÃ³n","RaÃºl","RenÃ©","RuairÃ­","RubÃ©n","SeÃ¡n","SÃ©rgio","SigurÃ°ur","SÃ¶nke","StefÃ¡n","TomÃ¡Å¡","Ãorsteinn"],female:["Ãdel","AgnÃ¨s","AlÃ­cia","Ãnne","AntÃ³nia","Ãsta","AuÃ°ur","CÃ¤cilia","ChloÃ«","ClaÃºdia","DÃ¶rte","ElÃ­n","ElÃ­sabet","EliÅ¡ka","FrantiÅ¡ka","GlÃ³ria","GraÅ¼yna","GuÃ°bjÃ¶rg","GuÃ°nÃ½","GuÃ°rÃºn","HenriÃ«tte","IngibjÃ¶rg","Ãris","JÃ³hanna","JÃ³na","JÃºlia","KÃ¤te","KatrÃ­n","KolbrÃºn","KristÃ­n","KÅ the","LetÃ­cia","LÃ­dia","LÃºcia","MaÅgorzata","MargrÃ©t","MarÃ­a","MÃ³nica","NatÃ¡lia","ÃlÃ¶f","PatrÃ­cia","RagnheiÃ°ur","RenÃ©e","RuÅ¾ena","SiÃ¢n","SigrÃ­Ã°ur","SigrÃºn","SÃ­lvia","SÃ¸rina","VÄra","VirgÃ­nia","ZoÃ«","ÃÃ³ra","ÃÃ³runn"]},withoutAccents:{male:["Abdul","Abdullahi","Abubakar","Adam","Adamu","Adiy","Ahmad","Ajay","Akira","Alan","Alberto","Alejandro","Aleksander","Aleksandr","Aleksey","Alex","Alexander","Alexey","Ali","Aliyu","Aminu","Amit","Amiyr","Amiyt","Amnuai","Amphon","Anah","Anan","Andreas","Andrew","Andrey","Andri","Andries","Andrzej","Anil","Anthony","Anton","Antonio","Arnar","Artur","Artyom","Arun","Ashok","Atli","Avraham","Bartosz","Bello","Bernd","Bin","Birgir","Bjarni","Blessing","Bongani","Brian","Bunmi","Carlos","Carol","Chan","Chao","Charles","Charoen","Chen","Cheng","Christian","Christopher","Colin","Daniel","Daniyel","Dariusz","David","Denis","Dennis","Diego","Dieter","Dilip","Dinesh","Dmitriy","Dmitry","Einar","Eliyahu","Emmanuel","Evgeniy","Fernando","Fran","Francis","Francisco","Francisco-Javier","Frank","Franz","Gang","Gareth","Gary","George","Gerhard","Graham","Grzegorz","Gunnar","Guy","Haim","Haiyan","Hans","Hans-Ulrich","Haruna","Hassan","Heike","Heinz","Helgi","Helmut","Hendrik","Herbert","Hideo","Hiromi","Hiroshi","Hong","Horst","Hui","Ian","Ibrahim","Idris","Igor","Ilya","Isa","Isaac","Isah","Ivan","Jabulani","Jacek","Jacobus","Jakub","James","Jan","Janusz","Javier","Jean","Jerzy","Jesus","Jason","Jianguo","Jianhua","Jianjun","Jianping","Jin","Joan","Johan","Johannes","John","Jonathan","Jorge","Jose","Jose-Antonio","Jose-Luis","Jose-Manuel","Jose-Maria","Josef","Joseph","Joyce","Juan","Kabiru","Kai","Kamil","Karen","Karl","Karl-Heinz","Katsumi","Kazuo","Kelvin","Kenji","Kenneth","Kevin","Kiran","Kirill","Kiyoshi","Kjartan","Klaus","Ko","Koichi","Koji","Konstantin","Koshi","Krishna","Kristinn","Krzysztof","Kun","Lakshmi","Lan","Laxmi","Lei","Li","Lihua","Lijun","Lilian","Lin","Ling","Liping","Liyor","Luis","Lukasz","Maciej","Mahmood","Maksim","Manfred","Manoj","Manuel","Marcin","Mardkhay","Marek","Mariusz","Mark","Martin","Masami","Masao","Mateusz","Matt","Matthew","Meiyr","Michael","Michal","Miguel","Miguel-Angel","Mikhail","Min","Ming","Mitsuo","Miykhael","Miykhal","Mo","Mohamed","Mohammad","Mohammed","Mohan","Moses","Moshe","Mpho","Muhammad","Muhammed","Mukesh","Musa","Narong","Nathan","Nicola","Nikita","Nikolay","Ning","Nkosinathi","Noam","Oleg","Omer","Otieno","Pablo","Patrick","Paul","Pavel","Pawel","Pedro","Peng","Peter","Petrus","Philip","Pieter","Ping","Piotr","Prasit","Prasoet","Pricha","Pushpa","Qiang","Qing","Radha","Rafael","Ragnar","Raj","Rajendra","Rajesh","Raju","Rakesh","Ram","Ramesh","Raphael","Rattana","Ravi","Richard","Robert","Roman","Rong","Roy","Ryan","Salisu","Saman","Samran","Samuel","Sani","Sanjay","Santosh","Sam","Sammy","Sawat","Sebastian","Sergey","Sergio","Shankar","Shay","Shigeru","Shimon","Shlomo","Shoji","Sibusiso","Simon","Sipho","Sombat","Sombun","Somchai","Somchit","Somkhit","Somkiat","Sommai","Somnuek","Somphon","Somphong","Somsak","Sri","Stefan","Stephen","Steve","Steven","Suman","Sunday","Sunil","Sunthon","Suresh","Sushila","Suwit","Sveinn","Tadashi","Takashi","Takeshi","Tal","Tebogo","Thabo","Thawi","Themba","Thomas","Thulani","Tomasz","Toshio","Udom","Umar","Uriy","Usman","Uwe","Victor","Vijay","Viktor","Vincent","Vinod","Vladimir","Walter","Wanchai","Waraphon","Wei","Werner","Wichai","Wichian","Willem","William","Winai","Wirat","Wirot","Wojciech","Wolfgang","Xiang","Xiaohong","Xiaoli","Xiaoping","Xiaoyan","Xin","Xolani","Yaakv","Yahaya","Yakubu","Yan","Yasuo","Yhudah","Ying","Yisrael","Yong","Yosef","Yoshie","Yoshimi","Yoshio","Yu","Yue","Yukio","Yun","Yuriy","Yusuf","Yuval","Zbigniew","Zhen","Zhiqiang"],female:["Agata","Agnieszka","Aisha","Akira","Aleksandra","Alina","Alyona","Amina","Amnuai","Ana","Ana-Maria","Anah","Anan","Anastasiya","Andrea","Angela","Anita","Ann","Anna","Anong","Antonia","Asha","Barbara","Beata","Berglind","Bin","Birgit","Birna","Blessing","Brigitte","Bunmi","Busisiwe","Carmen","Carol","Caroline","Catherine","Chan","Chanah","Chao","Charoen","Chayah","Chen","Cheng","Christa","Christine","Claire","Claudia","Cristina","Darya","Dolores","Dorota","Edda","Ekaterina","Elena","Elisabeth","Elizabeth","Elke","Emiko","Emma","Erika","Erla","Erna","Ester","Esther","Eunice","Eva","Eugenia","Ewa","Faith","Fatima","Fiona","Fran","Francisca","Fumiko","Galina","Gabra","Gisela","Gita","Grace","Hadiza","Haiyan","Hanna","Haruna","Hauwa","Heike","Helen","Helga","Hildur","Hiroko","Hiromi","Hisako","Hong","Hui","Hulda","Inga","Ingrid","Irina","Isa","Isabel","Isah","Iwona","Jackline","Jan","Jane","Janet","Jean","Jennifer","Jianhua","Jianping","Jin","Joan","Joanna","Johanna","Josefa","Joy","Joyce","Juan","Julie","Justyna","Kai","Kanchana","Karen","Karin","Karolina","Kasia","Katarzyna","Katsumi","Keiko","Kiran","Kiyoko","Kristina","Kseniya","Kun","Lakshmi","Lalita","Lan","Latda","Laura","Laxmi","Leah","Lei","Li","Lihua","Lijun","Lilian","Lilja","Lin","Linda","Lindiwe","Ling","Liping","Lisa","Lucia","Lucy","Lyubov","Lyudmila","Magda","Magdalena","Mali","Manju","Margaret","Maria","Maria-Isabel","Maria-Jose","Maria-Pilar","Marina","Mariya","Marta","Martha","Mary","Maryam","Masako","Masami","Mei","Mercy","Michal","Michiko","Mieko","Min","Mina","Ming","Miriam","Miyoko","Mo","Monika","Mpho","Na","Nadezhda","Nan","Nancy","Natalya","Ngozi","Nicola","Ning","Nittaya","Noam","Nobuko","Nokuthula","Nonhlanhla","Noriko","Nushi","Olga","Omer","Patricia","Paula","Paulina","Peng","Petra","Phonthip","Pilar","Ping","Prani","Purity","Pushpa","Qing","Rachel","Radha","Rattana","Rebecca","Reiko","Rekha","Renate","Rita","Rong","Rosa","Rose","Rut","Ruth","Ryoko","Sabine","Sachiko","Samran","Santosh","Sara","Sarah","Sam","Sammy","Sawat","Shanti","Sharon","Shay","Shizuko","Shoshanah","Sibongile","Sita","Sombat","Sombun","Somchit","Somkhit","Sommai","Somnuek","Somphon","Somphong","Sri","Steinunn","Sukanya","Suman","Sunday","Sunita","Suphaphon","Susan","Susanne","Sushila","Svetlana","Takako","Tamar","Tatyana","Tal","Tebogo","Teruko","Thawi","Tomiko","Toshiko","Unnur","Urai","Urmila","Ursula","Usha","Valentina","Victoria","Wanjiru","Wanphen","Watsana","Wei","Wilai","Xiang","Xiaohong","Xiaoli","Xiaoping","Xiaoyan","Xin","Yael","Yan","Yasuko","Yelena","Yhudiyt","Ying","Yoko","Yong","Yoshie","Yoshiko","Yoshimi","Yu","Yue","Yuko","Yuliya","Yun","Yuval","Zainab","Zandile","Zanele","Zhen"]}};function aCe(e){var r,o;const s=(r=e==null?void 0:e.withAccents)!=null&&r,c=(o=e==null?void 0:e.gender)!=null?o:oCe(["male","female"]),d=e==null?void 0:e.locale;return HH(s?d?d==null?void 0:d.withAccents[c]:l6.withAccents[c]:d?d==null?void 0:d.withoutAccents[c]:l6.withoutAccents[c],e)}var sCe={china:["Peking roasted duck","Kung pao chicken","Sweet and sour pork","Hot pot","Dim sum","Dumplings","Ma po tofu","Char siu","Chicken chow mein","Beef chow mein","vegetable chow mein","Chicken fried rice","Beef fried rice","Vegetable fried Rice","Special fried Rice","Sichuan pork","Xiaolongbao","Zhajiangmian","Wonton soup","Sweet and sour pork","Duck spring Rolls","Vegetable spring Rolls","Wonton","Peking duck","Lamb hot pot","Spicy crayfish","Guilin rice noodles","Lanzhou hand-pulled noodles","Steamed crab","Shredded pork with garlic sauce","Red braised pork","Sweet and sour Ribs","Xinjiang","Braised pork with vermicelli"],italy:["Butternut squash risotto","Mushroom risotto","Beetroot risotto","Courgette risotto","Pizza","Gnocchi","Spaghetti bolognese","Spaghetti carbonara","Pesto alla Genovese","Beef lasagne","Vegetable lasagne","Gelato","Prosciutto di Parma","Ribollita","Bagna cauda","Polenta","Tortelli and ravioli","Focaccia","Garlic bread","Arancini","Il tartufo","Panzerotto fritto","Fiorentina","Minestrone","Frico","Arrosticini","Olive ascolante","Fritto misto piemontes","TiramisÃ¹"],india:["Biryani","Dosa","Tandoori chicken","Samosas","Chaat","Plain naan","Garlic naan","Pilau rice","Steamed rice","Chicken madras","Vegetable madras","Chicken vindaloo","Chicken jalfrezi","Chicken roghan josh","Lamb roghan josh","Beef roghan josh","Butter chicken","Dosa","Gulab jamun","Chicken korma","Mutter paneer","Papadum","Paratha","Raita","Saag paneer","Tandoori chicken","Chicken tikka masala","Pakora","Dal","Chapati","Pasanda","Aloo gobi","Kofta","Chicken makhani","Paneer naan","Chana Aloo Curry"],mexico:["Chilaquiles","Pozole","Tacos al pastor","Tostadas","Chiles en nogada","Elote","Enchiladas","Mole","Guacamole","Tamales","Huevos rancheros","Machaca","Discada","Beef Burrito","Chicken Burrito","Pozole de pollo o duajolote","Menudo","Cochinita pibil","Tamale","Quesadilla","Frijoles puercos","Chile en nogada","Esquites","Alegria de amaranto","PipiÃ¡n","Aguachile","Ceviche","Pescado zarandeado","Camarones a la diabla","Birria de chivo","Tlayuda","Guacamole con chapulines","Flautas","Torta Ahogada","Carnitas","Caldo Azteca","Gorditas de Nata"],japan:["Sushi","Udon","Tofu","Tempura","Yakitori","Sashimi","Ramen","Donburi","Natto","Oden","Tamagoyaki","Soba","Tonkatsu","Kashipan","Sukiyaki","Miso soup","Okonomiyaki","Mentaiko","Nikujaga","Unagi no kabayaki","Shabu Shabu","Onigiri","Gyoza","Takoyaki","aiseki ryori","Edamame","Yakisoba","Chawanmushi","Wagashi"],france:["Foie gras","HuÃ®tres","Cassoulet","Poulet basquaise","Escargots au beurre persillÃ©","Mouclade charentaise","Galettes bretonnes","Flemish carbonnade","Quiche lorraine","Raclette","Cheese fondue","Beef fondue","Gratin dauphinois","Tartiflette","Bouillabaisse","Ratatouille","Boeuf bourguignon","Blanquette de veau","Pot-au-feu","Coq-au-vin","Hachis parmentier","Steak tartare","Choucroute","SoufflÃ© au fromage","Cuisses de grenouilles","Soupe Ã  lâoignon","Baguette","Croissant","French cheeses","Fondant au chocolat","Tarte tatin","Macarons","CrÃ¨me brÃ»lÃ©e","Ãle flottante","Profiteroles","Pain au chocolat"],lebanon:["Kibbeh","Kafta","Kanafeh","Hummus","Rice pilaf","Fattoush","Manakish","Tabbouleh","Sfeeha","Fattoush","Labneh","Muhammara","Lahm bi ajin","Kaak","Chanklich","Mssabaha","Shawarma","Kebbe","Falafel","Halewit el jeben","Namoura","Maamoul","Foul mdammas","Balila","Kawarma","Fattouch"],thailand:["Pad kra pao moo","Tom kha gai","Khao Pad","Chicken pad Thai","Vegetable pad Thai","Moo satay","Tom yum goong","Khao niew mamuang","Kai yad sai","Khao soi","Pad see ew","Laab moo","Gaeng panang","Gai pad med ma muang","Som tam","Poh pia tod","Gaeng massaman","Pla kapung nueng manao","Tod mun pla","Gaeng ped","Gaeng garee","Gaeng keow wan","Moo ping","Durian","Sai ooah","Hoy tod","Kuay teow reua","Mu kratha","Kao ka moo","Yam nua"],greece:["Moussaka","Papoutsakia","Pastitsio","Souvlaki","Soutzoukakia","Stifado","Tomatokeftedes","Tzatziki","Kolokithokeftedes","Giouvetsi","Choriatiki","Kleftiko","Gemista","Fasolada","Bougatsa","Tiropita","Spanakopita","Feta Cheese with Honey","Horta","Tirokroketes","Briam","Saganaki","Gigantes","Dolmades","Fasolatha","Koulouri","Loukoumades","Gyros","Galaktoboureko","Baklava"],turkey:["ÅiÅ kebap","DÃ¶ner","KÃ¶fte","Pide","Kumpir","Meze","MantÄ±","Lahmacun","Menemen","ÅiÅ kebap","Ä°skender kebab","Corba","Kuzu tandir","ÃiÄ KÃ¶fte","Pilav","Yaprak sarma","Dolma","Ä°mam bayÄ±ldÄ±","Borek","Durum","Kumpir","Balik ekmek","Simit","Kunefe","Baklava","Lokum","Halva","Mozzaik pasta","GÃ¼llaÃ§","Mercimek KÃ¶ftesi","Haydari","Tursu suyu","Kahvalti","Kazan dibi","Hunkar begendi","Islak burgers","Salep","Yogurtlu kebab"],spain:["Tortilla de patatas","Fabada asturiana","CalÃ§ots","Boquerones al vinagre","Empanada gallega","Paella","Gazpacho","Gachas","Migas","Bocadillo de calamares","Pulpo a feira","Caldo gallego","Lentejas con chorizo","Cocido madrileÃ±o","Cachopo","Caracoles"],venezuela:["PabellÃ³n criollo","Arepa","Mondongo","Empanadas","Quesillo","Chicha andina","TequeÃ±os","Cachapa","Hallaca","Perico","Pasticho","Mandocas","Caraotas negras","Patacones","Dulce de leche","Pan de JamÃ³n"],chile:["Humitas","Empanadas","Porotos con riendas","Completos","Manjar","Cordero al palo","Pastel de choclo","Mote con huesillos","Sopaipillas","Curanto"],argentina:["Milanesas","Empanadas","Pizza fugazeta","Asado","Choripan","Bondiola","Bife de chorizo"],colombia:["Bandeja paisa","Chuleta valluna","Sancocho trifÃ¡sico","Empanada valluna","Salpicon de frutas","Pastel de garbanzo","Ajiaco","Arepas","Arroz de lisa","Sancocho","Pan de bono","Cuchuco","Oblea","Cazuela de mariscos","Pan de yuca","Bollo Limpio","AlmojÃ¡bana","Empanadas","Arroz con Coco","Sopa de mondongo","Cazuela de Mariscos","Arroz con Pollo","Arepa de Huevo","Mote de Queso"],ecuador:["Encebollado","Ceviche","Tigrillo","Bolon de verde","Llapingacho","Mote pillo","Locro de papa","Churrasco"],peru:["Ceviche","Arroz con pollo","Aji de gallina","Llunca de gallina"],"el salvador":["Pupusa","Sopa de patas","Rigua","Flor de izote con huevo","Gallo en chicha"],romania:["Sarmale","Mici","Pomana porcului","CiorbÄ de fasole cu ciolan","CiorbÄ de burtÄ","CiorbÄ rÄdÄuÈeanÄ","PlÄcintÄ cu brÃ¢nzÄ","CiorbÄ de potroace","MÄmÄligÄ cu brÃ¢nzÄ Èi smÃ¢ntÃ¢nÄ","TochiturÄ","Piftie","Iahnie de fasole","SlÄninÄ afumatÄ","CÃ¢rnaÈi afumaÈi","VarzÄ a la Cluj","GulaÈ de cartofi cu afumÄturÄ","Cozonac de casÄ","CiorbÄ ardeleneascÄ de porc","Mucenici moldoveneÈti","SalatÄ de boeuf","Dovleac copt","PapanaÈi cu brÃ¢nzÄ de vacÄ Èi afine","Drob de miel","PÃ¢rjoale moldoveneÈti","ZacuscÄ de vinete","ZacuscÄ de fasole","TurtÄ dulce","ClÄtitele cu gem","ClÄtitele cu brÃ¢nza de vacÄ","BalmoÈ","Cozonac","Chiftele"]},u6;(u6=Object.keys(sCe))==null||u6.length;var d6,cCe={olympic:["Archery","Artistic Gymnastics","Artistic Swimming","Athletics","Badminton","Baseball Softball","Basketball","Beach Volleyball","BMX Freestyle","BMX Racing","Boxing","Kayak Flatwater","Kayak Slalom","Diving","Equestrian","Fencing","Football","Golf","Handball","Hockey","Judo","Karate","Marathon Swimming","Modern Pentathlon","Mountain Bike","Rhythmic Gymnastics","Road Cycling","Rowing","Rugby","Sailing","Shooting","Skateboarding","Sport Climbing","Surfing","Swimming","Table Tennis","Taekwondo","Tennis","Track Cycling","Trampoline","Triathlon","Volleyball","Water Polo","Weightlifting","Wrestling"],winterOlympic:["Alpine Skiing","Biathlon","Bobsleigh","Cross-Country Skiing","Curling","Figure Skating","Freestyle Skiing","Ice Hockey","Luge","Nordic Combined","Short Track Speed Skating","Skeleton","Ski Jumping","Snowboard","Speed Skating"],outdoor:["Archery","Athletics","Badminton","Baseball","Basketball","Bowling","Boxing","Camping","Canoeing","Climbing","Cricket","Curling","Cycling","Equestrian","Fencing","Football","Golf","Gymnastics","Handball","Hang Gliding","High Jumping","Hockey","Ice Hockey","Judo","Karate","Kite Flying","Monkey Bars","Motorsports","Netball","Rowing","Rugby","Running","Sailing","Skateboarding","Slide","Snow Skiing","Soccer","Street Hockey","Surfing","Swimming","Table Tennis","Tennis","Trekking","Triathlon","Volleyball","Weightlifting","Wrestling"]};(d6=Object.keys(cCe))==null||d6.length;var WH={exports:{}};function lCe(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ow={exports:{}};const uCe={},dCe=Object.freeze(Object.defineProperty({__proto__:null,default:uCe},Symbol.toStringTag,{value:"Module"})),hCe=Rre(dCe);var h6;function On(){return h6||(h6=1,function(e,r){(function(o,s){e.exports=s()})(Ft,function(){var o=o||function(s,c){var d;if(typeof window<"u"&&window.crypto&&(d=window.crypto),typeof self<"u"&&self.crypto&&(d=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(d=globalThis.crypto),!d&&typeof window<"u"&&window.msCrypto&&(d=window.msCrypto),!d&&typeof Ft<"u"&&Ft.crypto&&(d=Ft.crypto),!d&&typeof lCe=="function")try{d=hCe}catch{}var f=function(){if(d){if(typeof d.getRandomValues=="function")try{return d.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof d.randomBytes=="function")try{return d.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},m=Object.create||function(){function P(){}return function(D){var F;return P.prototype=D,F=new P,P.prototype=null,F}}(),g={},_=g.lib={},S=_.Base=function(){return{extend:function(P){var D=m(this);return P&&D.mixIn(P),(!D.hasOwnProperty("init")||this.init===D.init)&&(D.init=function(){D.$super.init.apply(this,arguments)}),D.init.prototype=D,D.$super=this,D},create:function(){var P=this.extend();return P.init.apply(P,arguments),P},init:function(){},mixIn:function(P){for(var D in P)P.hasOwnProperty(D)&&(this[D]=P[D]);P.hasOwnProperty("toString")&&(this.toString=P.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),T=_.WordArray=S.extend({init:function(P,D){P=this.words=P||[],D!=c?this.sigBytes=D:this.sigBytes=P.length*4},toString:function(P){return(P||N).stringify(this)},concat:function(P){var D=this.words,F=P.words,$=this.sigBytes,V=P.sigBytes;if(this.clamp(),$%4)for(var W=0;W<V;W++){var K=F[W>>>2]>>>24-W%4*8&255;D[$+W>>>2]|=K<<24-($+W)%4*8}else for(var Q=0;Q<V;Q+=4)D[$+Q>>>2]=F[Q>>>2];return this.sigBytes+=V,this},clamp:function(){var P=this.words,D=this.sigBytes;P[D>>>2]&=4294967295<<32-D%4*8,P.length=s.ceil(D/4)},clone:function(){var P=S.clone.call(this);return P.words=this.words.slice(0),P},random:function(P){for(var D=[],F=0;F<P;F+=4)D.push(f());return new T.init(D,P)}}),R=g.enc={},N=R.Hex={stringify:function(P){for(var D=P.words,F=P.sigBytes,$=[],V=0;V<F;V++){var W=D[V>>>2]>>>24-V%4*8&255;$.push((W>>>4).toString(16)),$.push((W&15).toString(16))}return $.join("")},parse:function(P){for(var D=P.length,F=[],$=0;$<D;$+=2)F[$>>>3]|=parseInt(P.substr($,2),16)<<24-$%8*4;return new T.init(F,D/2)}},A=R.Latin1={stringify:function(P){for(var D=P.words,F=P.sigBytes,$=[],V=0;V<F;V++){var W=D[V>>>2]>>>24-V%4*8&255;$.push(String.fromCharCode(W))}return $.join("")},parse:function(P){for(var D=P.length,F=[],$=0;$<D;$++)F[$>>>2]|=(P.charCodeAt($)&255)<<24-$%4*8;return new T.init(F,D)}},O=R.Utf8={stringify:function(P){try{return decodeURIComponent(escape(A.stringify(P)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(P){return A.parse(unescape(encodeURIComponent(P)))}},M=_.BufferedBlockAlgorithm=S.extend({reset:function(){this._data=new T.init,this._nDataBytes=0},_append:function(P){typeof P=="string"&&(P=O.parse(P)),this._data.concat(P),this._nDataBytes+=P.sigBytes},_process:function(P){var D,F=this._data,$=F.words,V=F.sigBytes,W=this.blockSize,K=W*4,Q=V/K;P?Q=s.ceil(Q):Q=s.max((Q|0)-this._minBufferSize,0);var Y=Q*W,ee=s.min(Y*4,V);if(Y){for(var te=0;te<Y;te+=W)this._doProcessBlock($,te);D=$.splice(0,Y),F.sigBytes-=ee}return new T.init(D,ee)},clone:function(){var P=S.clone.call(this);return P._data=this._data.clone(),P},_minBufferSize:0});_.Hasher=M.extend({cfg:S.extend(),init:function(P){this.cfg=this.cfg.extend(P),this.reset()},reset:function(){M.reset.call(this),this._doReset()},update:function(P){return this._append(P),this._process(),this},finalize:function(P){P&&this._append(P);var D=this._doFinalize();return D},blockSize:16,_createHelper:function(P){return function(D,F){return new P.init(F).finalize(D)}},_createHmacHelper:function(P){return function(D,F){return new x.HMAC.init(P,F).finalize(D)}}});var x=g.algo={};return g}(Math);return o})}(ow)),ow.exports}var aw={exports:{}},p6;function GS(){return p6||(p6=1,function(e,r){(function(o,s){e.exports=s(On())})(Ft,function(o){return function(s){var c=o,d=c.lib,f=d.Base,m=d.WordArray,g=c.x64={};g.Word=f.extend({init:function(_,S){this.high=_,this.low=S}}),g.WordArray=f.extend({init:function(_,S){_=this.words=_||[],S!=s?this.sigBytes=S:this.sigBytes=_.length*8},toX32:function(){for(var _=this.words,S=_.length,T=[],R=0;R<S;R++){var N=_[R];T.push(N.high),T.push(N.low)}return m.create(T,this.sigBytes)},clone:function(){for(var _=f.clone.call(this),S=_.words=this.words.slice(0),T=S.length,R=0;R<T;R++)S[R]=S[R].clone();return _}})}(),o})}(aw)),aw.exports}var sw={exports:{}},f6;function pCe(){return f6||(f6=1,function(e,r){(function(o,s){e.exports=s(On())})(Ft,function(o){return function(){if(typeof ArrayBuffer=="function"){var s=o,c=s.lib,d=c.WordArray,f=d.init,m=d.init=function(g){if(g instanceof ArrayBuffer&&(g=new Uint8Array(g)),(g instanceof Int8Array||typeof Uint8ClampedArray<"u"&&g instanceof Uint8ClampedArray||g instanceof Int16Array||g instanceof Uint16Array||g instanceof Int32Array||g instanceof Uint32Array||g instanceof Float32Array||g instanceof Float64Array)&&(g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength)),g instanceof Uint8Array){for(var _=g.byteLength,S=[],T=0;T<_;T++)S[T>>>2]|=g[T]<<24-T%4*8;f.call(this,S,_)}else f.apply(this,arguments)};m.prototype=d}}(),o.lib.WordArray})}(sw)),sw.exports}var cw={exports:{}},m6;function fCe(){return m6||(m6=1,function(e,r){(function(o,s){e.exports=s(On())})(Ft,function(o){return function(){var s=o,c=s.lib,d=c.WordArray,f=s.enc;f.Utf16=f.Utf16BE={stringify:function(g){for(var _=g.words,S=g.sigBytes,T=[],R=0;R<S;R+=2){var N=_[R>>>2]>>>16-R%4*8&65535;T.push(String.fromCharCode(N))}return T.join("")},parse:function(g){for(var _=g.length,S=[],T=0;T<_;T++)S[T>>>1]|=g.charCodeAt(T)<<16-T%2*16;return d.create(S,_*2)}},f.Utf16LE={stringify:function(g){for(var _=g.words,S=g.sigBytes,T=[],R=0;R<S;R+=2){var N=m(_[R>>>2]>>>16-R%4*8&65535);T.push(String.fromCharCode(N))}return T.join("")},parse:function(g){for(var _=g.length,S=[],T=0;T<_;T++)S[T>>>1]|=m(g.charCodeAt(T)<<16-T%2*16);return d.create(S,_*2)}};function m(g){return g<<8&4278255360|g>>>8&16711935}}(),o.enc.Utf16})}(cw)),cw.exports}var lw={exports:{}},g6;function uh(){return g6||(g6=1,function(e,r){(function(o,s){e.exports=s(On())})(Ft,function(o){return function(){var s=o,c=s.lib,d=c.WordArray,f=s.enc;f.Base64={stringify:function(g){var _=g.words,S=g.sigBytes,T=this._map;g.clamp();for(var R=[],N=0;N<S;N+=3)for(var A=_[N>>>2]>>>24-N%4*8&255,O=_[N+1>>>2]>>>24-(N+1)%4*8&255,M=_[N+2>>>2]>>>24-(N+2)%4*8&255,x=A<<16|O<<8|M,P=0;P<4&&N+P*.75<S;P++)R.push(T.charAt(x>>>6*(3-P)&63));var D=T.charAt(64);if(D)for(;R.length%4;)R.push(D);return R.join("")},parse:function(g){var _=g.length,S=this._map,T=this._reverseMap;if(!T){T=this._reverseMap=[];for(var R=0;R<S.length;R++)T[S.charCodeAt(R)]=R}var N=S.charAt(64);if(N){var A=g.indexOf(N);A!==-1&&(_=A)}return m(g,_,T)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function m(g,_,S){for(var T=[],R=0,N=0;N<_;N++)if(N%4){var A=S[g.charCodeAt(N-1)]<<N%4*2,O=S[g.charCodeAt(N)]>>>6-N%4*2,M=A|O;T[R>>>2]|=M<<24-R%4*8,R++}return d.create(T,R)}}(),o.enc.Base64})}(lw)),lw.exports}var uw={exports:{}},v6;function mCe(){return v6||(v6=1,function(e,r){(function(o,s){e.exports=s(On())})(Ft,function(o){return function(){var s=o,c=s.lib,d=c.WordArray,f=s.enc;f.Base64url={stringify:function(g,_){_===void 0&&(_=!0);var S=g.words,T=g.sigBytes,R=_?this._safe_map:this._map;g.clamp();for(var N=[],A=0;A<T;A+=3)for(var O=S[A>>>2]>>>24-A%4*8&255,M=S[A+1>>>2]>>>24-(A+1)%4*8&255,x=S[A+2>>>2]>>>24-(A+2)%4*8&255,P=O<<16|M<<8|x,D=0;D<4&&A+D*.75<T;D++)N.push(R.charAt(P>>>6*(3-D)&63));var F=R.charAt(64);if(F)for(;N.length%4;)N.push(F);return N.join("")},parse:function(g,_){_===void 0&&(_=!0);var S=g.length,T=_?this._safe_map:this._map,R=this._reverseMap;if(!R){R=this._reverseMap=[];for(var N=0;N<T.length;N++)R[T.charCodeAt(N)]=N}var A=T.charAt(64);if(A){var O=g.indexOf(A);O!==-1&&(S=O)}return m(g,S,R)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function m(g,_,S){for(var T=[],R=0,N=0;N<_;N++)if(N%4){var A=S[g.charCodeAt(N-1)]<<N%4*2,O=S[g.charCodeAt(N)]>>>6-N%4*2,M=A|O;T[R>>>2]|=M<<24-R%4*8,R++}return d.create(T,R)}}(),o.enc.Base64url})}(uw)),uw.exports}var dw={exports:{}},E6;function dh(){return E6||(E6=1,function(e,r){(function(o,s){e.exports=s(On())})(Ft,function(o){return function(s){var c=o,d=c.lib,f=d.WordArray,m=d.Hasher,g=c.algo,_=[];(function(){for(var O=0;O<64;O++)_[O]=s.abs(s.sin(O+1))*4294967296|0})();var S=g.MD5=m.extend({_doReset:function(){this._hash=new f.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(O,M){for(var x=0;x<16;x++){var P=M+x,D=O[P];O[P]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360}var F=this._hash.words,$=O[M+0],V=O[M+1],W=O[M+2],K=O[M+3],Q=O[M+4],Y=O[M+5],ee=O[M+6],te=O[M+7],ie=O[M+8],le=O[M+9],me=O[M+10],ce=O[M+11],se=O[M+12],ae=O[M+13],ge=O[M+14],Se=O[M+15],de=F[0],he=F[1],be=F[2],ve=F[3];de=T(de,he,be,ve,$,7,_[0]),ve=T(ve,de,he,be,V,12,_[1]),be=T(be,ve,de,he,W,17,_[2]),he=T(he,be,ve,de,K,22,_[3]),de=T(de,he,be,ve,Q,7,_[4]),ve=T(ve,de,he,be,Y,12,_[5]),be=T(be,ve,de,he,ee,17,_[6]),he=T(he,be,ve,de,te,22,_[7]),de=T(de,he,be,ve,ie,7,_[8]),ve=T(ve,de,he,be,le,12,_[9]),be=T(be,ve,de,he,me,17,_[10]),he=T(he,be,ve,de,ce,22,_[11]),de=T(de,he,be,ve,se,7,_[12]),ve=T(ve,de,he,be,ae,12,_[13]),be=T(be,ve,de,he,ge,17,_[14]),he=T(he,be,ve,de,Se,22,_[15]),de=R(de,he,be,ve,V,5,_[16]),ve=R(ve,de,he,be,ee,9,_[17]),be=R(be,ve,de,he,ce,14,_[18]),he=R(he,be,ve,de,$,20,_[19]),de=R(de,he,be,ve,Y,5,_[20]),ve=R(ve,de,he,be,me,9,_[21]),be=R(be,ve,de,he,Se,14,_[22]),he=R(he,be,ve,de,Q,20,_[23]),de=R(de,he,be,ve,le,5,_[24]),ve=R(ve,de,he,be,ge,9,_[25]),be=R(be,ve,de,he,K,14,_[26]),he=R(he,be,ve,de,ie,20,_[27]),de=R(de,he,be,ve,ae,5,_[28]),ve=R(ve,de,he,be,W,9,_[29]),be=R(be,ve,de,he,te,14,_[30]),he=R(he,be,ve,de,se,20,_[31]),de=N(de,he,be,ve,Y,4,_[32]),ve=N(ve,de,he,be,ie,11,_[33]),be=N(be,ve,de,he,ce,16,_[34]),he=N(he,be,ve,de,ge,23,_[35]),de=N(de,he,be,ve,V,4,_[36]),ve=N(ve,de,he,be,Q,11,_[37]),be=N(be,ve,de,he,te,16,_[38]),he=N(he,be,ve,de,me,23,_[39]),de=N(de,he,be,ve,ae,4,_[40]),ve=N(ve,de,he,be,$,11,_[41]),be=N(be,ve,de,he,K,16,_[42]),he=N(he,be,ve,de,ee,23,_[43]),de=N(de,he,be,ve,le,4,_[44]),ve=N(ve,de,he,be,se,11,_[45]),be=N(be,ve,de,he,Se,16,_[46]),he=N(he,be,ve,de,W,23,_[47]),de=A(de,he,be,ve,$,6,_[48]),ve=A(ve,de,he,be,te,10,_[49]),be=A(be,ve,de,he,ge,15,_[50]),he=A(he,be,ve,de,Y,21,_[51]),de=A(de,he,be,ve,se,6,_[52]),ve=A(ve,de,he,be,K,10,_[53]),be=A(be,ve,de,he,me,15,_[54]),he=A(he,be,ve,de,V,21,_[55]),de=A(de,he,be,ve,ie,6,_[56]),ve=A(ve,de,he,be,Se,10,_[57]),be=A(be,ve,de,he,ee,15,_[58]),he=A(he,be,ve,de,ae,21,_[59]),de=A(de,he,be,ve,Q,6,_[60]),ve=A(ve,de,he,be,ce,10,_[61]),be=A(be,ve,de,he,W,15,_[62]),he=A(he,be,ve,de,le,21,_[63]),F[0]=F[0]+de|0,F[1]=F[1]+he|0,F[2]=F[2]+be|0,F[3]=F[3]+ve|0},_doFinalize:function(){var O=this._data,M=O.words,x=this._nDataBytes*8,P=O.sigBytes*8;M[P>>>5]|=128<<24-P%32;var D=s.floor(x/4294967296),F=x;M[(P+64>>>9<<4)+15]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,M[(P+64>>>9<<4)+14]=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360,O.sigBytes=(M.length+1)*4,this._process();for(var $=this._hash,V=$.words,W=0;W<4;W++){var K=V[W];V[W]=(K<<8|K>>>24)&16711935|(K<<24|K>>>8)&4278255360}return $},clone:function(){var O=m.clone.call(this);return O._hash=this._hash.clone(),O}});function T(O,M,x,P,D,F,$){var V=O+(M&x|~M&P)+D+$;return(V<<F|V>>>32-F)+M}function R(O,M,x,P,D,F,$){var V=O+(M&P|x&~P)+D+$;return(V<<F|V>>>32-F)+M}function N(O,M,x,P,D,F,$){var V=O+(M^x^P)+D+$;return(V<<F|V>>>32-F)+M}function A(O,M,x,P,D,F,$){var V=O+(x^(M|~P))+D+$;return(V<<F|V>>>32-F)+M}c.MD5=m._createHelper(S),c.HmacMD5=m._createHmacHelper(S)}(Math),o.MD5})}(dw)),dw.exports}var hw={exports:{}},_6;function GH(){return _6||(_6=1,function(e,r){(function(o,s){e.exports=s(On())})(Ft,function(o){return function(){var s=o,c=s.lib,d=c.WordArray,f=c.Hasher,m=s.algo,g=[],_=m.SHA1=f.extend({_doReset:function(){this._hash=new d.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(S,T){for(var R=this._hash.words,N=R[0],A=R[1],O=R[2],M=R[3],x=R[4],P=0;P<80;P++){if(P<16)g[P]=S[T+P]|0;else{var D=g[P-3]^g[P-8]^g[P-14]^g[P-16];g[P]=D<<1|D>>>31}var F=(N<<5|N>>>27)+x+g[P];P<20?F+=(A&O|~A&M)+1518500249:P<40?F+=(A^O^M)+1859775393:P<60?F+=(A&O|A&M|O&M)-1894007588:F+=(A^O^M)-899497514,x=M,M=O,O=A<<30|A>>>2,A=N,N=F}R[0]=R[0]+N|0,R[1]=R[1]+A|0,R[2]=R[2]+O|0,R[3]=R[3]+M|0,R[4]=R[4]+x|0},_doFinalize:function(){var S=this._data,T=S.words,R=this._nDataBytes*8,N=S.sigBytes*8;return T[N>>>5]|=128<<24-N%32,T[(N+64>>>9<<4)+14]=Math.floor(R/4294967296),T[(N+64>>>9<<4)+15]=R,S.sigBytes=T.length*4,this._process(),this._hash},clone:function(){var S=f.clone.call(this);return S._hash=this._hash.clone(),S}});s.SHA1=f._createHelper(_),s.HmacSHA1=f._createHmacHelper(_)}(),o.SHA1})}(hw)),hw.exports}var pw={exports:{}},y6;function nN(){return y6||(y6=1,function(e,r){(function(o,s){e.exports=s(On())})(Ft,function(o){return function(s){var c=o,d=c.lib,f=d.WordArray,m=d.Hasher,g=c.algo,_=[],S=[];(function(){function N(x){for(var P=s.sqrt(x),D=2;D<=P;D++)if(!(x%D))return!1;return!0}function A(x){return(x-(x|0))*4294967296|0}for(var O=2,M=0;M<64;)N(O)&&(M<8&&(_[M]=A(s.pow(O,1/2))),S[M]=A(s.pow(O,1/3)),M++),O++})();var T=[],R=g.SHA256=m.extend({_doReset:function(){this._hash=new f.init(_.slice(0))},_doProcessBlock:function(N,A){for(var O=this._hash.words,M=O[0],x=O[1],P=O[2],D=O[3],F=O[4],$=O[5],V=O[6],W=O[7],K=0;K<64;K++){if(K<16)T[K]=N[A+K]|0;else{var Q=T[K-15],Y=(Q<<25|Q>>>7)^(Q<<14|Q>>>18)^Q>>>3,ee=T[K-2],te=(ee<<15|ee>>>17)^(ee<<13|ee>>>19)^ee>>>10;T[K]=Y+T[K-7]+te+T[K-16]}var ie=F&$^~F&V,le=M&x^M&P^x&P,me=(M<<30|M>>>2)^(M<<19|M>>>13)^(M<<10|M>>>22),ce=(F<<26|F>>>6)^(F<<21|F>>>11)^(F<<7|F>>>25),se=W+ce+ie+S[K]+T[K],ae=me+le;W=V,V=$,$=F,F=D+se|0,D=P,P=x,x=M,M=se+ae|0}O[0]=O[0]+M|0,O[1]=O[1]+x|0,O[2]=O[2]+P|0,O[3]=O[3]+D|0,O[4]=O[4]+F|0,O[5]=O[5]+$|0,O[6]=O[6]+V|0,O[7]=O[7]+W|0},_doFinalize:function(){var N=this._data,A=N.words,O=this._nDataBytes*8,M=N.sigBytes*8;return A[M>>>5]|=128<<24-M%32,A[(M+64>>>9<<4)+14]=s.floor(O/4294967296),A[(M+64>>>9<<4)+15]=O,N.sigBytes=A.length*4,this._process(),this._hash},clone:function(){var N=m.clone.call(this);return N._hash=this._hash.clone(),N}});c.SHA256=m._createHelper(R),c.HmacSHA256=m._createHmacHelper(R)}(Math),o.SHA256})}(pw)),pw.exports}var fw={exports:{}},S6;function gCe(){return S6||(S6=1,function(e,r){(function(o,s,c){e.exports=s(On(),nN())})(Ft,function(o){return function(){var s=o,c=s.lib,d=c.WordArray,f=s.algo,m=f.SHA256,g=f.SHA224=m.extend({_doReset:function(){this._hash=new d.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var _=m._doFinalize.call(this);return _.sigBytes-=4,_}});s.SHA224=m._createHelper(g),s.HmacSHA224=m._createHmacHelper(g)}(),o.SHA224})}(fw)),fw.exports}var mw={exports:{}},C6;function zH(){return C6||(C6=1,function(e,r){(function(o,s,c){e.exports=s(On(),GS())})(Ft,function(o){return function(){var s=o,c=s.lib,d=c.Hasher,f=s.x64,m=f.Word,g=f.WordArray,_=s.algo;function S(){return m.create.apply(m,arguments)}var T=[S(1116352408,3609767458),S(1899447441,602891725),S(3049323471,3964484399),S(3921009573,2173295548),S(961987163,4081628472),S(1508970993,3053834265),S(2453635748,2937671579),S(2870763221,3664609560),S(3624381080,2734883394),S(310598401,1164996542),S(607225278,1323610764),S(1426881987,3590304994),S(1925078388,4068182383),S(2162078206,991336113),S(2614888103,633803317),S(3248222580,3479774868),S(3835390401,2666613458),S(4022224774,944711139),S(264347078,2341262773),S(604807628,2007800933),S(770255983,1495990901),S(1249150122,1856431235),S(1555081692,3175218132),S(1996064986,2198950837),S(2554220882,3999719339),S(2821834349,766784016),S(2952996808,2566594879),S(3210313671,3203337956),S(3336571891,1034457026),S(3584528711,2466948901),S(113926993,3758326383),S(338241895,168717936),S(666307205,1188179964),S(773529912,1546045734),S(1294757372,1522805485),S(1396182291,2643833823),S(1695183700,2343527390),S(1986661051,1014477480),S(2177026350,1206759142),S(2456956037,344077627),S(2730485921,1290863460),S(2820302411,3158454273),S(3259730800,3505952657),S(3345764771,106217008),S(3516065817,3606008344),S(3600352804,1432725776),S(4094571909,1467031594),S(275423344,851169720),S(430227734,3100823752),S(506948616,1363258195),S(659060556,3750685593),S(883997877,3785050280),S(958139571,3318307427),S(1322822218,3812723403),S(1537002063,2003034995),S(1747873779,3602036899),S(1955562222,1575990012),S(2024104815,1125592928),S(2227730452,2716904306),S(2361852424,442776044),S(2428436474,593698344),S(2756734187,3733110249),S(3204031479,2999351573),S(3329325298,3815920427),S(3391569614,3928383900),S(3515267271,566280711),S(3940187606,3454069534),S(4118630271,4000239992),S(116418474,1914138554),S(174292421,2731055270),S(289380356,3203993006),S(460393269,320620315),S(685471733,587496836),S(852142971,1086792851),S(1017036298,365543100),S(1126000580,2618297676),S(1288033470,3409855158),S(1501505948,4234509866),S(1607167915,987167468),S(1816402316,1246189591)],R=[];(function(){for(var A=0;A<80;A++)R[A]=S()})();var N=_.SHA512=d.extend({_doReset:function(){this._hash=new g.init([new m.init(1779033703,4089235720),new m.init(3144134277,2227873595),new m.init(1013904242,4271175723),new m.init(2773480762,1595750129),new m.init(1359893119,2917565137),new m.init(2600822924,725511199),new m.init(528734635,4215389547),new m.init(1541459225,327033209)])},_doProcessBlock:function(A,O){for(var M=this._hash.words,x=M[0],P=M[1],D=M[2],F=M[3],$=M[4],V=M[5],W=M[6],K=M[7],Q=x.high,Y=x.low,ee=P.high,te=P.low,ie=D.high,le=D.low,me=F.high,ce=F.low,se=$.high,ae=$.low,ge=V.high,Se=V.low,de=W.high,he=W.low,be=K.high,ve=K.low,ke=Q,Le=Y,$e=ee,Ve=te,ut=ie,ht=le,Ct=me,gt=ce,kt=se,It=ae,Lt=ge,Yt=Se,jt=de,He=he,dt=be,rt=ve,et=0;et<80;et++){var lt,Dt,Ht=R[et];if(et<16)Dt=Ht.high=A[O+et*2]|0,lt=Ht.low=A[O+et*2+1]|0;else{var En=R[et-15],Vt=En.high,vn=En.low,Un=(Vt>>>1|vn<<31)^(Vt>>>8|vn<<24)^Vt>>>7,xn=(vn>>>1|Vt<<31)^(vn>>>8|Vt<<24)^(vn>>>7|Vt<<25),Dr=R[et-2],ln=Dr.high,Wr=Dr.low,Gn=(ln>>>19|Wr<<13)^(ln<<3|Wr>>>29)^ln>>>6,zn=(Wr>>>19|ln<<13)^(Wr<<3|ln>>>29)^(Wr>>>6|ln<<26),on=R[et-7],Ai=on.high,va=on.low,kr=R[et-16],Zn=kr.high,tt=kr.low;lt=xn+va,Dt=Un+Ai+(lt>>>0<xn>>>0?1:0),lt=lt+zn,Dt=Dt+Gn+(lt>>>0<zn>>>0?1:0),lt=lt+tt,Dt=Dt+Zn+(lt>>>0<tt>>>0?1:0),Ht.high=Dt,Ht.low=lt}var Tt=kt&Lt^~kt&jt,Rn=It&Yt^~It&He,Jt=ke&$e^ke&ut^$e&ut,Qt=Le&Ve^Le&ht^Ve&ht,fr=(ke>>>28|Le<<4)^(ke<<30|Le>>>2)^(ke<<25|Le>>>7),Kn=(Le>>>28|ke<<4)^(Le<<30|ke>>>2)^(Le<<25|ke>>>7),Mt=(kt>>>14|It<<18)^(kt>>>18|It<<14)^(kt<<23|It>>>9),dn=(It>>>14|kt<<18)^(It>>>18|kt<<14)^(It<<23|kt>>>9),kn=T[et],er=kn.high,Yn=kn.low,Qr=rt+dn,Oi=dt+Mt+(Qr>>>0<rt>>>0?1:0),Qr=Qr+Rn,Oi=Oi+Tt+(Qr>>>0<Rn>>>0?1:0),Qr=Qr+Yn,Oi=Oi+er+(Qr>>>0<Yn>>>0?1:0),Qr=Qr+lt,Oi=Oi+Dt+(Qr>>>0<lt>>>0?1:0),Ji=Kn+Qt,Ka=fr+Jt+(Ji>>>0<Kn>>>0?1:0);dt=jt,rt=He,jt=Lt,He=Yt,Lt=kt,Yt=It,It=gt+Qr|0,kt=Ct+Oi+(It>>>0<gt>>>0?1:0)|0,Ct=ut,gt=ht,ut=$e,ht=Ve,$e=ke,Ve=Le,Le=Qr+Ji|0,ke=Oi+Ka+(Le>>>0<Qr>>>0?1:0)|0}Y=x.low=Y+Le,x.high=Q+ke+(Y>>>0<Le>>>0?1:0),te=P.low=te+Ve,P.high=ee+$e+(te>>>0<Ve>>>0?1:0),le=D.low=le+ht,D.high=ie+ut+(le>>>0<ht>>>0?1:0),ce=F.low=ce+gt,F.high=me+Ct+(ce>>>0<gt>>>0?1:0),ae=$.low=ae+It,$.high=se+kt+(ae>>>0<It>>>0?1:0),Se=V.low=Se+Yt,V.high=ge+Lt+(Se>>>0<Yt>>>0?1:0),he=W.low=he+He,W.high=de+jt+(he>>>0<He>>>0?1:0),ve=K.low=ve+rt,K.high=be+dt+(ve>>>0<rt>>>0?1:0)},_doFinalize:function(){var A=this._data,O=A.words,M=this._nDataBytes*8,x=A.sigBytes*8;O[x>>>5]|=128<<24-x%32,O[(x+128>>>10<<5)+30]=Math.floor(M/4294967296),O[(x+128>>>10<<5)+31]=M,A.sigBytes=O.length*4,this._process();var P=this._hash.toX32();return P},clone:function(){var A=d.clone.call(this);return A._hash=this._hash.clone(),A},blockSize:1024/32});s.SHA512=d._createHelper(N),s.HmacSHA512=d._createHmacHelper(N)}(),o.SHA512})}(mw)),mw.exports}var gw={exports:{}},b6;function vCe(){return b6||(b6=1,function(e,r){(function(o,s,c){e.exports=s(On(),GS(),zH())})(Ft,function(o){return function(){var s=o,c=s.x64,d=c.Word,f=c.WordArray,m=s.algo,g=m.SHA512,_=m.SHA384=g.extend({_doReset:function(){this._hash=new f.init([new d.init(3418070365,3238371032),new d.init(1654270250,914150663),new d.init(2438529370,812702999),new d.init(355462360,4144912697),new d.init(1731405415,4290775857),new d.init(2394180231,1750603025),new d.init(3675008525,1694076839),new d.init(1203062813,3204075428)])},_doFinalize:function(){var S=g._doFinalize.call(this);return S.sigBytes-=16,S}});s.SHA384=g._createHelper(_),s.HmacSHA384=g._createHmacHelper(_)}(),o.SHA384})}(gw)),gw.exports}var vw={exports:{}},T6;function ECe(){return T6||(T6=1,function(e,r){(function(o,s,c){e.exports=s(On(),GS())})(Ft,function(o){return function(s){var c=o,d=c.lib,f=d.WordArray,m=d.Hasher,g=c.x64,_=g.Word,S=c.algo,T=[],R=[],N=[];(function(){for(var M=1,x=0,P=0;P<24;P++){T[M+5*x]=(P+1)*(P+2)/2%64;var D=x%5,F=(2*M+3*x)%5;M=D,x=F}for(var M=0;M<5;M++)for(var x=0;x<5;x++)R[M+5*x]=x+(2*M+3*x)%5*5;for(var $=1,V=0;V<24;V++){for(var W=0,K=0,Q=0;Q<7;Q++){if($&1){var Y=(1<<Q)-1;Y<32?K^=1<<Y:W^=1<<Y-32}$&128?$=$<<1^113:$<<=1}N[V]=_.create(W,K)}})();var A=[];(function(){for(var M=0;M<25;M++)A[M]=_.create()})();var O=S.SHA3=m.extend({cfg:m.cfg.extend({outputLength:512}),_doReset:function(){for(var M=this._state=[],x=0;x<25;x++)M[x]=new _.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(M,x){for(var P=this._state,D=this.blockSize/2,F=0;F<D;F++){var $=M[x+2*F],V=M[x+2*F+1];$=($<<8|$>>>24)&16711935|($<<24|$>>>8)&4278255360,V=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360;var W=P[F];W.high^=V,W.low^=$}for(var K=0;K<24;K++){for(var Q=0;Q<5;Q++){for(var Y=0,ee=0,te=0;te<5;te++){var W=P[Q+5*te];Y^=W.high,ee^=W.low}var ie=A[Q];ie.high=Y,ie.low=ee}for(var Q=0;Q<5;Q++)for(var le=A[(Q+4)%5],me=A[(Q+1)%5],ce=me.high,se=me.low,Y=le.high^(ce<<1|se>>>31),ee=le.low^(se<<1|ce>>>31),te=0;te<5;te++){var W=P[Q+5*te];W.high^=Y,W.low^=ee}for(var ae=1;ae<25;ae++){var Y,ee,W=P[ae],ge=W.high,Se=W.low,de=T[ae];de<32?(Y=ge<<de|Se>>>32-de,ee=Se<<de|ge>>>32-de):(Y=Se<<de-32|ge>>>64-de,ee=ge<<de-32|Se>>>64-de);var he=A[R[ae]];he.high=Y,he.low=ee}var be=A[0],ve=P[0];be.high=ve.high,be.low=ve.low;for(var Q=0;Q<5;Q++)for(var te=0;te<5;te++){var ae=Q+5*te,W=P[ae],ke=A[ae],Le=A[(Q+1)%5+5*te],$e=A[(Q+2)%5+5*te];W.high=ke.high^~Le.high&$e.high,W.low=ke.low^~Le.low&$e.low}var W=P[0],Ve=N[K];W.high^=Ve.high,W.low^=Ve.low}},_doFinalize:function(){var M=this._data,x=M.words;this._nDataBytes*8;var P=M.sigBytes*8,D=this.blockSize*32;x[P>>>5]|=1<<24-P%32,x[(s.ceil((P+1)/D)*D>>>5)-1]|=128,M.sigBytes=x.length*4,this._process();for(var F=this._state,$=this.cfg.outputLength/8,V=$/8,W=[],K=0;K<V;K++){var Q=F[K],Y=Q.high,ee=Q.low;Y=(Y<<8|Y>>>24)&16711935|(Y<<24|Y>>>8)&4278255360,ee=(ee<<8|ee>>>24)&16711935|(ee<<24|ee>>>8)&4278255360,W.push(ee),W.push(Y)}return new f.init(W,$)},clone:function(){for(var M=m.clone.call(this),x=M._state=this._state.slice(0),P=0;P<25;P++)x[P]=x[P].clone();return M}});c.SHA3=m._createHelper(O),c.HmacSHA3=m._createHmacHelper(O)}(Math),o.SHA3})}(vw)),vw.exports}var Ew={exports:{}},R6;function _Ce(){return R6||(R6=1,function(e,r){(function(o,s){e.exports=s(On())})(Ft,function(o){/** @preserve
			(c) 2012 by CÃ©dric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(s){var c=o,d=c.lib,f=d.WordArray,m=d.Hasher,g=c.algo,_=f.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),S=f.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),T=f.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),R=f.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),N=f.create([0,1518500249,1859775393,2400959708,2840853838]),A=f.create([1352829926,1548603684,1836072691,2053994217,0]),O=g.RIPEMD160=m.extend({_doReset:function(){this._hash=f.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(V,W){for(var K=0;K<16;K++){var Q=W+K,Y=V[Q];V[Q]=(Y<<8|Y>>>24)&16711935|(Y<<24|Y>>>8)&4278255360}var ee=this._hash.words,te=N.words,ie=A.words,le=_.words,me=S.words,ce=T.words,se=R.words,ae,ge,Se,de,he,be,ve,ke,Le,$e;be=ae=ee[0],ve=ge=ee[1],ke=Se=ee[2],Le=de=ee[3],$e=he=ee[4];for(var Ve,K=0;K<80;K+=1)Ve=ae+V[W+le[K]]|0,K<16?Ve+=M(ge,Se,de)+te[0]:K<32?Ve+=x(ge,Se,de)+te[1]:K<48?Ve+=P(ge,Se,de)+te[2]:K<64?Ve+=D(ge,Se,de)+te[3]:Ve+=F(ge,Se,de)+te[4],Ve=Ve|0,Ve=$(Ve,ce[K]),Ve=Ve+he|0,ae=he,he=de,de=$(Se,10),Se=ge,ge=Ve,Ve=be+V[W+me[K]]|0,K<16?Ve+=F(ve,ke,Le)+ie[0]:K<32?Ve+=D(ve,ke,Le)+ie[1]:K<48?Ve+=P(ve,ke,Le)+ie[2]:K<64?Ve+=x(ve,ke,Le)+ie[3]:Ve+=M(ve,ke,Le)+ie[4],Ve=Ve|0,Ve=$(Ve,se[K]),Ve=Ve+$e|0,be=$e,$e=Le,Le=$(ke,10),ke=ve,ve=Ve;Ve=ee[1]+Se+Le|0,ee[1]=ee[2]+de+$e|0,ee[2]=ee[3]+he+be|0,ee[3]=ee[4]+ae+ve|0,ee[4]=ee[0]+ge+ke|0,ee[0]=Ve},_doFinalize:function(){var V=this._data,W=V.words,K=this._nDataBytes*8,Q=V.sigBytes*8;W[Q>>>5]|=128<<24-Q%32,W[(Q+64>>>9<<4)+14]=(K<<8|K>>>24)&16711935|(K<<24|K>>>8)&4278255360,V.sigBytes=(W.length+1)*4,this._process();for(var Y=this._hash,ee=Y.words,te=0;te<5;te++){var ie=ee[te];ee[te]=(ie<<8|ie>>>24)&16711935|(ie<<24|ie>>>8)&4278255360}return Y},clone:function(){var V=m.clone.call(this);return V._hash=this._hash.clone(),V}});function M(V,W,K){return V^W^K}function x(V,W,K){return V&W|~V&K}function P(V,W,K){return(V|~W)^K}function D(V,W,K){return V&K|W&~K}function F(V,W,K){return V^(W|~K)}function $(V,W){return V<<W|V>>>32-W}c.RIPEMD160=m._createHelper(O),c.HmacRIPEMD160=m._createHmacHelper(O)}(),o.RIPEMD160})}(Ew)),Ew.exports}var _w={exports:{}},w6;function rN(){return w6||(w6=1,function(e,r){(function(o,s){e.exports=s(On())})(Ft,function(o){(function(){var s=o,c=s.lib,d=c.Base,f=s.enc,m=f.Utf8,g=s.algo;g.HMAC=d.extend({init:function(_,S){_=this._hasher=new _.init,typeof S=="string"&&(S=m.parse(S));var T=_.blockSize,R=T*4;S.sigBytes>R&&(S=_.finalize(S)),S.clamp();for(var N=this._oKey=S.clone(),A=this._iKey=S.clone(),O=N.words,M=A.words,x=0;x<T;x++)O[x]^=1549556828,M[x]^=909522486;N.sigBytes=A.sigBytes=R,this.reset()},reset:function(){var _=this._hasher;_.reset(),_.update(this._iKey)},update:function(_){return this._hasher.update(_),this},finalize:function(_){var S=this._hasher,T=S.finalize(_);S.reset();var R=S.finalize(this._oKey.clone().concat(T));return R}})})()})}(_w)),_w.exports}var yw={exports:{}},I6;function yCe(){return I6||(I6=1,function(e,r){(function(o,s,c){e.exports=s(On(),nN(),rN())})(Ft,function(o){return function(){var s=o,c=s.lib,d=c.Base,f=c.WordArray,m=s.algo,g=m.SHA256,_=m.HMAC,S=m.PBKDF2=d.extend({cfg:d.extend({keySize:128/32,hasher:g,iterations:25e4}),init:function(T){this.cfg=this.cfg.extend(T)},compute:function(T,R){for(var N=this.cfg,A=_.create(N.hasher,T),O=f.create(),M=f.create([1]),x=O.words,P=M.words,D=N.keySize,F=N.iterations;x.length<D;){var $=A.update(R).finalize(M);A.reset();for(var V=$.words,W=V.length,K=$,Q=1;Q<F;Q++){K=A.finalize(K),A.reset();for(var Y=K.words,ee=0;ee<W;ee++)V[ee]^=Y[ee]}O.concat($),P[0]++}return O.sigBytes=D*4,O}});s.PBKDF2=function(T,R,N){return S.create(N).compute(T,R)}}(),o.PBKDF2})}(yw)),yw.exports}var Sw={exports:{}},A6;function qu(){return A6||(A6=1,function(e,r){(function(o,s,c){e.exports=s(On(),GH(),rN())})(Ft,function(o){return function(){var s=o,c=s.lib,d=c.Base,f=c.WordArray,m=s.algo,g=m.MD5,_=m.EvpKDF=d.extend({cfg:d.extend({keySize:128/32,hasher:g,iterations:1}),init:function(S){this.cfg=this.cfg.extend(S)},compute:function(S,T){for(var R,N=this.cfg,A=N.hasher.create(),O=f.create(),M=O.words,x=N.keySize,P=N.iterations;M.length<x;){R&&A.update(R),R=A.update(S).finalize(T),A.reset();for(var D=1;D<P;D++)R=A.finalize(R),A.reset();O.concat(R)}return O.sigBytes=x*4,O}});s.EvpKDF=function(S,T,R){return _.create(R).compute(S,T)}}(),o.EvpKDF})}(Sw)),Sw.exports}var Cw={exports:{}},O6;function qi(){return O6||(O6=1,function(e,r){(function(o,s,c){e.exports=s(On(),qu())})(Ft,function(o){o.lib.Cipher||function(s){var c=o,d=c.lib,f=d.Base,m=d.WordArray,g=d.BufferedBlockAlgorithm,_=c.enc;_.Utf8;var S=_.Base64,T=c.algo,R=T.EvpKDF,N=d.Cipher=g.extend({cfg:f.extend(),createEncryptor:function(Y,ee){return this.create(this._ENC_XFORM_MODE,Y,ee)},createDecryptor:function(Y,ee){return this.create(this._DEC_XFORM_MODE,Y,ee)},init:function(Y,ee,te){this.cfg=this.cfg.extend(te),this._xformMode=Y,this._key=ee,this.reset()},reset:function(){g.reset.call(this),this._doReset()},process:function(Y){return this._append(Y),this._process()},finalize:function(Y){Y&&this._append(Y);var ee=this._doFinalize();return ee},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function Y(ee){return typeof ee=="string"?Q:V}return function(ee){return{encrypt:function(te,ie,le){return Y(ie).encrypt(ee,te,ie,le)},decrypt:function(te,ie,le){return Y(ie).decrypt(ee,te,ie,le)}}}}()});d.StreamCipher=N.extend({_doFinalize:function(){var Y=this._process(!0);return Y},blockSize:1});var A=c.mode={},O=d.BlockCipherMode=f.extend({createEncryptor:function(Y,ee){return this.Encryptor.create(Y,ee)},createDecryptor:function(Y,ee){return this.Decryptor.create(Y,ee)},init:function(Y,ee){this._cipher=Y,this._iv=ee}}),M=A.CBC=function(){var Y=O.extend();Y.Encryptor=Y.extend({processBlock:function(te,ie){var le=this._cipher,me=le.blockSize;ee.call(this,te,ie,me),le.encryptBlock(te,ie),this._prevBlock=te.slice(ie,ie+me)}}),Y.Decryptor=Y.extend({processBlock:function(te,ie){var le=this._cipher,me=le.blockSize,ce=te.slice(ie,ie+me);le.decryptBlock(te,ie),ee.call(this,te,ie,me),this._prevBlock=ce}});function ee(te,ie,le){var me,ce=this._iv;ce?(me=ce,this._iv=s):me=this._prevBlock;for(var se=0;se<le;se++)te[ie+se]^=me[se]}return Y}(),x=c.pad={},P=x.Pkcs7={pad:function(Y,ee){for(var te=ee*4,ie=te-Y.sigBytes%te,le=ie<<24|ie<<16|ie<<8|ie,me=[],ce=0;ce<ie;ce+=4)me.push(le);var se=m.create(me,ie);Y.concat(se)},unpad:function(Y){var ee=Y.words[Y.sigBytes-1>>>2]&255;Y.sigBytes-=ee}};d.BlockCipher=N.extend({cfg:N.cfg.extend({mode:M,padding:P}),reset:function(){var Y;N.reset.call(this);var ee=this.cfg,te=ee.iv,ie=ee.mode;this._xformMode==this._ENC_XFORM_MODE?Y=ie.createEncryptor:(Y=ie.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==Y?this._mode.init(this,te&&te.words):(this._mode=Y.call(ie,this,te&&te.words),this._mode.__creator=Y)},_doProcessBlock:function(Y,ee){this._mode.processBlock(Y,ee)},_doFinalize:function(){var Y,ee=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(ee.pad(this._data,this.blockSize),Y=this._process(!0)):(Y=this._process(!0),ee.unpad(Y)),Y},blockSize:128/32});var D=d.CipherParams=f.extend({init:function(Y){this.mixIn(Y)},toString:function(Y){return(Y||this.formatter).stringify(this)}}),F=c.format={},$=F.OpenSSL={stringify:function(Y){var ee,te=Y.ciphertext,ie=Y.salt;return ie?ee=m.create([1398893684,1701076831]).concat(ie).concat(te):ee=te,ee.toString(S)},parse:function(Y){var ee,te=S.parse(Y),ie=te.words;return ie[0]==1398893684&&ie[1]==1701076831&&(ee=m.create(ie.slice(2,4)),ie.splice(0,4),te.sigBytes-=16),D.create({ciphertext:te,salt:ee})}},V=d.SerializableCipher=f.extend({cfg:f.extend({format:$}),encrypt:function(Y,ee,te,ie){ie=this.cfg.extend(ie);var le=Y.createEncryptor(te,ie),me=le.finalize(ee),ce=le.cfg;return D.create({ciphertext:me,key:te,iv:ce.iv,algorithm:Y,mode:ce.mode,padding:ce.padding,blockSize:Y.blockSize,formatter:ie.format})},decrypt:function(Y,ee,te,ie){ie=this.cfg.extend(ie),ee=this._parse(ee,ie.format);var le=Y.createDecryptor(te,ie).finalize(ee.ciphertext);return le},_parse:function(Y,ee){return typeof Y=="string"?ee.parse(Y,this):Y}}),W=c.kdf={},K=W.OpenSSL={execute:function(Y,ee,te,ie,le){if(ie||(ie=m.random(64/8)),le)var me=R.create({keySize:ee+te,hasher:le}).compute(Y,ie);else var me=R.create({keySize:ee+te}).compute(Y,ie);var ce=m.create(me.words.slice(ee),te*4);return me.sigBytes=ee*4,D.create({key:me,iv:ce,salt:ie})}},Q=d.PasswordBasedCipher=V.extend({cfg:V.cfg.extend({kdf:K}),encrypt:function(Y,ee,te,ie){ie=this.cfg.extend(ie);var le=ie.kdf.execute(te,Y.keySize,Y.ivSize,ie.salt,ie.hasher);ie.iv=le.iv;var me=V.encrypt.call(this,Y,ee,le.key,ie);return me.mixIn(le),me},decrypt:function(Y,ee,te,ie){ie=this.cfg.extend(ie),ee=this._parse(ee,ie.format);var le=ie.kdf.execute(te,Y.keySize,Y.ivSize,ee.salt,ie.hasher);ie.iv=le.iv;var me=V.decrypt.call(this,Y,ee,le.key,ie);return me}})}()})}(Cw)),Cw.exports}var bw={exports:{}},x6;function SCe(){return x6||(x6=1,function(e,r){(function(o,s,c){e.exports=s(On(),qi())})(Ft,function(o){return o.mode.CFB=function(){var s=o.lib.BlockCipherMode.extend();s.Encryptor=s.extend({processBlock:function(d,f){var m=this._cipher,g=m.blockSize;c.call(this,d,f,g,m),this._prevBlock=d.slice(f,f+g)}}),s.Decryptor=s.extend({processBlock:function(d,f){var m=this._cipher,g=m.blockSize,_=d.slice(f,f+g);c.call(this,d,f,g,m),this._prevBlock=_}});function c(d,f,m,g){var _,S=this._iv;S?(_=S.slice(0),this._iv=void 0):_=this._prevBlock,g.encryptBlock(_,0);for(var T=0;T<m;T++)d[f+T]^=_[T]}return s}(),o.mode.CFB})}(bw)),bw.exports}var Tw={exports:{}},N6;function CCe(){return N6||(N6=1,function(e,r){(function(o,s,c){e.exports=s(On(),qi())})(Ft,function(o){return o.mode.CTR=function(){var s=o.lib.BlockCipherMode.extend(),c=s.Encryptor=s.extend({processBlock:function(d,f){var m=this._cipher,g=m.blockSize,_=this._iv,S=this._counter;_&&(S=this._counter=_.slice(0),this._iv=void 0);var T=S.slice(0);m.encryptBlock(T,0),S[g-1]=S[g-1]+1|0;for(var R=0;R<g;R++)d[f+R]^=T[R]}});return s.Decryptor=c,s}(),o.mode.CTR})}(Tw)),Tw.exports}var Rw={exports:{}},P6;function bCe(){return P6||(P6=1,function(e,r){(function(o,s,c){e.exports=s(On(),qi())})(Ft,function(o){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return o.mode.CTRGladman=function(){var s=o.lib.BlockCipherMode.extend();function c(m){if((m>>24&255)===255){var g=m>>16&255,_=m>>8&255,S=m&255;g===255?(g=0,_===255?(_=0,S===255?S=0:++S):++_):++g,m=0,m+=g<<16,m+=_<<8,m+=S}else m+=1<<24;return m}function d(m){return(m[0]=c(m[0]))===0&&(m[1]=c(m[1])),m}var f=s.Encryptor=s.extend({processBlock:function(m,g){var _=this._cipher,S=_.blockSize,T=this._iv,R=this._counter;T&&(R=this._counter=T.slice(0),this._iv=void 0),d(R);var N=R.slice(0);_.encryptBlock(N,0);for(var A=0;A<S;A++)m[g+A]^=N[A]}});return s.Decryptor=f,s}(),o.mode.CTRGladman})}(Rw)),Rw.exports}var ww={exports:{}},D6;function TCe(){return D6||(D6=1,function(e,r){(function(o,s,c){e.exports=s(On(),qi())})(Ft,function(o){return o.mode.OFB=function(){var s=o.lib.BlockCipherMode.extend(),c=s.Encryptor=s.extend({processBlock:function(d,f){var m=this._cipher,g=m.blockSize,_=this._iv,S=this._keystream;_&&(S=this._keystream=_.slice(0),this._iv=void 0),m.encryptBlock(S,0);for(var T=0;T<g;T++)d[f+T]^=S[T]}});return s.Decryptor=c,s}(),o.mode.OFB})}(ww)),ww.exports}var Iw={exports:{}},k6;function RCe(){return k6||(k6=1,function(e,r){(function(o,s,c){e.exports=s(On(),qi())})(Ft,function(o){return o.mode.ECB=function(){var s=o.lib.BlockCipherMode.extend();return s.Encryptor=s.extend({processBlock:function(c,d){this._cipher.encryptBlock(c,d)}}),s.Decryptor=s.extend({processBlock:function(c,d){this._cipher.decryptBlock(c,d)}}),s}(),o.mode.ECB})}(Iw)),Iw.exports}var Aw={exports:{}},L6;function wCe(){return L6||(L6=1,function(e,r){(function(o,s,c){e.exports=s(On(),qi())})(Ft,function(o){return o.pad.AnsiX923={pad:function(s,c){var d=s.sigBytes,f=c*4,m=f-d%f,g=d+m-1;s.clamp(),s.words[g>>>2]|=m<<24-g%4*8,s.sigBytes+=m},unpad:function(s){var c=s.words[s.sigBytes-1>>>2]&255;s.sigBytes-=c}},o.pad.Ansix923})}(Aw)),Aw.exports}var Ow={exports:{}},M6;function ICe(){return M6||(M6=1,function(e,r){(function(o,s,c){e.exports=s(On(),qi())})(Ft,function(o){return o.pad.Iso10126={pad:function(s,c){var d=c*4,f=d-s.sigBytes%d;s.concat(o.lib.WordArray.random(f-1)).concat(o.lib.WordArray.create([f<<24],1))},unpad:function(s){var c=s.words[s.sigBytes-1>>>2]&255;s.sigBytes-=c}},o.pad.Iso10126})}(Ow)),Ow.exports}var xw={exports:{}},F6;function ACe(){return F6||(F6=1,function(e,r){(function(o,s,c){e.exports=s(On(),qi())})(Ft,function(o){return o.pad.Iso97971={pad:function(s,c){s.concat(o.lib.WordArray.create([2147483648],1)),o.pad.ZeroPadding.pad(s,c)},unpad:function(s){o.pad.ZeroPadding.unpad(s),s.sigBytes--}},o.pad.Iso97971})}(xw)),xw.exports}var Nw={exports:{}},U6;function OCe(){return U6||(U6=1,function(e,r){(function(o,s,c){e.exports=s(On(),qi())})(Ft,function(o){return o.pad.ZeroPadding={pad:function(s,c){var d=c*4;s.clamp(),s.sigBytes+=d-(s.sigBytes%d||d)},unpad:function(s){for(var c=s.words,d=s.sigBytes-1,d=s.sigBytes-1;d>=0;d--)if(c[d>>>2]>>>24-d%4*8&255){s.sigBytes=d+1;break}}},o.pad.ZeroPadding})}(Nw)),Nw.exports}var Pw={exports:{}},B6;function xCe(){return B6||(B6=1,function(e,r){(function(o,s,c){e.exports=s(On(),qi())})(Ft,function(o){return o.pad.NoPadding={pad:function(){},unpad:function(){}},o.pad.NoPadding})}(Pw)),Pw.exports}var Dw={exports:{}},j6;function NCe(){return j6||(j6=1,function(e,r){(function(o,s,c){e.exports=s(On(),qi())})(Ft,function(o){return function(s){var c=o,d=c.lib,f=d.CipherParams,m=c.enc,g=m.Hex,_=c.format;_.Hex={stringify:function(S){return S.ciphertext.toString(g)},parse:function(S){var T=g.parse(S);return f.create({ciphertext:T})}}}(),o.format.Hex})}(Dw)),Dw.exports}var kw={exports:{}},V6;function PCe(){return V6||(V6=1,function(e,r){(function(o,s,c){e.exports=s(On(),uh(),dh(),qu(),qi())})(Ft,function(o){return function(){var s=o,c=s.lib,d=c.BlockCipher,f=s.algo,m=[],g=[],_=[],S=[],T=[],R=[],N=[],A=[],O=[],M=[];(function(){for(var D=[],F=0;F<256;F++)F<128?D[F]=F<<1:D[F]=F<<1^283;for(var $=0,V=0,F=0;F<256;F++){var W=V^V<<1^V<<2^V<<3^V<<4;W=W>>>8^W&255^99,m[$]=W,g[W]=$;var K=D[$],Q=D[K],Y=D[Q],ee=D[W]*257^W*16843008;_[$]=ee<<24|ee>>>8,S[$]=ee<<16|ee>>>16,T[$]=ee<<8|ee>>>24,R[$]=ee;var ee=Y*16843009^Q*65537^K*257^$*16843008;N[W]=ee<<24|ee>>>8,A[W]=ee<<16|ee>>>16,O[W]=ee<<8|ee>>>24,M[W]=ee,$?($=K^D[D[D[Y^K]]],V^=D[D[V]]):$=V=1}})();var x=[0,1,2,4,8,16,32,64,128,27,54],P=f.AES=d.extend({_doReset:function(){var D;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var F=this._keyPriorReset=this._key,$=F.words,V=F.sigBytes/4,W=this._nRounds=V+6,K=(W+1)*4,Q=this._keySchedule=[],Y=0;Y<K;Y++)Y<V?Q[Y]=$[Y]:(D=Q[Y-1],Y%V?V>6&&Y%V==4&&(D=m[D>>>24]<<24|m[D>>>16&255]<<16|m[D>>>8&255]<<8|m[D&255]):(D=D<<8|D>>>24,D=m[D>>>24]<<24|m[D>>>16&255]<<16|m[D>>>8&255]<<8|m[D&255],D^=x[Y/V|0]<<24),Q[Y]=Q[Y-V]^D);for(var ee=this._invKeySchedule=[],te=0;te<K;te++){var Y=K-te;if(te%4)var D=Q[Y];else var D=Q[Y-4];te<4||Y<=4?ee[te]=D:ee[te]=N[m[D>>>24]]^A[m[D>>>16&255]]^O[m[D>>>8&255]]^M[m[D&255]]}}},encryptBlock:function(D,F){this._doCryptBlock(D,F,this._keySchedule,_,S,T,R,m)},decryptBlock:function(D,F){var $=D[F+1];D[F+1]=D[F+3],D[F+3]=$,this._doCryptBlock(D,F,this._invKeySchedule,N,A,O,M,g);var $=D[F+1];D[F+1]=D[F+3],D[F+3]=$},_doCryptBlock:function(D,F,$,V,W,K,Q,Y){for(var ee=this._nRounds,te=D[F]^$[0],ie=D[F+1]^$[1],le=D[F+2]^$[2],me=D[F+3]^$[3],ce=4,se=1;se<ee;se++){var ae=V[te>>>24]^W[ie>>>16&255]^K[le>>>8&255]^Q[me&255]^$[ce++],ge=V[ie>>>24]^W[le>>>16&255]^K[me>>>8&255]^Q[te&255]^$[ce++],Se=V[le>>>24]^W[me>>>16&255]^K[te>>>8&255]^Q[ie&255]^$[ce++],de=V[me>>>24]^W[te>>>16&255]^K[ie>>>8&255]^Q[le&255]^$[ce++];te=ae,ie=ge,le=Se,me=de}var ae=(Y[te>>>24]<<24|Y[ie>>>16&255]<<16|Y[le>>>8&255]<<8|Y[me&255])^$[ce++],ge=(Y[ie>>>24]<<24|Y[le>>>16&255]<<16|Y[me>>>8&255]<<8|Y[te&255])^$[ce++],Se=(Y[le>>>24]<<24|Y[me>>>16&255]<<16|Y[te>>>8&255]<<8|Y[ie&255])^$[ce++],de=(Y[me>>>24]<<24|Y[te>>>16&255]<<16|Y[ie>>>8&255]<<8|Y[le&255])^$[ce++];D[F]=ae,D[F+1]=ge,D[F+2]=Se,D[F+3]=de},keySize:256/32});s.AES=d._createHelper(P)}(),o.AES})}(kw)),kw.exports}var Lw={exports:{}},$6;function DCe(){return $6||($6=1,function(e,r){(function(o,s,c){e.exports=s(On(),uh(),dh(),qu(),qi())})(Ft,function(o){return function(){var s=o,c=s.lib,d=c.WordArray,f=c.BlockCipher,m=s.algo,g=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],_=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],S=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],T=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],R=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],N=m.DES=f.extend({_doReset:function(){for(var x=this._key,P=x.words,D=[],F=0;F<56;F++){var $=g[F]-1;D[F]=P[$>>>5]>>>31-$%32&1}for(var V=this._subKeys=[],W=0;W<16;W++){for(var K=V[W]=[],Q=S[W],F=0;F<24;F++)K[F/6|0]|=D[(_[F]-1+Q)%28]<<31-F%6,K[4+(F/6|0)]|=D[28+(_[F+24]-1+Q)%28]<<31-F%6;K[0]=K[0]<<1|K[0]>>>31;for(var F=1;F<7;F++)K[F]=K[F]>>>(F-1)*4+3;K[7]=K[7]<<5|K[7]>>>27}for(var Y=this._invSubKeys=[],F=0;F<16;F++)Y[F]=V[15-F]},encryptBlock:function(x,P){this._doCryptBlock(x,P,this._subKeys)},decryptBlock:function(x,P){this._doCryptBlock(x,P,this._invSubKeys)},_doCryptBlock:function(x,P,D){this._lBlock=x[P],this._rBlock=x[P+1],A.call(this,4,252645135),A.call(this,16,65535),O.call(this,2,858993459),O.call(this,8,16711935),A.call(this,1,1431655765);for(var F=0;F<16;F++){for(var $=D[F],V=this._lBlock,W=this._rBlock,K=0,Q=0;Q<8;Q++)K|=T[Q][((W^$[Q])&R[Q])>>>0];this._lBlock=W,this._rBlock=V^K}var Y=this._lBlock;this._lBlock=this._rBlock,this._rBlock=Y,A.call(this,1,1431655765),O.call(this,8,16711935),O.call(this,2,858993459),A.call(this,16,65535),A.call(this,4,252645135),x[P]=this._lBlock,x[P+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function A(x,P){var D=(this._lBlock>>>x^this._rBlock)&P;this._rBlock^=D,this._lBlock^=D<<x}function O(x,P){var D=(this._rBlock>>>x^this._lBlock)&P;this._lBlock^=D,this._rBlock^=D<<x}s.DES=f._createHelper(N);var M=m.TripleDES=f.extend({_doReset:function(){var x=this._key,P=x.words;if(P.length!==2&&P.length!==4&&P.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var D=P.slice(0,2),F=P.length<4?P.slice(0,2):P.slice(2,4),$=P.length<6?P.slice(0,2):P.slice(4,6);this._des1=N.createEncryptor(d.create(D)),this._des2=N.createEncryptor(d.create(F)),this._des3=N.createEncryptor(d.create($))},encryptBlock:function(x,P){this._des1.encryptBlock(x,P),this._des2.decryptBlock(x,P),this._des3.encryptBlock(x,P)},decryptBlock:function(x,P){this._des3.decryptBlock(x,P),this._des2.encryptBlock(x,P),this._des1.decryptBlock(x,P)},keySize:192/32,ivSize:64/32,blockSize:64/32});s.TripleDES=f._createHelper(M)}(),o.TripleDES})}(Lw)),Lw.exports}var Mw={exports:{}},H6;function kCe(){return H6||(H6=1,function(e,r){(function(o,s,c){e.exports=s(On(),uh(),dh(),qu(),qi())})(Ft,function(o){return function(){var s=o,c=s.lib,d=c.StreamCipher,f=s.algo,m=f.RC4=d.extend({_doReset:function(){for(var S=this._key,T=S.words,R=S.sigBytes,N=this._S=[],A=0;A<256;A++)N[A]=A;for(var A=0,O=0;A<256;A++){var M=A%R,x=T[M>>>2]>>>24-M%4*8&255;O=(O+N[A]+x)%256;var P=N[A];N[A]=N[O],N[O]=P}this._i=this._j=0},_doProcessBlock:function(S,T){S[T]^=g.call(this)},keySize:256/32,ivSize:0});function g(){for(var S=this._S,T=this._i,R=this._j,N=0,A=0;A<4;A++){T=(T+1)%256,R=(R+S[T])%256;var O=S[T];S[T]=S[R],S[R]=O,N|=S[(S[T]+S[R])%256]<<24-A*8}return this._i=T,this._j=R,N}s.RC4=d._createHelper(m);var _=f.RC4Drop=m.extend({cfg:m.cfg.extend({drop:192}),_doReset:function(){m._doReset.call(this);for(var S=this.cfg.drop;S>0;S--)g.call(this)}});s.RC4Drop=d._createHelper(_)}(),o.RC4})}(Mw)),Mw.exports}var Fw={exports:{}},W6;function LCe(){return W6||(W6=1,function(e,r){(function(o,s,c){e.exports=s(On(),uh(),dh(),qu(),qi())})(Ft,function(o){return function(){var s=o,c=s.lib,d=c.StreamCipher,f=s.algo,m=[],g=[],_=[],S=f.Rabbit=d.extend({_doReset:function(){for(var R=this._key.words,N=this.cfg.iv,A=0;A<4;A++)R[A]=(R[A]<<8|R[A]>>>24)&16711935|(R[A]<<24|R[A]>>>8)&4278255360;var O=this._X=[R[0],R[3]<<16|R[2]>>>16,R[1],R[0]<<16|R[3]>>>16,R[2],R[1]<<16|R[0]>>>16,R[3],R[2]<<16|R[1]>>>16],M=this._C=[R[2]<<16|R[2]>>>16,R[0]&4294901760|R[1]&65535,R[3]<<16|R[3]>>>16,R[1]&4294901760|R[2]&65535,R[0]<<16|R[0]>>>16,R[2]&4294901760|R[3]&65535,R[1]<<16|R[1]>>>16,R[3]&4294901760|R[0]&65535];this._b=0;for(var A=0;A<4;A++)T.call(this);for(var A=0;A<8;A++)M[A]^=O[A+4&7];if(N){var x=N.words,P=x[0],D=x[1],F=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360,$=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,V=F>>>16|$&4294901760,W=$<<16|F&65535;M[0]^=F,M[1]^=V,M[2]^=$,M[3]^=W,M[4]^=F,M[5]^=V,M[6]^=$,M[7]^=W;for(var A=0;A<4;A++)T.call(this)}},_doProcessBlock:function(R,N){var A=this._X;T.call(this),m[0]=A[0]^A[5]>>>16^A[3]<<16,m[1]=A[2]^A[7]>>>16^A[5]<<16,m[2]=A[4]^A[1]>>>16^A[7]<<16,m[3]=A[6]^A[3]>>>16^A[1]<<16;for(var O=0;O<4;O++)m[O]=(m[O]<<8|m[O]>>>24)&16711935|(m[O]<<24|m[O]>>>8)&4278255360,R[N+O]^=m[O]},blockSize:128/32,ivSize:64/32});function T(){for(var R=this._X,N=this._C,A=0;A<8;A++)g[A]=N[A];N[0]=N[0]+1295307597+this._b|0,N[1]=N[1]+3545052371+(N[0]>>>0<g[0]>>>0?1:0)|0,N[2]=N[2]+886263092+(N[1]>>>0<g[1]>>>0?1:0)|0,N[3]=N[3]+1295307597+(N[2]>>>0<g[2]>>>0?1:0)|0,N[4]=N[4]+3545052371+(N[3]>>>0<g[3]>>>0?1:0)|0,N[5]=N[5]+886263092+(N[4]>>>0<g[4]>>>0?1:0)|0,N[6]=N[6]+1295307597+(N[5]>>>0<g[5]>>>0?1:0)|0,N[7]=N[7]+3545052371+(N[6]>>>0<g[6]>>>0?1:0)|0,this._b=N[7]>>>0<g[7]>>>0?1:0;for(var A=0;A<8;A++){var O=R[A]+N[A],M=O&65535,x=O>>>16,P=((M*M>>>17)+M*x>>>15)+x*x,D=((O&4294901760)*O|0)+((O&65535)*O|0);_[A]=P^D}R[0]=_[0]+(_[7]<<16|_[7]>>>16)+(_[6]<<16|_[6]>>>16)|0,R[1]=_[1]+(_[0]<<8|_[0]>>>24)+_[7]|0,R[2]=_[2]+(_[1]<<16|_[1]>>>16)+(_[0]<<16|_[0]>>>16)|0,R[3]=_[3]+(_[2]<<8|_[2]>>>24)+_[1]|0,R[4]=_[4]+(_[3]<<16|_[3]>>>16)+(_[2]<<16|_[2]>>>16)|0,R[5]=_[5]+(_[4]<<8|_[4]>>>24)+_[3]|0,R[6]=_[6]+(_[5]<<16|_[5]>>>16)+(_[4]<<16|_[4]>>>16)|0,R[7]=_[7]+(_[6]<<8|_[6]>>>24)+_[5]|0}s.Rabbit=d._createHelper(S)}(),o.Rabbit})}(Fw)),Fw.exports}var Uw={exports:{}},G6;function MCe(){return G6||(G6=1,function(e,r){(function(o,s,c){e.exports=s(On(),uh(),dh(),qu(),qi())})(Ft,function(o){return function(){var s=o,c=s.lib,d=c.StreamCipher,f=s.algo,m=[],g=[],_=[],S=f.RabbitLegacy=d.extend({_doReset:function(){var R=this._key.words,N=this.cfg.iv,A=this._X=[R[0],R[3]<<16|R[2]>>>16,R[1],R[0]<<16|R[3]>>>16,R[2],R[1]<<16|R[0]>>>16,R[3],R[2]<<16|R[1]>>>16],O=this._C=[R[2]<<16|R[2]>>>16,R[0]&4294901760|R[1]&65535,R[3]<<16|R[3]>>>16,R[1]&4294901760|R[2]&65535,R[0]<<16|R[0]>>>16,R[2]&4294901760|R[3]&65535,R[1]<<16|R[1]>>>16,R[3]&4294901760|R[0]&65535];this._b=0;for(var M=0;M<4;M++)T.call(this);for(var M=0;M<8;M++)O[M]^=A[M+4&7];if(N){var x=N.words,P=x[0],D=x[1],F=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360,$=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,V=F>>>16|$&4294901760,W=$<<16|F&65535;O[0]^=F,O[1]^=V,O[2]^=$,O[3]^=W,O[4]^=F,O[5]^=V,O[6]^=$,O[7]^=W;for(var M=0;M<4;M++)T.call(this)}},_doProcessBlock:function(R,N){var A=this._X;T.call(this),m[0]=A[0]^A[5]>>>16^A[3]<<16,m[1]=A[2]^A[7]>>>16^A[5]<<16,m[2]=A[4]^A[1]>>>16^A[7]<<16,m[3]=A[6]^A[3]>>>16^A[1]<<16;for(var O=0;O<4;O++)m[O]=(m[O]<<8|m[O]>>>24)&16711935|(m[O]<<24|m[O]>>>8)&4278255360,R[N+O]^=m[O]},blockSize:128/32,ivSize:64/32});function T(){for(var R=this._X,N=this._C,A=0;A<8;A++)g[A]=N[A];N[0]=N[0]+1295307597+this._b|0,N[1]=N[1]+3545052371+(N[0]>>>0<g[0]>>>0?1:0)|0,N[2]=N[2]+886263092+(N[1]>>>0<g[1]>>>0?1:0)|0,N[3]=N[3]+1295307597+(N[2]>>>0<g[2]>>>0?1:0)|0,N[4]=N[4]+3545052371+(N[3]>>>0<g[3]>>>0?1:0)|0,N[5]=N[5]+886263092+(N[4]>>>0<g[4]>>>0?1:0)|0,N[6]=N[6]+1295307597+(N[5]>>>0<g[5]>>>0?1:0)|0,N[7]=N[7]+3545052371+(N[6]>>>0<g[6]>>>0?1:0)|0,this._b=N[7]>>>0<g[7]>>>0?1:0;for(var A=0;A<8;A++){var O=R[A]+N[A],M=O&65535,x=O>>>16,P=((M*M>>>17)+M*x>>>15)+x*x,D=((O&4294901760)*O|0)+((O&65535)*O|0);_[A]=P^D}R[0]=_[0]+(_[7]<<16|_[7]>>>16)+(_[6]<<16|_[6]>>>16)|0,R[1]=_[1]+(_[0]<<8|_[0]>>>24)+_[7]|0,R[2]=_[2]+(_[1]<<16|_[1]>>>16)+(_[0]<<16|_[0]>>>16)|0,R[3]=_[3]+(_[2]<<8|_[2]>>>24)+_[1]|0,R[4]=_[4]+(_[3]<<16|_[3]>>>16)+(_[2]<<16|_[2]>>>16)|0,R[5]=_[5]+(_[4]<<8|_[4]>>>24)+_[3]|0,R[6]=_[6]+(_[5]<<16|_[5]>>>16)+(_[4]<<16|_[4]>>>16)|0,R[7]=_[7]+(_[6]<<8|_[6]>>>24)+_[5]|0}s.RabbitLegacy=d._createHelper(S)}(),o.RabbitLegacy})}(Uw)),Uw.exports}var Bw={exports:{}},z6;function FCe(){return z6||(z6=1,function(e,r){(function(o,s,c){e.exports=s(On(),uh(),dh(),qu(),qi())})(Ft,function(o){return function(){var s=o,c=s.lib,d=c.BlockCipher,f=s.algo;const m=16,g=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],_=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var S={pbox:[],sbox:[]};function T(M,x){let P=x>>24&255,D=x>>16&255,F=x>>8&255,$=x&255,V=M.sbox[0][P]+M.sbox[1][D];return V=V^M.sbox[2][F],V=V+M.sbox[3][$],V}function R(M,x,P){let D=x,F=P,$;for(let V=0;V<m;++V)D=D^M.pbox[V],F=T(M,D)^F,$=D,D=F,F=$;return $=D,D=F,F=$,F=F^M.pbox[m],D=D^M.pbox[m+1],{left:D,right:F}}function N(M,x,P){let D=x,F=P,$;for(let V=m+1;V>1;--V)D=D^M.pbox[V],F=T(M,D)^F,$=D,D=F,F=$;return $=D,D=F,F=$,F=F^M.pbox[1],D=D^M.pbox[0],{left:D,right:F}}function A(M,x,P){for(let W=0;W<4;W++){M.sbox[W]=[];for(let K=0;K<256;K++)M.sbox[W][K]=_[W][K]}let D=0;for(let W=0;W<m+2;W++)M.pbox[W]=g[W]^x[D],D++,D>=P&&(D=0);let F=0,$=0,V=0;for(let W=0;W<m+2;W+=2)V=R(M,F,$),F=V.left,$=V.right,M.pbox[W]=F,M.pbox[W+1]=$;for(let W=0;W<4;W++)for(let K=0;K<256;K+=2)V=R(M,F,$),F=V.left,$=V.right,M.sbox[W][K]=F,M.sbox[W][K+1]=$;return!0}var O=f.Blowfish=d.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var M=this._keyPriorReset=this._key,x=M.words,P=M.sigBytes/4;A(S,x,P)}},encryptBlock:function(M,x){var P=R(S,M[x],M[x+1]);M[x]=P.left,M[x+1]=P.right},decryptBlock:function(M,x){var P=N(S,M[x],M[x+1]);M[x]=P.left,M[x+1]=P.right},blockSize:64/32,keySize:128/32,ivSize:64/32});s.Blowfish=d._createHelper(O)}(),o.Blowfish})}(Bw)),Bw.exports}(function(e,r){(function(o,s,c){e.exports=s(On(),GS(),pCe(),fCe(),uh(),mCe(),dh(),GH(),nN(),gCe(),zH(),vCe(),ECe(),_Ce(),rN(),yCe(),qu(),qi(),SCe(),CCe(),bCe(),TCe(),RCe(),wCe(),ICe(),ACe(),OCe(),xCe(),NCe(),PCe(),DCe(),kCe(),LCe(),MCe(),FCe())})(Ft,function(o){return o})})(WH);var UCe=WH.exports;const K6=Ol(UCe);let KH="U2FsdGVkX1/nIO3//tPu/+LNS4S4tsxT3MzmKKuvXDxFFYxlol+eYrZkKcLoUBHMNoDedcuF62hF/qfPSSy59Q==";const BCe=10;{const e=K6.AES.decrypt("U2FsdGVkX1/nIO3//tPu/+LNS4S4tsxT3MzmKKuvXDxFFYxlol+eYrZkKcLoUBHMNoDedcuF62hF/qfPSSy59Q==","U2FsdGVkX1/fp5K6GAphzVxz");KH=JSON.parse(e.toString(K6.enc.Utf8))}const pt={appId:KH,channel:{}.AGORA_CHANNEL||"test",token:{}.AGORA_TOKEN?{}.AGORA_TOKEN:null,ShareScreenUID:BCe};function jCe(){return[{channel:{}.AGORA_CHANNEL_0||"test0",token:{}.AGORA_TOKEN_0},{channel:{}.AGORA_CHANNEL_1||"test1",token:{}.AGORA_TOKEN_1},{channel:{}.AGORA_CHANNEL_2||"test2",token:{}.AGORA_TOKEN_2},{channel:{}.AGORA_CHANNEL_3||"test3",token:{}.AGORA_TOKEN_3},{channel:{}.AGORA_CHANNEL_4||"test4",token:{}.AGORA_TOKEN_4},{channel:{}.AGORA_CHANNEL_5||"test5",token:{}.AGORA_TOKEN_5},{channel:{}.AGORA_CHANNEL_6||"test6",token:{}.AGORA_TOKEN_6},{channel:{}.AGORA_CHANNEL_7||"test7",token:{}.AGORA_TOKEN_7},{channel:{}.AGORA_CHANNEL_8||"test8",token:{}.AGORA_TOKEN_8},{channel:{}.AGORA_CHANNEL_9||"test9",token:{}.AGORA_TOKEN_9}]}const ic=e=>{c6(String(e));const r=aCe();return c6(),r},Bc=()=>"https://www.agora.io/en/wp-content/uploads/2022/10/3d-spatial-audio-icon.svg";function zS({micOn:e,cameraOn:r,renderAction:o,renderLocalUser:s,renderRemoteUsers:c}){const d=bs(),f=Wy()||0,m=b.useMemo(()=>ic(f),[f]),g=b.useMemo(()=>Bc(),[]),_=oc(),S=_.filter(A=>A.hasAudio||A.hasVideo),T=e||r,{localMicrophoneTrack:R}=hf(e),{localCameraTrack:N}=pf(r);return Gu([R,N]),ne.jsxs(ne.Fragment,{children:[o?o():void 0,ne.jsx(qx,{published:S.length+(T?1:0),total:_.length+1}),ne.jsxs(Es,{children:[d&&(s?s():ne.jsx(Es.Item,{children:ne.jsx(Yx,{audioTrack:R,cameraOn:r,cover:g,micOn:e,videoTrack:N,children:ne.jsx(Al,{children:`${m}{${f}}`})})})),c?c():void 0]})]})}const d_=({children:e,clientConfig:r={mode:"rtc",codec:"vp8"}})=>{const[o]=b.useState(()=>_l.createClient(r));return ne.jsx(M8,{client:o,children:e})},ga=({calling:e,micOn:r,cameraOn:o,setMic:s,setCamera:c,setCalling:d})=>ne.jsx(ne.Fragment,{children:ne.jsxs("div",{className:"inset-0 top-a flex justify-center items-center gap-3 px-6 py-3 bg-#21242c c-coolgray-3",children:[ne.jsxs("div",{className:"flex-1 flex top-0 left-0 h-full items-center gap-3 px-6 py-3",children:[s&&ne.jsx("button",{className:"btn",onClick:()=>s(),children:r?ne.jsx(FSe,{}):ne.jsx(USe,{})}),c&&ne.jsx("button",{className:"btn",onClick:()=>c(),children:o?ne.jsx(BSe,{}):ne.jsx(jSe,{})})]}),d&&ne.jsx("button",{className:Kx("btn btn-phone",{"btn-phone-active":e}),onClick:()=>d(),children:e?ne.jsx("i",{className:"i-mdi-phone-hangup"}):ne.jsx("i",{className:"i-mdi-phone"})})]})}),VCe=({screenShareOn:e,screenTrack:r,onCloseScreenShare:o})=>{const[s]=b.useState(()=>_l.createClient({mode:"rtc",codec:"vp8"})),[c,d]=b.useState(null),[f,m]=b.useState(null);return Ii({appid:pt.appId,channel:pt.channel,token:pt.token,uid:pt.ShareScreenUID},e,s),b.useEffect(()=>{r?Array.isArray(r)?(d(r.filter(g=>g.trackMediaType==="video")[0]),m(r.filter(g=>g.trackMediaType==="audio")[0])):d(r):(m(null),d(null))},[r]),Gu([c,f],e,s),k8(c,"track-ended",()=>{console.log("screen sharing ended"),o&&o()}),ne.jsxs(eie,{client:s,children:[e&&c&&ne.jsx(ag,{disabled:!e,play:e,style:{width:"300px",height:"300px"},track:c}),f&&ne.jsx(Gy,{disabled:!e,track:f})]})},Y6=e=>{let r;const o=new Set,s=(g,_)=>{const S=typeof g=="function"?g(r):g;if(!Object.is(S,r)){const T=r;r=_??typeof S!="object"?S:Object.assign({},r,S),o.forEach(R=>R(r,T))}},c=()=>r,m={setState:s,getState:c,subscribe:g=>(o.add(g),()=>o.delete(g)),destroy:()=>{o.clear()}};return r=e(s,c,m),m},$Ce=e=>e?Y6(e):Y6;var YH={exports:{}},qH={},XH={exports:{}},JH={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lf=b;function HCe(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var WCe=typeof Object.is=="function"?Object.is:HCe,GCe=lf.useState,zCe=lf.useEffect,KCe=lf.useLayoutEffect,YCe=lf.useDebugValue;function qCe(e,r){var o=r(),s=GCe({inst:{value:o,getSnapshot:r}}),c=s[0].inst,d=s[1];return KCe(function(){c.value=o,c.getSnapshot=r,jw(c)&&d({inst:c})},[e,o,r]),zCe(function(){return jw(c)&&d({inst:c}),e(function(){jw(c)&&d({inst:c})})},[e]),YCe(o),o}function jw(e){var r=e.getSnapshot;e=e.value;try{var o=r();return!WCe(e,o)}catch{return!0}}function XCe(e,r){return r()}var JCe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?XCe:qCe;JH.useSyncExternalStore=lf.useSyncExternalStore!==void 0?lf.useSyncExternalStore:JCe;XH.exports=JH;var QCe=XH.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KS=b,ZCe=QCe;function ebe(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var tbe=typeof Object.is=="function"?Object.is:ebe,nbe=ZCe.useSyncExternalStore,rbe=KS.useRef,ibe=KS.useEffect,obe=KS.useMemo,abe=KS.useDebugValue;qH.useSyncExternalStoreWithSelector=function(e,r,o,s,c){var d=rbe(null);if(d.current===null){var f={hasValue:!1,value:null};d.current=f}else f=d.current;d=obe(function(){function g(N){if(!_){if(_=!0,S=N,N=s(N),c!==void 0&&f.hasValue){var A=f.value;if(c(A,N))return T=A}return T=N}if(A=T,tbe(S,N))return A;var O=s(N);return c!==void 0&&c(A,O)?A:(S=N,T=O)}var _=!1,S,T,R=o===void 0?null:o;return[function(){return g(r())},R===null?void 0:function(){return g(R())}]},[r,o,s,c]);var m=nbe(e,d[0],d[1]);return ibe(function(){f.hasValue=!0,f.value=m},[m]),abe(m),m};YH.exports=qH;var sbe=YH.exports;const cbe=Ol(sbe),{useSyncExternalStoreWithSelector:lbe}=cbe;function ube(e,r=e.getState,o){const s=lbe(e.subscribe,e.getState,e.getServerState||e.getState,r,o);return b.useDebugValue(s),s}const q6=e=>{const r=typeof e=="function"?$Ce(e):e,o=(s,c)=>ube(r,s,c);return Object.assign(o,r),o},dbe=e=>e?q6(e):q6,hbe=pt.appId,pbe=jCe(),Im=dbe((e,r)=>({getRooms:()=>{let{rooms:o}=r();o=pbe.map(({token:s,channel:c})=>{const d=_l.createClient({mode:"live",codec:"vp8"});return d.join(hbe,c,s||null,null),{channel:c,token:s,client:d}}),e({rooms:o})},selectChannel:async o=>{let{hostRoom:s,localTracks:c}=r();const{rooms:d}=r();if(!o){s&&(c&&s.client.localTracks.length>0&&await s.client.unpublish(c),s.client.setClientRole("audience"),s=null,e({hostRoom:s,localTracks:c}));return}if(s){if(s.client.channelName===o)return;c&&await s.client.unpublish(c),await s.client.setClientRole("audience")}s=d==null?void 0:d.find(f=>f.client.channelName===o),s&&(await s.client.setClientRole("host"),c||(c=await _l.createMicrophoneAndCameraTracks()),await s.client.publish(c)),e({localTracks:c,hostRoom:s})},dispose:()=>{const{rooms:o,hostRoom:s}=r();if(s==null||s.client.leave(),o)for(const c of o)c.client.leave()}}));var fbe=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function mbe(e){var r=e.defaultInputValue,o=r===void 0?"":r,s=e.defaultMenuIsOpen,c=s===void 0?!1:s,d=e.defaultValue,f=d===void 0?null:d,m=e.inputValue,g=e.menuIsOpen,_=e.onChange,S=e.onInputChange,T=e.onMenuClose,R=e.onMenuOpen,N=e.value,A=An(e,fbe),O=b.useState(m!==void 0?m:o),M=Ge(O,2),x=M[0],P=M[1],D=b.useState(g!==void 0?g:c),F=Ge(D,2),$=F[0],V=F[1],W=b.useState(N!==void 0?N:f),K=Ge(W,2),Q=K[0],Y=K[1],ee=b.useCallback(function(ae,ge){typeof _=="function"&&_(ae,ge),Y(ae)},[_]),te=b.useCallback(function(ae,ge){var Se;typeof S=="function"&&(Se=S(ae,ge)),P(Se!==void 0?Se:ae)},[S]),ie=b.useCallback(function(){typeof R=="function"&&R(),V(!0)},[R]),le=b.useCallback(function(){typeof T=="function"&&T(),V(!1)},[T]),me=m!==void 0?m:x,ce=g!==void 0?g:$,se=N!==void 0?N:Q;return Oe(Oe({},A),{},{inputValue:me,menuIsOpen:ce,onChange:ee,onInputChange:te,onMenuClose:le,onMenuOpen:ie,value:se})}function gbe(e){if(e.sheet)return e.sheet;for(var r=0;r<document.styleSheets.length;r++)if(document.styleSheets[r].ownerNode===e)return document.styleSheets[r]}function vbe(e){var r=document.createElement("style");return r.setAttribute("data-emotion",e.key),e.nonce!==void 0&&r.setAttribute("nonce",e.nonce),r.appendChild(document.createTextNode("")),r.setAttribute("data-s",""),r}var Ebe=function(){function e(o){var s=this;this._insertTag=function(c){var d;s.tags.length===0?s.insertionPoint?d=s.insertionPoint.nextSibling:s.prepend?d=s.container.firstChild:d=s.before:d=s.tags[s.tags.length-1].nextSibling,s.container.insertBefore(c,d),s.tags.push(c)},this.isSpeedy=o.speedy===void 0?!0:o.speedy,this.tags=[],this.ctr=0,this.nonce=o.nonce,this.key=o.key,this.container=o.container,this.prepend=o.prepend,this.insertionPoint=o.insertionPoint,this.before=null}var r=e.prototype;return r.hydrate=function(s){s.forEach(this._insertTag)},r.insert=function(s){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(vbe(this));var c=this.tags[this.tags.length-1];if(this.isSpeedy){var d=gbe(c);try{d.insertRule(s,d.cssRules.length)}catch{}}else c.appendChild(document.createTextNode(s));this.ctr++},r.flush=function(){this.tags.forEach(function(s){return s.parentNode&&s.parentNode.removeChild(s)}),this.tags=[],this.ctr=0},e}(),bo="-ms-",Ly="-moz-",Hn="-webkit-",QH="comm",iN="rule",oN="decl",_be="@import",ZH="@keyframes",ybe="@layer",Sbe=Math.abs,YS=String.fromCharCode,Cbe=Object.assign;function bbe(e,r){return ro(e,0)^45?(((r<<2^ro(e,0))<<2^ro(e,1))<<2^ro(e,2))<<2^ro(e,3):0}function eW(e){return e.trim()}function Tbe(e,r){return(e=r.exec(e))?e[0]:e}function Wn(e,r,o){return e.replace(r,o)}function KA(e,r){return e.indexOf(r)}function ro(e,r){return e.charCodeAt(r)|0}function tg(e,r,o){return e.slice(r,o)}function Dc(e){return e.length}function aN(e){return e.length}function h_(e,r){return r.push(e),e}function Rbe(e,r){return e.map(r).join("")}var qS=1,uf=1,tW=0,fa=0,Ti=0,xf="";function XS(e,r,o,s,c,d,f){return{value:e,root:r,parent:o,type:s,props:c,children:d,line:qS,column:uf,length:f,return:""}}function em(e,r){return Cbe(XS("",null,null,"",null,null,0),e,{length:-e.length},r)}function wbe(){return Ti}function Ibe(){return Ti=fa>0?ro(xf,--fa):0,uf--,Ti===10&&(uf=1,qS--),Ti}function Va(){return Ti=fa<tW?ro(xf,fa++):0,uf++,Ti===10&&(uf=1,qS++),Ti}function Uc(){return ro(xf,fa)}function U_(){return fa}function Rg(e,r){return tg(xf,e,r)}function ng(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function nW(e){return qS=uf=1,tW=Dc(xf=e),fa=0,[]}function rW(e){return xf="",e}function B_(e){return eW(Rg(fa-1,YA(e===91?e+2:e===40?e+1:e)))}function Abe(e){for(;(Ti=Uc())&&Ti<33;)Va();return ng(e)>2||ng(Ti)>3?"":" "}function Obe(e,r){for(;--r&&Va()&&!(Ti<48||Ti>102||Ti>57&&Ti<65||Ti>70&&Ti<97););return Rg(e,U_()+(r<6&&Uc()==32&&Va()==32))}function YA(e){for(;Va();)switch(Ti){case e:return fa;case 34:case 39:e!==34&&e!==39&&YA(Ti);break;case 40:e===41&&YA(e);break;case 92:Va();break}return fa}function xbe(e,r){for(;Va()&&e+Ti!==47+10;)if(e+Ti===42+42&&Uc()===47)break;return"/*"+Rg(r,fa-1)+"*"+YS(e===47?e:Va())}function Nbe(e){for(;!ng(Uc());)Va();return Rg(e,fa)}function Pbe(e){return rW(j_("",null,null,null,[""],e=nW(e),0,[0],e))}function j_(e,r,o,s,c,d,f,m,g){for(var _=0,S=0,T=f,R=0,N=0,A=0,O=1,M=1,x=1,P=0,D="",F=c,$=d,V=s,W=D;M;)switch(A=P,P=Va()){case 40:if(A!=108&&ro(W,T-1)==58){KA(W+=Wn(B_(P),"&","&\f"),"&\f")!=-1&&(x=-1);break}case 34:case 39:case 91:W+=B_(P);break;case 9:case 10:case 13:case 32:W+=Abe(A);break;case 92:W+=Obe(U_()-1,7);continue;case 47:switch(Uc()){case 42:case 47:h_(Dbe(xbe(Va(),U_()),r,o),g);break;default:W+="/"}break;case 123*O:m[_++]=Dc(W)*x;case 125*O:case 59:case 0:switch(P){case 0:case 125:M=0;case 59+S:x==-1&&(W=Wn(W,/\f/g,"")),N>0&&Dc(W)-T&&h_(N>32?J6(W+";",s,o,T-1):J6(Wn(W," ","")+";",s,o,T-2),g);break;case 59:W+=";";default:if(h_(V=X6(W,r,o,_,S,c,m,D,F=[],$=[],T),d),P===123)if(S===0)j_(W,r,V,V,F,d,T,m,$);else switch(R===99&&ro(W,3)===110?100:R){case 100:case 108:case 109:case 115:j_(e,V,V,s&&h_(X6(e,V,V,0,0,c,m,D,c,F=[],T),$),c,$,T,m,s?F:$);break;default:j_(W,V,V,V,[""],$,0,m,$)}}_=S=N=0,O=x=1,D=W="",T=f;break;case 58:T=1+Dc(W),N=A;default:if(O<1){if(P==123)--O;else if(P==125&&O++==0&&Ibe()==125)continue}switch(W+=YS(P),P*O){case 38:x=S>0?1:(W+="\f",-1);break;case 44:m[_++]=(Dc(W)-1)*x,x=1;break;case 64:Uc()===45&&(W+=B_(Va())),R=Uc(),S=T=Dc(D=W+=Nbe(U_())),P++;break;case 45:A===45&&Dc(W)==2&&(O=0)}}return d}function X6(e,r,o,s,c,d,f,m,g,_,S){for(var T=c-1,R=c===0?d:[""],N=aN(R),A=0,O=0,M=0;A<s;++A)for(var x=0,P=tg(e,T+1,T=Sbe(O=f[A])),D=e;x<N;++x)(D=eW(O>0?R[x]+" "+P:Wn(P,/&\f/g,R[x])))&&(g[M++]=D);return XS(e,r,o,c===0?iN:m,g,_,S)}function Dbe(e,r,o){return XS(e,r,o,QH,YS(wbe()),tg(e,2,-2),0)}function J6(e,r,o,s){return XS(e,r,o,oN,tg(e,0,s),tg(e,s+1,-1),s)}function Jp(e,r){for(var o="",s=aN(e),c=0;c<s;c++)o+=r(e[c],c,e,r)||"";return o}function kbe(e,r,o,s){switch(e.type){case ybe:if(e.children.length)break;case _be:case oN:return e.return=e.return||e.value;case QH:return"";case ZH:return e.return=e.value+"{"+Jp(e.children,s)+"}";case iN:e.value=e.props.join(",")}return Dc(o=Jp(e.children,s))?e.return=e.value+"{"+o+"}":""}function Lbe(e){var r=aN(e);return function(o,s,c,d){for(var f="",m=0;m<r;m++)f+=e[m](o,s,c,d)||"";return f}}function Mbe(e){return function(r){r.root||(r=r.return)&&e(r)}}function Fbe(e){var r=Object.create(null);return function(o){return r[o]===void 0&&(r[o]=e(o)),r[o]}}var Ube=function(r,o,s){for(var c=0,d=0;c=d,d=Uc(),c===38&&d===12&&(o[s]=1),!ng(d);)Va();return Rg(r,fa)},Bbe=function(r,o){var s=-1,c=44;do switch(ng(c)){case 0:c===38&&Uc()===12&&(o[s]=1),r[s]+=Ube(fa-1,o,s);break;case 2:r[s]+=B_(c);break;case 4:if(c===44){r[++s]=Uc()===58?"&\f":"",o[s]=r[s].length;break}default:r[s]+=YS(c)}while(c=Va());return r},jbe=function(r,o){return rW(Bbe(nW(r),o))},Q6=new WeakMap,Vbe=function(r){if(!(r.type!=="rule"||!r.parent||r.length<1)){for(var o=r.value,s=r.parent,c=r.column===s.column&&r.line===s.line;s.type!=="rule";)if(s=s.parent,!s)return;if(!(r.props.length===1&&o.charCodeAt(0)!==58&&!Q6.get(s))&&!c){Q6.set(r,!0);for(var d=[],f=jbe(o,d),m=s.props,g=0,_=0;g<f.length;g++)for(var S=0;S<m.length;S++,_++)r.props[_]=d[g]?f[g].replace(/&\f/g,m[S]):m[S]+" "+f[g]}}},$be=function(r){if(r.type==="decl"){var o=r.value;o.charCodeAt(0)===108&&o.charCodeAt(2)===98&&(r.return="",r.value="")}};function iW(e,r){switch(bbe(e,r)){case 5103:return Hn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Hn+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Hn+e+Ly+e+bo+e+e;case 6828:case 4268:return Hn+e+bo+e+e;case 6165:return Hn+e+bo+"flex-"+e+e;case 5187:return Hn+e+Wn(e,/(\w+).+(:[^]+)/,Hn+"box-$1$2"+bo+"flex-$1$2")+e;case 5443:return Hn+e+bo+"flex-item-"+Wn(e,/flex-|-self/,"")+e;case 4675:return Hn+e+bo+"flex-line-pack"+Wn(e,/align-content|flex-|-self/,"")+e;case 5548:return Hn+e+bo+Wn(e,"shrink","negative")+e;case 5292:return Hn+e+bo+Wn(e,"basis","preferred-size")+e;case 6060:return Hn+"box-"+Wn(e,"-grow","")+Hn+e+bo+Wn(e,"grow","positive")+e;case 4554:return Hn+Wn(e,/([^-])(transform)/g,"$1"+Hn+"$2")+e;case 6187:return Wn(Wn(Wn(e,/(zoom-|grab)/,Hn+"$1"),/(image-set)/,Hn+"$1"),e,"")+e;case 5495:case 3959:return Wn(e,/(image-set\([^]*)/,Hn+"$1$`$1");case 4968:return Wn(Wn(e,/(.+:)(flex-)?(.*)/,Hn+"box-pack:$3"+bo+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Hn+e+e;case 4095:case 3583:case 4068:case 2532:return Wn(e,/(.+)-inline(.+)/,Hn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Dc(e)-1-r>6)switch(ro(e,r+1)){case 109:if(ro(e,r+4)!==45)break;case 102:return Wn(e,/(.+:)(.+)-([^]+)/,"$1"+Hn+"$2-$3$1"+Ly+(ro(e,r+3)==108?"$3":"$2-$3"))+e;case 115:return~KA(e,"stretch")?iW(Wn(e,"stretch","fill-available"),r)+e:e}break;case 4949:if(ro(e,r+1)!==115)break;case 6444:switch(ro(e,Dc(e)-3-(~KA(e,"!important")&&10))){case 107:return Wn(e,":",":"+Hn)+e;case 101:return Wn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Hn+(ro(e,14)===45?"inline-":"")+"box$3$1"+Hn+"$2$3$1"+bo+"$2box$3")+e}break;case 5936:switch(ro(e,r+11)){case 114:return Hn+e+bo+Wn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Hn+e+bo+Wn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Hn+e+bo+Wn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Hn+e+bo+e+e}return e}var Hbe=function(r,o,s,c){if(r.length>-1&&!r.return)switch(r.type){case oN:r.return=iW(r.value,r.length);break;case ZH:return Jp([em(r,{value:Wn(r.value,"@","@"+Hn)})],c);case iN:if(r.length)return Rbe(r.props,function(d){switch(Tbe(d,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Jp([em(r,{props:[Wn(d,/:(read-\w+)/,":"+Ly+"$1")]})],c);case"::placeholder":return Jp([em(r,{props:[Wn(d,/:(plac\w+)/,":"+Hn+"input-$1")]}),em(r,{props:[Wn(d,/:(plac\w+)/,":"+Ly+"$1")]}),em(r,{props:[Wn(d,/:(plac\w+)/,bo+"input-$1")]})],c)}return""})}},Wbe=[Hbe],Gbe=function(r){var o=r.key;if(o==="css"){var s=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(s,function(O){var M=O.getAttribute("data-emotion");M.indexOf(" ")!==-1&&(document.head.appendChild(O),O.setAttribute("data-s",""))})}var c=r.stylisPlugins||Wbe,d={},f,m=[];f=r.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+o+' "]'),function(O){for(var M=O.getAttribute("data-emotion").split(" "),x=1;x<M.length;x++)d[M[x]]=!0;m.push(O)});var g,_=[Vbe,$be];{var S,T=[kbe,Mbe(function(O){S.insert(O)})],R=Lbe(_.concat(c,T)),N=function(M){return Jp(Pbe(M),R)};g=function(M,x,P,D){S=P,N(M?M+"{"+x.styles+"}":x.styles),D&&(A.inserted[x.name]=!0)}}var A={key:o,sheet:new Ebe({key:o,container:f,nonce:r.nonce,speedy:r.speedy,prepend:r.prepend,insertionPoint:r.insertionPoint}),nonce:r.nonce,inserted:d,registered:{},insert:g};return A.sheet.hydrate(m),A},oW={exports:{}},sr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xi=typeof Symbol=="function"&&Symbol.for,sN=Xi?Symbol.for("react.element"):60103,cN=Xi?Symbol.for("react.portal"):60106,JS=Xi?Symbol.for("react.fragment"):60107,QS=Xi?Symbol.for("react.strict_mode"):60108,ZS=Xi?Symbol.for("react.profiler"):60114,eC=Xi?Symbol.for("react.provider"):60109,tC=Xi?Symbol.for("react.context"):60110,lN=Xi?Symbol.for("react.async_mode"):60111,nC=Xi?Symbol.for("react.concurrent_mode"):60111,rC=Xi?Symbol.for("react.forward_ref"):60112,iC=Xi?Symbol.for("react.suspense"):60113,zbe=Xi?Symbol.for("react.suspense_list"):60120,oC=Xi?Symbol.for("react.memo"):60115,aC=Xi?Symbol.for("react.lazy"):60116,Kbe=Xi?Symbol.for("react.block"):60121,Ybe=Xi?Symbol.for("react.fundamental"):60117,qbe=Xi?Symbol.for("react.responder"):60118,Xbe=Xi?Symbol.for("react.scope"):60119;function za(e){if(typeof e=="object"&&e!==null){var r=e.$$typeof;switch(r){case sN:switch(e=e.type,e){case lN:case nC:case JS:case ZS:case QS:case iC:return e;default:switch(e=e&&e.$$typeof,e){case tC:case rC:case aC:case oC:case eC:return e;default:return r}}case cN:return r}}}function aW(e){return za(e)===nC}sr.AsyncMode=lN;sr.ConcurrentMode=nC;sr.ContextConsumer=tC;sr.ContextProvider=eC;sr.Element=sN;sr.ForwardRef=rC;sr.Fragment=JS;sr.Lazy=aC;sr.Memo=oC;sr.Portal=cN;sr.Profiler=ZS;sr.StrictMode=QS;sr.Suspense=iC;sr.isAsyncMode=function(e){return aW(e)||za(e)===lN};sr.isConcurrentMode=aW;sr.isContextConsumer=function(e){return za(e)===tC};sr.isContextProvider=function(e){return za(e)===eC};sr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===sN};sr.isForwardRef=function(e){return za(e)===rC};sr.isFragment=function(e){return za(e)===JS};sr.isLazy=function(e){return za(e)===aC};sr.isMemo=function(e){return za(e)===oC};sr.isPortal=function(e){return za(e)===cN};sr.isProfiler=function(e){return za(e)===ZS};sr.isStrictMode=function(e){return za(e)===QS};sr.isSuspense=function(e){return za(e)===iC};sr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===JS||e===nC||e===ZS||e===QS||e===iC||e===zbe||typeof e=="object"&&e!==null&&(e.$$typeof===aC||e.$$typeof===oC||e.$$typeof===eC||e.$$typeof===tC||e.$$typeof===rC||e.$$typeof===Ybe||e.$$typeof===qbe||e.$$typeof===Xbe||e.$$typeof===Kbe)};sr.typeOf=za;oW.exports=sr;var Jbe=oW.exports,sW=Jbe,Qbe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Zbe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},cW={};cW[sW.ForwardRef]=Qbe;cW[sW.Memo]=Zbe;var eTe=!0;function tTe(e,r,o){var s="";return o.split(" ").forEach(function(c){e[c]!==void 0?r.push(e[c]+";"):s+=c+" "}),s}var lW=function(r,o,s){var c=r.key+"-"+o.name;(s===!1||eTe===!1)&&r.registered[c]===void 0&&(r.registered[c]=o.styles)},nTe=function(r,o,s){lW(r,o,s);var c=r.key+"-"+o.name;if(r.inserted[o.name]===void 0){var d=o;do r.insert(o===d?"."+c:"",d,r.sheet,!0),d=d.next;while(d!==void 0)}};function rTe(e){for(var r=0,o,s=0,c=e.length;c>=4;++s,c-=4)o=e.charCodeAt(s)&255|(e.charCodeAt(++s)&255)<<8|(e.charCodeAt(++s)&255)<<16|(e.charCodeAt(++s)&255)<<24,o=(o&65535)*1540483477+((o>>>16)*59797<<16),o^=o>>>24,r=(o&65535)*1540483477+((o>>>16)*59797<<16)^(r&65535)*1540483477+((r>>>16)*59797<<16);switch(c){case 3:r^=(e.charCodeAt(s+2)&255)<<16;case 2:r^=(e.charCodeAt(s+1)&255)<<8;case 1:r^=e.charCodeAt(s)&255,r=(r&65535)*1540483477+((r>>>16)*59797<<16)}return r^=r>>>13,r=(r&65535)*1540483477+((r>>>16)*59797<<16),((r^r>>>15)>>>0).toString(36)}var iTe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},oTe=/[A-Z]|^ms/g,aTe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,uW=function(r){return r.charCodeAt(1)===45},Z6=function(r){return r!=null&&typeof r!="boolean"},Vw=Fbe(function(e){return uW(e)?e:e.replace(oTe,"-$&").toLowerCase()}),e8=function(r,o){switch(r){case"animation":case"animationName":if(typeof o=="string")return o.replace(aTe,function(s,c,d){return kc={name:c,styles:d,next:kc},c})}return iTe[r]!==1&&!uW(r)&&typeof o=="number"&&o!==0?o+"px":o};function rg(e,r,o){if(o==null)return"";if(o.__emotion_styles!==void 0)return o;switch(typeof o){case"boolean":return"";case"object":{if(o.anim===1)return kc={name:o.name,styles:o.styles,next:kc},o.name;if(o.styles!==void 0){var s=o.next;if(s!==void 0)for(;s!==void 0;)kc={name:s.name,styles:s.styles,next:kc},s=s.next;var c=o.styles+";";return c}return sTe(e,r,o)}case"function":{if(e!==void 0){var d=kc,f=o(e);return kc=d,rg(e,r,f)}break}}if(r==null)return o;var m=r[o];return m!==void 0?m:o}function sTe(e,r,o){var s="";if(Array.isArray(o))for(var c=0;c<o.length;c++)s+=rg(e,r,o[c])+";";else for(var d in o){var f=o[d];if(typeof f!="object")r!=null&&r[f]!==void 0?s+=d+"{"+r[f]+"}":Z6(f)&&(s+=Vw(d)+":"+e8(d,f)+";");else if(Array.isArray(f)&&typeof f[0]=="string"&&(r==null||r[f[0]]===void 0))for(var m=0;m<f.length;m++)Z6(f[m])&&(s+=Vw(d)+":"+e8(d,f[m])+";");else{var g=rg(e,r,f);switch(d){case"animation":case"animationName":{s+=Vw(d)+":"+g+";";break}default:s+=d+"{"+g+"}"}}}return s}var t8=/label:\s*([^\s;\n{]+)\s*(;|$)/g,kc,dW=function(r,o,s){if(r.length===1&&typeof r[0]=="object"&&r[0]!==null&&r[0].styles!==void 0)return r[0];var c=!0,d="";kc=void 0;var f=r[0];f==null||f.raw===void 0?(c=!1,d+=rg(s,o,f)):d+=f[0];for(var m=1;m<r.length;m++)d+=rg(s,o,r[m]),c&&(d+=f[m]);t8.lastIndex=0;for(var g="",_;(_=t8.exec(d))!==null;)g+="-"+_[1];var S=rTe(d)+g;return{name:S,styles:d,next:kc}},cTe=function(r){return r()},lTe=Yd["useInsertionEffect"]?Yd["useInsertionEffect"]:!1,uTe=lTe||cTe,uN={}.hasOwnProperty,hW=b.createContext(typeof HTMLElement<"u"?Gbe({key:"css"}):null);hW.Provider;var dTe=function(r){return b.forwardRef(function(o,s){var c=b.useContext(hW);return r(o,c,s)})},hTe=b.createContext({}),qA="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",pTe=function(r,o){var s={};for(var c in o)uN.call(o,c)&&(s[c]=o[c]);return s[qA]=r,s},fTe=function(r){var o=r.cache,s=r.serialized,c=r.isStringTag;return lW(o,s,c),uTe(function(){return nTe(o,s,c)}),null},mTe=dTe(function(e,r,o){var s=e.css;typeof s=="string"&&r.registered[s]!==void 0&&(s=r.registered[s]);var c=e[qA],d=[s],f="";typeof e.className=="string"?f=tTe(r.registered,d,e.className):e.className!=null&&(f=e.className+" ");var m=dW(d,void 0,b.useContext(hTe));f+=r.key+"-"+m.name;var g={};for(var _ in e)uN.call(e,_)&&_!=="css"&&_!==qA&&(g[_]=e[_]);return g.ref=o,g.className=f,b.createElement(b.Fragment,null,b.createElement(fTe,{cache:r,serialized:m,isStringTag:typeof c=="string"}),b.createElement(c,g))}),gTe=mTe,Bt=function(r,o){var s=arguments;if(o==null||!uN.call(o,"css"))return b.createElement.apply(void 0,s);var c=s.length,d=new Array(c);d[0]=gTe,d[1]=pTe(r,o);for(var f=2;f<c;f++)d[f]=s[f];return b.createElement.apply(null,d)};function dN(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return dW(r)}var vTe=function(){var r=dN.apply(void 0,arguments),o="animation-"+r.name;return{name:o,styles:"@keyframes "+o+"{"+r.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}};function ETe(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}const _Te=Math.min,yTe=Math.max,My=Math.round,p_=Math.floor,Fy=e=>({x:e,y:e});function STe(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function pW(e){return mW(e)?(e.nodeName||"").toLowerCase():"#document"}function ec(e){var r;return(e==null||(r=e.ownerDocument)==null?void 0:r.defaultView)||window}function fW(e){var r;return(r=(mW(e)?e.ownerDocument:e.document)||window.document)==null?void 0:r.documentElement}function mW(e){return e instanceof Node||e instanceof ec(e).Node}function XA(e){return e instanceof Element||e instanceof ec(e).Element}function hN(e){return e instanceof HTMLElement||e instanceof ec(e).HTMLElement}function n8(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ec(e).ShadowRoot}function gW(e){const{overflow:r,overflowX:o,overflowY:s,display:c}=pN(e);return/auto|scroll|overlay|hidden|clip/.test(r+s+o)&&!["inline","contents"].includes(c)}function CTe(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function bTe(e){return["html","body","#document"].includes(pW(e))}function pN(e){return ec(e).getComputedStyle(e)}function TTe(e){if(pW(e)==="html")return e;const r=e.assignedSlot||e.parentNode||n8(e)&&e.host||fW(e);return n8(r)?r.host:r}function vW(e){const r=TTe(e);return bTe(r)?e.ownerDocument?e.ownerDocument.body:e.body:hN(r)&&gW(r)?r:vW(r)}function Uy(e,r,o){var s;r===void 0&&(r=[]),o===void 0&&(o=!0);const c=vW(e),d=c===((s=e.ownerDocument)==null?void 0:s.body),f=ec(c);return d?r.concat(f,f.visualViewport||[],gW(c)?c:[],f.frameElement&&o?Uy(f.frameElement):[]):r.concat(c,Uy(c,[],o))}function RTe(e){const r=pN(e);let o=parseFloat(r.width)||0,s=parseFloat(r.height)||0;const c=hN(e),d=c?e.offsetWidth:o,f=c?e.offsetHeight:s,m=My(o)!==d||My(s)!==f;return m&&(o=d,s=f),{width:o,height:s,$:m}}function fN(e){return XA(e)?e:e.contextElement}function $w(e){const r=fN(e);if(!hN(r))return Fy(1);const o=r.getBoundingClientRect(),{width:s,height:c,$:d}=RTe(r);let f=(d?My(o.width):o.width)/s,m=(d?My(o.height):o.height)/c;return(!f||!Number.isFinite(f))&&(f=1),(!m||!Number.isFinite(m))&&(m=1),{x:f,y:m}}const wTe=Fy(0);function ITe(e){const r=ec(e);return!CTe()||!r.visualViewport?wTe:{x:r.visualViewport.offsetLeft,y:r.visualViewport.offsetTop}}function ATe(e,r,o){return r===void 0&&(r=!1),!o||r&&o!==ec(e)?!1:r}function r8(e,r,o,s){r===void 0&&(r=!1),o===void 0&&(o=!1);const c=e.getBoundingClientRect(),d=fN(e);let f=Fy(1);r&&(s?XA(s)&&(f=$w(s)):f=$w(e));const m=ATe(d,o,s)?ITe(d):Fy(0);let g=(c.left+m.x)/f.x,_=(c.top+m.y)/f.y,S=c.width/f.x,T=c.height/f.y;if(d){const R=ec(d),N=s&&XA(s)?ec(s):s;let A=R.frameElement;for(;A&&s&&N!==R;){const O=$w(A),M=A.getBoundingClientRect(),x=pN(A),P=M.left+(A.clientLeft+parseFloat(x.paddingLeft))*O.x,D=M.top+(A.clientTop+parseFloat(x.paddingTop))*O.y;g*=O.x,_*=O.y,S*=O.x,T*=O.y,g+=P,_+=D,A=ec(A).frameElement}}return STe({width:S,height:T,x:g,y:_})}function OTe(e,r){let o=null,s;const c=fW(e);function d(){clearTimeout(s),o&&o.disconnect(),o=null}function f(m,g){m===void 0&&(m=!1),g===void 0&&(g=1),d();const{left:_,top:S,width:T,height:R}=e.getBoundingClientRect();if(m||r(),!T||!R)return;const N=p_(S),A=p_(c.clientWidth-(_+T)),O=p_(c.clientHeight-(S+R)),M=p_(_),P={rootMargin:-N+"px "+-A+"px "+-O+"px "+-M+"px",threshold:yTe(0,_Te(1,g))||1};let D=!0;function F($){const V=$[0].intersectionRatio;if(V!==g){if(!D)return f();V?f(!1,V):s=setTimeout(()=>{f(!1,1e-7)},100)}D=!1}try{o=new IntersectionObserver(F,{...P,root:c.ownerDocument})}catch{o=new IntersectionObserver(F,P)}o.observe(e)}return f(!0),d}function xTe(e,r,o,s){s===void 0&&(s={});const{ancestorScroll:c=!0,ancestorResize:d=!0,elementResize:f=typeof ResizeObserver=="function",layoutShift:m=typeof IntersectionObserver=="function",animationFrame:g=!1}=s,_=fN(e),S=c||d?[..._?Uy(_):[],...Uy(r)]:[];S.forEach(x=>{c&&x.addEventListener("scroll",o,{passive:!0}),d&&x.addEventListener("resize",o)});const T=_&&m?OTe(_,o):null;let R=-1,N=null;f&&(N=new ResizeObserver(x=>{let[P]=x;P&&P.target===_&&N&&(N.unobserve(r),cancelAnimationFrame(R),R=requestAnimationFrame(()=>{N&&N.observe(r)})),o()}),_&&!g&&N.observe(_),N.observe(r));let A,O=g?r8(e):null;g&&M();function M(){const x=r8(e);O&&(x.x!==O.x||x.y!==O.y||x.width!==O.width||x.height!==O.height)&&o(),O=x,A=requestAnimationFrame(M)}return o(),()=>{S.forEach(x=>{c&&x.removeEventListener("scroll",o),d&&x.removeEventListener("resize",o)}),T&&T(),N&&N.disconnect(),N=null,g&&cancelAnimationFrame(A)}}var JA=b.useLayoutEffect,NTe=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],By=function(){};function PTe(e,r){return r?r[0]==="-"?e+r:e+"__"+r:e}function DTe(e,r){for(var o=arguments.length,s=new Array(o>2?o-2:0),c=2;c<o;c++)s[c-2]=arguments[c];var d=[].concat(s);if(r&&e)for(var f in r)r.hasOwnProperty(f)&&r[f]&&d.push("".concat(PTe(e,f)));return d.filter(function(m){return m}).map(function(m){return String(m).trim()}).join(" ")}var i8=function(r){return $Te(r)?r.filter(Boolean):Fn(r)==="object"&&r!==null?[r]:[]},EW=function(r){r.className,r.clearValue,r.cx,r.getStyles,r.getClassNames,r.getValue,r.hasValue,r.isMulti,r.isRtl,r.options,r.selectOption,r.selectProps,r.setValue,r.theme;var o=An(r,NTe);return Oe({},o)},ti=function(r,o,s){var c=r.cx,d=r.getStyles,f=r.getClassNames,m=r.className;return{css:d(o,r),className:c(s??{},f(o,r),m)}};function sC(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function kTe(e){return sC(e)?window.innerHeight:e.clientHeight}function _W(e){return sC(e)?window.pageYOffset:e.scrollTop}function jy(e,r){if(sC(e)){window.scrollTo(0,r);return}e.scrollTop=r}function LTe(e){var r=getComputedStyle(e),o=r.position==="absolute",s=/(auto|scroll)/;if(r.position==="fixed")return document.documentElement;for(var c=e;c=c.parentElement;)if(r=getComputedStyle(c),!(o&&r.position==="static")&&s.test(r.overflow+r.overflowY+r.overflowX))return c;return document.documentElement}function MTe(e,r,o,s){return o*((e=e/s-1)*e*e+1)+r}function f_(e,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:By,c=_W(e),d=r-c,f=10,m=0;function g(){m+=f;var _=MTe(m,c,d,o);jy(e,_),m<o?window.requestAnimationFrame(g):s(e)}g()}function o8(e,r){var o=e.getBoundingClientRect(),s=r.getBoundingClientRect(),c=r.offsetHeight/3;s.bottom+c>o.bottom?jy(e,Math.min(r.offsetTop+r.clientHeight-e.offsetHeight+c,e.scrollHeight)):s.top-c<o.top&&jy(e,Math.max(r.offsetTop-c,0))}function FTe(e){var r=e.getBoundingClientRect();return{bottom:r.bottom,height:r.height,left:r.left,right:r.right,top:r.top,width:r.width}}function a8(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function UTe(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var yW=!1,BTe={get passive(){return yW=!0}},m_=typeof window<"u"?window:{};m_.addEventListener&&m_.removeEventListener&&(m_.addEventListener("p",By,BTe),m_.removeEventListener("p",By,!1));var jTe=yW;function VTe(e){return e!=null}function $Te(e){return Array.isArray(e)}function g_(e,r,o){return e?r:o}var HTe=function(r){for(var o=arguments.length,s=new Array(o>1?o-1:0),c=1;c<o;c++)s[c-1]=arguments[c];var d=Object.entries(r).filter(function(f){var m=Ge(f,1),g=m[0];return!s.includes(g)});return d.reduce(function(f,m){var g=Ge(m,2),_=g[0],S=g[1];return f[_]=S,f},{})};function WTe(e){var r=e.maxHeight,o=e.menuEl,s=e.minHeight,c=e.placement,d=e.shouldScroll,f=e.isFixedPosition,m=e.controlHeight,g=LTe(o),_={placement:"bottom",maxHeight:r};if(!o||!o.offsetParent)return _;var S=g.getBoundingClientRect(),T=S.height,R=o.getBoundingClientRect(),N=R.bottom,A=R.height,O=R.top,M=o.offsetParent.getBoundingClientRect(),x=M.top,P=f?window.innerHeight:kTe(g),D=_W(g),F=parseInt(getComputedStyle(o).marginBottom,10),$=parseInt(getComputedStyle(o).marginTop,10),V=x-$,W=P-O,K=V+D,Q=T-D-O,Y=N-P+D+F,ee=D+O-$,te=160;switch(c){case"auto":case"bottom":if(W>=A)return{placement:"bottom",maxHeight:r};if(Q>=A&&!f)return d&&f_(g,Y,te),{placement:"bottom",maxHeight:r};if(!f&&Q>=s||f&&W>=s){d&&f_(g,Y,te);var ie=f?W-F:Q-F;return{placement:"bottom",maxHeight:ie}}if(c==="auto"||f){var le=r,me=f?V:K;return me>=s&&(le=Math.min(me-F-m,r)),{placement:"top",maxHeight:le}}if(c==="bottom")return d&&jy(g,Y),{placement:"bottom",maxHeight:r};break;case"top":if(V>=A)return{placement:"top",maxHeight:r};if(K>=A&&!f)return d&&f_(g,ee,te),{placement:"top",maxHeight:r};if(!f&&K>=s||f&&V>=s){var ce=r;return(!f&&K>=s||f&&V>=s)&&(ce=f?V-$:K-$),d&&f_(g,ee,te),{placement:"top",maxHeight:ce}}return{placement:"bottom",maxHeight:r};default:throw new Error('Invalid placement provided "'.concat(c,'".'))}return _}function GTe(e){var r={bottom:"top",top:"bottom"};return e?r[e]:"bottom"}var SW=function(r){return r==="auto"?"bottom":r},zTe=function(r,o){var s,c=r.placement,d=r.theme,f=d.borderRadius,m=d.spacing,g=d.colors;return Oe((s={label:"menu"},ct(s,GTe(c),"100%"),ct(s,"position","absolute"),ct(s,"width","100%"),ct(s,"zIndex",1),s),o?{}:{backgroundColor:g.neutral0,borderRadius:f,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:m.menuGutter,marginTop:m.menuGutter})},CW=b.createContext(null),KTe=function(r){var o=r.children,s=r.minMenuHeight,c=r.maxMenuHeight,d=r.menuPlacement,f=r.menuPosition,m=r.menuShouldScrollIntoView,g=r.theme,_=b.useContext(CW)||{},S=_.setPortalPlacement,T=b.useRef(null),R=b.useState(c),N=Ge(R,2),A=N[0],O=N[1],M=b.useState(null),x=Ge(M,2),P=x[0],D=x[1],F=g.spacing.controlHeight;return JA(function(){var $=T.current;if($){var V=f==="fixed",W=m&&!V,K=WTe({maxHeight:c,menuEl:$,minHeight:s,placement:d,shouldScroll:W,isFixedPosition:V,controlHeight:F});O(K.maxHeight),D(K.placement),S==null||S(K.placement)}},[c,d,f,m,s,S,F]),o({ref:T,placerProps:Oe(Oe({},r),{},{placement:P||SW(d),maxHeight:A})})},YTe=function(r){var o=r.children,s=r.innerRef,c=r.innerProps;return Bt("div",Ze({},ti(r,"menu",{menu:!0}),{ref:s},c),o)},qTe=YTe,XTe=function(r,o){var s=r.maxHeight,c=r.theme.spacing.baseUnit;return Oe({maxHeight:s,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},o?{}:{paddingBottom:c,paddingTop:c})},JTe=function(r){var o=r.children,s=r.innerProps,c=r.innerRef,d=r.isMulti;return Bt("div",Ze({},ti(r,"menuList",{"menu-list":!0,"menu-list--is-multi":d}),{ref:c},s),o)},bW=function(r,o){var s=r.theme,c=s.spacing.baseUnit,d=s.colors;return Oe({textAlign:"center"},o?{}:{color:d.neutral40,padding:"".concat(c*2,"px ").concat(c*3,"px")})},QTe=bW,ZTe=bW,TW=function(r){var o=r.children,s=r.innerProps;return Bt("div",Ze({},ti(r,"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),s),o)};TW.defaultProps={children:"No options"};var RW=function(r){var o=r.children,s=r.innerProps;return Bt("div",Ze({},ti(r,"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),s),o)};RW.defaultProps={children:"Loading..."};var eRe=function(r){var o=r.rect,s=r.offset,c=r.position;return{left:o.left,position:c,top:s,width:o.width,zIndex:1}},tRe=function(r){var o=r.appendTo,s=r.children,c=r.controlElement,d=r.innerProps,f=r.menuPlacement,m=r.menuPosition,g=b.useRef(null),_=b.useRef(null),S=b.useState(SW(f)),T=Ge(S,2),R=T[0],N=T[1],A=b.useMemo(function(){return{setPortalPlacement:N}},[]),O=b.useState(null),M=Ge(O,2),x=M[0],P=M[1],D=b.useCallback(function(){if(c){var W=FTe(c),K=m==="fixed"?0:window.pageYOffset,Q=W[R]+K;(Q!==(x==null?void 0:x.offset)||W.left!==(x==null?void 0:x.rect.left)||W.width!==(x==null?void 0:x.rect.width))&&P({offset:Q,rect:W})}},[c,m,R,x==null?void 0:x.offset,x==null?void 0:x.rect.left,x==null?void 0:x.rect.width]);JA(function(){D()},[D]);var F=b.useCallback(function(){typeof _.current=="function"&&(_.current(),_.current=null),c&&g.current&&(_.current=xTe(c,g.current,D,{elementResize:"ResizeObserver"in window}))},[c,D]);JA(function(){F()},[F]);var $=b.useCallback(function(W){g.current=W,F()},[F]);if(!o&&m!=="fixed"||!x)return null;var V=Bt("div",Ze({ref:$},ti(Oe(Oe({},r),{},{offset:x.offset,position:m,rect:x.rect}),"menuPortal",{"menu-portal":!0}),d),s);return Bt(CW.Provider,{value:A},o?Nl.createPortal(V,o):V)},nRe=function(r){var o=r.isDisabled,s=r.isRtl;return{label:"container",direction:s?"rtl":void 0,pointerEvents:o?"none":void 0,position:"relative"}},rRe=function(r){var o=r.children,s=r.innerProps,c=r.isDisabled,d=r.isRtl;return Bt("div",Ze({},ti(r,"container",{"--is-disabled":c,"--is-rtl":d}),s),o)},iRe=function(r,o){var s=r.theme.spacing,c=r.isMulti,d=r.hasValue,f=r.selectProps.controlShouldRenderValue;return Oe({alignItems:"center",display:c&&d&&f?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},o?{}:{padding:"".concat(s.baseUnit/2,"px ").concat(s.baseUnit*2,"px")})},oRe=function(r){var o=r.children,s=r.innerProps,c=r.isMulti,d=r.hasValue;return Bt("div",Ze({},ti(r,"valueContainer",{"value-container":!0,"value-container--is-multi":c,"value-container--has-value":d}),s),o)},aRe=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},sRe=function(r){var o=r.children,s=r.innerProps;return Bt("div",Ze({},ti(r,"indicatorsContainer",{indicators:!0}),s),o)},s8,cRe=["size"],lRe={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},wW=function(r){var o=r.size,s=An(r,cRe);return Bt("svg",Ze({height:o,width:o,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:lRe},s))},mN=function(r){return Bt(wW,Ze({size:20},r),Bt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},IW=function(r){return Bt(wW,Ze({size:20},r),Bt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},AW=function(r,o){var s=r.isFocused,c=r.theme,d=c.spacing.baseUnit,f=c.colors;return Oe({label:"indicatorContainer",display:"flex",transition:"color 150ms"},o?{}:{color:s?f.neutral60:f.neutral20,padding:d*2,":hover":{color:s?f.neutral80:f.neutral40}})},uRe=AW,dRe=function(r){var o=r.children,s=r.innerProps;return Bt("div",Ze({},ti(r,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),s),o||Bt(IW,null))},hRe=AW,pRe=function(r){var o=r.children,s=r.innerProps;return Bt("div",Ze({},ti(r,"clearIndicator",{indicator:!0,"clear-indicator":!0}),s),o||Bt(mN,null))},fRe=function(r,o){var s=r.isDisabled,c=r.theme,d=c.spacing.baseUnit,f=c.colors;return Oe({label:"indicatorSeparator",alignSelf:"stretch",width:1},o?{}:{backgroundColor:s?f.neutral10:f.neutral20,marginBottom:d*2,marginTop:d*2})},mRe=function(r){var o=r.innerProps;return Bt("span",Ze({},o,ti(r,"indicatorSeparator",{"indicator-separator":!0})))},gRe=vTe(s8||(s8=ETe([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),vRe=function(r,o){var s=r.isFocused,c=r.size,d=r.theme,f=d.colors,m=d.spacing.baseUnit;return Oe({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:c,lineHeight:1,marginRight:c,textAlign:"center",verticalAlign:"middle"},o?{}:{color:s?f.neutral60:f.neutral20,padding:m*2})},Hw=function(r){var o=r.delay,s=r.offset;return Bt("span",{css:dN({animation:"".concat(gRe," 1s ease-in-out ").concat(o,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:s?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},OW=function(r){var o=r.innerProps,s=r.isRtl;return Bt("div",Ze({},ti(r,"loadingIndicator",{indicator:!0,"loading-indicator":!0}),o),Bt(Hw,{delay:0,offset:s}),Bt(Hw,{delay:160,offset:!0}),Bt(Hw,{delay:320,offset:!s}))};OW.defaultProps={size:4};var ERe=function(r,o){var s=r.isDisabled,c=r.isFocused,d=r.theme,f=d.colors,m=d.borderRadius,g=d.spacing;return Oe({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:g.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},o?{}:{backgroundColor:s?f.neutral5:f.neutral0,borderColor:s?f.neutral10:c?f.primary:f.neutral20,borderRadius:m,borderStyle:"solid",borderWidth:1,boxShadow:c?"0 0 0 1px ".concat(f.primary):void 0,"&:hover":{borderColor:c?f.primary:f.neutral30}})},_Re=function(r){var o=r.children,s=r.isDisabled,c=r.isFocused,d=r.innerRef,f=r.innerProps,m=r.menuIsOpen;return Bt("div",Ze({ref:d},ti(r,"control",{control:!0,"control--is-disabled":s,"control--is-focused":c,"control--menu-is-open":m}),f),o)},yRe=_Re,SRe=["data"],CRe=function(r,o){var s=r.theme.spacing;return o?{}:{paddingBottom:s.baseUnit*2,paddingTop:s.baseUnit*2}},bRe=function(r){var o=r.children,s=r.cx,c=r.getStyles,d=r.getClassNames,f=r.Heading,m=r.headingProps,g=r.innerProps,_=r.label,S=r.theme,T=r.selectProps;return Bt("div",Ze({},ti(r,"group",{group:!0}),g),Bt(f,Ze({},m,{selectProps:T,theme:S,getStyles:c,getClassNames:d,cx:s}),_),Bt("div",null,o))},TRe=function(r,o){var s=r.theme,c=s.colors,d=s.spacing;return Oe({label:"group",cursor:"default",display:"block"},o?{}:{color:c.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:d.baseUnit*3,paddingRight:d.baseUnit*3,textTransform:"uppercase"})},RRe=function(r){var o=EW(r);o.data;var s=An(o,SRe);return Bt("div",Ze({},ti(r,"groupHeading",{"group-heading":!0}),s))},wRe=bRe,IRe=["innerRef","isDisabled","isHidden","inputClassName"],ARe=function(r,o){var s=r.isDisabled,c=r.value,d=r.theme,f=d.spacing,m=d.colors;return Oe(Oe({visibility:s?"hidden":"visible",transform:c?"translateZ(0)":""},ORe),o?{}:{margin:f.baseUnit/2,paddingBottom:f.baseUnit/2,paddingTop:f.baseUnit/2,color:m.neutral80})},xW={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},ORe={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Oe({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},xW)},xRe=function(r){return Oe({label:"input",color:"inherit",background:0,opacity:r?0:1,width:"100%"},xW)},NRe=function(r){var o=r.cx,s=r.value,c=EW(r),d=c.innerRef,f=c.isDisabled,m=c.isHidden,g=c.inputClassName,_=An(c,IRe);return Bt("div",Ze({},ti(r,"input",{"input-container":!0}),{"data-value":s||""}),Bt("input",Ze({className:o({input:!0},g),ref:d,style:xRe(m),disabled:f},_)))},PRe=NRe,DRe=function(r,o){var s=r.theme,c=s.spacing,d=s.borderRadius,f=s.colors;return Oe({label:"multiValue",display:"flex",minWidth:0},o?{}:{backgroundColor:f.neutral10,borderRadius:d/2,margin:c.baseUnit/2})},kRe=function(r,o){var s=r.theme,c=s.borderRadius,d=s.colors,f=r.cropWithEllipsis;return Oe({overflow:"hidden",textOverflow:f||f===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},o?{}:{borderRadius:c/2,color:d.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},LRe=function(r,o){var s=r.theme,c=s.spacing,d=s.borderRadius,f=s.colors,m=r.isFocused;return Oe({alignItems:"center",display:"flex"},o?{}:{borderRadius:d/2,backgroundColor:m?f.dangerLight:void 0,paddingLeft:c.baseUnit,paddingRight:c.baseUnit,":hover":{backgroundColor:f.dangerLight,color:f.danger}})},NW=function(r){var o=r.children,s=r.innerProps;return Bt("div",s,o)},MRe=NW,FRe=NW;function URe(e){var r=e.children,o=e.innerProps;return Bt("div",Ze({role:"button"},o),r||Bt(mN,{size:14}))}var BRe=function(r){var o=r.children,s=r.components,c=r.data,d=r.innerProps,f=r.isDisabled,m=r.removeProps,g=r.selectProps,_=s.Container,S=s.Label,T=s.Remove;return Bt(_,{data:c,innerProps:Oe(Oe({},ti(r,"multiValue",{"multi-value":!0,"multi-value--is-disabled":f})),d),selectProps:g},Bt(S,{data:c,innerProps:Oe({},ti(r,"multiValueLabel",{"multi-value__label":!0})),selectProps:g},o),Bt(T,{data:c,innerProps:Oe(Oe({},ti(r,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(o||"option")},m),selectProps:g}))},jRe=BRe,VRe=function(r,o){var s=r.isDisabled,c=r.isFocused,d=r.isSelected,f=r.theme,m=f.spacing,g=f.colors;return Oe({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},o?{}:{backgroundColor:d?g.primary:c?g.primary25:"transparent",color:s?g.neutral20:d?g.neutral0:"inherit",padding:"".concat(m.baseUnit*2,"px ").concat(m.baseUnit*3,"px"),":active":{backgroundColor:s?void 0:d?g.primary:g.primary50}})},$Re=function(r){var o=r.children,s=r.isDisabled,c=r.isFocused,d=r.isSelected,f=r.innerRef,m=r.innerProps;return Bt("div",Ze({},ti(r,"option",{option:!0,"option--is-disabled":s,"option--is-focused":c,"option--is-selected":d}),{ref:f,"aria-disabled":s},m),o)},HRe=$Re,WRe=function(r,o){var s=r.theme,c=s.spacing,d=s.colors;return Oe({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},o?{}:{color:d.neutral50,marginLeft:c.baseUnit/2,marginRight:c.baseUnit/2})},GRe=function(r){var o=r.children,s=r.innerProps;return Bt("div",Ze({},ti(r,"placeholder",{placeholder:!0}),s),o)},zRe=GRe,KRe=function(r,o){var s=r.isDisabled,c=r.theme,d=c.spacing,f=c.colors;return Oe({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},o?{}:{color:s?f.neutral40:f.neutral80,marginLeft:d.baseUnit/2,marginRight:d.baseUnit/2})},YRe=function(r){var o=r.children,s=r.isDisabled,c=r.innerProps;return Bt("div",Ze({},ti(r,"singleValue",{"single-value":!0,"single-value--is-disabled":s}),c),o)},qRe=YRe,XRe={ClearIndicator:pRe,Control:yRe,DropdownIndicator:dRe,DownChevron:IW,CrossIcon:mN,Group:wRe,GroupHeading:RRe,IndicatorsContainer:sRe,IndicatorSeparator:mRe,Input:PRe,LoadingIndicator:OW,Menu:qTe,MenuList:JTe,MenuPortal:tRe,LoadingMessage:RW,NoOptionsMessage:TW,MultiValue:jRe,MultiValueContainer:MRe,MultiValueLabel:FRe,MultiValueRemove:URe,Option:HRe,Placeholder:zRe,SelectContainer:rRe,SingleValue:qRe,ValueContainer:oRe},JRe=function(r){return Oe(Oe({},XRe),r.components)},c8=Number.isNaN||function(r){return typeof r=="number"&&r!==r};function QRe(e,r){return!!(e===r||c8(e)&&c8(r))}function ZRe(e,r){if(e.length!==r.length)return!1;for(var o=0;o<e.length;o++)if(!QRe(e[o],r[o]))return!1;return!0}function e1e(e,r){r===void 0&&(r=ZRe);var o=null;function s(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];if(o&&o.lastThis===this&&r(c,o.lastArgs))return o.lastResult;var f=e.apply(this,c);return o={lastResult:f,lastArgs:c,lastThis:this},f}return s.clear=function(){o=null},s}var t1e={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},n1e=function(r){return Bt("span",Ze({css:t1e},r))},l8=n1e,r1e={guidance:function(r){var o=r.isSearchable,s=r.isMulti,c=r.isDisabled,d=r.tabSelectsValue,f=r.context;switch(f){case"menu":return"Use Up and Down to choose options".concat(c?"":", press Enter to select the currently focused option",", press Escape to exit the menu").concat(d?", press Tab to select the option and exit the menu":"",".");case"input":return"".concat(r["aria-label"]||"Select"," is focused ").concat(o?",type to refine list":"",", press Down to open the menu, ").concat(s?" press left to focus selected values":"");case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(r){var o=r.action,s=r.label,c=s===void 0?"":s,d=r.labels,f=r.isDisabled;switch(o){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(c,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(d.length>1?"s":""," ").concat(d.join(","),", selected.");case"select-option":return f?"option ".concat(c," is disabled. Select another option."):"option ".concat(c,", selected.");default:return""}},onFocus:function(r){var o=r.context,s=r.focused,c=r.options,d=r.label,f=d===void 0?"":d,m=r.selectValue,g=r.isDisabled,_=r.isSelected,S=function(A,O){return A&&A.length?"".concat(A.indexOf(O)+1," of ").concat(A.length):""};if(o==="value"&&m)return"value ".concat(f," focused, ").concat(S(m,s),".");if(o==="menu"){var T=g?" disabled":"",R="".concat(_?"selected":"focused").concat(T);return"option ".concat(f," ").concat(R,", ").concat(S(c,s),".")}return""},onFilter:function(r){var o=r.inputValue,s=r.resultsMessage;return"".concat(s).concat(o?" for search term "+o:"",".")}},i1e=function(r){var o=r.ariaSelection,s=r.focusedOption,c=r.focusedValue,d=r.focusableOptions,f=r.isFocused,m=r.selectValue,g=r.selectProps,_=r.id,S=g.ariaLiveMessages,T=g.getOptionLabel,R=g.inputValue,N=g.isMulti,A=g.isOptionDisabled,O=g.isSearchable,M=g.menuIsOpen,x=g.options,P=g.screenReaderStatus,D=g.tabSelectsValue,F=g["aria-label"],$=g["aria-live"],V=b.useMemo(function(){return Oe(Oe({},r1e),S||{})},[S]),W=b.useMemo(function(){var le="";if(o&&V.onChange){var me=o.option,ce=o.options,se=o.removedValue,ae=o.removedValues,ge=o.value,Se=function($e){return Array.isArray($e)?null:$e},de=se||me||Se(ge),he=de?T(de):"",be=ce||ae||void 0,ve=be?be.map(T):[],ke=Oe({isDisabled:de&&A(de,m),label:he,labels:ve},o);le=V.onChange(ke)}return le},[o,V,A,m,T]),K=b.useMemo(function(){var le="",me=s||c,ce=!!(s&&m&&m.includes(s));if(me&&V.onFocus){var se={focused:me,label:T(me),isDisabled:A(me,m),isSelected:ce,options:d,context:me===s?"menu":"value",selectValue:m};le=V.onFocus(se)}return le},[s,c,T,A,V,d,m]),Q=b.useMemo(function(){var le="";if(M&&x.length&&V.onFilter){var me=P({count:d.length});le=V.onFilter({inputValue:R,resultsMessage:me})}return le},[d,R,M,V,x,P]),Y=b.useMemo(function(){var le="";if(V.guidance){var me=c?"value":M?"menu":"input";le=V.guidance({"aria-label":F,context:me,isDisabled:s&&A(s,m),isMulti:N,isSearchable:O,tabSelectsValue:D})}return le},[F,s,c,N,A,O,M,V,m,D]),ee="".concat(K," ").concat(Q," ").concat(Y),te=Bt(b.Fragment,null,Bt("span",{id:"aria-selection"},W),Bt("span",{id:"aria-context"},ee)),ie=(o==null?void 0:o.action)==="initial-input-focus";return Bt(b.Fragment,null,Bt(l8,{id:_},ie&&te),Bt(l8,{"aria-live":$,"aria-atomic":"false","aria-relevant":"additions text"},f&&!ie&&te))},o1e=i1e,QA=[{base:"A",letters:"Aâ¶ï¼¡ÃÃÃáº¦áº¤áºªáº¨ÃÄÄáº°áº®áº´áº²È¦Ç ÃÇáº¢ÃÇºÇÈÈáº áº¬áº¶á¸ÄÈºâ±¯"},{base:"AA",letters:"ê²"},{base:"AE",letters:"ÃÇ¼Ç¢"},{base:"AO",letters:"ê´"},{base:"AU",letters:"ê¶"},{base:"AV",letters:"ê¸êº"},{base:"AY",letters:"ê¼"},{base:"B",letters:"Bâ·ï¼¢á¸á¸á¸ÉÆÆ"},{base:"C",letters:"Câ¸ï¼£ÄÄÄÄÃá¸ÆÈ»ê¾"},{base:"D",letters:"Dâ¹ï¼¤á¸Äá¸á¸á¸á¸ÄÆÆÆê¹"},{base:"DZ",letters:"Ç±Ç"},{base:"Dz",letters:"Ç²Ç"},{base:"E",letters:"Eâºï¼¥ÃÃÃá»áº¾á»á»áº¼Äá¸á¸ÄÄÃáººÄÈÈáº¸á»È¨á¸Äá¸á¸ÆÆ"},{base:"F",letters:"Fâ»ï¼¦á¸Æê»"},{base:"G",letters:"Gâ¼ï¼§Ç´Äá¸ ÄÄ Ç¦Ä¢Ç¤Æê ê½ê¾"},{base:"H",letters:"Hâ½ï¼¨Ä¤á¸¢á¸¦Èá¸¤á¸¨á¸ªÄ¦â±§â±µê"},{base:"I",letters:"Iâ¾ï¼©ÃÃÃÄ¨ÄªÄ¬Ä°Ãá¸®á»ÇÈÈá»Ä®á¸¬Æ"},{base:"J",letters:"Jâ¿ï¼ªÄ´É"},{base:"K",letters:"Kâï¼«á¸°Ç¨á¸²Ä¶á¸´Æâ±©êêêê¢"},{base:"L",letters:"Lâï¼¬Ä¿Ä¹Ä½á¸¶á¸¸Ä»á¸¼á¸ºÅÈ½â±¢â± êêê"},{base:"LJ",letters:"Ç"},{base:"Lj",letters:"Ç"},{base:"M",letters:"Mâï¼­á¸¾á¹á¹â±®Æ"},{base:"N",letters:"Nâï¼®Ç¸ÅÃá¹Åá¹Åá¹á¹È Æêê¤"},{base:"NJ",letters:"Ç"},{base:"Nj",letters:"Ç"},{base:"O",letters:"Oâï¼¯ÃÃÃá»á»á»á»Ãá¹È¬á¹Åá¹á¹ÅÈ®È°ÃÈªá»ÅÇÈÈÆ á»á»á» á»á»¢á»á»ÇªÇ¬ÃÇ¾ÆÆêê"},{base:"OI",letters:"Æ¢"},{base:"OO",letters:"ê"},{base:"OU",letters:"È¢"},{base:"P",letters:"Pâï¼°á¹á¹Æ¤â±£êêê"},{base:"Q",letters:"Qâï¼±êêÉ"},{base:"R",letters:"Râï¼²Åá¹ÅÈÈá¹á¹Åá¹Éâ±¤êê¦ê"},{base:"S",letters:"Sâï¼³áºÅá¹¤Åá¹ Å á¹¦á¹¢á¹¨ÈÅâ±¾ê¨ê"},{base:"T",letters:"Tâï¼´á¹ªÅ¤á¹¬ÈÅ¢á¹°á¹®Å¦Æ¬Æ®È¾ê"},{base:"TZ",letters:"ê¨"},{base:"U",letters:"Uâï¼µÃÃÃÅ¨á¹¸Åªá¹ºÅ¬ÃÇÇÇÇá»¦Å®Å°ÇÈÈÆ¯á»ªá»¨á»®á»¬á»°á»¤á¹²Å²á¹¶á¹´É"},{base:"V",letters:"Vâï¼¶á¹¼á¹¾Æ²êÉ"},{base:"VY",letters:"ê "},{base:"W",letters:"Wâï¼·áºáºÅ´áºáºáºâ±²"},{base:"X",letters:"Xâï¼¸áºáº"},{base:"Y",letters:"Yâï¼¹á»²ÃÅ¶á»¸È²áºÅ¸á»¶á»´Æ³Éá»¾"},{base:"Z",letters:"Zâï¼ºÅ¹áºÅ»Å½áºáºÆµÈ¤â±¿â±«ê¢"},{base:"a",letters:"aâï½áºÃ Ã¡Ã¢áº§áº¥áº«áº©Ã£ÄÄáº±áº¯áºµáº³È§Ç¡Ã¤Çáº£Ã¥Ç»ÇÈÈáº¡áº­áº·á¸Äâ±¥É"},{base:"aa",letters:"ê³"},{base:"ae",letters:"Ã¦Ç½Ç£"},{base:"ao",letters:"êµ"},{base:"au",letters:"ê·"},{base:"av",letters:"ê¹ê»"},{base:"ay",letters:"ê½"},{base:"b",letters:"bâï½á¸á¸á¸ÆÆÉ"},{base:"c",letters:"câï½ÄÄÄÄÃ§á¸ÆÈ¼ê¿â"},{base:"d",letters:"dâï½á¸Äá¸á¸á¸á¸ÄÆÉÉêº"},{base:"dz",letters:"Ç³Ç"},{base:"e",letters:"eâï½Ã¨Ã©Ãªá»áº¿á»á»áº½Äá¸á¸ÄÄÃ«áº»ÄÈÈáº¹á»È©á¸Äá¸á¸ÉÉÇ"},{base:"f",letters:"fâï½á¸Æê¼"},{base:"g",letters:"gâï½ÇµÄá¸¡ÄÄ¡Ç§Ä£Ç¥É ê¡áµ¹ê¿"},{base:"h",letters:"hâï½Ä¥á¸£á¸§Èá¸¥á¸©á¸«áºÄ§â±¨â±¶É¥"},{base:"hv",letters:"Æ"},{base:"i",letters:"iâï½Ã¬Ã­Ã®Ä©Ä«Ä­Ã¯á¸¯á»ÇÈÈá»Ä¯á¸­É¨Ä±"},{base:"j",letters:"jâï½ÄµÇ°É"},{base:"k",letters:"kâï½á¸±Ç©á¸³Ä·á¸µÆâ±ªêêêê£"},{base:"l",letters:"lâï½ÅÄºÄ¾á¸·á¸¹Ä¼á¸½á¸»Å¿ÅÆÉ«â±¡êêê"},{base:"lj",letters:"Ç"},{base:"m",letters:"mâï½á¸¿á¹á¹É±É¯"},{base:"n",letters:"nâï½Ç¹ÅÃ±á¹Åá¹Åá¹á¹ÆÉ²Åêê¥"},{base:"nj",letters:"Ç"},{base:"o",letters:"oâï½Ã²Ã³Ã´á»á»á»á»Ãµá¹È­á¹Åá¹á¹ÅÈ¯È±Ã¶È«á»ÅÇÈÈÆ¡á»á»á»¡á»á»£á»á»Ç«Ç­Ã¸Ç¿ÉêêÉµ"},{base:"oi",letters:"Æ£"},{base:"ou",letters:"È£"},{base:"oo",letters:"ê"},{base:"p",letters:"pâï½á¹á¹Æ¥áµ½êêê"},{base:"q",letters:"qâ ï½Éêê"},{base:"r",letters:"râ¡ï½Åá¹ÅÈÈá¹á¹Åá¹ÉÉ½êê§ê"},{base:"s",letters:"sâ¢ï½ÃÅá¹¥Åá¹¡Å¡á¹§á¹£á¹©ÈÅÈ¿ê©êáº"},{base:"t",letters:"tâ£ï½á¹«áºÅ¥á¹­ÈÅ£á¹±á¹¯Å§Æ­Êâ±¦ê"},{base:"tz",letters:"ê©"},{base:"u",letters:"uâ¤ï½Ã¹ÃºÃ»Å©á¹¹Å«á¹»Å­Ã¼ÇÇÇÇá»§Å¯Å±ÇÈÈÆ°á»«á»©á»¯á»­á»±á»¥á¹³Å³á¹·á¹µÊ"},{base:"v",letters:"vâ¥ï½á¹½á¹¿ÊêÊ"},{base:"vy",letters:"ê¡"},{base:"w",letters:"wâ¦ï½áºáºÅµáºáºáºáºâ±³"},{base:"x",letters:"xâ§ï½áºáº"},{base:"y",letters:"yâ¨ï½á»³Ã½Å·á»¹È³áºÃ¿á»·áºá»µÆ´Éá»¿"},{base:"z",letters:"zâ©ï½ÅºáºÅ¼Å¾áºáºÆ¶È¥Éâ±¬ê£"}],a1e=new RegExp("["+QA.map(function(e){return e.letters}).join("")+"]","g"),PW={};for(var Ww=0;Ww<QA.length;Ww++)for(var Gw=QA[Ww],zw=0;zw<Gw.letters.length;zw++)PW[Gw.letters[zw]]=Gw.base;var DW=function(r){return r.replace(a1e,function(o){return PW[o]})},s1e=e1e(DW),u8=function(r){return r.replace(/^\s+|\s+$/g,"")},c1e=function(r){return"".concat(r.label," ").concat(r.value)},l1e=function(r){return function(o,s){if(o.data.__isNew__)return!0;var c=Oe({ignoreCase:!0,ignoreAccents:!0,stringify:c1e,trim:!0,matchFrom:"any"},r),d=c.ignoreCase,f=c.ignoreAccents,m=c.stringify,g=c.trim,_=c.matchFrom,S=g?u8(s):s,T=g?u8(m(o)):m(o);return d&&(S=S.toLowerCase(),T=T.toLowerCase()),f&&(S=s1e(S),T=DW(T)),_==="start"?T.substr(0,S.length)===S:T.indexOf(S)>-1}},u1e=["innerRef"];function d1e(e){var r=e.innerRef,o=An(e,u1e),s=HTe(o,"onExited","in","enter","exit","appear");return Bt("input",Ze({ref:r},s,{css:dN({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var h1e=function(r){r.preventDefault(),r.stopPropagation()};function p1e(e){var r=e.isEnabled,o=e.onBottomArrive,s=e.onBottomLeave,c=e.onTopArrive,d=e.onTopLeave,f=b.useRef(!1),m=b.useRef(!1),g=b.useRef(0),_=b.useRef(null),S=b.useCallback(function(M,x){if(_.current!==null){var P=_.current,D=P.scrollTop,F=P.scrollHeight,$=P.clientHeight,V=_.current,W=x>0,K=F-$-D,Q=!1;K>x&&f.current&&(s&&s(M),f.current=!1),W&&m.current&&(d&&d(M),m.current=!1),W&&x>K?(o&&!f.current&&o(M),V.scrollTop=F,Q=!0,f.current=!0):!W&&-x>D&&(c&&!m.current&&c(M),V.scrollTop=0,Q=!0,m.current=!0),Q&&h1e(M)}},[o,s,c,d]),T=b.useCallback(function(M){S(M,M.deltaY)},[S]),R=b.useCallback(function(M){g.current=M.changedTouches[0].clientY},[]),N=b.useCallback(function(M){var x=g.current-M.changedTouches[0].clientY;S(M,x)},[S]),A=b.useCallback(function(M){if(M){var x=jTe?{passive:!1}:!1;M.addEventListener("wheel",T,x),M.addEventListener("touchstart",R,x),M.addEventListener("touchmove",N,x)}},[N,R,T]),O=b.useCallback(function(M){M&&(M.removeEventListener("wheel",T,!1),M.removeEventListener("touchstart",R,!1),M.removeEventListener("touchmove",N,!1))},[N,R,T]);return b.useEffect(function(){if(r){var M=_.current;return A(M),function(){O(M)}}},[r,A,O]),function(M){_.current=M}}var d8=["boxSizing","height","overflow","paddingRight","position"],h8={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function p8(e){e.preventDefault()}function f8(e){e.stopPropagation()}function m8(){var e=this.scrollTop,r=this.scrollHeight,o=e+this.offsetHeight;e===0?this.scrollTop=1:o===r&&(this.scrollTop=e-1)}function g8(){return"ontouchstart"in window||navigator.maxTouchPoints}var v8=!!(typeof window<"u"&&window.document&&window.document.createElement),tm=0,Tp={capture:!1,passive:!1};function f1e(e){var r=e.isEnabled,o=e.accountForScrollbars,s=o===void 0?!0:o,c=b.useRef({}),d=b.useRef(null),f=b.useCallback(function(g){if(v8){var _=document.body,S=_&&_.style;if(s&&d8.forEach(function(A){var O=S&&S[A];c.current[A]=O}),s&&tm<1){var T=parseInt(c.current.paddingRight,10)||0,R=document.body?document.body.clientWidth:0,N=window.innerWidth-R+T||0;Object.keys(h8).forEach(function(A){var O=h8[A];S&&(S[A]=O)}),S&&(S.paddingRight="".concat(N,"px"))}_&&g8()&&(_.addEventListener("touchmove",p8,Tp),g&&(g.addEventListener("touchstart",m8,Tp),g.addEventListener("touchmove",f8,Tp))),tm+=1}},[s]),m=b.useCallback(function(g){if(v8){var _=document.body,S=_&&_.style;tm=Math.max(tm-1,0),s&&tm<1&&d8.forEach(function(T){var R=c.current[T];S&&(S[T]=R)}),_&&g8()&&(_.removeEventListener("touchmove",p8,Tp),g&&(g.removeEventListener("touchstart",m8,Tp),g.removeEventListener("touchmove",f8,Tp)))}},[s]);return b.useEffect(function(){if(r){var g=d.current;return f(g),function(){m(g)}}},[r,f,m]),function(g){d.current=g}}var m1e=function(){return document.activeElement&&document.activeElement.blur()},g1e={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function v1e(e){var r=e.children,o=e.lockEnabled,s=e.captureEnabled,c=s===void 0?!0:s,d=e.onBottomArrive,f=e.onBottomLeave,m=e.onTopArrive,g=e.onTopLeave,_=p1e({isEnabled:c,onBottomArrive:d,onBottomLeave:f,onTopArrive:m,onTopLeave:g}),S=f1e({isEnabled:o}),T=function(N){_(N),S(N)};return Bt(b.Fragment,null,o&&Bt("div",{onClick:m1e,css:g1e}),r(T))}var E1e={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},_1e=function(r){var o=r.name,s=r.onFocus;return Bt("input",{required:!0,name:o,tabIndex:-1,"aria-hidden":"true",onFocus:s,css:E1e,value:"",onChange:function(){}})},y1e=_1e,S1e=function(r){return r.label},C1e=function(r){return r.label},b1e=function(r){return r.value},T1e=function(r){return!!r.isDisabled},R1e={clearIndicator:hRe,container:nRe,control:ERe,dropdownIndicator:uRe,group:CRe,groupHeading:TRe,indicatorsContainer:aRe,indicatorSeparator:fRe,input:ARe,loadingIndicator:vRe,loadingMessage:ZTe,menu:zTe,menuList:XTe,menuPortal:eRe,multiValue:DRe,multiValueLabel:kRe,multiValueRemove:LRe,noOptionsMessage:QTe,option:VRe,placeholder:WRe,singleValue:KRe,valueContainer:iRe},w1e={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},I1e=4,kW=4,A1e=38,O1e=kW*2,x1e={baseUnit:kW,controlHeight:A1e,menuGutter:O1e},Kw={borderRadius:I1e,colors:w1e,spacing:x1e},N1e={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:a8(),captureMenuScroll:!a8(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:l1e(),formatGroupLabel:S1e,getOptionLabel:C1e,getOptionValue:b1e,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:T1e,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!UTe(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(r){var o=r.count;return"".concat(o," result").concat(o!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function E8(e,r,o,s){var c=UW(e,r,o),d=BW(e,r,o),f=FW(e,r),m=Vy(e,r);return{type:"option",data:r,isDisabled:c,isSelected:d,label:f,value:m,index:s}}function LW(e,r){return e.options.map(function(o,s){if("options"in o){var c=o.options.map(function(f,m){return E8(e,f,r,m)}).filter(function(f){return _8(e,f)});return c.length>0?{type:"group",data:o,options:c,index:s}:void 0}var d=E8(e,o,r,s);return _8(e,d)?d:void 0}).filter(VTe)}function MW(e){return e.reduce(function(r,o){return o.type==="group"?r.push.apply(r,at(o.options.map(function(s){return s.data}))):r.push(o.data),r},[])}function P1e(e,r){return MW(LW(e,r))}function _8(e,r){var o=e.inputValue,s=o===void 0?"":o,c=r.data,d=r.isSelected,f=r.label,m=r.value;return(!VW(e)||!d)&&jW(e,{label:f,value:m,data:c},s)}function D1e(e,r){var o=e.focusedValue,s=e.selectValue,c=s.indexOf(o);if(c>-1){var d=r.indexOf(o);if(d>-1)return o;if(c<r.length)return r[c]}return null}function k1e(e,r){var o=e.focusedOption;return o&&r.indexOf(o)>-1?o:r[0]}var FW=function(r,o){return r.getOptionLabel(o)},Vy=function(r,o){return r.getOptionValue(o)};function UW(e,r,o){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(r,o):!1}function BW(e,r,o){if(o.indexOf(r)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(r,o);var s=Vy(e,r);return o.some(function(c){return Vy(e,c)===s})}function jW(e,r,o){return e.filterOption?e.filterOption(r,o):!0}var VW=function(r){var o=r.hideSelectedOptions,s=r.isMulti;return o===void 0?s:o},L1e=1,$W=function(e){yf(o,e);var r=Sf(o);function o(s){var c;if(Ts(this,o),c=r.call(this,s),c.state={ariaSelection:null,focusedOption:null,focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0},c.blockOptionHover=!1,c.isComposing=!1,c.commonProps=void 0,c.initialTouchX=0,c.initialTouchY=0,c.instancePrefix="",c.openAfterFocus=!1,c.scrollToFocusedOptionOnUpdate=!1,c.userIsDragging=void 0,c.controlRef=null,c.getControlRef=function(m){c.controlRef=m},c.focusedOptionRef=null,c.getFocusedOptionRef=function(m){c.focusedOptionRef=m},c.menuListRef=null,c.getMenuListRef=function(m){c.menuListRef=m},c.inputRef=null,c.getInputRef=function(m){c.inputRef=m},c.focus=c.focusInput,c.blur=c.blurInput,c.onChange=function(m,g){var _=c.props,S=_.onChange,T=_.name;g.name=T,c.ariaOnChange(m,g),S(m,g)},c.setValue=function(m,g,_){var S=c.props,T=S.closeMenuOnSelect,R=S.isMulti,N=S.inputValue;c.onInputChange("",{action:"set-value",prevInputValue:N}),T&&(c.setState({inputIsHiddenAfterUpdate:!R}),c.onMenuClose()),c.setState({clearFocusValueOnUpdate:!0}),c.onChange(m,{action:g,option:_})},c.selectOption=function(m){var g=c.props,_=g.blurInputOnSelect,S=g.isMulti,T=g.name,R=c.state.selectValue,N=S&&c.isOptionSelected(m,R),A=c.isOptionDisabled(m,R);if(N){var O=c.getOptionValue(m);c.setValue(R.filter(function(M){return c.getOptionValue(M)!==O}),"deselect-option",m)}else if(!A)S?c.setValue([].concat(at(R),[m]),"select-option",m):c.setValue(m,"select-option");else{c.ariaOnChange(m,{action:"select-option",option:m,name:T});return}_&&c.blurInput()},c.removeValue=function(m){var g=c.props.isMulti,_=c.state.selectValue,S=c.getOptionValue(m),T=_.filter(function(N){return c.getOptionValue(N)!==S}),R=g_(g,T,T[0]||null);c.onChange(R,{action:"remove-value",removedValue:m}),c.focusInput()},c.clearValue=function(){var m=c.state.selectValue;c.onChange(g_(c.props.isMulti,[],null),{action:"clear",removedValues:m})},c.popValue=function(){var m=c.props.isMulti,g=c.state.selectValue,_=g[g.length-1],S=g.slice(0,g.length-1),T=g_(m,S,S[0]||null);c.onChange(T,{action:"pop-value",removedValue:_})},c.getValue=function(){return c.state.selectValue},c.cx=function(){for(var m=arguments.length,g=new Array(m),_=0;_<m;_++)g[_]=arguments[_];return DTe.apply(void 0,[c.props.classNamePrefix].concat(g))},c.getOptionLabel=function(m){return FW(c.props,m)},c.getOptionValue=function(m){return Vy(c.props,m)},c.getStyles=function(m,g){var _=c.props.unstyled,S=R1e[m](g,_);S.boxSizing="border-box";var T=c.props.styles[m];return T?T(S,g):S},c.getClassNames=function(m,g){var _,S;return(_=(S=c.props.classNames)[m])===null||_===void 0?void 0:_.call(S,g)},c.getElementId=function(m){return"".concat(c.instancePrefix,"-").concat(m)},c.getComponents=function(){return JRe(c.props)},c.buildCategorizedOptions=function(){return LW(c.props,c.state.selectValue)},c.getCategorizedOptions=function(){return c.props.menuIsOpen?c.buildCategorizedOptions():[]},c.buildFocusableOptions=function(){return MW(c.buildCategorizedOptions())},c.getFocusableOptions=function(){return c.props.menuIsOpen?c.buildFocusableOptions():[]},c.ariaOnChange=function(m,g){c.setState({ariaSelection:Oe({value:m},g)})},c.onMenuMouseDown=function(m){m.button===0&&(m.stopPropagation(),m.preventDefault(),c.focusInput())},c.onMenuMouseMove=function(m){c.blockOptionHover=!1},c.onControlMouseDown=function(m){if(!m.defaultPrevented){var g=c.props.openMenuOnClick;c.state.isFocused?c.props.menuIsOpen?m.target.tagName!=="INPUT"&&m.target.tagName!=="TEXTAREA"&&c.onMenuClose():g&&c.openMenu("first"):(g&&(c.openAfterFocus=!0),c.focusInput()),m.target.tagName!=="INPUT"&&m.target.tagName!=="TEXTAREA"&&m.preventDefault()}},c.onDropdownIndicatorMouseDown=function(m){if(!(m&&m.type==="mousedown"&&m.button!==0)&&!c.props.isDisabled){var g=c.props,_=g.isMulti,S=g.menuIsOpen;c.focusInput(),S?(c.setState({inputIsHiddenAfterUpdate:!_}),c.onMenuClose()):c.openMenu("first"),m.preventDefault()}},c.onClearIndicatorMouseDown=function(m){m&&m.type==="mousedown"&&m.button!==0||(c.clearValue(),m.preventDefault(),c.openAfterFocus=!1,m.type==="touchend"?c.focusInput():setTimeout(function(){return c.focusInput()}))},c.onScroll=function(m){typeof c.props.closeMenuOnScroll=="boolean"?m.target instanceof HTMLElement&&sC(m.target)&&c.props.onMenuClose():typeof c.props.closeMenuOnScroll=="function"&&c.props.closeMenuOnScroll(m)&&c.props.onMenuClose()},c.onCompositionStart=function(){c.isComposing=!0},c.onCompositionEnd=function(){c.isComposing=!1},c.onTouchStart=function(m){var g=m.touches,_=g&&g.item(0);_&&(c.initialTouchX=_.clientX,c.initialTouchY=_.clientY,c.userIsDragging=!1)},c.onTouchMove=function(m){var g=m.touches,_=g&&g.item(0);if(_){var S=Math.abs(_.clientX-c.initialTouchX),T=Math.abs(_.clientY-c.initialTouchY),R=5;c.userIsDragging=S>R||T>R}},c.onTouchEnd=function(m){c.userIsDragging||(c.controlRef&&!c.controlRef.contains(m.target)&&c.menuListRef&&!c.menuListRef.contains(m.target)&&c.blurInput(),c.initialTouchX=0,c.initialTouchY=0)},c.onControlTouchEnd=function(m){c.userIsDragging||c.onControlMouseDown(m)},c.onClearIndicatorTouchEnd=function(m){c.userIsDragging||c.onClearIndicatorMouseDown(m)},c.onDropdownIndicatorTouchEnd=function(m){c.userIsDragging||c.onDropdownIndicatorMouseDown(m)},c.handleInputChange=function(m){var g=c.props.inputValue,_=m.currentTarget.value;c.setState({inputIsHiddenAfterUpdate:!1}),c.onInputChange(_,{action:"input-change",prevInputValue:g}),c.props.menuIsOpen||c.onMenuOpen()},c.onInputFocus=function(m){c.props.onFocus&&c.props.onFocus(m),c.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(c.openAfterFocus||c.props.openMenuOnFocus)&&c.openMenu("first"),c.openAfterFocus=!1},c.onInputBlur=function(m){var g=c.props.inputValue;if(c.menuListRef&&c.menuListRef.contains(document.activeElement)){c.inputRef.focus();return}c.props.onBlur&&c.props.onBlur(m),c.onInputChange("",{action:"input-blur",prevInputValue:g}),c.onMenuClose(),c.setState({focusedValue:null,isFocused:!1})},c.onOptionHover=function(m){c.blockOptionHover||c.state.focusedOption===m||c.setState({focusedOption:m})},c.shouldHideSelectedOptions=function(){return VW(c.props)},c.onValueInputFocus=function(m){m.preventDefault(),m.stopPropagation(),c.focus()},c.onKeyDown=function(m){var g=c.props,_=g.isMulti,S=g.backspaceRemovesValue,T=g.escapeClearsValue,R=g.inputValue,N=g.isClearable,A=g.isDisabled,O=g.menuIsOpen,M=g.onKeyDown,x=g.tabSelectsValue,P=g.openMenuOnFocus,D=c.state,F=D.focusedOption,$=D.focusedValue,V=D.selectValue;if(!A&&!(typeof M=="function"&&(M(m),m.defaultPrevented))){switch(c.blockOptionHover=!0,m.key){case"ArrowLeft":if(!_||R)return;c.focusValue("previous");break;case"ArrowRight":if(!_||R)return;c.focusValue("next");break;case"Delete":case"Backspace":if(R)return;if($)c.removeValue($);else{if(!S)return;_?c.popValue():N&&c.clearValue()}break;case"Tab":if(c.isComposing||m.shiftKey||!O||!x||!F||P&&c.isOptionSelected(F,V))return;c.selectOption(F);break;case"Enter":if(m.keyCode===229)break;if(O){if(!F||c.isComposing)return;c.selectOption(F);break}return;case"Escape":O?(c.setState({inputIsHiddenAfterUpdate:!1}),c.onInputChange("",{action:"menu-close",prevInputValue:R}),c.onMenuClose()):N&&T&&c.clearValue();break;case" ":if(R)return;if(!O){c.openMenu("first");break}if(!F)return;c.selectOption(F);break;case"ArrowUp":O?c.focusOption("up"):c.openMenu("last");break;case"ArrowDown":O?c.focusOption("down"):c.openMenu("first");break;case"PageUp":if(!O)return;c.focusOption("pageup");break;case"PageDown":if(!O)return;c.focusOption("pagedown");break;case"Home":if(!O)return;c.focusOption("first");break;case"End":if(!O)return;c.focusOption("last");break;default:return}m.preventDefault()}},c.instancePrefix="react-select-"+(c.props.instanceId||++L1e),c.state.selectValue=i8(s.value),s.menuIsOpen&&c.state.selectValue.length){var d=c.buildFocusableOptions(),f=d.indexOf(c.state.selectValue[0]);c.state.focusedOption=d[f]}return c}return Rs(o,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&o8(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(c){var d=this.props,f=d.isDisabled,m=d.menuIsOpen,g=this.state.isFocused;(g&&!f&&c.isDisabled||g&&m&&!c.menuIsOpen)&&this.focusInput(),g&&f&&!c.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!g&&!f&&c.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(o8(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(c,d){this.props.onInputChange(c,d)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(c){var d=this,f=this.state,m=f.selectValue,g=f.isFocused,_=this.buildFocusableOptions(),S=c==="first"?0:_.length-1;if(!this.props.isMulti){var T=_.indexOf(m[0]);T>-1&&(S=T)}this.scrollToFocusedOptionOnUpdate=!(g&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:_[S]},function(){return d.onMenuOpen()})}},{key:"focusValue",value:function(c){var d=this.state,f=d.selectValue,m=d.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var g=f.indexOf(m);m||(g=-1);var _=f.length-1,S=-1;if(f.length){switch(c){case"previous":g===0?S=0:g===-1?S=_:S=g-1;break;case"next":g>-1&&g<_&&(S=g+1);break}this.setState({inputIsHidden:S!==-1,focusedValue:f[S]})}}}},{key:"focusOption",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",d=this.props.pageSize,f=this.state.focusedOption,m=this.getFocusableOptions();if(m.length){var g=0,_=m.indexOf(f);f||(_=-1),c==="up"?g=_>0?_-1:m.length-1:c==="down"?g=(_+1)%m.length:c==="pageup"?(g=_-d,g<0&&(g=0)):c==="pagedown"?(g=_+d,g>m.length-1&&(g=m.length-1)):c==="last"&&(g=m.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:m[g],focusedValue:null})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(Kw):Oe(Oe({},Kw),this.props.theme):Kw}},{key:"getCommonProps",value:function(){var c=this.clearValue,d=this.cx,f=this.getStyles,m=this.getClassNames,g=this.getValue,_=this.selectOption,S=this.setValue,T=this.props,R=T.isMulti,N=T.isRtl,A=T.options,O=this.hasValue();return{clearValue:c,cx:d,getStyles:f,getClassNames:m,getValue:g,hasValue:O,isMulti:R,isRtl:N,options:A,selectOption:_,selectProps:T,setValue:S,theme:this.getTheme()}}},{key:"hasValue",value:function(){var c=this.state.selectValue;return c.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var c=this.props,d=c.isClearable,f=c.isMulti;return d===void 0?f:d}},{key:"isOptionDisabled",value:function(c,d){return UW(this.props,c,d)}},{key:"isOptionSelected",value:function(c,d){return BW(this.props,c,d)}},{key:"filterOption",value:function(c,d){return jW(this.props,c,d)}},{key:"formatOptionLabel",value:function(c,d){if(typeof this.props.formatOptionLabel=="function"){var f=this.props.inputValue,m=this.state.selectValue;return this.props.formatOptionLabel(c,{context:d,inputValue:f,selectValue:m})}else return this.getOptionLabel(c)}},{key:"formatGroupLabel",value:function(c){return this.props.formatGroupLabel(c)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var c=this.props,d=c.isDisabled,f=c.isSearchable,m=c.inputId,g=c.inputValue,_=c.tabIndex,S=c.form,T=c.menuIsOpen,R=c.required,N=this.getComponents(),A=N.Input,O=this.state,M=O.inputIsHidden,x=O.ariaSelection,P=this.commonProps,D=m||this.getElementId("input"),F=Oe(Oe(Oe({"aria-autocomplete":"list","aria-expanded":T,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":R,role:"combobox"},T&&{"aria-controls":this.getElementId("listbox"),"aria-owns":this.getElementId("listbox")}),!f&&{"aria-readonly":!0}),this.hasValue()?(x==null?void 0:x.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return f?b.createElement(A,Ze({},P,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:D,innerRef:this.getInputRef,isDisabled:d,isHidden:M,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:_,form:S,type:"text",value:g},F)):b.createElement(d1e,Ze({id:D,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:By,onFocus:this.onInputFocus,disabled:d,tabIndex:_,inputMode:"none",form:S,value:""},F))}},{key:"renderPlaceholderOrValue",value:function(){var c=this,d=this.getComponents(),f=d.MultiValue,m=d.MultiValueContainer,g=d.MultiValueLabel,_=d.MultiValueRemove,S=d.SingleValue,T=d.Placeholder,R=this.commonProps,N=this.props,A=N.controlShouldRenderValue,O=N.isDisabled,M=N.isMulti,x=N.inputValue,P=N.placeholder,D=this.state,F=D.selectValue,$=D.focusedValue,V=D.isFocused;if(!this.hasValue()||!A)return x?null:b.createElement(T,Ze({},R,{key:"placeholder",isDisabled:O,isFocused:V,innerProps:{id:this.getElementId("placeholder")}}),P);if(M)return F.map(function(K,Q){var Y=K===$,ee="".concat(c.getOptionLabel(K),"-").concat(c.getOptionValue(K));return b.createElement(f,Ze({},R,{components:{Container:m,Label:g,Remove:_},isFocused:Y,isDisabled:O,key:ee,index:Q,removeProps:{onClick:function(){return c.removeValue(K)},onTouchEnd:function(){return c.removeValue(K)},onMouseDown:function(ie){ie.preventDefault()}},data:K}),c.formatOptionLabel(K,"value"))});if(x)return null;var W=F[0];return b.createElement(S,Ze({},R,{data:W,isDisabled:O}),this.formatOptionLabel(W,"value"))}},{key:"renderClearIndicator",value:function(){var c=this.getComponents(),d=c.ClearIndicator,f=this.commonProps,m=this.props,g=m.isDisabled,_=m.isLoading,S=this.state.isFocused;if(!this.isClearable()||!d||g||!this.hasValue()||_)return null;var T={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return b.createElement(d,Ze({},f,{innerProps:T,isFocused:S}))}},{key:"renderLoadingIndicator",value:function(){var c=this.getComponents(),d=c.LoadingIndicator,f=this.commonProps,m=this.props,g=m.isDisabled,_=m.isLoading,S=this.state.isFocused;if(!d||!_)return null;var T={"aria-hidden":"true"};return b.createElement(d,Ze({},f,{innerProps:T,isDisabled:g,isFocused:S}))}},{key:"renderIndicatorSeparator",value:function(){var c=this.getComponents(),d=c.DropdownIndicator,f=c.IndicatorSeparator;if(!d||!f)return null;var m=this.commonProps,g=this.props.isDisabled,_=this.state.isFocused;return b.createElement(f,Ze({},m,{isDisabled:g,isFocused:_}))}},{key:"renderDropdownIndicator",value:function(){var c=this.getComponents(),d=c.DropdownIndicator;if(!d)return null;var f=this.commonProps,m=this.props.isDisabled,g=this.state.isFocused,_={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return b.createElement(d,Ze({},f,{innerProps:_,isDisabled:m,isFocused:g}))}},{key:"renderMenu",value:function(){var c=this,d=this.getComponents(),f=d.Group,m=d.GroupHeading,g=d.Menu,_=d.MenuList,S=d.MenuPortal,T=d.LoadingMessage,R=d.NoOptionsMessage,N=d.Option,A=this.commonProps,O=this.state.focusedOption,M=this.props,x=M.captureMenuScroll,P=M.inputValue,D=M.isLoading,F=M.loadingMessage,$=M.minMenuHeight,V=M.maxMenuHeight,W=M.menuIsOpen,K=M.menuPlacement,Q=M.menuPosition,Y=M.menuPortalTarget,ee=M.menuShouldBlockScroll,te=M.menuShouldScrollIntoView,ie=M.noOptionsMessage,le=M.onMenuScrollToTop,me=M.onMenuScrollToBottom;if(!W)return null;var ce=function(be,ve){var ke=be.type,Le=be.data,$e=be.isDisabled,Ve=be.isSelected,ut=be.label,ht=be.value,Ct=O===Le,gt=$e?void 0:function(){return c.onOptionHover(Le)},kt=$e?void 0:function(){return c.selectOption(Le)},It="".concat(c.getElementId("option"),"-").concat(ve),Lt={id:It,onClick:kt,onMouseMove:gt,onMouseOver:gt,tabIndex:-1};return b.createElement(N,Ze({},A,{innerProps:Lt,data:Le,isDisabled:$e,isSelected:Ve,key:It,label:ut,type:ke,value:ht,isFocused:Ct,innerRef:Ct?c.getFocusedOptionRef:void 0}),c.formatOptionLabel(be.data,"menu"))},se;if(this.hasOptions())se=this.getCategorizedOptions().map(function(he){if(he.type==="group"){var be=he.data,ve=he.options,ke=he.index,Le="".concat(c.getElementId("group"),"-").concat(ke),$e="".concat(Le,"-heading");return b.createElement(f,Ze({},A,{key:Le,data:be,options:ve,Heading:m,headingProps:{id:$e,data:he.data},label:c.formatGroupLabel(he.data)}),he.options.map(function(Ve){return ce(Ve,"".concat(ke,"-").concat(Ve.index))}))}else if(he.type==="option")return ce(he,"".concat(he.index))});else if(D){var ae=F({inputValue:P});if(ae===null)return null;se=b.createElement(T,A,ae)}else{var ge=ie({inputValue:P});if(ge===null)return null;se=b.createElement(R,A,ge)}var Se={minMenuHeight:$,maxMenuHeight:V,menuPlacement:K,menuPosition:Q,menuShouldScrollIntoView:te},de=b.createElement(KTe,Ze({},A,Se),function(he){var be=he.ref,ve=he.placerProps,ke=ve.placement,Le=ve.maxHeight;return b.createElement(g,Ze({},A,Se,{innerRef:be,innerProps:{onMouseDown:c.onMenuMouseDown,onMouseMove:c.onMenuMouseMove,id:c.getElementId("listbox")},isLoading:D,placement:ke}),b.createElement(v1e,{captureEnabled:x,onTopArrive:le,onBottomArrive:me,lockEnabled:ee},function($e){return b.createElement(_,Ze({},A,{innerRef:function(ut){c.getMenuListRef(ut),$e(ut)},isLoading:D,maxHeight:Le,focusedOption:O}),se)}))});return Y||Q==="fixed"?b.createElement(S,Ze({},A,{appendTo:Y,controlElement:this.controlRef,menuPlacement:K,menuPosition:Q}),de):de}},{key:"renderFormField",value:function(){var c=this,d=this.props,f=d.delimiter,m=d.isDisabled,g=d.isMulti,_=d.name,S=d.required,T=this.state.selectValue;if(S&&!this.hasValue()&&!m)return b.createElement(y1e,{name:_,onFocus:this.onValueInputFocus});if(!(!_||m))if(g)if(f){var R=T.map(function(O){return c.getOptionValue(O)}).join(f);return b.createElement("input",{name:_,type:"hidden",value:R})}else{var N=T.length>0?T.map(function(O,M){return b.createElement("input",{key:"i-".concat(M),name:_,type:"hidden",value:c.getOptionValue(O)})}):b.createElement("input",{name:_,type:"hidden",value:""});return b.createElement("div",null,N)}else{var A=T[0]?this.getOptionValue(T[0]):"";return b.createElement("input",{name:_,type:"hidden",value:A})}}},{key:"renderLiveRegion",value:function(){var c=this.commonProps,d=this.state,f=d.ariaSelection,m=d.focusedOption,g=d.focusedValue,_=d.isFocused,S=d.selectValue,T=this.getFocusableOptions();return b.createElement(o1e,Ze({},c,{id:this.getElementId("live-region"),ariaSelection:f,focusedOption:m,focusedValue:g,isFocused:_,selectValue:S,focusableOptions:T}))}},{key:"render",value:function(){var c=this.getComponents(),d=c.Control,f=c.IndicatorsContainer,m=c.SelectContainer,g=c.ValueContainer,_=this.props,S=_.className,T=_.id,R=_.isDisabled,N=_.menuIsOpen,A=this.state.isFocused,O=this.commonProps=this.getCommonProps();return b.createElement(m,Ze({},O,{className:S,innerProps:{id:T,onKeyDown:this.onKeyDown},isDisabled:R,isFocused:A}),this.renderLiveRegion(),b.createElement(d,Ze({},O,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:R,isFocused:A,menuIsOpen:N}),b.createElement(g,Ze({},O,{isDisabled:R}),this.renderPlaceholderOrValue(),this.renderInput()),b.createElement(f,Ze({},O,{isDisabled:R}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(c,d){var f=d.prevProps,m=d.clearFocusValueOnUpdate,g=d.inputIsHiddenAfterUpdate,_=d.ariaSelection,S=d.isFocused,T=d.prevWasFocused,R=c.options,N=c.value,A=c.menuIsOpen,O=c.inputValue,M=c.isMulti,x=i8(N),P={};if(f&&(N!==f.value||R!==f.options||A!==f.menuIsOpen||O!==f.inputValue)){var D=A?P1e(c,x):[],F=m?D1e(d,x):null,$=k1e(d,D);P={selectValue:x,focusedOption:$,focusedValue:F,clearFocusValueOnUpdate:!1}}var V=g!=null&&c!==f?{inputIsHidden:g,inputIsHiddenAfterUpdate:void 0}:{},W=_,K=S&&T;return S&&!K&&(W={value:g_(M,x,x[0]||null),options:x,action:"initial-input-focus"},K=!T),(_==null?void 0:_.action)==="initial-input-focus"&&(W=null),Oe(Oe(Oe({},P),V),{},{prevProps:c,ariaSelection:W,prevWasFocused:K})}}]),o}(b.Component);$W.defaultProps=N1e;var M1e=b.forwardRef(function(e,r){var o=mbe(e);return b.createElement($W,Ze({ref:r},o))}),F1e=M1e;const{Title:U1e,Paragraph:B1e}=Ao,j1e=b.memo(function({label:r}){const s=oc().filter(g=>g.hasAudio||g.hasVideo),c=Im(g=>g.localTracks),d=Im(g=>g.hostRoom),f=bs(),m=Cs();return ne.jsxs("div",{className:"room-selector-item",children:[ne.jsx("i",{className:"i-mdi-chat-processing-outline text-5 color-zinc"}),ne.jsx("code",{className:"bg-rose color-white px-2 rounded",children:r}),f&&c&&m.uid&&(d==null?void 0:d.client.channelName)===m.channelName&&ne.jsxs("div",{className:"user",children:[ne.jsx(j8,{audioTrack:c[0],cameraOn:!0,micOn:!0,videoTrack:c[1]}),ne.jsx("div",{className:"mask"}),ne.jsx("label",{className:"label",children:ic(m.uid)})]},m.uid),ne.jsx(ne.Fragment,{children:s.map(g=>ne.jsxs("div",{className:"user",children:[ne.jsx(lO,{user:g}),ne.jsx("div",{className:"mask"}),ne.jsx("label",{className:"label",children:ic(g.uid)})]},g.uid))})]})}),V1e=({innerProps:e,isDisabled:r,label:o,data:s})=>{const{client:c}=s.value;return r?null:ne.jsx("div",{...e,children:ne.jsx(M8,{client:c,children:ne.jsx(j1e,{label:o})})})},$1e=()=>{const e=Im(f=>f.getRooms),[r,o]=b.useState(!1);b.useEffect(()=>{e()},[]);const s=Im(f=>f.rooms),c=Im(f=>f.selectChannel),d=b.useMemo(()=>s==null?void 0:s.map(f=>({label:f.channel.replace(/[^0-9]*/,"Room"),value:f})),[s]);return ne.jsx(ni,{children:r?ne.jsx("div",{className:"max-w-lg p-10",children:ne.jsx(F1e,{components:{Option:V1e},isMulti:!1,menuIsOpen:!0,onChange:f=>{var m;return c((m=f==null?void 0:f.value)==null?void 0:m.channel)},options:d})}):ne.jsxs("div",{className:"h-screen p-3",children:[ne.jsx(U1e,{children:"multi-channel"}),ne.jsx(B1e,{children:"This is multi-channel example. By create multi Agora Client. You can join multi-channel"}),ne.jsx("div",{className:"text-xl",children:ne.jsx(wi,{onClick:()=>o(!0),type:"primary",children:"show demo"})})]})})};function HW({videoTracks:e}){return ne.jsx(ne.Fragment,{children:e.map(r=>ne.jsxs(Es.Item,{children:[ne.jsx(Tg,{cover:Bc(),track:r},r.getUserId()),ne.jsx(Al,{children:`${ic(r.getUserId())}{${r.getUserId()}}`})]},r.getUserId()))})}const H1e=()=>{const[e,r]=b.useState(!1);Ii({appid:pt.appId,channel:pt.channel,token:pt.token},e);const[o,s]=b.useState(!1),[c,d]=b.useState(!1),[f,m]=b.useState(!1),{screenTrack:g,error:_}=F8(f,{},"auto");b.useEffect(()=>{m(!1)},[_]);const S=oc(),{videoTracks:T}=mf(S.filter(N=>N.uid!==pt.ShareScreenUID)),{audioTracks:R}=ff(S.filter(N=>N.uid!==pt.ShareScreenUID));return R.map(N=>N.play()),ne.jsxs(ni,{children:[ne.jsx("div",{className:"h-screen p-3",children:e&&ne.jsxs(ne.Fragment,{children:[ne.jsx(wi,{onClick:()=>m(N=>!N),type:"primary",children:f?"stop share screen":"start share screen"}),f&&ne.jsx(VCe,{onCloseScreenShare:()=>{m(!1)},screenShareOn:f,screenTrack:g}),ne.jsx(zS,{cameraOn:c,micOn:o,renderRemoteUsers:()=>ne.jsx(HW,{videoTracks:T})})]})}),ne.jsx(ga,{calling:e,cameraOn:c,micOn:o,setCalling:()=>{r(N=>!N),m(!1)},setCamera:()=>{d(N=>!N)},setMic:()=>{s(N=>!N)}})]})};const{Title:W1e,Paragraph:G1e,Text:z1e}=Ao,K1e=()=>{const[e,r]=b.useState(!1);Ii({appid:pt.appId,channel:pt.channel,token:pt.token},e);const[o,s]=b.useState(!1),[c,d]=b.useState(!1),f=oc(),[m,g]=b.useState(!0),{videoTracks:_}=mf(m?f:f.filter((N,A)=>A==0)),{audioTracks:S}=ff(f);S.map(N=>N.play());const T=()=>ne.jsx("div",{className:"p-4 text-xl",children:ne.jsx(wi,{onClick:()=>g(N=>!N),type:"primary",children:`switch to layout ${m?2:1}`})}),R=()=>ne.jsx(ne.Fragment,{children:m?ne.jsx(Y1e,{videoTracks:_}):ne.jsx(q1e,{videoTracks:_})});return ne.jsxs(ni,{children:[e?ne.jsx(zS,{cameraOn:c,micOn:o,renderAction:T,renderRemoteUsers:R}):ne.jsxs("div",{className:"h-screen p-3",children:[ne.jsx(W1e,{children:"SwitchLayout"}),ne.jsxs(G1e,{children:["By using ",ne.jsx(z1e,{keyboard:!0,children:"useRemoteVideoTracks"})," hook to dynamically switch the camera track, this will not generate a new track, but only dynamically subscribe and unsubscribe the track according to your needs."]})]}),ne.jsx(ga,{calling:e,cameraOn:c,micOn:o,setCalling:()=>{r(N=>!N)},setCamera:()=>{d(N=>!N)},setMic:()=>{s(N=>!N)}})]})};function Y1e({videoTracks:e}){return ne.jsx(ne.Fragment,{children:e.map(r=>ne.jsxs(Es.Item,{children:[ne.jsx(Tg,{cover:Bc(),track:r},r.getUserId()),ne.jsx(Al,{children:`Layout1 ${ic(r.getUserId())}{${r.getUserId()}}`})]},r.getUserId()))})}function q1e({videoTracks:e}){return ne.jsx(ne.Fragment,{children:e.map(r=>ne.jsxs(Es.Item,{children:[ne.jsx(Tg,{cover:Bc(),track:r},r.getUserId()),ne.jsx(Al,{children:`Layout2 ${ic(r.getUserId())}{${r.getUserId()}}`})]},r.getUserId()))})}const WW=[{label:"switch-layout",component:K1e},{label:"multi-channel",component:$1e},{label:"share-screen",component:H1e}],X1e=()=>{const[e,r]=b.useState(!1);Ii({appid:pt.appId,channel:pt.channel,token:pt.token},e);const[o,s]=b.useState(!1),[c,d]=b.useState(!1),f=oc(),{videoTracks:m}=mf(f),{audioTracks:g}=ff(f);return g.map(_=>_.play()),ne.jsxs(ni,{children:[e?ne.jsx(zS,{cameraOn:c,micOn:o,renderRemoteUsers:()=>ne.jsx(HW,{videoTracks:m})}):ne.jsx(ni,{}),ne.jsx(ga,{calling:e,cameraOn:c,micOn:o,setCalling:()=>{r(_=>!_)},setCamera:()=>{d(_=>!_)},setMic:()=>{s(_=>!_)}})]})},GW=[{label:"overview",component:X1e}],{Title:J1e,Paragraph:Yw}=Ao,Q1e=()=>{Ii({appid:pt.appId,channel:pt.channel,token:pt.token},!0);const[e,r]=b.useState(!1),[o,s]=b.useState(),{localMicrophoneTrack:c}=hf(e);return Gu([c]),b.useEffect(()=>{c&&s({muted:c.muted,isPlaying:c.isPlaying,enabled:c.enabled})},[e,c]),ne.jsxs(ni,{children:[ne.jsxs("div",{className:"h-screen p-3",children:[ne.jsx(J1e,{children:"local audio track status"}),o&&ne.jsxs(ne.Fragment,{children:[ne.jsx(Yw,{children:`muted: ${o==null?void 0:o.muted}`}),ne.jsx(Yw,{children:`isPlaying: ${o.isPlaying}`}),ne.jsx(Yw,{children:`enabled: ${o==null?void 0:o.enabled}`})]}),ne.jsx(Gy,{disabled:!e,track:c})]}),ne.jsx(ga,{micOn:e,setMic:()=>{r(d=>!d)}})]})},{Title:Z1e}=Ao,ewe=()=>{Ii({appid:pt.appId,channel:pt.channel,token:pt.token},!0);const[e,r]=b.useState(!1),[o,s]=b.useState(!1),[c,d]=b.useState(!1),[f,m]=b.useState(!1),{localMicrophoneTrack:g}=hf(e),{localCameraTrack:_}=pf(o);return Gu([g,_]),ne.jsxs(ni,{children:[ne.jsxs("div",{className:"h-screen p-3 overflow-auto",children:[ne.jsx(Z1e,{children:"local user status"}),ne.jsxs(wi,{className:"m-2",onClick:()=>{m(S=>!S)},type:f?"primary":"default",children:["playAudio : ",JSON.stringify(f)]}),ne.jsxs(wi,{className:"m-2",onClick:()=>{d(S=>!S)},type:c?"primary":"default",children:["playVideo : ",JSON.stringify(c)]}),ne.jsx(wi,{className:"m-2",onClick:()=>{d(!0),s(!1)},type:"primary",children:"cameraOn=false playVideo=true"}),ne.jsx(wi,{className:"m-2",onClick:()=>{d(!1),s(!0)},type:"primary",children:"cameraOn=true playVideo=false"}),ne.jsx(j8,{audioTrack:g,cameraOn:o,className:"m-2",micOn:e,playAudio:f,playVideo:c,style:{width:"300px",height:"300px"},videoTrack:_})]}),ne.jsx(ga,{cameraOn:o,micOn:e,setCamera:()=>{s(S=>!S)},setMic:()=>{r(S=>!S)}})]})},{Title:twe}=Ao,nwe=()=>{Ii({appid:pt.appId,channel:pt.channel,token:pt.token},!0);const[e,r]=b.useState(!1),{localCameraTrack:o}=pf();return Gu([o]),ne.jsxs(ni,{children:[ne.jsxs("div",{className:"h-screen p-3",children:[ne.jsx(twe,{children:"local video track"}),ne.jsx(ag,{disabled:!e,play:e,style:{width:"300px",height:"300px"},track:o})]}),ne.jsx(ga,{cameraOn:e,setCamera:()=>{r(s=>!s)}})]})},{Title:rwe}=Ao,iwe=()=>{const[e,r]=b.useState(!1);Ii({appid:pt.appId,channel:pt.channel,token:pt.token},e);const[o,s]=b.useState(),c=oc(),{audioTracks:d}=ff(c);return b.useEffect(()=>{if(d&&d.length>0){const f=[];d.map(m=>{f.push({isPlay:m.isPlaying,id:m.getTrackId(),track:m})}),s(f)}else s([])},[d]),b.useEffect(()=>{e||s([])},[e]),ne.jsxs(ni,{children:[ne.jsxs("div",{className:"h-screen p-3",children:[ne.jsx(rwe,{children:"remote audio track status"}),o&&o.length>0&&o.map(f=>ne.jsxs("div",{children:[ne.jsx("div",{className:"p-4 text-xl",children:ne.jsx(wi,{onClick:()=>{f.isPlay=!f.isPlay,s([...o])},type:"primary",children:"switch this remote audio track play status"})}),f.isPlay,ne.jsx(V8,{play:f.isPlay,track:f.track})]},f.id))]}),ne.jsx(ga,{calling:e,setCalling:()=>{r(f=>!f)}})]})},{Title:owe}=Ao,awe=()=>{const[e,r]=b.useState(!1),o=b.useMemo(()=>Bc(),[]);Ii({appid:pt.appId,channel:pt.channel,token:pt.token},e);const[s,c]=b.useState(),d=oc();return b.useEffect(()=>{if(d.length>0){const f=[];d.map(m=>{f.push({playVideo:!0,playAudio:!0,id:m.uid,user:m})}),c(f)}else c([])},[d]),b.useEffect(()=>{e||c([])},[e]),ne.jsxs(ni,{children:[ne.jsxs("div",{className:"h-screen p-3",children:[ne.jsx(owe,{children:"RemoteUser"}),s&&s.length>0&&s.map(f=>ne.jsxs("div",{children:[ne.jsxs("div",{className:"text-xl",children:[ne.jsx(wi,{className:"m-2",onClick:()=>{f.playVideo=!f.playVideo,c([...s])},type:f.playVideo?"default":"primary",children:`${f.playVideo?"stop":"play"} RemoteUser Video`}),ne.jsx(wi,{className:"m-2",onClick:()=>{f.playAudio=!f.playAudio,c([...s])},type:f.playAudio?"default":"primary",children:`${f.playAudio?"stop":"play"} RemoteUser Audio`})]}),ne.jsx("div",{className:"p-4 text-xl",children:ne.jsx(lO,{cover:o,playAudio:f.playAudio,playVideo:f.playVideo,style:{width:"150px",height:"100px"},user:f.user})})]},f.id))]}),ne.jsx(ga,{calling:e,setCalling:()=>{r(f=>!f)}})]})},{Title:swe}=Ao,cwe=()=>{const[e,r]=b.useState(!1);Ii({appid:pt.appId,channel:pt.channel,token:pt.token},e);const[o,s]=b.useState(),c=oc(),{videoTracks:d}=mf(c);return b.useEffect(()=>{if(d&&d.length>0){const f=[];d.map(m=>{f.push({isPlay:!0,id:m.getTrackId(),track:m})}),s(f)}else s([])},[d]),b.useEffect(()=>{e||s([])},[e]),ne.jsxs(ni,{children:[ne.jsxs("div",{className:"h-screen p-3",children:[ne.jsx(swe,{children:"remote video track status"}),o&&o.length>0&&o.map(f=>ne.jsxs("div",{children:[ne.jsx("div",{className:"p-4 text-xl",children:ne.jsx(wi,{onClick:()=>{f.isPlay=!f.isPlay,s([...o])},type:"primary",children:"switch this remote video track play status"})}),ne.jsx("div",{className:"p-4 text-xl",children:ne.jsx(cO,{play:f.isPlay,style:{width:"150px",height:"100px"},track:f.track})})]},f.id))]}),ne.jsx(ga,{calling:e,setCalling:()=>{r(f=>!f)}})]})},zW=[{label:"LocalAudioTrack",component:Q1e},{label:"RemoteAudioTrack",component:iwe},{label:"LocalVideoTrack",component:nwe},{label:"RemoteVideoTrack",component:cwe},{label:"LocalUser",component:ewe},{label:"RemoteUser",component:awe}],{Title:lwe}=Ao,uwe=()=>{Ii({appid:pt.appId,channel:pt.channel,token:pt.token},!0);const[e,r]=b.useState(!1),{localMicrophoneTrack:o}=hf();return sO(o,e),ne.jsxs(ni,{children:[ne.jsx("div",{className:"h-screen p-3",children:ne.jsx(lwe,{children:"useAutoPlayAudioTrack"})}),ne.jsx(ga,{micOn:e,setMic:()=>{r(s=>!s)}})]})},{Title:dwe}=Ao,hwe=()=>{Ii({appid:pt.appId,channel:pt.channel,token:pt.token},!0);const[e,r]=b.useState(!1),o=b.useRef(null),{localCameraTrack:s}=pf();return aO(s,e,o.current),ne.jsxs(ni,{children:[ne.jsxs("div",{className:"h-screen p-3",children:[ne.jsx(dwe,{children:"useAutoPlayVideoTrack"}),ne.jsx("div",{className:"p-4 text-xl",children:ne.jsx("div",{ref:c=>o.current=c,style:{width:"150px",height:"100px"}})})]}),ne.jsx(ga,{cameraOn:e,setCamera:()=>{r(c=>!c)}})]})},{Title:pwe,Paragraph:qw,Text:fwe}=Ao,mwe=()=>{const[e,r]=b.useState(!1),o=tie();return Ii({appid:pt.appId,channel:pt.channel,token:pt.token},e),ne.jsx(ni,{children:ne.jsxs("div",{className:"h-screen p-3",children:[ne.jsx(pwe,{children:"useConnectionState"}),ne.jsxs(qw,{children:["By using ",ne.jsx(fwe,{keyboard:!0,children:"useConnectionState"})," hook to get the current connection state of the client."]}),ne.jsx(qw,{children:`result: ${o}`}),ne.jsxs(qw,{children:[ne.jsx(wi,{className:"m-1",onClick:()=>r(!0),type:"primary",children:"Join"}),ne.jsx(wi,{className:"m-1",onClick:()=>r(!1),type:"default",children:"Leave"})]})]})})},{Title:gwe,Paragraph:Xw,Text:vwe}=Ao,Ewe=()=>{const[e,r]=b.useState(!1),o=Wy();return Ii({appid:pt.appId,channel:pt.channel,token:pt.token},e),ne.jsx(ni,{children:ne.jsxs("div",{className:"h-screen p-3",children:[ne.jsx(gwe,{children:"useCurrentUID"}),ne.jsxs(Xw,{children:["By using ",ne.jsx(vwe,{keyboard:!0,children:"useCurrentUID"})," hook to get the UID of the current user."]}),ne.jsx(Xw,{children:`result: ${o}`}),ne.jsxs(Xw,{children:[ne.jsx(wi,{className:"m-1",onClick:()=>r(!0),type:"primary",children:"Join"}),ne.jsx(wi,{className:"m-1",onClick:()=>r(!1),type:"default",children:"Leave"})]})]})})},{Title:_we,Paragraph:Jw,Text:ywe}=Ao,Swe=()=>{const[e,r]=b.useState(!1),o=bs();return Ii({appid:pt.appId,channel:pt.channel,token:pt.token},e),ne.jsx(ni,{children:ne.jsxs("div",{className:"h-screen p-3",children:[ne.jsx(_we,{children:"useIsConnected"}),ne.jsxs(Jw,{children:["By using ",ne.jsx(ywe,{keyboard:!0,children:"useIsConnected"})," hook to determines whether the client is successfully connected to Agora server."]}),ne.jsx(Jw,{children:`result: ${o}`}),ne.jsxs(Jw,{children:[ne.jsx(wi,{className:"m-1",onClick:()=>r(!0),type:"primary",children:"Join"}),ne.jsx(wi,{className:"m-1",onClick:()=>r(!1),type:"default",children:"Leave"})]})]})})},{Title:Cwe,Paragraph:y8,Text:nm}=Ao,bwe=()=>{const[e,r]=b.useState(!1),{data:o,isLoading:s,isConnected:c,error:d}=Ii({appid:pt.appId,channel:pt.channel,token:pt.token},e),[f,m]=b.useState(!1),[g,_]=b.useState(!1),S=oc(),{videoTracks:T}=mf(S),{audioTracks:R}=ff(S);R.map(A=>A.play());const N=()=>ne.jsx(ne.Fragment,{children:T.map(A=>ne.jsxs(Es.Item,{children:[ne.jsx(Tg,{cover:Bc(),track:A},A.getUserId()),ne.jsx(Al,{children:`${ic(A.getUserId())}{${A.getUserId()}}`})]},A.getUserId()))});return ne.jsxs(ni,{children:[ne.jsxs("div",{className:"h-screen p-3",children:[ne.jsx(Cwe,{children:"UseJoin"}),ne.jsxs(y8,{children:["By using ",ne.jsx(nm,{keyboard:!0,children:"UseJoin"})," hook to join room."]}),ne.jsxs(y8,{children:["You can do some actions like fetching token before calling join.",ne.jsx("br",{}),"Below is the returned data."]}),ne.jsxs(nm,{children:["data: ",o]}),ne.jsxs(nm,{className:"pl-3",children:["isLoading: ",`${s}`]}),ne.jsxs(nm,{className:"pl-3",children:["isConnected: ",`${c}`]}),ne.jsxs(nm,{className:"pl-3",children:["error: ",`${JSON.stringify(d)}`]})]}),e&&ne.jsx(zS,{cameraOn:g,micOn:f,renderRemoteUsers:N}),ne.jsx(ga,{calling:e,cameraOn:g,micOn:f,setCalling:()=>{r(A=>!A)},setCamera:()=>{_(A=>!A)},setMic:()=>{m(A=>!A)}})]})},{Title:Twe}=Ao,Rwe=()=>{const[e,r]=b.useState(!1),[o,s]=b.useState(null),[c,d]=b.useState(null);Ii({appid:pt.appId,channel:pt.channel,token:pt.token,uid:pt.ShareScreenUID},e);const{screenTrack:f,error:m}=F8(e,{},"auto");return b.useEffect(()=>{f?Array.isArray(f)?(s(f.filter(g=>g.trackMediaType==="video")[0]),d(f.filter(g=>g.trackMediaType==="audio")[0])):s(f):(d(null),s(null))},[f]),Gu([o,c],e),b.useEffect(()=>{r(!1)},[m]),k8(o,"track-ended",()=>{console.log("screen sharing ended"),r(!1)}),ne.jsx(ni,{children:ne.jsxs("div",{className:"h-screen p-3",children:[ne.jsx(Twe,{children:"useLocalScreenTrack"}),ne.jsx(wi,{onClick:()=>r(g=>!g),type:"primary",children:e?"stop share screen":"start share screen"}),e&&o&&ne.jsx(ag,{disabled:!e,play:e,style:{width:"600px",height:"400px"},track:o})]})})},{Title:wwe,Paragraph:Iwe}=Ao,Awe=()=>{const e=nie();return Ii({appid:pt.appId,channel:pt.channel,token:pt.token},!0),ne.jsx(ni,{children:ne.jsxs("div",{className:"h-screen p-3",children:[ne.jsx(wwe,{children:"useNetworkQuality"}),ne.jsx(Iwe,{children:`result: ${JSON.stringify(e)}`})]})})},Owe=()=>{const[e,r]=b.useState(!1),o=Wy()||0,s=b.useMemo(()=>ic(o),[o]),c=b.useMemo(()=>Bc(),[]),{isConnected:d}=Ii({appid:pt.appId,channel:pt.channel,token:pt.token},e),[f,m]=b.useState(!1),[g,_]=b.useState(!1),{localMicrophoneTrack:S}=hf(f),{localCameraTrack:T}=pf(g);Gu([S,T]);const R=oc(),N=R.filter(x=>x.hasAudio||x.hasVideo),{videoTracks:A}=mf(R),{audioTracks:O}=ff(R);O.map(x=>x.play());const M=()=>ne.jsx(ne.Fragment,{children:A.map(x=>ne.jsxs(Es.Item,{children:[ne.jsx(Tg,{cover:Bc(),track:x},x.getUserId()),ne.jsx(Al,{children:`Layout1 ${ic(x.getUserId())}{${x.getUserId()}}`})]},x.getUserId()))});return ne.jsxs(ni,{children:[ne.jsxs(ne.Fragment,{children:[ne.jsx(qx,{published:N.length+(f||g?1:0),total:R.length+1}),ne.jsxs(Es,{children:[d&&ne.jsx(Es.Item,{children:ne.jsx(Yx,{audioTrack:S,cameraOn:g,cover:c,micOn:f,videoTrack:T,children:ne.jsx(Al,{children:`${s}{${o}}`})})}),M?M():void 0]})]}),ne.jsx(ga,{calling:e,cameraOn:g,micOn:f,setCalling:()=>r(x=>!x),setCamera:()=>{_(x=>!x)},setMic:()=>{m(x=>!x)}})]})},xwe=()=>{const[e,r]=b.useState(!1),o=bs(),s=Wy()||0,c=b.useMemo(()=>ic(s),[s]),d=b.useMemo(()=>Bc(),[]);Ii({appid:pt.appId,channel:pt.channel,token:pt.token},e);const[f,m]=b.useState(!1),[g,_]=b.useState(!1),{localMicrophoneTrack:S}=hf(f),{localCameraTrack:T}=pf(g);Gu([S,T]);const R=oc(),N=R.filter(A=>A.hasAudio||A.hasVideo);return ne.jsxs(ni,{children:[ne.jsxs(ne.Fragment,{children:[ne.jsx(qx,{published:N.length+(f||g?1:0),total:R.length+1}),ne.jsxs(Es,{children:[o&&ne.jsx(Es.Item,{children:ne.jsx(Yx,{audioTrack:S,cameraOn:g,cover:d,micOn:f,videoTrack:T,children:ne.jsx(Al,{children:`${c}{${s}}`})})}),R.map(A=>ne.jsxs(Es.Item,{children:[ne.jsx(lO,{cover:Bc(),user:A}),ne.jsx(Al,{children:`${ic(A.uid)}{${A.uid}}`})]},A.uid))]})]}),ne.jsx(ga,{calling:e,cameraOn:g,micOn:f,setCalling:()=>r(A=>!A),setCamera:()=>{_(A=>!A)},setMic:()=>{m(A=>!A)}})]})},KW=[{label:"useJoin",component:bwe},{label:"usePublish",component:Owe},{label:"useRemoteUsers",component:xwe},{label:"useConnectionState",component:mwe},{label:"useIsConnected",component:Swe},{label:"useCurrentUID",component:Ewe},{label:"useAutoPlayAudioTrack",component:uwe},{label:"useAutoPlayVideoTrack",component:hwe},{label:"useNetworkQuality",component:Awe},{label:"useLocalScreenTrack",component:Rwe}],S8=()=>{const[e,r]=b.useState(pt.channel),o=g=>{r(g.target.value)},[s,c]=_ye.useNotification(),d=g=>{s[g]({message:"Configuration Saved",description:"Go to other pages and try it now!"})},f=()=>{pt.channel=e,d("success")},m={wrapperCol:{span:14,offset:4}};return ne.jsxs(ni,{children:[c,ne.jsx("div",{className:"p-4",children:ne.jsx(t6.Item,{label:"Channel Name",children:ne.jsx(S_e,{onChange:o,style:{width:"200px"},value:e})})}),ne.jsx(t6.Item,{...m,children:ne.jsx(wi,{onClick:f,type:"primary",children:"Save configuration"})})]})},{Content:Nwe,Sider:Pwe}=zA,no=["Basic","Hooks","Components","Advanced","Setting"],Dwe=[{label:no[0],key:no[0],children:GW.map(e=>({key:`/${no[0]}/${e.label}`,label:e.label}))},{label:no[1],key:no[1],children:KW.map(e=>({key:`/${no[1]}/${e.label}`,label:e.label}))},{label:no[2],key:no[2],children:zW.map(e=>({key:`/${no[2]}/${e.label}`,label:e.label}))},{label:no[3],key:no[3],children:WW.map(e=>({key:`/${no[3]}/${e.label}`,label:e.label}))},{label:"settings",key:"/setting"}];function kwe(){const[e,r]=b.useState(!1),[o,s]=b.useState([window.location.hash.slice(1).split("/")[1]]),c=f=>{const m=f.find(g=>o.indexOf(g)===-1);m&&no.indexOf(m)===-1?s(f):s(m?[m]:[])},d=Fae();return ne.jsx(ne.Fragment,{children:ne.jsxs(zA,{children:[ne.jsx(Pwe,{collapsed:e,collapsible:!0,onCollapse:f=>r(f),style:{overflow:"auto",height:"100vh",position:"fixed",left:0,top:0,bottom:0},children:ne.jsx(cEe,{items:Dwe,mode:"inline",onClick:f=>{d(f.key)},onOpenChange:c,openKeys:o,selectedKeys:[window.location.hash.slice(1)],theme:"dark"})}),ne.jsx(zA,{style:{marginLeft:e?80:200},children:ne.jsxs(Nwe,{children:[ne.jsxs(Qae,{children:[ne.jsx(Pd,{Component:()=>ne.jsx(S8,{}),path:"/*"}),ne.jsx(Pd,{Component:()=>ne.jsx(S8,{}),path:"/setting"}),GW.map(({label:f,component:m})=>{const g=m;return ne.jsx(Pd,{Component:()=>ne.jsx(d_,{children:ne.jsx(g,{})}),path:`/${no[0]}/${f}`},f)}),KW.map(({label:f,component:m})=>{const g=m;return ne.jsx(Pd,{Component:()=>ne.jsx(d_,{children:ne.jsx(g,{})}),path:`/${no[1]}/${f}`},f)}),zW.map(({label:f,component:m})=>{const g=m;return ne.jsx(Pd,{Component:()=>ne.jsx(d_,{children:ne.jsx(g,{})}),path:`/${no[2]}/${f}`},f)}),WW.map(({label:f,component:m})=>{const g=m;return ne.jsx(Pd,{Component:()=>ne.jsx(d_,{children:ne.jsx(g,{})}),path:`/${no[3]}/${f}`},f)})]}),ne.jsx("a",{"aria-label":"View source on GitHub",className:"github-corner",href:"https://github.com/AgoraIO-Extensions/agora-rtc-react",rel:"noreferrer",target:"_blank",children:ne.jsxs("svg",{"aria-hidden":"true",className:"github-corner-svg",height:"80",viewBox:"0 0 250 250",width:"80",children:[ne.jsx("path",{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"}),ne.jsx("path",{className:"github-corner-svg-arm",d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor"}),ne.jsx("path",{className:"github-corner-svg-body",d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor"})]})})]})})]})})}_l.setLogLevel(0);Qw.createRoot(document.getElementById("root")).render(ne.jsx(b.StrictMode,{children:ne.jsx(ese,{children:ne.jsx(kwe,{})})}));

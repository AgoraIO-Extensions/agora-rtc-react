var $ne=Object.defineProperty;var Hne=(e,n,o)=>n in e?$ne(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o;var hE=(e,n,o)=>(Hne(e,typeof n!="symbol"?n+"":n,o),o);function v6(e,n){for(var o=0;o<n.length;o++){const s=n[o];if(typeof s!="string"&&!Array.isArray(s)){for(const c in s)if(c!=="default"&&!(c in e)){const d=Object.getOwnPropertyDescriptor(s,c);d&&Object.defineProperty(e,c,d.get?d:{enumerable:!0,get:()=>s[c]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))s(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const p of d.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&s(p)}).observe(document,{childList:!0,subtree:!0});function o(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function s(c){if(c.ep)return;c.ep=!0;const d=o(c);fetch(c.href,d)}})();var Dt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yl(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Wne(e){if(e.__esModule)return e;var n=e.default;if(typeof n=="function"){var o=function s(){return this instanceof s?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};o.prototype=n.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var c=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(o,s,c.get?c:{enumerable:!0,get:function(){return e[s]}})}),o}var E6={exports:{}},Ry={},_6={exports:{}},wn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vm=Symbol.for("react.element"),zne=Symbol.for("react.portal"),Gne=Symbol.for("react.fragment"),Kne=Symbol.for("react.strict_mode"),qne=Symbol.for("react.profiler"),Yne=Symbol.for("react.provider"),Xne=Symbol.for("react.context"),Jne=Symbol.for("react.forward_ref"),Qne=Symbol.for("react.suspense"),Zne=Symbol.for("react.memo"),ere=Symbol.for("react.lazy"),NU=Symbol.iterator;function tre(e){return e===null||typeof e!="object"?null:(e=NU&&e[NU]||e["@@iterator"],typeof e=="function"?e:null)}var y6={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S6=Object.assign,C6={};function Xp(e,n,o){this.props=e,this.context=n,this.refs=C6,this.updater=o||y6}Xp.prototype.isReactComponent={};Xp.prototype.setState=function(e,n){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")};Xp.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function b6(){}b6.prototype=Xp.prototype;function wA(e,n,o){this.props=e,this.context=n,this.refs=C6,this.updater=o||y6}var IA=wA.prototype=new b6;IA.constructor=wA;S6(IA,Xp.prototype);IA.isPureReactComponent=!0;var PU=Array.isArray,T6=Object.prototype.hasOwnProperty,AA={current:null},R6={key:!0,ref:!0,__self:!0,__source:!0};function w6(e,n,o){var s,c={},d=null,p=null;if(n!=null)for(s in n.ref!==void 0&&(p=n.ref),n.key!==void 0&&(d=""+n.key),n)T6.call(n,s)&&!R6.hasOwnProperty(s)&&(c[s]=n[s]);var m=arguments.length-2;if(m===1)c.children=o;else if(1<m){for(var g=Array(m),_=0;_<m;_++)g[_]=arguments[_+2];c.children=g}if(e&&e.defaultProps)for(s in m=e.defaultProps,m)c[s]===void 0&&(c[s]=m[s]);return{$$typeof:Vm,type:e,key:d,ref:p,props:c,_owner:AA.current}}function nre(e,n){return{$$typeof:Vm,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}function OA(e){return typeof e=="object"&&e!==null&&e.$$typeof===Vm}function rre(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(o){return n[o]})}var DU=/\/+/g;function RR(e,n){return typeof e=="object"&&e!==null&&e.key!=null?rre(""+e.key):n.toString(36)}function e_(e,n,o,s,c){var d=typeof e;(d==="undefined"||d==="boolean")&&(e=null);var p=!1;if(e===null)p=!0;else switch(d){case"string":case"number":p=!0;break;case"object":switch(e.$$typeof){case Vm:case zne:p=!0}}if(p)return p=e,c=c(p),e=s===""?"."+RR(p,0):s,PU(c)?(o="",e!=null&&(o=e.replace(DU,"$&/")+"/"),e_(c,n,o,"",function(_){return _})):c!=null&&(OA(c)&&(c=nre(c,o+(!c.key||p&&p.key===c.key?"":(""+c.key).replace(DU,"$&/")+"/")+e)),n.push(c)),1;if(p=0,s=s===""?".":s+":",PU(e))for(var m=0;m<e.length;m++){d=e[m];var g=s+RR(d,m);p+=e_(d,n,o,g,c)}else if(g=tre(e),typeof g=="function")for(e=g.call(e),m=0;!(d=e.next()).done;)d=d.value,g=s+RR(d,m++),p+=e_(d,n,o,g,c);else if(d==="object")throw n=String(e),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return p}function pE(e,n,o){if(e==null)return e;var s=[],c=0;return e_(e,s,"","",function(d){return n.call(o,d,c++)}),s}function ire(e){if(e._status===-1){var n=e._result;n=n(),n.then(function(o){(e._status===0||e._status===-1)&&(e._status=1,e._result=o)},function(o){(e._status===0||e._status===-1)&&(e._status=2,e._result=o)}),e._status===-1&&(e._status=0,e._result=n)}if(e._status===1)return e._result.default;throw e._result}var $o={current:null},t_={transition:null},ore={ReactCurrentDispatcher:$o,ReactCurrentBatchConfig:t_,ReactCurrentOwner:AA};wn.Children={map:pE,forEach:function(e,n,o){pE(e,function(){n.apply(this,arguments)},o)},count:function(e){var n=0;return pE(e,function(){n++}),n},toArray:function(e){return pE(e,function(n){return n})||[]},only:function(e){if(!OA(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};wn.Component=Xp;wn.Fragment=Gne;wn.Profiler=qne;wn.PureComponent=wA;wn.StrictMode=Kne;wn.Suspense=Qne;wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ore;wn.cloneElement=function(e,n,o){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=S6({},e.props),c=e.key,d=e.ref,p=e._owner;if(n!=null){if(n.ref!==void 0&&(d=n.ref,p=AA.current),n.key!==void 0&&(c=""+n.key),e.type&&e.type.defaultProps)var m=e.type.defaultProps;for(g in n)T6.call(n,g)&&!R6.hasOwnProperty(g)&&(s[g]=n[g]===void 0&&m!==void 0?m[g]:n[g])}var g=arguments.length-2;if(g===1)s.children=o;else if(1<g){m=Array(g);for(var _=0;_<g;_++)m[_]=arguments[_+2];s.children=m}return{$$typeof:Vm,type:e.type,key:c,ref:d,props:s,_owner:p}};wn.createContext=function(e){return e={$$typeof:Xne,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Yne,_context:e},e.Consumer=e};wn.createElement=w6;wn.createFactory=function(e){var n=w6.bind(null,e);return n.type=e,n};wn.createRef=function(){return{current:null}};wn.forwardRef=function(e){return{$$typeof:Jne,render:e}};wn.isValidElement=OA;wn.lazy=function(e){return{$$typeof:ere,_payload:{_status:-1,_result:e},_init:ire}};wn.memo=function(e,n){return{$$typeof:Zne,type:e,compare:n===void 0?null:n}};wn.startTransition=function(e){var n=t_.transition;t_.transition={};try{e()}finally{t_.transition=n}};wn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};wn.useCallback=function(e,n){return $o.current.useCallback(e,n)};wn.useContext=function(e){return $o.current.useContext(e)};wn.useDebugValue=function(){};wn.useDeferredValue=function(e){return $o.current.useDeferredValue(e)};wn.useEffect=function(e,n){return $o.current.useEffect(e,n)};wn.useId=function(){return $o.current.useId()};wn.useImperativeHandle=function(e,n,o){return $o.current.useImperativeHandle(e,n,o)};wn.useInsertionEffect=function(e,n){return $o.current.useInsertionEffect(e,n)};wn.useLayoutEffect=function(e,n){return $o.current.useLayoutEffect(e,n)};wn.useMemo=function(e,n){return $o.current.useMemo(e,n)};wn.useReducer=function(e,n,o){return $o.current.useReducer(e,n,o)};wn.useRef=function(e){return $o.current.useRef(e)};wn.useState=function(e){return $o.current.useState(e)};wn.useSyncExternalStore=function(e,n,o){return $o.current.useSyncExternalStore(e,n,o)};wn.useTransition=function(){return $o.current.useTransition()};wn.version="18.2.0";_6.exports=wn;var b=_6.exports;const Et=yl(b),Md=v6({__proto__:null,default:Et},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var are=b,sre=Symbol.for("react.element"),cre=Symbol.for("react.fragment"),lre=Object.prototype.hasOwnProperty,ure=are.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dre={key:!0,ref:!0,__self:!0,__source:!0};function I6(e,n,o){var s,c={},d=null,p=null;o!==void 0&&(d=""+o),n.key!==void 0&&(d=""+n.key),n.ref!==void 0&&(p=n.ref);for(s in n)lre.call(n,s)&&!dre.hasOwnProperty(s)&&(c[s]=n[s]);if(e&&e.defaultProps)for(s in n=e.defaultProps,n)c[s]===void 0&&(c[s]=n[s]);return{$$typeof:sre,type:e,key:d,ref:p,props:c,_owner:ure.current}}Ry.Fragment=cre;Ry.jsx=I6;Ry.jsxs=I6;E6.exports=Ry;var te=E6.exports;var A6={exports:{}};(function(e,n){(function(o,s){e.exports=s()})(Dt,function(){function o(i,t){return t.forEach(function(r){r&&typeof r!="string"&&!Array.isArray(r)&&Object.keys(r).forEach(function(a){if(a!=="default"&&!(a in i)){var l=Object.getOwnPropertyDescriptor(r,a);Object.defineProperty(i,a,l.get?l:{enumerable:!0,get:function(){return r[a]}})}})}),Object.freeze(i)}let s=!0,c=!0;function d(i,t,r){const a=i.match(t);return a&&a.length>=r&&parseInt(a[r],10)}function p(i,t,r){if(!i.RTCPeerConnection)return;const a=i.RTCPeerConnection.prototype,l=a.addEventListener;a.addEventListener=function(h,f){if(h!==t)return l.apply(this,arguments);const v=E=>{const y=r(E);y&&(f.handleEvent?f.handleEvent(y):f(y))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(f,v),l.apply(this,[h,v])};const u=a.removeEventListener;a.removeEventListener=function(h,f){if(h!==t||!this._eventMap||!this._eventMap[t])return u.apply(this,arguments);if(!this._eventMap[t].has(f))return u.apply(this,arguments);const v=this._eventMap[t].get(f);return this._eventMap[t].delete(f),this._eventMap[t].size===0&&delete this._eventMap[t],Object.keys(this._eventMap).length===0&&delete this._eventMap,u.apply(this,[h,v])},Object.defineProperty(a,"on"+t,{get(){return this["_on"+t]},set(h){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),h&&this.addEventListener(t,this["_on"+t]=h)},enumerable:!0,configurable:!0})}function m(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):(s=i,i?"adapter.js logging disabled":"adapter.js logging enabled")}function g(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):(c=!i,"adapter.js deprecation warnings "+(i?"disabled":"enabled"))}function _(){if(typeof window=="object"){if(s)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function S(i,t){c&&console.warn(i+" is deprecated, please use "+t+" instead.")}function T(i){return Object.prototype.toString.call(i)==="[object Object]"}function R(i){return T(i)?Object.keys(i).reduce(function(t,r){const a=T(i[r]),l=a?R(i[r]):i[r],u=a&&!Object.keys(l).length;return l===void 0||u?t:Object.assign(t,{[r]:l})},{}):i}function N(i,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach(a=>{a.endsWith("Id")?N(i,i.get(t[a]),r):a.endsWith("Ids")&&t[a].forEach(l=>{N(i,i.get(l),r)})}))}function O(i,t,r){const a=r?"outbound-rtp":"inbound-rtp",l=new Map;if(t===null)return l;const u=[];return i.forEach(h=>{h.type==="track"&&h.trackIdentifier===t.id&&u.push(h)}),u.forEach(h=>{i.forEach(f=>{f.type===a&&f.trackId===h.id&&N(i,f,l)})}),l}const A=_;function M(i,t){const r=i&&i.navigator;if(!r.mediaDevices)return;const a=function(h){if(typeof h!="object"||h.mandatory||h.optional)return h;const f={};return Object.keys(h).forEach(v=>{if(v==="require"||v==="advanced"||v==="mediaSource")return;const E=typeof h[v]=="object"?h[v]:{ideal:h[v]};E.exact!==void 0&&typeof E.exact=="number"&&(E.min=E.max=E.exact);const y=function(C,I){return C?C+I.charAt(0).toUpperCase()+I.slice(1):I==="deviceId"?"sourceId":I};if(E.ideal!==void 0){f.optional=f.optional||[];let C={};typeof E.ideal=="number"?(C[y("min",v)]=E.ideal,f.optional.push(C),C={},C[y("max",v)]=E.ideal,f.optional.push(C)):(C[y("",v)]=E.ideal,f.optional.push(C))}E.exact!==void 0&&typeof E.exact!="number"?(f.mandatory=f.mandatory||{},f.mandatory[y("",v)]=E.exact):["min","max"].forEach(C=>{E[C]!==void 0&&(f.mandatory=f.mandatory||{},f.mandatory[y(C,v)]=E[C])})}),h.advanced&&(f.optional=(f.optional||[]).concat(h.advanced)),f},l=function(h,f){if(t.version>=61)return f(h);if((h=JSON.parse(JSON.stringify(h)))&&typeof h.audio=="object"){const v=function(E,y,C){y in E&&!(C in E)&&(E[C]=E[y],delete E[y])};v((h=JSON.parse(JSON.stringify(h))).audio,"autoGainControl","googAutoGainControl"),v(h.audio,"noiseSuppression","googNoiseSuppression"),h.audio=a(h.audio)}if(h&&typeof h.video=="object"){let v=h.video.facingMode;v=v&&(typeof v=="object"?v:{ideal:v});const E=t.version<66;if(v&&(v.exact==="user"||v.exact==="environment"||v.ideal==="user"||v.ideal==="environment")&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||E)){let y;if(delete h.video.facingMode,v.exact==="environment"||v.ideal==="environment"?y=["back","rear"]:v.exact!=="user"&&v.ideal!=="user"||(y=["front"]),y)return r.mediaDevices.enumerateDevices().then(C=>{let I=(C=C.filter(k=>k.kind==="videoinput")).find(k=>y.some(W=>k.label.toLowerCase().includes(W)));return!I&&C.length&&y.includes("back")&&(I=C[C.length-1]),I&&(h.video.deviceId=v.exact?{exact:I.deviceId}:{ideal:I.deviceId}),h.video=a(h.video),A("chrome: "+JSON.stringify(h)),f(h)})}h.video=a(h.video)}return A("chrome: "+JSON.stringify(h)),f(h)},u=function(h){return t.version>=64?h:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[h.name]||h.name,message:h.message,constraint:h.constraint||h.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(r.getUserMedia=(function(h,f,v){l(h,E=>{r.webkitGetUserMedia(E,f,y=>{v&&v(u(y))})})}).bind(r),r.mediaDevices.getUserMedia){const h=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(f){return l(f,v=>h(v).then(E=>{if(v.audio&&!E.getAudioTracks().length||v.video&&!E.getVideoTracks().length)throw E.getTracks().forEach(y=>{y.stop()}),new DOMException("","NotFoundError");return E},E=>Promise.reject(u(E))))}}}function x(i){i.MediaStream=i.MediaStream||i.webkitMediaStream}function P(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("ontrack"in i.RTCPeerConnection.prototype)){Object.defineProperty(i.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(r){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=r)},enumerable:!0,configurable:!0});const t=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",a=>{let l;l=i.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(h=>h.track&&h.track.id===a.track.id):{track:a.track};const u=new Event("track");u.track=a.track,u.receiver=l,u.transceiver={receiver:l},u.streams=[r.stream],this.dispatchEvent(u)}),r.stream.getTracks().forEach(a=>{let l;l=i.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(h=>h.track&&h.track.id===a.id):{track:a};const u=new Event("track");u.track=a,u.receiver=l,u.transceiver={receiver:l},u.streams=[r.stream],this.dispatchEvent(u)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else p(i,"track",t=>(t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t))}function D(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("getSenders"in i.RTCPeerConnection.prototype)&&"createDTMFSender"in i.RTCPeerConnection.prototype){const t=function(l,u){return{track:u,get dtmf(){return this._dtmf===void 0&&(u.kind==="audio"?this._dtmf=l.createDTMFSender(u):this._dtmf=null),this._dtmf},_pc:l}};if(!i.RTCPeerConnection.prototype.getSenders){i.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const l=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(h,f){let v=l.apply(this,arguments);return v||(v=t(this,h),this._senders.push(v)),v};const u=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(h){u.apply(this,arguments);const f=this._senders.indexOf(h);f!==-1&&this._senders.splice(f,1)}}const r=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(l){this._senders=this._senders||[],r.apply(this,[l]),l.getTracks().forEach(u=>{this._senders.push(t(this,u))})};const a=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(l){this._senders=this._senders||[],a.apply(this,[l]),l.getTracks().forEach(u=>{const h=this._senders.find(f=>f.track===u);h&&this._senders.splice(this._senders.indexOf(h),1)})}}else if(typeof i=="object"&&i.RTCPeerConnection&&"getSenders"in i.RTCPeerConnection.prototype&&"createDTMFSender"in i.RTCPeerConnection.prototype&&i.RTCRtpSender&&!("dtmf"in i.RTCRtpSender.prototype)){const t=i.RTCPeerConnection.prototype.getSenders;i.RTCPeerConnection.prototype.getSenders=function(){const r=t.apply(this,[]);return r.forEach(a=>a._pc=this),r},Object.defineProperty(i.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function F(i){if(!i.RTCPeerConnection)return;const t=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){const[r,a,l]=arguments;if(arguments.length>0&&typeof r=="function")return t.apply(this,arguments);if(t.length===0&&(arguments.length===0||typeof r!="function"))return t.apply(this,[]);const u=function(f){const v={};return f.result().forEach(E=>{const y={id:E.id,timestamp:E.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[E.type]||E.type};E.names().forEach(C=>{y[C]=E.stat(C)}),v[y.id]=y}),v},h=function(f){return new Map(Object.keys(f).map(v=>[v,f[v]]))};if(arguments.length>=2){const f=function(v){a(h(u(v)))};return t.apply(this,[f,r])}return new Promise((f,v)=>{t.apply(this,[function(E){f(h(u(E)))},v])}).then(a,l)}}function j(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender&&i.RTCRtpReceiver))return;if(!("getStats"in i.RTCRtpSender.prototype)){const r=i.RTCPeerConnection.prototype.getSenders;r&&(i.RTCPeerConnection.prototype.getSenders=function(){const l=r.apply(this,[]);return l.forEach(u=>u._pc=this),l});const a=i.RTCPeerConnection.prototype.addTrack;a&&(i.RTCPeerConnection.prototype.addTrack=function(){const l=a.apply(this,arguments);return l._pc=this,l}),i.RTCRtpSender.prototype.getStats=function(){const l=this;return this._pc.getStats().then(u=>O(u,l.track,!0))}}if(!("getStats"in i.RTCRtpReceiver.prototype)){const r=i.RTCPeerConnection.prototype.getReceivers;r&&(i.RTCPeerConnection.prototype.getReceivers=function(){const a=r.apply(this,[]);return a.forEach(l=>l._pc=this),a}),p(i,"track",a=>(a.receiver._pc=a.srcElement,a)),i.RTCRtpReceiver.prototype.getStats=function(){const a=this;return this._pc.getStats().then(l=>O(l,a.track,!1))}}if(!("getStats"in i.RTCRtpSender.prototype)||!("getStats"in i.RTCRtpReceiver.prototype))return;const t=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof i.MediaStreamTrack){const r=arguments[0];let a,l,u;return this.getSenders().forEach(h=>{h.track===r&&(a?u=!0:a=h)}),this.getReceivers().forEach(h=>(h.track===r&&(l?u=!0:l=h),h.track===r)),u||a&&l?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):a?a.getStats():l?l.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function B(i){i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(u=>this._shimmedLocalStreams[u][0])};const t=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(u,h){if(!h)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const f=t.apply(this,arguments);return this._shimmedLocalStreams[h.id]?this._shimmedLocalStreams[h.id].indexOf(f)===-1&&this._shimmedLocalStreams[h.id].push(f):this._shimmedLocalStreams[h.id]=[h,f],f};const r=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(u){this._shimmedLocalStreams=this._shimmedLocalStreams||{},u.getTracks().forEach(v=>{if(this.getSenders().find(E=>E.track===v))throw new DOMException("Track already exists.","InvalidAccessError")});const h=this.getSenders();r.apply(this,arguments);const f=this.getSenders().filter(v=>h.indexOf(v)===-1);this._shimmedLocalStreams[u.id]=[u].concat(f)};const a=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[u.id],a.apply(this,arguments)};const l=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},u&&Object.keys(this._shimmedLocalStreams).forEach(h=>{const f=this._shimmedLocalStreams[h].indexOf(u);f!==-1&&this._shimmedLocalStreams[h].splice(f,1),this._shimmedLocalStreams[h].length===1&&delete this._shimmedLocalStreams[h]}),l.apply(this,arguments)}}function H(i,t){if(!i.RTCPeerConnection)return;if(i.RTCPeerConnection.prototype.addTrack&&t.version>=65)return B(i);const r=i.RTCPeerConnection.prototype.getLocalStreams;i.RTCPeerConnection.prototype.getLocalStreams=function(){const v=r.apply(this);return this._reverseStreams=this._reverseStreams||{},v.map(E=>this._reverseStreams[E.id])};const a=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(v){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},v.getTracks().forEach(E=>{if(this.getSenders().find(y=>y.track===E))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[v.id]){const E=new i.MediaStream(v.getTracks());this._streams[v.id]=E,this._reverseStreams[E.id]=v,v=E}a.apply(this,[v])};const l=i.RTCPeerConnection.prototype.removeStream;function u(v,E){let y=E.sdp;return Object.keys(v._reverseStreams||[]).forEach(C=>{const I=v._reverseStreams[C],k=v._streams[I.id];y=y.replace(new RegExp(k.id,"g"),I.id)}),new RTCSessionDescription({type:E.type,sdp:y})}i.RTCPeerConnection.prototype.removeStream=function(v){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},l.apply(this,[this._streams[v.id]||v]),delete this._reverseStreams[this._streams[v.id]?this._streams[v.id].id:v.id],delete this._streams[v.id]},i.RTCPeerConnection.prototype.addTrack=function(v,E){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const y=[].slice.call(arguments,1);if(y.length!==1||!y[0].getTracks().find(I=>I===v))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(I=>I.track===v))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const C=this._streams[E.id];if(C)C.addTrack(v),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const I=new i.MediaStream([v]);this._streams[E.id]=I,this._reverseStreams[I.id]=E,this.addStream(I)}return this.getSenders().find(I=>I.track===v)},["createOffer","createAnswer"].forEach(function(v){const E=i.RTCPeerConnection.prototype[v],y={[v](){const C=arguments;return arguments.length&&typeof arguments[0]=="function"?E.apply(this,[I=>{const k=u(this,I);C[0].apply(null,[k])},I=>{C[1]&&C[1].apply(null,I)},arguments[2]]):E.apply(this,arguments).then(I=>u(this,I))}};i.RTCPeerConnection.prototype[v]=y[v]});const h=i.RTCPeerConnection.prototype.setLocalDescription;i.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(v,E){let y=E.sdp;return Object.keys(v._reverseStreams||[]).forEach(C=>{const I=v._reverseStreams[C],k=v._streams[I.id];y=y.replace(new RegExp(I.id,"g"),k.id)}),new RTCSessionDescription({type:E.type,sdp:y})}(this,arguments[0]),h.apply(this,arguments)):h.apply(this,arguments)};const f=Object.getOwnPropertyDescriptor(i.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(i.RTCPeerConnection.prototype,"localDescription",{get(){const v=f.get.apply(this);return v.type===""?v:u(this,v)}}),i.RTCPeerConnection.prototype.removeTrack=function(v){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!v._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(v._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let E;this._streams=this._streams||{},Object.keys(this._streams).forEach(y=>{this._streams[y].getTracks().find(C=>v.track===C)&&(E=this._streams[y])}),E&&(E.getTracks().length===1?this.removeStream(this._reverseStreams[E.id]):E.removeTrack(v.track),this.dispatchEvent(new Event("negotiationneeded")))}}function K(i,t){!i.RTCPeerConnection&&i.webkitRTCPeerConnection&&(i.RTCPeerConnection=i.webkitRTCPeerConnection),i.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const a=i.RTCPeerConnection.prototype[r],l={[r](){return arguments[0]=new(r==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),a.apply(this,arguments)}};i.RTCPeerConnection.prototype[r]=l[r]})}function J(i,t){p(i,"negotiationneeded",r=>{const a=r.target;if(!(t.version<72||a.getConfiguration&&a.getConfiguration().sdpSemantics==="plan-b")||a.signalingState==="stable")return r})}var q=Object.freeze({__proto__:null,fixNegotiationNeeded:J,shimAddTrackRemoveTrack:H,shimAddTrackRemoveTrackWithNative:B,shimGetDisplayMedia:function(i,t){i.navigator.mediaDevices&&"getDisplayMedia"in i.navigator.mediaDevices||i.navigator.mediaDevices&&(typeof t=="function"?i.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then(a=>{const l=r.video&&r.video.width,u=r.video&&r.video.height,h=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:a,maxFrameRate:h||3}},l&&(r.video.mandatory.maxWidth=l),u&&(r.video.mandatory.maxHeight=u),i.navigator.mediaDevices.getUserMedia(r)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:D,shimGetStats:F,shimGetUserMedia:M,shimMediaStream:x,shimOnTrack:P,shimPeerConnection:K,shimSenderReceiverGetStats:j});function Q(i,t){const r=i&&i.navigator,a=i&&i.MediaStreamTrack;if(r.getUserMedia=function(l,u,h){S("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(l).then(u,h)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){const l=function(h,f,v){f in h&&!(v in h)&&(h[v]=h[f],delete h[f])},u=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(h){return typeof h=="object"&&typeof h.audio=="object"&&(h=JSON.parse(JSON.stringify(h)),l(h.audio,"autoGainControl","mozAutoGainControl"),l(h.audio,"noiseSuppression","mozNoiseSuppression")),u(h)},a&&a.prototype.getSettings){const h=a.prototype.getSettings;a.prototype.getSettings=function(){const f=h.apply(this,arguments);return l(f,"mozAutoGainControl","autoGainControl"),l(f,"mozNoiseSuppression","noiseSuppression"),f}}if(a&&a.prototype.applyConstraints){const h=a.prototype.applyConstraints;a.prototype.applyConstraints=function(f){return this.kind==="audio"&&typeof f=="object"&&(f=JSON.parse(JSON.stringify(f)),l(f,"autoGainControl","mozAutoGainControl"),l(f,"noiseSuppression","mozNoiseSuppression")),h.apply(this,[f])}}}}function ee(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ne(i,t){if(typeof i!="object"||!i.RTCPeerConnection&&!i.mozRTCPeerConnection)return;!i.RTCPeerConnection&&i.mozRTCPeerConnection&&(i.RTCPeerConnection=i.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(l){const u=i.RTCPeerConnection.prototype[l],h={[l](){return arguments[0]=new(l==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),u.apply(this,arguments)}};i.RTCPeerConnection.prototype[l]=h[l]});const r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},a=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){const[l,u,h]=arguments;return a.apply(this,[l||null]).then(f=>{if(t.version<53&&!u)try{f.forEach(v=>{v.type=r[v.type]||v.type})}catch(v){if(v.name!=="TypeError")throw v;f.forEach((E,y)=>{f.set(y,Object.assign({},E,{type:r[E.type]||E.type}))})}return f}).then(u,h)}}function he(i){if(typeof i!="object"||!i.RTCPeerConnection||!i.RTCRtpSender||i.RTCRtpSender&&"getStats"in i.RTCRtpSender.prototype)return;const t=i.RTCPeerConnection.prototype.getSenders;t&&(i.RTCPeerConnection.prototype.getSenders=function(){const a=t.apply(this,[]);return a.forEach(l=>l._pc=this),a});const r=i.RTCPeerConnection.prototype.addTrack;r&&(i.RTCPeerConnection.prototype.addTrack=function(){const a=r.apply(this,arguments);return a._pc=this,a}),i.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function pe(i){if(typeof i!="object"||!i.RTCPeerConnection||!i.RTCRtpSender||i.RTCRtpSender&&"getStats"in i.RTCRtpReceiver.prototype)return;const t=i.RTCPeerConnection.prototype.getReceivers;t&&(i.RTCPeerConnection.prototype.getReceivers=function(){const r=t.apply(this,[]);return r.forEach(a=>a._pc=this),r}),p(i,"track",r=>(r.receiver._pc=r.srcElement,r)),i.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function ce(i){i.RTCPeerConnection&&!("removeStream"in i.RTCPeerConnection.prototype)&&(i.RTCPeerConnection.prototype.removeStream=function(t){S("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&t.getTracks().includes(r.track)&&this.removeTrack(r)})})}function se(i){i.DataChannel&&!i.RTCDataChannel&&(i.RTCDataChannel=i.DataChannel)}function ae(i){if(typeof i!="object"||!i.RTCPeerConnection)return;const t=i.RTCPeerConnection.prototype.addTransceiver;t&&(i.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const a=r.length>0;a&&r.forEach(u=>{if("rid"in u&&!/^[a-z0-9]{0,16}$/i.test(u.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in u&&!(parseFloat(u.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in u&&!(parseFloat(u.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const l=t.apply(this,arguments);if(a){const{sender:u}=l,h=u.getParameters();(!("encodings"in h)||h.encodings.length===1&&Object.keys(h.encodings[0]).length===0)&&(h.encodings=r,u.sendEncodings=r,this.setParametersPromises.push(u.setParameters(h).then(()=>{delete u.sendEncodings}).catch(()=>{delete u.sendEncodings})))}return l})}function Ee(i){if(typeof i!="object"||!i.RTCRtpSender)return;const t=i.RTCRtpSender.prototype.getParameters;t&&(i.RTCRtpSender.prototype.getParameters=function(){const r=t.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function ve(i){if(typeof i!="object"||!i.RTCPeerConnection)return;const t=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function le(i){if(typeof i!="object"||!i.RTCPeerConnection)return;const t=i.RTCPeerConnection.prototype.createAnswer;i.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var de=Object.freeze({__proto__:null,shimAddTransceiver:ae,shimCreateAnswer:le,shimCreateOffer:ve,shimGetDisplayMedia:function(i,t){i.navigator.mediaDevices&&"getDisplayMedia"in i.navigator.mediaDevices||i.navigator.mediaDevices&&(i.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){const a=new DOMException("getDisplayMedia without video constraints is undefined");return a.name="NotFoundError",a.code=8,Promise.reject(a)}return r.video===!0?r.video={mediaSource:t}:r.video.mediaSource=t,i.navigator.mediaDevices.getUserMedia(r)})},shimGetParameters:Ee,shimGetUserMedia:Q,shimOnTrack:ee,shimPeerConnection:ne,shimRTCDataChannel:se,shimReceiverGetStats:pe,shimRemoveStream:ce,shimSenderGetStats:he});function ye(i){if(typeof i=="object"&&i.RTCPeerConnection){if("getLocalStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in i.RTCPeerConnection.prototype)){const t=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(a=>t.call(this,a,r)),r.getVideoTracks().forEach(a=>t.call(this,a,r))},i.RTCPeerConnection.prototype.addTrack=function(r,...a){return a&&a.forEach(l=>{this._localStreams?this._localStreams.includes(l)||this._localStreams.push(l):this._localStreams=[l]}),t.apply(this,arguments)}}"removeStream"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(t);if(r===-1)return;this._localStreams.splice(r,1);const a=t.getTracks();this.getSenders().forEach(l=>{a.includes(l.track)&&this.removeTrack(l)})})}}function fe(i){if(typeof i=="object"&&i.RTCPeerConnection&&("getRemoteStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in i.RTCPeerConnection.prototype))){Object.defineProperty(i.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(r){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=r),this.addEventListener("track",this._onaddstreampoly=a=>{a.streams.forEach(l=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(l))return;this._remoteStreams.push(l);const u=new Event("addstream");u.stream=l,this.dispatchEvent(u)})})}});const t=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(l=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(l)>=0)return;r._remoteStreams.push(l);const u=new Event("addstream");u.stream=l,r.dispatchEvent(u)})}),t.apply(r,arguments)}}}function ke(i){if(typeof i!="object"||!i.RTCPeerConnection)return;const t=i.RTCPeerConnection.prototype,r=t.createOffer,a=t.createAnswer,l=t.setLocalDescription,u=t.setRemoteDescription,h=t.addIceCandidate;t.createOffer=function(v,E){const y=arguments.length>=2?arguments[2]:arguments[0],C=r.apply(this,[y]);return E?(C.then(v,E),Promise.resolve()):C},t.createAnswer=function(v,E){const y=arguments.length>=2?arguments[2]:arguments[0],C=a.apply(this,[y]);return E?(C.then(v,E),Promise.resolve()):C};let f=function(v,E,y){const C=l.apply(this,[v]);return y?(C.then(E,y),Promise.resolve()):C};t.setLocalDescription=f,f=function(v,E,y){const C=u.apply(this,[v]);return y?(C.then(E,y),Promise.resolve()):C},t.setRemoteDescription=f,f=function(v,E,y){const C=h.apply(this,[v]);return y?(C.then(E,y),Promise.resolve()):C},t.addIceCandidate=f}function Me(i){const t=i&&i.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const r=t.mediaDevices,a=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=l=>a(Ve(l))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=(function(r,a,l){t.mediaDevices.getUserMedia(r).then(a,l)}).bind(t))}function Ve(i){return i&&i.video!==void 0?Object.assign({},i,{video:R(i.video)}):i}function je(i){if(!i.RTCPeerConnection)return;const t=i.RTCPeerConnection;i.RTCPeerConnection=function(r,a){if(r&&r.iceServers){const l=[];for(let u=0;u<r.iceServers.length;u++){let h=r.iceServers[u];!h.hasOwnProperty("urls")&&h.hasOwnProperty("url")?(S("RTCIceServer.url","RTCIceServer.urls"),h=JSON.parse(JSON.stringify(h)),h.urls=h.url,delete h.url,l.push(h)):l.push(r.iceServers[u])}r.iceServers=l}return new t(r,a)},i.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(i.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function dt(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ut(i){const t=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(r){if(r){r.offerToReceiveAudio!==void 0&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const a=this.getTransceivers().find(u=>u.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):r.offerToReceiveAudio!==!0||a||this.addTransceiver("audio",{direction:"recvonly"}),r.offerToReceiveVideo!==void 0&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const l=this.getTransceivers().find(u=>u.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):r.offerToReceiveVideo!==!0||l||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function Ct(i){typeof i!="object"||i.AudioContext||(i.AudioContext=i.webkitAudioContext)}var _t=Object.freeze({__proto__:null,shimAudioContext:Ct,shimCallbacksAPI:ke,shimConstraints:Ve,shimCreateOfferLegacy:ut,shimGetUserMedia:Me,shimLocalStreamsAPI:ye,shimRTCIceServerUrls:je,shimRemoteStreamsAPI:fe,shimTrackEventTransceiver:dt}),Tt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Dt<"u"?Dt:typeof self<"u"?self:{};function it(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var kt={exports:{}};(function(i){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(r){return r.trim().split(`
`).map(a=>a.trim())},t.splitSections=function(r){return r.split(`
m=`).map((a,l)=>(l>0?"m="+a:a).trim()+`\r
`)},t.getDescription=function(r){const a=t.splitSections(r);return a&&a[0]},t.getMediaSections=function(r){const a=t.splitSections(r);return a.shift(),a},t.matchPrefix=function(r,a){return t.splitLines(r).filter(l=>l.indexOf(a)===0)},t.parseCandidate=function(r){let a;a=r.indexOf("a=candidate:")===0?r.substring(12).split(" "):r.substring(10).split(" ");const l={foundation:a[0],component:{1:"rtp",2:"rtcp"}[a[1]]||a[1],protocol:a[2].toLowerCase(),priority:parseInt(a[3],10),ip:a[4],address:a[4],port:parseInt(a[5],10),type:a[7]};for(let u=8;u<a.length;u+=2)switch(a[u]){case"raddr":l.relatedAddress=a[u+1];break;case"rport":l.relatedPort=parseInt(a[u+1],10);break;case"tcptype":l.tcpType=a[u+1];break;case"ufrag":l.ufrag=a[u+1],l.usernameFragment=a[u+1];break;default:l[a[u]]===void 0&&(l[a[u]]=a[u+1])}return l},t.writeCandidate=function(r){const a=[];a.push(r.foundation);const l=r.component;l==="rtp"?a.push(1):l==="rtcp"?a.push(2):a.push(l),a.push(r.protocol.toUpperCase()),a.push(r.priority),a.push(r.address||r.ip),a.push(r.port);const u=r.type;return a.push("typ"),a.push(u),u!=="host"&&r.relatedAddress&&r.relatedPort&&(a.push("raddr"),a.push(r.relatedAddress),a.push("rport"),a.push(r.relatedPort)),r.tcpType&&r.protocol.toLowerCase()==="tcp"&&(a.push("tcptype"),a.push(r.tcpType)),(r.usernameFragment||r.ufrag)&&(a.push("ufrag"),a.push(r.usernameFragment||r.ufrag)),"candidate:"+a.join(" ")},t.parseIceOptions=function(r){return r.substring(14).split(" ")},t.parseRtpMap=function(r){let a=r.substring(9).split(" ");const l={payloadType:parseInt(a.shift(),10)};return a=a[0].split("/"),l.name=a[0],l.clockRate=parseInt(a[1],10),l.channels=a.length===3?parseInt(a[2],10):1,l.numChannels=l.channels,l},t.writeRtpMap=function(r){let a=r.payloadType;r.preferredPayloadType!==void 0&&(a=r.preferredPayloadType);const l=r.channels||r.numChannels||1;return"a=rtpmap:"+a+" "+r.name+"/"+r.clockRate+(l!==1?"/"+l:"")+`\r
`},t.parseExtmap=function(r){const a=r.substring(9).split(" ");return{id:parseInt(a[0],10),direction:a[0].indexOf("/")>0?a[0].split("/")[1]:"sendrecv",uri:a[1],attributes:a.slice(2).join(" ")}},t.writeExtmap=function(r){return"a=extmap:"+(r.id||r.preferredId)+(r.direction&&r.direction!=="sendrecv"?"/"+r.direction:"")+" "+r.uri+(r.attributes?" "+r.attributes:"")+`\r
`},t.parseFmtp=function(r){const a={};let l;const u=r.substring(r.indexOf(" ")+1).split(";");for(let h=0;h<u.length;h++)l=u[h].trim().split("="),a[l[0].trim()]=l[1];return a},t.writeFmtp=function(r){let a="",l=r.payloadType;if(r.preferredPayloadType!==void 0&&(l=r.preferredPayloadType),r.parameters&&Object.keys(r.parameters).length){const u=[];Object.keys(r.parameters).forEach(h=>{r.parameters[h]!==void 0?u.push(h+"="+r.parameters[h]):u.push(h)}),a+="a=fmtp:"+l+" "+u.join(";")+`\r
`}return a},t.parseRtcpFb=function(r){const a=r.substring(r.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}},t.writeRtcpFb=function(r){let a="",l=r.payloadType;return r.preferredPayloadType!==void 0&&(l=r.preferredPayloadType),r.rtcpFeedback&&r.rtcpFeedback.length&&r.rtcpFeedback.forEach(u=>{a+="a=rtcp-fb:"+l+" "+u.type+(u.parameter&&u.parameter.length?" "+u.parameter:"")+`\r
`}),a},t.parseSsrcMedia=function(r){const a=r.indexOf(" "),l={ssrc:parseInt(r.substring(7,a),10)},u=r.indexOf(":",a);return u>-1?(l.attribute=r.substring(a+1,u),l.value=r.substring(u+1)):l.attribute=r.substring(a+1),l},t.parseSsrcGroup=function(r){const a=r.substring(13).split(" ");return{semantics:a.shift(),ssrcs:a.map(l=>parseInt(l,10))}},t.getMid=function(r){const a=t.matchPrefix(r,"a=mid:")[0];if(a)return a.substring(6)},t.parseFingerprint=function(r){const a=r.substring(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1].toUpperCase()}},t.getDtlsParameters=function(r,a){return{role:"auto",fingerprints:t.matchPrefix(r+a,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(r,a){let l="a=setup:"+a+`\r
`;return r.fingerprints.forEach(u=>{l+="a=fingerprint:"+u.algorithm+" "+u.value+`\r
`}),l},t.parseCryptoLine=function(r){const a=r.substring(9).split(" ");return{tag:parseInt(a[0],10),cryptoSuite:a[1],keyParams:a[2],sessionParams:a.slice(3)}},t.writeCryptoLine=function(r){return"a=crypto:"+r.tag+" "+r.cryptoSuite+" "+(typeof r.keyParams=="object"?t.writeCryptoKeyParams(r.keyParams):r.keyParams)+(r.sessionParams?" "+r.sessionParams.join(" "):"")+`\r
`},t.parseCryptoKeyParams=function(r){if(r.indexOf("inline:")!==0)return null;const a=r.substring(7).split("|");return{keyMethod:"inline",keySalt:a[0],lifeTime:a[1],mkiValue:a[2]?a[2].split(":")[0]:void 0,mkiLength:a[2]?a[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(r){return r.keyMethod+":"+r.keySalt+(r.lifeTime?"|"+r.lifeTime:"")+(r.mkiValue&&r.mkiLength?"|"+r.mkiValue+":"+r.mkiLength:"")},t.getCryptoParameters=function(r,a){return t.matchPrefix(r+a,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(r,a){const l=t.matchPrefix(r+a,"a=ice-ufrag:")[0],u=t.matchPrefix(r+a,"a=ice-pwd:")[0];return l&&u?{usernameFragment:l.substring(12),password:u.substring(10)}:null},t.writeIceParameters=function(r){let a="a=ice-ufrag:"+r.usernameFragment+`\r
a=ice-pwd:`+r.password+`\r
`;return r.iceLite&&(a+=`a=ice-lite\r
`),a},t.parseRtpParameters=function(r){const a={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},l=t.splitLines(r)[0].split(" ");a.profile=l[2];for(let h=3;h<l.length;h++){const f=l[h],v=t.matchPrefix(r,"a=rtpmap:"+f+" ")[0];if(v){const E=t.parseRtpMap(v),y=t.matchPrefix(r,"a=fmtp:"+f+" ");switch(E.parameters=y.length?t.parseFmtp(y[0]):{},E.rtcpFeedback=t.matchPrefix(r,"a=rtcp-fb:"+f+" ").map(t.parseRtcpFb),a.codecs.push(E),E.name.toUpperCase()){case"RED":case"ULPFEC":a.fecMechanisms.push(E.name.toUpperCase())}}}t.matchPrefix(r,"a=extmap:").forEach(h=>{a.headerExtensions.push(t.parseExtmap(h))});const u=t.matchPrefix(r,"a=rtcp-fb:* ").map(t.parseRtcpFb);return a.codecs.forEach(h=>{u.forEach(f=>{h.rtcpFeedback.find(v=>v.type===f.type&&v.parameter===f.parameter)||h.rtcpFeedback.push(f)})}),a},t.writeRtpDescription=function(r,a){let l="";l+="m="+r+" ",l+=a.codecs.length>0?"9":"0",l+=" "+(a.profile||"UDP/TLS/RTP/SAVPF")+" ",l+=a.codecs.map(h=>h.preferredPayloadType!==void 0?h.preferredPayloadType:h.payloadType).join(" ")+`\r
`,l+=`c=IN IP4 0.0.0.0\r
`,l+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,a.codecs.forEach(h=>{l+=t.writeRtpMap(h),l+=t.writeFmtp(h),l+=t.writeRtcpFb(h)});let u=0;return a.codecs.forEach(h=>{h.maxptime>u&&(u=h.maxptime)}),u>0&&(l+="a=maxptime:"+u+`\r
`),a.headerExtensions&&a.headerExtensions.forEach(h=>{l+=t.writeExtmap(h)}),l},t.parseRtpEncodingParameters=function(r){const a=[],l=t.parseRtpParameters(r),u=l.fecMechanisms.indexOf("RED")!==-1,h=l.fecMechanisms.indexOf("ULPFEC")!==-1,f=t.matchPrefix(r,"a=ssrc:").map(I=>t.parseSsrcMedia(I)).filter(I=>I.attribute==="cname"),v=f.length>0&&f[0].ssrc;let E;const y=t.matchPrefix(r,"a=ssrc-group:FID").map(I=>I.substring(17).split(" ").map(k=>parseInt(k,10)));y.length>0&&y[0].length>1&&y[0][0]===v&&(E=y[0][1]),l.codecs.forEach(I=>{if(I.name.toUpperCase()==="RTX"&&I.parameters.apt){let k={ssrc:v,codecPayloadType:parseInt(I.parameters.apt,10)};v&&E&&(k.rtx={ssrc:E}),a.push(k),u&&(k=JSON.parse(JSON.stringify(k)),k.fec={ssrc:v,mechanism:h?"red+ulpfec":"red"},a.push(k))}}),a.length===0&&v&&a.push({ssrc:v});let C=t.matchPrefix(r,"b=");return C.length&&(C=C[0].indexOf("b=TIAS:")===0?parseInt(C[0].substring(7),10):C[0].indexOf("b=AS:")===0?1e3*parseInt(C[0].substring(5),10)*.95-16e3:void 0,a.forEach(I=>{I.maxBitrate=C})),a},t.parseRtcpParameters=function(r){const a={},l=t.matchPrefix(r,"a=ssrc:").map(f=>t.parseSsrcMedia(f)).filter(f=>f.attribute==="cname")[0];l&&(a.cname=l.value,a.ssrc=l.ssrc);const u=t.matchPrefix(r,"a=rtcp-rsize");a.reducedSize=u.length>0,a.compound=u.length===0;const h=t.matchPrefix(r,"a=rtcp-mux");return a.mux=h.length>0,a},t.writeRtcpParameters=function(r){let a="";return r.reducedSize&&(a+=`a=rtcp-rsize\r
`),r.mux&&(a+=`a=rtcp-mux\r
`),r.ssrc!==void 0&&r.cname&&(a+="a=ssrc:"+r.ssrc+" cname:"+r.cname+`\r
`),a},t.parseMsid=function(r){let a;const l=t.matchPrefix(r,"a=msid:");if(l.length===1)return a=l[0].substring(7).split(" "),{stream:a[0],track:a[1]};const u=t.matchPrefix(r,"a=ssrc:").map(h=>t.parseSsrcMedia(h)).filter(h=>h.attribute==="msid");return u.length>0?(a=u[0].value.split(" "),{stream:a[0],track:a[1]}):void 0},t.parseSctpDescription=function(r){const a=t.parseMLine(r),l=t.matchPrefix(r,"a=max-message-size:");let u;l.length>0&&(u=parseInt(l[0].substring(19),10)),isNaN(u)&&(u=65536);const h=t.matchPrefix(r,"a=sctp-port:");if(h.length>0)return{port:parseInt(h[0].substring(12),10),protocol:a.fmt,maxMessageSize:u};const f=t.matchPrefix(r,"a=sctpmap:");if(f.length>0){const v=f[0].substring(10).split(" ");return{port:parseInt(v[0],10),protocol:v[1],maxMessageSize:u}}},t.writeSctpDescription=function(r,a){let l=[];return l=r.protocol!=="DTLS/SCTP"?["m="+r.kind+" 9 "+r.protocol+" "+a.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+a.port+`\r
`]:["m="+r.kind+" 9 "+r.protocol+" "+a.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+a.port+" "+a.protocol+` 65535\r
`],a.maxMessageSize!==void 0&&l.push("a=max-message-size:"+a.maxMessageSize+`\r
`),l.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(r,a,l){let u;const h=a!==void 0?a:2;return u=r||t.generateSessionId(),`v=0\r
o=`+(l||"thisisadapterortc")+" "+u+" "+h+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},t.getDirection=function(r,a){const l=t.splitLines(r);for(let u=0;u<l.length;u++)switch(l[u]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return l[u].substring(2)}return a?t.getDirection(a):"sendrecv"},t.getKind=function(r){return t.splitLines(r)[0].split(" ")[0].substring(2)},t.isRejected=function(r){return r.split(" ",2)[1]==="0"},t.parseMLine=function(r){const a=t.splitLines(r)[0].substring(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}},t.parseOLine=function(r){const a=t.matchPrefix(r,"o=")[0].substring(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}},t.isValidSDP=function(r){if(typeof r!="string"||r.length===0)return!1;const a=t.splitLines(r);for(let l=0;l<a.length;l++)if(a[l].length<2||a[l].charAt(1)!=="=")return!1;return!0},i.exports=t})(kt);var qt=kt.exports,xt=it(qt),ze=o({__proto__:null,default:xt},[qt]);function ct(i){if(!i.RTCIceCandidate||i.RTCIceCandidate&&"foundation"in i.RTCIceCandidate.prototype)return;const t=i.RTCIceCandidate;i.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&((r=JSON.parse(JSON.stringify(r))).candidate=r.candidate.substr(2)),r.candidate&&r.candidate.length){const a=new t(r),l=xt.parseCandidate(r.candidate),u=Object.assign(a,l);return u.toJSON=function(){return{candidate:u.candidate,sdpMid:u.sdpMid,sdpMLineIndex:u.sdpMLineIndex,usernameFragment:u.usernameFragment}},u}return new t(r)},i.RTCIceCandidate.prototype=t.prototype,p(i,"icecandidate",r=>(r.candidate&&Object.defineProperty(r,"candidate",{value:new i.RTCIceCandidate(r.candidate),writable:"false"}),r))}function et(i){!i.RTCIceCandidate||i.RTCIceCandidate&&"relayProtocol"in i.RTCIceCandidate.prototype||p(i,"icecandidate",t=>{if(t.candidate){const r=xt.parseCandidate(t.candidate.candidate);r.type==="relay"&&(t.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[r.priority>>24])}return t})}function tt(i,t){if(!i.RTCPeerConnection)return;"sctp"in i.RTCPeerConnection.prototype||Object.defineProperty(i.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const r=function(f){if(!f||!f.sdp)return!1;const v=xt.splitSections(f.sdp);return v.shift(),v.some(E=>{const y=xt.parseMLine(E);return y&&y.kind==="application"&&y.protocol.indexOf("SCTP")!==-1})},a=function(f){const v=f.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(v===null||v.length<2)return-1;const E=parseInt(v[1],10);return E!=E?-1:E},l=function(f){let v=65536;return t.browser==="firefox"&&(v=t.version<57?f===-1?16384:2147483637:t.version<60?t.version===57?65535:65536:2147483637),v},u=function(f,v){let E=65536;t.browser==="firefox"&&t.version===57&&(E=65535);const y=xt.matchPrefix(f.sdp,"a=max-message-size:");return y.length>0?E=parseInt(y[0].substr(19),10):t.browser==="firefox"&&v!==-1&&(E=2147483637),E},h=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,t.browser==="chrome"&&t.version>=76){const{sdpSemantics:f}=this.getConfiguration();f==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(r(arguments[0])){const f=a(arguments[0]),v=l(f),E=u(arguments[0],f);let y;y=v===0&&E===0?Number.POSITIVE_INFINITY:v===0||E===0?Math.max(v,E):Math.min(v,E);const C={};Object.defineProperty(C,"maxMessageSize",{get:()=>y}),this._sctp=C}return h.apply(this,arguments)}}function mt(i){if(!i.RTCPeerConnection||!("createDataChannel"in i.RTCPeerConnection.prototype))return;function t(a,l){const u=a.send;a.send=function(){const h=arguments[0],f=h.length||h.size||h.byteLength;if(a.readyState==="open"&&l.sctp&&f>l.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+l.sctp.maxMessageSize+" bytes)");return u.apply(a,arguments)}}const r=i.RTCPeerConnection.prototype.createDataChannel;i.RTCPeerConnection.prototype.createDataChannel=function(){const a=r.apply(this,arguments);return t(a,this),a},p(i,"datachannel",a=>(t(a.channel,a.target),a))}function Ot(i){if(!i.RTCPeerConnection||"connectionState"in i.RTCPeerConnection.prototype)return;const t=i.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(r){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),r&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=r)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(r=>{const a=t[r];t[r]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=l=>{const u=l.target;if(u._lastConnectionState!==u.connectionState){u._lastConnectionState=u.connectionState;const h=new Event("connectionstatechange",l);u.dispatchEvent(h)}return l},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),a.apply(this,arguments)}})}function Ht(i,t){if(!i.RTCPeerConnection||t.browser==="chrome"&&t.version>=71||t.browser==="safari"&&t.version>=605)return;const r=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(a){if(a&&a.sdp&&a.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const l=a.sdp.split(`
`).filter(u=>u.trim()!=="a=extmap-allow-mixed").join(`
`);i.RTCSessionDescription&&a instanceof i.RTCSessionDescription?arguments[0]=new i.RTCSessionDescription({type:a.type,sdp:l}):a.sdp=l}return r.apply(this,arguments)}}function hn(i,t){if(!i.RTCPeerConnection||!i.RTCPeerConnection.prototype)return;const r=i.RTCPeerConnection.prototype.addIceCandidate;r&&r.length!==0&&(i.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(t.browser==="chrome"&&t.version<78||t.browser==="firefox"&&t.version<68||t.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Lt(i,t){if(!i.RTCPeerConnection||!i.RTCPeerConnection.prototype)return;const r=i.RTCPeerConnection.prototype.setLocalDescription;r&&r.length!==0&&(i.RTCPeerConnection.prototype.setLocalDescription=function(){let a=arguments[0]||{};if(typeof a!="object"||a.type&&a.sdp)return r.apply(this,arguments);if(a={type:a.type,sdp:a.sdp},!a.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":a.type="offer";break;default:a.type="answer"}return a.sdp||a.type!=="offer"&&a.type!=="answer"?r.apply(this,[a]):(a.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(l=>r.apply(this,[l]))})}var br=Object.freeze({__proto__:null,removeExtmapAllowMixed:Ht,shimAddIceCandidateNullOrEmpty:hn,shimConnectionState:Ot,shimMaxMessageSize:tt,shimParameterlessSetLocalDescription:Lt,shimRTCIceCandidate:ct,shimRTCIceCandidateRelayProtocol:et,shimSendThrowTypeError:mt});(function({window:i}={},t={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const r=_,a=function(u){const h={browser:null,version:null};if(u===void 0||!u.navigator)return h.browser="Not a browser.",h;const{navigator:f}=u;if(f.mozGetUserMedia)h.browser="firefox",h.version=d(f.userAgent,/Firefox\/(\d+)\./,1);else if(f.webkitGetUserMedia||u.isSecureContext===!1&&u.webkitRTCPeerConnection)h.browser="chrome",h.version=d(f.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!u.RTCPeerConnection||!f.userAgent.match(/AppleWebKit\/(\d+)\./))return h.browser="Not a supported browser.",h;h.browser="safari",h.version=d(f.userAgent,/AppleWebKit\/(\d+)\./,1),h.supportsUnifiedPlan=u.RTCRtpTransceiver&&"currentDirection"in u.RTCRtpTransceiver.prototype}return h}(i),l={browserDetails:a,commonShim:br,extractVersion:d,disableLog:m,disableWarnings:g,sdp:ze};switch(a.browser){case"chrome":if(!q||!K||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),l;if(a.version===null)return r("Chrome shim can not determine version, not shimming."),l;r("adapter.js shimming chrome."),l.browserShim=q,hn(i,a),Lt(i),M(i,a),x(i),K(i,a),P(i),H(i,a),D(i),F(i),j(i),J(i,a),ct(i),et(i),Ot(i),tt(i,a),mt(i),Ht(i,a);break;case"firefox":if(!de||!ne||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),l;r("adapter.js shimming firefox."),l.browserShim=de,hn(i,a),Lt(i),Q(i,a),ne(i,a),ee(i),ce(i),he(i),pe(i),se(i),ae(i),Ee(i),ve(i),le(i),ct(i),Ot(i),tt(i,a),mt(i);break;case"safari":if(!_t||!t.shimSafari)return r("Safari shim is not included in this adapter release."),l;r("adapter.js shimming safari."),l.browserShim=_t,hn(i,a),Lt(i),je(i),ut(i),ke(i),ye(i),fe(i),dt(i),Me(i),Ct(i),ct(i),et(i),tt(i,a),mt(i),Ht(i,a);break;default:r("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var Xt=function(i){try{return!!i()}catch{return!0}},In=!Xt(function(){var i=(function(){}).bind();return typeof i!="function"||i.hasOwnProperty("prototype")}),Hr=In,sn=Function.prototype,Dr=sn.call,Qn=Hr&&sn.bind.bind(Dr,Dr),Ut=Hr?Qn:function(i){return function(){return Dr.apply(i,arguments)}},Jt=Ut({}.isPrototypeOf),ai=function(i){return i&&i.Math==Math&&i},Gn=ai(typeof globalThis=="object"&&globalThis)||ai(typeof window=="object"&&window)||ai(typeof self=="object"&&self)||ai(typeof Tt=="object"&&Tt)||function(){return this}()||Tt||Function("return this")(),kr=In,Tr=Function.prototype,nt=Tr.apply,yt=Tr.call,En=typeof Reflect=="object"&&Reflect.apply||(kr?yt.bind(nt):function(){return yt.apply(nt,arguments)}),Qt=Ut,tn=Qt({}.toString),Wr=Qt("".slice),_n=function(i){return Wr(tn(i),8,-1)},jt=_n,pn=Ut,Pn=function(i){if(jt(i)==="Function")return pn(i)},Vn=typeof document=="object"&&document.all,Jr={all:Vn,IS_HTMLDDA:Vn===void 0&&Vn!==void 0},Qr=Jr.all,gn=Jr.IS_HTMLDDA?function(i){return typeof i=="function"||i===Qr}:function(i){return typeof i=="function"},Ni={},Pi=!Xt(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),As=In,Zr=Function.prototype.call,dr=As?Zr.bind(Zr):function(){return Zr.apply(Zr,arguments)},Wo={},Xa={}.propertyIsEnumerable,Os=Object.getOwnPropertyDescriptor,Tl=Os&&!Xa.call({1:2},1);Wo.f=Tl?function(i){var t=Os(this,i);return!!t&&t.enumerable}:Xa;var si,xs,zr=function(i,t){return{enumerable:!(1&i),configurable:!(2&i),writable:!(4&i),value:t}},Ns=Xt,Rl=_n,sc=Object,Ja=Ut("".split),Qa=Ns(function(){return!sc("z").propertyIsEnumerable(0)})?function(i){return Rl(i)=="String"?Ja(i,""):sc(i)}:sc,zo=function(i){return i==null},wl=zo,Mu=TypeError,uo=function(i){if(wl(i))throw Mu("Can't call method on "+i);return i},Go=Qa,Bc=uo,Ji=function(i){return Go(Bc(i))},ya=gn,Sa=Jr.all,ei=Jr.IS_HTMLDDA?function(i){return typeof i=="object"?i!==null:ya(i)||i===Sa}:function(i){return typeof i=="object"?i!==null:ya(i)},ho={},Za=ho,Po=Gn,Fu=gn,Kn=function(i){return Fu(i)?i:void 0},Yt=function(i,t){return arguments.length<2?Kn(Za[i])||Kn(Po[i]):Za[i]&&Za[i][t]||Po[i]&&Po[i][t]},yn=typeof navigator<"u"&&String(navigator.userAgent)||"",ci=Gn,li=yn,Ko=ci.process,Ca=ci.Deno,Il=Ko&&Ko.versions||Ca&&Ca.version,Zd=Il&&Il.v8;Zd&&(xs=(si=Zd.split("."))[0]>0&&si[0]<4?1:+(si[0]+si[1])),!xs&&li&&(!(si=li.match(/Edge\/(\d+)/))||si[1]>=74)&&(si=li.match(/Chrome\/(\d+)/))&&(xs=+si[1]);var es=xs,eh=es,Ef=Xt,lg=Gn.String,qo=!!Object.getOwnPropertySymbols&&!Ef(function(){var i=Symbol();return!lg(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&eh&&eh<41}),po=qo&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Uu=Yt,Al=gn,cc=Jt,lc=Object,Ps=po?function(i){return typeof i=="symbol"}:function(i){var t=Uu("Symbol");return Al(t)&&cc(t.prototype,lc(i))},th=String,uc=function(i){try{return th(i)}catch{return"Object"}},_f=gn,yf=uc,gt=TypeError,Nt=function(i){if(_f(i))return i;throw gt(yf(i)+" is not a function")},gr=Nt,ui=zo,vr=function(i,t){var r=i[t];return ui(r)?void 0:gr(r)},Ol=dr,Bu=gn,nh=ei,rh=TypeError,$x={exports:{}},Hx=Gn,WH=Object.defineProperty,zH=function(i,t){try{WH(Hx,i,{value:t,configurable:!0,writable:!0})}catch{Hx[i]=t}return t},Wx="__core-js_shared__",zS=Gn[Wx]||zH(Wx,{}),zx=zS;($x.exports=function(i,t){return zx[i]||(zx[i]=t!==void 0?t:{})})("versions",[]).push({version:"3.31.1",mode:"pure",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"});var ih=$x.exports,GH=uo,KH=Object,ju=function(i){return KH(GH(i))},qH=ju,YH=Ut({}.hasOwnProperty),fo=Object.hasOwn||function(i,t){return YH(qH(i),t)},XH=Ut,JH=0,QH=Math.random(),ZH=XH(1 .toString),GS=function(i){return"Symbol("+(i===void 0?"":i)+")_"+ZH(++JH+QH,36)},eW=ih,Gx=fo,tW=GS,nW=qo,rW=po,oh=Gn.Symbol,KS=eW("wks"),iW=rW?oh.for||oh:oh&&oh.withoutSetter||tW,Lr=function(i){return Gx(KS,i)||(KS[i]=nW&&Gx(oh,i)?oh[i]:iW("Symbol."+i)),KS[i]},oW=dr,Kx=ei,qx=Ps,aW=vr,sW=function(i,t){var r,a;if(t==="string"&&Bu(r=i.toString)&&!nh(a=Ol(r,i))||Bu(r=i.valueOf)&&!nh(a=Ol(r,i))||t!=="string"&&Bu(r=i.toString)&&!nh(a=Ol(r,i)))return a;throw rh("Can't convert object to primitive value")},cW=TypeError,lW=Lr("toPrimitive"),uW=function(i,t){if(!Kx(i)||qx(i))return i;var r,a=aW(i,lW);if(a){if(t===void 0&&(t="default"),r=oW(a,i,t),!Kx(r)||qx(r))return r;throw cW("Can't convert object to primitive value")}return t===void 0&&(t="number"),sW(i,t)},dW=Ps,ug=function(i){var t=uW(i,"string");return dW(t)?t:t+""},Yx=ei,qS=Gn.document,hW=Yx(qS)&&Yx(qS.createElement),YS=function(i){return hW?qS.createElement(i):{}},pW=YS,Xx=!Pi&&!Xt(function(){return Object.defineProperty(pW("div"),"a",{get:function(){return 7}}).a!=7}),fW=Pi,mW=dr,gW=Wo,vW=zr,EW=Ji,_W=ug,yW=fo,SW=Xx,Jx=Object.getOwnPropertyDescriptor;Ni.f=fW?Jx:function(i,t){if(i=EW(i),t=_W(t),SW)try{return Jx(i,t)}catch{}if(yW(i,t))return vW(!mW(gW.f,i,t),i[t])};var CW=Xt,bW=gn,TW=/#|\.prototype\./,Sf=function(i,t){var r=wW[RW(i)];return r==AW||r!=IW&&(bW(t)?CW(t):!!t)},RW=Sf.normalize=function(i){return String(i).replace(TW,".").toLowerCase()},wW=Sf.data={},IW=Sf.NATIVE="N",AW=Sf.POLYFILL="P",Qx=Sf,OW=Nt,xW=In,NW=Pn(Pn.bind),Cf=function(i,t){return OW(i),t===void 0?i:xW?NW(i,t):function(){return i.apply(t,arguments)}},ts={},Zx=Pi&&Xt(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),PW=ei,DW=String,kW=TypeError,Ds=function(i){if(PW(i))return i;throw kW(DW(i)+" is not an object")},LW=Pi,MW=Xx,FW=Zx,dg=Ds,eN=ug,UW=TypeError,XS=Object.defineProperty,BW=Object.getOwnPropertyDescriptor,JS="enumerable",QS="configurable",ZS="writable";ts.f=LW?FW?function(i,t,r){if(dg(i),t=eN(t),dg(r),typeof i=="function"&&t==="prototype"&&"value"in r&&ZS in r&&!r[ZS]){var a=BW(i,t);a&&a[ZS]&&(i[t]=r.value,r={configurable:QS in r?r[QS]:a[QS],enumerable:JS in r?r[JS]:a[JS],writable:!1})}return XS(i,t,r)}:XS:function(i,t,r){if(dg(i),t=eN(t),dg(r),MW)try{return XS(i,t,r)}catch{}if("get"in r||"set"in r)throw UW("Accessors not supported");return"value"in r&&(i[t]=r.value),i};var jW=ts,VW=zr,xl=Pi?function(i,t,r){return jW.f(i,t,VW(1,r))}:function(i,t,r){return i[t]=r,i},hg=Gn,$W=En,HW=Pn,WW=gn,zW=Ni.f,GW=Qx,ah=ho,KW=Cf,sh=xl,tN=fo,qW=function(i){var t=function(r,a,l){if(this instanceof t){switch(arguments.length){case 0:return new i;case 1:return new i(r);case 2:return new i(r,a)}return new i(r,a,l)}return $W(i,this,arguments)};return t.prototype=i.prototype,t},Zn=function(i,t){var r,a,l,u,h,f,v,E,y,C=i.target,I=i.global,k=i.stat,W=i.proto,$=I?hg:k?hg[C]:(hg[C]||{}).prototype,z=I?ah:ah[C]||sh(ah,C,{})[C],X=z.prototype;for(u in t)a=!(r=GW(I?u:C+(k?".":"#")+u,i.forced))&&$&&tN($,u),f=z[u],a&&(v=i.dontCallGetSet?(y=zW($,u))&&y.value:$[u]),h=a&&v?v:t[u],a&&typeof f==typeof h||(E=i.bind&&a?KW(h,hg):i.wrap&&a?qW(h):W&&WW(h)?HW(h):h,(i.sham||h&&h.sham||f&&f.sham)&&sh(E,"sham",!0),sh(z,u,E),W&&(tN(ah,l=C+"Prototype")||sh(ah,l,{}),sh(ah[l],u,h),i.real&&X&&(r||!X[u])&&sh(X,u,h)))},YW=Math.ceil,XW=Math.floor,JW=Math.trunc||function(i){var t=+i;return(t>0?XW:YW)(t)},eC=function(i){var t=+i;return t!=t||t===0?0:JW(t)},QW=eC,ZW=Math.max,ez=Math.min,nN=function(i,t){var r=QW(i);return r<0?ZW(r+t,0):ez(r,t)},tz=eC,nz=Math.min,rz=function(i){return i>0?nz(tz(i),9007199254740991):0},Vu=function(i){return rz(i.length)},iz=Ji,oz=nN,az=Vu,rN=function(i){return function(t,r,a){var l,u=iz(t),h=az(u),f=oz(a,h);if(i&&r!=r){for(;h>f;)if((l=u[f++])!=l)return!0}else for(;h>f;f++)if((i||f in u)&&u[f]===r)return i||f||0;return!i&&-1}},iN={includes:rN(!0),indexOf:rN(!1)},sz=iN.includes;Zn({target:"Array",proto:!0,forced:Xt(function(){return!Array(1).includes()})},{includes:function(i){return sz(this,i,arguments.length>1?arguments[1]:void 0)}});var cz=ho,$u=function(i){return cz[i+"Prototype"]},lz=$u("Array").includes,uz=ei,dz=_n,hz=Lr("match"),pz=function(i){var t;return uz(i)&&((t=i[hz])!==void 0?!!t:dz(i)=="RegExp")},fz=TypeError,oN={};oN[Lr("toStringTag")]="z";var tC=String(oN)==="[object z]",mz=tC,gz=gn,pg=_n,vz=Lr("toStringTag"),Ez=Object,_z=pg(function(){return arguments}())=="Arguments",Hu=mz?pg:function(i){var t,r,a;return i===void 0?"Undefined":i===null?"Null":typeof(r=function(l,u){try{return l[u]}catch{}}(t=Ez(i),vz))=="string"?r:_z?pg(t):(a=pg(t))=="Object"&&gz(t.callee)?"Arguments":a},yz=Hu,Sz=String,jc=function(i){if(yz(i)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return Sz(i)},Cz=Lr("match"),bz=Zn,Tz=function(i){if(pz(i))throw fz("The method doesn't accept regular expressions");return i},Rz=uo,aN=jc,wz=function(i){var t=/./;try{"/./"[i](t)}catch{try{return t[Cz]=!1,"/./"[i](t)}catch{}}return!1},Iz=Ut("".indexOf);bz({target:"String",proto:!0,forced:!wz("includes")},{includes:function(i){return!!~Iz(aN(Rz(this)),aN(Tz(i)),arguments.length>1?arguments[1]:void 0)}});var Az=$u("String").includes,sN=Jt,Oz=lz,xz=Az,nC=Array.prototype,rC=String.prototype,Ke=it(function(i){var t=i.includes;return i===nC||sN(nC,i)&&t===nC.includes?Oz:typeof i=="string"||i===rC||sN(rC,i)&&t===rC.includes?xz:t}),cN={exports:{}},Nz=Zn,Pz=Pi,lN=ts.f;Nz({target:"Object",stat:!0,forced:Object.defineProperty!==lN,sham:!Pz},{defineProperty:lN});var uN=ho.Object,Dz=cN.exports=function(i,t,r){return uN.defineProperty(i,t,r)};uN.defineProperty.sham&&(Dz.sham=!0);var kz=it(cN.exports),Lz=_n,iC=Array.isArray||function(i){return Lz(i)=="Array"},Mz=TypeError,Fz=ug,Uz=ts,Bz=zr,dN=function(i,t,r){var a=Fz(t);a in i?Uz.f(i,a,Bz(0,r)):i[a]=r},jz=gn,oC=zS,Vz=Ut(Function.toString);jz(oC.inspectSource)||(oC.inspectSource=function(i){return Vz(i)});var hN=oC.inspectSource,$z=Ut,Hz=Xt,pN=gn,Wz=Hu,zz=hN,fN=function(){},Gz=[],mN=Yt("Reflect","construct"),aC=/^\s*(?:class|function)\b/,Kz=$z(aC.exec),qz=!aC.exec(fN),bf=function(i){if(!pN(i))return!1;try{return mN(fN,Gz,i),!0}catch{return!1}},gN=function(i){if(!pN(i))return!1;switch(Wz(i)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return qz||!!Kz(aC,zz(i))}catch{return!0}};gN.sham=!0;var vN=!mN||Hz(function(){var i;return bf(bf.call)||!bf(Object)||!bf(function(){i=!0})||i})?gN:bf,EN=iC,Yz=vN,Xz=ei,Jz=Lr("species"),_N=Array,Qz=function(i){var t;return EN(i)&&(t=i.constructor,(Yz(t)&&(t===_N||EN(t.prototype))||Xz(t)&&(t=t[Jz])===null)&&(t=void 0)),t===void 0?_N:t},yN=function(i,t){return new(Qz(i))(t===0?0:t)},Zz=Xt,eG=es,tG=Lr("species"),nG=Zn,rG=Xt,iG=iC,oG=ei,aG=ju,sG=Vu,SN=function(i){if(i>9007199254740991)throw Mz("Maximum allowed index exceeded");return i},CN=dN,cG=yN,lG=function(i){return eG>=51||!Zz(function(){var t=[];return(t.constructor={})[tG]=function(){return{foo:1}},t[i](Boolean).foo!==1})},uG=es,bN=Lr("isConcatSpreadable"),dG=uG>=51||!rG(function(){var i=[];return i[bN]=!1,i.concat()[0]!==i}),hG=function(i){if(!oG(i))return!1;var t=i[bN];return t!==void 0?!!t:iG(i)};nG({target:"Array",proto:!0,arity:1,forced:!dG||!lG("concat")},{concat:function(i){var t,r,a,l,u,h=aG(this),f=cG(h,0),v=0;for(t=-1,a=arguments.length;t<a;t++)if(hG(u=t===-1?h:arguments[t]))for(l=sG(u),SN(v+l),r=0;r<l;r++,v++)r in u&&CN(f,v,u[r]);else SN(v+1),CN(f,v++,u);return f.length=v,f}});var sC={},fg={},cC=fo,pG=Ji,fG=iN.indexOf,mG=fg,TN=Ut([].push),RN=function(i,t){var r,a=pG(i),l=0,u=[];for(r in a)!cC(mG,r)&&cC(a,r)&&TN(u,r);for(;t.length>l;)cC(a,r=t[l++])&&(~fG(u,r)||TN(u,r));return u},lC=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],gG=RN,vG=lC,wN=Object.keys||function(i){return gG(i,vG)},EG=Pi,_G=Zx,yG=ts,SG=Ds,CG=Ji,bG=wN;sC.f=EG&&!_G?Object.defineProperties:function(i,t){SG(i);for(var r,a=CG(t),l=bG(t),u=l.length,h=0;u>h;)yG.f(i,r=l[h++],a[r]);return i};var mg,IN=Yt("document","documentElement"),TG=GS,AN=ih("keys"),gg=function(i){return AN[i]||(AN[i]=TG(i))},RG=Ds,wG=sC,ON=lC,IG=fg,AG=IN,OG=YS,uC="prototype",dC="script",xN=gg("IE_PROTO"),hC=function(){},NN=function(i){return"<"+dC+">"+i+"</"+dC+">"},PN=function(i){i.write(NN("")),i.close();var t=i.parentWindow.Object;return i=null,t},vg=function(){try{mg=new ActiveXObject("htmlfile")}catch{}var i,t,r;vg=typeof document<"u"?document.domain&&mg?PN(mg):(t=OG("iframe"),r="java"+dC+":",t.style.display="none",AG.appendChild(t),t.src=String(r),(i=t.contentWindow.document).open(),i.write(NN("document.F=Object")),i.close(),i.F):PN(mg);for(var a=ON.length;a--;)delete vg[uC][ON[a]];return vg()};IG[xN]=!0;var Eg=Object.create||function(i,t){var r;return i!==null?(hC[uC]=RG(i),r=new hC,hC[uC]=null,r[xN]=i):r=vg(),t===void 0?r:wG.f(r,t)},_g={},xG=RN,NG=lC.concat("length","prototype");_g.f=Object.getOwnPropertyNames||function(i){return xG(i,NG)};var DN={},kN=nN,PG=Vu,DG=dN,kG=Array,LG=Math.max,LN=function(i,t,r){for(var a=PG(i),l=kN(t,a),u=kN(r===void 0?a:r,a),h=kG(LG(u-l,0)),f=0;l<u;l++,f++)DG(h,f,i[l]);return h.length=f,h},MG=_n,FG=Ji,MN=_g.f,UG=LN,FN=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];DN.f=function(i){return FN&&MG(i)=="Window"?function(t){try{return MN(t)}catch{return UG(FN)}}(i):MN(FG(i))};var yg={};yg.f=Object.getOwnPropertySymbols;var BG=xl,Tf=function(i,t,r,a){return a&&a.enumerable?i[t]=r:BG(i,t,r),i},jG=ts,UN=function(i,t,r){return jG.f(i,t,r)},ch={},VG=Lr;ch.f=VG;var Sg,Rf,Cg,BN=ho,$G=fo,HG=ch,WG=ts.f,ti=function(i){var t=BN.Symbol||(BN.Symbol={});$G(t,i)||WG(t,i,{value:HG.f(i)})},zG=dr,GG=Yt,KG=Lr,qG=Tf,jN=function(){var i=GG("Symbol"),t=i&&i.prototype,r=t&&t.valueOf,a=KG("toPrimitive");t&&!t[a]&&qG(t,a,function(l){return zG(r,this)},{arity:1})},YG=Hu,XG=tC?{}.toString:function(){return"[object "+YG(this)+"]"},JG=tC,QG=ts.f,ZG=xl,eK=fo,tK=XG,VN=Lr("toStringTag"),lh=function(i,t,r,a){if(i){var l=r?i:i.prototype;eK(l,VN)||QG(l,VN,{configurable:!0,value:t}),a&&!JG&&ZG(l,"toString",tK)}},nK=gn,$N=Gn.WeakMap,rK=nK($N)&&/native code/.test(String($N)),HN=Gn,iK=ei,oK=xl,pC=fo,fC=zS,aK=gg,sK=fg,WN="Object already initialized",mC=HN.TypeError,cK=HN.WeakMap;if(rK||fC.state){var dc=fC.state||(fC.state=new cK);dc.get=dc.get,dc.has=dc.has,dc.set=dc.set,Sg=function(i,t){if(dc.has(i))throw mC(WN);return t.facade=i,dc.set(i,t),t},Rf=function(i){return dc.get(i)||{}},Cg=function(i){return dc.has(i)}}else{var uh=aK("state");sK[uh]=!0,Sg=function(i,t){if(pC(i,uh))throw mC(WN);return t.facade=i,oK(i,uh,t),t},Rf=function(i){return pC(i,uh)?i[uh]:{}},Cg=function(i){return pC(i,uh)}}var bg={set:Sg,get:Rf,has:Cg,enforce:function(i){return Cg(i)?Rf(i):Sg(i,{})},getterFor:function(i){return function(t){var r;if(!iK(t)||(r=Rf(t)).type!==i)throw mC("Incompatible receiver, "+i+" required");return r}}},lK=Cf,uK=Qa,dK=ju,hK=Vu,pK=yN,zN=Ut([].push),Nl=function(i){var t=i==1,r=i==2,a=i==3,l=i==4,u=i==6,h=i==7,f=i==5||u;return function(v,E,y,C){for(var I,k,W=dK(v),$=uK(W),z=lK(E,y),X=hK($),ie=0,oe=C||pK,Re=t?oe(v,X):r||h?oe(v,0):void 0;X>ie;ie++)if((f||ie in $)&&(k=z(I=$[ie],ie,W),i))if(t)Re[ie]=k;else if(k)switch(i){case 3:return!0;case 5:return I;case 6:return ie;case 2:zN(Re,I)}else switch(i){case 4:return!1;case 7:zN(Re,I)}return u?-1:a||l?l:Re}},fK={forEach:Nl(0),map:Nl(1),filter:Nl(2),some:Nl(3),every:Nl(4),find:Nl(5),findIndex:Nl(6),filterReject:Nl(7)},Tg=Zn,gC=Gn,vC=dr,mK=Ut,dh=Pi,hh=qo,gK=Xt,ji=fo,vK=Jt,EC=Ds,Rg=Ji,_C=ug,EK=jc,yC=zr,wf=Eg,GN=wN,_K=_g,KN=DN,yK=yg,qN=Ni,YN=ts,SK=sC,XN=Wo,JN=Tf,CK=UN,SC=ih,QN=fg,ZN=GS,bK=Lr,TK=ch,RK=ti,wK=jN,IK=lh,eP=bg,wg=fK.forEach,Yo=gg("hidden"),Ig="Symbol",If="prototype",AK=eP.set,tP=eP.getterFor(Ig),ks=Object[If],Wu=gC.Symbol,Ag=Wu&&Wu[If],OK=gC.TypeError,CC=gC.QObject,nP=qN.f,zu=YN.f,rP=KN.f,xK=XN.f,iP=mK([].push),Vc=SC("symbols"),Af=SC("op-symbols"),NK=SC("wks"),bC=!CC||!CC[If]||!CC[If].findChild,TC=dh&&gK(function(){return wf(zu({},"a",{get:function(){return zu(this,"a",{value:7}).a}})).a!=7})?function(i,t,r){var a=nP(ks,t);a&&delete ks[t],zu(i,t,r),a&&i!==ks&&zu(ks,t,a)}:zu,RC=function(i,t){var r=Vc[i]=wf(Ag);return AK(r,{type:Ig,tag:i,description:t}),dh||(r.description=t),r},Og=function(i,t,r){i===ks&&Og(Af,t,r),EC(i);var a=_C(t);return EC(r),ji(Vc,a)?(r.enumerable?(ji(i,Yo)&&i[Yo][a]&&(i[Yo][a]=!1),r=wf(r,{enumerable:yC(0,!1)})):(ji(i,Yo)||zu(i,Yo,yC(1,{})),i[Yo][a]=!0),TC(i,a,r)):zu(i,a,r)},wC=function(i,t){EC(i);var r=Rg(t),a=GN(r).concat(cP(r));return wg(a,function(l){dh&&!vC(oP,r,l)||Og(i,l,r[l])}),i},oP=function(i){var t=_C(i),r=vC(xK,this,t);return!(this===ks&&ji(Vc,t)&&!ji(Af,t))&&(!(r||!ji(this,t)||!ji(Vc,t)||ji(this,Yo)&&this[Yo][t])||r)},aP=function(i,t){var r=Rg(i),a=_C(t);if(r!==ks||!ji(Vc,a)||ji(Af,a)){var l=nP(r,a);return!l||!ji(Vc,a)||ji(r,Yo)&&r[Yo][a]||(l.enumerable=!0),l}},sP=function(i){var t=rP(Rg(i)),r=[];return wg(t,function(a){ji(Vc,a)||ji(QN,a)||iP(r,a)}),r},cP=function(i){var t=i===ks,r=rP(t?Af:Rg(i)),a=[];return wg(r,function(l){!ji(Vc,l)||t&&!ji(ks,l)||iP(a,Vc[l])}),a};hh||(Wu=function(){if(vK(Ag,this))throw OK("Symbol is not a constructor");var i=arguments.length&&arguments[0]!==void 0?EK(arguments[0]):void 0,t=ZN(i),r=function(a){this===ks&&vC(r,Af,a),ji(this,Yo)&&ji(this[Yo],t)&&(this[Yo][t]=!1),TC(this,t,yC(1,a))};return dh&&bC&&TC(ks,t,{configurable:!0,set:r}),RC(t,i)},JN(Ag=Wu[If],"toString",function(){return tP(this).tag}),JN(Wu,"withoutSetter",function(i){return RC(ZN(i),i)}),XN.f=oP,YN.f=Og,SK.f=wC,qN.f=aP,_K.f=KN.f=sP,yK.f=cP,TK.f=function(i){return RC(bK(i),i)},dh&&CK(Ag,"description",{configurable:!0,get:function(){return tP(this).description}})),Tg({global:!0,constructor:!0,wrap:!0,forced:!hh,sham:!hh},{Symbol:Wu}),wg(GN(NK),function(i){RK(i)}),Tg({target:Ig,stat:!0,forced:!hh},{useSetter:function(){bC=!0},useSimple:function(){bC=!1}}),Tg({target:"Object",stat:!0,forced:!hh,sham:!dh},{create:function(i,t){return t===void 0?wf(i):wC(wf(i),t)},defineProperty:Og,defineProperties:wC,getOwnPropertyDescriptor:aP}),Tg({target:"Object",stat:!0,forced:!hh},{getOwnPropertyNames:sP}),wK(),IK(Wu,Ig),QN[Yo]=!0;var lP=qo&&!!Symbol.for&&!!Symbol.keyFor,PK=Zn,DK=Yt,kK=fo,LK=jc,uP=ih,MK=lP,IC=uP("string-to-symbol-registry"),FK=uP("symbol-to-string-registry");PK({target:"Symbol",stat:!0,forced:!MK},{for:function(i){var t=LK(i);if(kK(IC,t))return IC[t];var r=DK("Symbol")(t);return IC[t]=r,FK[r]=t,r}});var UK=Zn,BK=fo,jK=Ps,VK=uc,$K=lP,dP=ih("symbol-to-string-registry");UK({target:"Symbol",stat:!0,forced:!$K},{keyFor:function(i){if(!jK(i))throw TypeError(VK(i)+" is not a symbol");if(BK(dP,i))return dP[i]}});var hP=Ut([].slice),pP=iC,HK=gn,fP=_n,WK=jc,mP=Ut([].push),zK=Zn,gP=Yt,vP=En,GK=dr,Of=Ut,EP=Xt,_P=gn,yP=Ps,SP=hP,KK=function(i){if(HK(i))return i;if(pP(i)){for(var t=i.length,r=[],a=0;a<t;a++){var l=i[a];typeof l=="string"?mP(r,l):typeof l!="number"&&fP(l)!="Number"&&fP(l)!="String"||mP(r,WK(l))}var u=r.length,h=!0;return function(f,v){if(h)return h=!1,v;if(pP(this))return v;for(var E=0;E<u;E++)if(r[E]===f)return v}}},qK=qo,YK=String,Pl=gP("JSON","stringify"),xg=Of(/./.exec),CP=Of("".charAt),XK=Of("".charCodeAt),JK=Of("".replace),QK=Of(1 .toString),ZK=/[\uD800-\uDFFF]/g,bP=/^[\uD800-\uDBFF]$/,TP=/^[\uDC00-\uDFFF]$/,RP=!qK||EP(function(){var i=gP("Symbol")();return Pl([i])!="[null]"||Pl({a:i})!="{}"||Pl(Object(i))!="{}"}),wP=EP(function(){return Pl("\uDF06\uD834")!=='"\\udf06\\ud834"'||Pl("\uDEAD")!=='"\\udead"'}),eq=function(i,t){var r=SP(arguments),a=KK(t);if(_P(a)||i!==void 0&&!yP(i))return r[1]=function(l,u){if(_P(a)&&(u=GK(a,this,YK(l),u)),!yP(u))return u},vP(Pl,null,r)},tq=function(i,t,r){var a=CP(r,t-1),l=CP(r,t+1);return xg(bP,i)&&!xg(TP,l)||xg(TP,i)&&!xg(bP,a)?"\\u"+QK(XK(i,0),16):i};Pl&&zK({target:"JSON",stat:!0,arity:3,forced:RP||wP},{stringify:function(i,t,r){var a=SP(arguments),l=vP(RP?eq:Pl,null,a);return wP&&typeof l=="string"?JK(l,ZK,tq):l}});var IP=yg,nq=ju;Zn({target:"Object",stat:!0,forced:!qo||Xt(function(){IP.f(1)})},{getOwnPropertySymbols:function(i){var t=IP.f;return t?t(nq(i)):[]}}),ti("asyncIterator"),ti("hasInstance"),ti("isConcatSpreadable"),ti("iterator"),ti("match"),ti("matchAll"),ti("replace"),ti("search"),ti("species"),ti("split");var rq=jN;ti("toPrimitive"),rq();var iq=Yt,oq=lh;ti("toStringTag"),oq(iq("Symbol"),"Symbol"),ti("unscopables"),lh(Gn.JSON,"JSON",!0);var Gu,AP,OP,aq=ho.Symbol,ph={},AC=Pi,sq=fo,xP=Function.prototype,cq=AC&&Object.getOwnPropertyDescriptor,OC=sq(xP,"name"),NP={EXISTS:OC,PROPER:OC&&(function(){}).name==="something",CONFIGURABLE:OC&&(!AC||AC&&cq(xP,"name").configurable)},lq=!Xt(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype}),uq=fo,dq=gn,hq=ju,pq=lq,PP=gg("IE_PROTO"),xC=Object,fq=xC.prototype,NC=pq?xC.getPrototypeOf:function(i){var t=hq(i);if(uq(t,PP))return t[PP];var r=t.constructor;return dq(r)&&t instanceof r?r.prototype:t instanceof xC?fq:null},mq=Xt,gq=gn,vq=ei,Eq=Eg,DP=NC,_q=Tf,PC=Lr("iterator"),kP=!1;[].keys&&("next"in(OP=[].keys())?(AP=DP(DP(OP)))!==Object.prototype&&(Gu=AP):kP=!0);var yq=!vq(Gu)||mq(function(){var i={};return Gu[PC].call(i)!==i});gq((Gu=yq?{}:Eq(Gu))[PC])||_q(Gu,PC,function(){return this});var LP={IteratorPrototype:Gu,BUGGY_SAFARI_ITERATORS:kP},Sq=LP.IteratorPrototype,Cq=Eg,bq=zr,Tq=lh,Rq=ph,wq=function(){return this},Iq=Ut,Aq=Nt,Oq=gn,xq=String,Nq=TypeError,Pq=function(i,t,r){try{return Iq(Aq(Object.getOwnPropertyDescriptor(i,t)[r]))}catch{}},Dq=Ds,kq=function(i){if(typeof i=="object"||Oq(i))return i;throw Nq("Can't set "+xq(i)+" as a prototype")},Lq=Object.setPrototypeOf||("__proto__"in{}?function(){var i,t=!1,r={};try{(i=Pq(Object.prototype,"__proto__","set"))(r,[]),t=r instanceof Array}catch{}return function(a,l){return Dq(a),kq(l),t?i(a,l):a.__proto__=l,a}}():void 0),Mq=Zn,Fq=dr,Uq=NP,Bq=function(i,t,r,a){var l=t+" Iterator";return i.prototype=Cq(Sq,{next:bq(+!a,r)}),Tq(i,l,!1,!0),Rq[l]=wq,i},jq=NC,Vq=lh,MP=Tf,FP=ph,$q=LP,Hq=Uq.PROPER,Ng=$q.BUGGY_SAFARI_ITERATORS,DC=Lr("iterator"),UP="keys",Pg="values",BP="entries",Wq=function(){return this},jP=function(i,t,r,a,l,u,h){Bq(r,t,a);var f,v,E,y=function(X){if(X===l&&$)return $;if(!Ng&&X in k)return k[X];switch(X){case UP:case Pg:case BP:return function(){return new r(this,X)}}return function(){return new r(this)}},C=t+" Iterator",I=!1,k=i.prototype,W=k[DC]||k["@@iterator"]||l&&k[l],$=!Ng&&W||y(l),z=t=="Array"&&k.entries||W;if(z&&(f=jq(z.call(new i)))!==Object.prototype&&f.next&&(Vq(f,C,!0,!0),FP[C]=Wq),Hq&&l==Pg&&W&&W.name!==Pg&&(I=!0,$=function(){return Fq(W,this)}),l)if(v={values:y(Pg),keys:u?$:y(UP),entries:y(BP)},h)for(E in v)(Ng||I||!(E in k))&&MP(k,E,v[E]);else Mq({target:t,proto:!0,forced:Ng||I},v);return h&&k[DC]!==$&&MP(k,DC,$,{name:l}),FP[t]=$,v},VP=function(i,t){return{value:i,done:t}},zq=Ji,$P=ph,HP=bg;ts.f;var Gq=jP,WP=VP,zP="Array Iterator",Kq=HP.set,qq=HP.getterFor(zP);Gq(Array,"Array",function(i,t){Kq(this,{type:zP,target:zq(i),index:0,kind:t})},function(){var i=qq(this),t=i.target,r=i.kind,a=i.index++;return!t||a>=t.length?(i.target=void 0,WP(void 0,!0)):WP(r=="keys"?a:r=="values"?t[a]:[a,t[a]],!1)},"values"),$P.Arguments=$P.Array;var Yq={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Xq=Gn,Jq=Hu,Qq=xl,GP=ph,KP=Lr("toStringTag");for(var kC in Yq){var qP=Xq[kC],LC=qP&&qP.prototype;LC&&Jq(LC)!==KP&&Qq(LC,KP,kC),GP[kC]=GP.Array}var Zq=aq,eY=Lr,tY=ts.f,YP=eY("metadata"),XP=Function.prototype;XP[YP]===void 0&&tY(XP,YP,{value:null}),ti("dispose"),ti("metadata");var nY=Zq;ti("asyncDispose");var rY=Ut,MC=Yt("Symbol"),iY=MC.keyFor,oY=rY(MC.prototype.valueOf),JP=MC.isRegisteredSymbol||function(i){try{return iY(oY(i))!==void 0}catch{return!1}};Zn({target:"Symbol",stat:!0},{isRegisteredSymbol:JP});for(var aY=ih,QP=Yt,sY=Ut,cY=Ps,lY=Lr,Dg=QP("Symbol"),ZP=Dg.isWellKnownSymbol,eD=QP("Object","getOwnPropertyNames"),uY=sY(Dg.prototype.valueOf),tD=aY("wks"),FC=0,nD=eD(Dg),dY=nD.length;FC<dY;FC++)try{var rD=nD[FC];cY(Dg[rD])&&lY(rD)}catch{}var iD=function(i){if(ZP&&ZP(i))return!0;try{for(var t=uY(i),r=0,a=eD(tD),l=a.length;r<l;r++)if(tD[a[r]]==t)return!0}catch{}return!1};Zn({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:iD}),ti("matcher"),ti("observable"),Zn({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:JP}),Zn({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:iD}),ti("metadataKey"),ti("patternMatch"),ti("replaceAll");var fh=it(nY),UC=Ut,hY=eC,pY=jc,fY=uo,mY=UC("".charAt),oD=UC("".charCodeAt),gY=UC("".slice),aD=function(i){return function(t,r){var a,l,u=pY(fY(t)),h=hY(r),f=u.length;return h<0||h>=f?i?"":void 0:(a=oD(u,h))<55296||a>56319||h+1===f||(l=oD(u,h+1))<56320||l>57343?i?mY(u,h):a:i?gY(u,h,h+2):l-56320+(a-55296<<10)+65536}},vY={codeAt:aD(!1),charAt:aD(!0)}.charAt,EY=jc,sD=bg,_Y=jP,cD=VP,lD="String Iterator",yY=sD.set,SY=sD.getterFor(lD);_Y(String,"String",function(i){yY(this,{type:lD,string:EY(i),index:0})},function(){var i,t=SY(this),r=t.string,a=t.index;return a>=r.length?cD(void 0,!0):(i=vY(r,a),t.index+=i.length,cD(i,!1))});var uD=it(ch.f("iterator"));function xf(i){return xf=typeof fh=="function"&&typeof uD=="symbol"?function(t){return typeof t}:function(t){return t&&typeof fh=="function"&&t.constructor===fh&&t!==fh.prototype?"symbol":typeof t},xf(i)}var CY=it(ch.f("toPrimitive"));function bY(i){var t=function(r,a){if(xf(r)!=="object"||r===null)return r;var l=r[CY];if(l!==void 0){var u=l.call(r,a||"default");if(xf(u)!=="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(r)}(i,"string");return xf(t)==="symbol"?t:String(t)}function w(i,t,r){return(t=bY(t))in i?kz(i,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[t]=r,i}var TY=$u("Array").keys,RY=Hu,wY=fo,IY=Jt,AY=TY,BC=Array.prototype,OY={DOMTokenList:!0,NodeList:!0},Xo=it(function(i){var t=i.keys;return i===BC||IY(BC,i)&&t===BC.keys||wY(OY,RY(i))?AY:t}),dD=uc,xY=TypeError,hD=LN,NY=Math.floor,jC=function(i,t){var r=i.length,a=NY(r/2);return r<8?PY(i,t):DY(i,jC(hD(i,0,a),t),jC(hD(i,a),t),t)},PY=function(i,t){for(var r,a,l=i.length,u=1;u<l;){for(a=u,r=i[u];a&&t(i[a-1],r)>0;)i[a]=i[--a];a!==u++&&(i[a]=r)}return i},DY=function(i,t,r,a){for(var l=t.length,u=r.length,h=0,f=0;h<l||f<u;)i[h+f]=h<l&&f<u?a(t[h],r[f])<=0?t[h++]:r[f++]:h<l?t[h++]:r[f++];return i},kY=jC,LY=Xt,pD=function(i,t){var r=[][i];return!!r&&LY(function(){r.call(null,t||function(){return 1},1)})},fD=yn.match(/firefox\/(\d+)/i),MY=!!fD&&+fD[1],FY=/MSIE|Trident/.test(yn),mD=yn.match(/AppleWebKit\/(\d+)\./),UY=!!mD&&+mD[1],BY=Zn,gD=Ut,jY=Nt,VY=ju,vD=Vu,$Y=function(i,t){if(!delete i[t])throw xY("Cannot delete property "+dD(t)+" of "+dD(i))},ED=jc,VC=Xt,HY=kY,WY=pD,_D=MY,zY=FY,yD=es,SD=UY,Dl=[],CD=gD(Dl.sort),GY=gD(Dl.push),KY=VC(function(){Dl.sort(void 0)}),qY=VC(function(){Dl.sort(null)}),YY=WY("sort"),bD=!VC(function(){if(yD)return yD<70;if(!(_D&&_D>3)){if(zY)return!0;if(SD)return SD<603;var i,t,r,a,l="";for(i=65;i<76;i++){switch(t=String.fromCharCode(i),i){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(a=0;a<47;a++)Dl.push({k:t+a,v:r})}for(Dl.sort(function(u,h){return h.v-u.v}),a=0;a<Dl.length;a++)t=Dl[a].k.charAt(0),l.charAt(l.length-1)!==t&&(l+=t);return l!=="DGBEFHACIJK"}});BY({target:"Array",proto:!0,forced:KY||!qY||!YY||!bD},{sort:function(i){i!==void 0&&jY(i);var t=VY(this);if(bD)return i===void 0?CD(t):CD(t,i);var r,a,l=[],u=vD(t);for(a=0;a<u;a++)a in t&&GY(l,t[a]);for(HY(l,function(h){return function(f,v){return v===void 0?-1:f===void 0?1:h!==void 0?+h(f,v)||0:ED(f)>ED(v)?1:-1}}(i)),r=vD(l),a=0;a<r;)t[a]=l[a++];for(;a<u;)$Y(t,a++);return t}});var XY=$u("Array").sort,JY=Jt,QY=XY,$C=Array.prototype,Nf=it(function(i){var t=i.sort;return i===$C||JY($C,i)&&t===$C.sort?QY:t}),ZY=Yt,eX=_g,tX=yg,nX=Ds,rX=Ut([].concat),iX=ZY("Reflect","ownKeys")||function(i){var t=eX.f(nX(i)),r=tX.f;return r?rX(t,r(i)):t},TD=fo,oX=iX,aX=Ni,sX=ts,cX=ei,lX=xl,RD=Error,uX=Ut("".replace),dX=String(RD("zxcasd").stack),wD=/\n\s*at [^:]*:[^\n]*/,hX=wD.test(dX),pX=zr,fX=!Xt(function(){var i=Error("a");return!("stack"in i)||(Object.defineProperty(i,"stack",pX(1,7)),i.stack!==7)}),mX=xl,gX=function(i,t){if(hX&&typeof i=="string"&&!RD.prepareStackTrace)for(;t--;)i=uX(i,wD,"");return i},vX=fX,ID=Error.captureStackTrace,EX=ph,_X=Lr("iterator"),yX=Array.prototype,SX=Hu,AD=vr,CX=zo,bX=ph,TX=Lr("iterator"),OD=function(i){if(!CX(i))return AD(i,TX)||AD(i,"@@iterator")||bX[SX(i)]},RX=dr,wX=Nt,IX=Ds,AX=uc,OX=OD,xX=TypeError,NX=dr,xD=Ds,PX=vr,DX=Cf,kX=dr,LX=Ds,MX=uc,FX=function(i){return i!==void 0&&(EX.Array===i||yX[_X]===i)},UX=Vu,ND=Jt,BX=function(i,t){var r=arguments.length<2?OX(i):t;if(wX(r))return IX(RX(r,i));throw xX(AX(i)+" is not iterable")},jX=OD,PD=function(i,t,r){var a,l;xD(i);try{if(!(a=PX(i,"return"))){if(t==="throw")throw r;return r}a=NX(a,i)}catch(u){l=!0,a=u}if(t==="throw")throw r;if(l)throw a;return xD(a),r},VX=TypeError,kg=function(i,t){this.stopped=i,this.result=t},DD=kg.prototype,Pf=function(i,t,r){var a,l,u,h,f,v,E,y=r&&r.that,C=!(!r||!r.AS_ENTRIES),I=!(!r||!r.IS_RECORD),k=!(!r||!r.IS_ITERATOR),W=!(!r||!r.INTERRUPTED),$=DX(t,y),z=function(ie){return a&&PD(a,"normal",ie),new kg(!0,ie)},X=function(ie){return C?(LX(ie),W?$(ie[0],ie[1],z):$(ie[0],ie[1])):W?$(ie,z):$(ie)};if(I)a=i.iterator;else if(k)a=i;else{if(!(l=jX(i)))throw VX(MX(i)+" is not iterable");if(FX(l)){for(u=0,h=UX(i);h>u;u++)if((f=X(i[u]))&&ND(DD,f))return f;return new kg(!1)}a=BX(i,l)}for(v=I?i.next:a.next;!(E=kX(v,a)).done;){try{f=X(E.value)}catch(ie){PD(a,"throw",ie)}if(typeof f=="object"&&f&&ND(DD,f))return f}return new kg(!1)},$X=jc,HX=Zn,WX=Jt,zX=NC,Lg=Lq,GX=function(i,t,r){for(var a=oX(t),l=sX.f,u=aX.f,h=0;h<a.length;h++){var f=a[h];TD(i,f)||r&&TD(r,f)||l(i,f,u(t,f))}},kD=Eg,HC=xl,WC=zr,KX=function(i,t){cX(t)&&"cause"in t&&lX(i,"cause",t.cause)},qX=function(i,t,r,a){vX&&(ID?ID(i,t):mX(i,"stack",gX(r,a)))},YX=Pf,XX=function(i,t){return i===void 0?arguments.length<2?"":t:$X(i)},JX=Lr("toStringTag"),Mg=Error,QX=[].push,mh=function(i,t){var r,a=WX(zC,this);Lg?r=Lg(Mg(),a?zX(this):zC):(r=a?this:kD(zC),HC(r,JX,"Error")),t!==void 0&&HC(r,"message",XX(t)),qX(r,mh,r.stack,1),arguments.length>2&&KX(r,arguments[2]);var l=[];return YX(i,QX,{that:l}),HC(r,"errors",l),r};Lg?Lg(mh,Mg):GX(mh,Mg,{name:!0});var zC=mh.prototype=kD(Mg.prototype,{constructor:WC(1,mh),message:WC(1,""),name:WC(1,"AggregateError")});HX({global:!0,constructor:!0,arity:2},{AggregateError:mh});var Df,gh,LD,GC,kf=typeof process<"u"&&_n(process)=="process",ZX=Yt,eJ=UN,tJ=Pi,MD=Lr("species"),nJ=Jt,rJ=TypeError,iJ=vN,oJ=uc,aJ=TypeError,FD=Ds,sJ=function(i){if(iJ(i))return i;throw aJ(oJ(i)+" is not a constructor")},cJ=zo,lJ=Lr("species"),UD=function(i,t){var r,a=FD(i).constructor;return a===void 0||cJ(r=FD(a)[lJ])?t:sJ(r)},uJ=TypeError,BD=/(?:ipad|iphone|ipod).*applewebkit/i.test(yn),ba=Gn,dJ=En,hJ=Cf,jD=gn,pJ=fo,VD=Xt,$D=IN,fJ=hP,HD=YS,mJ=function(i,t){if(i<t)throw uJ("Not enough arguments");return i},gJ=BD,vJ=kf,KC=ba.setImmediate,qC=ba.clearImmediate,EJ=ba.process,YC=ba.Dispatch,_J=ba.Function,WD=ba.MessageChannel,yJ=ba.String,XC=0,Lf={},zD="onreadystatechange";VD(function(){Df=ba.location});var JC=function(i){if(pJ(Lf,i)){var t=Lf[i];delete Lf[i],t()}},QC=function(i){return function(){JC(i)}},GD=function(i){JC(i.data)},KD=function(i){ba.postMessage(yJ(i),Df.protocol+"//"+Df.host)};KC&&qC||(KC=function(i){mJ(arguments.length,1);var t=jD(i)?i:_J(i),r=fJ(arguments,1);return Lf[++XC]=function(){dJ(t,void 0,r)},gh(XC),XC},qC=function(i){delete Lf[i]},vJ?gh=function(i){EJ.nextTick(QC(i))}:YC&&YC.now?gh=function(i){YC.now(QC(i))}:WD&&!gJ?(GC=(LD=new WD).port2,LD.port1.onmessage=GD,gh=hJ(GC.postMessage,GC)):ba.addEventListener&&jD(ba.postMessage)&&!ba.importScripts&&Df&&Df.protocol!=="file:"&&!VD(KD)?(gh=KD,ba.addEventListener("message",GD,!1)):gh=zD in HD("script")?function(i){$D.appendChild(HD("script"))[zD]=function(){$D.removeChild(this),JC(i)}}:function(i){setTimeout(QC(i),0)});var qD={set:KC,clear:qC},YD=function(){this.head=null,this.tail=null};YD.prototype={add:function(i){var t={item:i,next:null},r=this.tail;r?r.next=t:this.head=t,this.tail=t},get:function(){var i=this.head;if(i)return(this.head=i.next)===null&&(this.tail=null),i.item}};var vh,ZC,eb,tb,XD,JD=YD,SJ=/ipad|iphone|ipod/i.test(yn)&&typeof Pebble<"u",CJ=/web0s(?!.*chrome)/i.test(yn),Ku=Gn,QD=Cf,bJ=Ni.f,nb=qD.set,TJ=JD,RJ=BD,wJ=SJ,IJ=CJ,rb=kf,ZD=Ku.MutationObserver||Ku.WebKitMutationObserver,ek=Ku.document,tk=Ku.process,Fg=Ku.Promise,nk=bJ(Ku,"queueMicrotask"),ib=nk&&nk.value;if(!ib){var Ug=new TJ,Bg=function(){var i,t;for(rb&&(i=tk.domain)&&i.exit();t=Ug.get();)try{t()}catch(r){throw Ug.head&&vh(),r}i&&i.enter()};RJ||rb||IJ||!ZD||!ek?!wJ&&Fg&&Fg.resolve?((tb=Fg.resolve(void 0)).constructor=Fg,XD=QD(tb.then,tb),vh=function(){XD(Bg)}):rb?vh=function(){tk.nextTick(Bg)}:(nb=QD(nb,Ku),vh=function(){nb(Bg)}):(ZC=!0,eb=ek.createTextNode(""),new ZD(Bg).observe(eb,{characterData:!0}),vh=function(){eb.data=ZC=!ZC}),ib=function(i){Ug.head||vh(),Ug.add(i)}}var AJ=ib,Eh=function(i){try{return{error:!1,value:i()}}catch(t){return{error:!0,value:t}}},qu=Gn.Promise,rk=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",OJ=!rk&&!kf&&typeof window=="object"&&typeof document=="object",xJ=Gn,Mf=qu,NJ=gn,PJ=Qx,DJ=hN,kJ=Lr,LJ=OJ,MJ=rk,ob=es,ik=Mf&&Mf.prototype,FJ=kJ("species"),ok=!1,ak=NJ(xJ.PromiseRejectionEvent),UJ=PJ("Promise",function(){var i=DJ(Mf),t=i!==String(Mf);if(!t&&ob===66||!ik.catch||!ik.finally)return!0;if(!ob||ob<51||!/native code/.test(i)){var r=new Mf(function(l){l(1)}),a=function(l){l(function(){},function(){})};if((r.constructor={})[FJ]=a,!(ok=r.then(function(){})instanceof a))return!0}return!t&&(LJ||MJ)&&!ak}),Ff={CONSTRUCTOR:UJ,REJECTION_EVENT:ak,SUBCLASSING:ok},hc={},sk=Nt,BJ=TypeError,jJ=function(i){var t,r;this.promise=new i(function(a,l){if(t!==void 0||r!==void 0)throw BJ("Bad Promise constructor");t=a,r=l}),this.resolve=sk(t),this.reject=sk(r)};hc.f=function(i){return new jJ(i)};var ab,ck,VJ=Zn,jg=kf,kl=Gn,Uf=dr,$J=Tf,HJ=lh,WJ=function(i){var t=ZX(i);tJ&&t&&!t[MD]&&eJ(t,MD,{configurable:!0,get:function(){return this}})},zJ=Nt,sb=gn,GJ=ei,KJ=function(i,t){if(nJ(t,i))return i;throw rJ("Incorrect invocation")},qJ=UD,lk=qD.set,cb=AJ,YJ=function(i,t){try{arguments.length==1?console.error(i):console.error(i,t)}catch{}},XJ=Eh,JJ=JD,uk=bg,lb=qu,dk=Ff,hk=hc,Vg="Promise",pk=dk.CONSTRUCTOR,QJ=dk.REJECTION_EVENT,ub=uk.getterFor(Vg),ZJ=uk.set,eQ=lb&&lb.prototype,Bf=lb,db=eQ,fk=kl.TypeError,hb=kl.document,pb=kl.process,fb=hk.f,tQ=fb,nQ=!!(hb&&hb.createEvent&&kl.dispatchEvent),mk="unhandledrejection",gk=function(i){var t;return!(!GJ(i)||!sb(t=i.then))&&t},vk=function(i,t){var r,a,l,u=t.value,h=t.state==1,f=h?i.ok:i.fail,v=i.resolve,E=i.reject,y=i.domain;try{f?(h||(t.rejection===2&&iQ(t),t.rejection=1),f===!0?r=u:(y&&y.enter(),r=f(u),y&&(y.exit(),l=!0)),r===i.promise?E(fk("Promise-chain cycle")):(a=gk(r))?Uf(a,r,v,E):v(r)):E(u)}catch(C){y&&!l&&y.exit(),E(C)}},Ek=function(i,t){i.notified||(i.notified=!0,cb(function(){for(var r,a=i.reactions;r=a.get();)vk(r,i);i.notified=!1,t&&!i.rejection&&rQ(i)}))},_k=function(i,t,r){var a,l;nQ?((a=hb.createEvent("Event")).promise=t,a.reason=r,a.initEvent(i,!1,!0),kl.dispatchEvent(a)):a={promise:t,reason:r},!QJ&&(l=kl["on"+i])?l(a):i===mk&&YJ("Unhandled promise rejection",r)},rQ=function(i){Uf(lk,kl,function(){var t,r=i.facade,a=i.value;if(yk(i)&&(t=XJ(function(){jg?pb.emit("unhandledRejection",a,r):_k(mk,r,a)}),i.rejection=jg||yk(i)?2:1,t.error))throw t.value})},yk=function(i){return i.rejection!==1&&!i.parent},iQ=function(i){Uf(lk,kl,function(){var t=i.facade;jg?pb.emit("rejectionHandled",t):_k("rejectionhandled",t,i.value)})},_h=function(i,t,r){return function(a){i(t,a,r)}},yh=function(i,t,r){i.done||(i.done=!0,r&&(i=r),i.value=t,i.state=2,Ek(i,!0))},mb=function(i,t,r){if(!i.done){i.done=!0,r&&(i=r);try{if(i.facade===t)throw fk("Promise can't be resolved itself");var a=gk(t);a?cb(function(){var l={done:!1};try{Uf(a,t,_h(mb,l,i),_h(yh,l,i))}catch(u){yh(l,u,i)}}):(i.value=t,i.state=1,Ek(i,!1))}catch(l){yh({done:!1},l,i)}}};pk&&(db=(Bf=function(i){KJ(this,db),zJ(i),Uf(ab,this);var t=ub(this);try{i(_h(mb,t),_h(yh,t))}catch(r){yh(t,r)}}).prototype,(ab=function(i){ZJ(this,{type:Vg,done:!1,notified:!1,parent:!1,reactions:new JJ,rejection:!1,state:0,value:void 0})}).prototype=$J(db,"then",function(i,t){var r=ub(this),a=fb(qJ(this,Bf));return r.parent=!0,a.ok=!sb(i)||i,a.fail=sb(t)&&t,a.domain=jg?pb.domain:void 0,r.state==0?r.reactions.add(a):cb(function(){vk(a,r)}),a.promise}),ck=function(){var i=new ab,t=ub(i);this.promise=i,this.resolve=_h(mb,t),this.reject=_h(yh,t)},hk.f=fb=function(i){return i===Bf||i===void 0?new ck(i):tQ(i)}),VJ({global:!0,constructor:!0,wrap:!0,forced:pk},{Promise:Bf}),HJ(Bf,Vg,!1,!0),WJ(Vg);var Sk=Lr("iterator"),Ck=!1;try{var oQ=0,bk={next:function(){return{done:!!oQ++}},return:function(){Ck=!0}};bk[Sk]=function(){return this},Array.from(bk,function(){throw 2})}catch{}var aQ=qu,sQ=function(i,t){if(!t&&!Ck)return!1;var r=!1;try{var a={};a[Sk]=function(){return{next:function(){return{done:r=!0}}}},i(a)}catch{}return r},$g=Ff.CONSTRUCTOR||!sQ(function(i){aQ.all(i).then(void 0,function(){})}),cQ=dr,lQ=Nt,uQ=hc,dQ=Eh,hQ=Pf;Zn({target:"Promise",stat:!0,forced:$g},{all:function(i){var t=this,r=uQ.f(t),a=r.resolve,l=r.reject,u=dQ(function(){var h=lQ(t.resolve),f=[],v=0,E=1;hQ(i,function(y){var C=v++,I=!1;E++,cQ(h,t,y).then(function(k){I||(I=!0,f[C]=k,--E||a(f))},l)}),--E||a(f)});return u.error&&l(u.value),r.promise}});var pQ=Zn,fQ=Ff.CONSTRUCTOR;qu&&qu.prototype,pQ({target:"Promise",proto:!0,forced:fQ,real:!0},{catch:function(i){return this.then(void 0,i)}});var mQ=dr,gQ=Nt,vQ=hc,EQ=Eh,_Q=Pf;Zn({target:"Promise",stat:!0,forced:$g},{race:function(i){var t=this,r=vQ.f(t),a=r.reject,l=EQ(function(){var u=gQ(t.resolve);_Q(i,function(h){mQ(u,t,h).then(r.resolve,a)})});return l.error&&a(l.value),r.promise}});var yQ=dr,SQ=hc;Zn({target:"Promise",stat:!0,forced:Ff.CONSTRUCTOR},{reject:function(i){var t=SQ.f(this);return yQ(t.reject,void 0,i),t.promise}});var CQ=Ds,bQ=ei,TQ=hc,Tk=function(i,t){if(CQ(i),bQ(t)&&t.constructor===i)return t;var r=TQ.f(i);return(0,r.resolve)(t),r.promise},RQ=Zn,wQ=qu,IQ=Ff.CONSTRUCTOR,AQ=Tk,OQ=Yt("Promise"),xQ=!IQ;RQ({target:"Promise",stat:!0,forced:!0},{resolve:function(i){return AQ(xQ&&this===OQ?wQ:this,i)}});var NQ=dr,PQ=Nt,DQ=hc,kQ=Eh,LQ=Pf;Zn({target:"Promise",stat:!0,forced:$g},{allSettled:function(i){var t=this,r=DQ.f(t),a=r.resolve,l=r.reject,u=kQ(function(){var h=PQ(t.resolve),f=[],v=0,E=1;LQ(i,function(y){var C=v++,I=!1;E++,NQ(h,t,y).then(function(k){I||(I=!0,f[C]={status:"fulfilled",value:k},--E||a(f))},function(k){I||(I=!0,f[C]={status:"rejected",reason:k},--E||a(f))})}),--E||a(f)});return u.error&&l(u.value),r.promise}});var MQ=dr,FQ=Nt,UQ=Yt,BQ=hc,jQ=Eh,VQ=Pf,Rk="No one promise resolved";Zn({target:"Promise",stat:!0,forced:$g},{any:function(i){var t=this,r=UQ("AggregateError"),a=BQ.f(t),l=a.resolve,u=a.reject,h=jQ(function(){var f=FQ(t.resolve),v=[],E=0,y=1,C=!1;VQ(i,function(I){var k=E++,W=!1;y++,MQ(f,t,I).then(function($){W||C||(C=!0,l($))},function($){W||C||(W=!0,v[k]=$,--y||u(new r(v,Rk)))})}),--y||u(new r(v,Rk))});return h.error&&u(h.value),a.promise}});var $Q=Zn,gb=qu,HQ=Xt,WQ=Yt,zQ=gn,GQ=UD,wk=Tk,KQ=gb&&gb.prototype;$Q({target:"Promise",proto:!0,real:!0,forced:!!gb&&HQ(function(){KQ.finally.call({then:function(){}},function(){})})},{finally:function(i){var t=GQ(this,WQ("Promise")),r=zQ(i);return this.then(r?function(a){return wk(t,i()).then(function(){return a})}:i,r?function(a){return wk(t,i()).then(function(){throw a})}:i)}});var Ik=ho.Promise,me=it(Ik);const qQ=()=>{};function jf(){const i={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:qQ};return i.promise=new me((t,r)=>{i.resolve=a=>{i.isFinished||(i.isResolved=!0,i.isFinished=!0,t(a),i.value=a)},i.reject=a=>{i.isFinished||(i.isRejected=!0,i.isFinished=!0,r(a))}}),i}const Hg=new Map,Wg=new Map,pc=new Map;var Rr,Zt;(function(i){i.WIN_10="Windows 10",i.WIN_81="Windows 8.1",i.WIN_8="Windows 8",i.WIN_7="Windows 7",i.WIN_VISTA="Windows Vista",i.WIN_SERVER_2003="Windows Server 2003",i.WIN_XP="Windows XP",i.WIN_2000="Windows 2000",i.ANDROID="Android",i.HARMONY_OS="HarmonyOS",i.OPEN_BSD="Open BSD",i.SUN_OS="Sun OS",i.LINUX="Linux",i.IOS="iOS",i.MAC_OS="Mac OS",i.QNX="QNX",i.UNIX="UNIX",i.BEOS="BeOS",i.OS_2="OS/2",i.SEARCH_BOT="Search Bot"})(Rr||(Rr={})),function(i){i.CHROME="Chrome",i.SAFARI="Safari",i.EDGE="Edge",i.FIREFOX="Firefox",i.OPERA="OPR",i.QQ="QQBrowser",i.WECHAT="MicroMessenger"}(Zt||(Zt={}));var vb={exports:{}};(function(i,t){(function(r,a){var l="function",u="undefined",h="object",f="string",v="major",E="model",y="name",C="type",I="vendor",k="version",W="architecture",$="console",z="mobile",X="tablet",ie="smarttv",oe="wearable",Re="embedded",Ce="Amazon",ge="Apple",_e="ASUS",Se="BlackBerry",De="Browser",Ne="Chrome",vt="Firefox",Ft="Google",Bn="Huawei",fr="LG",bn="Microsoft",Mo="Motorola",Ie="Opera",xe="Samsung",Be="Sharp",at="Sony",Gt="Xiaomi",Pe="Zebra",U="Facebook",Y="Chromium OS",re="Mac OS",Oe=function(Xn){for(var mr={},Tn=0;Tn<Xn.length;Tn++)mr[Xn[Tn].toUpperCase()]=Xn[Tn];return mr},pt=function(Xn,mr){return typeof Xn===f&&Sn(mr).indexOf(Sn(Xn))!==-1},Sn=function(Xn){return Xn.toLowerCase()},vi=function(Xn,mr){if(typeof Xn===f)return Xn=Xn.replace(/^\s\s*/,""),typeof mr===u?Xn:Xn.substring(0,350)},Fo=function(Xn,mr){for(var Tn,Uo,Ac,Jn,Kt,bo,ou=0;ou<mr.length&&!Kt;){var Bs=mr[ou],xU=mr[ou+1];for(Tn=Uo=0;Tn<Bs.length&&!Kt&&Bs[Tn];)if(Kt=Bs[Tn++].exec(Xn))for(Ac=0;Ac<xU.length;Ac++)bo=Kt[++Uo],typeof(Jn=xU[Ac])===h&&Jn.length>0?Jn.length===2?typeof Jn[1]==l?this[Jn[0]]=Jn[1].call(this,bo):this[Jn[0]]=Jn[1]:Jn.length===3?typeof Jn[1]!==l||Jn[1].exec&&Jn[1].test?this[Jn[0]]=bo?bo.replace(Jn[1],Jn[2]):a:this[Jn[0]]=bo?Jn[1].call(this,bo,Jn[2]):a:Jn.length===4&&(this[Jn[0]]=bo?Jn[3].call(this,bo.replace(Jn[1],Jn[2])):a):this[Jn]=bo||a;ou+=2}},Zc=function(Xn,mr){for(var Tn in mr)if(typeof mr[Tn]===h&&mr[Tn].length>0){for(var Uo=0;Uo<mr[Tn].length;Uo++)if(pt(mr[Tn][Uo],Xn))return Tn==="?"?a:Tn}else if(pt(mr[Tn],Xn))return Tn==="?"?a:Tn;return Xn},uE={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},dE={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[k,[y,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[k,[y,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[y,k],[/opios[\/ ]+([\w\.]+)/i],[k,[y,Ie+" Mini"]],[/\bopr\/([\w\.]+)/i],[k,[y,Ie]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[y,k],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[k,[y,"UC"+De]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[k,[y,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[k,[y,"WeChat"]],[/konqueror\/([\w\.]+)/i],[k,[y,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[k,[y,"IE"]],[/yabrowser\/([\w\.]+)/i],[k,[y,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[y,/(.+)/,"$1 Secure "+De],k],[/\bfocus\/([\w\.]+)/i],[k,[y,vt+" Focus"]],[/\bopt\/([\w\.]+)/i],[k,[y,Ie+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[k,[y,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[k,[y,"Dolphin"]],[/coast\/([\w\.]+)/i],[k,[y,Ie+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[k,[y,"MIUI "+De]],[/fxios\/([-\w\.]+)/i],[k,[y,vt]],[/\bqihu|(qi?ho?o?|360)browser/i],[[y,"360 "+De]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[y,/(.+)/,"$1 "+De],k],[/(comodo_dragon)\/([\w\.]+)/i],[[y,/_/g," "],k],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[y,k],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[y],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[y,U],k],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[y,k],[/\bgsa\/([\w\.]+) .*safari\//i],[k,[y,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[k,[y,Ne+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[y,Ne+" WebView"],k],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[k,[y,"Android "+De]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[y,k],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[k,[y,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[k,y],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[y,[k,Zc,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[y,k],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[y,"Netscape"],k],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[k,[y,vt+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[y,k],[/(cobalt)\/([\w\.]+)/i],[y,[k,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[W,"amd64"]],[/(ia32(?=;))/i],[[W,Sn]],[/((?:i[346]|x)86)[;\)]/i],[[W,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[W,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[W,"armhf"]],[/windows (ce|mobile); ppc;/i],[[W,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[W,/ower/,"",Sn]],[/(sun4\w)[;\)]/i],[[W,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[W,Sn]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[E,[I,xe],[C,X]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[E,[I,xe],[C,z]],[/\((ip(?:hone|od)[\w ]*);/i],[E,[I,ge],[C,z]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[E,[I,ge],[C,X]],[/(macintosh);/i],[E,[I,ge]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[E,[I,Be],[C,z]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[E,[I,Bn],[C,X]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[E,[I,Bn],[C,z]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[E,/_/g," "],[I,Gt],[C,z]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[E,/_/g," "],[I,Gt],[C,X]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[E,[I,"OPPO"],[C,z]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[E,[I,"Vivo"],[C,z]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[E,[I,"Realme"],[C,z]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[E,[I,Mo],[C,z]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[E,[I,Mo],[C,X]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[E,[I,fr],[C,X]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[E,[I,fr],[C,z]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[E,[I,"Lenovo"],[C,X]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[E,/_/g," "],[I,"Nokia"],[C,z]],[/(pixel c)\b/i],[E,[I,Ft],[C,X]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[E,[I,Ft],[C,z]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[E,[I,at],[C,z]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[E,"Xperia Tablet"],[I,at],[C,X]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[E,[I,"OnePlus"],[C,z]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[E,[I,Ce],[C,X]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[E,/(.+)/g,"Fire Phone $1"],[I,Ce],[C,z]],[/(playbook);[-\w\),; ]+(rim)/i],[E,I,[C,X]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[E,[I,Se],[C,z]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[E,[I,_e],[C,X]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[E,[I,_e],[C,z]],[/(nexus 9)/i],[E,[I,"HTC"],[C,X]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[I,[E,/_/g," "],[C,z]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[E,[I,"Acer"],[C,X]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[E,[I,"Meizu"],[C,z]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[I,E,[C,z]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[I,E,[C,X]],[/(surface duo)/i],[E,[I,bn],[C,X]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[E,[I,"Fairphone"],[C,z]],[/(u304aa)/i],[E,[I,"AT&T"],[C,z]],[/\bsie-(\w*)/i],[E,[I,"Siemens"],[C,z]],[/\b(rct\w+) b/i],[E,[I,"RCA"],[C,X]],[/\b(venue[\d ]{2,7}) b/i],[E,[I,"Dell"],[C,X]],[/\b(q(?:mv|ta)\w+) b/i],[E,[I,"Verizon"],[C,X]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[E,[I,"Barnes & Noble"],[C,X]],[/\b(tm\d{3}\w+) b/i],[E,[I,"NuVision"],[C,X]],[/\b(k88) b/i],[E,[I,"ZTE"],[C,X]],[/\b(nx\d{3}j) b/i],[E,[I,"ZTE"],[C,z]],[/\b(gen\d{3}) b.+49h/i],[E,[I,"Swiss"],[C,z]],[/\b(zur\d{3}) b/i],[E,[I,"Swiss"],[C,X]],[/\b((zeki)?tb.*\b) b/i],[E,[I,"Zeki"],[C,X]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[I,"Dragon Touch"],E,[C,X]],[/\b(ns-?\w{0,9}) b/i],[E,[I,"Insignia"],[C,X]],[/\b((nxa|next)-?\w{0,9}) b/i],[E,[I,"NextBook"],[C,X]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[I,"Voice"],E,[C,z]],[/\b(lvtel\-)?(v1[12]) b/i],[[I,"LvTel"],E,[C,z]],[/\b(ph-1) /i],[E,[I,"Essential"],[C,z]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[E,[I,"Envizen"],[C,X]],[/\b(trio[-\w\. ]+) b/i],[E,[I,"MachSpeed"],[C,X]],[/\btu_(1491) b/i],[E,[I,"Rotor"],[C,X]],[/(shield[\w ]+) b/i],[E,[I,"Nvidia"],[C,X]],[/(sprint) (\w+)/i],[I,E,[C,z]],[/(kin\.[onetw]{3})/i],[[E,/\./g," "],[I,bn],[C,z]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[E,[I,Pe],[C,X]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[E,[I,Pe],[C,z]],[/smart-tv.+(samsung)/i],[I,[C,ie]],[/hbbtv.+maple;(\d+)/i],[[E,/^/,"SmartTV"],[I,xe],[C,ie]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[I,fr],[C,ie]],[/(apple) ?tv/i],[I,[E,ge+" TV"],[C,ie]],[/crkey/i],[[E,Ne+"cast"],[I,Ft],[C,ie]],[/droid.+aft(\w)( bui|\))/i],[E,[I,Ce],[C,ie]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[E,[I,Be],[C,ie]],[/(bravia[\w ]+)( bui|\))/i],[E,[I,at],[C,ie]],[/(mitv-\w{5}) bui/i],[E,[I,Gt],[C,ie]],[/Hbbtv.*(technisat) (.*);/i],[I,E,[C,ie]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[I,vi],[E,vi],[C,ie]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[C,ie]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[I,E,[C,$]],[/droid.+; (shield) bui/i],[E,[I,"Nvidia"],[C,$]],[/(playstation [345portablevi]+)/i],[E,[I,at],[C,$]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[E,[I,bn],[C,$]],[/((pebble))app/i],[I,E,[C,oe]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[E,[I,ge],[C,oe]],[/droid.+; (glass) \d/i],[E,[I,Ft],[C,oe]],[/droid.+; (wt63?0{2,3})\)/i],[E,[I,Pe],[C,oe]],[/(quest( 2| pro)?)/i],[E,[I,U],[C,oe]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[I,[C,Re]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[E,[C,z]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[E,[C,X]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[C,X]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[C,z]],[/(android[-\w\. ]{0,9});.+buil/i],[E,[I,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[k,[y,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[k,[y,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[y,k],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[k,y]],os:[[/microsoft (windows) (vista|xp)/i],[y,k],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[y,[k,Zc,uE]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[y,"Windows"],[k,Zc,uE]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[k,/_/g,"."],[y,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[y,re],[k,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[k,y],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[y,k],[/\(bb(10);/i],[k,[y,Se]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[k,[y,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[k,[y,vt+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[k,[y,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[k,[y,"watchOS"]],[/crkey\/([\d\.]+)/i],[k,[y,Ne+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[y,Y],k],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[y,k],[/(sunos) ?([\w\.\d]*)/i],[[y,"Solaris"],k],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[y,k]]},Ma=function(Xn,mr){if(typeof Xn===h&&(mr=Xn,Xn=a),!(this instanceof Ma))return new Ma(Xn,mr).getResult();var Tn=typeof r!==u&&r.navigator?r.navigator:a,Uo=Xn||(Tn&&Tn.userAgent?Tn.userAgent:""),Ac=Tn&&Tn.userAgentData?Tn.userAgentData:a,Jn=mr?function(Kt,bo){var ou={};for(var Bs in Kt)bo[Bs]&&bo[Bs].length%2==0?ou[Bs]=bo[Bs].concat(Kt[Bs]):ou[Bs]=Kt[Bs];return ou}(dE,mr):dE;return this.getBrowser=function(){var Kt={};return Kt[y]=a,Kt[k]=a,Fo.call(Kt,Uo,Jn.browser),Kt[v]=function(bo){return typeof bo===f?bo.replace(/[^\d\.]/g,"").split(".")[0]:a}(Kt[k]),Tn&&Tn.brave&&typeof Tn.brave.isBrave==l&&(Kt[y]="Brave"),Kt},this.getCPU=function(){var Kt={};return Kt[W]=a,Fo.call(Kt,Uo,Jn.cpu),Kt},this.getDevice=function(){var Kt={};return Kt[I]=a,Kt[E]=a,Kt[C]=a,Fo.call(Kt,Uo,Jn.device),!Kt[C]&&Ac&&Ac.mobile&&(Kt[C]=z),Kt[E]=="Macintosh"&&Tn&&typeof Tn.standalone!==u&&Tn.maxTouchPoints&&Tn.maxTouchPoints>2&&(Kt[E]="iPad",Kt[C]=X),Kt},this.getEngine=function(){var Kt={};return Kt[y]=a,Kt[k]=a,Fo.call(Kt,Uo,Jn.engine),Kt},this.getOS=function(){var Kt={};return Kt[y]=a,Kt[k]=a,Fo.call(Kt,Uo,Jn.os),!Kt[y]&&Ac&&Ac.platform!="Unknown"&&(Kt[y]=Ac.platform.replace(/chrome os/i,Y).replace(/macos/i,re)),Kt},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return Uo},this.setUA=function(Kt){return Uo=typeof Kt===f&&Kt.length>350?vi(Kt,350):Kt,this},this.setUA(Uo),this};Ma.VERSION="0.7.34",Ma.BROWSER=Oe([y,k,v]),Ma.CPU=Oe([W]),Ma.DEVICE=Oe([E,I,C,$,z,ie,X,oe,Re]),Ma.ENGINE=Ma.OS=Oe([y,k]),i.exports&&(t=i.exports=Ma),t.UAParser=Ma;var iu=typeof r!==u&&(r.jQuery||r.Zepto);if(iu&&!iu.ua){var Zh=new Ma;iu.ua=Zh.getResult(),iu.ua.get=function(){return Zh.getUA()},iu.ua.set=function(Xn){Zh.setUA(Xn);var mr=Zh.getResult();for(var Tn in mr)iu.ua[Tn]=mr[Tn]}}})(typeof window=="object"?window:Tt)})(vb,vb.exports);const Eb=new(it(vb.exports));let $c=Eb.getResult(),_b=null;function Wt(i){if(!_b){i&&Eb.setUA(i),$c=Eb.getResult();const t=function(u){if(u.engine.name==="Blink"&&u.browser.name!=="WeChat")return Zt.CHROME;switch(u.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return Zt.CHROME;case"Safari":case"Mobile Safari":return Zt.SAFARI;case"Edge":return Zt.EDGE;case"Firefox":return Zt.FIREFOX;case"QQBrowser":return Zt.QQ;case"Opera":return Zt.OPERA;case"WeChat":return Zt.WECHAT;default:return u.browser.name||""}}($c),r=function(u){let h;return h=u.engine.name==="Blink"?u.engine.version||"":u.browser.version||"",h.split(".")[0]}($c),a=function(u){return u.os.name==="Windows"?u.os.version?u.os.name+" "+u.os.version:u.os.name:u.os.name||""}($c),l=$c.os.version;if(!(t&&r&&a&&l))return{name:t,version:r,os:a,osVersion:l};_b={name:t,version:r,os:a,osVersion:l}}return _b}function zg(){return Wt().os}function Ak(){const i=Wt();return"".concat(i.os," ").concat(i.osVersion)}function Gg(){const i=Wt();return!!($c.engine.name==="WebKit"&&i.os===Rr.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&i.name!==Zt.SAFARI||ki()&&i.name!==Zt.SAFARI)}function YQ(){const i=Wt();if(Gg()){if(i.os===Rr.MAC_OS)return!0;if(i.os===Rr.IOS){const t=$c.os.version&&$c.os.version.split(".");if(t&&Number(t[0])===14&&t[1]&&Number(t[1])>=3||t&&Number(t[0])>14)return!0}}return!1}function XQ(){return $c.engine.name==="WebKit"}function yb(){return Wt().name===Zt.CHROME}function Di(){return Wt().name===Zt.SAFARI}function Cn(){return Wt().name===Zt.FIREFOX}function ki(){return Wt().os===Rr.IOS}function Sb(i){const t=Wt();return!(t.name!==Zt.CHROME||!t.osVersion)&&Number(t.version)>=i}function Ok(i){const t=Wt();return!(t.name!==Zt.EDGE||!t.osVersion)&&Number(t.version)>=i}function xk(i){const t=Wt();return!(t.name!==Zt.OPERA||!t.osVersion)&&Number(t.version)>=i}function Nk(){const i=Wt();return!(i.name!==Zt.CHROME||!i.osVersion)&&Number(i.version)<=90}function Pk(){const i=Wt();if(i.os!==Rr.IOS||!i.osVersion)return!1;const t=i.osVersion.split(".");return Number(t[0])<14||Number(t[0])===14&&Number(t[1])<=6}function Sh(){const i=Wt();if(i.os!==Rr.IOS||!i.osVersion)return!1;const t=i.osVersion.split(".");return Number(t[0])===15}function Cb(){const i=Wt();if(i.os!==Rr.IOS||!i.osVersion)return!1;const t=i.osVersion.split(".");return Number(t[0])===16}function Dk(){const i=Wt();if(i.os!==Rr.IOS||!i.osVersion)return!1;const t=i.osVersion.split(".");return Number(t[0])===15&&Number(t[1])>=1}function fc(){return Di()&&navigator.maxTouchPoints>0}function kk(){return Wt().name===Zt.WECHAT}function Lk(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function Ll(){const i=Wt();return i.name===Zt.EDGE||i.name===Zt.SAFARI?!1:!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function Kg(){return zg()===Rr.ANDROID}function Vf(){const i=Wt();return Kg()&&(i.name===Zt.CHROME||i.name===Zt.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}var G;(function(i){i.UNEXPECTED_ERROR="UNEXPECTED_ERROR",i.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",i.TIMEOUT="TIMEOUT",i.INVALID_PARAMS="INVALID_PARAMS",i.NOT_READABLE="NOT_READABLE",i.NOT_SUPPORTED="NOT_SUPPORTED",i.INVALID_OPERATION="INVALID_OPERATION",i.OPERATION_ABORTED="OPERATION_ABORTED",i.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",i.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",i.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",i.DATACHANNEL_FAILED="DATACHANNEL_FAILED",i.NETWORK_ERROR="NETWORK_ERROR",i.NETWORK_TIMEOUT="NETWORK_TIMEOUT",i.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",i.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",i.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",i.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",i.ELECTRON_IS_NULL="ELECTRON_IS_NULL",i.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",i.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",i.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",i.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",i.PERMISSION_DENIED="PERMISSION_DENIED",i.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",i.TRACK_IS_DISABLED="TRACK_IS_DISABLED",i.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",i.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",i.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",i.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",i.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",i.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",i.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",i.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",i.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",i.UID_CONFLICT="UID_CONFLICT",i.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",i.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",i.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",i.INVALID_TRACK="INVALID_TRACK",i.SENDER_NOT_FOUND="SENDER_NOT_FOUND",i.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",i.SET_ANSWER_FAILED="SET_ANSWER_FAILED",i.ICE_FAILED="ICE_FAILED",i.PC_CLOSED="PC_CLOSED",i.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",i.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",i.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",i.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",i.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",i.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",i.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",i.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",i.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",i.INVALID_REMOTE_USER="INVALID_REMOTE_USER",i.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",i.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",i.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",i.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",i.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",i.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",i.WS_ABORT="WS_ABORT",i.WS_DISCONNECT="WS_DISCONNECT",i.WS_ERR="WS_ERR",i.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",i.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",i.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",i.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",i.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",i.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",i.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",i.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",i.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",i.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",i.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",i.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",i.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",i.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",i.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",i.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",i.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",i.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",i.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",i.INVALID_PLUGIN="INVALID_PLUGIN",i.DISCONNECT_P2P="DISCONNECT_P2P",i.INIT_WEBSOCKET_TIMEOUT="INIT_WEBSOCKET_TIMEOUT",i.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",i.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",i.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",i.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",i.PROHIBITED_OPERATION="PROHIBITED_OPERATION",i.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED"})(G||(G={}));let be=class extends Error{constructor(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;super(t),w(this,"code",void 0),w(this,"message",void 0),w(this,"data",void 0),w(this,"name","AgoraRTCException"),this.code=i,this.message="AgoraRTCError ".concat(this.code,": ").concat(t),this.data=r}toString(){return this.data?"data: ".concat(JSON.stringify(this.data),`
`).concat(this.stack):"".concat(this.stack)}print(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error",t=arguments.length>1?arguments[1]:void 0;return i==="error"&&(t||console).error(this.toString()),i==="warning"&&(t||console).warn(this.toString()),this}throw(i){throw this.print("error",i),this}};function Yu(i,t){if(typeof i!="boolean")throw new be(G.INVALID_PARAMS,"Invalid ".concat(t,": The value is of the boolean type."))}function wr(i,t,r){if(!Ke(r).call(r,i))throw new be(G.INVALID_PARAMS,"".concat(t," can only be set as ").concat(JSON.stringify(r)))}function cn(i,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4;if(i<r||i>a||(!(arguments.length>4&&arguments[4]!==void 0)||arguments[4])&&!function(l){return typeof l=="number"&&l%1==0}(i))throw new be(G.INVALID_PARAMS,"invalid ".concat(t,": the value range is [").concat(r,", ").concat(a,"]. integer only"))}function bb(i,t){if(typeof i!="number"){if(!(i.min||i.max||i.ideal||i.exact))throw new be(G.INVALID_PARAMS,"".concat(t," is not a valid ConstrainLong"));i.min!==void 0&&cn(i.min,"".concat(t,".min"),0,1/0),i.max!==void 0&&cn(i.max,"".concat(t,".max"),1,1/0),i.exact!==void 0&&cn(i.exact,"".concat(t,".exact"),1,1/0),i.ideal!==void 0&&cn(i.ideal,"".concat(t,".ideal"),1,1/0)}else cn(i,t,1,1/0)}function di(i,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,l=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(i==null)throw new be(G.INVALID_PARAMS,"".concat(t||"param"," cannot be empty"));if(!Mk(i,r,a,l))throw new be(G.INVALID_PARAMS,"Invalid ".concat(t||"string param",": Length of the string: [").concat(r,",").concat(a,"].").concat(l?" ASCII characters only.":""))}function Hc(i,t){if(!Array.isArray(i))throw new be(G.INVALID_PARAMS,"".concat(t," should be an array"))}function kn(i){return i==null}function Mk(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,a=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof i=="string"&&i.length<=r&&i.length>=t&&(!a||function(l){if(typeof l!="string")return!1;for(let u=0;u<l.length;u+=1){const h=l.charCodeAt(u);if(h<0||h>255)return!1}return!0}(i))}function Fk(i,t,r){if("getBigUint64"in DataView.prototype)return i.getBigUint64(t,r);const a=i.getUint32(t,r),l=i.getUint32(t+4,r),u=+!!r,h=+!r;return BigInt(a*h+l*u)<<BigInt(32)|BigInt(a*u+l*h)}function Uk(i,t,r,a){if("setBigUint64"in DataView.prototype)return i.setBigUint64(t,r,a);const l=Number(r>>BigInt(32)),u=Number(r&BigInt(4294967295));a?(i.setUint32(t+4,l,a),i.setUint32(t,u,a)):(i.setUint32(t,l,a),i.setUint32(t+4,u,a))}var Ch,qg;(function(i){i.COVERED="COVERED",i.POSITION="POSITION",i.SIZE="SIZE",i.STYLE="STYLE"})(Ch||(Ch={})),function(i){i.UNMOUNTED="UNMOUNTED",i.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT"}(qg||(qg={}));const Bk=new class{constructor(){w(this,"_clientSize",null),w(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),w(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),w(this,"getStyle",i=>window.getComputedStyle(i,null)),w(this,"checkCssVisibleProperty",i=>{var t;let r=!0;const a=this.getStyle(i),{display:l,visibility:u,opacity:h,filter:f}=a;return(l==="none"||Ke(t=["hidden","collapse"]).call(t,u)||Number(h)<.1)&&(r=!1),r?(f&&f.split(" ").filter(v=>{var E;const y=v.split("(")[0];return Ke(E=["brightness","blur","opacity"]).call(E,y)}).map(v=>{const[E,y]=v.split(/\(|\)/);return[E,Number(y.match(/^[0-9\.]+/))]}).forEach(v=>{const[E,y]=v;switch(E){case"brightness":(y<.1||y>3)&&(r=!1);break;case"blur":y>3&&(r=!1);break;case"opacity":y<.1&&(r=!1)}}),r):!1}),w(this,"checkPropertyUpToAllParentNodes",(i,t)=>{let r=!0,a=!0;const l=h=>t(h);let u=i;for(;u&&a;)l(u)||(r=!1,a=!1),u=u.parentElement,u||(a=!1);return r}),w(this,"checkActualCssVisibleIncludeInherit",i=>this.checkPropertyUpToAllParentNodes(i,this.checkCssVisibleProperty)),w(this,"getSizeAboutClient",i=>{const{width:t,height:r,left:a,right:l,top:u,bottom:h}=i.getBoundingClientRect(),f=this.getClientWidth(),v=this.getClientHeight();return{width:t,height:r,left:a,right:l,top:u,bottom:h,clientWidth:f,clientHeight:v,clientMin:Math.min(f,v)}}),w(this,"checkActualSize",()=>{const{width:i,height:t,clientMin:r}=this._clientSize;return this.checkSizeIsVisible(i,t,r)}),w(this,"elementFromPoint",(i,t)=>document.elementFromPoint?document.elementFromPoint(i,t):null),w(this,"checkCoverForAPoint",(i,t,r)=>{const a=this.elementFromPoint(i,t);return a!==null&&a!==r}),w(this,"getPointPositionList",()=>{const{width:i,height:t,left:r,top:a}=this._clientSize,l=i/6,u=t/6,h=[],f=10**6;for(let v=0;v<5;v++)for(let E=0;E<5;E++){const y=(r*f+(v===0?.1:v===4?(l*v*f-1e5)/f:l*v)*f)/f,C=(a*f+(E===0?.1:E===4?(u*E*f-1e5)/f:u*E)*f)/f;h.push({x:y,y:C})}return[...h]}),w(this,"checkElementCover",i=>this.getPointPositionList().map(t=>this.checkCoverForAPoint(t.x,t.y,i)).filter(t=>!!t).length>6),w(this,"checkSizeIsVisible",(i,t,r)=>(i>50||r/i<=10)&&(t>50||r/t<=10)),w(this,"checkSizeOfPartInClient",()=>{const{left:i,right:t,top:r,bottom:a,clientHeight:l,clientWidth:u,clientMin:h}=this._clientSize;let f,v,E,y;if(i<0)f=0;else{if(!(i<u))return!1;f=i}if(t<0)return!1;if(v=t<u?t:u,r<0)E=0;else{if(!(r<l))return!1;E=r}if(a<0)return!1;y=a<l?a:l;const C=v-f,I=y-E;return this.checkSizeIsVisible(C,I,h)}),w(this,"returnHiddenResult",i=>(this._clientSize=null,{visible:!1,reason:i})),w(this,"checkOneElementVisible",i=>{if(i instanceof HTMLElement){if(this.checkElementIsMountedOnDom(i)){if(this.checkActualCssVisibleIncludeInherit(i)){if(this._clientSize=this.getSizeAboutClient(i),this.checkElementCover(i))return this.returnHiddenResult(Ch.COVERED);{const t=this.checkActualSize(),r=this.checkSizeOfPartInClient();return t&&!r?this.returnHiddenResult(Ch.POSITION):t?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(Ch.SIZE)}}return this.returnHiddenResult(Ch.STYLE)}return this.returnHiddenResult(qg.UNMOUNTED)}return this.returnHiddenResult(qg.INVALID_HTML_ELEMENT)}),w(this,"checkElementIsMountedOnDom",i=>this.checkPropertyUpToAllParentNodes(i,t=>t.nodeName.toUpperCase()!=="HTML"?t.parentElement!==null:!!document.documentElement))}};function Tb(i){return new TextEncoder().encode(i)}const jk=function(i,t){const r=new Uint8Array(i.byteLength+t.byteLength);return r.set(new Uint8Array(i),0),r.set(new Uint8Array(t),i.byteLength),r},JQ=async i=>{const t=function(u){const h=window.atob(u),f=new Uint8Array(new ArrayBuffer(h.length));for(let v=0;v<h.length;v+=1)f[v]=h.charCodeAt(v);return f}(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),r=await window.crypto.subtle.importKey("spki",t,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),a=Tb(i),l=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},r,a);return function(u){let h="";for(let f=0;f<u.length;f+=1)h+=String.fromCharCode(u[f]);return window.btoa(h)}(new Uint8Array(l))},QQ=async i=>function(t,r){let a="";return new Uint8Array(t).forEach(l=>{a+=l.toString(r).padStart(2,"0")}),a}(await crypto.subtle.digest("SHA-256",Tb(i)),16);class An{constructor(){w(this,"_events",{}),w(this,"addListener",this.on)}getListeners(t){return this._events[t]?this._events[t].map(r=>r.listener):[]}on(t,r){this._events[t]||(this._events[t]=[]);const a=this._events[t];this._indexOfListener(a,r)===-1&&a.push({listener:r,once:!1})}once(t,r){this._events[t]||(this._events[t]=[]);const a=this._events[t];this._indexOfListener(a,r)===-1&&a.push({listener:r,once:!0})}off(t,r){if(!this._events[t])return;const a=this._events[t],l=this._indexOfListener(a,r);l!==-1&&a.splice(l,1),this._events[t].length===0&&delete this._events[t]}removeAllListeners(t){t?delete this._events[t]:this._events={}}emit(t){this._events[t]||(this._events[t]=[]);const r=this._events[t].map(h=>h);for(var a=arguments.length,l=new Array(a>1?a-1:0),u=1;u<a;u++)l[u-1]=arguments[u];for(let h=0;h<r.length;h+=1){const f=r[h];f.once&&this.off(t,f.listener),f.listener.apply(this,l||[])}}safeEmit(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),l=1;l<r;l++)a[l-1]=arguments[l];[...this._events[t]||[]].forEach(u=>{u.once&&this.off(t,u.listener);try{u.listener.apply(this,a)}catch(h){console.error("safeEmit event:".concat(t," error ").concat(h==null?void 0:h.toString()))}})}_indexOfListener(t,r){let a=t.length;for(;a--;)if(t[a].listener===r)return a;return-1}}let $f=null;function Vk(){if($f)return $f;if(window.electron)return $f=window.electron;if(!window.require)return null;try{return $f=window.require("electron"),$f}catch{return null}}var hr,Dn,Rb,It,At,Ir,Li,Wc;function $k(i){return cn(i.timeout,"config.timeout",0,1e5),cn(i.timeoutFactor,"config.timeoutFactor",0,100,!1),cn(i.maxRetryCount,"config.maxRetryConfig",0,1/0),cn(i.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}function bh(i){if(!Array.isArray(i)||i.length<1)return!1;try{i.forEach(t=>{if(!t.urls)throw Error()})}catch{return!1}return!0}function Hk(i){return di(i.turnServerURL,"turnServerURL"),di(i.username,"username"),di(i.password,"password"),i.udpport&&cn(i.udpport,"udpport",1,99999,!0),i.forceturn&&Yu(i.forceturn,"forceturn"),i.security&&Yu(i.security,"security"),i.tcpport&&cn(i.tcpport,"tcpport",1,99999,!0),!0}function Wk(i){return i.level!==void 0&&wr(i.level,"level",[1,2,3]),i.delay!==void 0&&cn(i.delay,"delay",0,3e3,!0),!0}function Ln(i,t){for(var r=arguments.length,a=new Array(r>2?r-2:0),l=2;l<r;l++)a[l-2]=arguments[l];return i.getListeners(t).length===0?me.reject(new be(G.UNEXPECTED_ERROR,"can not emit promise")):new me((u,h)=>{i.emit(t,...a,u,h)})}function ln(i,t){if(i.getListeners(t).length===0)return me.resolve();for(var r=arguments.length,a=new Array(r>2?r-2:0),l=2;l<r;l++)a[l-2]=arguments[l];return Ln(i,t,...a)}function mo(i,t){if(i.getListeners(t).length===0)return null;for(var r=arguments.length,a=new Array(r>2?r-2:0),l=2;l<r;l++)a[l-2]=arguments[l];return zc(i,t,...a)}function zc(i,t){let r=null,a=null;for(var l=arguments.length,u=new Array(l>2?l-2:0),h=2;h<l;h++)u[h-2]=arguments[h];if(i.emit(t,...u,f=>{r=f},f=>{a=f}),a!==null)throw a;if(r===null)throw new be(G.UNEXPECTED_ERROR,"handler is not sync");return r}(function(i){i.CREATE_CLIENT="createClient",i.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",i.SET_AREA="setArea",i.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",i.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",i.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",i.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",i.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",i.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",i.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",i.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",i.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",i.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",i.START_PROXY_SERVER="Client.startProxyServer",i.STOP_PROXY_SERVER="Client.stopProxyServer",i.SET_PROXY_SERVER="Client.setProxyServer",i.SET_TURN_SERVER="Client.setTurnServer",i.SET_CLIENT_ROLE="Client.setClientRole",i.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",i.ENABLE_DUAL_STREAM="Client.enableDualStream",i.DISABLE_DUAL_STREAM="Client.disableDualStream",i.JOIN="Client.join",i.LEAVE="Client.leave",i.PUBLISH="Client.publish",i.UNPUBLISH="Client.unpublish",i.SUBSCRIBE="Client.subscribe",i.MASS_SUBSCRIBE="Client.massSubscribe",i.MASS_UNSUBSCRIBE="Client.massUnsubscribe",i.UNSUBSCRIBE="Client.unsubscribe",i.RENEW_TOKEN="Client.renewToken",i.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",i.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",i.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",i.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",i.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",i.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",i.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",i.DATACHANNEL_FAILBACK="Client._datachannelFailback",i.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",i.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",i.START_LIVE_STREAMING="Client.startLiveStreaming",i.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",i.STOP_LIVE_STREAMING="Client.stopLiveStreaming",i.ADD_INJECT_STREAM_URL="Client.addInjectStreamUrl",i.REMOVE_INJECT_STREAM_URL="Client.removeInjectStreamUrl",i.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",i.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",i.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",i.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",i.SET_CONFIG_DISTRIBUTE="_configDistribute",i.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",i.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",i.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",i.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",i.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",i.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",i.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",i.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",i.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",i.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",i.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",i.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",i.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",i.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",i.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",i.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",i.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",i.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",i.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",i.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",i.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",i.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",i.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",i.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",i.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",i.STREAM_TYPE_CHANGE="streamTypeChange",i.CONNECTION_STATE_CHANGE="connectionStateChange",i.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",i.IMAGE_MODERATION_UPLOAD="imageModerationUpload"})(hr||(hr={})),function(i){i.TRACER="tracer"}(Dn||(Dn={})),function(i){i[i.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",i[i.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",i[i.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY"}(Rb||(Rb={})),function(i){i.LEAVE="LEAVE",i.NETWORK_ERROR="NETWORK_ERROR",i.SERVER_ERROR="SERVER_ERROR",i.UID_BANNED="UID_BANNED",i.IP_BANNED="IP_BANNED",i.CHANNEL_BANNED="CHANNEL_BANNED",i.FALLBACK="FALLBACK",i.LICENSE_MISSING="LICENSE_MISSING",i.LICENSE_EXPIRED="LICENSE_EXPIRED",i.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",i.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",i.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",i.LICENSE_ILLEGAL="LICENSE_ILLEGAL",i.TOKEN_EXPIRE="TOKEN_EXPIRE"}(It||(It={})),function(i){i.CONNECTION_STATE_CHANGE="connection-state-change",i.MEDIA_RECONNECT_START="media-reconnect-start",i.MEDIA_RECONNECT_END="media-reconnect-end",i.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",i.USER_JOINED="user-joined",i.USER_LEAVED="user-left",i.USER_PUBLISHED="user-published",i.USER_UNPUBLISHED="user-unpublished",i.USER_INFO_UPDATED="user-info-updated",i.CLIENT_BANNED="client-banned",i.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",i.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",i.VOLUME_INDICATOR="volume-indicator",i.CRYPT_ERROR="crypt-error",i.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",i.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",i.NETWORK_QUALITY="network-quality",i.STREAM_TYPE_CHANGED="stream-type-changed",i.STREAM_FALLBACK="stream-fallback",i.RECEIVE_METADATA="receive-metadata",i.STREAM_MESSAGE="stream-message",i.LIVE_STREAMING_ERROR="live-streaming-error",i.LIVE_STREAMING_WARNING="live-streaming-warning",i.INJECT_STREAM_STATUS="stream-inject-status",i.EXCEPTION="exception",i.ERROR="error",i.P2P_LOST="p2p_lost",i.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",i.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",i.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",i.PUBLISHED_USER_LIST="published-user-list",i.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",i.CONTENT_INSPECT_ERROR="content-inspect-error",i.CONTENT_INSPECT_RESULT="content-inspect-result",i.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change"}(At||(At={})),function(i){i.NETWORK_ERROR="NETWORK_ERROR",i.SERVER_ERROR="SERVER_ERROR",i.MULTI_IP="MULTI_IP",i.TIMEOUT="TIMEOUT",i.OFFLINE="OFFLINE",i.LEAVE="LEAVE",i.P2P_FAILED="P2P_FAILED",i.FALLBACK="FALLBACK"}(Ir||(Ir={})),function(i){i.ONLINE="ONLINE",i.OFFLINE="OFFLINE"}(Li||(Li={})),function(i){i.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",i.ONLINE="ONLINE",i.OFFLINE="OFFLINE"}(Wc||(Wc={}));const or=new class extends An{set networkState(i){this.emit(Wc.NETWORK_STATE_CHANGE,i,this._networkState),i===Li.ONLINE?this.emit(Wc.ONLINE):i===Li.OFFLINE&&(this.onlineWaiter=new me(t=>{this.once(Wc.ONLINE,()=>{this.onlineWaiter=void 0,t(Li.ONLINE)})}),this.emit(Wc.OFFLINE)),this._networkState=i}get networkState(){return this._networkState}get isOnline(){return this._networkState===Li.ONLINE}constructor(){super(),w(this,"_moduleName","network-indicator"),w(this,"_networkState",Li.ONLINE),w(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=Li.ONLINE}),window.addEventListener("offline",()=>{this.networkState=Li.OFFLINE})}};function zk(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function Xu(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zk(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):zk(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}function wb(i,t){const r=i.indexOf(t);r!==-1&&i.splice(r,1)}function Th(i){const t=[];return i.forEach(r=>{t.indexOf(r)===-1&&t.push(r)}),t}function ns(i){me!==void 0?me.resolve().then(i):setTimeout(i,0)}function ar(i){return JSON.parse(JSON.stringify(i))}function Ju(i){try{return ar(i)}catch{return i}}const Gk={};function Hf(i,t){Gk[t]||(Gk[t]=!0,i())}function Yg(i){const t=window.atob(i),r=new Uint8Array(new ArrayBuffer(t.length));for(let a=0;a<t.length;a+=1)r[a]=t.charCodeAt(a);return r}function Xg(i){let t="";for(let r=0;r<i.length;r+=1)t+=String.fromCharCode(i[r]);return window.btoa(t)}function mc(i){return window.TextEncoder?new TextEncoder().encode(i).length:i.length}function Kk(i){let t=0;return/DingTalk/i.test(navigator.userAgent)&&i.realFormData&&(i=i.realFormData),i.forEach(r=>{t+=typeof r=="string"?mc(r):r.size}),t+138}function ZQ(i){const t=new be(G.TIMEOUT,"timeout");return new me((r,a)=>{window.setTimeout(()=>a(t),i)})}function ni(i){return new me(t=>{window.setTimeout(t,i)})}function un(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,t=arguments.length>1?arguments[1]:void 0;const r=Math.random().toString(16).substr(2,i).toLowerCase();return r.length===i?"".concat(t).concat(r):"".concat(t).concat(r)+un(i-r.length,"")}function Ib(){return un(32,"").toUpperCase()}const Jg=()=>{},qk=new class{constructor(){w(this,"fnMap",new Map)}throttleByKey(i,t,r,a){for(var l=arguments.length,u=new Array(l>4?l-4:0),h=4;h<l;h++)u[h-4]=arguments[h];if(this.fnMap.has(t)){const f=this.fnMap.get(t);if(f.threshold!==r){f.fn(...f.args),clearTimeout(f.timer);const v=window.setTimeout(()=>{const E=this.fnMap.get(t);E&&E.fn(...E.args),this.fnMap.delete(t)},r);this.fnMap.set(t,{fn:i,threshold:r,timer:v,args:u,skipFn:a})}else f.skipFn&&f.skipFn(...f.args),this.fnMap.set(t,Xu(Xu({},f),{},{fn:i,args:u,skipFn:a}))}else{const f=window.setTimeout(()=>{const v=this.fnMap.get(t);v&&v.fn(...v.args),this.fnMap.delete(t)},r);this.fnMap.set(t,{fn:i,threshold:r,timer:f,args:u,skipFn:a})}}},Yk=qk.throttleByKey.bind(qk);function Xk(i){return typeof i=="object"&&i!==null&&!(i instanceof RegExp)}function Ab(i,t){if(!Xk(i)||!Xk(t)||Array.isArray(i)&&!Array.isArray(t)||!Array.isArray(i)&&Array.isArray(t))return t;if(Array.isArray(t)&&Array.isArray(i)){const r=[...i];for(let a=0;a<t.length;a++)r[a]=Ab(i[a],t[a]);return r}{const r=Xu({},i);for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&(Object.prototype.hasOwnProperty.call(i,a)?r[a]=Ab(i[a],t[a]):r[a]=t[a]);return r}}let eZ=1,Qg=console;class Mr{static setLogger(t){Qg=t}constructor(t){w(this,"lockingPromise",me.resolve()),w(this,"locks",0),w(this,"name",""),w(this,"lockId",void 0),this.lockId=eZ++,t&&(this.name=t),Qg.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock(t){let r;this.locks+=1,Qg.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is locked, current queue ").concat(this.locks,". ").concat(typeof t=="string"?t:""));const a=new me(u=>{r=()=>{this.locks-=1,Qg.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is not locked, current queue ").concat(this.locks,". ").concat(typeof t=="string"?t:"")),u()}}),l=this.lockingPromise.then(()=>r);return this.lockingPromise=this.lockingPromise.then(()=>a),l}}function Rh(i,t){return function(r,a,l){const u=l.value;if(typeof u!="function")throw new Error("Cannot use mutex on object property.");return l.value=async function(){const h=this[t];if(!h)throw new Error("mutex property key ".concat(t," doesn't exist on ").concat(i));const f=await h.lock("From ".concat(i,".").concat(a));try{for(var v=arguments.length,E=new Array(v),y=0;y<v;y++)E[y]=arguments[y];return await u.apply(this,E)}finally{f()}},l}}const sr={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function Zg(i,t){const r=Math.floor(t.timeout*Math.pow(t.timeoutFactor,i));return Math.min(t.maxRetryTimeout,r)}function Ls(i,t,r,a){const l=Object.assign({},sr,a);let u=l.timeout;const h=async()=>{await function(E){return new me(y=>{window.setTimeout(y,E)})}(u),u*=l.timeoutFactor,u=Math.min(l.maxRetryTimeout,u)};let f=!1;const v=new me(async(E,y)=>{t=t||(()=>!1),r=r||(()=>!0);for(let C=0;C<l.maxRetryCount;C+=1){if(f)return y(new be(G.OPERATION_ABORTED));try{const I=await i();if(!t(I,C)||C+1===l.maxRetryCount)return E(I);await h()}catch(I){if(!r(I,C)||C+1===l.maxRetryCount)return y(I);await h()}}});return v.cancel=()=>f=!0,v}var tZ=Nt,nZ=ju,rZ=Qa,iZ=Vu,oZ=TypeError,Jk=function(i){return function(t,r,a,l){tZ(r);var u=nZ(t),h=rZ(u),f=iZ(u),v=i?f-1:0,E=i?-1:1;if(a<2)for(;;){if(v in h){l=h[v],v+=E;break}if(v+=E,i?v<0:f<=v)throw oZ("Reduce of empty array with no initial value")}for(;i?v>=0:f>v;v+=E)v in h&&(l=r(l,h[v],v,u));return l}},aZ={left:Jk(!1),right:Jk(!0)}.left;Zn({target:"Array",proto:!0,forced:!kf&&es>79&&es<83||!pD("reduce")},{reduce:function(i){var t=arguments.length;return aZ(this,i,t,t>1?arguments[1]:void 0)}});var sZ=$u("Array").reduce,cZ=Jt,lZ=sZ,Ob=Array.prototype,Qu=it(function(i){var t=i.reduce;return i===Ob||cZ(Ob,i)&&t===Ob.reduce?lZ:t});let xb=class{constructor(i){w(this,"input",[]),w(this,"size",void 0),this.size=i}add(i){this.input.push(i),this.input.length>this.size&&this.input.splice(0,1)}mean(){var i;return this.input.length===0?0:Qu(i=this.input).call(i,(t,r)=>t+r)/this.input.length}};var Nb,Pb={exports:{}},Qk=function(i,t){return function(){for(var r=new Array(arguments.length),a=0;a<r.length;a++)r[a]=arguments[a];return i.apply(t,r)}},uZ=Qk,Db=Object.prototype.toString,kb=(Nb=Object.create(null),function(i){var t=Db.call(i);return Nb[t]||(Nb[t]=t.slice(8,-1).toLowerCase())});function Zu(i){return i=i.toLowerCase(),function(t){return kb(t)===i}}function Lb(i){return Array.isArray(i)}function ev(i){return i===void 0}var Zk=Zu("ArrayBuffer");function e2(i){return i!==null&&typeof i=="object"}function tv(i){if(kb(i)!=="object")return!1;var t=Object.getPrototypeOf(i);return t===null||t===Object.prototype}var dZ=Zu("Date"),hZ=Zu("File"),pZ=Zu("Blob"),fZ=Zu("FileList");function Mb(i){return Db.call(i)==="[object Function]"}var mZ=Zu("URLSearchParams");function Fb(i,t){if(i!=null)if(typeof i!="object"&&(i=[i]),Lb(i))for(var r=0,a=i.length;r<a;r++)t.call(null,i[r],r,i);else for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&t.call(null,i[l],l,i)}var Ub,gZ=(Ub=typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array),function(i){return Ub&&i instanceof Ub}),Qi={isArray:Lb,isArrayBuffer:Zk,isBuffer:function(i){return i!==null&&!ev(i)&&i.constructor!==null&&!ev(i.constructor)&&typeof i.constructor.isBuffer=="function"&&i.constructor.isBuffer(i)},isFormData:function(i){var t="[object FormData]";return i&&(typeof FormData=="function"&&i instanceof FormData||Db.call(i)===t||Mb(i.toString)&&i.toString()===t)},isArrayBufferView:function(i){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(i):i&&i.buffer&&Zk(i.buffer)},isString:function(i){return typeof i=="string"},isNumber:function(i){return typeof i=="number"},isObject:e2,isPlainObject:tv,isUndefined:ev,isDate:dZ,isFile:hZ,isBlob:pZ,isFunction:Mb,isStream:function(i){return e2(i)&&Mb(i.pipe)},isURLSearchParams:mZ,isStandardBrowserEnv:function(){return(typeof navigator>"u"||navigator.product!=="ReactNative"&&navigator.product!=="NativeScript"&&navigator.product!=="NS")&&typeof window<"u"&&typeof document<"u"},forEach:Fb,merge:function i(){var t={};function r(u,h){tv(t[h])&&tv(u)?t[h]=i(t[h],u):tv(u)?t[h]=i({},u):Lb(u)?t[h]=u.slice():t[h]=u}for(var a=0,l=arguments.length;a<l;a++)Fb(arguments[a],r);return t},extend:function(i,t,r){return Fb(t,function(a,l){i[l]=r&&typeof a=="function"?uZ(a,r):a}),i},trim:function(i){return i.trim?i.trim():i.replace(/^\s+|\s+$/g,"")},stripBOM:function(i){return i.charCodeAt(0)===65279&&(i=i.slice(1)),i},inherits:function(i,t,r,a){i.prototype=Object.create(t.prototype,a),i.prototype.constructor=i,r&&Object.assign(i.prototype,r)},toFlatObject:function(i,t,r){var a,l,u,h={};t=t||{};do{for(l=(a=Object.getOwnPropertyNames(i)).length;l-- >0;)h[u=a[l]]||(t[u]=i[u],h[u]=!0);i=Object.getPrototypeOf(i)}while(i&&(!r||r(i,t))&&i!==Object.prototype);return t},kindOf:kb,kindOfTest:Zu,endsWith:function(i,t,r){i=String(i),(r===void 0||r>i.length)&&(r=i.length),r-=t.length;var a=i.indexOf(t,r);return a!==-1&&a===r},toArray:function(i){if(!i)return null;var t=i.length;if(ev(t))return null;for(var r=new Array(t);t-- >0;)r[t]=i[t];return r},isTypedArray:gZ,isFileList:fZ},wh=Qi;function t2(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var n2=function(i,t,r){if(!t)return i;var a;if(r)a=r(t);else if(wh.isURLSearchParams(t))a=t.toString();else{var l=[];wh.forEach(t,function(h,f){h!=null&&(wh.isArray(h)?f+="[]":h=[h],wh.forEach(h,function(v){wh.isDate(v)?v=v.toISOString():wh.isObject(v)&&(v=JSON.stringify(v)),l.push(t2(f)+"="+t2(v))}))}),a=l.join("&")}if(a){var u=i.indexOf("#");u!==-1&&(i=i.slice(0,u)),i+=(i.indexOf("?")===-1?"?":"&")+a}return i},vZ=Qi;function nv(){this.handlers=[]}nv.prototype.use=function(i,t,r){return this.handlers.push({fulfilled:i,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},nv.prototype.eject=function(i){this.handlers[i]&&(this.handlers[i]=null)},nv.prototype.forEach=function(i){vZ.forEach(this.handlers,function(t){t!==null&&i(t)})};var r2,i2,EZ=nv,_Z=Qi;function Ih(){if(i2)return r2;i2=1;var i=Qi;function t(l,u,h,f,v){Error.call(this),this.message=l,this.name="AxiosError",u&&(this.code=u),h&&(this.config=h),f&&(this.request=f),v&&(this.response=v)}i.inherits(t,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var r=t.prototype,a={};return["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(l){a[l]={value:l}}),Object.defineProperties(t,a),Object.defineProperty(r,"isAxiosError",{value:!0}),t.from=function(l,u,h,f,v,E){var y=Object.create(r);return i.toFlatObject(l,y,function(C){return C!==Error.prototype}),t.call(y,l.message,u,h,f,v),y.name=l.name,E&&Object.assign(y,E),y},r2=t}var Bb,o2,a2,s2,jb,c2,l2={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};function u2(){if(o2)return Bb;o2=1;var i=Qi;return Bb=function(t,r){r=r||new FormData;var a=[];function l(u){return u===null?"":i.isDate(u)?u.toISOString():i.isArrayBuffer(u)||i.isTypedArray(u)?typeof Blob=="function"?new Blob([u]):Buffer.from(u):u}return function u(h,f){if(i.isPlainObject(h)||i.isArray(h)){if(a.indexOf(h)!==-1)throw Error("Circular reference detected in "+f);a.push(h),i.forEach(h,function(v,E){if(!i.isUndefined(v)){var y,C=f?f+"."+E:E;if(v&&!f&&typeof v=="object"){if(i.endsWith(E,"{}"))v=JSON.stringify(v);else if(i.endsWith(E,"[]")&&(y=i.toArray(v)))return void y.forEach(function(I){!i.isUndefined(I)&&r.append(C,l(I))})}u(v,C)}}),a.pop()}else r.append(f,l(h))}(t),r},Bb}function yZ(){if(s2)return a2;s2=1;var i=Ih();return a2=function(t,r,a){var l=a.config.validateStatus;a.status&&l&&!l(a.status)?r(new i("Request failed with status code "+a.status,[i.ERR_BAD_REQUEST,i.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a)):t(a)}}function SZ(){if(c2)return jb;c2=1;var i=Qi;return jb=i.isStandardBrowserEnv()?{write:function(t,r,a,l,u,h){var f=[];f.push(t+"="+encodeURIComponent(r)),i.isNumber(a)&&f.push("expires="+new Date(a).toGMTString()),i.isString(l)&&f.push("path="+l),i.isString(u)&&f.push("domain="+u),h===!0&&f.push("secure"),document.cookie=f.join("; ")},read:function(t){var r=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},jb}var Vb,d2,h2,p2,f2,m2,g2,v2,$b,E2,_2,y2,CZ=function(i){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(i)},bZ=function(i,t){return t?i.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):i},S2=function(i,t){return i&&!CZ(t)?bZ(i,t):t};function TZ(){if(d2)return Vb;d2=1;var i=Qi,t=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return Vb=function(r){var a,l,u,h={};return r&&i.forEach(r.split(`
`),function(f){if(u=f.indexOf(":"),a=i.trim(f.substr(0,u)).toLowerCase(),l=i.trim(f.substr(u+1)),a){if(h[a]&&t.indexOf(a)>=0)return;h[a]=a==="set-cookie"?(h[a]?h[a]:[]).concat([l]):h[a]?h[a]+", "+l:l}}),h},Vb}function RZ(){if(p2)return h2;p2=1;var i=Qi;return h2=i.isStandardBrowserEnv()?function(){var t,r=/(msie|trident)/i.test(navigator.userAgent),a=document.createElement("a");function l(u){var h=u;return r&&(a.setAttribute("href",h),h=a.href),a.setAttribute("href",h),{href:a.href,protocol:a.protocol?a.protocol.replace(/:$/,""):"",host:a.host,search:a.search?a.search.replace(/^\?/,""):"",hash:a.hash?a.hash.replace(/^#/,""):"",hostname:a.hostname,port:a.port,pathname:a.pathname.charAt(0)==="/"?a.pathname:"/"+a.pathname}}return t=l(window.location.href),function(u){var h=i.isString(u)?l(u):u;return h.protocol===t.protocol&&h.host===t.host}}():function(){return!0}}function rv(){if(m2)return f2;m2=1;var i=Ih();function t(r){i.call(this,r??"canceled",i.ERR_CANCELED),this.name="CanceledError"}return Qi.inherits(t,i,{__CANCEL__:!0}),f2=t}function wZ(){return v2||(v2=1,g2=function(i){var t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(i);return t&&t[1]||""}),g2}function IZ(){if(E2)return $b;E2=1;var i=Qi,t=yZ(),r=SZ(),a=n2,l=S2,u=TZ(),h=RZ(),f=l2,v=Ih(),E=rv(),y=wZ();return $b=function(C){return new Promise(function(I,k){var W,$=C.data,z=C.headers,X=C.responseType;function ie(){C.cancelToken&&C.cancelToken.unsubscribe(W),C.signal&&C.signal.removeEventListener("abort",W)}i.isFormData($)&&i.isStandardBrowserEnv()&&delete z["Content-Type"];var oe=new XMLHttpRequest;if(C.auth){var Re=C.auth.username||"",Ce=C.auth.password?unescape(encodeURIComponent(C.auth.password)):"";z.Authorization="Basic "+btoa(Re+":"+Ce)}var ge=l(C.baseURL,C.url);function _e(){if(oe){var Ne="getAllResponseHeaders"in oe?u(oe.getAllResponseHeaders()):null,vt={data:X&&X!=="text"&&X!=="json"?oe.response:oe.responseText,status:oe.status,statusText:oe.statusText,headers:Ne,config:C,request:oe};t(function(Ft){I(Ft),ie()},function(Ft){k(Ft),ie()},vt),oe=null}}if(oe.open(C.method.toUpperCase(),a(ge,C.params,C.paramsSerializer),!0),oe.timeout=C.timeout,"onloadend"in oe?oe.onloadend=_e:oe.onreadystatechange=function(){oe&&oe.readyState===4&&(oe.status!==0||oe.responseURL&&oe.responseURL.indexOf("file:")===0)&&setTimeout(_e)},oe.onabort=function(){oe&&(k(new v("Request aborted",v.ECONNABORTED,C,oe)),oe=null)},oe.onerror=function(){k(new v("Network Error",v.ERR_NETWORK,C,oe,oe)),oe=null},oe.ontimeout=function(){var Ne=C.timeout?"timeout of "+C.timeout+"ms exceeded":"timeout exceeded",vt=C.transitional||f;C.timeoutErrorMessage&&(Ne=C.timeoutErrorMessage),k(new v(Ne,vt.clarifyTimeoutError?v.ETIMEDOUT:v.ECONNABORTED,C,oe)),oe=null},i.isStandardBrowserEnv()){var Se=(C.withCredentials||h(ge))&&C.xsrfCookieName?r.read(C.xsrfCookieName):void 0;Se&&(z[C.xsrfHeaderName]=Se)}"setRequestHeader"in oe&&i.forEach(z,function(Ne,vt){$===void 0&&vt.toLowerCase()==="content-type"?delete z[vt]:oe.setRequestHeader(vt,Ne)}),i.isUndefined(C.withCredentials)||(oe.withCredentials=!!C.withCredentials),X&&X!=="json"&&(oe.responseType=C.responseType),typeof C.onDownloadProgress=="function"&&oe.addEventListener("progress",C.onDownloadProgress),typeof C.onUploadProgress=="function"&&oe.upload&&oe.upload.addEventListener("progress",C.onUploadProgress),(C.cancelToken||C.signal)&&(W=function(Ne){oe&&(k(!Ne||Ne&&Ne.type?new E:Ne),oe.abort(),oe=null)},C.cancelToken&&C.cancelToken.subscribe(W),C.signal&&(C.signal.aborted?W():C.signal.addEventListener("abort",W))),$||($=null);var De=y(ge);De&&["http","https","file"].indexOf(De)===-1?k(new v("Unsupported protocol "+De+":",v.ERR_BAD_REQUEST,C)):oe.send($)})},$b}var Vi=Qi,C2=function(i,t){_Z.forEach(i,function(r,a){a!==t&&a.toUpperCase()===t.toUpperCase()&&(i[t]=r,delete i[a])})},b2=Ih(),AZ=l2,OZ=u2(),xZ={"Content-Type":"application/x-www-form-urlencoded"};function T2(i,t){!Vi.isUndefined(i)&&Vi.isUndefined(i["Content-Type"])&&(i["Content-Type"]=t)}var R2,iv={transitional:AZ,adapter:((typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(R2=IZ()),R2),transformRequest:[function(i,t){if(C2(t,"Accept"),C2(t,"Content-Type"),Vi.isFormData(i)||Vi.isArrayBuffer(i)||Vi.isBuffer(i)||Vi.isStream(i)||Vi.isFile(i)||Vi.isBlob(i))return i;if(Vi.isArrayBufferView(i))return i.buffer;if(Vi.isURLSearchParams(i))return T2(t,"application/x-www-form-urlencoded;charset=utf-8"),i.toString();var r,a=Vi.isObject(i),l=t&&t["Content-Type"];if((r=Vi.isFileList(i))||a&&l==="multipart/form-data"){var u=this.env&&this.env.FormData;return OZ(r?{"files[]":i}:i,u&&new u)}return a||l==="application/json"?(T2(t,"application/json"),function(h,f,v){if(Vi.isString(h))try{return(f||JSON.parse)(h),Vi.trim(h)}catch(E){if(E.name!=="SyntaxError")throw E}return(v||JSON.stringify)(h)}(i)):i}],transformResponse:[function(i){var t=this.transitional||iv.transitional,r=t&&t.silentJSONParsing,a=t&&t.forcedJSONParsing,l=!r&&this.responseType==="json";if(l||a&&Vi.isString(i)&&i.length)try{return JSON.parse(i)}catch(u){if(l)throw u.name==="SyntaxError"?b2.from(u,b2.ERR_BAD_RESPONSE,this,null,this.response):u}return i}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:y2?_2:(y2=1,_2=null)},validateStatus:function(i){return i>=200&&i<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Vi.forEach(["delete","get","head"],function(i){iv.headers[i]={}}),Vi.forEach(["post","put","patch"],function(i){iv.headers[i]=Vi.merge(xZ)});var w2,I2,Hb=iv,NZ=Qi,PZ=Hb;function A2(){return I2?w2:(I2=1,w2=function(i){return!(!i||!i.__CANCEL__)})}var O2=Qi,Wb=function(i,t,r){var a=this||PZ;return NZ.forEach(r,function(l){i=l.call(a,i,t)}),i},DZ=A2(),kZ=Hb,LZ=rv();function zb(i){if(i.cancelToken&&i.cancelToken.throwIfRequested(),i.signal&&i.signal.aborted)throw new LZ}var x2,N2,Ta=Qi,P2=function(i,t){t=t||{};var r={};function a(E,y){return Ta.isPlainObject(E)&&Ta.isPlainObject(y)?Ta.merge(E,y):Ta.isPlainObject(y)?Ta.merge({},y):Ta.isArray(y)?y.slice():y}function l(E){return Ta.isUndefined(t[E])?Ta.isUndefined(i[E])?void 0:a(void 0,i[E]):a(i[E],t[E])}function u(E){if(!Ta.isUndefined(t[E]))return a(void 0,t[E])}function h(E){return Ta.isUndefined(t[E])?Ta.isUndefined(i[E])?void 0:a(void 0,i[E]):a(void 0,t[E])}function f(E){return E in t?a(i[E],t[E]):E in i?a(void 0,i[E]):void 0}var v={url:u,method:u,data:u,baseURL:h,transformRequest:h,transformResponse:h,paramsSerializer:h,timeout:h,timeoutMessage:h,withCredentials:h,adapter:h,responseType:h,xsrfCookieName:h,xsrfHeaderName:h,onUploadProgress:h,onDownloadProgress:h,decompress:h,maxContentLength:h,maxBodyLength:h,beforeRedirect:h,transport:h,httpAgent:h,httpsAgent:h,cancelToken:h,socketPath:h,responseEncoding:h,validateStatus:f};return Ta.forEach(Object.keys(i).concat(Object.keys(t)),function(E){var y=v[E]||l,C=y(E);Ta.isUndefined(C)&&y!==f||(r[E]=C)}),r};function D2(){return N2?x2:(N2=1,x2={version:"0.27.2"})}var MZ=D2().version,Ml=Ih(),Gb={};["object","boolean","number","function","string","symbol"].forEach(function(i,t){Gb[i]=function(r){return typeof r===i||"a"+(t<1?"n ":" ")+i}});var k2={};Gb.transitional=function(i,t,r){function a(l,u){return"[Axios v"+MZ+"] Transitional option '"+l+"'"+u+(r?". "+r:"")}return function(l,u,h){if(i===!1)throw new Ml(a(u," has been removed"+(t?" in "+t:"")),Ml.ERR_DEPRECATED);return t&&!k2[u]&&(k2[u]=!0,console.warn(a(u," has been deprecated since v"+t+" and will be removed in the near future"))),!i||i(l,u,h)}};var L2,M2,F2,U2,B2,j2,FZ={assertOptions:function(i,t,r){if(typeof i!="object")throw new Ml("options must be an object",Ml.ERR_BAD_OPTION_VALUE);for(var a=Object.keys(i),l=a.length;l-- >0;){var u=a[l],h=t[u];if(h){var f=i[u],v=f===void 0||h(f,u,i);if(v!==!0)throw new Ml("option "+u+" must be "+v,Ml.ERR_BAD_OPTION_VALUE)}else if(r!==!0)throw new Ml("Unknown option "+u,Ml.ERR_BAD_OPTION)}},validators:Gb},V2=Qi,UZ=n2,$2=EZ,H2=function(i){return zb(i),i.headers=i.headers||{},i.data=Wb.call(i,i.data,i.headers,i.transformRequest),i.headers=O2.merge(i.headers.common||{},i.headers[i.method]||{},i.headers),O2.forEach(["delete","get","head","post","put","patch","common"],function(t){delete i.headers[t]}),(i.adapter||kZ.adapter)(i).then(function(t){return zb(i),t.data=Wb.call(i,t.data,t.headers,i.transformResponse),t},function(t){return DZ(t)||(zb(i),t&&t.response&&(t.response.data=Wb.call(i,t.response.data,t.response.headers,i.transformResponse))),Promise.reject(t)})},ov=P2,BZ=S2,W2=FZ,Ah=W2.validators;function Oh(i){this.defaults=i,this.interceptors={request:new $2,response:new $2}}Oh.prototype.request=function(i,t){typeof i=="string"?(t=t||{}).url=i:t=i||{},(t=ov(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var r=t.transitional;r!==void 0&&W2.assertOptions(r,{silentJSONParsing:Ah.transitional(Ah.boolean),forcedJSONParsing:Ah.transitional(Ah.boolean),clarifyTimeoutError:Ah.transitional(Ah.boolean)},!1);var a=[],l=!0;this.interceptors.request.forEach(function(C){typeof C.runWhen=="function"&&C.runWhen(t)===!1||(l=l&&C.synchronous,a.unshift(C.fulfilled,C.rejected))});var u,h=[];if(this.interceptors.response.forEach(function(C){h.push(C.fulfilled,C.rejected)}),!l){var f=[H2,void 0];for(Array.prototype.unshift.apply(f,a),f=f.concat(h),u=Promise.resolve(t);f.length;)u=u.then(f.shift(),f.shift());return u}for(var v=t;a.length;){var E=a.shift(),y=a.shift();try{v=E(v)}catch(C){y(C);break}}try{u=H2(v)}catch(C){return Promise.reject(C)}for(;h.length;)u=u.then(h.shift(),h.shift());return u},Oh.prototype.getUri=function(i){i=ov(this.defaults,i);var t=BZ(i.baseURL,i.url);return UZ(t,i.params,i.paramsSerializer)},V2.forEach(["delete","get","head","options"],function(i){Oh.prototype[i]=function(t,r){return this.request(ov(r||{},{method:i,url:t,data:(r||{}).data}))}}),V2.forEach(["post","put","patch"],function(i){function t(r){return function(a,l,u){return this.request(ov(u||{},{method:i,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}Oh.prototype[i]=t(),Oh.prototype[i+"Form"]=t(!0)});var z2=Qi,jZ=Qk,av=Oh,VZ=P2,Jo=function i(t){var r=new av(t),a=jZ(av.prototype.request,r);return z2.extend(a,av.prototype,r),z2.extend(a,r),a.create=function(l){return i(VZ(t,l))},a}(Hb);Jo.Axios=av,Jo.CanceledError=rv(),Jo.CancelToken=function(){if(M2)return L2;M2=1;var i=rv();function t(r){if(typeof r!="function")throw new TypeError("executor must be a function.");var a;this.promise=new Promise(function(u){a=u});var l=this;this.promise.then(function(u){if(l._listeners){var h,f=l._listeners.length;for(h=0;h<f;h++)l._listeners[h](u);l._listeners=null}}),this.promise.then=function(u){var h,f=new Promise(function(v){l.subscribe(v),h=v}).then(u);return f.cancel=function(){l.unsubscribe(h)},f},r(function(u){l.reason||(l.reason=new i(u),a(l.reason))})}return t.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},t.prototype.subscribe=function(r){this.reason?r(this.reason):this._listeners?this._listeners.push(r):this._listeners=[r]},t.prototype.unsubscribe=function(r){if(this._listeners){var a=this._listeners.indexOf(r);a!==-1&&this._listeners.splice(a,1)}},t.source=function(){var r;return{token:new t(function(a){r=a}),cancel:r}},L2=t}(),Jo.isCancel=A2(),Jo.VERSION=D2().version,Jo.toFormData=u2(),Jo.AxiosError=Ih(),Jo.Cancel=Jo.CanceledError,Jo.all=function(i){return Promise.all(i)},Jo.spread=U2?F2:(U2=1,F2=function(i){return function(t){return i.apply(null,t)}}),Jo.isAxiosError=function(){if(j2)return B2;j2=1;var i=Qi;return B2=function(t){return i.isObject(t)&&t.isAxiosError===!0}}(),Pb.exports=Jo,Pb.exports.default=Jo;var go=it(Pb.exports);function G2(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function K2(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G2(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):G2(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}let sv,cv=0,Kb=0;function qb(i,t,r,a){return new me((l,u)=>{t.responseType=t.responseType||"json",t.data&&!r?(t.data=JSON.stringify(t.data),cv+=mc(t.data)):r&&(t.data.size?cv+=t.data.size:t.data instanceof FormData?cv+=Kk(t.data):cv+=mc(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=i,go.request(t).then(h=>{typeof h.data=="string"?Kb+=mc(h.data):h.data instanceof ArrayBuffer||h.data instanceof Uint8Array?Kb+=h.data.byteLength:Kb+=mc(JSON.stringify(h.data)),a&&l({data:h.data,headers:h.headers}),l(h.data)}).catch(h=>{go.isCancel(h)?u(new be(G.OPERATION_ABORTED,"cancel token canceled")):h.code==="ECONNABORTED"?u(new be(G.NETWORK_TIMEOUT,h.message)):h.response?u(new be(G.NETWORK_RESPONSE_ERROR,h.response.status)):u(new be(G.NETWORK_ERROR,h.message))})})}async function $Z(i,t){const r=new Blob([t.data],{type:"buffer"});return await qb(i,K2(K2({},t),{},{data:r,headers:{"Content-Type":"application/octet-stream"}}),!0)}const HZ=()=>(sv||sv||(sv=(window.location.protocol.split(":")[0]||"").toUpperCase(),sv))==="HTTPS",q2=()=>window.isSecureContext!==void 0;function Y2(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function Ge(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y2(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):Y2(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}var Pt;(function(i){i.SET_SESSION_ID="SET_SESSION_ID",i.SET_P2P_ID="SET_P2P_id",i.SET_DC_ID="SET_DC_id",i.SET_UID="SET_UID",i.SET_PUB_ID="SET_PUB_ID",i.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",i.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",i.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",i.AVOID_JOIN_START="AVOID_JOIN_START",i.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",i.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",i.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",i.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",i.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",i.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",i.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",i.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",i.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",i.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",i.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",i.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",i.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",i.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",i.RESET_KEY_METRICS="RESET_KEY_METRICS",i.SET_USE_DATACHANNEL="SET_USE_DATACHANNEL",i.SET_USE_P2P="SET_USE_P2P"})(Pt||(Pt={}));class WZ{constructor(t,r,a,l){w(this,"state",void 0),this.state={codec:t,audioCodec:r,mode:a,clientId:l,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useDataChannel:!1,useP2P:!1}}dispatch(t){this.state=function(r,a){switch(a.type){case Pt.SET_SESSION_ID:return Ge(Ge({},r),{},{sessionId:a.sessionId});case Pt.SET_P2P_ID:return Ge(Ge({},r),{},{p2pId:a.p2pId});case Pt.SET_UID:return Ge(Ge({},r),{},{uid:a.uid});case Pt.SET_PUB_ID:return Ge(Ge({},r),{},{pubId:a.pubId});case Pt.KEY_METRIC_CLIENT_CREATED:return Ge(Ge({},r),{},{keyMetrics:Ge(Ge({},r.keyMetrics),{},{clientCreated:a.metric})});case Pt.KEY_METRIC_JOIN_START:return Ge(Ge({},r),{},{keyMetrics:Ge(Ge({},r.keyMetrics),{},{joinStart:a.metric})});case Pt.AVOID_JOIN_START:return Ge(Ge({},r),{},{avoidJoinStart:a.avoidJoinStart});case Pt.KEY_METRIC_JOIN_END:return Ge(Ge({},r),{},{keyMetrics:Ge(Ge({},r.keyMetrics),{},{joinEnd:a.metric})});case Pt.KEY_METRIC_REQUEST_AP_START:return Ge(Ge({},r),{},{keyMetrics:Ge(Ge({},r.keyMetrics),{},{requestAPStart:a.metric})});case Pt.KEY_METRIC_REQUEST_AP_END:return Ge(Ge({},r),{},{keyMetrics:Ge(Ge({},r.keyMetrics),{},{requestAPEnd:a.metric})});case Pt.KEY_METRIC_JOIN_GATEWAY_START:return Ge(Ge({},r),{},{keyMetrics:Ge(Ge({},r.keyMetrics),{},{joinGatewayStart:a.metric})});case Pt.KEY_METRIC_JOIN_GATEWAY_END:return Ge(Ge({},r),{},{keyMetrics:Ge(Ge({},r.keyMetrics),{},{joinGatewayEnd:a.metric})});case Pt.KEY_METRIC_PEER_CONNECTION_START:return Ge(Ge({},r),{},{keyMetrics:Ge(Ge({},r.keyMetrics),{},{peerConnectionStart:a.metric})});case Pt.KEY_METRIC_PEER_CONNECTION_END:return Ge(Ge({},r),{},{keyMetrics:Ge(Ge({},r.keyMetrics),{},{peerConnectionEnd:a.metric})});case Pt.KEY_METRIC_DESCRIPTION_START:return Ge(Ge({},r),{},{keyMetrics:Ge(Ge({},r.keyMetrics),{},{descriptionStart:a.metric})});case Pt.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return Ge(Ge({},r),{},{keyMetrics:Ge(Ge({},r.keyMetrics),{},{signalChannelOpen:a.metric})});case Pt.KEY_METRIC_ICE_CONNECTION_END:return Ge(Ge({},r),{},{keyMetrics:Ge(Ge({},r.keyMetrics),{},{iceConnectionEnd:a.metric})});case Pt.KEY_METRIC_PUBLISH:{const l=r.keyMetrics.publish,u=l.findIndex(h=>h.trackId===a.metric.trackId);return u!==-1?(l[u]=Ge(Ge({},l[u]),a.metric),Ge(Ge({},r),{},{keyMetrics:Ge(Ge({},r.keyMetrics),{},{publish:[...l]})})):Ge(Ge({},r),{},{keyMetrics:Ge(Ge({},r.keyMetrics),{},{publish:[...r.keyMetrics.publish,a.metric]})})}case Pt.KEY_METRIC_SUBSCRIBE:{const l=r.keyMetrics.subscribe,u=l.findIndex(h=>h.userId===a.metric.userId&&h.type===a.metric.type);return u!==-1?(l[u]=Ge(Ge({},l[u]),a.metric),Ge(Ge({},r),{},{keyMetrics:Ge(Ge({},r.keyMetrics),{},{subscribe:[...l]})})):Ge(Ge({},r),{},{keyMetrics:Ge(Ge({},r.keyMetrics),{},{subscribe:[...r.keyMetrics.subscribe,a.metric]})})}case Pt.SET_CLOUD_PROXY_SERVER_MODE:return r.cloudProxyServerMode=a.mode,r;case Pt.RECORD_JOIN_CHANNEL_SERVICE:return typeof a.index!="number"?r.joinChannelServiceRecords=[...r.joinChannelServiceRecords,a.record]:(r.joinChannelServiceRecords[a.index]=Ge(Ge({},r.joinChannelServiceRecords[a.index]),a.record),r.joinChannelServiceRecords=[...r.joinChannelServiceRecords]),r;case Pt.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return r.joinChannelServiceRecords=[],r;case Pt.RESET_KEY_METRICS:return r.keyMetrics={publish:[],subscribe:[]},r;case Pt.SET_USE_DATACHANNEL:return Ge(Ge({},r),{},{useDataChannel:a.val});case Pt.SET_USE_P2P:return Ge(Ge({},r),{},{useP2P:a.val});default:return r}}(this.state,t)}set sessionId(t){this.dispatch({type:Pt.SET_SESSION_ID,sessionId:t})}get sessionId(){return this.state.sessionId}get codec(){return this.state.codec}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(t){this.dispatch({type:Pt.SET_P2P_ID,p2pId:t})}get p2pId(){return this.state.p2pId}set dcId(t){this.dispatch({type:Pt.SET_DC_ID,dcId:t})}get dcId(){return this.state.dcId}set uid(t){this.dispatch({type:Pt.SET_UID,uid:t})}get uid(){return this.state.uid}set pubId(t){this.dispatch({type:Pt.SET_PUB_ID,pubId:t})}get pubId(){return this.state.pubId}set cloudProxyServerMode(t){this.dispatch({type:Pt.SET_CLOUD_PROXY_SERVER_MODE,mode:t})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useDataChannel(t){this.dispatch({type:Pt.SET_USE_DATACHANNEL,val:t})}get useDataChannel(){return this.state.useDataChannel}set useP2P(t){this.dispatch({type:Pt.SET_USE_P2P,val:t})}get useP2P(){return this.state.useP2P}clientCreated(){this.dispatch({type:Pt.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:Pt.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:Pt.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:Pt.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:Pt.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:Pt.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:Pt.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:Pt.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:Pt.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:Pt.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:Pt.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:Pt.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(t,r,a,l){this.dispatch({type:Pt.KEY_METRIC_PUBLISH,metric:Ge(Ge({trackId:t,type:r},a&&{publishStart:a}),l&&{publishEnd:l})})}subscribe(t,r,a,l,u,h,f){this.dispatch({type:Pt.KEY_METRIC_SUBSCRIBE,metric:Ge(Ge(Ge(Ge(Ge({userId:t,type:r},a&&{subscribeStart:a}),l&&{subscribeEnd:l}),u&&{firstFrame:u}),h&&{streamAdded:h}),f&&{firstDecoded:f})})}massSubscribe(t,r,a,l){t.forEach(u=>{this.dispatch({type:Pt.KEY_METRIC_SUBSCRIBE,metric:Ge(Ge(Ge({userId:u.userId,type:u.type},r&&{subscribeStart:r}),a&&{subscribeEnd:a}),l&&{firstFrame:l})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(t,r){t.service==="gateway"&&Array.isArray(t.urls)&&(t.urls=t.urls.map(a=>a.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof r!="number"?(this.dispatch({type:Pt.RECORD_JOIN_CHANNEL_SERVICE,record:Ge(Ge({},t),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(r<0||r>=this.state.joinChannelServiceRecords.length||this.dispatch({type:Pt.RECORD_JOIN_CHANNEL_SERVICE,record:t,index:r}),r)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:Pt.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:Pt.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}get avoidJoinStart(){return this.state.avoidJoinStart}set avoidJoinStart(t){this.dispatch({type:Pt.AVOID_JOIN_START,avoidJoinStart:t})}}const Ra=function(i){if(i.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return i;const t=i.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(t&&t[1]&&t[2]){const a=t[1],l=t[2];return"".concat(a,".").concat(l)}const r=i.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/);if(r&&r[1]&&r[2]){const a=r[1],l=r[2];return"".concat(a,".").concat(100*(Number(l)+1))}return"4.0.0.999"}("4.19.2"),Yb=function(){try{return JSON.parse("true")===!0}catch{return!0}}(),Xb="v4.19.2-0-g791c0f00(10/18/2023, 4:17:50 PM)",$i={PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",ENABLE_EVENT_REPORT:!0,GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],SUBSCRIBE_TWCC:!1,PUBLISH_TWCC:!1,PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,USE_PUB_RTX:!1,USE_SUB_RTX:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:100,PROFILE_SWITCH_INTERVAL:2e3,ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!0,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,DISABLE_FEC:void 0,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,ICE_RESTART_INTERVAL:1e4,NEW_ICE_RESTART:!1,ENABLE_USER_LICENSE_CHECK:!0,SIGNAL_CHANNEL:0,TRANSMITTER_INITIAL_RTT:30,TRANSMITTER_INITIAL_RTO:30,TRANSMITTER_MAX_BATCH_ACK_COUNT:2,TRANSMITTER_MAX_RTO:500,DATACHANNEL_COMPRESS:!1,FINGERPRINT:null,DC_JOIN_WITH_FAILBACK:5e3,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,AP_AREA:!0,SVC:[],ENABLE_ENCODED_TRANSFORM:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,RTM2_FLAG:void 0,AP_RTM:!1,ENABLE_DATASTREAM_2:!1,DATASTREAM_MAX_RETRANSMITS:10,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_INSTANT_VIDEO:!1,ENABLE_NTP_REPORT:!1,USE_XR:!1,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:1e4,P2P:!1,SHOW_P2P_LOG:!1,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[]};function an(i,t,r){var a,l;Ke(a=Object.keys($i)).call(a,i)&&(!r&&Ke(l=Object.keys(Fl)).call(l,i)||($i[i]=t))}function Z(i){return $i[i]}const Fl={};var ed,X2;(function(i){i.h264="h264",i.h265="h265",i.vp8="vp8",i.vp9="vp9",i.av1="av1"})(ed||(ed={})),function(i){i.opus="opus",i.pcma="pcma",i.pcmu="pcmu",i.g722="g722"}(X2||(X2={}));const lv=new class extends An{reportLogUploadError(i){this.emit("REPORT_LOG_UPLOAD",i)}};class zZ{constructor(t){w(this,"logger",void 0),w(this,"prefixLists",[]),this.logger=t}debug(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];this.logger.debug(...this.prefixLists,...r)}info(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];this.logger.info(...this.prefixLists,...r)}warning(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];this.logger.warning(...this.prefixLists,...r)}error(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];this.logger.error(...this.prefixLists,...r)}prefix(t){return this.prefixLists.push(t),this}popPrefix(){return this.prefixLists.pop(),this}}function Jb(){const i=new Date;return i.toTimeString().split(" ")[0]+":"+i.getMilliseconds()}function J2(){const i=new Date,t=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return t?(t==null?void 0:t[0])+":"+i.getUTCMilliseconds():i.toTimeString().split(" ")[0]+":"+i.getMilliseconds()}const wa={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},uv=Date.now(),Wf=i=>{for(const t in wa)if(Object.prototype.hasOwnProperty.call(wa,t)&&wa[t]===i)return t;return"DEFAULT"},L=new class{constructor(){w(this,"proxyServerURL",void 0),w(this,"logLevel",wa.DEBUG),w(this,"uploadState","collecting"),w(this,"uploadLogWaitingList",[]),w(this,"uploadLogUploadingList",[]),w(this,"uploadErrorCount",0),w(this,"currentLogID",0),w(this,"url",void 0),w(this,"extLog",(i,t)=>{this.appendLogToWaitingList(i,...t)})}debug(){for(var i=arguments.length,t=new Array(i),r=0;r<i;r++)t[r]=arguments[r];const a=[wa.DEBUG].concat(t);this.log.apply(this,a)}info(){for(var i=arguments.length,t=new Array(i),r=0;r<i;r++)t[r]=arguments[r];const a=[wa.INFO].concat(t);this.log.apply(this,a)}warning(){for(var i=arguments.length,t=new Array(i),r=0;r<i;r++)t[r]=arguments[r];const a=[wa.WARNING].concat(t);this.log.apply(this,a)}warn(){this.warning(...arguments)}error(){for(var i=arguments.length,t=new Array(i),r=0;r<i;r++)t[r]=arguments[r];const a=[wa.ERROR].concat(t);this.log.apply(this,a)}upload(){for(var i=arguments.length,t=new Array(i),r=0;r<i;r++)t[r]=arguments[r];const a=[wa.DEBUG].concat(t);this.uploadLog.apply(this,a)}setLogLevel(i){i=Math.min(Math.max(0,i),4),this.logLevel=i}enableLogUpload(){an("UPLOAD_LOG",!0)}disableLogUpload(){an("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(i){this.proxyServerURL=i}prefix(i){return new zZ(this).prefix(i)}log(){for(var i=arguments.length,t=new Array(i),r=0;r<i;r++)t[r]=arguments[r];if(Date.now()-uv<100)return void setTimeout(()=>{this.log(...t)},Date.now()-uv);const a=Math.max(0,Math.min(4,t[0]));if(t[0]=Jb()+" Agora-SDK [".concat(Wf(a),"]:"),this.appendLogToWaitingList(a,...t),a<this.logLevel)return;const l=Jb()+" %cAgora-SDK [".concat(Wf(a),"]:");let u=[];if(!Z("USE_NEW_LOG"))switch(a){case wa.DEBUG:u=[l,"color: #64B5F6;"].concat(t.slice(1)),console.log.apply(console,u);break;case wa.INFO:u=[l,"color: #1E88E5; font-weight: bold;"].concat(t.slice(1)),console.log.apply(console,u);break;case wa.WARNING:u=[l,"color: #FB8C00; font-weight: bold;"].concat(t.slice(1)),console.warn.apply(console,u);break;case wa.ERROR:u=[l,"color: #B00020; font-weight: bold;"].concat(t.slice(1)),console.error.apply(console,u)}}uploadLog(){for(var i=arguments.length,t=new Array(i),r=0;r<i;r++)t[r]=arguments[r];if(Date.now()-uv<100)return void setTimeout(()=>{this.uploadLog(...t)},Date.now()-uv);const a=Math.max(0,Math.min(4,t[0]));t[0]=Jb()+" Agora-SDK [".concat(Wf(a),"]:"),this.appendLogToWaitingList(a,...t)}appendLogToWaitingList(i){if(!Z("UPLOAD_LOG"))return;for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];Array.isArray(r[0])?r[0][0]=J2()+" Agora-SDK [".concat(Wf(i),"]:"):r[0]=J2()+" Agora-SDK [".concat(Wf(i),"]:");let l="";r.forEach(u=>{typeof u=="object"&&(u=JSON.stringify(u)),l+="".concat(u," ")}),this.uploadLogWaitingList.push({payload_str:l,log_level:i,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const i=this.uploadLogUploadingList,t={sdk_version:Ra,process_id:Z("PROCESS_ID"),payload:JSON.stringify(i)};return Ls(async()=>{const r=await go.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(Z("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(Z("LOG_UPLOAD_SERVER"),"/upload/v1")),t,{responseType:"text"});if(r.data!=="OK"){const a=new Error("unexpected upload log response");throw a.response=r,a}},()=>(this.uploadLogUploadingList=[],!1),r=>(r.response?lv.reportLogUploadError({status:r.response.status,data:r.response.data,headers:r.response.headers,message:r.message}):r.request?lv.reportLogUploadError({status:r.request.status,message:r.message}):lv.reportLogUploadError({status:-1,message:r.message}),!0),{timeout:Z("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:Z("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,Z("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),Z("UPLOAD_LOG_INTERVAL"))}).catch(i=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),Z("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),Z("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}};var Q2,Z2;function GZ(i){return di(i.reportId,"params.reportId",0,100,!1),di(i.category,"params.category",0,100,!1),di(i.event,"params.event",0,100,!1),di(i.label,"params.label",0,100,!1),cn(i.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(function(i){i.FREE="free",i.UPLOADING="uploading"})(Q2||(Q2={})),function(i){i[i.MISC=0]="MISC",i[i.INTERNAL_EVENT=1]="INTERNAL_EVENT",i[i.PUBLIC_EVENT=2]="PUBLIC_EVENT",i[i.WEB_EVENT=3]="WEB_EVENT",i[i.INTERNAL_API=4]="INTERNAL_API",i[i.WEB_API=5]="WEB_API",i[i.PUBLIC_API=6]="PUBLIC_API"}(Z2||(Z2={}));const KZ={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};var Ar,On,eL,tL;function nL(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function Rt(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nL(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):nL(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}(function(i){i.PUBLISH="publish",i.SUBSCRIBE="subscribe",i.WS_COMPRESSOR_INIT="ws_compressor_init",i.SESSION_INIT="session_init",i.JOIN_CHOOSE_SERVER="join_choose_server",i.REQ_USER_ACCOUNT="req_user_account",i.JOIN_GATEWAY="join_gateway",i.REJOIN_GATEWAY="rejoin_gateway",i.STREAM_SWITCH="stream_switch",i.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",i.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",i.FIRST_VIDEO_RECEIVED="first_video_received",i.FIRST_AUDIO_RECEIVED="first_audio_received",i.FIRST_VIDEO_DECODE="first_video_decode",i.FIRST_AUDIO_DECODE="first_audio_decode",i.ON_ADD_AUDIO_STREAM="on_add_audio_stream",i.ON_ADD_VIDEO_STREAM="on_add_video_stream",i.ON_UPDATE_STREAM="on_update_stream",i.ON_REMOVE_STREAM="on_remove_stream",i.USER_ANALYTICS="req_user_analytics",i.PC_STATS="pc_stats"})(Ar||(Ar={})),function(i){i.SESSION="io.agora.pb.Wrtc.Session",i.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",i.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",i.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",i.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",i.PUBLISH="io.agora.pb.Wrtc.Publish",i.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",i.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",i.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",i.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",i.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",i.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",i.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",i.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",i.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",i.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",i.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",i.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",i.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",i.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",i.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",i.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",i.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",i.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",i.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",i.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",i.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",i.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",i.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",i.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",i.PC_STATS="io.agora.pb.Wrtc.PCStats"}(On||(On={})),function(i){i[i.WORKER_EVENT=156]="WORKER_EVENT",i[i.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}(eL||(eL={})),function(i){i[i.SESSION=26]="SESSION",i[i.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",i[i.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",i[i.JOIN_GATEWAY=28]="JOIN_GATEWAY",i[i.PUBLISH=30]="PUBLISH",i[i.SUBSCRIBE=29]="SUBSCRIBE",i[i.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",i[i.STREAM_SWITCH=32]="STREAM_SWITCH",i[i.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",i[i.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",i[i.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",i[i.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",i[i.API_INVOKE=41]="API_INVOKE",i[i.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",i[i.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",i[i.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",i[i.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",i[i.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",i[i.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",i[i.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",i[i.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",i[i.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",i[i.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",i[i.WORKER_EVENT=156]="WORKER_EVENT",i[i.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",i[i.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",i[i.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",i[i.USER_ANALYTICS=1e4]="USER_ANALYTICS",i[i.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED"}(tL||(tL={}));class zf{constructor(){w(this,"baseInfoMap",new Map),w(this,"proxyServer",void 0),w(this,"eventUploadTimer",void 0),w(this,"setSessionIdTimer",void 0),w(this,"url",void 0),w(this,"backupUrl",void 0),w(this,"_appId",void 0),w(this,"keyEventUploadPendingItems",[]),w(this,"normalEventUploadPendingItems",[]),w(this,"apiInvokeUploadPendingItems",[]),w(this,"apiInvokeCount",0),w(this,"ltsList",[]),w(this,"lastSendNormalEventTime",Date.now()),w(this,"customReportCounterTimer",void 0),w(this,"customReportCount",0),w(this,"extApiInvoke",async t=>{for(const r of t){const a=Rt(Rt({},r),{},{sid:null,invokeId:++this.apiInvokeCount,tag:Dn.TRACER});this.sendApiInvoke(a)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),Z("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),Z("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(t){return this.baseInfoMap.get(t)}adjustSessionStartTime(t){if(!this.baseInfoMap.has(t)&&!this.baseInfoMap.get(t))return void L.error("adjust session ".concat(t," start time, sid is not exist or info is undefined"));const r=this.baseInfoMap.get(t),a=Date.now(),l=r.startTime;r.startTime=a,L.debug("rewrite session ".concat(t," startTime: ").concat(a," , ").concat(a-l,"ms")),this.baseInfoMap.set(t,r)}setAppId(t){this._appId=t}reportApiInvoke(t,r,a){r.timeout=r.timeout||6e4,r.reportResult=r.reportResult===void 0||r.reportResult;const l=Date.now();this.apiInvokeCount+=1;const u=this.apiInvokeCount,h=()=>({tag:r.tag,invokeId:u,sid:t,name:r.name,apiInvokeTime:l,options:r.options,states:r.states||null}),f=!!Z("SHOW_REPORT_INVOKER_LOG");f&&L.info("".concat(r.name," start"),r.options);let v=!1;ni(r.timeout).then(()=>{v||(this.sendApiInvoke(Rt(Rt({},h()),{},{error:G.API_INVOKE_TIMEOUT,success:!1})),L.debug("".concat(r.name," timeout")))});const E=new be(G.UNEXPECTED_ERROR,"".concat(r.name,": this api invoke is end"));return{onSuccess:y=>{const C=()=>{if(v)throw E;return v=!0,this.sendApiInvoke(Rt(Rt({},h()),{},{success:!0},r.reportResult&&{result:y})),f&&L.info("".concat(r.name," onSuccess")),y};return a?Yk(C,r.name+"Success",a,()=>v=!0):C()},onError:y=>{const C=()=>{if(v)throw y;v=!0,this.sendApiInvoke(Rt(Rt({},h()),{},{success:!1,error:y})),f&&L.info("".concat(r.name," onFailure"),y.toString())};return a?Yk(C,r.name+"Error",a,()=>v=!0):C()}}}sessionInit(t,r){if(this.baseInfoMap.has(t))return;const a=Date.now(),l=this.createBaseInfo(t,a);l.cname=r.cname;const u=Object.assign({},{willUploadConsoleLog:Z("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:Yb?"global":"oversea",areas:Z("AREAS")&&Z("AREAS").join(",")},r.extend),h=Date.now(),f=Rt(Rt({},l),{},{eventType:Ar.SESSION_INIT,appid:r.appid,browser:navigator.userAgent,build:Xb,lts:h,elapse:h-a,extend:JSON.stringify(u),mode:r.mode,process:Z("PROCESS_ID"),appType:Z("APP_TYPE"),success:!0,version:Ra});this.send({type:On.SESSION,data:f},!0)}joinChooseServer(t,r){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Rt(Rt({},l),{},{eventType:Ar.JOIN_CHOOSE_SERVER,lts:u,eventElapse:u-r.lts,chooseServerAddr:r.csAddr,errorCode:r.ec,elapse:u-a.startTime,success:r.succ,chooseServerAddrList:JSON.stringify(r.serverList),uid:r.uid?parseInt(r.uid):null,cid:r.cid?parseInt(r.cid):null,chooseServerIp:r.csIp||"",opid:r.opid,unilbsServerIds:r.unilbsServerIds,extend:r.extend||void 0,isHttp3:r.isHttp3});this.send({type:On.JOIN_CHOOSE_SERVER,data:h},!0)}reqUserAccount(t,r){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Rt(Rt({},l),{},{eventType:Ar.REQ_USER_ACCOUNT,lts:u,success:r.success,serverAddress:r.serverAddr,stringUid:r.stringUid,uid:r.uid,errorCode:r.errorCode,elapse:u-a.startTime,eventElapse:u-r.lts,extend:JSON.stringify(r.extend)});this.send({type:On.REQ_USER_ACCOUNT,data:h},!0)}joinGateway(t,r){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info;r.vid&&(l.vid=r.vid),l.uid=r.uid,l.cid=r.cid;const u=Date.now(),{firstSuccess:h,avoidJoinStartTime:f,isProxy:v,addr:E}=r,y=u-(h&&f?f:a.startTime),C=Rt(Rt({},l),{},{eventType:Ar.JOIN_GATEWAY,lts:u,gatewayAddr:r.addr,success:r.succ,errorCode:r.ec,elapse:y,eventElapse:u-r.lts,firstSuccess:h,signalChannel:r.signalChannel}),I=C.success?1:0;if(r.succ&&(a.lastJoinSuccessTime=u),h)this.send({type:On.JOIN_GATEWAY,data:C},!0);else{let k;if(E)if(v){const $=E.match(/h=(\d{1,3}-){3}\d{1,3}/g),z=E.match(/p=[0-9]{1,6}/g);k={isSuccess:I,gatewayIp:$&&$.length?$[0].split("=")[1].replace(/-/g,"."):"",port:z&&z.length?z[0].split("=")[1]:"",isProxy:v?1:0}}else{const $=E.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),z=E.match(/(:|p=)[0-9]{1,6}/g);k={isSuccess:I,gatewayIp:$&&$.length?$[0].split("//")[1].replace(/-/g,"."):"",port:z&&z.length?z[0].split(/:|p=/g)[1]:"",isProxy:v?1:0}}else k={isSuccess:I,gatewayIp:"",port:"",isProxy:v?1:0};delete C.success,delete C.eventType,delete C.firstSuccess,C.vid=Number(C.vid);const W=Object.assign({},C,k,{eventType:Ar.REJOIN_GATEWAY});this.send({type:On.RE_JOIN_GATEWAY,data:W},!0)}}joinChannelTimeout(t,r){const a=this.baseInfoMap.get(t);if(!a)return;const l=Date.now(),u=Rt(Rt({},a.info),{},{lts:l,timeout:r,elapse:l-a.startTime});this.send({type:On.JOIN_CHANNEL_TIMEOUT,data:u},!0)}publish(t,r){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Rt(Rt({},l),{},{eventType:Ar.PUBLISH,lts:u,eventElapse:r.eventElapse,elapse:u-a.startTime,success:r.succ,errorCode:r.ec,videoName:r.videoName,audioName:r.audioName,screenName:r.screenName,screenshare:r.screenshare,audio:r.audio,video:r.video,p2pid:r.p2pid,publishRequestid:r.publishRequestid});this.send({type:On.PUBLISH,data:h},!0)}subscribe(t,r,a){const l=this.baseInfoMap.get(t);if(!l)return;const u=l.info,h=Date.now(),f=Rt(Rt({},u),{},{eventType:Ar.SUBSCRIBE,lts:h,eventElapse:r.eventElapse,elapse:h-l.startTime,success:r.succ,errorCode:r.ec,video:r.video,audio:r.audio,subscribeRequestid:r.subscribeRequestid,p2pid:r.p2pid},a&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof r.peerid=="string"?f.peerSuid=r.peerid:f.peer=r.peerid,this.send({type:On.SUBSCRIBE,data:f},!0)}wsCompressorInit(t){var r;const a=[...Xo(r=this.baseInfoMap).call(r)],l=a.length?a[0]:"UnableToGetSid",u=this.baseInfoMap.get(l);if(!u)return;const h=u.info,f=Date.now(),v=Rt(Rt({},h),{},{eventType:Ar.WS_COMPRESSOR_INIT,lts:f,eventElapse:t.eventElapse,elapse:f-u.startTime,status:t.status?1:2});this.send({type:On.WS_COMPRESSOR_INIT,data:v},!0)}firstRemoteVideoDecode(t,r,a,l){const u=this.baseInfoMap.get(t);if(!u)return;const h=u.info,f=Date.now(),v=Rt(Rt(Rt({},h),l),{},{elapse:f-u.startTime,eventType:r,lts:f,firstDecodeFrame:Math.max(f-u.startTime,0),apEnd:Math.max(l.apEnd-u.startTime,0),apStart:Math.max(l.apStart-u.startTime,0),joinGwEnd:Math.max(l.joinGwEnd-u.startTime,0),joinGwStart:Math.max(l.joinGwStart-u.startTime,0),pcEnd:Math.max(l.pcEnd-u.startTime,0),pcStart:Math.max(l.pcStart-u.startTime,0),subscriberEnd:Math.max(l.subscriberEnd-u.startTime,0),subscriberStart:Math.max(l.subscriberStart-u.startTime,0),videoAddNotify:Math.max(l.videoAddNotify-u.startTime,0)});this.send({type:a,data:v},!0)}firstRemoteFrame(t,r,a,l){const u=this.baseInfoMap.get(t);if(!u)return;const h=u.info,f=Date.now(),v=Rt(Rt(Rt({},h),l),{},{elapse:f-u.startTime,eventType:r,lts:f});this.send({type:a,data:v},!0)}pcStats(t,r){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Rt(Rt(Rt({},l),r),{},{vid:l.vid===void 0?0:Number(l.vid),elapse:u-a.startTime,eventType:Ar.PC_STATS,lts:u});this.send({type:On.PC_STATS,data:h},!0)}updateRemoteRTPCapabilities(t,r){this.reportApiInvoke(t,{name:"Client.updateRemoteRTPCapabilities",options:r,tag:Dn.TRACER}).onSuccess()}onGatewayStream(t,r,a,l){const u=this.baseInfoMap.get(t);if(!u)return;const h=u.info,f=Date.now(),v=Rt(Rt(Rt({},h),l),{},{eventType:r,lts:f});this.send({type:a,data:v},!0)}streamSwitch(t,r){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Rt(Rt({},l),{},{eventType:Ar.STREAM_SWITCH,lts:u,isDual:r.isdual,elapse:u-a.startTime,success:r.succ});this.send({type:On.STREAM_SWITCH,data:h},!0)}requestProxyAppCenter(t,r){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Rt(Rt({},l),{},{eventType:Ar.REQUEST_PROXY_APPCENTER,lts:u,eventElapse:u-r.lts,elapse:u-a.startTime,APAddr:r.APAddr,workerManagerList:r.workerManagerList,response:r.response,errorCode:r.ec,success:r.succ});this.send({type:On.REQUEST_PROXY_APPCENTER,data:h},!0)}requestProxyWorkerManager(t,r){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Rt(Rt({},l),{},{eventType:Ar.REQUEST_PROXY_WORKER_MANAGER,lts:u,eventElapse:u-r.lts,elapse:u-a.startTime,workerManagerAddr:r.workerManagerAddr,response:r.response,errorCode:r.ec,success:r.succ});this.send({type:On.REQUEST_PROXY_WORKER_MANAGER,data:h},!0)}setProxyServer(t){this.proxyServer=t,t?L.debug("reportProxyServerurl: ".concat(t)):L.debug("disable reportProxyServerurl: ".concat(t))}peerPublishStatus(t,r){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Rt(Rt({},l),{},{subscribeElapse:r.subscribeElapse,peer:r.peer,peerPublishDuration:Math.max(r.audioPublishDuration,r.videoPublishDuration),audiotag:r.audioPublishDuration>0?1:-1,videotag:r.videoPublishDuration>0?1:-1,lts:u,elapse:u-a.startTime,joinChannelSuccessElapse:u-(a.lastJoinSuccessTime||u),peerPublishDurationVideo:r.videoPublishDuration,peerPublishDurationAudio:r.audioPublishDuration});this.send({type:On.PEER_PUBLISH_STATUS,data:h},!0)}workerEvent(t,r){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now();(function(f,v,E){const y=f[v];if(!y||typeof y!="string")return[f];f[v]="";const C=mc(JSON.stringify(f));let I=0;const k=[];let W=0;for(let $=0;$<y.length;$++)W+=y.charCodeAt($)<=127?1:3,W<=E-C||(k[k.length]=Xu(Xu({},f),{},{[v]:y.substring(I,$)}),I=$,W=y.charCodeAt($)<=127?1:3);return I!==y.length-1&&(k[k.length]=Xu(Xu({},f),{},{[v]:y.substring(I)})),k})(Rt(Rt(Rt({},l),r),{},{elapse:u-a.startTime,lts:u,productType:"WebRTC"}),"payload",1300).forEach(f=>this.send({type:On.WORKER_EVENT,data:f},!0))}apworkerEvent(t,r){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Rt(Rt(Rt({},l),r),{},{elapse:u-a.startTime,lts:u});this.send({type:On.AP_WORKER_EVENT,data:h},!0)}joinWebProxyAP(t,r){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Rt(Rt(Rt({},l),r),{},{elapse:u-a.startTime,lts:u,extend:r.extend||void 0});this.send({type:On.JOIN_WEB_PROXY_AP,data:h},!0)}WebSocketQuit(t,r){const a=this.baseInfoMap.get(t);if(!a)return;const l=a.info,u=Date.now(),h=Rt(Rt(Rt({},l),r),{},{elapse:u-a.startTime,lts:u});this.send({type:On.WEBSOCKET_QUIT,data:h},!0)}async sendCustomReportMessage(t,r){if(this.customReportCount+=r.length,this.customReportCount>Z("CUSTOM_REPORT_LIMIT"))throw new be(G.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const a=Date.now(),l=r.map(u=>({type:On.USER_ANALYTICS,data:Rt(Rt({sid:t},u),{},{lts:a})}));try{Z("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(l):await this.postDataToStatsCollector(l)}catch(u){throw L.error("send custom report message failed",u.toString()),new be(G.CUSTOM_REPORT_SEND_FAILED,u.message)}}sendApiInvoke(t){const r=Z("NOT_REPORT_EVENT");if(t.tag&&Ke(r)&&Ke(r).call(r,t.tag))return!1;if(t.sid===null)return this.apiInvokeUploadPendingItems.push(t),!1;const a=this.baseInfoMap.get(t.sid);if(!a)return this.apiInvokeUploadPendingItems.push(t),!1;const{cname:l,uid:u,cid:h}=a.info;let f;if(t.lts=t.lts||Date.now(),t.error)if(t.error instanceof be){const{code:E,message:y}=t.error;f=E||y||t.error.toString()}else f=t.error.toString();const v={invokeId:t.invokeId,sid:t.sid,cname:l,cid:h,uid:u,lts:t.lts,success:t.success,elapse:t.lts-a.startTime,execElapse:t.lts-t.apiInvokeTime,apiName:t.name,options:t.options?JSON.stringify(t.options):void 0,execStates:t.states?JSON.stringify(t.states):void 0,execResult:t.result?JSON.stringify(t.result):void 0,errorCode:t.error?f:void 0,errorMsg:t.error?JSON.stringify(t.error):void 0};return this.send({type:On.API_INVOKE,data:v},!1),!0}appendSessionId(){zf.__CLIENT_LIST__.forEach(t=>{if(t._sessionId){const r=this.apiInvokeUploadPendingItems.length;for(let a=0;a<r;a++){const l=this.apiInvokeUploadPendingItems.shift();l&&(l.sid=t._sessionId,this.sendApiInvoke(Object.assign({},l)))}}})}send(t,r){if(r)return this.keyEventUploadPendingItems.push(t),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(t),this.normalEventUploadPendingItems.length>Z("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(t,r){const a=[],l=[];for(;t.length;){const h=t.shift();a.length<20?a.push(h):l.push(h)}t.push(...l);for(const h of[...a]){var u;this.ltsList.indexOf(h.data.lts)!==-1?(h.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(h.data.lts)):(this.ltsList.push(h.data.lts),Nf(u=this.ltsList).call(u,(f,v)=>f-v))}return r||(this.lastSendNormalEventTime=Date.now()),Z("ENABLE_EVENT_REPORT")&&a.length&&(Z("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(a):this.postDataToStatsCollector(a)).catch((h=>f=>{Z("EVENT_REPORT_RETRY")&&(r?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(h):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(h),this.normalEventUploadPendingItems.length>Z("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-Z("NORMAL_EVENT_QUEUE_CAPACITY")),L.warning("report: drop normal events"))))})(a)),t}async postDataToStatsCollector2(t){or.networkState===Li.OFFLINE&&await me.race([or.onlineWaiter,ni(2*sr.maxRetryTimeout)]);const r=u=>{let h=new Uint8Array;return u.forEach(f=>{const v=Tb(JSON.stringify(f.data)),E=new ArrayBuffer(5),y=(I=>{let k=0;return Object.entries(On).forEach(W=>{let[$,z]=W;z===I.type&&(k=EventNameToID[$])}),k})(f),C=new DataView(E);C.setUint16(0,v.byteLength,!0),C.setUint8(2,255&y),C.setUint8(3,y>>>8&255),C.setUint8(4,y>>>16&255),h=jk(h,new Uint8Array(E)),h=jk(h,v)}),h},a="event";let l=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Z("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(a):"https://".concat(Z("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(a);for(let u=0;u<2;u+=1){u===1&&(l=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Z("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(a):"https://".concat(Z("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(a));try{await qb(l,{timeout:1e4,data:r(t),headers:Rt(Rt({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(h){if(u===1)throw h;continue}return}}async postDataToStatsCollector(t){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const a={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:t.map(h=>JSON.stringify(h)),vid:(h=>{const f=h&&h.data.sid&&this.baseInfoMap.get(h.data.sid);return f&&f.info.vid&&+f.info.vid||0})(t[0])};or.networkState===Li.OFFLINE&&await me.race([or.onlineWaiter,ni(2*sr.maxRetryTimeout)]);const l=r?"/events/proto-raws":"/events/messages";let u=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Z("EVENT_REPORT_DOMAIN"),"&p=").concat(Z("STATS_COLLECTOR_PORT"),"&d=").concat(l):"https://".concat(Z("EVENT_REPORT_DOMAIN"),":").concat(Z("STATS_COLLECTOR_PORT")).concat(l));for(let h=0;h<2;h+=1){h===1&&(u=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Z("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(Z("STATS_COLLECTOR_PORT"),"&d=").concat(l):"https://".concat(Z("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(Z("STATS_COLLECTOR_PORT")).concat(l)));try{r?await $Z(u,{timeout:1e4,data:a}):await qb(u,{timeout:1e4,data:a})}catch(f){if(h===1)throw f;continue}return}}createBaseInfo(t,r){const a=Object.assign({},KZ);return a.sid=t,this.baseInfoMap.set(t,{info:a,startTime:r}),a}reportResourceTiming(t,r){const a=performance.getEntriesByName(t),l=a[a.length-1];l&&this.reportApiInvoke(r,{name:"Client.resourceTiming",options:l,tag:Dn.TRACER}).onSuccess()}}function Ze(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(t,r,a){const l=a.value;if(typeof l=="function"){const u=i.className||t.__className__||(t.constructor.name==="AgoraRTCClient"?"Client":t.constructor.name);a.value=function(){for(var h=arguments.length,f=new Array(h),v=0;v<h;v++)f[v]=arguments[v];let E=f;if(i.argsMap)try{E=i.argsMap(this,...f)}catch(C){L.warning(C),E=[]}try{JSON.stringify(E)}catch{L.warning("arguments for method ".concat(u,".").concat(String(r)," not serializable for apiInvoke.")),E=[]}const y=(i.report||He).reportApiInvoke(this._sessionId||null,{name:"".concat(u,".").concat(String(r)),options:E,tag:Dn.TRACER,reportResult:i.reportResult},i.throttleTime);try{const C=l.apply(this,f);return C instanceof me?C.then(I=>(y.onSuccess(i.reportResult&&I),I)).catch(I=>{throw y.onError(I),I}):(y.onSuccess(i.reportResult&&C),C)}catch(C){throw y.onError(C),C}}}return a}}w(zf,"__CLIENT_LIST__",[]);const He=new zf;lv.on("REPORT_LOG_UPLOAD",i=>{i.networkState=or.networkState,He.reportApiInvoke(null,{name:"logUploadError",options:i,tag:Dn.TRACER})});const qZ=["CHINA","GLOBAL"],Qo=function(){const i="us".concat("erna","me"),t="pa".concat("sswo","rd"),r=["t","s","t"];r.splice(1,0,"e");const a=r.join(""),l=[];for(let f=0;f<6;f++)l.push("1");const u=l.join(""),h={};return h[i]=a,h[t]=u,Object.assign(h,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=Qo,Yb||($i.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],$i.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],$i.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],$i.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],$i.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],$i.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],$i.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",$i.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",$i.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",$i.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",$i.AREAS=["NORTH_AMERICA","OVERSEA"]);const rL=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],Ul=[];function td(i,t){return!!t&&Ul.some(r=>r.uid===i&&r.channelName===t)}zf.__CLIENT_LIST__=Ul;var Qb,vo,xh,Gf,Zo,yi,Xe,wt,Le,$e,Eo,lt,iL,Nh,rt,Er,Bl,YZ=$u("Array").values,XZ=Hu,JZ=fo,QZ=Jt,ZZ=YZ,Zb=Array.prototype,eee={DOMTokenList:!0,NodeList:!0},gc=it(function(i){var t=i.values;return i===Zb||QZ(Zb,i)&&t===Zb.values||JZ(eee,XZ(i))?ZZ:t});function Te(i,t,r,a){var l,u=arguments.length,h=u<3?t:a===null?a=Object.getOwnPropertyDescriptor(t,r):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(i,t,r,a);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(h=(u<3?l(h):u>3?l(t,r,h):l(t,r))||h);return u>3&&h&&Object.defineProperty(t,r,h),h}function V(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)}(function(i){i.L1T1="L1T1",i.L1T2="L1T2",i.L1T3="L1T3",i.L2T1_KEY="L2T1_KEY",i.L2T2_KEY="L2T2_KEY",i.L2T3_KEY="L2T3_KEY",i.L3T1_KEY="L3T1_KEY",i.L3T2_KEY="L3T2_KEY",i.L3T3_KEY="L3T3_KEY"})(Qb||(Qb={})),function(i){i.CERTIFICATE="certificate",i.CODEC="codec",i.CANDIDATE_PAIR="candidate-pair",i.LOCAL_CANDIDATE="local-candidate",i.REMOTE_CANDIDATE="remote-candidate",i.INBOUND="inbound-rtp",i.TRACK="track",i.OUTBOUND="outbound-rtp",i.PC="peer-connection",i.REMOTE_INBOUND="remote-inbound-rtp",i.REMOTE_OUTBOUND="remote-outbound-rtp",i.TRANSPORT="transport",i.CSRC="csrc",i.DATA_CHANNEL="data-channel",i.STREAM="stream",i.SENDER="sender",i.RECEIVER="receiver"}(vo||(vo={})),function(i){i[i.ACCESS_POINT=101]="ACCESS_POINT",i[i.UNILBS=201]="UNILBS",i[i.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR"}(xh||(xh={})),function(i){i[i.IIIEGAL_APPID=1]="IIIEGAL_APPID",i[i.IIIEGAL_UID=2]="IIIEGAL_UID",i[i.INTERNAL_ERROR=3]="INTERNAL_ERROR"}(Gf||(Gf={})),function(i){i[i.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",i[i.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",i[i.INTERNAL_ERROR=8]="INTERNAL_ERROR",i[i.NO_AUTHORIZED=9]="NO_AUTHORIZED",i[i.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",i[i.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",i[i.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",i[i.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",i[i.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",i[i.USER_OVERLOAD=16]="USER_OVERLOAD",i[i.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",i[i.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND"}(Zo||(Zo={})),function(i){i[i.NO_FLAG_SET=100]="NO_FLAG_SET",i[i.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",i[i.INVALID_FALG_SET=102]="INVALID_FALG_SET",i[i.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",i[i.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",i[i.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",i[i.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",i[i.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",i[i.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",i[i.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",i[i.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",i[i.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",i[i.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",i[i.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",i[i.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",i[i.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",i[i.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",i[i.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",i[i.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV"}(yi||(yi={})),function(i){i[i.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",i[i.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",i[i.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",i[i.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",i[i.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",i[i.K_TICKET_INVALID=7]="K_TICKET_INVALID",i[i.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",i[i.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",i[i.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",i[i.K_UID_BANNED=14]="K_UID_BANNED",i[i.K_IP_BANNED=15]="K_IP_BANNED",i[i.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",i[i.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",i[i.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",i[i.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",i[i.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",i[i.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",i[i.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",i[i.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",i[i.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",i[i.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",i[i.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",i[i.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",i[i.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",i[i.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",i[i.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",i[i.ERR_INVALID_UID=117]="ERR_INVALID_UID",i[i.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",i[i.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",i[i.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",i[i.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",i[i.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",i[i.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",i[i.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",i[i.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",i[i.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",i[i.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",i[i.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",i[i.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",i[i.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",i[i.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",i[i.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",i[i.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",i[i.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",i[i.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",i[i.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",i[i.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",i[i.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",i[i.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",i[i.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",i[i.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",i[i.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",i[i.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",i[i.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",i[i.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",i[i.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",i[i.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",i[i.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",i[i.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",i[i.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",i[i.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",i[i.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",i[i.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",i[i.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY"}(Xe||(Xe={})),function(i){i.CONNECTING="connecting",i.CONNECTED="connected",i.RECONNECTING="reconnecting",i.CLOSED="closed"}(wt||(wt={})),function(i){i.WS_CONNECTED="ws_connected",i.WS_RECONNECTING="ws_reconnecting",i.WS_CLOSED="ws_closed",i.WS_RECONNECT_WAITTING_FINISH="ws_reconnect_waitting_finish",i.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",i.ON_BINARY_DATA="on_binary_data",i.REQUEST_RECOVER="request_recover",i.REQUEST_JOIN_INFO="request_join_info",i.REQUEST_REJOIN_INFO="req_rejoin_info",i.IS_P2P_DISCONNECTED="is_p2p_dis",i.DISCONNECT_P2P="dis_p2p",i.ABORT_P2P_EXECUTION="abort_p2p_execution",i.NEED_RENEW_SESSION="need-sid",i.REPORT_JOIN_GATEWAY="report_join_gateway",i.REQUEST_TIMEOUT="request_timeout",i.REQUEST_SUCCESS="request_success",i.JOIN_RESPONSE="join_response",i.DATACHANNEL_PRECONNECT="datachannel_preconnect",i.DATACHANNEL_CONNECTING="datachannel_connecting",i.DATACHANNEL_FAILBACK="datachannel_failback",i.P2P_START="p2p_start",i.P2P_CONNECTION="p2p_connection",i.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",i.P2P_SUBSCRIBE="p2p_subscribe",i.P2P_UNSUBSCRIBE="p2p_unsubscribe",i.P2P_EXCHANGE_SDP="p2p_exchange_sdp",i.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",i.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream"}(Le||(Le={})),function(i){i.PING="ping",i.PING_BACK="ping_back",i.JOIN="join_v3",i.REJOIN="rejoin_v3",i.LEAVE="leave",i.SET_CLIENT_ROLE="set_client_role",i.PUBLISH="publish",i.PUBLISH_DATASTREAM="publish_datastream",i.UNPUBLISH="unpublish",i.UNPUBLISH_DATASTREAM="unpublish_datastream",i.SUBSCRIBE="subscribe",i.SUBSCRIBE_DATASTREAM="subscribe_datastream",i.SUBSCRIBE_STREAMS="subscribe_streams",i.UNSUBSCRIBE="unsubscribe",i.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",i.UNSUBSCRIBE_STREAMS="unsubscribe_streams",i.SUBSCRIBE_CHANGE="subscribe_change",i.TRAFFIC_STATS="traffic_stats",i.RENEW_TOKEN="renew_token",i.SWITCH_VIDEO_STREAM="switch_video_stream",i.DEFAULT_VIDEO_STREAM="default_video_stream",i.SET_FALLBACK_OPTION="set_fallback_option",i.GATEWAY_INFO="gateway_info",i.CONTROL="control",i.SEND_METADATA="send_metadata",i.DATA_STREAM="data_stream",i.PICK_SVC_LAYER="pick_svc_layer",i.RESTART_ICE="restart_ice",i.CONNECT_PC="connect_pc",i.SET_VIDEO_PROFILE="set_video_profile",i.SET_PARAMETER="set_parameter",i.SET_RTM2_FLAG="set_rtm2_flag"}($e||($e={})),function(i){i.PUBLISH_STATS="publish_stats",i.PUBLISH_RELATED_STATS="publish_related_stats",i.SUBSCRIBE_STATS="subscribe_stats",i.SUBSCRIBE_RELATED_STATS="subscribe_related_stats",i.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",i.DENOISER_STATS="denoiser_stats",i.TRANSPORT_STATS="transport_stats",i.EXTENSION_USAGE_STATS="extension_usage_stats"}(Eo||(Eo={})),function(i){i.ON_USER_ONLINE="on_user_online",i.ON_USER_OFFLINE="on_user_offline",i.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",i.ON_PUBLISH_STREAM="on_publish_stream",i.ON_UPLINK_STATS="on_uplink_stats",i.ON_P2P_LOST="on_p2p_lost",i.ON_REMOVE_STREAM="on_remove_stream",i.ON_ADD_AUDIO_STREAM="on_add_audio_stream",i.ON_ADD_VIDEO_STREAM="on_add_video_stream",i.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",i.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",i.ON_USER_BANNED="on_user_banned",i.ON_USER_LICENSE_BANNED="on_user_license_banned",i.ON_NOTIFICATION="on_notification",i.ON_CRYPT_ERROR="on_crypt_error",i.MUTE_AUDIO="mute_audio",i.MUTE_VIDEO="mute_video",i.UNMUTE_AUDIO="unmute_audio",i.UNMUTE_VIDEO="unmute_video",i.ON_P2P_OK="on_p2p_ok",i.RECEIVE_METADATA="receive_metadata",i.ON_DATA_STREAM="on_data_stream",i.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",i.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",i.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",i.ENABLE_LOCAL_VIDEO="enable_local_video",i.DISABLE_LOCAL_VIDEO="disable_local_video",i.ENABLE_LOCAL_AUDIO="enable_local_audio",i.DISABLE_LOCAL_AUDIO="disable_local_audio",i.ON_PUBLISHED_USER_LIST="on_published_user_list"}(lt||(lt={})),function(i){i.CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",i.NEED_ANSWER="NEED_ANSWER",i.NEED_RENEGOTIATE="NEED_RENEGOTIATE",i.P2P_LOST="P2P_LOST",i.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",i.NEED_UNPUB="NEED_UNPUB",i.NEED_UNSUB="NEED_UNSUB",i.NEED_UPLOAD="NEED_UPLOAD",i.NEED_CONTROL="NEED_CONTROL",i.START_RECONNECT="START_RECONNECT",i.END_RECONNECT="END_RECONNECT",i.NEED_SIGNAL_RTT="NEED_SIGNAL_RTT"}(iL||(iL={})),function(i){i.SEND_ONLY="SEND_ONLY",i.RECEIVE_ONLY="RECEIVE_ONLY"}(Nh||(Nh={})),function(i){i.CONNECTED="websocket:connected",i.RECONNECTING="websocket:reconnecting",i.WILL_RECONNECT="websocket:will_reconnect",i.CLOSED="websocket:closed",i.FAILED="websocket:failed",i.ON_MESSAGE="websocket:on_message",i.REQUEST_NEW_URLS="websocket:request_new_urls",i.RECONNECT_WAITTING_FINISH="websocket:reconnect_waitting_finish",i.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",i.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire"}(rt||(rt={}));class ue extends be{constructor(t){super(t,arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",arguments.length>2?arguments[2]:void 0),w(this,"name","AgoraRTCException")}print(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return super.print(t,L)}throw(){super.throw(L)}}function eT(i){if(typeof i!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(i))throw L.error("Invalid Channel Name ".concat(i)),new ue(G.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function tT(i){if(t=i,!(typeof t=="number"&&Math.floor(t)===t&&0<=t&&t<=4294967295||Mk(i,1,255)))throw new ue(G.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var t;typeof i=="string"&&L.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}(function(i){i.TRANSCODE="mix_streaming",i.RAW="raw_streaming",i.INJECT="inject_streaming"})(Er||(Er={})),function(i){i[i.INJECT_STREAM_STATUS_START_SUCCESS=0]="INJECT_STREAM_STATUS_START_SUCCESS",i[i.INJECT_STREAM_STATUS_START_ALREADY_EXISTS=1]="INJECT_STREAM_STATUS_START_ALREADY_EXISTS",i[i.INJECT_STREAM_STATUS_START_UNAUTHORIZED=2]="INJECT_STREAM_STATUS_START_UNAUTHORIZED",i[i.INJECT_STREAM_STATUS_START_TIMEOUT=3]="INJECT_STREAM_STATUS_START_TIMEOUT",i[i.INJECT_STREAM_STATUS_START_FAILED=4]="INJECT_STREAM_STATUS_START_FAILED",i[i.INJECT_STREAM_STATUS_STOP_SUCCESS=5]="INJECT_STREAM_STATUS_STOP_SUCCESS",i[i.INJECT_STREAM_STATUS_STOP_NOT_FOUND=6]="INJECT_STREAM_STATUS_STOP_NOT_FOUND",i[i.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED=7]="INJECT_STREAM_STATUS_STOP_UNAUTHORIZED",i[i.INJECT_STREAM_STATUS_STOP_TIMEOUT=8]="INJECT_STREAM_STATUS_STOP_TIMEOUT",i[i.INJECT_STREAM_STATUS_STOP_FAILED=9]="INJECT_STREAM_STATUS_STOP_FAILED",i[i.INJECT_STREAM_STATUS_BROKEN=10]="INJECT_STREAM_STATUS_BROKEN"}(Bl||(Bl={}));const tee={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},nT={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function rT(i,t){di(i.url,"".concat(t,".url"),1,1e3,!1),kn(i.x)||cn(i.x,"".concat(t,".x"),0,1e4),kn(i.y)||cn(i.y,"".concat(t,".y"),0,1e4),kn(i.width)||cn(i.width,"".concat(t,".width"),0,1e4),kn(i.height)||cn(i.height,"".concat(t,".height"),0,1e4),kn(i.zOrder)||cn(i.zOrder,"".concat(t,".zOrder"),0,255),kn(i.alpha)||cn(i.alpha,"".concat(t,".alpha"),0,1,!1)}const nee={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},ree={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30};var rs,Ph,er,oL,Si,Ms,Hi,jl,rn,Fn,nd,pr,dv,Vt;function aL(i){if(!i.channelName)throw new ue(G.INVALID_PARAMS,"invalid channelName in info");if(typeof i.uid!="number")throw new ue(G.INVALID_PARAMS,"invalid uid in info, uid must be a number");return i.token&&di(i.token,"info.token",1,2047),tT(i.uid),eT(i.channelName),!0}(function(i){i.WARNING="@live_uap-warning",i.ERROR="@line_uap-error",i.PUBLISH_STREAM_STATUS="@live_uap-publish-status",i.INJECT_STREAM_STATUS="@live_uap-inject-status",i.WORKER_STATUS="@live_uap-worker-status",i.REQUEST_NEW_ADDRESS="@live_uap-request-address"})(rs||(rs={})),function(i){i.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(Ph||(Ph={})),function(i){i[i.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",i[i.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",i[i.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",i[i.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",i[i.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",i[i.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",i[i.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",i[i.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",i[i.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",i[i.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",i[i.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",i[i.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",i[i.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",i[i.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",i[i.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",i[i.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",i[i.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",i[i.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",i[i.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",i[i.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",i[i.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(er||(er={})),function(i){i.CONNECT_FAILED="connect failed",i.CONNECT_TIMEOUT="connect timeout",i.WS_DISCONNECTED="websocket disconnected",i.REQUEST_TIMEOUT="request timeout",i.REQUEST_FAILED="request failed",i.WAIT_STATUS_TIMEOUT="wait status timeout",i.WAIT_STATUS_ERROR="wait status error",i.BAD_STATE="bad state",i.WS_ABORT="ws abort",i.AP_REQUEST_TIMEOUT="AP request timeout",i.AP_JSON_PARSE_ERROR="AP json parse error",i.AP_REQUEST_ERROR="AP request error",i.AP_REQUEST_ABORT="AP request abort"}(oL||(oL={})),function(i){i[i.SetSdkProfile=0]="SetSdkProfile",i[i.SetSourceChannel=1]="SetSourceChannel",i[i.SetSourceUserId=2]="SetSourceUserId",i[i.SetDestChannel=3]="SetDestChannel",i[i.StartPacketTransfer=4]="StartPacketTransfer",i[i.StopPacketTransfer=5]="StopPacketTransfer",i[i.UpdateDestChannel=6]="UpdateDestChannel",i[i.Reconnect=7]="Reconnect",i[i.SetVideoProfile=8]="SetVideoProfile"}(Si||(Si={})),function(i){i.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",i.NETWORK_CONNECTED="NETWORK_CONNECTED",i.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",i.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",i.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",i.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",i.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",i.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",i.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",i.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}(Ms||(Ms={})),function(i){i.RELAY_STATE_IDLE="RELAY_STATE_IDLE",i.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",i.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",i.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE"}(Hi||(Hi={})),function(i){i.RELAY_OK="RELAY_OK",i.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",i.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",i.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED"}(jl||(jl={})),function(i){i.High="high",i.Low="low",i.Audio="audio",i.Screen="screen",i.ScreenLow="screen_low"}(rn||(rn={})),function(i){i.DISCONNECT="disconnect",i.CONNECTION_STATE_CHANGE="connection-state-change",i.NETWORK_QUALITY="network-quality",i.STREAM_TYPE_CHANGE="stream-type-change",i.IS_P2P_DISCONNECTED="is-p2p-dis",i.DISCONNECT_P2P="dis-p2p",i.REQUEST_NEW_GATEWAY_LIST="req-gate-url",i.NEED_RENEW_SESSION="need-sid",i.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",i.JOIN_RESPONSE="join-response",i.REQUEST_DC_CONNECTION_PARAMS="request-dc-connection-params",i.RESET_CONNECTION_EVENTS="reset-connection-events",i.DATACHANNEL_PRECONNECT="datachannel_preconnect",i.DATACHANNEL_FAILBACK="datachannel_failback",i.RESET_SIGNAL="reset-signal"}(Fn||(Fn={})),function(i){i.P2P_DISCONNECTED="P2P_DISCONNECTED",i.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",i.TIMEOUT="TIMEOUT",i.UNKNOWN_REASON="UNKNOWN_REASON"}(nd||(nd={})),function(i){i[i.Nothing=0]="Nothing",i[i.Audio=1]="Audio",i[i.LwoVideo=2]="LwoVideo",i[i.Video=4]="Video",i[i.Data=8]="Data",i[i.DataStream0=256]="DataStream0",i[i.DataStream1=512]="DataStream1",i[i.DataStream2=1024]="DataStream2",i[i.DataStream3=2048]="DataStream3",i[i.DataStream4=4096]="DataStream4",i[i.DataStream5=8192]="DataStream5",i[i.DataStream6=16384]="DataStream6",i[i.DataStream7=32768]="DataStream7"}(pr||(pr={})),function(i){i[i.websocket=0]="websocket",i[i.datachannel=1]="datachannel"}(dv||(dv={})),function(i){i.CHINA="CHINA",i.ASIA="ASIA",i.NORTH_AMERICA="NORTH_AMERICA",i.EUROPE="EUROPE",i.JAPAN="JAPAN",i.INDIA="INDIA",i.KOREA="KOREA",i.HKMC="HKMC",i.US="US",i.OCEANIA="OCEANIA",i.SOUTH_AMERICA="SOUTH_AMERICA",i.AFRICA="AFRICA",i.OVERSEA="OVERSEA",i.GLOBAL="GLOBAL",i.EXTENSIONS="EXTENSIONS"}(Vt||(Vt={}));const sL=[Vt.AFRICA,Vt.ASIA,Vt.CHINA,Vt.EUROPE,Vt.GLOBAL,Vt.INDIA,Vt.JAPAN,Vt.NORTH_AMERICA,Vt.OCEANIA,Vt.OVERSEA,Vt.SOUTH_AMERICA];var Gr;(function(i){i.CHINA="CN",i.ASIA="AS",i.NORTH_AMERICA="NA",i.EUROPE="EU",i.JAPAN="JP",i.INDIA="IN",i.KOREA="KR",i.HKMC="HK",i.US="US",i.OCEANIA="OC",i.SOUTH_AMERICA="SA",i.AFRICA="AF",i.OVERSEA="OVERSEA",i.GLOBAL="GLOBAL",i.EXTENSIONS="GLOBAL"})(Gr||(Gr={}));const hv={CHINA:{},ASIA:{CODE:Gr.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:Gr.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:Gr.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:Gr.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","	uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:Gr.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:Gr.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:Gr.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:Gr.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:Gr.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:Gr.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:Gr.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:Gr.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:Gr.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};var Kf,cL,Ue,hi,Fs,we,$t,Je,lL,ea,ta,_r,vc,qn,Us,uL,Do,Ia,Vl,mn,Ec,dL;Yb&&(hv.CHINA={CODE:Gr.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),function(i){i.UPDATE_BITRATE_LIMIT="update_bitrate_limit"}(Kf||(Kf={}));class hL extends An{constructor(t,r){super(),w(this,"onICEConnectionStateChange",void 0),w(this,"onConnectionStateChange",void 0),w(this,"onDTLSTransportStateChange",void 0),w(this,"onDTLSTransportError",void 0),w(this,"onICETransportStateChange",void 0),w(this,"onFirstAudioReceived",void 0),w(this,"onFirstVideoReceived",void 0),w(this,"onFirstAudioDecoded",void 0),w(this,"onFirstVideoDecoded",void 0),w(this,"onFirstVideoDecodedTimeout",void 0),w(this,"onSelectedLocalCandidateChanged",void 0),w(this,"onSelectedRemoteCandidateChanged",void 0)}}class pv extends hL{constructor(t,r){super(t,r)}}(function(i){i.SEND="sendonly",i.RECV="recvonly",i.SENDRECV="sendrecv",i.INACTIVE="inactive"})(cL||(cL={})),function(i){i.VIDEO="video",i.AUDIO="audio"}(Ue||(Ue={})),function(i){i[i.UDP=0]="UDP",i[i.TCP=1]="TCP",i[i.RELAY=2]="RELAY"}(hi||(hi={})),function(i){i[i.FIRST_CONNECTION=0]="FIRST_CONNECTION",i[i.TCP_RESTART=1]="TCP_RESTART",i[i.RELAY_RESTART=2]="RELAY_RESTART",i[i.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",i[i.OLD_RESTART=11]="OLD_RESTART",i[i.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED"}(Fs||(Fs={})),function(i){i.LocalVideoTrack="videoTrack",i.LocalAudioTrack="audioTrack",i.LocalVideoLowTrack="videoLowTrack"}(we||(we={})),function(i){i.New="new",i.Connected="connected",i.Reconnecting="reconnecting",i.Disconnected="disconnected"}($t||($t={})),function(i){i.StateChange="stateChange",i.IceConnectionStateChange="iceConnectionStateChange",i.RequestMuteLocal="requestMuteLocal",i.RequestUnmuteLocal="requestUnmuteLocal",i.RequestRePublish="requestRePublish",i.RequestRePublishDataChannel="requestRePublishDataChannel",i.RequestReSubscribe="requestReSubscribe",i.RequestUploadStats="requestUploadStats",i.MediaReconnectStart="MediaReconnectStart",i.MediaReconnectEnd="MediaReconnectEnd",i.NeedSignalRTT="NeedSignalRTT",i.RequestRestartICE="RequestRestartIce",i.PeerConnectionStateChange="PeerConnectionStateChange",i.RequestReconnect="RequestReconnect",i.RequestReconnectPC="RequestReconnectPC",i.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",i.P2PLost="P2PLost",i.UpdateVideoEncoder="UpdateVideoEncoder",i.ConnectionTypeChange="ConnectionTypeChange",i.RequestLowStreamParameter="RequestLowStreamParameter",i.QueryClientConnectionState="QueryClientConnectionState",i.LocalCandidate="LocalCandidate",i.RequestP2PMuteLocal="requestP2PMuteLocal",i.RequestP2PPublish="RequestP2PPublish",i.RequestP2PUnPublish="RequestP2PUnPublish",i.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",i.RequestP2PMuteRemote="RequestP2PMuteRemote",i.RequestP2PRestartICE="RequestP2PRestartICE"}(Je||(Je={})),function(i){i.MUTE_LOCAL_VIDEO="mute_local_video",i.MUTE_LOCAL_AUDIO="mute_local_audio",i.UNMUTE_LOCAL_VIDEO="unmute_local_video",i.UNMUTE_LOCAL_AUDIO="unmute_local_audio",i.MUTE_REMOTE_VIDEO="mute_remote_video",i.MUTE_REMOTE_AUDIO="mute_remote_audio",i.UNMUTE_REMOTE_VIDEO="unmute_remote_video",i.UNMUTE_REMOTE_AUDIO="unmute_remote_audio"}(lL||(lL={})),function(i){i.CONNECTING="CONNECTING",i.RECONNECTING="RECONNECTING",i.CONNECTED="CONNECTED",i.CLOSED="CLOSED"}(ea||(ea={})),function(i){i[i.CONNECT_AP=0]="CONNECT_AP",i[i.AP_CONNECTED=1]="AP_CONNECTED",i[i.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",i[i.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",i[i.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",i[i.CONNECT_WORKER=5]="CONNECT_WORKER",i[i.WORKER_CONNECTED=6]="WORKER_CONNECTED",i[i.CLOSED=7]="CLOSED"}(ta||(ta={})),function(i){i.CONNECTION_STATE_CHANGE="connection-state-change",i.STATE_CHANGE="state-change",i.INSPECT_RESULT="inspect-result",i.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",i.REQUEST_NEW_WORKER_URL="request-new-worker-url"}(_r||(_r={})),function(i){i.NETWORK_ERROR="NETWORK_ERROR",i.SERVER_ERROR="SERVER_ERROR",i.MULTI_IP="MULTI_IP",i.TIMEOUT="TIMEOUT",i.OFFLINE="OFFLINE",i.LEAVE="LEAVE",i.P2P_FAILED="P2P_FAILED",i.FALLBACK="FALLBACK"}(vc||(vc={})),function(i){i.CONNECTED="transmitter:connected",i.RECONNECTING="transmitter:reconnecting",i.WILL_RECONNECT="transmitter:will_reconnect",i.CLOSED="transmitter:closed",i.FAILED="transmitter:failed",i.ON_MESSAGE="transmitter:on_message",i.REQUEST_NEW_URLS="transmitter:request_new_urls",i.RECONNECT_WAITTING_FINISH="transmitter:reconnect_waitting_finish",i.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",i.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",i.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",i.FAILBACK="transmitter:failback"}(qn||(qn={})),function(i){i.CAMERA_CHANGED="camera-changed",i.MICROPHONE_CHANGED="microphone-changed",i.PLAYBACK_DEVICE_CHANGED="playback-device-changed",i.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",i.AUTOPLAY_FAILED="autoplay-failed",i.SECURITY_POLICY_VIOLATION="security-policy-violation"}(Us||(Us={})),function(i){i[i.APP_TYPE_INVALID_VALUE=-1]="APP_TYPE_INVALID_VALUE",i[i.APP_TYPE_NATIVE=0]="APP_TYPE_NATIVE",i[i.APP_TYPE_NATIVE_COCOS=1]="APP_TYPE_NATIVE_COCOS",i[i.APP_TYPE_NATIVE_UNITY=2]="APP_TYPE_NATIVE_UNITY",i[i.APP_TYPE_NATIVE_ELECTRON=3]="APP_TYPE_NATIVE_ELECTRON",i[i.APP_TYPE_NATIVE_FLUTTER=4]="APP_TYPE_NATIVE_FLUTTER",i[i.APP_TYPE_NATIVE_UNREAL=5]="APP_TYPE_NATIVE_UNREAL",i[i.APP_TYPE_NATIVE_XAMARIN=6]="APP_TYPE_NATIVE_XAMARIN",i[i.APP_TYPE_NATIVE_API_CLOUD=7]="APP_TYPE_NATIVE_API_CLOUD",i[i.APP_TYPE_NATIVE_REACT_NATIVE=8]="APP_TYPE_NATIVE_REACT_NATIVE",i[i.APP_TYPE_NATIVE_PYTHON=9]="APP_TYPE_NATIVE_PYTHON",i[i.APP_TYPE_NATIVE_COCOS_CREATOR=10]="APP_TYPE_NATIVE_COCOS_CREATOR",i[i.APP_TYPE_NATIVE_RUST=11]="APP_TYPE_NATIVE_RUST",i[i.APP_TYPE_NATIVE_C_SHARP=12]="APP_TYPE_NATIVE_C_SHARP",i[i.APP_TYPE_NATIVE_CEF=13]="APP_TYPE_NATIVE_CEF",i[i.APP_TYPE_NATIVE_UNI_APP=14]="APP_TYPE_NATIVE_UNI_APP",i[i.APP_TYPE_WEBRTC=1e3]="APP_TYPE_WEBRTC",i[i.APP_TYPE_WEBRTC_REACT=1001]="APP_TYPE_WEBRTC_REACT",i[i.APP_TYPE_WEBRTC_VUE=1002]="APP_TYPE_WEBRTC_VUE",i[i.APP_TYPE_WEBRTC_ANGULAR=1003]="APP_TYPE_WEBRTC_ANGULAR"}(uL||(uL={})),function(i){i.CONNECTING="CONNECTING",i.RECONNECTING="RECONNECTING",i.CONNECTED="CONNECTED",i.CLOSED="CLOSED"}(Do||(Do={})),function(i){i.CONNECTION_STATE_CHANGE="connection-state-change",i.STATE_CHANGE="state-change",i.INSPECT_RESULT="inspect-result",i.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",i.REQUEST_NEW_WORKER_URL="request-new-worker-url"}(Ia||(Ia={})),function(i){i[i.CONNECT_AP=0]="CONNECT_AP",i[i.AP_CONNECTED=1]="AP_CONNECTED",i[i.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",i[i.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",i[i.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",i[i.CONNECT_WORKER=5]="CONNECT_WORKER",i[i.WORKER_CONNECTED=6]="WORKER_CONNECTED",i[i.CLOSED=7]="CLOSED"}(Vl||(Vl={})),function(i){i.CALL="call",i.CANDIDATE="candidate",i.PUBLISH="publish",i.UNPUBLISH="unpublish",i.SUBSCRIBE="subscribe",i.UNSUBSCRIBE="unsubscribe",i.CONTROL="control",i.RESTART_ICE="restart_ice",i.ACK="ack",i.JOIN="join",i.EXCHANGE_SDP="exchange_sdp",i.DO_SUBSCRIBE="do_subscribe",i.DO_UNSUBSCRIBE="do_unsubscribe"}(mn||(mn={})),function(i){i.MUTE_LOCAL_AUDIO="mute_local_audio",i.MUTE_LOCAL_VIDEO="mute_local_video",i.UNMUTE_LOCAL_AUDIO="unmute_local_audio",i.UNMUTE_LOCAL_VIDEO="unmute_local_video"}(Ec||(Ec={})),function(i){i[i.SUCCESS=1]="SUCCESS",i[i.FAILED=0]="FAILED"}(dL||(dL={}));const iee={[xh.ACCESS_POINT]:{[yi.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[yi.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[yi.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[yi.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[yi.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[yi.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[yi.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[yi.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[yi.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[yi.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[yi.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[yi.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[yi.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[yi.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[yi.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[yi.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[yi.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[yi.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[xh.UNILBS]:{[Zo.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[Zo.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[Zo.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[Zo.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[Zo.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[Zo.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[Zo.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[Zo.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[Zo.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[Zo.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[Zo.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[Zo.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[xh.STRING_UID_ALLOCATOR]:{[Gf.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[Gf.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[Gf.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function fv(i){const t=iee[Math.floor(i/1e4)];if(!t)return{desc:"unkonw error",retry:!1};const r=t[i%1e4];if(!r){if(Math.floor(i/1e4)===xh.ACCESS_POINT){const a=i%1e4;if(a.toString()[0]==="1")return{desc:i.toString(),retry:!1};if(a.toString()[0]==="2")return{desc:i.toString(),retry:!0}}return{desc:"unkonw error",retry:!1}}return r}const oee={[Xe.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[Xe.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[Xe.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[Xe.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[Xe.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[Xe.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[Xe.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[Xe.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[Xe.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[Xe.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[Xe.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[Xe.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[Xe.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[Xe.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[Xe.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[Xe.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[Xe.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[Xe.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[Xe.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[Xe.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[Xe.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[Xe.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[Xe.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[Xe.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[Xe.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[Xe.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[Xe.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[Xe.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[Xe.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[Xe.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[Xe.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[Xe.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[Xe.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[Xe.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[Xe.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[Xe.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[Xe.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[Xe.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[Xe.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[Xe.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[Xe.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[Xe.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[Xe.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[Xe.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[Xe.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[Xe.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[Xe.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[Xe.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[Xe.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[Xe.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[Xe.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[Xe.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[Xe.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[Xe.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[Xe.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[Xe.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[Xe.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[Xe.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[Xe.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[Xe.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[Xe.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[Xe.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[Xe.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function rd(i){return oee[i]||{desc:"UNKNOW_ERROR_".concat(i),action:"failed"}}function pL(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function iT(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pL(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):pL(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}function fL(i){return i.every(t=>t.readyState===WebSocket.CLOSED||t.readyState===WebSocket.CLOSING)}function mL(i,t){if(typeof i=="string")return i;const{proxy:r,host:a,port:l}=i;if(t){const u=Z("JOIN_GATEWAY_FALLBACK_PORT")||443;return u===443?"wss://".concat(a,"/ws/?p=").concat(Number(l)+150):"wss://".concat(a,":").concat(u,"/ws/?p=").concat(Number(l)+150)}return r?"wss://".concat(r,"/ws/?h=").concat(a,"&p=").concat(l):"wss://".concat(a,":").concat(l)}const aee=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,see=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,cee=/wss:\/\/(.+):([0-9]+)\/?/,lee=/wss:\/\/(.[^\/]+)\/?/;let uee=0;class dee{constructor(t,r){w(this,"id",0),w(this,"store",void 0),w(this,"recordIndex",void 0),w(this,"websockets",[]),w(this,"try443PortDuration",2e3),w(this,"forceCloseWSDuration",5e3),w(this,"try443PortTimeout",null),w(this,"forceCloseTimeout",null),w(this,"isTry443PortFailed",!1),w(this,"isNormalPortFailed",!1),w(this,"useDoubleDomain",!1),w(this,"useProxy",!1),w(this,"startTime",Date.now()),this.id=++uee,this.try443PortDuration=Z("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=t||5e3,this.store=r}closeAllWebsockets(){this.websockets.forEach(t=>{t.onopen=null,t.onclose=null,t.onmessage=null,t.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout)}logger(){var t;const r=Date.now()-this.startTime;for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];L.debug("[choose-best-ws ".concat((t=this.store)===null||t===void 0?void 0:t.clientId," ").concat(this.id,"] ").concat(r,"ms:"),...l)}createWebSocket(t,r,a){this.logger("createWebSocket:",t,{isTry443Port:r,hasTimeoutDetection:a});const l=Z("GATEWAY_DOMAINS"),u=Date.now(),h=[],f=l.find(y=>{var C;return Ke(C=t.host).call(C,y)});f||(this.useDoubleDomain=!1);const v=[];if(this.useDoubleDomain)l.forEach(y=>{v.push(mL(iT(iT({},t),{},{host:t.host.replace(f,y)}),r))});else{const y=iT({},t);if(r&&f){const C=l.find(I=>I!==f);C&&(y.host=y.host.replace(f,C))}v.push(mL(y,r))}try{v.forEach(y=>{const C=new WebSocket(y);C.binaryType="arraybuffer",h.push(C),this.logger("ws is connecting:",C.url)})}catch(y){if(this.logger("ws create failed"),h.forEach(C=>C.close()),h.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(t,r,a);if(!r&&Number(t.port)!==443)return this.createWebSocket(t,!0,a);throw new ue(G.WS_ERR,"init websocket failed! Error: ".concat(y.toString()))}const E=jf();return this.store&&this.store.recordJoinChannelService({urls:h.map(y=>y.url),service:"gateway"},this.recordIndex),h.forEach(y=>{y.onopen=()=>{this.logger("onopen: ws ".concat(y.url," open cost ").concat(Date.now()-u,"ms")),this.websockets.forEach(C=>{C!==y&&(C.onopen=null,C.onclose=null,C.onmessage=null,C.close(),this.logger("close backup websocket: ".concat(C.url)))}),this.websockets.length=0,E.resolve(y)},y.onclose=C=>{this.logger("onclose: ws ".concat(y.url," closed cost ").concat(Date.now()-u,"ms state: ").concat(y.readyState)),r?this.isTry443PortFailed=fL(h):this.isNormalPortFailed=fL(h),this.logger("443: ".concat(this.useProxy?"not try":this.isTry443PortFailed?"failed":"trying"," 47xx: ").concat(this.isNormalPortFailed?"failed":"trying")),(r&&this.isTry443PortFailed||!r&&(this.isTry443PortFailed||this.useProxy)&&this.isNormalPortFailed)&&(this.logger("onclose: all websocket is closed, ".concat(C.reason)),E.reject({code:C.code,reason:nd.A_ROUND_WS_FAILED}))},y.onmessage=C=>this.logger("".concat(y.url," onmessage: ").concat(C.data))}),this.websockets.push(...h),a||(()=>{const y=()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",E.isResolved),this.websockets.forEach(C=>C.readyState!==WebSocket.OPEN&&C.close())};if(r||this.useProxy)return this.logger("add 5s timeout at ".concat(r?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(y,this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{if(this.logger("2s timeout, isWebsocket created: ",E.isResolved),E.isResolved)return y();Wt().os===Rr.MAC_OS&&Cn()&&y(),this.createWebSocket(t,!0,!0).then(C=>E.resolve(C)).catch(C=>{this.isNormalPortFailed&&E.reject(C),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(y,this.forceCloseWSDuration)},this.try443PortDuration)})(),E.promise}chooseBestWebsocket(t,r,a,l){return this.useDoubleDomain=!!r,typeof t=="string"&&(t=function(u){let h,f,v;return[,h,f,v]=u.match(aee)||[],h||([,f,v]=u.match(see)||[]),f&&v||([,f,v]=u.match(cee)||[]),f&&v||([,f]=u.match(lee)||[]),f||L.warning("un-destructible url: ",u),{proxy:h,host:f,port:v||"443"}}(t)),this.recordIndex=l,this.useProxy=!!t.proxy,a&&this.useProxy&&(L.warn("cannot use 443 only when use proxy"),a=!1),this.createWebSocket(t,!!a,!1).finally(()=>this.clearTimeout())}}function gL(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}class vL extends An{get url(){return this.websocket&&this.websocket.url||null}get reconnectMode(){return this._reconnectMode}set reconnectMode(t){var r;Ke(r=["tryNext","recover"]).call(r,t)&&this.resetReconnectCount(t),this._reconnectMode=t}get state(){return this._state}set state(t){t!==this._state&&(this._state=t,this._state==="reconnecting"?this.emit(rt.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(rt.CONNECTED):this._state==="closed"?this.emit(rt.CLOSED):this._state==="failed"&&this.emit(rt.FAILED))}resetReconnectCount(t){L.debug("websocket reset reconnect count, reason: "+t),this.reconnectCount=0}constructor(t,r){let a=arguments.length>2&&arguments[2]!==void 0&&arguments[2],l=arguments.length>3&&arguments[3]!==void 0&&arguments[3],u=arguments.length>4&&arguments[4]!==void 0&&arguments[4],h=arguments.length>5?arguments[5]:void 0;super(),w(this,"connectionID",0),w(this,"currentURLIndex",0),w(this,"urls",[]),w(this,"_reconnectMode","tryNext"),w(this,"reconnectReason",void 0),w(this,"_initMutex",new Mr("websocket")),w(this,"name",void 0),w(this,"_state","closed"),w(this,"reconnectInterrupter",void 0),w(this,"websocket",void 0),w(this,"retryConfig",void 0),w(this,"reconnectCount",0),w(this,"forceCloseTimeout",5e3),w(this,"onlineReconnectListener",void 0),w(this,"useCompress",void 0),w(this,"tryDoubleDomain",!1),w(this,"use443PortOnly",!1),w(this,"wsInflateLength",0),w(this,"wsDeflateLength",0),w(this,"closeEstablishingWs",()=>{}),w(this,"store",void 0),w(this,"joinGatewayRecordIndex",void 0),this.store=h,this.name=t,this.retryConfig=function(C){for(var I=1;I<arguments.length;I++){var k=arguments[I]!=null?arguments[I]:{};I%2?gL(Object(k),!0).forEach(function(W){w(C,W,k[W])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(k)):gL(Object(k)).forEach(function(W){Object.defineProperty(C,W,Object.getOwnPropertyDescriptor(k,W))})}return C}({},r),this.useCompress=a,this.tryDoubleDomain=l,this.use443PortOnly=u;const{timeout:f,timeoutFactor:v}=r,E=Math.max(300,Math.floor(3*f/5)),y=Math.max(1.2,Math.floor(8*v)/10);Li.ONLINE&&(this.retryConfig.timeout=E,this.retryConfig.timeoutFactor=y),or.on(Wc.NETWORK_STATE_CHANGE,(C,I)=>{C!==I&&(this.resetReconnectCount("network state change: ".concat(I," -> ").concat(C)),C===Li.ONLINE?(this.retryConfig.timeout=E,this.retryConfig.timeoutFactor=y):(this.retryConfig.timeout=f,this.retryConfig.timeoutFactor=v))})}getConnection(){return this.websocket||void 0}async init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const a=await this._initMutex.lock();this.forceCloseTimeout=r,this.urls=t,this.state="connecting";try{const l=jf(),u=this.urls[this.currentURLIndex];this.createWebSocketConnection(u).then(l.resolve).catch(l.reject),this.once(rt.CLOSED,()=>{l.reject(new be(G.WS_DISCONNECT))}),this.once(rt.CONNECTED,l.resolve),await l.promise}catch{}finally{a()}}close(t,r){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const a=this.websocket;r?setTimeout(()=>a.close(),500):a.close(),this.websocket=void 0}this.state=t?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(t,r){if(!this.websocket)return void L.warning("[".concat(this.name,"] can not reconnect, no websocket"));t!==void 0&&(this.reconnectMode=t),L.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinGatewayRecordIndex=="number"&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(r)]},this.joinGatewayRecordIndex);const a=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),a&&a.bind(this.websocket)({code:9999,reason:r})}sendMessage(t){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new be(G.WS_ABORT,"websocket is not ready");try{r||(t=JSON.stringify(t)),this.websocket.send(t)}catch(a){throw new be(G.WS_ERR,"send websocket message error"+a.toString())}}setWsInflateData(t){this.wsDeflateLength=this.wsDeflateLength+t.originLength,this.wsInflateLength=this.wsInflateLength+t.compressedLength}getWsInflateData(){const t=this.wsInflateLength,r=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:t,wsDeflateLength:r}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(t){var r;const a=jf();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const l=y=>{var C;(C=this.store)===null||C===void 0||C.signalChannelOpen(),L.debug("[".concat(this.name,"] websocket opened:"),y),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),a.resolve()},u=async y=>{var C;if(L.debug("[".concat(this.name,"] websocket close ").concat((C=this.websocket)===null||C===void 0?void 0:C.url,", code: ").concat(y.code,", reason: ").concat(y.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)a.reject(new be(G.WS_DISCONNECT,"websocket close: ".concat(y.code))),this.close();else{this.state==="connected"&&(this.reconnectReason=y.reason,this.state="reconnecting");const I=mo(this,rt.WILL_RECONNECT,this.reconnectMode,y.reason)||this.reconnectMode,k=await this.reconnectWithAction(I);if(this.state==="closed")return void L.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!k)return a.reject(new be(G.WS_DISCONNECT,"websocket reconnect failed: ".concat(y.code))),this.close(!0);a.resolve()}},h=y=>{this.emit(rt.ON_MESSAGE,y)},f=y=>{L.warn("[".concat(this.connectionID,"] ws open error ").concat(y))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),Z("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(t=Z("GATEWAY_WSS_ADDRESS")),L.debug("[".concat(this.name,"] start connect, url:"),t);const v=(r=this.store)===null||r===void 0?void 0:r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var E;const y=await this.chooseBestWebsocketConnection(t);this.websocket=y,l&&l(this.websocket.url),this.websocket.onclose=u,this.websocket.onmessage=h,this.websocket.onerror=f,(E=this.store)===null||E===void 0||E.recordJoinChannelService({endTs:Date.now(),status:"success"},v),this.joinGatewayRecordIndex=v}catch(y){const C=this.state==="closed",I=y instanceof be,k=I&&y.code===G.WS_ABORT,W=I&&y.code===G.WS_ERR,$=I?y.message:y&&(y.reason||y.toString());L.warning("[choose-best-ws] chooseBestWebsocket error: ".concat($)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:k?"aborted":"error",errors:[y]},v),C||W?(a.reject(C?new be(G.WS_DISCONNECT,"websocket is closed: ".concat($)):new be(G.WS_ERR,"init websocket failed: ".concat($))),W&&L.error("[".concat(this.name,"] init websocket failed: ").concat($))):u&&u(y)}return a.promise}async reconnectWithAction(t){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||this.urls.length===0||this.state==="closed")return!1;L.warning("[choose-best-ws] action: =>",t),this.onlineReconnectListener||or.isOnline||!or.onlineWaiter||(this.onlineReconnectListener=or.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let a=!0;if(this.reconnectInterrupter=()=>a=!1,r){const h=Zg(this.reconnectCount,this.retryConfig);L.debug("[".concat(this.name,"] wait ").concat(h,"ms to reconnect websocket, mode: ").concat(t)),await me.race([ni(h),this.onlineReconnectListener||new me(()=>{})])}if(this._state==="closed"||!a)return!1;this.reconnectCount+=1;const l=async(h,f)=>{this.emit(rt.RECONNECT_CREATE_CONNECTION,f),await this.createWebSocketConnection(h)};try{if(t==="retry")this.emit(rt.RECONNECT_WAITTING_FINISH,t),await l(this.urls[this.currentURLIndex],t);else if(t==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);L.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),this.emit(rt.RECONNECT_WAITTING_FINISH,t),await l(this.urls[this.currentURLIndex],t)}else t==="recover"&&(L.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.emit(rt.RECONNECT_WAITTING_FINISH,t),this.urls=await Ln(this,rt.REQUEST_NEW_URLS),this.currentURLIndex=0,await l(this.urls[this.currentURLIndex],t))}catch(h){var u;L.error("[".concat(this.name,"] reconnect failed ").concat(h&&h.toString()));const f=h==null||(u=h.data)===null||u===void 0?void 0:u.desc;return Array.isArray(f)&&Ke(f).call(f,"dynamic key expired")?(this.emit(rt.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(t,r)}return!0}}class qf extends vL{constructor(t,r){super(t,r,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(t,r){const a=jf(),l=function(h,f){return new dee(h,f)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{L.debug("[choose-best-ws] close establishing websockets"),l.closeAllWebsockets(),a.reject(new be(G.WS_ABORT,"choose best websocket aborted"))};const u=Z("GATEWAY_DOMAINS");return L.debug("[choose-best-ws] currentDomain: ",t,", domains: ",u,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),l.chooseBestWebsocket(t,this.tryDoubleDomain,this.use443PortOnly,r).then(a.resolve).catch(a.reject),a.promise.finally(()=>{this.closeEstablishingWs=void 0})}}class Yf extends vL{constructor(t,r){super(t,r,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(t,r){return new me((a,l)=>{let u=!1;const h=[];this.closeEstablishingWs=()=>{L.debug("[choose-best-ws] close establishing websockets"),h.forEach(W=>{W.onclose=null,W.onopen=null,W.onmessage=null,W.close()}),l(new be(G.WS_ABORT,"choose best websocket aborted"))};const f=Z("GATEWAY_DOMAINS");let v;const E=t.indexOf("?h="),y=f.find(W=>E!==-1?Ke(t).call(t,W,E):Ke(t).call(t,W));L.debug("[choose-best-ws] currentDomain: ",y,", domains: ",f);let C=!this.tryDoubleDomain||!y;if(!C&&y){var I;const W=Date.now();try{f.forEach($=>{const z=E===-1?t.replace(y,$):t.substr(0,E)+t.substr(E).replace(y,$),X=new WebSocket(z);X.binaryType="arraybuffer",h.push(X),L.debug("[choose-best-ws] ws is connecting:",X.url)})}catch{for(L.debug("[choose-best-ws] ws create failed, fallback to single url"),h.forEach(z=>z.close());h.length;)h.pop();C=!0}(I=this.store)===null||I===void 0||I.recordJoinChannelService({urls:h.map($=>$.url),service:"gateway"},r),h.forEach($=>{$.onopen=()=>{if(u)return;const z=Date.now()-W;L.debug("[choose-best-ws] ws open cost ".concat(z,"ms")),h.filter(X=>X!==$).forEach(X=>{L.debug("[choose-best-ws]close backup websocket: ".concat(X.url)),X.close()}),u=!0,a($)},$.onclose=z=>{v=z,!u&&(h.find(X=>!(X.readyState===WebSocket.CLOSED||X.readyState===WebSocket.CLOSING))||(L.debug("[choose-best-ws] all websocket is closed"),u=!0,l(v)))},$.onmessage=z=>{L.debug("[choose-best-ws]".concat($.url," onmessage: ").concat(z.data))}}),ni(this.forceCloseTimeout).then(()=>{h.forEach($=>{$.readyState!==WebSocket.OPEN&&$.close()})})}if(C){var k;let W;L.debug("[choose-best-ws] use single url: ",t),(k=this.store)===null||k===void 0||k.recordJoinChannelService({urls:[t],service:"gateway"},r);try{W=new WebSocket(t),h.push(W),W.binaryType="arraybuffer"}catch($){const z=new be(G.WS_ERR,"init websocket failed! Error: ".concat($.toString()));return L.error("[".concat(this.name,"]").concat(z)),void l(z)}W.onopen=()=>{a(W)},W.onclose=$=>{l($)},W.onmessage=$=>{L.debug("[choose-best-ws]".concat(W.url," onmessage: ").concat($.data))},ni(this.forceCloseTimeout).then(()=>{W&&W.readyState!==WebSocket.OPEN&&W.close()})}}).then(a=>(this.closeEstablishingWs=void 0,a)).catch(a=>{throw this.closeEstablishingWs=void 0,a})}}class EL extends An{get connectionState(){return this._connectionState}set connectionState(t){t!==this._connectionState&&(this._connectionState=t,t===wt.CONNECTED?this.emit(Le.WS_CONNECTED):t===wt.RECONNECTING?this.emit(Le.WS_RECONNECTING,this._websocketReconnectReason):t===wt.CLOSED&&this.emit(Le.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(t,r){super(),w(this,"_disconnectedReason",void 0),w(this,"_websocketReconnectReason",void 0),w(this,"_connectionState",wt.CLOSED),w(this,"reconnectToken",void 0),w(this,"websocket",void 0),w(this,"openConnectionTime",void 0),w(this,"clientId",void 0),w(this,"lastMsgTime",Date.now()),w(this,"uploadCache",[]),w(this,"uploadCacheInterval",void 0),w(this,"rttRolling",new xb(5)),w(this,"pingpongTimer",void 0),w(this,"wsInflateDataTimer",void 0),w(this,"pingpongTimeoutCount",0),w(this,"joinResponse",void 0),w(this,"multiIpOption",void 0),w(this,"initError",void 0),w(this,"spec",void 0),w(this,"store",void 0),w(this,"onWebsocketMessage",a=>{if(a.data instanceof ArrayBuffer)return void this.emit(Le.ON_BINARY_DATA,a.data);const l=JSON.parse(a.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(l,"_id")){const u="res-@".concat(l._id);this.emit(u,l._result,l._message)}else if(Object.prototype.hasOwnProperty.call(l,"_type")){if(this.emit(l._type,l._message),l._type===lt.ON_NOTIFICATION&&this.handleNotification(l._message),l._type===lt.ON_USER_BANNED)switch(l._message.error_code){case 14:this.close(It.UID_BANNED);break;case 15:this.close(It.IP_BANNED);break;case 16:this.close(It.CHANNEL_BANNED)}if(l._type===lt.ON_USER_LICENSE_BANNED)switch(l._message.error_code){case Xe.ERR_LICENSE_MISSING:this.close(It.LICENSE_MISSING);break;case Xe.ERR_LICENSE_EXPIRED:this.close(It.LICENSE_EXPIRED);break;case Xe.ERR_LICENSE_MINUTES_EXCEEDED:this.close(It.LICENSE_MINUTES_EXCEEDED);break;case Xe.ERR_LICENSE_PERIOD_INVALID:this.close(It.LICENSE_PERIOD_INVALID);break;case Xe.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(It.LICENSE_MULTIPLE_SDK_SERVICE);break;case Xe.ERR_LICENSE_ILLEGAL:this.close(It.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=t.clientId,this.spec=t,this.store=r,this.websocket=new qf("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Z("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Z("JOIN_GATEWAY_USE_443PORT_ONLY"),r),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===wt.CONNECTED&&this.reconnect("retry",Ir.OFFLINE)})}async request(t,r,a,l){const u=un(6,""),h={_id:u,_type:t,_message:r},f=this.websocket.connectionID,v=()=>new me((W,$)=>{if(this.connectionState===wt.CONNECTED)return W();const z=()=>{this.off(Le.WS_CLOSED,X),W()},X=()=>{this.off(Le.WS_CONNECTED,z),$(new ue(G.WS_ABORT))};this.once(Le.WS_CONNECTED,z),this.once(Le.WS_CLOSED,X),t!==$e.PUBLISH&&t!==$e.SUBSCRIBE&&t!==$e.UNSUBSCRIBE&&t!==$e.UNPUBLISH&&t!==$e.CONTROL&&t!==$e.RESTART_ICE||this.once(Le.DISCONNECT_P2P,()=>{$(new ue(G.DISCONNECT_P2P))}),t!==$e.PUBLISH&&t!==$e.RESTART_ICE||this.once(Le.ABORT_P2P_EXECUTION,()=>{$(new ue(G.DISCONNECT_P2P))})});if(this.connectionState!==wt.CONNECTING&&this.connectionState!==wt.RECONNECTING||t===$e.JOIN||t===$e.REJOIN||await v(),this.websocket.sendMessage(h,!0),l)return;const E=new me((W,$)=>{let z=!1;const X=(oe,Re)=>{z=!0,W({isSuccess:oe==="success",message:Re||{}}),this.off(Le.WS_CLOSED,ie),this.off(Le.WS_RECONNECTING,ie),this.emit(Le.REQUEST_SUCCESS,t,r)};this.once("res-@".concat(u),X);const ie=()=>{$(new ue(G.WS_ABORT,"type: ".concat(t))),this.off(Le.WS_CLOSED,ie),this.off(Le.WS_RECONNECTING,ie),this.off("res-@".concat(u),X)};this.once(Le.WS_CLOSED,ie),this.once(Le.WS_RECONNECTING,ie),ni(Z("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==f||z||(L.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(t)),this.emit(Le.REQUEST_TIMEOUT,t,r))})});let y=null;try{y=await E}catch(W){if(this.connectionState===wt.CLOSED||t===$e.LEAVE)throw new ue(G.WS_ABORT);return!this.spec.forceWaitGatewayResponse||a?W.throw():t===$e.JOIN||t===$e.REJOIN?null:(await v(),await this.request(t,r))}if(y.isSuccess)return y.message;const C=Number(y.message.error_code||y.message.code),I=rd(C),k=new ue(G.UNEXPECTED_RESPONSE,"".concat(I.desc,": ").concat(y.message.error_str),{code:C,data:y.message});return I.action==="success"?y.message:(L.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(t,", error_code: ").concat(C,", message: ").concat(I.desc,", action: ").concat(I.action)),C===Xe.ERR_TOO_MANY_BROADCASTERS?((t===$e.JOIN||t===$e.REJOIN)&&(this.initError=k,this.close()),k.throw()):I.action==="failed"?k.throw():I.action==="quit"?(this.initError=k,this.close(),k.throw()):(C===Xe.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=y.message.option,L.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Ir.MULTI_IP)):this.reconnect(I.action,Ir.SERVER_ERROR),t===$e.JOIN||t===$e.REJOIN?null:await this.request(t,r)))}waitMessage(t,r){return new me(a=>{const l=u=>{(!r||r(u))&&(this.off(t,l),a(u))};this.on(t,l)})}upload(t,r){const a={_type:t,_message:r};try{this.websocket.sendMessage(a)}catch{const u=Z("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(a),this.uploadCache.length>u&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==wt.CONNECTED)return;const h=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(h._type,h._message)},Z("UPLOAD_CACHE_INTERVAL")||2e3))}}send(t,r){const a={_type:t,_message:r};this.websocket.sendMessage(a)}init(t,r){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new me((a,l)=>{this.once(Le.WS_CONNECTED,()=>a(this.joinResponse)),this.once(Le.WS_CLOSED,()=>l(this.initError||new ue(G.WS_ABORT))),this.connectionState=wt.CONNECTING,this.websocket.init(t).catch(l),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=t||It.LEAVE,this.connectionState=wt.CLOSED,L.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),t===It.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new qf("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Z("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Z("JOIN_GATEWAY_USE_443PORT_ONLY"),this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(Le.ABORT_P2P_EXECUTION);const t=await Ln(this,Le.REQUEST_JOIN_INFO),r=await this.request($e.JOIN,t);if(!r)return this.emit(Le.REPORT_JOIN_GATEWAY,nd.TIMEOUT,this.url||""),!1;this.joinResponse=r,this.emit(Le.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=wt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new ue(G.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const t=zc(this,Le.REQUEST_REJOIN_INFO);t.token=this.reconnectToken;const r=await this.request($e.REJOIN,t);return!!r&&(this.connectionState=wt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),r.peers&&r.peers.forEach(a=>{this.emit(lt.ON_USER_ONLINE,{uid:a.uid}),a.audio&&this.emit(lt.ON_ADD_AUDIO_STREAM,{uid:a.uid,uint_id:a.uint_id,audio:!0,ssrcId:a.audio_ssrc}),a.video&&this.emit(lt.ON_ADD_VIDEO_STREAM,{uid:a.uid,uint_id:a.uint_id,video:!0,ssrcId:a.video_ssrc}),a.audio_mute?this.emit(lt.MUTE_AUDIO,{uid:a.uid}):this.emit(lt.UNMUTE_AUDIO,{uid:a.uid}),a.video_mute?this.emit(lt.MUTE_VIDEO,{uid:a.uid}):this.emit(lt.UNMUTE_VIDEO,{uid:a.uid}),a.audio_enable_local?this.emit(lt.ENABLE_LOCAL_AUDIO,{uid:a.uid}):this.emit(lt.DISABLE_LOCAL_AUDIO,{uid:a.uid}),a.video_enable_local?this.emit(lt.ENABLE_LOCAL_VIDEO,{uid:a.uid}):this.emit(lt.DISABLE_LOCAL_VIDEO,{uid:a.uid}),a.audio||a.video||this.emit(lt.ON_REMOVE_STREAM,{uid:a.uid,uint_id:a.uint_id})}),!0)}reconnect(t,r){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(t,r)}handleNotification(t){L.debug("[".concat(this.clientId,"] receive notification: "),t);const r=rd(t.code);if(r.action!=="success"){if(r.action!=="failed")return r.action==="quit"?(r.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(It.UID_BANNED),void this.close()):void this.reconnect(r.action,Ir.SERVER_ERROR);L.error("[".concat(this.clientId,"] ignore error: "),r.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const t=Z("PING_PONG_TIME_OUT"),r=Date.now();this.pingpongTimeoutCount>=t&&(L.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(r-this.lastMsgTime,"ms")),r-this.lastMsgTime>Z("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Ir.TIMEOUT):this.request($e.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const a=Date.now()-r;this.rttRolling.add(a),Z("REPORT_STATS")&&this.send($e.PING_BACK,{pingpongElapse:a})}).catch(a=>{})}handleWsInflateData(){const{wsInflateLength:t,wsDeflateLength:r}=this.websocket.getWsInflateData();t!==0&&r!==0&&this.upload(Eo.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:r,ws_inflate_length:t})}handleWebsocketEvents(){this.websocket.on(rt.RECONNECT_WAITTING_FINISH,t=>{this.emit(Le.WS_RECONNECT_WAITTING_FINISH,t)}),this.websocket.on(rt.RECONNECT_CREATE_CONNECTION,t=>{this.emit(Le.WS_RECONNECT_CREATE_CONNECTION,t)}),this.websocket.on(rt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(rt.CLOSED,()=>{this.connectionState=wt.CLOSED}),this.websocket.on(rt.FAILED,()=>{this._disconnectedReason=It.NETWORK_ERROR,this.connectionState=wt.CLOSED}),this.websocket.on(rt.RECONNECTING,t=>{this._websocketReconnectReason=t,this.joinResponse=void 0,this.connectionState===wt.CONNECTED?this.connectionState=wt.RECONNECTING:this.connectionState=wt.CONNECTING}),this.websocket.on(rt.WILL_RECONNECT,(t,r,a)=>{const l=zc(this,Le.IS_P2P_DISCONNECTED),u=l||t!=="retry";l&&t==="retry"&&(L.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),t="tryNext",r=nd.P2P_DISCONNECTED),u&&(L.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(t)),this.emit(Le.REPORT_JOIN_GATEWAY,r||nd.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(Le.NEED_RENEW_SESSION),this.emit(Le.DISCONNECT_P2P)),a(t)}),this.websocket.on(rt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(t=>{L.warning("[".concat(this.clientId,"] rejoin failed ").concat(t)),this.reconnect("tryNext",Ir.SERVER_ERROR)}):this.join().catch(t=>{if(this.emit(Le.REPORT_JOIN_GATEWAY,t.message||t.code||nd.UNKNOWN_REASON,this.url||""),t instanceof ue&&t.code===G.UNEXPECTED_RESPONSE&&t.data.code===Xe.ERR_NO_AUTHORIZED)return L.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",Ir.SERVER_ERROR);L.error("[".concat(this.clientId,"] join gateway request failed"),t.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Ir.SERVER_ERROR):(this.initError=t,this.close())})}),this.websocket.on(rt.REQUEST_NEW_URLS,(t,r)=>{Ln(this,Le.REQUEST_RECOVER,this.multiIpOption).then(t).catch(r)}),this.websocket.on(rt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(lt.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}var _L=`	
\v\f\r \u2028\u2029\uFEFF`,hee=uo,pee=jc,oT=_L,yL=Ut("".replace),fee=RegExp("^["+oT+"]+"),mee=RegExp("(^|[^"+oT+"])["+oT+"]+$"),aT=function(i){return function(t){var r=pee(hee(t));return 1&i&&(r=yL(r,fee,"")),2&i&&(r=yL(r,mee,"$1")),r}},gee={start:aT(1),end:aT(2),trim:aT(3)},vee=NP.PROPER,Eee=Xt,SL=_L,_ee=gee.trim;Zn({target:"String",proto:!0,forced:function(i){return Eee(function(){return!!SL[i]()||""[i]()!==""||vee&&SL[i].name!==i})}("trim")},{trim:function(){return _ee(this)}});var Fr,Ur,yee=$u("String").trim,See=Jt,Cee=yee,sT=String.prototype,cT=it(function(i){var t=i.trim;return typeof i=="string"||i===sT||See(sT,i)&&t===sT.trim?Cee:t});function Dh(i,t,r){return{sampleRate:i,stereo:t,bitrate:r}}function Mt(i,t,r,a,l){return{width:i,height:t,frameRate:r,bitrateMin:a,bitrateMax:l}}function is(i,t,r,a,l){return{width:{max:i},height:{max:t},frameRate:r,bitrateMin:a,bitrateMax:l}}function lT(i,t){return{numSpatialLayers:i,numTemporalLayers:t}}(function(i){i[i.CHOOSE_SERVER=11]="CHOOSE_SERVER",i[i.CLOUD_PROXY=18]="CLOUD_PROXY",i[i.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",i[i.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK"})(Fr||(Fr={})),function(i){i.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",i.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",i.IOS_INTERRUPTION_START="ios-interruption-start",i.IOS_INTERRUPTION_END="ios-interruption-end",i.STATE_CHANGE="state-change"}(Ur||(Ur={}));const bee={"90p":Mt(160,90),"90p_1":Mt(160,90),"120p":Mt(160,120,15,30,65),"120p_1":Mt(160,120,15,30,65),"120p_3":Mt(120,120,15,30,50),"120p_4":Mt(212,120),"180p":Mt(320,180,15,30,140),"180p_1":Mt(320,180,15,30,140),"180p_3":Mt(180,180,15,30,100),"180p_4":Mt(240,180,15,30,120),"240p":Mt(320,240,15,40,200),"240p_1":Mt(320,240,15,40,200),"240p_3":Mt(240,240,15,40,140),"240p_4":Mt(424,240,15,40,220),"360p":Mt(640,360,15,80,400),"360p_1":Mt(640,360,15,80,400),"360p_3":Mt(360,360,15,80,260),"360p_4":Mt(640,360,30,80,600),"360p_6":Mt(360,360,30,80,400),"360p_7":Mt(480,360,15,80,320),"360p_8":Mt(480,360,30,80,490),"360p_9":Mt(640,360,15,80,800),"360p_10":Mt(640,360,24,80,800),"360p_11":Mt(640,360,24,80,1e3),"480p":Mt(640,480,15,100,500),"480p_1":Mt(640,480,15,100,500),"480p_2":Mt(640,480,30,100,1e3),"480p_3":Mt(480,480,15,100,400),"480p_4":Mt(640,480,30,100,750),"480p_6":Mt(480,480,30,100,600),"480p_8":Mt(848,480,15,100,610),"480p_9":Mt(848,480,30,100,930),"480p_10":Mt(640,480,10,100,400),"720p":Mt(1280,720,15,120,1130),"720p_auto":Mt(1280,720,30,900,3e3),"720p_1":Mt(1280,720,15,120,1130),"720p_2":Mt(1280,720,30,120,2e3),"720p_3":Mt(1280,720,30,120,1710),"720p_5":Mt(960,720,15,120,910),"720p_6":Mt(960,720,30,120,1380),"1080p":Mt(1920,1080,15,120,2080),"1080p_1":Mt(1920,1080,15,120,2080),"1080p_2":Mt(1920,1080,30,120,3e3),"1080p_3":Mt(1920,1080,30,120,3150),"1080p_5":Mt(1920,1080,60,120,4780),"1440p":Mt(2560,1440,30,120,4850),"1440p_1":Mt(2560,1440,30,120,4850),"1440p_2":Mt(2560,1440,60,120,7350),"4k":Mt(3840,2160,30,120,8910),"4k_1":Mt(3840,2160,30,120,8910),"4k_3":Mt(3840,2160,60,120,13500)},mv=[{scaleResolutionDownBy:2,width:1280,height:720,frameRate:30,bitrateMin:300,bitrateMax:900},{scaleResolutionDownBy:1.333333,width:1280,height:720,frameRate:30,bitrateMin:600,bitrateMax:2e3},{scaleResolutionDownBy:1,width:1280,height:720,frameRate:30,bitrateMin:900,bitrateMax:3e3}],Tee={"480p":is(640,480,5),"480p_1":is(640,480,5),"480p_2":is(640,480,30),"480p_3":is(640,480,15),"720p":is(1280,720,5),"720p_auto":Mt(1280,720,30,900,3e3),"720p_1":is(1280,720,5),"720p_2":is(1280,720,30),"720p_3":is(1280,720,15),"1080p":is(1920,1080,5),"1080p_1":is(1920,1080,5),"1080p_2":is(1920,1080,30),"1080p_3":is(1920,1080,15)},Ree={"1SL1TL":lT(1,1),"3SL3TL":lT(3,3),"2SL3TL":lT(2,3)};function _c(i){return i||(i="480p_1"),typeof i=="string"?Object.assign({},bee[i]):i}function uT(i){return typeof i=="string"?Object.assign({},Tee[i]):i}function gv(i){return typeof i=="string"?Object.assign({},Ree[i]):i}const wee={speech_low_quality:Dh(16e3,!1),speech_standard:Dh(32e3,!1,18),music_standard:Dh(48e3,!1),standard_stereo:Dh(48e3,!0,56),high_quality:Dh(48e3,!1,128),high_quality_stereo:Dh(48e3,!0,192)};function vv(i){return typeof i=="string"?Object.assign({},wee[i]):i}const kh=[];function CL(i){return wr(i,"mediaSource",["screen","window","application"]),!0}var Fe,vn,$l,Ev,dT,Lh,Hl,id,_o,_v;(function(i){i.NEED_RENEGOTIATE="@need_renegotiate",i.NEED_REPLACE_TRACK="@need_replace_track",i.NEED_CLOSE="@need_close",i.NEED_ENABLE_TRACK="@need_enable_track",i.NEED_DISABLE_TRACK="@need_disable_track",i.NEED_SESSION_ID="@need_sid",i.SET_OPTIMIZATION_MODE="@set_optimization_mode",i.GET_STATS="@get_stats",i.GET_RTC_STATS="@get_rtc_stats",i.GET_LOW_VIDEO_TRACK="@get_low_video_track",i.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",i.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",i.NEED_MUTE_TRACK="@need_mute_track",i.NEED_UNMUTE_TRACK="@need_unmute_track"})(Fe||(Fe={})),function(i){i.SCREEN_TRACK="screen_track",i.CUSTOM_TRACK="custome_track",i.LOW_STREAM="low_stream"}(vn||(vn={})),function(i){i[i.HIGH_STREAM=0]="HIGH_STREAM",i[i.LOW_STREAM=1]="LOW_STREAM"}($l||($l={})),function(i){i[i.HIGH_STREAM=0]="HIGH_STREAM",i[i.LOW_STREAM=1]="LOW_STREAM"}(Ev||(Ev={})),function(i){i[i.DISABLE=0]="DISABLE",i[i.LOW_STREAM=1]="LOW_STREAM",i[i.AUDIO_ONLY=2]="AUDIO_ONLY"}(dT||(dT={})),function(i){i.TRANSCEIVER_UPDATED="transceiver-updated"}(Lh||(Lh={})),function(i){i.SOURCE_STATE_CHANGE="source-state-change",i.TRACK_ENDED="track-ended",i.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",i.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",i.CLOSED="closed"}(Hl||(Hl={})),function(i){i.FIRST_FRAME_DECODED="first-frame-decoded",i.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status"}(id||(id={})),function(i){i.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",i.RECEIVE_TRACK_BUFFER="receive_track_buffer",i.ON_AUDIO_BUFFER="on_audio_buffer",i.UPDATE_SOURCE="update_source"}(_o||(_o={})),function(i){i.UPDATE_TRACK_SOURCE="update-track-source"}(_v||(_v={}));const hT={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},pT={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},bL={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},Iee={uplinkNetworkQuality:0,downlinkNetworkQuality:0},TL={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};var Ci,yo,od,Gc,bi;(function(i){i.ON_TRACK="on_track",i.ON_NODE="on_node"})(Ci||(Ci={})),function(i){i.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",i.REQUEST_CONSTRAINTS="request_constraints"}(yo||(yo={})),function(i){i.IDLE="IDLE",i.INITING="INITING",i.INITEND="INITEND"}(od||(od={})),function(i){i.STATE_CHANGE="state_change",i.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",i.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",i.CAMERA_DEVICE_CHANGED="cameraDeviceChanged"}(Gc||(Gc={})),function(i){i.NONE="none",i.INIT="init",i.CANPLAY="canplay",i.PLAYING="playing",i.PAUSED="paused",i.SUSPEND="suspend",i.STALLED="stalled",i.WAITING="waiting",i.ERROR="error",i.DESTROYED="destroyed",i.ABORT="abort",i.ENDED="ended",i.EMPTIED="emptied",i.LOADEDDATA="loadeddata"}(bi||(bi={}));const fT={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};var Mh;(function(i){i.OPEN="open",i.MESSAGE="message",i.CLOSE="close",i.CLOSING="closing",i.ERROR="error"})(Mh||(Mh={}));class RL extends An{constructor(t,r){super(),w(this,"_ID",void 0),w(this,"_rtpTransceiver",void 0),w(this,"_lowRtpTransceiver",void 0),w(this,"_hints",[]),w(this,"_isClosed",!1),w(this,"_originMediaStreamTrack",void 0),w(this,"_mediaStreamTrack",void 0),w(this,"_external",{}),this._ID=r||un(8,"track-"),this._originMediaStreamTrack=t,this._mediaStreamTrack=t,function(a){Ke(kh).call(kh,a)||kh.push(a)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(t){if(!t){const r=He.reportApiInvoke(null,{name:hr.GET_MEDIA_STREAM_TRACK,options:[],tag:Dn.TRACER});this._mediaStreamTrack&&typeof this._mediaStreamTrack.label=="string"?r.onSuccess(this._mediaStreamTrack.label):r.onSuccess("")}return this._mediaStreamTrack}getRTCRtpTransceiver(t){return t===$l.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(t){const r=kh.indexOf(t);r!==-1&&kh.splice(r,1)}(this),this.emit(Hl.CLOSED)}_updateRtpTransceiver(t,r){if(r===$l.LOW_STREAM){if(this._lowRtpTransceiver===t)return;this._lowRtpTransceiver=t}else{if(this._rtpTransceiver===t)return;this._rtpTransceiver=t}this.emit(Lh.TRANSCEIVER_UPDATED,t,r)}}class pi extends RL{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}set processorContext(t){this._processorContext=t}constructor(t,r){super(t,r),w(this,"_enabled",!0),w(this,"_muted",!1),w(this,"_isExternalTrack",!1),w(this,"_isClosed",!1),w(this,"_enabledMutex",void 0),w(this,"processor",void 0),w(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new Mr("".concat(this.getTrackId())),t.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var t,r;return(t=(r=this._originMediaStreamTrack)===null||r===void 0?void 0:r.label)!==null&&t!==void 0?t:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,L.debug("[".concat(this.getTrackId(),"] close")),this.emit(Fe.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(t,r){let a=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this._isExternalTrack=a,t!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),r&&this._originMediaStreamTrack.stop()),t.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=t,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await ln(this,Fe.NEED_REPLACE_TRACK,this),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){L.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Hl.TRACK_ENDED)}stateCheck(t,r){if(L.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(t,": ").concat(r,"]")),Yu(r,t),this._enabled&&this._muted&&t==="enabled"&&r===!1)throw new be(G.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",L);if(!this._enabled&&!this._muted&&t==="muted"&&r===!0)throw new be(G.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",L)}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}function wL(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}const IL=window.AudioContext||window.webkitAudioContext;let na=null;const on=new class extends An{constructor(){super(...arguments),w(this,"prevState",void 0),w(this,"curState",void 0),w(this,"currentTime",void 0),w(this,"currentTimeStuckAt",void 0),w(this,"interruptDetectorTrack",void 0),w(this,"onLocalAudioTrackMute",()=>{L.info("ios15-interruption-start"),this.emit(Ur.IOS_15_16_INTERRUPTION_START)}),w(this,"onLocalAudioTrackUnmute",async()=>{L.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?L.info("ios15-interruption-end-canceled"):(na&&await na.suspend(),this.emit(Ur.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(i){L.debug("webaudio bindInterruptDetectorTrack ".concat(i.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=i,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(i){L.debug("webaudio unbindInterruptDetectorTrack ".concat(i.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===i&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function Aee(){if(!IL)return void L.error("your browser is not support web audio");L.info("create audio context");const i=function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?wL(Object(a),!0).forEach(function(l){w(t,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):wL(Object(a)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(a,l))})}return t}({},Z("WEBAUDIO_INIT_OPTIONS"));L.debug("audio context init option:",JSON.stringify(i)),na=new IL(i),on.curState=na.state,na.onstatechange=()=>{on.prevState=on.curState,on.curState=na?na.state:void 0;const{prevState:t,curState:r}=on,a=r==="running",l=r==="interrupted",u=t==="running",h=t==="suspended",f=t==="interrupted",v=Wt().osVersion;(ki()||fc())&&u&&l&&(L.info("ios".concat(v,"-interruption-start")),on.emit(Ur.IOS_INTERRUPTION_START)),(ki()||fc())&&(h||f)&&a&&(L.info("ios".concat(v,"-interruption-end")),on.emit(Ur.IOS_INTERRUPTION_END)),t!==r&&(L.debug("AudioContext State Change","".concat(t,"=>").concat(r)),on.emit(Ur.STATE_CHANGE))},setInterval(()=>{var t;const r=(t=na)===null||t===void 0?void 0:t.currentTime;on.currentTime!==r?(on.currentTimeStuckAt&&(L.debug("AudioContext current time resume at ".concat(r)),on.currentTimeStuckAt=void 0),on.currentTime=r):(r!==on.currentTimeStuckAt&&(He.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:r},tag:Dn.TRACER}).onSuccess(),L.warning("AudioContext current time stuck at ".concat(r))),on.currentTimeStuckAt=r)},5e3),async function(t){const r=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let a,l=!1,u=!1,h=!1;function f(z){t.state==="running"?v(!1):ki()||fc()?t.state==="suspended"&&(v(!0),z&&t.resume().then(y,y)):t.state!=="closed"&&(v(!0),z&&t.resume().then(y,y))}function v(z){if(l!==z){l=z;for(let X=0,ie=r;X<ie.length;X+=1){const oe=ie[X];z?window.addEventListener(oe,C,{capture:!0,passive:!0}):window.removeEventListener(oe,C,{capture:!0,passive:!0})}}}function E(){f(!0)}function y(){f(!1)}function C(){f(!0)}function I(z){if(!h)if(a.paused)if(z){let X;k(!1),h=!0;try{X=a.play(),X?X.then(W,W):(a.addEventListener("playing",W),a.addEventListener("abort",W),a.addEventListener("error",W))}catch{W()}}else k(!0);else k(!1)}function k(z){if(u!==z){u=z;for(let X=0,ie=r;X<ie.length;X++){const oe=ie[X];z?window.addEventListener(oe,$,{capture:!0,passive:!0}):window.removeEventListener(oe,$,{capture:!0,passive:!0})}}}function W(){a.removeEventListener("playing",W),a.removeEventListener("abort",W),a.removeEventListener("error",W),h=!1,I(!1)}function $(){I(!0)}if(ki()){const z=t.createMediaStreamDestination(),X=document.createElement("div");X.innerHTML="<audio x-webkit-airplay='deny'></audio>",a=X.children.item(0),a.controls=!1,a.disableRemotePlayback=!0,a.preload="auto",a.srcObject=z.stream,I(!0)}on.on(Ur.STATE_CHANGE,E),f(!1)}(na)}function Fh(){if(!na){if(Aee(),!na)throw new be(G.NOT_SUPPORTED,"can not create audio context");return na}return na}function AL(){return!!na}function ad(i){if(function(){if(mT!==null)return mT;const a=Fh(),l=a.createBufferSource(),u=a.createGain(),h=a.createGain();l.connect(u),l.connect(h),l.disconnect(u);let f=!1;try{l.disconnect(u)}catch{f=!0}return l.disconnect(),mT=f,f}())return;const t=i.connect,r=i.disconnect;i.connect=(a,l,u)=>{var h;return i._inputNodes||(i._inputNodes=[]),Ke(h=i._inputNodes).call(h,a)||(a instanceof AudioNode?(i._inputNodes.push(a),t.call(i,a,l,u)):t.call(i,a,l)),i},i.disconnect=(a,l,u)=>{r.call(i),a?wb(i._inputNodes,a):i._inputNodes=[];for(const h of i._inputNodes)t.call(i,h)}}let mT=null;function gT(i,t){let r=!1;const a=1/t;if(Z("DISABLE_WEBAUDIO")){const l=window.setInterval(()=>{r?window.clearInterval(l):i(performance.now()/1e3)},1e3*a)}else{const l=Fh();let u=l.createGain();u.gain.value=0,u.connect(l.destination);const h=()=>{if(r)return void(u=null);const f=l.createOscillator();f.onended=h,f.connect(u),f.start(0),f.stop(l.currentTime+a),i(l.currentTime)};h()}return()=>{r=!0}}const Ti={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1};function fn(){return Ti}class OL{constructor(){w(this,"context",void 0),w(this,"analyserNode",void 0),w(this,"sourceNode",void 0),this.context=Fh(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(t){if(t!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=t,t==null||t.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||ki()||fc()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;const t=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(t);else{const a=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(a);for(let l=0;l<t.length;++l)t[l]=a[l]/128-1}const r=Qu(t).call(t,(a,l)=>a+l*l,0)/t.length;return Math.max(10*Math.log10(r)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var t,r;(t=this.sourceNode)===null||t===void 0||t.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(r=this.sourceNode)===null||r===void 0||r.connect(this.analyserNode)}catch{L.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class xL extends An{get processSourceNode(){return this.sourceNode}set processedNode(t){var r;if(!this.isDestroyed&&this._processedNode!==t){try{var a;(a=this.sourceNode)===null||a===void 0||a.disconnect(this.outputNode)}catch{}(r=this._processedNode)===null||r===void 0||r.disconnect(),this._processedNode=t,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),w(this,"outputNode",void 0),w(this,"outputTrack",void 0),w(this,"isPlayed",!1),w(this,"context",void 0),w(this,"audioBufferNode",void 0),w(this,"destNode",void 0),w(this,"audioOutputLevel",0),w(this,"volumeLevelAnalyser",void 0),w(this,"_processedNode",void 0),w(this,"playNode",void 0),w(this,"isDestroyed",!1),w(this,"onNoAudioInput",void 0),w(this,"isNoAudioInput",!1),w(this,"_noAudioInputCount",0),this.context=Fh(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),ad(this.outputNode),this.volumeLevelAnalyser=new OL}startGetAudioBuffer(t){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(t),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=r=>{this.emit(_o.ON_AUDIO_BUFFER,function(a){for(let l=0;l<a.outputBuffer.numberOfChannels;l+=1){const u=a.outputBuffer.getChannelData(l);for(let h=0;h<u.length;h+=1)u[h]=0}return a.inputBuffer}(r))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!fn().webAudioMediaStreamDest)throw new be(G.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(t){this.context.state!=="running"&&ns(()=>{on.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=t||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(t>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;ki()||fc()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();const r=this.volumeLevelAnalyser.getAnalyserNode();let a;r.getFloatTimeDomainData?(a=new Float32Array(r.fftSize),r.getFloatTimeDomainData(a)):(a=new Uint8Array(r.fftSize),r.getByteTimeDomainData(a));let l=!1;for(let u=0;u<a.length;u++)a[u]!==0&&(l=!0);return l?(this.isNoAudioInput=!1,!0):(await ni(200),await this.checkHasAudioInput(t?t+1:1)&&l)}getAudioVolume(){return this.outputNode.gain.value}setVolume(t){this.outputNode.gain.setValueAtTime(t,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var t,r;(t=this.processedNode)===null||t===void 0||t.disconnect(),(r=this.sourceNode)===null||r===void 0||r.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var t;this.processedNode?(t=this.processedNode)===null||t===void 0||t.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class vT extends xL{get isFreeze(){return!1}constructor(t,r,a){var l;if(super(),w(this,"sourceNode",void 0),w(this,"track",void 0),w(this,"clonedTrack",void 0),w(this,"audioElement",void 0),w(this,"isCurrentTrackCloned",!1),w(this,"isRemoteTrack",!1),w(this,"originVolumeLevelAnalyser",void 0),w(this,"rebuildWebAudio",async()=>{if(L.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void L.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>L.info("resume success")),L.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const f=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?f.stop():this.isCurrentTrackCloned=!0;const v=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(v),ad(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const E=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(E,this.context.currentTime),ad(this.outputNode),this.emit(_o.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=v,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),t.kind!=="audio")throw new be(G.UNEXPECTED_ERROR);this.track=t;const u=new MediaStream([this.track]);if(this.isRemoteTrack=!!r,this.sourceNode=this.context.createMediaStreamSource(u),ad(this.sourceNode),a){const f=a.clone();f.enabled=!0,this.clonedTrack=f,L.debug("create an unmuted track ".concat(f.id," from the original track ").concat(a.id," to get the volume"));const v=this.context.createMediaStreamSource(new MediaStream([f]));ad(v),this.originVolumeLevelAnalyser=new OL,this.originVolumeLevelAnalyser.updateSource(v)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=u;const h=Wt();r&&h.os===Rr.IOS&&Number((l=h.osVersion)===null||l===void 0?void 0:l.split(".")[0])<15&&(on.on(Ur.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(f=>{f||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(t){this.sourceNode.disconnect(),this.track=t,this.isCurrentTrackCloned=!1;const r=new MediaStream([t]);this.sourceNode=this.context.createMediaStreamSource(r),ad(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(_o.UPDATE_SOURCE),this.audioElement.srcObject=r}destroy(){var t;this.audioElement.srcObject=null,this.audioElement.remove(),on.off("state-change",this.rebuildWebAudio),(t=this.originVolumeLevelAnalyser)===null||t===void 0||t.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(t){return this.context.createMediaStreamSource(new MediaStream([t]))}updateOriginTrack(t){const r=t.clone();r.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=r),L.debug("create an unmuted track ".concat(r.id," from the original track ").concat(t.id," to get the volume"));const a=this.context.createMediaStreamSource(new MediaStream([r]));ad(a),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(a)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function NL(i,t,r){const a=(u,h)=>u?typeof u!="number"?u.max||u.exact||u.ideal||u.min||h:u:h,l={audio:!!r&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxHeight:a(t.height,1080),maxWidth:a(t.width,1920)}}};return t.frameRate&&typeof t.frameRate!="number"?(l.video.mandatory.maxFrameRate=t.frameRate.max,l.video.mandatory.minFrameRate=t.frameRate.min):typeof t.frameRate=="number"&&(l.video.mandatory.maxFrameRate=t.frameRate),await navigator.mediaDevices.getUserMedia(l)}async function Oee(i,t){const r=await PL(i.mediaSource),{sourceId:a,audio:l}=await function(u){let h=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new me((f,v)=>{const E=document.createElement("div");E.innerText="share screen",E.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const y=document.createElement("div");y.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const C=document.createElement("div");C.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",C.setAttribute("style","height: 12%;");const I=document.createElement("div");I.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const k=document.createElement("div");k.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const W=document.createElement("button");W.innerHTML="cancel",W.setAttribute("style","width: 85px;"),W.onclick=()=>{document.body.removeChild(X);const ie=new Error("NotAllowedError");ie.name="NotAllowedError",v(ie)};let $=h;const z=document.createElement("div");if(h){const ie=document.createElement("input");ie.setAttribute("type","checkbox");const oe=document.createElement("span");ie.setAttribute("style","margin-right: 6px;"),oe.innerText="Share audio",ie.checked=$,ie.onchange=()=>{$=ie.checked},z.appendChild(ie),z.appendChild(oe)}k.appendChild(z),k.appendChild(W),y.appendChild(C),y.appendChild(I),y.appendChild(k);const X=document.createElement("div");X.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),X.appendChild(E),X.appendChild(y),document.body.appendChild(X),u.map(ie=>{if(ie.id){const oe=document.createElement("div");oe.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let Re=ie.thumbnail;try{const{width:Ce}=Re.getSize();Ce>1920&&(Re=Re.resize({width:1920}))}catch(Ce){throw Ce&&Ce.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),Ce}oe.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+Re.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+ie.name.replace(/[\u00A0-\u9999<>\&]/g,function(Ce){return"&#"+Ce.charCodeAt(0)+";"})+"</span>",oe.onclick=()=>{document.body.removeChild(X),f({sourceId:ie.id,audio:$})},I.appendChild(oe)}})})}(r,t);return await NL(a,i,l)}async function PL(i){let t=["window","screen"];i!=="application"&&i!=="window"||(t=["window"]),i==="screen"&&(t=["screen"]);const r=Vk();if(!r)throw console.error("failed to fetch electron, please mount it to window"),new be(G.ELECTRON_IS_NULL);let a=null;try{var l;a=((l=r.desktopCapturer)===null||l===void 0?void 0:l.getSources({types:t}))||r.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:t})}catch{a=null}a&&a.then||(a=new me((u,h)=>{r.desktopCapturer.getSources({types:t},(f,v)=>{f?h(f):u(v)})}));try{return await a}catch(u){throw new be(G.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,u.toString())}}function DL(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}const ET=new Mr("safari");let kL=!1,LL=!1;async function ra(i,t){let r=0,a=null;for(;r<2;)try{a=await xee(i,t,r>0);break}catch(l){if(l instanceof be)throw L.error("[".concat(t,"] ").concat(l.toString())),l;const u=yv(l.name||l.code||l,l.message);if(u.code===G.MEDIA_OPTION_INVALID){L.debug("[".concat(t,"] detect media option invalid, retry")),r+=1,await ni(500);continue}throw L.error("[".concat(t,"] ").concat(u.toString())),u}if(!a)throw new be(G.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return a}async function xee(i,t,r){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new be(G.NOT_SUPPORTED,"can not find getUserMedia");r&&(i.video&&(delete i.video.width,delete i.video.height),i.screen&&(delete i.screen.width,delete i.screen.height));const a=fn(),l=new MediaStream;if(i.audioSource&&l.addTrack(i.audioSource),i.videoSource&&l.addTrack(i.videoSource),!i.audio&&!i.video&&!i.screen)return L.debug("Using Video Source/ Audio Source"),l;if(i.screen)if(Vk())i.screen.sourceId?Uh(l,await NL(i.screen.sourceId,i.screen,i.screenAudio)):Uh(l,await Oee(i.screen,i.screenAudio));else if(yb()&&i.screen.extensionId&&i.screen.mandatory){if(!a.getStreamFromExtension)throw new be(G.NOT_SUPPORTED,"This browser does not support screen sharing");L.debug("[".concat(t,'] Screen access on chrome stable, looking for extension"'));const I=await(h=i.screen.extensionId,f=t,new me((k,W)=>{try{chrome.runtime.sendMessage(h,{getStream:!0},$=>{if(!$||!$.streamId)return L.error("[".concat(f,"] No response from Chrome Plugin. Plugin not installed properly"),$),void W(new be(G.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));k($.streamId)})}catch($){L.error("[".concat(f,"] AgoraRTC screensharing plugin is not accessible(").concat(h,")"),$.toString()),W(new be(G.CHROME_PLUGIN_NOT_INSTALL))}}));i.screen.mandatory.chromeMediaSourceId=I,Uh(l,await navigator.mediaDevices.getUserMedia({video:{mandatory:i.screen.mandatory}}))}else if(a.getDisplayMedia){var u;i.screen.mediaSource&&CL(i.screen.mediaSource);const I={width:i.screen.width,height:i.screen.height,frameRate:i.screen.frameRate,displaySurface:(u=i.screen.displaySurface)!==null&&u!==void 0?u:i.screen.mediaSource==="screen"?"monitor":i.screen.mediaSource},{selfBrowserSurface:k,surfaceSwitching:W,systemAudio:$}=i.screen,z={selfBrowserSurface:k,surfaceSwitching:W,systemAudio:$};!k&&delete z.selfBrowserSurface,!W&&delete z.surfaceSwitching,!$&&delete z.systemAudio,L.debug("[".concat(t,"] getDisplayMedia:"),JSON.stringify({video:I,audio:!!i.screenAudio,controls:z}));const X=await navigator.mediaDevices.getDisplayMedia(function(ie){for(var oe=1;oe<arguments.length;oe++){var Re=arguments[oe]!=null?arguments[oe]:{};oe%2?DL(Object(Re),!0).forEach(function(Ce){w(ie,Ce,Re[Ce])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ie,Object.getOwnPropertyDescriptors(Re)):DL(Object(Re)).forEach(function(Ce){Object.defineProperty(ie,Ce,Object.getOwnPropertyDescriptor(Re,Ce))})}return ie}({video:I,audio:!!i.screenAudio},z));Uh(l,X)}else{if(!Cn())throw L.error("[".concat(t,"] This browser does not support screenSharing")),new be(G.NOT_SUPPORTED,"This browser does not support screen sharing");{i.screen.mediaSource&&CL(i.screen.mediaSource);const I={video:{mediaSource:i.screen.mediaSource,width:i.screen.width,height:i.screen.height,frameRate:i.screen.frameRate}};L.debug("[".concat(t,"] getUserMedia: ").concat(JSON.stringify(I))),Uh(l,await navigator.mediaDevices.getUserMedia(I))}}var h,f;if(!i.video&&!i.audio)return l;let v={video:i.video,audio:i.audio},E=Z("MEDIA_DEVICE_CONSTRAINTS");if(E)try{typeof E=="string"&&(E=JSON.parse(E)),v=Ab(v,E)}catch{}L.debug("[".concat(t,"] GetUserMedia"),JSON.stringify(v)),Wt();let y,C=null;(Di()||ki()||Gg())&&(C=await ET.lock());try{y=await navigator.mediaDevices.getUserMedia(v)}catch(I){throw C&&C(),I}return v.audio&&(kL=!0),v.video&&(LL=!0),Uh(l,y),C&&C(),l}function yv(i,t){switch(i){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new be(G.MEDIA_OPTION_INVALID,"".concat(i,": ").concat(t));case"NotFoundError":case"DevicesNotFoundError":return new be(G.DEVICE_NOT_FOUND,"".concat(i,": ").concat(t));case"NotSupportedError":return new be(G.NOT_SUPPORTED,"".concat(i,": ").concat(t));case"NotReadableError":return new be(G.NOT_READABLE,"".concat(i,": ").concat(t));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new be(G.PERMISSION_DENIED,"".concat(i,": ").concat(t));case"ConstraintNotSatisfiedError":return new be(G.CONSTRAINT_NOT_SATISFIED,"".concat(i,": ").concat(t));default:return L.error("getUserMedia unexpected error",i),new be(G.UNEXPECTED_ERROR,"".concat(i,": ").concat(t))}}function Uh(i,t){const r=i.getVideoTracks()[0],a=i.getAudioTracks()[0],l=t.getVideoTracks()[0],u=t.getAudioTracks()[0];u&&(a&&i.removeTrack(a),i.addTrack(u)),l&&(r&&i.removeTrack(r),i.addTrack(l))}const ia=new class extends An{get state(){return this._state}set state(i){i!==this._state&&(this.emit(Gc.STATE_CHANGE,i),this._state=i)}constructor(){super(),w(this,"_state",od.IDLE),w(this,"isAccessMicrophonePermission",!1),w(this,"isAccessCameraPermission",!1),w(this,"lastAccessMicrophonePermission",!1),w(this,"lastAccessCameraPermission",!1),w(this,"checkdeviceMatched",!1),w(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(Z("ENUMERATE_DEVICES_INTERVAL")||(Kg()||zg()===Rr.HARMONY_OS)&&Ll())&&this.updateDevicesInfo()},Z("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(i=>L.error(i.toString()))}async enumerateDevices(i,t){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new be(G.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const a=await navigator.mediaDevices.enumerateDevices(),l=this.checkMediaDeviceInfoIsOk(a);let u=!this.isAccessMicrophonePermission&&i,h=!this.isAccessCameraPermission&&t;l.audio&&(u=!1),l.video&&(h=!1);let f=null,v=null,E=null;if(!r&&(u||h)){if(ET.isLocked&&(L.debug("[device manager] wait GUM lock"),(await ET.lock())(),L.debug("[device manager] GUM unlock")),kL&&(u=!1,this.isAccessMicrophonePermission=!0),LL&&(h=!1,this.isAccessCameraPermission=!0),L.debug("[device manager] check media device permissions",i,t,u,h),u&&h){try{E=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(y){const C=yv(y.name||y.code||y,y.message);if(C.code===G.PERMISSION_DENIED)throw C;L.warning("getUserMedia failed in getDevices",C)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(u){try{f=await navigator.mediaDevices.getUserMedia({audio:i})}catch(y){const C=yv(y.name||y.code||y,y.message);if(C.code===G.PERMISSION_DENIED)throw C;L.warning("getUserMedia failed in getDevices",C)}this.isAccessMicrophonePermission=!0}else if(h){try{v=await navigator.mediaDevices.getUserMedia({video:t})}catch(y){const C=yv(y.name||y.code||y,y.message);if(C.code===G.PERMISSION_DENIED)throw C;L.warning("getUserMedia failed in getDevices",C)}this.isAccessCameraPermission=!0}L.debug("[device manager] mic permission",i,"cam permission",t)}try{const y=await navigator.mediaDevices.enumerateDevices();return f&&f.getTracks().forEach(C=>C.stop()),v&&v.getTracks().forEach(C=>C.stop()),E&&E.getTracks().forEach(C=>C.stop()),f=null,v=null,E=null,y}catch(y){return f&&f.getTracks().forEach(C=>C.stop()),v&&v.getTracks().forEach(C=>C.stop()),E&&E.getTracks().forEach(C=>C.stop()),f=null,v=null,E=null,new be(G.ENUMERATE_DEVICES_FAILED,y.toString()).throw()}}async getRecordingDevices(){let i=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,i)).filter(t=>t.kind==="audioinput")}async getCamerasDevices(){let i=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,i)).filter(t=>t.kind==="videoinput")}async getSpeakers(){let i=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,i)).filter(t=>t.kind==="audiooutput")}searchDeviceIdByName(i){let t=null;return this.deviceInfoMap.forEach(r=>{r.device.label===i&&(t=r.device.deviceId)}),t}async getDeviceById(i){const t=(await this.enumerateDevices(!0,!0,!0)).find(r=>r.deviceId===i);if(!t)throw new be(G.DEVICE_NOT_FOUND,"deviceId: ".concat(i));return t}async init(){this.state=od.INITING;try{await this.updateDevicesInfo(),this.state=od.INITEND}catch(i){throw L.warning("Device Detection functionality cannot start properly.",i.toString()),this.state=od.IDLE,!(typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1")&&new be(G.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),i}}async updateDevicesInfo(){const i=await this.enumerateDevices(!0,!0,!0),t=Date.now(),r=[];if(i[0]&&i[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const l=i.find(h=>h.kind==="audioinput"&&h.deviceId==="default"),u=i.find(h=>h.kind==="audiooutput"&&h.deviceId==="default");l&&u?u.groupId===l.groupId?L.debug("[device-check] default input ".concat(l.label," and output ").concat(u.label," is the same group")):L.warning("[device-check] default input ".concat(l.label," and output ").concat(u.label," is not the same group")):L.debug("[device-check] default input or output not found")}const a=this.checkMediaDeviceInfoIsOk(i);if(i.forEach(l=>{if(!l.deviceId)return;const u=this.deviceInfoMap.get("".concat(l.kind,"_").concat(l.deviceId));if((u?u.state:"INACTIVE")!=="ACTIVE"){const h={initAt:t,updateAt:t,device:l,state:"ACTIVE"};this.deviceInfoMap.set("".concat(l.kind,"_").concat(l.deviceId),h),r.push(h)}u&&(u.updateAt=t)}),this.deviceInfoMap.forEach((l,u)=>{l.state==="ACTIVE"&&l.updateAt!==t&&(l.state="INACTIVE",r.push(l))}),this.state!==od.INITEND)return a.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(a.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));r.forEach(l=>{switch(l.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(Gc.RECORDING_DEVICE_CHANGED,l);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(Gc.CAMERA_DEVICE_CHANGED,l);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(Gc.PLAYOUT_DEVICE_CHANGED,l)}}),a.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),a.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(i){const t=i.filter(l=>l.kind==="audioinput"),r=i.filter(l=>l.kind==="videoinput"),a={audio:!1,video:!1};for(const l of t)if(l.label&&l.deviceId){a.audio=!0;break}for(const l of r)if(l.label&&l.deviceId){a.video=!0;break}return a}};let _T=!1;const oa=new class extends An{constructor(){super(...arguments),w(this,"onAutoplayFailed",void 0),w(this,"onAudioAutoplayFailed",void 0)}};function ML(){if(Wt(),!_T){const i=t=>{t.preventDefault(),_T=!1,Vf()?document.body.removeEventListener("click",i,!0):(document.body.removeEventListener("touchstart",i,!0),document.body.removeEventListener("mousedown",i,!0))};_T=!0,Vf()?document.body.addEventListener("click",i,!0):(document.body.addEventListener("touchstart",i,!0),document.body.addEventListener("mousedown",i,!0)),L.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),oa.onAutoplayFailed?oa.onAutoplayFailed():oa.onAudioAutoplayFailed?L.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):L.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),oa.emit("autoplay-failed")}}function FL(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function UL(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FL(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):FL(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}function BL(i,t,r,a){if(!i)return;const l=He.getBaseInfoBySessionId(i);if(!l)return;const u=l.info,h=Date.now(),f=UL(UL({},u),{},{vid:u.vid===void 0?0:Number(u.vid),lts:h,elapse:h-l.startTime,cbRegistered:oa.onAutoplayFailed||oa.onAudioAutoplayFailed?1:-1,errorMsg:r,mediaType:t,trackId:a,extend:void 0});He.send({type:On.AUTOPLAY_FAILED,data:f},!0)}const Nee=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],ko=new class{constructor(){w(this,"onAutoplayFailed",void 0),w(this,"elementMap",new Map),w(this,"elementStateMap",new Map),w(this,"elementsNeedToResume",[]),w(this,"sinkIdMap",new Map),w(this,"autoResumeAfterInterruption",()=>{Array.from(this.elementMap.entries()).forEach(i=>{let[t,r]=i;const a=this.elementStateMap.get(t),l=r.srcObject.getAudioTracks()[0];Sh()?l&&l.readyState==="live"&&on.curState==="running"&&(L.debug("auto resume after interruption for iOS 15"),r.pause(),r.play()):a&&a==="paused"&&l&&l.readyState==="live"&&on.curState==="running"&&(L.debug("auto resume after interruption for iOS"),r.play())})}),w(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(i=>{let[t,r]=i;const a=r.srcObject.getAudioTracks()[0];a&&a.readyState==="live"&&(L.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),r.pause(),r.play())})}),this.autoResumeAudioElement(),on.on(Ur.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),on.on(Ur.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),on.on(Ur.STATE_CHANGE,()=>{ki()&&on.prevState==="suspended"&&on.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(i,t){const r=this.elementMap.get(i);if(this.sinkIdMap.set(i,t),r)try{await r.setSinkId(t)}catch(a){throw new be(G.PERMISSION_DENIED,"can not set sink id: "+a.toString())}}play(i,t,r,a){if(this.elementMap.has(t))return;const l=document.createElement("audio");l.autoplay=!0,l.srcObject=new MediaStream([i]),this.bindAudioElementEvents(t,l),this.elementMap.set(t,l),this.elementStateMap.set(t,bi.INIT),this.setVolume(t,r);const u=this.sinkIdMap.get(t);if(u)try{l.setSinkId(u).catch(f=>{L.warning("[".concat(t,"] set sink id failed"),f.toString())})}catch(f){L.warning("[".concat(t,"] set sink id failed"),f.toString())}const h=l.play();h&&h.then&&h.catch(f=>{a&&BL(a,"audio",f.message,t),L.warning("audio element play warning",f.toString()),this.elementMap.has(t)&&f.name==="NotAllowedError"&&(L.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(l),ns(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),ML()}))})}updateTrack(i,t){const r=this.elementMap.get(i);r&&(r.srcObject=new MediaStream([t]))}isPlaying(i){return this.elementMap.has(i)&&this.elementStateMap.get(i)==="playing"}setVolume(i,t){const r=this.elementMap.get(i);r&&(t=Math.max(0,Math.min(100,t)),r.volume=t/100)}stop(i){const t=this.elementMap.get(i);if(this.sinkIdMap.delete(i),!t)return;const r=this.elementsNeedToResume.indexOf(t);this.elementsNeedToResume.splice(r,1),t.srcObject=null,t.remove(),this.elementMap.delete(i),this.elementStateMap.delete(i)}bindAudioElementEvents(i,t){Nee.forEach(r=>{t.addEventListener(r,a=>{const l=this.elementStateMap.get(i),u=a.type==="pause"?"paused":a.type;if(L.debug("[".concat(i,"] audio-element-status change ").concat(l," => ").concat(u)),a.type==="error"){const h=t==null?void 0:t.error;h&&L.error("[".concat(i,"] media error, code: ").concat(h.code,", message: ").concat(h.message))}this.elementStateMap.set(i,u)})})}getPlayerState(i){return this.elementStateMap.get(i)||"uninit"}autoResumeAudioElement(){const i=()=>{this.elementsNeedToResume.forEach(t=>{t.play().then(r=>{L.debug("Auto resume audio element success")}).catch(r=>{L.warning("Auto resume audio element failed!",r)})}),this.elementsNeedToResume=[]};new me(t=>{document.body?t():window.addEventListener("load",()=>t())}).then(()=>{Vf()?document.body.addEventListener("click",i,!0):(document.body.addEventListener("touchstart",i,!0),document.body.addEventListener("mousedown",i,!0))})}};function Yn(){return function(i,t,r){const a=r.value;return typeof a=="function"&&(r.value=function(){this._isClosed&&new be(G.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",L);for(var l=arguments.length,u=new Array(l),h=0;h<l;h++)u[h]=arguments[h];const f=a.apply(this,u);return f instanceof me?new me((v,E)=>{f.then(v).catch(E)}):f}),r}}function jL(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function Sv(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jL(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):jL(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}class VL extends An{constructor(t){super(),w(this,"name","VideoProcessorDestination"),w(this,"ID","0"),w(this,"_source",void 0),w(this,"videoContext",void 0),w(this,"inputTrack",void 0),this.videoContext=t}get kind(){return"video"}get enabled(){return!0}pipe(){throw new be(G.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new be(G.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(t){if(t.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);t.track&&t.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=t.track,this.emit(Ci.ON_TRACK,t.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(Ci.ON_TRACK,void 0)}}class $L extends An{set chained(t){this._chained=t}get chained(){return this._chained}constructor(t,r){super(),w(this,"constraintsMap",new Map),w(this,"statsRegistry",[]),w(this,"usageRegistry",[]),w(this,"trackId",void 0),w(this,"direction",void 0),w(this,"_chained",!1),this.trackId=t,this.direction=r}async getConstraints(){return await Ln(this,yo.REQUEST_CONSTRAINTS)}async requestApplyConstraints(t,r){var a;return L.info("processor ".concat(r.name," requestApplyConstraints for ").concat(this.trackId)),t&&this.constraintsMap.set(r,t),ln(this,yo.REQUEST_UPDATE_CONSTRAINTS,Array.from(gc(a=this.constraintsMap).call(a)))}async requestRevertConstraints(t){var r;if(this.constraintsMap.has(t))return L.info("processor ".concat(t.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(t),ln(this,yo.REQUEST_UPDATE_CONSTRAINTS,Array.from(gc(r=this.constraintsMap).call(r)))}registerStats(t,r,a){this.statsRegistry.find(l=>l.processorID===t.ID&&l.processorName===t.name&&l.type===r)||this.statsRegistry.push({processorName:t.name,processorID:t.ID,type:r,cb:a})}unregisterStats(t,r){const a=this.statsRegistry.findIndex(l=>l.processorID===t.ID&&l.processorName===t.name&&l.type===r);a!==-1&&this.statsRegistry.splice(a,1)}gatherStats(){const t=[];for(const{processorID:r,processorName:a,type:l,cb:u}of this.statsRegistry)try{const h=u();t.push({processorID:r,processorName:a,type:l,stats:h})}catch(h){L.error(new be(G.UNEXPECTED_ERROR,h.message))}return t}registerUsage(t,r){this.usageRegistry.find(a=>a.processorID===t.ID&&a.processorName===t.name)||this.usageRegistry.push({processorID:t.ID,processorName:t.name,cb:r})}unregisterUsage(t){const r=this.usageRegistry.findIndex(a=>a.processorID===t.ID&&a.processorName===t.name);r!==-1&&this.usageRegistry.splice(r,1)}async gatherUsage(){const t=[];if(!this.chained)return[];for(const{cb:r}of this.usageRegistry)try{let a=r();a instanceof me&&(a=await a),t.push(Sv(Sv({},a),{},{direction:this.direction}))}catch(a){L.error("gather extension usage error",a)}return t}getDirection(){return this.direction}}class Cv extends An{constructor(t){super(),w(this,"name","AudioProcessorDestination"),w(this,"ID","0"),w(this,"inputTrack",void 0),w(this,"inputNode",void 0),w(this,"audioProcessorContext",void 0),w(this,"_source",void 0),this.audioProcessorContext=t}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new be(G.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new be(G.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(Ci.ON_TRACK,void 0),this.emit(Ci.ON_NODE,void 0)}updateInput(t){if(t.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);t.track&&this.inputTrack!==t.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=t.track,this.emit(Ci.ON_TRACK,this.inputTrack)),t.node&&this.inputNode!==t.node&&(this.audioProcessorContext.chained=!0,this.inputNode=t.node,this.emit(Ci.ON_NODE,this.inputNode))}}class bv extends An{set chained(t){this._chained=t}get chained(){return this._chained}constructor(t,r,a){super(),w(this,"constraintsMap",new Map),w(this,"statsRegistry",[]),w(this,"audioContext",void 0),w(this,"trackId",void 0),w(this,"direction",void 0),w(this,"usageRegistry",[]),w(this,"_chained",!1),this.audioContext=t,this.trackId=r,this.direction=a}async getConstraints(){return Ln(this,yo.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(t,r){var a;return L.info("processor ".concat(r.name," requestApplyConstraints for ").concat(this.trackId)),t&&this.constraintsMap.set(r,t),ln(this,yo.REQUEST_UPDATE_CONSTRAINTS,Array.from(gc(a=this.constraintsMap).call(a)))}async requestRevertConstraints(t){var r;if(this.constraintsMap.has(t))return this.constraintsMap.delete(t),ln(this,yo.REQUEST_UPDATE_CONSTRAINTS,Array.from(gc(r=this.constraintsMap).call(r)))}registerStats(t,r,a){this.statsRegistry.find(l=>l.processorID===t.ID&&l.processorName===t.name&&l.type===r)||this.statsRegistry.push({processorName:t.name,processorID:t.ID,type:r,cb:a})}unregisterStats(t,r){const a=this.statsRegistry.findIndex(l=>l.processorID===t.ID&&l.processorName===t.name&&l.type===r);a!==-1&&this.statsRegistry.splice(a,1)}gatherStats(){const t=[];for(const{processorID:r,processorName:a,type:l,cb:u}of this.statsRegistry)try{const h=u();t.push({processorID:r,processorName:a,type:l,stats:h})}catch(h){L.error(new be(G.UNEXPECTED_ERROR,h.message))}return t}registerUsage(t,r){this.usageRegistry.find(a=>a.processorID===t.ID&&a.processorName===t.name)||this.usageRegistry.push({processorID:t.ID,processorName:t.name,cb:r})}unregisterUsage(t){const r=this.usageRegistry.findIndex(a=>a.processorID===t.ID&&a.processorName===t.name);r!==-1&&this.usageRegistry.splice(r,1)}async gatherUsage(){const t=[];if(!this.chained)return[];for(const{cb:r}of this.usageRegistry)try{let a=r();a instanceof me&&(a=await a),t.push(Sv(Sv({},a),{},{direction:this.direction}))}catch(a){L.error("gather extension usage error",a)}return t}getDirection(){return this.direction}}class yT extends An{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),w(this,"context",void 0),w(this,"processSourceNode",void 0),w(this,"outputTrack",void 0),w(this,"processedNode",void 0),w(this,"clonedTrack",void 0),w(this,"outputNode",void 0),this.outputNode=new Pee}setVolume(){}createOutputTrack(){throw new be(G.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class Pee{disconnect(){}connect(){}}let Bh=null;class Dee{constructor(){w(this,"state","open"),w(this,"trigger",void 0),w(this,"tasks",[]),L.debug("[macro-task-queue] is created."),this.trigger=window.setTimeout(()=>{this.state="closed",L.debug("[macro-task-queue] will be closed, all remaining tasks will execute. [".concat(this.tasks.map(t=>t.key),"]")),this.trigger=void 0,this.tasks.forEach(t=>{let{func:r}=t;return r()}),this.tasks.length=0,L.debug("[macro-task-queue] is closed.")})}enqueue(t,r){this.state!=="closed"&&(this.tasks.push({key:t,func:r}),L.debug("[macro-task-queue] is queued, current queue ".concat(this.tasks.length,". ").concat(typeof t=="string"?t:"")))}runTask(t){if(this.state==="closed")return;const r=this.tasks.findIndex(a=>a.key===t);if(r!==-1){const a=this.tasks.splice(r,1);L.debug("[macro-task-queue] is unqueued, current queue ".concat(this.tasks.length,". ").concat(typeof t=="string"?t:"")),a[0].func()}}release(){this.trigger&&(this.state="closed",clearTimeout(this.trigger),this.trigger=void 0,this.tasks.length=0,L.debug("[macro-task-queue] is closed."))}}function ST(i){return function(t,r,a){var l;const u=(l=a.value)!==null&&l!==void 0?l:a.get,h=function(){Bh&&Bh.state==="open"&&Bh.runTask(i);for(var f=arguments.length,v=new Array(f),E=0;E<f;E++)v[E]=arguments[E];return u==null?void 0:u.apply(this,...v)};return a.value?a.value=h:a.get=h,a}}function HL(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function CT(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HL(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):HL(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}class en extends pi{get _source(){return this._trackSource}set _source(t){this._trackSource=t}get processorContext(){return this._processorContext}set processorContext(t){this._processorContext=t}get processorDestination(){return this._processorDestination}set processorDestination(t){this._processorDestination=t}get isPlaying(){return this._useAudioElement?ko.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(t,r,a,l,u){super(t,a),w(this,"trackMediaType","audio"),w(this,"_encoderConfig",void 0),w(this,"_trackSource",void 0),w(this,"_enabled",!0),w(this,"_volume",100),w(this,"_useAudioElement",!1),w(this,"_bypassWebAudio",!1),w(this,"processor",void 0),w(this,"_processorContext",void 0),w(this,"_processorDestination",void 0),w(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=r,this._getOriginVolumeLevel=!!l;const h=()=>{this.processorContext=new bv(this._source.context,this.getTrackId(),"local"),this.processorDestination=new Cv(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(_o.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})},f=u&&Di()&&!AL();Z("DISABLE_WEBAUDIO")?(this._source=new yT,this._useAudioElement=!0,this._bypassWebAudio=!0):f?this._source=new yT:(this._source=new vT(t,!1,this._getOriginVolumeLevel?t:void 0),Z("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")||(this._useAudioElement=!0)),h(),!Z("DISABLE_WEBAUDIO")&&f&&(Bh||(Bh=new Dee),Bh).enqueue("INIT_WEBAUDIO",()=>{this._source=new vT(t,!1,this._getOriginVolumeLevel?t:void 0),Z("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")||(this._useAudioElement=!0),h(),this.emit(_v.UPDATE_TRACK_SOURCE)})}setVolume(t){cn(t,"volume",0,1e3),this._volume=t,this._source.setVolume(t/100),this._useAudioElement&&ko.setVolume(this.getTrackId(),t);try{if(this._bypassWebAudio)return void L.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const r=this._source.createOutputTrack();this._mediaStreamTrack!==r&&(this._mediaStreamTrack=r,ln(this,Fe.NEED_REPLACE_TRACK,this).then(()=>{L.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(a=>{L.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),a)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(t){if(!this._useAudioElement)throw new be(G.NOT_SUPPORTED,"your browser does not support setting the audio output device");await ko.setSinkID(this.getTrackId(),t)}async setEnabled(t,r,a){return this._setEnabled(t,r,a)}async _setEnabled(t,r,a){if(!a){if(t===this._enabled)return;this.stateCheck("enabled",t)}if(L.info("[".concat(this.getTrackId(),"] start setEnabled"),t),t){this._originMediaStreamTrack.enabled=!0;try{a||(this._enabled=!0),await ln(this,Fe.NEED_ENABLE_TRACK,this),L.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(t," success"))}catch(l){throw a||(this._enabled=!1),L.error("[".concat(this.getTrackId(),"] setEnabled to true error"),l.toString()),l}}else{this._originMediaStreamTrack.enabled=!1,a||(this._enabled=!1);try{await ln(this,Fe.NEED_DISABLE_TRACK,this)}catch(l){throw a||(this._enabled=!0),L.error("[".concat(this.getTrackId(),"] setEnabled to false error"),l.toString()),l}}}async setMuted(t){t!==this._muted&&(this.stateCheck("muted",t),this._muted=t,this._originMediaStreamTrack.enabled=!t,L.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(t)),t?await ln(this,Fe.NEED_MUTE_TRACK,this):await ln(this,Fe.NEED_UNMUTE_TRACK,this))}getStats(){return Hf(()=>{L.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),mo(this,Fe.GET_STATS)||CT({},hT)}setAudioFrameCallback(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!t)return this._source.removeAllListeners(_o.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(r),this._source.removeAllListeners(_o.ON_AUDIO_BUFFER),this._source.on(_o.ON_AUDIO_BUFFER,a=>t(a))}play(){L.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(L.debug("[".concat(this.getTrackId(),"] start audio playback in element")),ko.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){L.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?ko.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let t=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];L.debug("[".concat(this.getTrackId(),"] update player source track")),t&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&ko.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(t,r){this._originMediaStreamTrack!==t&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),r&&this._originMediaStreamTrack.stop()),t.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=t,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this.processor.updateInput({track:t,context:this.processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await ln(this,Fe.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(t))}renewMediaStreamTrack(t){return me.resolve(void 0)}pipe(t){if(this._bypassWebAudio)throw new be(G.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===t)return t;if(t._source)throw new be(G.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),t}unpipe(){var t;if(!this.processor)return;const r=this.processor;(t=this._source.processSourceNode)===null||t===void 0||t.disconnect(),this.processor._source=!1,this.processor=void 0,r.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(Ci.ON_TRACK,async t=>{t?t!==this._mediaStreamTrack&&(this._mediaStreamTrack=t,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(t),await ln(this,Fe.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await ln(this,Fe.NEED_REPLACE_TRACK,this))}),this.processorDestination.on(Ci.ON_NODE,t=>{this._source.processedNode=t})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(Ci.ON_TRACK),this.processorDestination.removeAllListeners(Ci.ON_NODE)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(yo.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(yo.REQUEST_CONSTRAINTS)}}Te([ST("INIT_WEBAUDIO"),V("design:type",Object),V("design:paramtypes",[Object])],en.prototype,"_source",null),Te([ST("INIT_WEBAUDIO"),V("design:type",bv),V("design:paramtypes",[bv])],en.prototype,"processorContext",null),Te([ST("INIT_WEBAUDIO"),V("design:type",Cv),V("design:paramtypes",[Cv])],en.prototype,"processorDestination",null),Te([Ze({argsMap:(i,t)=>[i.getTrackId(),t],throttleTime:300}),V("design:type",Function),V("design:paramtypes",[Number]),V("design:returntype",void 0)],en.prototype,"setVolume",null),Te([Ze({argsMap:(i,t)=>[i.getTrackId(),t]}),Yn(),V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],en.prototype,"setPlaybackDevice",null),Te([Rh("LocalAudioTrack","_enabledMutex"),Ze({argsMap:(i,t)=>[i.getTrackId(),t]}),Yn(),V("design:type",Function),V("design:paramtypes",[Boolean,Object,Boolean]),V("design:returntype",me)],en.prototype,"setEnabled",null),Te([Rh("LocalAudioTrack","_enabledMutex"),Ze({argsMap:(i,t)=>[i.getTrackId(),t]}),Yn(),V("design:type",Function),V("design:paramtypes",[Boolean]),V("design:returntype",me)],en.prototype,"setMuted",null),Te([Yn(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",Object)],en.prototype,"getStats",null),Te([Yn(),V("design:type",Function),V("design:paramtypes",[Object,Number]),V("design:returntype",void 0)],en.prototype,"setAudioFrameCallback",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),Yn(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],en.prototype,"play",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),Yn(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],en.prototype,"stop",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],en.prototype,"close",null),Te([Ze({argsMap:(i,t)=>[i.getTrackId(),t.name]}),V("design:type",Function),V("design:paramtypes",[Object]),V("design:returntype",Object)],en.prototype,"pipe",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],en.prototype,"unpipe",null);class Wl extends en{get __className__(){return"MicrophoneAudioTrack"}constructor(t,r,a,l){super(t,r.encoderConfig?vv(r.encoderConfig):{},l,Z("GET_VOLUME_OF_MUTED_AUDIO_TRACK"),!0),w(this,"_config",void 0),w(this,"_deviceName","default"),w(this,"_constraints",void 0),w(this,"_originalConstraints",void 0),w(this,"_enabled",!0),this._config=r,this._constraints=a,this._originalConstraints=a,this._deviceName=t.label,typeof r.bypassWebAudio=="boolean"&&(this._bypassWebAudio=r.bypassWebAudio),(Sh()||Cb())&&on.bindInterruptDetectorTrack(this),this.on(_v.UPDATE_TRACK_SOURCE,()=>{this.bindProcessorContextEvents()}),AL()&&this.bindProcessorContextEvents()}async setDevice(t){if(L.info("[".concat(this.getTrackId(),"] start set device to ").concat(t)),this._enabled)try{const r=await ia.getDeviceById(t),a={};a.audio=CT({},this._constraints),a.audio.deviceId={exact:t},this._originMediaStreamTrack.stop();let l=null;try{l=await ra(a,this.getTrackId())}catch(u){throw L.error("[".concat(this.getTrackId(),"] setDevice failed"),u.toString()),l=await ra({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(l.getAudioTracks()[0],!1),u}await this._updateOriginMediaStreamTrack(l.getAudioTracks()[0],!1),this._deviceName=r.label,this._config.microphoneId=t,this._constraints.deviceId={exact:t}}catch(r){throw L.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}else try{const r=await ia.getDeviceById(t);this._deviceName=r.label,this._config.microphoneId=t,this._constraints.deviceId={exact:t}}catch(r){throw L.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}L.info("[".concat(this.getTrackId(),"] set device to ").concat(t," success"))}async setEnabled(t,r,a){if(r)return L.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(t);if(!a){if(t===this._enabled)return;this.stateCheck("enabled",t)}if(L.info("[".concat(this.getTrackId(),"] start setEnabled"),t),!t){var l;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(l=this._source.clonedTrack)===null||l===void 0||l.stop(),a||(this._enabled=!1);try{await ln(this,Fe.NEED_DISABLE_TRACK,this)}catch(f){throw L.error("[".concat(this.getTrackId(),"] setEnabled false failed"),f.toString()),f}return}const u=CT({},this._constraints),h=ia.searchDeviceIdByName(this._deviceName);h&&!u.deviceId&&(u.deviceId=h);try{a||(this._enabled=!0);const f=await ra({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(f.getAudioTracks()[0],!1),await ln(this,Fe.NEED_ENABLE_TRACK,this)}catch(f){throw a||(this._enabled=!1),L.error("[".concat(this.getTrackId(),"] setEnabled true failed"),f.toString()),f}L.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(Sh()||Cb())&&on.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((ki()||fc())&&this._enabled&&!this._isClosed&&on.duringInterruption){const t=async()=>{on.off(Ur.IOS_INTERRUPTION_END,t),this._enabled&&!this._isClosed&&(L.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};on.on(Ur.IOS_INTERRUPTION_END,t)}else L.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Hl.TRACK_ENDED)}async renewMediaStreamTrack(t){const r=t||this._constraints,a=ia.searchDeviceIdByName(this._deviceName);if(a&&!r.deviceId&&(r.deviceId=a),this._constraints=r,this._enabled){this._originMediaStreamTrack.stop();const l=await ra({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(l.getAudioTracks()[0],!0)}}bindProcessorContextEvents(){this.processorContext.on(yo.REQUEST_UPDATE_CONSTRAINTS,async(t,r,a)=>{try{const l=Object.assign({},this._originalConstraints,...t);await this.renewMediaStreamTrack(l),r()}catch(l){a(l)}}),this.processorContext.on(yo.REQUEST_CONSTRAINTS,async t=>{t(this._originMediaStreamTrack.getSettings())})}}Te([Ze({argsMap:(i,t)=>[i.getTrackId(),t]}),Yn(),V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],Wl.prototype,"setDevice",null),Te([Rh("MicrophoneAudioTrack","_enabledMutex"),Ze({argsMap:(i,t,r)=>[i.getTrackId(),t,r]}),Yn(),V("design:type",Function),V("design:paramtypes",[Boolean,Boolean,Boolean]),V("design:returntype",me)],Wl.prototype,"setEnabled",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],Wl.prototype,"close",null);class zl extends en{get __className__(){return"BufferSourceAudioTrack"}constructor(t,r,a,l){super(r.createOutputTrack(),a,l),w(this,"source",void 0),w(this,"_bufferSource",void 0),this.source=t,this._bufferSource=r,this._bufferSource.on(_o.AUDIO_SOURCE_STATE_CHANGE,u=>{this.safeEmit(Hl.SOURCE_STATE_CHANGE,u)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(t){t&&this._bufferSource.updateOptions(t),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(t){this._bufferSource.seekAudioBuffer(t)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(t){cn(t,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(t)}}Te([Ze({argsMap:(i,t)=>[i.getTrackId(),t,i.duration]}),Yn(),V("design:type",Function),V("design:paramtypes",[Object]),V("design:returntype",void 0)],zl.prototype,"startProcessAudioBuffer",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),Yn(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],zl.prototype,"pauseProcessAudioBuffer",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),Yn(),V("design:type",Function),V("design:paramtypes",[Number]),V("design:returntype",void 0)],zl.prototype,"seekAudioBuffer",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),Yn(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],zl.prototype,"resumeProcessAudioBuffer",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),Yn(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],zl.prototype,"stopProcessAudioBuffer",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],zl.prototype,"close",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),Yn(),V("design:type",Function),V("design:paramtypes",[Number]),V("design:returntype",void 0)],zl.prototype,"setAudioBufferPlaybackSpeed",null);class cr extends en{get __className__(){return"MixingAudioTrack"}get isActive(){for(const t of this.trackList)if(t._enabled&&!t._isClosed&&!t.muted)return!0;return!1}constructor(){const t=Fh().createMediaStreamDestination();super(t.stream.getAudioTracks()[0],void 0,un(8,"track-mix-")),w(this,"trackList",void 0),w(this,"destNode",void 0);try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=t,this.trackList=[]}hasAudioTrack(t){return this.trackList.indexOf(t)!==-1}addAudioTrack(t){this.trackList.indexOf(t)===-1?(L.debug("add ".concat(t.getTrackId()," to mixing track")),t._source.outputNode.connect(this.destNode),this.trackList.push(t),this.updateEncoderConfig()):L.debug("track ".concat(t.getTrackId()," is already added"))}removeAudioTrack(t){if(this.trackList.indexOf(t)!==-1){L.debug("remove ".concat(t.getTrackId()," from mixing track"));try{t._source.outputNode.disconnect(this.destNode)}catch{}wb(this.trackList,t),this.updateEncoderConfig()}}updateEncoderConfig(){const t={};this.trackList.forEach(r=>{r._encoderConfig&&((r._encoderConfig.bitrate||0)>(t.bitrate||0)&&(t.bitrate=r._encoderConfig.bitrate),(r._encoderConfig.sampleRate||0)>(t.sampleRate||0)&&(t.sampleRate=r._encoderConfig.sampleRate),(r._encoderConfig.sampleSize||0)>(t.sampleSize||0)&&(t.sampleSize=r._encoderConfig.sampleSize),r._encoderConfig.stereo&&(t.stereo=!0))}),this._encoderConfig=t}_updateRtpTransceiver(t){this._rtpTransceiver!==t&&(this._rtpTransceiver=t,this.trackList.forEach(r=>{r instanceof cr?r.emit(Lh.TRANSCEIVER_UPDATED,t):r._updateRtpTransceiver(t)}))}}function Tv(i){const t={};i.facingMode&&(t.facingMode=i.facingMode),i.cameraId&&(t.deviceId={exact:i.cameraId});const r=_c(i.encoderConfig);return r.width!=null&&(t.width=r.width),r.height!=null&&(t.height=r.height),!Lk()&&r.frameRate&&(t.frameRate=r.frameRate),Wt().name===Zt.EDGE&&typeof t.frameRate=="object"&&(t.frameRate.max=60),Cn()&&(t.frameRate={ideal:30,max:30}),t}function WL(i){const t={};if(Lk()||(i.AGC!==void 0&&(t.autoGainControl=i.AGC),i.AEC!==void 0&&(t.echoCancellation=i.AEC),i.ANS!==void 0&&(t.noiseSuppression=i.ANS,yb()&&i.ANS&&(t.googHighpassFilter=i.ANS))),i.encoderConfig){const r=vv(i.encoderConfig);t.channelCount=r.stereo?2:1,t.sampleRate=r.sampleRate,t.sampleSize=r.sampleSize}return i.microphoneId&&(t.deviceId={exact:i.microphoneId}),Kg()&&(t.sampleRate=void 0),t}class kee extends xL{set currentState(t){t!==this._currentState&&(this._currentState=t,this.safeEmit(_o.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),w(this,"audioBuffer",void 0),w(this,"sourceNode",void 0),w(this,"startPlayTime",0),w(this,"startPlayOffset",0),w(this,"pausePlayTime",0),w(this,"options",void 0),w(this,"currentLoopCount",0),w(this,"currentPlaybackSpeed",100),w(this,"_currentState","stopped"),this.audioBuffer=t,this.options=r,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(t){this.currentState==="stopped"?(this.options=t,this.startPlayOffset=this.options.startPlayTime||0):L.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(t){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=t,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=t))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(t){this.sourceNode&&(this.currentState==="playing"&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=t/100),this.currentPlaybackSpeed=t}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const t=this.context.createBufferSource();return t.buffer=this.audioBuffer,t.loop=!!this.options.loop,t.connect(this.outputNode),t.playbackRate.value=this.currentPlaybackSpeed/100,t}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const zL=new Map;async function Lee(i,t){let r=null;if(typeof i=="string"){const l=zL.get(i);if(l)return L.debug("use cached audio resource: ",i),l;try{r=(await Ls(()=>go.get(i,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(u){throw new be(G.FETCH_AUDIO_FILE_FAILED,u.toString())}}else r=await new me((u,h)=>{const f=new FileReader;f.onload=v=>{v.target?u(v.target.result):h(new be(G.READ_LOCAL_AUDIO_FILE_ERROR))},f.onerror=()=>{h(new be(G.READ_LOCAL_AUDIO_FILE_ERROR))},f.readAsArrayBuffer(i)});const a=await function(l){const u=Fh();return new me((h,f)=>{u.decodeAudioData(l,v=>{h(v)},v=>{f(new be(G.DECODE_AUDIO_FILE_FAILED,v.toString()))})})}(r);return typeof i=="string"&&t&&zL.set(i,a),a}const bT=i=>{const t=document.createElement("canvas");return t.width=2,t.height=2,new me((r,a)=>{t.toBlob(async l=>{if(t.remove(),l){const u=await GL(l);r({buffer:u,width:t.width,height:t.height})}else a(new be(G.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},i,1)})},GL=async i=>{const t=await i.arrayBuffer();return new Uint8Array(t)},Kc=new class extends An{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),w(this,"_lastHiddenTime",0),w(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),L.debug("document visibility went ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};function KL(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function qL(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KL(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):KL(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}class TT{get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(t){t!==this._videoElementStatus&&(L.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(t)),this._videoElementStatus=t)}constructor(t){w(this,"trackId",void 0),w(this,"config",void 0),w(this,"onFirstVideoFrameDecoded",void 0),w(this,"freezeTimeCounterList",[]),w(this,"renderFreezeAccTime",0),w(this,"isKeepLastFrame",!1),w(this,"timeUpdatedCount",0),w(this,"freezeTime",0),w(this,"playbackTime",0),w(this,"lastTimeUpdatedTime",0),w(this,"autoplayFailed",!1),w(this,"videoTrack",void 0),w(this,"videoElement",void 0),w(this,"cacheVideoElement",void 0),w(this,"videoElementCheckInterval",void 0),w(this,"_videoElementStatus",bi.NONE),w(this,"isGettingVideoDimensions",!1),w(this,"startGetVideoDimensions",()=>{const r=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return L.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(r,500)};!this.isGettingVideoDimensions&&r()}),w(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&on.curState==="running"&&(L.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(Ak())),Dk()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),w(this,"handleVideoEvents",r=>{switch(r.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=bi.PLAYING;break;case"loadeddata":if(this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=bi.CANPLAY;break;case"stalled":this.videoElementStatus=bi.STALLED;break;case"suspend":this.videoElementStatus=bi.SUSPEND;break;case"pause":this.videoElementStatus=bi.PAUSED,ki()||fc()||Di()&&this.autoplayFailed||!this.videoTrack||this.videoTrack.readyState!=="live"||(L.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=bi.WAITING;break;case"abort":this.videoElementStatus=bi.ABORT;break;case"ended":this.videoElementStatus=bi.ENDED;break;case"emptied":this.videoElementStatus=bi.EMPTIED;break;case"error":{this.videoElementStatus=bi.ERROR;const a=this.videoElement.error;a&&L.error("[".concat(this.trackId,"] media error, code: ").concat(a.code,", message: ").concat(a.message));break}case"timeupdate":{const a=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=a);const l=a-this.lastTimeUpdatedTime,u=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=a,Kc.lastVisibleTime<Kc.lastHiddenTime||u<Kc.lastHiddenTime||u<Kc.lastVisibleTime)return;for(l>Z("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=l),this.playbackTime+=l;this.playbackTime>=6e3;){this.playbackTime-=6e3;const h=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(h),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),w(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&(L.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(Ak())),Dk()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=t.trackId,this.config=t,t.element instanceof HTMLVideoElement?this.videoElement=t.element:this.videoElement=document.createElement("video"),on.on(Ur.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),on.on(Ur.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var t;return(t=this.videoElement.parentElement)!==null&&t!==void 0?t:void 0}updateConfig(t){this.config=t,this.trackId=t.trackId,t.element!==this.videoElement&&(this.destroy(),this.videoElement=t.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(t){this.videoTrack!==t&&(this.videoTrack=t,this.initVideoElement())}play(t){const r=this.videoElement.play();r&&r.catch&&r.catch(l=>{t&&BL(t,"video",l.message,this.trackId),l.name==="NotAllowedError"?(L.warning("detected video element autoplay failed",l),this.autoplayFailed=!0,this.handleAutoPlayFailed()):L.warning("[".concat(this.trackId,"] play warning: "),l)});const a=Wt();if((a.name==="Safari"&&Number(a.version)===15||Sh())&&r&&r.then){const l=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};r.then(l).catch(l)}}getCurrentFrame(){const t=document.createElement("canvas");t.width=this.videoElement.videoWidth,t.height=this.videoElement.videoHeight;const r=t.getContext("2d");if(!r)return L.error("create canvas context failed!"),new ImageData(2,2);r.drawImage(this.videoElement,0,0,t.width,t.height);const a=r.getImageData(0,0,t.width,t.height);return t.remove(),a}async getCurrentFrameToUint8Array(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const a=document.createElement("canvas");a.width=this.videoElement.videoWidth,a.height=this.videoElement.videoHeight;const l=a.getContext("2d");return l?(l.drawImage(this.videoElement,0,0,a.width,a.height),new me((u,h)=>{a.toBlob(async f=>{if(a.remove(),f){const v=await GL(f);u({buffer:v,width:a.width,height:a.height})}else h(new be(G.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},t,r<0?.1:r>1?1:r)})):await bT(t)}destroy(){on.off(Ur.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),on.off(Ur.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[]}initVideoElement(){if(this.videoElementStatus=bi.INIT,!this.videoElementCheckInterval&&(YL.forEach(u=>{this.videoElement.addEventListener(u,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{(function(u){return u!==document.body&&document.body.contains(u)})(this.videoElement)||(this.videoElementStatus=bi.DESTROYED)},1e3),Z("ENABLE_VIDEO_FRAME_CALLBACK"))){var t,r;let u;const h=(f,v)=>{if(this.videoElementStatus===bi.PLAYING){if(u){const C=v.presentationTime-u.presentationTime;C>Z("VIDEO_FREEZE_DURATION")&&Kc.lastVisibleTime>=Kc.lastHiddenTime&&u.timestamp>Kc.lastVisibleTime&&u.timestamp>Kc.lastHiddenTime&&(this.renderFreezeAccTime+=C)}u=qL(qL({},v),{},{timestamp:f})}var E,y;Z("ENABLE_VIDEO_FRAME_CALLBACK")&&((E=(y=this.videoElement).requestVideoFrameCallback)===null||E===void 0||E.call(y,h))};(t=(r=this.videoElement).requestVideoFrameCallback)===null||t===void 0||t.call(r,h)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),Kg()&&(this.videoElement.poster="noposter");const a=Wt();a.name==="Safari"&&Number(a.version)===15||Sh()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,Cn()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,Cn()&&this.videoElement.load());const l=this.videoElement.play();l!==void 0&&l.catch(u=>{L.debug("[".concat(this.trackId,"] playback interrupted"),u.toString())})}resetVideoElement(){YL.forEach(t=>{this.videoElement&&this.videoElement.removeEventListener(t,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=bi.NONE}handleAutoPlayFailed(){const t=r=>{r.preventDefault(),this.videoElement.play().then(()=>{L.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(a=>{L.error(a)}),this.autoplayFailed=!1,Vf()?document.body.removeEventListener("click",t,!0):(document.body.removeEventListener("touchstart",t,!0),document.body.removeEventListener("mousedown",t,!0))};Vf()?document.body.addEventListener("click",t,!0):(document.body.addEventListener("touchstart",t,!0),document.body.addEventListener("mousedown",t,!0)),ML()}}const YL=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class XL extends TT{constructor(t){super(t),w(this,"container",void 0),w(this,"slot",void 0),this.slot=t.element,this.updateConfig(t)}updateConfig(t){this.config=t,this.trackId=t.trackId;const r=t.element;r!==this.slot&&(this.destroy(),this.slot=r),this.createElements()}updateVideoTrack(t){this.videoTrack!==t&&(this.videoTrack=t,this.createElements())}play(t){var r;(r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)&&super.play(t)}getCurrentFrame(){var t;return(t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(t){var r;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return(r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(t,a):await bT(t)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",Z("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var t;!this.container||(t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var t;if((t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var t;(t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}function JL(i){return new me((t,r)=>{let a=!1;const l=document.createElement("video");l.setAttribute("autoplay",""),l.setAttribute("muted",""),l.muted=!0,l.autoplay=!0,l.setAttribute("playsinline",""),l.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(l);const u=ki()?"canplay":"playing";l.addEventListener(u,()=>{const h=l.videoWidth,f=l.videoHeight;!h&&Cn()||(a=!0,l.srcObject=null,l.remove(),t([h,f]))}),l.srcObject=new MediaStream([i]),l.play().catch(Jg),setTimeout(()=>{a||(l.srcObject=null,l.remove(),t([l.videoWidth,l.videoHeight]))},4e3)})}const Mee=async(i,t,r)=>{const a=function(h){const f=[];for(let v=0;v<h.length;v+=2)f.push(parseInt(h.slice(v,v+2),16));return Uint8Array.from(f)}(function(h){const f="0123456789abcdef";function v(De){let Ne,vt="";for(Ne=0;Ne<=3;Ne++)vt+=f.charAt(De>>8*Ne+4&15)+f.charAt(De>>8*Ne&15);return vt}function E(De,Ne){const vt=(65535&De)+(65535&Ne);return(De>>16)+(Ne>>16)+(vt>>16)<<16|65535&vt}function y(De,Ne,vt,Ft,Bn,fr){return E(function(bn,Mo){return bn<<Mo|bn>>>32-Mo}(E(E(Ne,De),E(Ft,fr)),Bn),vt)}function C(De,Ne,vt,Ft,Bn,fr,bn){return y(Ne&vt|~Ne&Ft,De,Ne,Bn,fr,bn)}function I(De,Ne,vt,Ft,Bn,fr,bn){return y(Ne&Ft|vt&~Ft,De,Ne,Bn,fr,bn)}function k(De,Ne,vt,Ft,Bn,fr,bn){return y(Ne^vt^Ft,De,Ne,Bn,fr,bn)}function W(De,Ne,vt,Ft,Bn,fr,bn){return y(vt^(Ne|~Ft),De,Ne,Bn,fr,bn)}const $=function(De){let Ne;const vt=1+(De.length+8>>6),Ft=new Array(16*vt);for(Ne=0;Ne<16*vt;Ne++)Ft[Ne]=0;for(Ne=0;Ne<De.length;Ne++)Ft[Ne>>2]|=De.charCodeAt(Ne)<<Ne%4*8;return Ft[Ne>>2]|=128<<Ne%4*8,Ft[16*vt-2]=8*De.length,Ft}(h);let z,X,ie,oe,Re,Ce=1732584193,ge=-271733879,_e=-1732584194,Se=271733878;for(z=0;z<$.length;z+=16)X=Ce,ie=ge,oe=_e,Re=Se,Ce=C(Ce,ge,_e,Se,$[z+0],7,-680876936),Se=C(Se,Ce,ge,_e,$[z+1],12,-389564586),_e=C(_e,Se,Ce,ge,$[z+2],17,606105819),ge=C(ge,_e,Se,Ce,$[z+3],22,-1044525330),Ce=C(Ce,ge,_e,Se,$[z+4],7,-176418897),Se=C(Se,Ce,ge,_e,$[z+5],12,1200080426),_e=C(_e,Se,Ce,ge,$[z+6],17,-1473231341),ge=C(ge,_e,Se,Ce,$[z+7],22,-45705983),Ce=C(Ce,ge,_e,Se,$[z+8],7,1770035416),Se=C(Se,Ce,ge,_e,$[z+9],12,-1958414417),_e=C(_e,Se,Ce,ge,$[z+10],17,-42063),ge=C(ge,_e,Se,Ce,$[z+11],22,-1990404162),Ce=C(Ce,ge,_e,Se,$[z+12],7,1804603682),Se=C(Se,Ce,ge,_e,$[z+13],12,-40341101),_e=C(_e,Se,Ce,ge,$[z+14],17,-1502002290),ge=C(ge,_e,Se,Ce,$[z+15],22,1236535329),Ce=I(Ce,ge,_e,Se,$[z+1],5,-165796510),Se=I(Se,Ce,ge,_e,$[z+6],9,-1069501632),_e=I(_e,Se,Ce,ge,$[z+11],14,643717713),ge=I(ge,_e,Se,Ce,$[z+0],20,-373897302),Ce=I(Ce,ge,_e,Se,$[z+5],5,-701558691),Se=I(Se,Ce,ge,_e,$[z+10],9,38016083),_e=I(_e,Se,Ce,ge,$[z+15],14,-660478335),ge=I(ge,_e,Se,Ce,$[z+4],20,-405537848),Ce=I(Ce,ge,_e,Se,$[z+9],5,568446438),Se=I(Se,Ce,ge,_e,$[z+14],9,-1019803690),_e=I(_e,Se,Ce,ge,$[z+3],14,-187363961),ge=I(ge,_e,Se,Ce,$[z+8],20,1163531501),Ce=I(Ce,ge,_e,Se,$[z+13],5,-1444681467),Se=I(Se,Ce,ge,_e,$[z+2],9,-51403784),_e=I(_e,Se,Ce,ge,$[z+7],14,1735328473),ge=I(ge,_e,Se,Ce,$[z+12],20,-1926607734),Ce=k(Ce,ge,_e,Se,$[z+5],4,-378558),Se=k(Se,Ce,ge,_e,$[z+8],11,-2022574463),_e=k(_e,Se,Ce,ge,$[z+11],16,1839030562),ge=k(ge,_e,Se,Ce,$[z+14],23,-35309556),Ce=k(Ce,ge,_e,Se,$[z+1],4,-1530992060),Se=k(Se,Ce,ge,_e,$[z+4],11,1272893353),_e=k(_e,Se,Ce,ge,$[z+7],16,-155497632),ge=k(ge,_e,Se,Ce,$[z+10],23,-1094730640),Ce=k(Ce,ge,_e,Se,$[z+13],4,681279174),Se=k(Se,Ce,ge,_e,$[z+0],11,-358537222),_e=k(_e,Se,Ce,ge,$[z+3],16,-722521979),ge=k(ge,_e,Se,Ce,$[z+6],23,76029189),Ce=k(Ce,ge,_e,Se,$[z+9],4,-640364487),Se=k(Se,Ce,ge,_e,$[z+12],11,-421815835),_e=k(_e,Se,Ce,ge,$[z+15],16,530742520),ge=k(ge,_e,Se,Ce,$[z+2],23,-995338651),Ce=W(Ce,ge,_e,Se,$[z+0],6,-198630844),Se=W(Se,Ce,ge,_e,$[z+7],10,1126891415),_e=W(_e,Se,Ce,ge,$[z+14],15,-1416354905),ge=W(ge,_e,Se,Ce,$[z+5],21,-57434055),Ce=W(Ce,ge,_e,Se,$[z+12],6,1700485571),Se=W(Se,Ce,ge,_e,$[z+3],10,-1894986606),_e=W(_e,Se,Ce,ge,$[z+10],15,-1051523),ge=W(ge,_e,Se,Ce,$[z+1],21,-2054922799),Ce=W(Ce,ge,_e,Se,$[z+8],6,1873313359),Se=W(Se,Ce,ge,_e,$[z+15],10,-30611744),_e=W(_e,Se,Ce,ge,$[z+6],15,-1560198380),ge=W(ge,_e,Se,Ce,$[z+13],21,1309151649),Ce=W(Ce,ge,_e,Se,$[z+4],6,-145523070),Se=W(Se,Ce,ge,_e,$[z+11],10,-1120210379),_e=W(_e,Se,Ce,ge,$[z+2],15,718787259),ge=W(ge,_e,Se,Ce,$[z+9],21,-343485551),Ce=E(Ce,X),ge=E(ge,ie),_e=E(_e,oe),Se=E(Se,Re);return v(Ce)+v(ge)+v(_e)+v(Se)}(""+t+r)).slice(0,16),l=a.slice(0,12),u=await window.crypto.subtle.importKey("raw",a,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:l},u,i))},QL=async(i,t,r)=>await Mee(i.buffer,t,r);function ZL(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function aa(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZL(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):ZL(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}class bt extends pi{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==bi.PLAYING)}get processorContext(){return this._processorContext}set processorContext(t){this._processorContext=t}get __className__(){return"LocalVideoTrack"}constructor(t,r,a,l,u,h){if(super(t,u),w(this,"trackMediaType","video"),w(this,"_player",void 0),w(this,"isUseScaleResolutionDownBy",!1),w(this,"_videoVisibleTimer",null),w(this,"_statsTimer",null),w(this,"_previousVideoVisibleStatus",void 0),w(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),w(this,"_encoderConfig",void 0),w(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),w(this,"_optimizationMode",void 0),w(this,"_videoHeight",void 0),w(this,"_videoWidth",void 0),w(this,"_forceBitrateLimit",void 0),w(this,"_enabled",!0),w(this,"processorDestination",void 0),w(this,"_processorContext",void 0),Di()){const{width:f,height:v}=t.getSettings();this._videoWidth=f,this._videoHeight=v}else this.updateMediaStreamTrackResolution();if(this._encoderConfig=r,this._scalabilityMode=a,this._optimizationMode=l,this._hints=h||[],this._hints.indexOf(vn.SCREEN_TRACK)===-1)this.updateBitrateFromProfile();else if(function(f,v,E){const y=Wt();return!(y.name!==f||!y.osVersion)&&(E?Number(y.version)>=v&&Number(y.version)<=E:Number(y.version)===v)}(Zt.CHROME,115)&&zg().indexOf("Windows")!==-1){const f=function(v,E){if("VideoFrame"in window&&"TransformStream"in window&&fn().supportWebRTCInsertableStream){const y=new MediaStreamTrackProcessor(v),C=new MediaStreamTrackGenerator({kind:"video"});let I,k,W=Date.now();const $=()=>{z&&(clearInterval(z),z=void 0),I&&(I.close(),I=void 0),v.stop(),k=void 0,C.removeEventListener("ended",$)};let z=window.setInterval(()=>{if(k&&I&&Date.now()-W>(E??1e3))try{C.readyState==="live"?k.enqueue(I.clone()):$()}catch{$()}},E??1e3);const X=new TransformStream({transform:(ie,oe)=>{C.readyState==="live"?(k=oe,W=Date.now(),I===void 0?(I=ie,oe.enqueue(ie.clone())):(oe.enqueue(I),I=ie)):ie.close()}});return C.addEventListener("ended",$),y.readable.pipeThrough(X).pipeTo(C.writable),C}}(t);f&&(L.info("local screen video track begin to inject frame"),this._mediaStreamTrack=f)}r&&this._hints.indexOf(vn.CUSTOM_TRACK)!==-1&&this.setEncoderConfiguration(r),this.processorContext=new $L(this.getTrackId(),"local"),this.processorDestination=new VL(this.processorContext),this.bindProcessorDestinationEvents()}play(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof t=="string"){const l=document.getElementById(t);l?t=l:(L.warning("[".concat(this.getTrackId(),'] can not find "#').concat(t,'" element, use document.body')),t=document.body)}L.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(r));const a=aa(aa(aa({},this._getDefaultPlayerConfig()),r),{},{trackId:this.getTrackId(),element:t});this._player?this._player.updateConfig(a):(t instanceof HTMLVideoElement?this._player=new TT(a):this._player=new XL(a),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const l=this.getVideoElementVisibleStatus();this.safeEmit(Hl.VIDEO_ELEMENT_VISIBLE_STATUS,l)}catch{}},Z("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._statsTimer&&(this.isUseScaleResolutionDownBy=!1,window.clearInterval(this._statsTimer),this._statsTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,L.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(t,r){if(!r){if(t===this._enabled)return;this.stateCheck("enabled",t)}if(L.info("[".concat(this.getTrackId(),"] start setEnabled"),t),!t){this._originMediaStreamTrack.enabled=!1;try{await ln(this,Fe.NEED_DISABLE_TRACK,this)}catch(a){throw L.error("[".concat(this.getTrackId(),"] setEnabled to false error"),a.toString()),a}return r||(this._enabled=!1),void L.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await ln(this,Fe.NEED_ENABLE_TRACK,this)}catch(a){throw L.error("[".concat(this.getTrackId(),"] setEnabled to true error"),a.toString()),a}L.info("[".concat(this.getTrackId(),"] setEnabled to true success")),r||(this._enabled=!0)}async setMuted(t){t!==this._muted&&(this.stateCheck("muted",t),this._muted=t,this._originMediaStreamTrack.enabled=!t,L.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(t)),t?await ln(this,Fe.NEED_MUTE_TRACK,this):await ln(this,Fe.NEED_UNMUTE_TRACK,this))}async setEncoderConfiguration(t,r){if(!this._enabled)throw new be(G.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(t==="720p_auto"?this.startMonitorStats():this._statsTimer&&(window.clearInterval(this._statsTimer),this._statsTimer=null),t=_c(t),this._forceBitrateLimit&&(t.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:t.bitrateMax,t.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:t.bitrateMin),t.width||t.height||t.frameRate){const a=Tv({encoderConfig:t});(Di()||ki()||fc())&&(a.deviceId=void 0),L.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(t),JSON.stringify(a));try{await this._originMediaStreamTrack.applyConstraints(a),this.updateMediaStreamTrackResolution()}catch(l){const u=new be(G.UNEXPECTED_ERROR,l.toString());throw L.error("[".concat(this.getTrackId(),"] applyConstraints error"),u.toString()),u}}this._encoderConfig=t,this._hints.indexOf(vn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await ln(this,Fe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(a){return a.throw(L)}}getStats(){return Hf(()=>{L.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),mo(this,Fe.GET_STATS)||aa({},pT)}async setBeautyEffect(t){L.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(t,r):await bT(t)}async setBitrateLimit(t){if(L.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(t))),t){this._forceBitrateLimit=t,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<t.max_bitrate?this._encoderConfig.bitrateMax:t.max_bitrate:this._encoderConfig.bitrateMax=t.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=t.min_bitrate);try{await ln(this,Fe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(r){return r.throw(L)}}}async setOptimizationMode(t){if(t!=="motion"&&t!=="detail"&&t!=="balanced")return void L.error(G.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const r=this._optimizationMode;try{this._optimizationMode=t,await ln(this,Fe.SET_OPTIMIZATION_MODE,this)}catch(a){throw this._optimizationMode=r,L.error("[".concat(this.getTrackId(),"] set optimization mode failed"),a.toString()),a}L.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(t,")"))}setScalabiltyMode(t){if(t.numSpatialLayers===1&&t.numTemporalLayers!==1)return L.error(G.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=t,L.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(t,")"))}updateMediaStreamTrackResolution(){JL(this._originMediaStreamTrack).then(t=>{let[r,a]=t;this._videoHeight=a,this._videoWidth=r}).catch(Jg)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(t){if(!this._enabled)throw new be(G.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");L.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(t)),t=_c(t),this._forceBitrateLimit&&(t.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:t.bitrateMax,t.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:t.bitrateMin),this._encoderConfig=t,this._hints.indexOf(vn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await ln(this,Fe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(r){return r.throw(L)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:t,height:r,frameRate:a}=this.getMediaStreamTrackSettings();if(!t||!r||!a)return;const[l,u]=function(h,f,v,E){let y;const C=200*Math.pow(v/15,.6)*Math.pow(h*f/640/360,.75),I=C;if(E==="STANDARD_BITRATE")y=4*C;else{if(E!=="COMPATIABLE_BITRATE")return;y=2*C}return[Math.floor(y),Math.floor(I)]}(t,r,a,Z("BITRATE_ADAPTER_TYPE"))||[void 0,void 0];this._encoderConfig.bitrateMin||this._encoderConfig.bitrateMax||(this._encoderConfig.bitrateMin=u,this._encoderConfig.bitrateMax=l,L.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(t,", h: ").concat(r,", fps: ").concat(a,"] => [brMax: ").concat(l,", brMin: ").concat(u,"]")))}getVideoElementVisibleStatus(){try{var t,r;const a=this==null||(t=this._player)===null||t===void 0?void 0:t.getContainerElement(),l={track:this,element:this==null||(r=this._player)===null||r===void 0?void 0:r.getVideoElement(),slot:a==null?void 0:a.parentElement},{element:u,slot:h}=l;if(this.isPlaying&&u instanceof HTMLVideoElement&&h instanceof HTMLElement){const f=Bk.checkOneElementVisible(u),v=Object.assign({},f);if(v.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=v.visible;const E=He.reportApiInvoke(null,{tag:Dn.TRACER,name:hr.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});v.visible?E.onSuccess("Video is visible"):E.onSuccess("Invisible because of ".concat(v.reason))}return v}return}catch(a){throw new be(G.GET_VIDEO_ELEMENT_VISIBLE_ERROR,a.message)}}async renewMediaStreamTrack(t){}pipe(t){if(this.processor===t)return t;if(t._source)throw new be(G.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),t}unpipe(){if(!this.processor)return;const t=this.processor;this.processor._source=void 0,this.processor=void 0,t.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(t){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],a=this._encoderConfig;t&&(a=aa(aa({},a),_c(t))),a=Ju(a);const l=un(8,"track-video-cloned-"),u=new bt(r?this._mediaStreamTrack.clone():this._mediaStreamTrack,a,Ju(this._scalabilityMode),this._optimizationMode,l,Ju(this._hints));return t&&a&&u.setEncoderConfiguration(a),L.debug("clone video track from ".concat(this.getTrackId()," to ").concat(l,", clone ").concat(r)),u}async replaceTrack(t,r){if(!(t instanceof MediaStreamTrack))throw new be(G.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if(t.kind!=="video")throw new be(G.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(t,r,!0),this.updateMediaStreamTrackResolution()}startMonitorStats(){if(!Di()&&!ki())return;this._statsTimer&&window.clearInterval(this._statsTimer);let t=2,r=mv[t],a=-1,l=Date.now();const u=h=>{h>2||h<0||(l=Date.now(),r=mv[h],this.setSenderConfiguration(r))};this.isUseScaleResolutionDownBy=!0,this._statsTimer=window.setInterval(()=>{const h=this.getStats(),f=mo(this,Fe.GET_RTC_STATS);if(h.sendPackets>0&&f){a===-1&&(a=Date.now());const v=Date.now();if(v-a<1e3||v-l<Z("PROFILE_SWITCH_INTERVAL"))return;const E=h.sendFrameRate,y=.6*r.frameRate,C=.9*r.frameRate;typeof E=="number"&&E>0&&E<y?t>0&&(t--,u(t),L.debug("[".concat(this.getTrackId(),"] step down for fps ").concat(E,", switchProfile to ").concat(t))):f.OutgoingAvailableBandwidth<r.bitrateMin?t>0&&(t--,u(t),L.debug("[".concat(this.getTrackId(),"] step down for OutgoingAvailableBandwidth ").concat(f.OutgoingAvailableBandwidth,", bitrateMin ").concat(r.bitrateMin,", switchProfile to ").concat(t))):typeof E=="number"&&E>C&&t<mv.length-1&&f.OutgoingAvailableBandwidth>1.2*mv[t+1].bitrateMin&&(t++,u(t),L.debug("[".concat(this.getTrackId(),"] step up for fps ").concat(E,", OutgoingAvailableBandwidth ").concat(f.OutgoingAvailableBandwidth,", switchProfile to ").concat(t)))}},Z("CHECK_LOCAL_STATS_INTERVAL"))}bindProcessorDestinationEvents(){this.processorDestination.on(Ci.ON_TRACK,async t=>{t?t!==this._mediaStreamTrack&&(this._mediaStreamTrack=t,this._updatePlayerSource(),await ln(this,Fe.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await ln(this,Fe.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(Ci.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(yo.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(yo.REQUEST_CONSTRAINTS)}}Te([Ze({argsMap:(i,t,r)=>[i.getTrackId(),typeof t=="string"?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",r]}),Yn(),V("design:type",Function),V("design:paramtypes",[Object,Object]),V("design:returntype",void 0)],bt.prototype,"play",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],bt.prototype,"stop",null),Te([Rh("LocalVideoTrack","_enabledMutex"),Ze({argsMap:(i,t)=>[i.getTrackId(),t]}),Yn(),V("design:type",Function),V("design:paramtypes",[Boolean,Boolean]),V("design:returntype",me)],bt.prototype,"setEnabled",null),Te([Rh("LocalVideoTrack","_enabledMutex"),Ze({argsMap:(i,t)=>[i.getTrackId(),t]}),Yn(),V("design:type",Function),V("design:paramtypes",[Boolean]),V("design:returntype",me)],bt.prototype,"setMuted",null),Te([Ze({argsMap:(i,t)=>[i.getTrackId(),t]}),Yn(),V("design:type",Function),V("design:paramtypes",[Object,Boolean]),V("design:returntype",me)],bt.prototype,"setEncoderConfiguration",null),Te([Yn(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",Object)],bt.prototype,"getStats",null),Te([Ze({argsMap:(i,t,r)=>[i.getTrackId(),t,r]}),Yn(),V("design:type",Function),V("design:paramtypes",[Boolean,Object]),V("design:returntype",me)],bt.prototype,"setBeautyEffect",null),Te([Yn(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",ImageData)],bt.prototype,"getCurrentFrameData",null),Te([Yn(),V("design:type",Function),V("design:paramtypes",[String,Number]),V("design:returntype",me)],bt.prototype,"getCurrentFrameImage",null),Te([Yn(),V("design:type",Function),V("design:paramtypes",[Object]),V("design:returntype",me)],bt.prototype,"setBitrateLimit",null),Te([Yn(),V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],bt.prototype,"setOptimizationMode",null),Te([Yn(),V("design:type",Function),V("design:paramtypes",[Object]),V("design:returntype",void 0)],bt.prototype,"setScalabiltyMode",null),Te([Yn(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],bt.prototype,"updateMediaStreamTrackResolution",null),Te([Ze({argsMap:(i,t)=>[i.getTrackId(),t.name]}),V("design:type",Function),V("design:paramtypes",[Object]),V("design:returntype",Object)],bt.prototype,"pipe",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],bt.prototype,"unpipe",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],bt.prototype,"close",null),Te([Ze({argsMap:(i,t,r)=>[i.getTrackId(),t.label,r]}),V("design:type",Function),V("design:paramtypes",[MediaStreamTrack,Boolean]),V("design:returntype",me)],bt.prototype,"replaceTrack",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],bt.prototype,"startMonitorStats",null);class Gl extends bt{get __className__(){return"CameraVideoTrack"}constructor(t,r,a,l,u,h){super(t,_c(r.encoderConfig),l,u,h),w(this,"_config",void 0),w(this,"_originalConstraints",void 0),w(this,"_constraints",void 0),w(this,"_enabled",!0),w(this,"_deviceName","default"),w(this,"tryResumeVideoForIOS15_16WeChat",async()=>{(Sh()||Cb())&&!function(){const f=Wt();if(f.os!==Rr.IOS||!f.osVersion)return!1;const v=f.osVersion.split(".");return Number(v[0])===15&&Number(v[1])>=2}()&&kk()&&this._enabled&&!this._isClosed&&(L.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=r,this._originalConstraints=a,this._constraints=a,this._deviceName=t.label,this._encoderConfig=_c(this._config.encoderConfig),on.on(Ur.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),on.on(Ur.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(t){return typeof t=="string"?this._setDeviceById(t):t.deviceId?this._setDeviceById(t.deviceId):t.facingMode?this._setDeviceByFacingModel(t.facingMode):void 0}async _setDeviceById(t){if(L.info("[".concat(this.getTrackId(),"] set device to ").concat(t)),this._enabled)try{const r=await ia.getDeviceById(t),a={};a.video=aa({},this._constraints),a.video.deviceId={exact:t},a.video.facingMode=void 0,this._originMediaStreamTrack.stop();let l=null;try{l=await ra(a,this.getTrackId())}catch(u){throw L.error("[".concat(this.getTrackId(),"] setDevice failed"),u.toString()),l=await ra({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!1),u}await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=r.label,this._config.cameraId=t,this._constraints.deviceId={exact:t}}catch(r){throw L.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}else try{const r=await ia.getDeviceById(t);this._deviceName=r.label,this._config.cameraId=t,this._constraints.deviceId={exact:t}}catch(r){throw L.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}L.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(t){L.info("[".concat(this.getTrackId(),"] set facingMode ").concat(t));const r={video:aa(aa({},this._constraints),{},{deviceId:void 0,facingMode:{exact:t}})};if(this._enabled){this._originMediaStreamTrack.stop();let a=null;try{a=await ra(r,this.getTrackId())}catch(l){throw L.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),l.toString()),a=await ra({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1),l}await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=t,this._config.cameraId=void 0,this._constraints=aa({},r.video),L.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(t,r){if(!r){if(t===this._enabled)return;this.stateCheck("enabled",t)}if(L.info("[".concat(this.getTrackId(),"] start setEnabled"),t),t){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const a=await ra({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1)}await ln(this,Fe.NEED_ENABLE_TRACK,this)}catch(a){throw L.error("[".concat(this.getTrackId(),"] setEnabled true error"),a.toString()),a}this.updateMediaStreamTrackResolution(),L.info("[".concat(this.getTrackId(),"] setEnabled to true success")),r||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),r||(this._enabled=!1);try{await ln(this,Fe.NEED_DISABLE_TRACK,this)}catch(a){throw L.error("[".concat(this.getTrackId(),"] setEnabled to false error"),a.toString()),a}L.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(t,r){if(!this._enabled)throw new be(G.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");t==="720p_auto"?this.startMonitorStats():this._statsTimer&&(window.clearInterval(this._statsTimer),this._statsTimer=null),t=_c(t),this._forceBitrateLimit&&(t.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:t.bitrateMax,t.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:t.bitrateMin);const a=ar(this._config);a.encoderConfig=t;const l=Tv(a);(Di()||ki()||fc())&&(l.deviceId=void 0),L.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(t),JSON.stringify(l));try{await this._originMediaStreamTrack.applyConstraints(l),this.updateMediaStreamTrackResolution()}catch(u){const h=new be(G.UNEXPECTED_ERROR,u.toString());throw L.error("[".concat(this.getTrackId(),"] applyConstraints error"),h.toString()),h}this._config=a,this._constraints=l,this._originalConstraints=l,this._encoderConfig=t,this._hints.indexOf(vn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await ln(this,Fe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(u){return u.throw(L)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((ki()||fc())&&this._enabled&&!this._isClosed&&on.duringInterruption){const t=async()=>{on.off(Ur.IOS_INTERRUPTION_END,t),this._enabled&&!this._isClosed&&(L.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};on.on(Ur.IOS_INTERRUPTION_END,t)}else L.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Hl.TRACK_ENDED)}async renewMediaStreamTrack(t){const r=t||this._constraints,a=ia.searchDeviceIdByName(this._deviceName);if(a&&!r.deviceId&&(r.deviceId={exact:a}),this._enabled){const l=await ra({video:r},this.getTrackId());this._constraints=r,await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),on.off(Ur.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),on.off(Ur.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(t){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],a=this._encoderConfig;t&&(a=aa(aa({},a),_c(t))),a=Ju(a);const l=un(8,"track-cam-cloned-"),u=new Gl(r?this._mediaStreamTrack.clone():this._mediaStreamTrack,Ju(aa(aa({},this._config),{},{encoderConfig:a})),Ju(this._constraints),Ju(this._scalabilityMode),this._optimizationMode,l);return t&&a&&u.setEncoderConfiguration(a),L.debug("clone track from ".concat(this.getTrackId()," to ").concat(l,", clone ").concat(r)),u}bindProcessorContextEvents(){this.processorContext.on(yo.REQUEST_UPDATE_CONSTRAINTS,async(t,r,a)=>{try{const l=Object.assign({},this._originalConstraints,...t);await this.renewMediaStreamTrack(l),r()}catch(l){a(l)}}),this.processorContext.on(yo.REQUEST_CONSTRAINTS,async t=>{t(this._originMediaStreamTrack.getSettings())})}}function eM(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function Rv(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eM(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):eM(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}function RT(i,t,r,a){r.optimizationMode&&(a&&a.width&&a.height?(r.encoderConfig=Rv(Rv({},a),{},{bitrateMin:a.bitrateMin,bitrateMax:a.bitrateMax}),r.optimizationMode!=="motion"&&r.optimizationMode!=="detail"||(t.contentHint=r.optimizationMode,t.contentHint===r.optimizationMode?L.debug("[".concat(i,"] set content hint to"),r.optimizationMode):L.debug("[".concat(i,"] set content hint failed")))):L.warning("[".concat(i,"] can not apply optimization mode bitrate config, no encoderConfig")))}function tM(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function wv(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tM(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):tM(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}Te([Ze({argsMap:(i,t)=>[i.getTrackId(),t]}),Yn(),V("design:type",Function),V("design:paramtypes",[Object]),V("design:returntype",me)],Gl.prototype,"setDevice",null),Te([Rh("CameraVideoTrack","_enabledMutex"),Ze({argsMap:(i,t)=>[i.getTrackId(),t]}),Yn(),V("design:type",Function),V("design:paramtypes",[Boolean,Boolean]),V("design:returntype",me)],Gl.prototype,"setEnabled",null),Te([Ze({argsMap:(i,t)=>[i.getTrackId(),t]}),Yn(),V("design:type",Function),V("design:paramtypes",[Object,Boolean]),V("design:returntype",me)],Gl.prototype,"setEncoderConfiguration",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],Gl.prototype,"close",null);class nM extends RL{getUserId(){return this._userId}constructor(t,r,a,l){super(t,"track-".concat(t.kind,"-").concat(r,"-").concat(l.clientId,"_").concat(un(5,""))),w(this,"_userId",void 0),w(this,"_uintId",void 0),w(this,"_isDestroyed",!1),w(this,"store",void 0),w(this,"processor",void 0),this._userId=r,this._uintId=a,this.store=l}_updateOriginMediaStreamTrack(t){this._originMediaStreamTrack=t,this._mediaStreamTrack=t,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,L.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}class yc extends nM{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==bi.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(t,r,a,l){super(t,r,a,l),w(this,"_videoVisibleTimer",null),w(this,"_previousVideoVisibleStatus",void 0),w(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),w(this,"trackMediaType","video"),w(this,"_videoWidth",void 0),w(this,"_videoHeight",void 0),w(this,"_player",void 0),w(this,"processorDestination",void 0),w(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new $L(this.getTrackId(),"remote"),this.processorDestination=new VL(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return Hf(()=>{L.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),mo(this,Fe.GET_STATS)||wv({},TL)}play(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof t=="string"){const l=document.getElementById(t);l?t=l:(L.warning("[".concat(this.getTrackId(),'] can not find "#').concat(t,'" element, use document.body')),t=document.body)}L.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(r));const a=wv(wv({fit:"cover"},r),{},{trackId:this.getTrackId(),element:t});this._player?this._player.updateConfig(a):(t instanceof HTMLVideoElement?this._player=new TT(a):this._player=new XL(a),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(id.FIRST_FRAME_DECODED)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const l=this.getVideoElementVisibleStatus();this.safeEmit(id.VIDEO_ELEMENT_VISIBLE_STATUS,l)}catch{}},Z("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,L.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){JL(this._originMediaStreamTrack).then(t=>{let[r,a]=t;this._videoHeight=a,this._videoWidth=r}).catch(Jg)}_updatePlayerSource(){L.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var t,r;const a=this==null||(t=this._player)===null||t===void 0?void 0:t.getContainerElement(),l={track:this,element:this==null||(r=this._player)===null||r===void 0?void 0:r.getVideoElement(),slot:a==null?void 0:a.parentElement},{element:u,slot:h}=l;if(this.isPlaying&&u instanceof HTMLVideoElement&&h instanceof HTMLElement){const f=Bk.checkOneElementVisible(u),v=Object.assign({},f);if(v.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=v.visible;const E=He.reportApiInvoke(null,{tag:Dn.TRACER,name:hr.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});v.visible?E.onSuccess("Video is visible"):E.onSuccess("Invisible because of ".concat(v.reason))}return v}return}catch(a){throw new be(G.GET_VIDEO_ELEMENT_VISIBLE_ERROR,a.message)}}pipe(t){if(this.processor===t)return t;if(t._source)throw new be(G.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),t}unpipe(){if(!this.processor)return;const t=this.processor;this.processor._source=void 0,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(Ci.ON_TRACK,async t=>{t?t!==this._mediaStreamTrack&&(this._mediaStreamTrack=t,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(Ci.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}}Te([Ze({argsMap:(i,t,r)=>[i.getTrackId(),typeof t=="string"?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",r]}),V("design:type",Function),V("design:paramtypes",[Object,Object]),V("design:returntype",void 0)],yc.prototype,"play",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],yc.prototype,"stop",null),Te([Ze({argsMap:(i,t)=>[i.getTrackId(),t.name]}),V("design:type",Function),V("design:paramtypes",[Object]),V("design:returntype",Object)],yc.prototype,"pipe",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],yc.prototype,"unpipe",null);class os extends nM{get isPlaying(){return this._useAudioElement?ko.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(t,r,a,l){super(t,r,a,l),w(this,"trackMediaType","audio"),w(this,"_source",void 0),w(this,"_useAudioElement",!0),w(this,"_volume",100),w(this,"processorContext",void 0),w(this,"processorDestination",void 0),w(this,"_played",!1),w(this,"_bypassWebAudio",!1),Z("DISABLE_WEBAUDIO")?(this._source=new yT,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new vT(t,!0),Z("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(_o.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(id.FIRST_FRAME_DECODED)}),this.processorContext=new bv(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new Cv(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(_o.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!t)return this._source.removeAllListeners(_o.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(r),this._source.removeAllListeners(_o.ON_AUDIO_BUFFER),this._source.on(_o.ON_AUDIO_BUFFER,a=>t(a))}setVolume(t){this._volume=t,this._useAudioElement?ko.setVolume(this.getTrackId(),t):this._source.setVolume(t/100)}async setPlaybackDevice(t){if(!this._useAudioElement)throw new be(G.NOT_SUPPORTED,"your browser does not support setting the audio output device");await ko.setSinkID(this.getTrackId(),t)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return Hf(()=>{L.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),mo(this,Fe.GET_STATS)||wv({},bL)}play(){L.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(L.debug("[".concat(this.getTrackId(),"] use audio element to play")),ko.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){L.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?ko.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let t=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];L.debug("[".concat(this.getTrackId(),"] update player source track")),t&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&ko.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(t){if(this._bypassWebAudio)throw new be(G.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===t)return t;if(t._source)throw new be(G.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),t}unpipe(){var t;if(this._bypassWebAudio)throw new be(G.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const r=this.processor;(t=this._source.processSourceNode)===null||t===void 0||t.disconnect(),this.processor._source=!1,this.processor=void 0,r.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(Ci.ON_TRACK,async t=>{t?t!==this._mediaStreamTrack&&(this._mediaStreamTrack=t,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(t)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(Ci.ON_NODE,t=>{this._source.processedNode=t;const r=!t;this._useAudioElement!==r&&(this._played?(this.stop(),this._useAudioElement=r,this.play()):this._useAudioElement=r)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(Ci.ON_TRACK),this.processorDestination.removeAllListeners(Ci.ON_NODE)}}Te([Ze({argsMap:(i,t)=>[i.getTrackId(),t],throttleTime:300}),V("design:type",Function),V("design:paramtypes",[Number]),V("design:returntype",void 0)],os.prototype,"setVolume",null),Te([Ze({argsMap:(i,t)=>[i.getTrackId(),t]}),V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],os.prototype,"setPlaybackDevice",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],os.prototype,"play",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],os.prototype,"stop",null),Te([Ze({argsMap:(i,t)=>[i.getTrackId(),t.name]}),V("design:type",Function),V("design:paramtypes",[Object]),V("design:returntype",Object)],os.prototype,"pipe",null),Te([Ze({argsMap:i=>[i.getTrackId()]}),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],os.prototype,"unpipe",null);function jh(i){let t=i.length;for(;--t>=0;)i[t]=0}const wT=256,rM=286,Xf=30,Jf=15,IT=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Iv=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Fee=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),iM=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),qc=new Array(576);jh(qc);const Qf=new Array(60);jh(Qf);const Zf=new Array(512);jh(Zf);const e0=new Array(256);jh(e0);const AT=new Array(29);jh(AT);const Av=new Array(Xf);function OT(i,t,r,a,l){this.static_tree=i,this.extra_bits=t,this.extra_base=r,this.elems=a,this.max_length=l,this.has_stree=i&&i.length}let oM,aM,sM;function xT(i,t){this.dyn_tree=i,this.max_code=0,this.stat_desc=t}jh(Av);const cM=i=>i<256?Zf[i]:Zf[256+(i>>>7)],t0=(i,t)=>{i.pending_buf[i.pending++]=255&t,i.pending_buf[i.pending++]=t>>>8&255},sa=(i,t,r)=>{i.bi_valid>16-r?(i.bi_buf|=t<<i.bi_valid&65535,t0(i,i.bi_buf),i.bi_buf=t>>16-i.bi_valid,i.bi_valid+=r-16):(i.bi_buf|=t<<i.bi_valid&65535,i.bi_valid+=r)},Sc=(i,t,r)=>{sa(i,r[2*t],r[2*t+1])},lM=(i,t)=>{let r=0;do r|=1&i,i>>>=1,r<<=1;while(--t>0);return r>>>1},uM=(i,t,r)=>{const a=new Array(16);let l,u,h=0;for(l=1;l<=Jf;l++)h=h+r[l-1]<<1,a[l]=h;for(u=0;u<=t;u++){let f=i[2*u+1];f!==0&&(i[2*u]=lM(a[f]++,f))}},dM=i=>{let t;for(t=0;t<rM;t++)i.dyn_ltree[2*t]=0;for(t=0;t<Xf;t++)i.dyn_dtree[2*t]=0;for(t=0;t<19;t++)i.bl_tree[2*t]=0;i.dyn_ltree[512]=1,i.opt_len=i.static_len=0,i.sym_next=i.matches=0},hM=i=>{i.bi_valid>8?t0(i,i.bi_buf):i.bi_valid>0&&(i.pending_buf[i.pending++]=i.bi_buf),i.bi_buf=0,i.bi_valid=0},pM=(i,t,r,a)=>{const l=2*t,u=2*r;return i[l]<i[u]||i[l]===i[u]&&a[t]<=a[r]},NT=(i,t,r)=>{const a=i.heap[r];let l=r<<1;for(;l<=i.heap_len&&(l<i.heap_len&&pM(t,i.heap[l+1],i.heap[l],i.depth)&&l++,!pM(t,a,i.heap[l],i.depth));)i.heap[r]=i.heap[l],r=l,l<<=1;i.heap[r]=a},fM=(i,t,r)=>{let a,l,u,h,f=0;if(i.sym_next!==0)do a=255&i.pending_buf[i.sym_buf+f++],a+=(255&i.pending_buf[i.sym_buf+f++])<<8,l=i.pending_buf[i.sym_buf+f++],a===0?Sc(i,l,t):(u=e0[l],Sc(i,u+wT+1,t),h=IT[u],h!==0&&(l-=AT[u],sa(i,l,h)),a--,u=cM(a),Sc(i,u,r),h=Iv[u],h!==0&&(a-=Av[u],sa(i,a,h)));while(f<i.sym_next);Sc(i,256,t)},PT=(i,t)=>{const r=t.dyn_tree,a=t.stat_desc.static_tree,l=t.stat_desc.has_stree,u=t.stat_desc.elems;let h,f,v,E=-1;for(i.heap_len=0,i.heap_max=573,h=0;h<u;h++)r[2*h]!==0?(i.heap[++i.heap_len]=E=h,i.depth[h]=0):r[2*h+1]=0;for(;i.heap_len<2;)v=i.heap[++i.heap_len]=E<2?++E:0,r[2*v]=1,i.depth[v]=0,i.opt_len--,l&&(i.static_len-=a[2*v+1]);for(t.max_code=E,h=i.heap_len>>1;h>=1;h--)NT(i,r,h);v=u;do h=i.heap[1],i.heap[1]=i.heap[i.heap_len--],NT(i,r,1),f=i.heap[1],i.heap[--i.heap_max]=h,i.heap[--i.heap_max]=f,r[2*v]=r[2*h]+r[2*f],i.depth[v]=(i.depth[h]>=i.depth[f]?i.depth[h]:i.depth[f])+1,r[2*h+1]=r[2*f+1]=v,i.heap[1]=v++,NT(i,r,1);while(i.heap_len>=2);i.heap[--i.heap_max]=i.heap[1],((y,C)=>{const I=C.dyn_tree,k=C.max_code,W=C.stat_desc.static_tree,$=C.stat_desc.has_stree,z=C.stat_desc.extra_bits,X=C.stat_desc.extra_base,ie=C.stat_desc.max_length;let oe,Re,Ce,ge,_e,Se,De=0;for(ge=0;ge<=Jf;ge++)y.bl_count[ge]=0;for(I[2*y.heap[y.heap_max]+1]=0,oe=y.heap_max+1;oe<573;oe++)Re=y.heap[oe],ge=I[2*I[2*Re+1]+1]+1,ge>ie&&(ge=ie,De++),I[2*Re+1]=ge,Re>k||(y.bl_count[ge]++,_e=0,Re>=X&&(_e=z[Re-X]),Se=I[2*Re],y.opt_len+=Se*(ge+_e),$&&(y.static_len+=Se*(W[2*Re+1]+_e)));if(De!==0){do{for(ge=ie-1;y.bl_count[ge]===0;)ge--;y.bl_count[ge]--,y.bl_count[ge+1]+=2,y.bl_count[ie]--,De-=2}while(De>0);for(ge=ie;ge!==0;ge--)for(Re=y.bl_count[ge];Re!==0;)Ce=y.heap[--oe],Ce>k||(I[2*Ce+1]!==ge&&(y.opt_len+=(ge-I[2*Ce+1])*I[2*Ce],I[2*Ce+1]=ge),Re--)}})(i,t),uM(r,E,i.bl_count)},mM=(i,t,r)=>{let a,l,u=-1,h=t[1],f=0,v=7,E=4;for(h===0&&(v=138,E=3),t[2*(r+1)+1]=65535,a=0;a<=r;a++)l=h,h=t[2*(a+1)+1],++f<v&&l===h||(f<E?i.bl_tree[2*l]+=f:l!==0?(l!==u&&i.bl_tree[2*l]++,i.bl_tree[32]++):f<=10?i.bl_tree[34]++:i.bl_tree[36]++,f=0,u=l,h===0?(v=138,E=3):l===h?(v=6,E=3):(v=7,E=4))},gM=(i,t,r)=>{let a,l,u=-1,h=t[1],f=0,v=7,E=4;for(h===0&&(v=138,E=3),a=0;a<=r;a++)if(l=h,h=t[2*(a+1)+1],!(++f<v&&l===h)){if(f<E)do Sc(i,l,i.bl_tree);while(--f!=0);else l!==0?(l!==u&&(Sc(i,l,i.bl_tree),f--),Sc(i,16,i.bl_tree),sa(i,f-3,2)):f<=10?(Sc(i,17,i.bl_tree),sa(i,f-3,3)):(Sc(i,18,i.bl_tree),sa(i,f-11,7));f=0,u=l,h===0?(v=138,E=3):l===h?(v=6,E=3):(v=7,E=4)}};let vM=!1;const EM=(i,t,r,a)=>{sa(i,0+(a?1:0),3),hM(i),t0(i,r),t0(i,~r),r&&i.pending_buf.set(i.window.subarray(t,t+r),i.pending),i.pending+=r};var Uee=i=>{vM||((()=>{let t,r,a,l,u;const h=new Array(16);for(a=0,l=0;l<28;l++)for(AT[l]=a,t=0;t<1<<IT[l];t++)e0[a++]=l;for(e0[a-1]=l,u=0,l=0;l<16;l++)for(Av[l]=u,t=0;t<1<<Iv[l];t++)Zf[u++]=l;for(u>>=7;l<Xf;l++)for(Av[l]=u<<7,t=0;t<1<<Iv[l]-7;t++)Zf[256+u++]=l;for(r=0;r<=Jf;r++)h[r]=0;for(t=0;t<=143;)qc[2*t+1]=8,t++,h[8]++;for(;t<=255;)qc[2*t+1]=9,t++,h[9]++;for(;t<=279;)qc[2*t+1]=7,t++,h[7]++;for(;t<=287;)qc[2*t+1]=8,t++,h[8]++;for(uM(qc,287,h),t=0;t<Xf;t++)Qf[2*t+1]=5,Qf[2*t]=lM(t,5);oM=new OT(qc,IT,257,rM,Jf),aM=new OT(Qf,Iv,0,Xf,Jf),sM=new OT(new Array(0),Fee,0,19,7)})(),vM=!0),i.l_desc=new xT(i.dyn_ltree,oM),i.d_desc=new xT(i.dyn_dtree,aM),i.bl_desc=new xT(i.bl_tree,sM),i.bi_buf=0,i.bi_valid=0,dM(i)},Bee=(i,t,r,a)=>{let l,u,h=0;i.level>0?(i.strm.data_type===2&&(i.strm.data_type=(f=>{let v,E=4093624447;for(v=0;v<=31;v++,E>>>=1)if(1&E&&f.dyn_ltree[2*v]!==0)return 0;if(f.dyn_ltree[18]!==0||f.dyn_ltree[20]!==0||f.dyn_ltree[26]!==0)return 1;for(v=32;v<wT;v++)if(f.dyn_ltree[2*v]!==0)return 1;return 0})(i)),PT(i,i.l_desc),PT(i,i.d_desc),h=(f=>{let v;for(mM(f,f.dyn_ltree,f.l_desc.max_code),mM(f,f.dyn_dtree,f.d_desc.max_code),PT(f,f.bl_desc),v=18;v>=3&&f.bl_tree[2*iM[v]+1]===0;v--);return f.opt_len+=3*(v+1)+5+5+4,v})(i),l=i.opt_len+3+7>>>3,u=i.static_len+3+7>>>3,u<=l&&(l=u)):l=u=r+5,r+4<=l&&t!==-1?EM(i,t,r,a):i.strategy===4||u===l?(sa(i,2+(a?1:0),3),fM(i,qc,Qf)):(sa(i,4+(a?1:0),3),((f,v,E,y)=>{let C;for(sa(f,v-257,5),sa(f,E-1,5),sa(f,y-4,4),C=0;C<y;C++)sa(f,f.bl_tree[2*iM[C]+1],3);gM(f,f.dyn_ltree,v-1),gM(f,f.dyn_dtree,E-1)})(i,i.l_desc.max_code+1,i.d_desc.max_code+1,h+1),fM(i,i.dyn_ltree,i.dyn_dtree)),dM(i),a&&hM(i)},jee=(i,t,r)=>(i.pending_buf[i.sym_buf+i.sym_next++]=t,i.pending_buf[i.sym_buf+i.sym_next++]=t>>8,i.pending_buf[i.sym_buf+i.sym_next++]=r,t===0?i.dyn_ltree[2*r]++:(i.matches++,t--,i.dyn_ltree[2*(e0[r]+wT+1)]++,i.dyn_dtree[2*cM(t)]++),i.sym_next===i.sym_end),Vee={_tr_init:Uee,_tr_stored_block:EM,_tr_flush_block:Bee,_tr_tally:jee,_tr_align:i=>{sa(i,2,3),Sc(i,256,qc),(t=>{t.bi_valid===16?(t0(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(i)}},n0=(i,t,r,a)=>{let l=65535&i|0,u=i>>>16&65535|0,h=0;for(;r!==0;){h=r>2e3?2e3:r,r-=h;do l=l+t[a++]|0,u=u+l|0;while(--h);l%=65521,u%=65521}return l|u<<16|0};const $ee=new Uint32Array((()=>{let i,t=[];for(var r=0;r<256;r++){i=r;for(var a=0;a<8;a++)i=1&i?3988292384^i>>>1:i>>>1;t[r]=i}return t})());var Wi=(i,t,r,a)=>{const l=$ee,u=a+r;i^=-1;for(let h=a;h<u;h++)i=i>>>8^l[255&(i^t[h])];return-1^i},sd={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Vh={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Hee,_tr_stored_block:DT,_tr_flush_block:Wee,_tr_tally:Kl,_tr_align:zee}=Vee,{Z_NO_FLUSH:ql,Z_PARTIAL_FLUSH:Gee,Z_FULL_FLUSH:Kee,Z_FINISH:as,Z_BLOCK:_M,Z_OK:Zi,Z_STREAM_END:yM,Z_STREAM_ERROR:Cc,Z_DATA_ERROR:qee,Z_BUF_ERROR:kT,Z_DEFAULT_COMPRESSION:Yee,Z_FILTERED:Xee,Z_HUFFMAN_ONLY:Ov,Z_RLE:Jee,Z_FIXED:Qee,Z_DEFAULT_STRATEGY:Zee,Z_UNKNOWN:ete,Z_DEFLATED:xv}=Vh,LT=286,tte=30,nte=19,rte=2*LT+1,ite=15,cd=258,bc=262,$h=42,ld=113,r0=666,ud=(i,t)=>(i.msg=sd[t],t),SM=i=>2*i-(i>4?9:0),Yl=i=>{let t=i.length;for(;--t>=0;)i[t]=0},ote=i=>{let t,r,a,l=i.w_size;t=i.hash_size,a=t;do r=i.head[--a],i.head[a]=r>=l?r-l:0;while(--t);t=l,a=t;do r=i.prev[--a],i.prev[a]=r>=l?r-l:0;while(--t)};let Xl=(i,t,r)=>(t<<i.hash_shift^r)&i.hash_mask;const Aa=i=>{const t=i.state;let r=t.pending;r>i.avail_out&&(r=i.avail_out),r!==0&&(i.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),i.next_out),i.next_out+=r,t.pending_out+=r,i.total_out+=r,i.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},Oa=(i,t)=>{Wee(i,i.block_start>=0?i.block_start:-1,i.strstart-i.block_start,t),i.block_start=i.strstart,Aa(i.strm)},$n=(i,t)=>{i.pending_buf[i.pending++]=t},i0=(i,t)=>{i.pending_buf[i.pending++]=t>>>8&255,i.pending_buf[i.pending++]=255&t},MT=(i,t,r,a)=>{let l=i.avail_in;return l>a&&(l=a),l===0?0:(i.avail_in-=l,t.set(i.input.subarray(i.next_in,i.next_in+l),r),i.state.wrap===1?i.adler=n0(i.adler,t,l,r):i.state.wrap===2&&(i.adler=Wi(i.adler,t,l,r)),i.next_in+=l,i.total_in+=l,l)},CM=(i,t)=>{let r,a,l=i.max_chain_length,u=i.strstart,h=i.prev_length,f=i.nice_match;const v=i.strstart>i.w_size-bc?i.strstart-(i.w_size-bc):0,E=i.window,y=i.w_mask,C=i.prev,I=i.strstart+cd;let k=E[u+h-1],W=E[u+h];i.prev_length>=i.good_match&&(l>>=2),f>i.lookahead&&(f=i.lookahead);do if(r=t,E[r+h]===W&&E[r+h-1]===k&&E[r]===E[u]&&E[++r]===E[u+1]){u+=2,r++;do;while(E[++u]===E[++r]&&E[++u]===E[++r]&&E[++u]===E[++r]&&E[++u]===E[++r]&&E[++u]===E[++r]&&E[++u]===E[++r]&&E[++u]===E[++r]&&E[++u]===E[++r]&&u<I);if(a=cd-(I-u),u=I-cd,a>h){if(i.match_start=t,h=a,a>=f)break;k=E[u+h-1],W=E[u+h]}}while((t=C[t&y])>v&&--l!=0);return h<=i.lookahead?h:i.lookahead},Hh=i=>{const t=i.w_size;let r,a,l;do{if(a=i.window_size-i.lookahead-i.strstart,i.strstart>=t+(t-bc)&&(i.window.set(i.window.subarray(t,t+t-a),0),i.match_start-=t,i.strstart-=t,i.block_start-=t,i.insert>i.strstart&&(i.insert=i.strstart),ote(i),a+=t),i.strm.avail_in===0)break;if(r=MT(i.strm,i.window,i.strstart+i.lookahead,a),i.lookahead+=r,i.lookahead+i.insert>=3)for(l=i.strstart-i.insert,i.ins_h=i.window[l],i.ins_h=Xl(i,i.ins_h,i.window[l+1]);i.insert&&(i.ins_h=Xl(i,i.ins_h,i.window[l+3-1]),i.prev[l&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=l,l++,i.insert--,!(i.lookahead+i.insert<3)););}while(i.lookahead<bc&&i.strm.avail_in!==0)},bM=(i,t)=>{let r,a,l,u=i.pending_buf_size-5>i.w_size?i.w_size:i.pending_buf_size-5,h=0,f=i.strm.avail_in;do{if(r=65535,l=i.bi_valid+42>>3,i.strm.avail_out<l||(l=i.strm.avail_out-l,a=i.strstart-i.block_start,r>a+i.strm.avail_in&&(r=a+i.strm.avail_in),r>l&&(r=l),r<u&&(r===0&&t!==as||t===ql||r!==a+i.strm.avail_in)))break;h=t===as&&r===a+i.strm.avail_in?1:0,DT(i,0,0,h),i.pending_buf[i.pending-4]=r,i.pending_buf[i.pending-3]=r>>8,i.pending_buf[i.pending-2]=~r,i.pending_buf[i.pending-1]=~r>>8,Aa(i.strm),a&&(a>r&&(a=r),i.strm.output.set(i.window.subarray(i.block_start,i.block_start+a),i.strm.next_out),i.strm.next_out+=a,i.strm.avail_out-=a,i.strm.total_out+=a,i.block_start+=a,r-=a),r&&(MT(i.strm,i.strm.output,i.strm.next_out,r),i.strm.next_out+=r,i.strm.avail_out-=r,i.strm.total_out+=r)}while(h===0);return f-=i.strm.avail_in,f&&(f>=i.w_size?(i.matches=2,i.window.set(i.strm.input.subarray(i.strm.next_in-i.w_size,i.strm.next_in),0),i.strstart=i.w_size,i.insert=i.strstart):(i.window_size-i.strstart<=f&&(i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,i.insert>i.strstart&&(i.insert=i.strstart)),i.window.set(i.strm.input.subarray(i.strm.next_in-f,i.strm.next_in),i.strstart),i.strstart+=f,i.insert+=f>i.w_size-i.insert?i.w_size-i.insert:f),i.block_start=i.strstart),i.high_water<i.strstart&&(i.high_water=i.strstart),h?4:t!==ql&&t!==as&&i.strm.avail_in===0&&i.strstart===i.block_start?2:(l=i.window_size-i.strstart,i.strm.avail_in>l&&i.block_start>=i.w_size&&(i.block_start-=i.w_size,i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,l+=i.w_size,i.insert>i.strstart&&(i.insert=i.strstart)),l>i.strm.avail_in&&(l=i.strm.avail_in),l&&(MT(i.strm,i.window,i.strstart,l),i.strstart+=l,i.insert+=l>i.w_size-i.insert?i.w_size-i.insert:l),i.high_water<i.strstart&&(i.high_water=i.strstart),l=i.bi_valid+42>>3,l=i.pending_buf_size-l>65535?65535:i.pending_buf_size-l,u=l>i.w_size?i.w_size:l,a=i.strstart-i.block_start,(a>=u||(a||t===as)&&t!==ql&&i.strm.avail_in===0&&a<=l)&&(r=a>l?l:a,h=t===as&&i.strm.avail_in===0&&r===a?1:0,DT(i,i.block_start,r,h),i.block_start+=r,Aa(i.strm)),h?3:1)},FT=(i,t)=>{let r,a;for(;;){if(i.lookahead<bc){if(Hh(i),i.lookahead<bc&&t===ql)return 1;if(i.lookahead===0)break}if(r=0,i.lookahead>=3&&(i.ins_h=Xl(i,i.ins_h,i.window[i.strstart+3-1]),r=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),r!==0&&i.strstart-r<=i.w_size-bc&&(i.match_length=CM(i,r)),i.match_length>=3)if(a=Kl(i,i.strstart-i.match_start,i.match_length-3),i.lookahead-=i.match_length,i.match_length<=i.max_lazy_match&&i.lookahead>=3){i.match_length--;do i.strstart++,i.ins_h=Xl(i,i.ins_h,i.window[i.strstart+3-1]),r=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart;while(--i.match_length!=0);i.strstart++}else i.strstart+=i.match_length,i.match_length=0,i.ins_h=i.window[i.strstart],i.ins_h=Xl(i,i.ins_h,i.window[i.strstart+1]);else a=Kl(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++;if(a&&(Oa(i,!1),i.strm.avail_out===0))return 1}return i.insert=i.strstart<2?i.strstart:2,t===as?(Oa(i,!0),i.strm.avail_out===0?3:4):i.sym_next&&(Oa(i,!1),i.strm.avail_out===0)?1:2},Wh=(i,t)=>{let r,a,l;for(;;){if(i.lookahead<bc){if(Hh(i),i.lookahead<bc&&t===ql)return 1;if(i.lookahead===0)break}if(r=0,i.lookahead>=3&&(i.ins_h=Xl(i,i.ins_h,i.window[i.strstart+3-1]),r=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),i.prev_length=i.match_length,i.prev_match=i.match_start,i.match_length=2,r!==0&&i.prev_length<i.max_lazy_match&&i.strstart-r<=i.w_size-bc&&(i.match_length=CM(i,r),i.match_length<=5&&(i.strategy===Xee||i.match_length===3&&i.strstart-i.match_start>4096)&&(i.match_length=2)),i.prev_length>=3&&i.match_length<=i.prev_length){l=i.strstart+i.lookahead-3,a=Kl(i,i.strstart-1-i.prev_match,i.prev_length-3),i.lookahead-=i.prev_length-1,i.prev_length-=2;do++i.strstart<=l&&(i.ins_h=Xl(i,i.ins_h,i.window[i.strstart+3-1]),r=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart);while(--i.prev_length!=0);if(i.match_available=0,i.match_length=2,i.strstart++,a&&(Oa(i,!1),i.strm.avail_out===0))return 1}else if(i.match_available){if(a=Kl(i,0,i.window[i.strstart-1]),a&&Oa(i,!1),i.strstart++,i.lookahead--,i.strm.avail_out===0)return 1}else i.match_available=1,i.strstart++,i.lookahead--}return i.match_available&&(a=Kl(i,0,i.window[i.strstart-1]),i.match_available=0),i.insert=i.strstart<2?i.strstart:2,t===as?(Oa(i,!0),i.strm.avail_out===0?3:4):i.sym_next&&(Oa(i,!1),i.strm.avail_out===0)?1:2};function Tc(i,t,r,a,l){this.good_length=i,this.max_lazy=t,this.nice_length=r,this.max_chain=a,this.func=l}const o0=[new Tc(0,0,0,0,bM),new Tc(4,4,8,4,FT),new Tc(4,5,16,8,FT),new Tc(4,6,32,32,FT),new Tc(4,4,16,16,Wh),new Tc(8,16,32,32,Wh),new Tc(8,16,128,128,Wh),new Tc(8,32,128,256,Wh),new Tc(32,128,258,1024,Wh),new Tc(32,258,258,4096,Wh)];function ate(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=xv,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*rte),this.dyn_dtree=new Uint16Array(2*(2*tte+1)),this.bl_tree=new Uint16Array(2*(2*nte+1)),Yl(this.dyn_ltree),Yl(this.dyn_dtree),Yl(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(ite+1),this.heap=new Uint16Array(2*LT+1),Yl(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*LT+1),Yl(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const a0=i=>{if(!i)return 1;const t=i.state;return!t||t.strm!==i||t.status!==$h&&t.status!==57&&t.status!==69&&t.status!==73&&t.status!==91&&t.status!==103&&t.status!==ld&&t.status!==r0?1:0},TM=i=>{if(a0(i))return ud(i,Cc);i.total_in=i.total_out=0,i.data_type=ete;const t=i.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?57:t.wrap?$h:ld,i.adler=t.wrap===2?0:1,t.last_flush=-2,Hee(t),Zi},RM=i=>{const t=TM(i);var r;return t===Zi&&((r=i.state).window_size=2*r.w_size,Yl(r.head),r.max_lazy_match=o0[r.level].max_lazy,r.good_match=o0[r.level].good_length,r.nice_match=o0[r.level].nice_length,r.max_chain_length=o0[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0),t},wM=(i,t,r,a,l,u)=>{if(!i)return Cc;let h=1;if(t===Yee&&(t=6),a<0?(h=0,a=-a):a>15&&(h=2,a-=16),l<1||l>9||r!==xv||a<8||a>15||t<0||t>9||u<0||u>Qee||a===8&&h!==1)return ud(i,Cc);a===8&&(a=9);const f=new ate;return i.state=f,f.strm=i,f.status=$h,f.wrap=h,f.gzhead=null,f.w_bits=a,f.w_size=1<<f.w_bits,f.w_mask=f.w_size-1,f.hash_bits=l+7,f.hash_size=1<<f.hash_bits,f.hash_mask=f.hash_size-1,f.hash_shift=~~((f.hash_bits+3-1)/3),f.window=new Uint8Array(2*f.w_size),f.head=new Uint16Array(f.hash_size),f.prev=new Uint16Array(f.w_size),f.lit_bufsize=1<<l+6,f.pending_buf_size=4*f.lit_bufsize,f.pending_buf=new Uint8Array(f.pending_buf_size),f.sym_buf=f.lit_bufsize,f.sym_end=3*(f.lit_bufsize-1),f.level=t,f.strategy=u,f.method=r,RM(i)};var ste=(i,t)=>{if(a0(i)||t>_M||t<0)return i?ud(i,Cc):Cc;const r=i.state;if(!i.output||i.avail_in!==0&&!i.input||r.status===r0&&t!==as)return ud(i,i.avail_out===0?kT:Cc);const a=r.last_flush;if(r.last_flush=t,r.pending!==0){if(Aa(i),i.avail_out===0)return r.last_flush=-1,Zi}else if(i.avail_in===0&&SM(t)<=SM(a)&&t!==as)return ud(i,kT);if(r.status===r0&&i.avail_in!==0)return ud(i,kT);if(r.status===$h&&r.wrap===0&&(r.status=ld),r.status===$h){let l=xv+(r.w_bits-8<<4)<<8,u=-1;if(u=r.strategy>=Ov||r.level<2?0:r.level<6?1:r.level===6?2:3,l|=u<<6,r.strstart!==0&&(l|=32),l+=31-l%31,i0(r,l),r.strstart!==0&&(i0(r,i.adler>>>16),i0(r,65535&i.adler)),i.adler=1,r.status=ld,Aa(i),r.pending!==0)return r.last_flush=-1,Zi}if(r.status===57){if(i.adler=0,$n(r,31),$n(r,139),$n(r,8),r.gzhead)$n(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),$n(r,255&r.gzhead.time),$n(r,r.gzhead.time>>8&255),$n(r,r.gzhead.time>>16&255),$n(r,r.gzhead.time>>24&255),$n(r,r.level===9?2:r.strategy>=Ov||r.level<2?4:0),$n(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&($n(r,255&r.gzhead.extra.length),$n(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(i.adler=Wi(i.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if($n(r,0),$n(r,0),$n(r,0),$n(r,0),$n(r,0),$n(r,r.level===9?2:r.strategy>=Ov||r.level<2?4:0),$n(r,3),r.status=ld,Aa(i),r.pending!==0)return r.last_flush=-1,Zi}if(r.status===69){if(r.gzhead.extra){let l=r.pending,u=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+u>r.pending_buf_size;){let f=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+f),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>l&&(i.adler=Wi(i.adler,r.pending_buf,r.pending-l,l)),r.gzindex+=f,Aa(i),r.pending!==0)return r.last_flush=-1,Zi;l=0,u-=f}let h=new Uint8Array(r.gzhead.extra);r.pending_buf.set(h.subarray(r.gzindex,r.gzindex+u),r.pending),r.pending+=u,r.gzhead.hcrc&&r.pending>l&&(i.adler=Wi(i.adler,r.pending_buf,r.pending-l,l)),r.gzindex=0}r.status=73}if(r.status===73){if(r.gzhead.name){let l,u=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>u&&(i.adler=Wi(i.adler,r.pending_buf,r.pending-u,u)),Aa(i),r.pending!==0)return r.last_flush=-1,Zi;u=0}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,$n(r,l)}while(l!==0);r.gzhead.hcrc&&r.pending>u&&(i.adler=Wi(i.adler,r.pending_buf,r.pending-u,u)),r.gzindex=0}r.status=91}if(r.status===91){if(r.gzhead.comment){let l,u=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>u&&(i.adler=Wi(i.adler,r.pending_buf,r.pending-u,u)),Aa(i),r.pending!==0)return r.last_flush=-1,Zi;u=0}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,$n(r,l)}while(l!==0);r.gzhead.hcrc&&r.pending>u&&(i.adler=Wi(i.adler,r.pending_buf,r.pending-u,u))}r.status=103}if(r.status===103){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Aa(i),r.pending!==0))return r.last_flush=-1,Zi;$n(r,255&i.adler),$n(r,i.adler>>8&255),i.adler=0}if(r.status=ld,Aa(i),r.pending!==0)return r.last_flush=-1,Zi}if(i.avail_in!==0||r.lookahead!==0||t!==ql&&r.status!==r0){let l=r.level===0?bM(r,t):r.strategy===Ov?((u,h)=>{let f;for(;;){if(u.lookahead===0&&(Hh(u),u.lookahead===0)){if(h===ql)return 1;break}if(u.match_length=0,f=Kl(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++,f&&(Oa(u,!1),u.strm.avail_out===0))return 1}return u.insert=0,h===as?(Oa(u,!0),u.strm.avail_out===0?3:4):u.sym_next&&(Oa(u,!1),u.strm.avail_out===0)?1:2})(r,t):r.strategy===Jee?((u,h)=>{let f,v,E,y;const C=u.window;for(;;){if(u.lookahead<=cd){if(Hh(u),u.lookahead<=cd&&h===ql)return 1;if(u.lookahead===0)break}if(u.match_length=0,u.lookahead>=3&&u.strstart>0&&(E=u.strstart-1,v=C[E],v===C[++E]&&v===C[++E]&&v===C[++E])){y=u.strstart+cd;do;while(v===C[++E]&&v===C[++E]&&v===C[++E]&&v===C[++E]&&v===C[++E]&&v===C[++E]&&v===C[++E]&&v===C[++E]&&E<y);u.match_length=cd-(y-E),u.match_length>u.lookahead&&(u.match_length=u.lookahead)}if(u.match_length>=3?(f=Kl(u,1,u.match_length-3),u.lookahead-=u.match_length,u.strstart+=u.match_length,u.match_length=0):(f=Kl(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++),f&&(Oa(u,!1),u.strm.avail_out===0))return 1}return u.insert=0,h===as?(Oa(u,!0),u.strm.avail_out===0?3:4):u.sym_next&&(Oa(u,!1),u.strm.avail_out===0)?1:2})(r,t):o0[r.level].func(r,t);if(l!==3&&l!==4||(r.status=r0),l===1||l===3)return i.avail_out===0&&(r.last_flush=-1),Zi;if(l===2&&(t===Gee?zee(r):t!==_M&&(DT(r,0,0,!1),t===Kee&&(Yl(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),Aa(i),i.avail_out===0))return r.last_flush=-1,Zi}return t!==as?Zi:r.wrap<=0?yM:(r.wrap===2?($n(r,255&i.adler),$n(r,i.adler>>8&255),$n(r,i.adler>>16&255),$n(r,i.adler>>24&255),$n(r,255&i.total_in),$n(r,i.total_in>>8&255),$n(r,i.total_in>>16&255),$n(r,i.total_in>>24&255)):(i0(r,i.adler>>>16),i0(r,65535&i.adler)),Aa(i),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Zi:yM)},cte=(i,t)=>{let r=t.length;if(a0(i))return Cc;const a=i.state,l=a.wrap;if(l===2||l===1&&a.status!==$h||a.lookahead)return Cc;if(l===1&&(i.adler=n0(i.adler,t,r,0)),a.wrap=0,r>=a.w_size){l===0&&(Yl(a.head),a.strstart=0,a.block_start=0,a.insert=0);let v=new Uint8Array(a.w_size);v.set(t.subarray(r-a.w_size,r),0),t=v,r=a.w_size}const u=i.avail_in,h=i.next_in,f=i.input;for(i.avail_in=r,i.next_in=0,i.input=t,Hh(a);a.lookahead>=3;){let v=a.strstart,E=a.lookahead-2;do a.ins_h=Xl(a,a.ins_h,a.window[v+3-1]),a.prev[v&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=v,v++;while(--E);a.strstart=v,a.lookahead=2,Hh(a)}return a.strstart+=a.lookahead,a.block_start=a.strstart,a.insert=a.lookahead,a.lookahead=0,a.match_length=a.prev_length=2,a.match_available=0,i.next_in=h,i.input=f,i.avail_in=u,a.wrap=l,Zi},s0={deflateInit:(i,t)=>wM(i,t,xv,15,8,Zee),deflateInit2:wM,deflateReset:RM,deflateResetKeep:TM,deflateSetHeader:(i,t)=>a0(i)||i.state.wrap!==2?Cc:(i.state.gzhead=t,Zi),deflate:ste,deflateEnd:i=>{if(a0(i))return Cc;const t=i.state.status;return i.state=null,t===ld?ud(i,qee):Zi},deflateSetDictionary:cte,deflateInfo:"pako deflate (from Nodeca project)"};const lte=(i,t)=>Object.prototype.hasOwnProperty.call(i,t);var Nv={assign:function(i){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const a in r)lte(r,a)&&(i[a]=r[a])}}return i},flattenChunks:i=>{let t=0;for(let a=0,l=i.length;a<l;a++)t+=i[a].length;const r=new Uint8Array(t);for(let a=0,l=0,u=i.length;a<u;a++){let h=i[a];r.set(h,l),l+=h.length}return r}};let IM=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{IM=!1}const c0=new Uint8Array(256);for(let i=0;i<256;i++)c0[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;c0[254]=c0[254]=1;var l0={string2buf:i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let t,r,a,l,u,h=i.length,f=0;for(l=0;l<h;l++)r=i.charCodeAt(l),(64512&r)==55296&&l+1<h&&(a=i.charCodeAt(l+1),(64512&a)==56320&&(r=65536+(r-55296<<10)+(a-56320),l++)),f+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(f),u=0,l=0;u<f;l++)r=i.charCodeAt(l),(64512&r)==55296&&l+1<h&&(a=i.charCodeAt(l+1),(64512&a)==56320&&(r=65536+(r-55296<<10)+(a-56320),l++)),r<128?t[u++]=r:r<2048?(t[u++]=192|r>>>6,t[u++]=128|63&r):r<65536?(t[u++]=224|r>>>12,t[u++]=128|r>>>6&63,t[u++]=128|63&r):(t[u++]=240|r>>>18,t[u++]=128|r>>>12&63,t[u++]=128|r>>>6&63,t[u++]=128|63&r);return t},buf2string:(i,t)=>{const r=t||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,t));let a,l;const u=new Array(2*r);for(l=0,a=0;a<r;){let h=i[a++];if(h<128){u[l++]=h;continue}let f=c0[h];if(f>4)u[l++]=65533,a+=f-1;else{for(h&=f===2?31:f===3?15:7;f>1&&a<r;)h=h<<6|63&i[a++],f--;f>1?u[l++]=65533:h<65536?u[l++]=h:(h-=65536,u[l++]=55296|h>>10&1023,u[l++]=56320|1023&h)}}return((h,f)=>{if(f<65534&&h.subarray&&IM)return String.fromCharCode.apply(null,h.length===f?h:h.subarray(0,f));let v="";for(let E=0;E<f;E++)v+=String.fromCharCode(h[E]);return v})(u,l)},utf8border:(i,t)=>{(t=t||i.length)>i.length&&(t=i.length);let r=t-1;for(;r>=0&&(192&i[r])==128;)r--;return r<0||r===0?t:r+c0[i[r]]>t?r:t}},AM=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const OM=Object.prototype.toString,{Z_NO_FLUSH:ute,Z_SYNC_FLUSH:dte,Z_FULL_FLUSH:hte,Z_FINISH:pte,Z_OK:Pv,Z_STREAM_END:fte,Z_DEFAULT_COMPRESSION:mte,Z_DEFAULT_STRATEGY:gte,Z_DEFLATED:vte}=Vh;function u0(i){this.options=Nv.assign({level:mte,method:vte,chunkSize:16384,windowBits:15,memLevel:8,strategy:gte},i||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new AM,this.strm.avail_out=0;let r=s0.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==Pv)throw new Error(sd[r]);if(t.header&&s0.deflateSetHeader(this.strm,t.header),t.dictionary){let a;if(a=typeof t.dictionary=="string"?l0.string2buf(t.dictionary):OM.call(t.dictionary)==="[object ArrayBuffer]"?new Uint8Array(t.dictionary):t.dictionary,r=s0.deflateSetDictionary(this.strm,a),r!==Pv)throw new Error(sd[r]);this._dict_set=!0}}function UT(i,t){const r=new u0(t);if(r.push(i,!0),r.err)throw r.msg||sd[r.err];return r.result}u0.prototype.push=function(i,t){const r=this.strm,a=this.options.chunkSize;let l,u;if(this.ended)return!1;for(u=t===~~t?t:t===!0?pte:ute,typeof i=="string"?r.input=l0.string2buf(i):OM.call(i)==="[object ArrayBuffer]"?r.input=new Uint8Array(i):r.input=i,r.next_in=0,r.avail_in=r.input.length;;)if(r.avail_out===0&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),(u===dte||u===hte)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(l=s0.deflate(r,u),l===fte)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),l=s0.deflateEnd(this.strm),this.onEnd(l),this.ended=!0,l===Pv;if(r.avail_out!==0){if(u>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(r.avail_in===0)break}else this.onData(r.output)}return!0},u0.prototype.onData=function(i){this.chunks.push(i)},u0.prototype.onEnd=function(i){i===Pv&&(this.result=Nv.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};var Ete={Deflate:u0,deflate:UT,deflateRaw:function(i,t){return(t=t||{}).raw=!0,UT(i,t)},gzip:function(i,t){return(t=t||{}).gzip=!0,UT(i,t)},constants:Vh};const Dv=16209;var _te=function(i,t){let r,a,l,u,h,f,v,E,y,C,I,k,W,$,z,X,ie,oe,Re,Ce,ge,_e,Se,De;const Ne=i.state;r=i.next_in,Se=i.input,a=r+(i.avail_in-5),l=i.next_out,De=i.output,u=l-(t-i.avail_out),h=l+(i.avail_out-257),f=Ne.dmax,v=Ne.wsize,E=Ne.whave,y=Ne.wnext,C=Ne.window,I=Ne.hold,k=Ne.bits,W=Ne.lencode,$=Ne.distcode,z=(1<<Ne.lenbits)-1,X=(1<<Ne.distbits)-1;e:do{k<15&&(I+=Se[r++]<<k,k+=8,I+=Se[r++]<<k,k+=8),ie=W[I&z];t:for(;;){if(oe=ie>>>24,I>>>=oe,k-=oe,oe=ie>>>16&255,oe===0)De[l++]=65535&ie;else{if(!(16&oe)){if(!(64&oe)){ie=W[(65535&ie)+(I&(1<<oe)-1)];continue t}if(32&oe){Ne.mode=16191;break e}i.msg="invalid literal/length code",Ne.mode=Dv;break e}Re=65535&ie,oe&=15,oe&&(k<oe&&(I+=Se[r++]<<k,k+=8),Re+=I&(1<<oe)-1,I>>>=oe,k-=oe),k<15&&(I+=Se[r++]<<k,k+=8,I+=Se[r++]<<k,k+=8),ie=$[I&X];n:for(;;){if(oe=ie>>>24,I>>>=oe,k-=oe,oe=ie>>>16&255,!(16&oe)){if(!(64&oe)){ie=$[(65535&ie)+(I&(1<<oe)-1)];continue n}i.msg="invalid distance code",Ne.mode=Dv;break e}if(Ce=65535&ie,oe&=15,k<oe&&(I+=Se[r++]<<k,k+=8,k<oe&&(I+=Se[r++]<<k,k+=8)),Ce+=I&(1<<oe)-1,Ce>f){i.msg="invalid distance too far back",Ne.mode=Dv;break e}if(I>>>=oe,k-=oe,oe=l-u,Ce>oe){if(oe=Ce-oe,oe>E&&Ne.sane){i.msg="invalid distance too far back",Ne.mode=Dv;break e}if(ge=0,_e=C,y===0){if(ge+=v-oe,oe<Re){Re-=oe;do De[l++]=C[ge++];while(--oe);ge=l-Ce,_e=De}}else if(y<oe){if(ge+=v+y-oe,oe-=y,oe<Re){Re-=oe;do De[l++]=C[ge++];while(--oe);if(ge=0,y<Re){oe=y,Re-=oe;do De[l++]=C[ge++];while(--oe);ge=l-Ce,_e=De}}}else if(ge+=y-oe,oe<Re){Re-=oe;do De[l++]=C[ge++];while(--oe);ge=l-Ce,_e=De}for(;Re>2;)De[l++]=_e[ge++],De[l++]=_e[ge++],De[l++]=_e[ge++],Re-=3;Re&&(De[l++]=_e[ge++],Re>1&&(De[l++]=_e[ge++]))}else{ge=l-Ce;do De[l++]=De[ge++],De[l++]=De[ge++],De[l++]=De[ge++],Re-=3;while(Re>2);Re&&(De[l++]=De[ge++],Re>1&&(De[l++]=De[ge++]))}break}}break}}while(r<a&&l<h);Re=k>>3,r-=Re,k-=Re<<3,I&=(1<<k)-1,i.next_in=r,i.next_out=l,i.avail_in=r<a?a-r+5:5-(r-a),i.avail_out=l<h?h-l+257:257-(l-h),Ne.hold=I,Ne.bits=k};const kv=15,yte=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Ste=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Cte=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),bte=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var d0=(i,t,r,a,l,u,h,f)=>{const v=f.bits;let E,y,C,I,k,W,$=0,z=0,X=0,ie=0,oe=0,Re=0,Ce=0,ge=0,_e=0,Se=0,De=null;const Ne=new Uint16Array(16),vt=new Uint16Array(16);let Ft,Bn,fr,bn=null;for($=0;$<=kv;$++)Ne[$]=0;for(z=0;z<a;z++)Ne[t[r+z]]++;for(oe=v,ie=kv;ie>=1&&Ne[ie]===0;ie--);if(oe>ie&&(oe=ie),ie===0)return l[u++]=20971520,l[u++]=20971520,f.bits=1,0;for(X=1;X<ie&&Ne[X]===0;X++);for(oe<X&&(oe=X),ge=1,$=1;$<=kv;$++)if(ge<<=1,ge-=Ne[$],ge<0)return-1;if(ge>0&&(i===0||ie!==1))return-1;for(vt[1]=0,$=1;$<kv;$++)vt[$+1]=vt[$]+Ne[$];for(z=0;z<a;z++)t[r+z]!==0&&(h[vt[t[r+z]]++]=z);if(i===0?(De=bn=h,W=20):i===1?(De=yte,bn=Ste,W=257):(De=Cte,bn=bte,W=0),Se=0,z=0,$=X,k=u,Re=oe,Ce=0,C=-1,_e=1<<oe,I=_e-1,i===1&&_e>852||i===2&&_e>592)return 1;for(;;){Ft=$-Ce,h[z]+1<W?(Bn=0,fr=h[z]):h[z]>=W?(Bn=bn[h[z]-W],fr=De[h[z]-W]):(Bn=96,fr=0),E=1<<$-Ce,y=1<<Re,X=y;do y-=E,l[k+(Se>>Ce)+y]=Ft<<24|Bn<<16|fr|0;while(y!==0);for(E=1<<$-1;Se&E;)E>>=1;if(E!==0?(Se&=E-1,Se+=E):Se=0,z++,--Ne[$]==0){if($===ie)break;$=t[r+h[z]]}if($>oe&&(Se&I)!==C){for(Ce===0&&(Ce=oe),k+=X,Re=$-Ce,ge=1<<Re;Re+Ce<ie&&(ge-=Ne[Re+Ce],!(ge<=0));)Re++,ge<<=1;if(_e+=1<<Re,i===1&&_e>852||i===2&&_e>592)return 1;C=Se&I,l[C]=oe<<24|Re<<16|k-u|0}}return Se!==0&&(l[k+Se]=$-Ce<<24|64<<16|0),f.bits=oe,0};const{Z_FINISH:xM,Z_BLOCK:Tte,Z_TREES:Lv,Z_OK:dd,Z_STREAM_END:Rte,Z_NEED_DICT:wte,Z_STREAM_ERROR:ss,Z_DATA_ERROR:NM,Z_MEM_ERROR:PM,Z_BUF_ERROR:Ite,Z_DEFLATED:DM}=Vh,Mv=16180,Fv=16190,Yc=16191,BT=16192,jT=16194,Uv=16199,Bv=16200,VT=16206,Br=16209,kM=i=>(i>>>24&255)+(i>>>8&65280)+((65280&i)<<8)+((255&i)<<24);function Ate(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const hd=i=>{if(!i)return 1;const t=i.state;return!t||t.strm!==i||t.mode<Mv||t.mode>16211?1:0},LM=i=>{if(hd(i))return ss;const t=i.state;return i.total_in=i.total_out=t.total=0,i.msg="",t.wrap&&(i.adler=1&t.wrap),t.mode=Mv,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,dd},MM=i=>{if(hd(i))return ss;const t=i.state;return t.wsize=0,t.whave=0,t.wnext=0,LM(i)},FM=(i,t)=>{let r;if(hd(i))return ss;const a=i.state;return t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?ss:(a.window!==null&&a.wbits!==t&&(a.window=null),a.wrap=r,a.wbits=t,MM(i))},UM=(i,t)=>{if(!i)return ss;const r=new Ate;i.state=r,r.strm=i,r.window=null,r.mode=Mv;const a=FM(i,t);return a!==dd&&(i.state=null),a};let $T,HT,BM=!0;const Ote=i=>{if(BM){$T=new Int32Array(512),HT=new Int32Array(32);let t=0;for(;t<144;)i.lens[t++]=8;for(;t<256;)i.lens[t++]=9;for(;t<280;)i.lens[t++]=7;for(;t<288;)i.lens[t++]=8;for(d0(1,i.lens,0,288,$T,0,i.work,{bits:9}),t=0;t<32;)i.lens[t++]=5;d0(2,i.lens,0,32,HT,0,i.work,{bits:5}),BM=!1}i.lencode=$T,i.lenbits=9,i.distcode=HT,i.distbits=5},jM=(i,t,r,a)=>{let l;const u=i.state;return u.window===null&&(u.wsize=1<<u.wbits,u.wnext=0,u.whave=0,u.window=new Uint8Array(u.wsize)),a>=u.wsize?(u.window.set(t.subarray(r-u.wsize,r),0),u.wnext=0,u.whave=u.wsize):(l=u.wsize-u.wnext,l>a&&(l=a),u.window.set(t.subarray(r-a,r-a+l),u.wnext),(a-=l)?(u.window.set(t.subarray(r-a,r),0),u.wnext=a,u.whave=u.wsize):(u.wnext+=l,u.wnext===u.wsize&&(u.wnext=0),u.whave<u.wsize&&(u.whave+=l))),0};var xte=(i,t)=>{let r,a,l,u,h,f,v,E,y,C,I,k,W,$,z,X,ie,oe,Re,Ce,ge,_e,Se=0;const De=new Uint8Array(4);let Ne,vt;const Ft=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(hd(i)||!i.output||!i.input&&i.avail_in!==0)return ss;r=i.state,r.mode===Yc&&(r.mode=BT),h=i.next_out,l=i.output,v=i.avail_out,u=i.next_in,a=i.input,f=i.avail_in,E=r.hold,y=r.bits,C=f,I=v,_e=dd;e:for(;;)switch(r.mode){case Mv:if(r.wrap===0){r.mode=BT;break}for(;y<16;){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}if(2&r.wrap&&E===35615){r.wbits===0&&(r.wbits=15),r.check=0,De[0]=255&E,De[1]=E>>>8&255,r.check=Wi(r.check,De,2,0),E=0,y=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&E)<<8)+(E>>8))%31){i.msg="incorrect header check",r.mode=Br;break}if((15&E)!==DM){i.msg="unknown compression method",r.mode=Br;break}if(E>>>=4,y-=4,ge=8+(15&E),r.wbits===0&&(r.wbits=ge),ge>15||ge>r.wbits){i.msg="invalid window size",r.mode=Br;break}r.dmax=1<<r.wbits,r.flags=0,i.adler=r.check=1,r.mode=512&E?16189:Yc,E=0,y=0;break;case 16181:for(;y<16;){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}if(r.flags=E,(255&r.flags)!==DM){i.msg="unknown compression method",r.mode=Br;break}if(57344&r.flags){i.msg="unknown header flags set",r.mode=Br;break}r.head&&(r.head.text=E>>8&1),512&r.flags&&4&r.wrap&&(De[0]=255&E,De[1]=E>>>8&255,r.check=Wi(r.check,De,2,0)),E=0,y=0,r.mode=16182;case 16182:for(;y<32;){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}r.head&&(r.head.time=E),512&r.flags&&4&r.wrap&&(De[0]=255&E,De[1]=E>>>8&255,De[2]=E>>>16&255,De[3]=E>>>24&255,r.check=Wi(r.check,De,4,0)),E=0,y=0,r.mode=16183;case 16183:for(;y<16;){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}r.head&&(r.head.xflags=255&E,r.head.os=E>>8),512&r.flags&&4&r.wrap&&(De[0]=255&E,De[1]=E>>>8&255,r.check=Wi(r.check,De,2,0)),E=0,y=0,r.mode=16184;case 16184:if(1024&r.flags){for(;y<16;){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}r.length=E,r.head&&(r.head.extra_len=E),512&r.flags&&4&r.wrap&&(De[0]=255&E,De[1]=E>>>8&255,r.check=Wi(r.check,De,2,0)),E=0,y=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&(k=r.length,k>f&&(k=f),k&&(r.head&&(ge=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(a.subarray(u,u+k),ge)),512&r.flags&&4&r.wrap&&(r.check=Wi(r.check,a,k,u)),f-=k,u+=k,r.length-=k),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(f===0)break e;k=0;do ge=a[u+k++],r.head&&ge&&r.length<65536&&(r.head.name+=String.fromCharCode(ge));while(ge&&k<f);if(512&r.flags&&4&r.wrap&&(r.check=Wi(r.check,a,k,u)),f-=k,u+=k,ge)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(f===0)break e;k=0;do ge=a[u+k++],r.head&&ge&&r.length<65536&&(r.head.comment+=String.fromCharCode(ge));while(ge&&k<f);if(512&r.flags&&4&r.wrap&&(r.check=Wi(r.check,a,k,u)),f-=k,u+=k,ge)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;y<16;){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}if(4&r.wrap&&E!==(65535&r.check)){i.msg="header crc mismatch",r.mode=Br;break}E=0,y=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),i.adler=r.check=0,r.mode=Yc;break;case 16189:for(;y<32;){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}i.adler=r.check=kM(E),E=0,y=0,r.mode=Fv;case Fv:if(r.havedict===0)return i.next_out=h,i.avail_out=v,i.next_in=u,i.avail_in=f,r.hold=E,r.bits=y,wte;i.adler=r.check=1,r.mode=Yc;case Yc:if(t===Tte||t===Lv)break e;case BT:if(r.last){E>>>=7&y,y-=7&y,r.mode=VT;break}for(;y<3;){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}switch(r.last=1&E,E>>>=1,y-=1,3&E){case 0:r.mode=16193;break;case 1:if(Ote(r),r.mode=Uv,t===Lv){E>>>=2,y-=2;break e}break;case 2:r.mode=16196;break;case 3:i.msg="invalid block type",r.mode=Br}E>>>=2,y-=2;break;case 16193:for(E>>>=7&y,y-=7&y;y<32;){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}if((65535&E)!=(E>>>16^65535)){i.msg="invalid stored block lengths",r.mode=Br;break}if(r.length=65535&E,E=0,y=0,r.mode=jT,t===Lv)break e;case jT:r.mode=16195;case 16195:if(k=r.length,k){if(k>f&&(k=f),k>v&&(k=v),k===0)break e;l.set(a.subarray(u,u+k),h),f-=k,u+=k,v-=k,h+=k,r.length-=k;break}r.mode=Yc;break;case 16196:for(;y<14;){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}if(r.nlen=257+(31&E),E>>>=5,y-=5,r.ndist=1+(31&E),E>>>=5,y-=5,r.ncode=4+(15&E),E>>>=4,y-=4,r.nlen>286||r.ndist>30){i.msg="too many length or distance symbols",r.mode=Br;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;y<3;){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}r.lens[Ft[r.have++]]=7&E,E>>>=3,y-=3}for(;r.have<19;)r.lens[Ft[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Ne={bits:r.lenbits},_e=d0(0,r.lens,0,19,r.lencode,0,r.work,Ne),r.lenbits=Ne.bits,_e){i.msg="invalid code lengths set",r.mode=Br;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;Se=r.lencode[E&(1<<r.lenbits)-1],z=Se>>>24,X=Se>>>16&255,ie=65535&Se,!(z<=y);){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}if(ie<16)E>>>=z,y-=z,r.lens[r.have++]=ie;else{if(ie===16){for(vt=z+2;y<vt;){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}if(E>>>=z,y-=z,r.have===0){i.msg="invalid bit length repeat",r.mode=Br;break}ge=r.lens[r.have-1],k=3+(3&E),E>>>=2,y-=2}else if(ie===17){for(vt=z+3;y<vt;){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}E>>>=z,y-=z,ge=0,k=3+(7&E),E>>>=3,y-=3}else{for(vt=z+7;y<vt;){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}E>>>=z,y-=z,ge=0,k=11+(127&E),E>>>=7,y-=7}if(r.have+k>r.nlen+r.ndist){i.msg="invalid bit length repeat",r.mode=Br;break}for(;k--;)r.lens[r.have++]=ge}}if(r.mode===Br)break;if(r.lens[256]===0){i.msg="invalid code -- missing end-of-block",r.mode=Br;break}if(r.lenbits=9,Ne={bits:r.lenbits},_e=d0(1,r.lens,0,r.nlen,r.lencode,0,r.work,Ne),r.lenbits=Ne.bits,_e){i.msg="invalid literal/lengths set",r.mode=Br;break}if(r.distbits=6,r.distcode=r.distdyn,Ne={bits:r.distbits},_e=d0(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Ne),r.distbits=Ne.bits,_e){i.msg="invalid distances set",r.mode=Br;break}if(r.mode=Uv,t===Lv)break e;case Uv:r.mode=Bv;case Bv:if(f>=6&&v>=258){i.next_out=h,i.avail_out=v,i.next_in=u,i.avail_in=f,r.hold=E,r.bits=y,_te(i,I),h=i.next_out,l=i.output,v=i.avail_out,u=i.next_in,a=i.input,f=i.avail_in,E=r.hold,y=r.bits,r.mode===Yc&&(r.back=-1);break}for(r.back=0;Se=r.lencode[E&(1<<r.lenbits)-1],z=Se>>>24,X=Se>>>16&255,ie=65535&Se,!(z<=y);){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}if(X&&!(240&X)){for(oe=z,Re=X,Ce=ie;Se=r.lencode[Ce+((E&(1<<oe+Re)-1)>>oe)],z=Se>>>24,X=Se>>>16&255,ie=65535&Se,!(oe+z<=y);){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}E>>>=oe,y-=oe,r.back+=oe}if(E>>>=z,y-=z,r.back+=z,r.length=ie,X===0){r.mode=16205;break}if(32&X){r.back=-1,r.mode=Yc;break}if(64&X){i.msg="invalid literal/length code",r.mode=Br;break}r.extra=15&X,r.mode=16201;case 16201:if(r.extra){for(vt=r.extra;y<vt;){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}r.length+=E&(1<<r.extra)-1,E>>>=r.extra,y-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;Se=r.distcode[E&(1<<r.distbits)-1],z=Se>>>24,X=Se>>>16&255,ie=65535&Se,!(z<=y);){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}if(!(240&X)){for(oe=z,Re=X,Ce=ie;Se=r.distcode[Ce+((E&(1<<oe+Re)-1)>>oe)],z=Se>>>24,X=Se>>>16&255,ie=65535&Se,!(oe+z<=y);){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}E>>>=oe,y-=oe,r.back+=oe}if(E>>>=z,y-=z,r.back+=z,64&X){i.msg="invalid distance code",r.mode=Br;break}r.offset=ie,r.extra=15&X,r.mode=16203;case 16203:if(r.extra){for(vt=r.extra;y<vt;){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}r.offset+=E&(1<<r.extra)-1,E>>>=r.extra,y-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){i.msg="invalid distance too far back",r.mode=Br;break}r.mode=16204;case 16204:if(v===0)break e;if(k=I-v,r.offset>k){if(k=r.offset-k,k>r.whave&&r.sane){i.msg="invalid distance too far back",r.mode=Br;break}k>r.wnext?(k-=r.wnext,W=r.wsize-k):W=r.wnext-k,k>r.length&&(k=r.length),$=r.window}else $=l,W=h-r.offset,k=r.length;k>v&&(k=v),v-=k,r.length-=k;do l[h++]=$[W++];while(--k);r.length===0&&(r.mode=Bv);break;case 16205:if(v===0)break e;l[h++]=r.length,v--,r.mode=Bv;break;case VT:if(r.wrap){for(;y<32;){if(f===0)break e;f--,E|=a[u++]<<y,y+=8}if(I-=v,i.total_out+=I,r.total+=I,4&r.wrap&&I&&(i.adler=r.check=r.flags?Wi(r.check,l,I,h-I):n0(r.check,l,I,h-I)),I=v,4&r.wrap&&(r.flags?E:kM(E))!==r.check){i.msg="incorrect data check",r.mode=Br;break}E=0,y=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;y<32;){if(f===0)break e;f--,E+=a[u++]<<y,y+=8}if(4&r.wrap&&E!==(4294967295&r.total)){i.msg="incorrect length check",r.mode=Br;break}E=0,y=0}r.mode=16208;case 16208:_e=Rte;break e;case Br:_e=NM;break e;case 16210:return PM;default:return ss}return i.next_out=h,i.avail_out=v,i.next_in=u,i.avail_in=f,r.hold=E,r.bits=y,(r.wsize||I!==i.avail_out&&r.mode<Br&&(r.mode<VT||t!==xM))&&jM(i,i.output,i.next_out,I-i.avail_out),C-=i.avail_in,I-=i.avail_out,i.total_in+=C,i.total_out+=I,r.total+=I,4&r.wrap&&I&&(i.adler=r.check=r.flags?Wi(r.check,l,I,i.next_out-I):n0(r.check,l,I,i.next_out-I)),i.data_type=r.bits+(r.last?64:0)+(r.mode===Yc?128:0)+(r.mode===Uv||r.mode===jT?256:0),(C===0&&I===0||t===xM)&&_e===dd&&(_e=Ite),_e},Xc={inflateReset:MM,inflateReset2:FM,inflateResetKeep:LM,inflateInit:i=>UM(i,15),inflateInit2:UM,inflate:xte,inflateEnd:i=>{if(hd(i))return ss;let t=i.state;return t.window&&(t.window=null),i.state=null,dd},inflateGetHeader:(i,t)=>{if(hd(i))return ss;const r=i.state;return 2&r.wrap?(r.head=t,t.done=!1,dd):ss},inflateSetDictionary:(i,t)=>{const r=t.length;let a,l,u;return hd(i)?ss:(a=i.state,a.wrap!==0&&a.mode!==Fv?ss:a.mode===Fv&&(l=1,l=n0(l,t,r,0),l!==a.check)?NM:(u=jM(i,t,r,r),u?(a.mode=16210,PM):(a.havedict=1,dd)))},inflateInfo:"pako inflate (from Nodeca project)"},Nte=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const VM=Object.prototype.toString,{Z_NO_FLUSH:Pte,Z_FINISH:Dte,Z_OK:h0,Z_STREAM_END:WT,Z_NEED_DICT:zT,Z_STREAM_ERROR:kte,Z_DATA_ERROR:$M,Z_MEM_ERROR:Lte}=Vh;function p0(i){this.options=Nv.assign({chunkSize:65536,windowBits:15,to:""},i||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||i&&i.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new AM,this.strm.avail_out=0;let r=Xc.inflateInit2(this.strm,t.windowBits);if(r!==h0)throw new Error(sd[r]);if(this.header=new Nte,Xc.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=l0.string2buf(t.dictionary):VM.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Xc.inflateSetDictionary(this.strm,t.dictionary),r!==h0)))throw new Error(sd[r])}function GT(i,t){const r=new p0(t);if(r.push(i),r.err)throw r.msg||sd[r.err];return r.result}p0.prototype.push=function(i,t){const r=this.strm,a=this.options.chunkSize,l=this.options.dictionary;let u,h,f;if(this.ended)return!1;for(h=t===~~t?t:t===!0?Dte:Pte,VM.call(i)==="[object ArrayBuffer]"?r.input=new Uint8Array(i):r.input=i,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),u=Xc.inflate(r,h),u===zT&&l&&(u=Xc.inflateSetDictionary(r,l),u===h0?u=Xc.inflate(r,h):u===$M&&(u=zT));r.avail_in>0&&u===WT&&r.state.wrap>0&&i[r.next_in]!==0;)Xc.inflateReset(r),u=Xc.inflate(r,h);switch(u){case kte:case $M:case zT:case Lte:return this.onEnd(u),this.ended=!0,!1}if(f=r.avail_out,r.next_out&&(r.avail_out===0||u===WT))if(this.options.to==="string"){let v=l0.utf8border(r.output,r.next_out),E=r.next_out-v,y=l0.buf2string(r.output,v);r.next_out=E,r.avail_out=a-E,E&&r.output.set(r.output.subarray(v,v+E),0),this.onData(y)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(u!==h0||f!==0){if(u===WT)return u=Xc.inflateEnd(this.strm),this.onEnd(u),this.ended=!0,!0;if(r.avail_in===0)break}}return!0},p0.prototype.onData=function(i){this.chunks.push(i)},p0.prototype.onEnd=function(i){i===h0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Nv.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};var Mte={Inflate:p0,inflate:GT,inflateRaw:function(i,t){return(t=t||{}).raw=!0,GT(i,t)},ungzip:GT,constants:Vh};const{Deflate:ewe,deflate:Fte,deflateRaw:twe,gzip:nwe}=Ete,{Inflate:rwe,inflate:Ute,inflateRaw:iwe,ungzip:owe}=Mte;var KT,Bte=Fte,jte=Ute;(function(i){i[i.ONE_BYTE=0]="ONE_BYTE",i[i.TWO_BYTE=1]="TWO_BYTE"})(KT||(KT={}));class Vte{constructor(){w(this,"_sequence",0),w(this,"_startTime",Date.now()),w(this,"isUseOneByte",!0)}get startTime(){const t=Date.now()-this._startTime;return t<Math.pow(2,16)?t:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(t){const r={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:t};if(t.byteLength>128){const f=new Uint8Array(4);f.set([1,0,0,0]);const v={id:0,length:4,data:f.buffer},E={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[v]};r.commonPacketHeader.extension=1,r.extension=E,r.payload=this.compress(t),r.commonPacketHeader.length=8+(r.extension.length+2)+r.payload.byteLength}else r.commonPacketHeader.length=8+r.payload.byteLength;const a=new ArrayBuffer(r.commonPacketHeader.length),l=new Uint8Array(a),u=new DataView(a);let h=0;if(u.setUint16(h,r.commonPacketHeader.extension<<15|r.commonPacketHeader.reserved<<14|r.commonPacketHeader.length,!0),h+=2,u.setUint32(h,r.commonPacketHeader.sequence,!0),h+=4,u.setUint16(h,r.commonStreamHeader,!0),h+=2,r.extension){const f=this.serializeExtension(r.extension);l.set(new Uint8Array(f),h),h+=f.byteLength}if(l.set(new Uint8Array(r.payload),h),h+=r.payload.byteLength,h!==r.commonPacketHeader.length)throw Error("serialize error!");return a}deserialize(t){if(t.byteLength<4)return new ArrayBuffer(0);const r=new DataView(t);let a=0;const l=r.getUint16(a,!0);a+=2;const u=(32768&l)>>15;r.getUint16(a+2,!0),r.getUint16(a,!0);let h,f;if(a+=4,r.getUint16(a,!0),a+=2,u){f=this.deserializeExtension(t.slice(a)),a+=2+f.length,h=t.slice(a);let v=!1;if(f.datas.length>0){const E=f.datas.find(y=>y.id===0);E&&(v=(1&new DataView(E.data).getUint32(0,!0))==1)}h=v?this.decompress(h):h}else h=t.slice(8);return h}serializeExtension(t){const{profile:r,length:a,datas:l}=t,u=new ArrayBuffer(a+2),h=new Uint8Array(u),f=new DataView(u);let v=0;if(f.setUint8(v++,r),f.setUint8(v++,a),l.forEach(E=>{r?(f.setUint8(v++,E.id),f.setUint8(v++,E.length),h.set(new Uint8Array(E.data),v),v+=E.data.byteLength):(f.setUint8(v++,E.id|E.length<<4),h.set(new Uint8Array(E.data),v),v+=E.data.byteLength)}),v!==a+2)throw Error("serialize extension error, is ".concat(v,"!==").concat(a+2));return u}deserializeExtension(t){const r=new DataView(t);let a=0;const l=r.getUint8(a);a++;const u=r.getUint8(a);a++;const h=l===KT.TWO_BYTE,f=[],v=new DataView(t,2);let E=0;for(;E<u;){let y=0,C=0,I=new ArrayBuffer(0);h?(y=v.getUint8(E),E++,C=v.getUint8(E),E++):(y=15&v.getUint8(E),C=v.getUint8(E)>>4,E++),C>0&&(I=v.buffer.slice(E+2,E+2+C),E+=I.byteLength),f.push({id:y,length:C,data:I})}if(E!==u)throw Error("parse error");return{profile:l,length:u,datas:f}}decompress(t){return jte(new Uint8Array(t))}compress(t){return Bte(new Uint8Array(t))}}class HM extends An{constructor(t,r){super(),w(this,"_version",1),w(this,"_type",3),w(this,"_config",void 0),w(this,"_originDataChannel",void 0),w(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),w(this,"_dataStreamPacketHandler",void 0),w(this,"_datachannelEventMap",new Map),this._config=t,r&&(this._originDataChannel=r,this._bandDataChannelEvents(r)),this._initPacketHeader(),this._dataStreamPacketHandler=new Vte}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return Z("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var t,r;return(t=(r=this._originDataChannel)===null||r===void 0?void 0:r.readyState)!==null&&t!==void 0?t:"connecting"}get _originDataChannelId(){var t,r;return(t=(r=this._originDataChannel)===null||r===void 0?void 0:r.id)!==null&&t!==void 0?t:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new me((t,r)=>{if(this._originDataChannel){this._originDataChannel.readyState==="open"&&t();const a=setTimeout(()=>{var l;r(new be(G.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat((l=this._originDataChannel)===null||l===void 0?void 0:l.id)))},1e4);this._originDataChannel.onopen=()=>{clearTimeout(a),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),t()},this._originDataChannel.onerror=()=>{throw clearTimeout(a),new be(G.DATACHANNEL_CONNECTION_TIMEOUT)}}else r(new be(G.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})}_updateOriginDataChannel(t){this._originDataChannel=t,this._bandDataChannelEvents(t)}_initPacketHeader(){const t=new DataView(this._dataStreamPacketHeader);t.setUint16(0,this._version),t.setUint8(2,this._type),t.setUint8(3,this._config.id)}_bandDataChannelEvents(t){this._unbindDataChannelEvents(t),[Mh.OPEN,Mh.CLOSE,Mh.ERROR].forEach(r=>{const a=()=>{this.emit(r)};this._datachannelEventMap.set(r,a),t.addEventListener(r,a)})}_unbindDataChannelEvents(t){Array.from(this._datachannelEventMap.entries()).forEach(r=>{let[a,l]=r;t.removeEventListener(a,l)}),this._datachannelEventMap.clear()}}class $te extends HM{constructor(t){super(t),w(this,"_messageListener",void 0),this._messageListener=r=>{if(r.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const a=r.data.slice(0,this._dataStreamPacketHeader.byteLength);if(new DataView(a).getUint8(3)!==this.id)return;let l=r.data.slice(this._dataStreamPacketHeader.byteLength);l=this._dataStreamPacketHandler.deserialize(l),this.emit(Mh.MESSAGE,l)}}_updateOriginDataChannel(t){super._updateOriginDataChannel(t),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class WM extends HM{send(t){if(this._originDataChannel){let r=t;r=this._dataStreamPacketHandler.serialize(t);const a=new Uint8Array(this._dataStreamPacketHeader.byteLength+r.byteLength);a.set(new Uint8Array(this._dataStreamPacketHeader),0),a.set(new Uint8Array(r),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(a.buffer)}}}class Hte extends An{constructor(){super(...arguments),w(this,"resultStorage",new Map)}setLocalAudioStats(t,r,a){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",t,this.checkAudioInputLevel(a,r)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",t,this.checkSendAudioBitrate(a,r))}setLocalVideoStats(t,r,a){this.record("SEND_VIDEO_BITRATE_TOO_LOW",t,this.checkSendVideoBitrate(a,r)),this.record("FRAMERATE_INPUT_TOO_LOW",t,this.checkFramerateInput(a,r)),this.record("FRAMERATE_SENT_TOO_LOW",t,this.checkFramerateSent(a))}setRemoteAudioStats(t,r){const a=t.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",a,this.checkAudioOutputLevel(r))}setRemoteVideoStats(t,r){const a=t.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",a,this.checkVideoDecode(r))}record(t,r,a){if(Z("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(t)||this.resultStorage.set(t,{result:[],isPrevNormal:!0});const l=this.resultStorage.get(t);if(l&&(l.result.push(a),l.result.length>=5)){var u;const h=Ke(u=l.result).call(u,!0);l.isPrevNormal&&!h&&this.emit("exception",zM[t],t,r),!l.isPrevNormal&&h&&this.emit("exception",zM[t]+2e3,t+"_RECOVER",r),l.isPrevNormal=h,l.result=[]}}checkAudioOutputLevel(t){return!(t.receiveBitrate>0&&t.receiveLevel===0)}checkAudioInputLevel(t,r){return r instanceof cr&&!r.isActive||!!r.muted||t.sendVolumeLevel!==0}checkFramerateInput(t,r){let a=null;r._encoderConfig&&r._encoderConfig.frameRate&&(a=ca(r._encoderConfig.frameRate));const l=t.captureFrameRate;return!a||!l||!(a>10&&l<5||a<10&&a>=5&&l<=1)}checkFramerateSent(t){return!(t.captureFrameRate&&t.sendFrameRate&&t.captureFrameRate>5&&t.sendFrameRate<=1)}checkSendVideoBitrate(t,r){return!!r.muted||t.sendBitrate!==0}checkSendAudioBitrate(t,r){return r instanceof cr&&!r.isActive||!!r.muted||t.sendBitrate!==0}checkVideoDecode(t){return t.receiveBitrate===0||t.decodeFrameRate!==0}}const zM={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},fi=new class{markSubscribeStart(i,t){performance.mark("agora-web-sdk/".concat(i,"/subscribe-").concat(t))}markPublishStart(i,t){performance.mark("agora-web-sdk/".concat(i,"/publish-").concat(t))}measureFromSubscribeStart(i,t){const r=performance.getEntriesByName("agora-web-sdk/".concat(i,"/subscribe-").concat(t));if(r.length>0){const a=r[r.length-1];return Math.round(performance.now()-a.startTime)}return 0}measureFromPublishStart(i,t){const r=performance.getEntriesByName("agora-web-sdk/".concat(i,"/publish-").concat(t));if(r.length>0){const a=r[r.length-1];return Math.round(performance.now()-a.startTime)}return 0}};function GM(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function pd(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GM(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):GM(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}class zh{constructor(t){w(this,"store",void 0),w(this,"onStatsException",void 0),w(this,"onUploadPublishDuration",void 0),w(this,"onStatsChanged",void 0),w(this,"localStats",new Map),w(this,"remoteStats",new Map),w(this,"updateStatsInterval",void 0),w(this,"trafficStats",void 0),w(this,"trafficStatsPeerList",[]),w(this,"uplinkStats",void 0),w(this,"exceptionMonitor",void 0),w(this,"p2pChannel",void 0),w(this,"scalabilityMode",Qb.L1T1),w(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=t,this.updateStatsInterval=window.setInterval(this.updateStats,1e3),this.exceptionMonitor=new Hte,this.exceptionMonitor.on("exception",(r,a,l)=>{this.onStatsException&&this.onStatsException(r,a,l)})}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(we.LocalAudioTrack)||pd({},hT)}getLocalVideoTrackStats(){return this.localStats.get(we.LocalVideoTrack)||pd({},pT)}getRemoteAudioTrackStats(t){const r=(u,h)=>{if(!this.trafficStats)return h;const f=this.trafficStats.peer_delay.find(v=>v.peer_uid===u);return f&&(h.publishDuration=f.B_ppad+(Date.now()-this.trafficStats.timestamp)),h},a={};if(t){var l;const u=(l=this.remoteStats.get(t))===null||l===void 0?void 0:l.audioStats;u&&(a[t]=r(t,u))}else Array.from(this.remoteStats.entries()).forEach(u=>{let[h,{audioStats:f}]=u;f&&(a[h]=r(h,f))});return a}getRemoteNetworkQualityStats(t){const r={};if(t){var a;const l=(a=this.remoteStats.get(t))===null||a===void 0?void 0:a.networkStats;l&&(r[t]=l)}else Array.from(this.remoteStats.entries()).forEach(l=>{let[u,{networkStats:h}]=l;h&&(r[u]=h)});return r}getRemoteVideoTrackStats(t){const r=(u,h)=>{if(!this.trafficStats)return h;const f=this.trafficStats.peer_delay.find(v=>v.peer_uid===u);return f&&(h.publishDuration=f.B_ppvd+(Date.now()-this.trafficStats.timestamp)),h},a={};if(t){var l;const u=(l=this.remoteStats.get(t))===null||l===void 0?void 0:l.videoStats;u&&(a[t]=r(t,u))}else Array.from(this.remoteStats.entries()).forEach(u=>{let[h,{videoStats:f}]=u;f&&(a[h]=r(h,f))});return a}getRTCStats(){let t=0,r=0,a=0,l=0;const u=this.localStats.get(we.LocalAudioTrack);u&&(t+=u.sendBytes,r+=u.sendBitrate);const h=this.localStats.get(we.LocalVideoTrack);h&&(t+=h.sendBytes,r+=h.sendBitrate);const f=this.localStats.get(we.LocalVideoLowTrack);f&&(t+=f.sendBytes,r+=f.sendBitrate),this.remoteStats.forEach(E=>{let{audioStats:y,videoStats:C}=E;y&&(a+=y.receiveBytes,l+=y.receiveBitrate),C&&(a+=C.receiveBytes,l+=C.receiveBitrate)});let v=1;return this.trafficStats&&(v+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:v,SendBitrate:r,SendBytes:t,RecvBytes:a,RecvBitrate:l,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(t){this.localStats.set(t,void 0)}removeLocalStats(t){t?this.localStats.delete(t):this.localStats.clear()}addRemoteStats(t){this.remoteStats.set(t,{})}removeRemoteStats(t){t?this.remoteStats.delete(t):this.remoteStats.clear()}addP2PChannel(t){this.p2pChannel=t}updateTrafficStats(t){t.peer_delay=t.peer_delay.filter(r=>r.B_ppad!==void 0||r.B_ppvd!==void 0),t.peer_delay.filter(r=>this.trafficStatsPeerList.indexOf(r.peer_uid)===-1).forEach(r=>{var a;const l=(a=this.p2pChannel)===null||a===void 0?void 0:a.getRemoteMedia(r.peer_uid),u=l!=null&&l.videoSSRC?fi.measureFromSubscribeStart(this.store.clientId,l.videoSSRC):0,h=l!=null&&l.audioSSRC?fi.measureFromSubscribeStart(this.store.clientId,l.audioSSRC):0;r.B_ppad!==void 0&&r.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(r.peer_uid,r.B_ppad,r.B_ppvd,u>h?u:h),this.trafficStatsPeerList.push(r.peer_uid))}),this.trafficStats=t}updateUplinkStats(t){this.uplinkStats&&this.uplinkStats.B_fir!==t.B_fir&&L.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(t.B_fir)),this.uplinkStats=t}static isRemoteVideoFreeze(t,r,a){if(!t)return!1;const l=!!a&&r.framesDecodeFreezeTime>a.framesDecodeFreezeTime,u=!a||r.framesDecodeCount>a.framesDecodeCount;return l||!u}static isRemoteAudioFreeze(t){return!!t&&t._isFreeze()}isLocalVideoFreeze(t){return!(!t.inputFrame||!t.sentFrame)&&t.inputFrame.frameRate>5&&t.sentFrame.frameRate<3}updateLocalStats(t){Array.from(this.localStats.entries()).forEach(r=>{let[a,l]=r;switch(a){case we.LocalVideoTrack:case we.LocalVideoLowTrack:{const h=l,f=pd({},pT),v=t.getStats(),E=t.getLocalMedia(a);if(v){const y=v.videoSend.find(C=>C.ssrc===(E==null?void 0:E.ssrcs[0].ssrcId));if(y){const C=t.getLocalVideoSize(),I=t.getEncoderConfig(we.LocalVideoTrack);y.codec!=="H264"&&y.codec!=="H265"&&y.codec!=="VP8"&&y.codec!=="VP9"&&y.codec!=="AV1X"&&y.codec!=="AV1"||(f.codecType=y.codec),f.sendBytes=y.bytes,f.sendBitrate=h?8*Math.max(0,f.sendBytes-h.sendBytes):0,y.inputFrame?(f.captureFrameRate=y.inputFrame.frameRate,f.captureResolutionHeight=y.inputFrame.height,f.captureResolutionWidth=y.inputFrame.width):C&&(f.captureResolutionWidth=C.width,f.captureResolutionHeight=C.height),y.sentFrame?(f.sendFrameRate=y.sentFrame.frameRate,f.sendResolutionHeight=y.sentFrame.height,f.sendResolutionWidth=y.sentFrame.width):C&&(f.sendResolutionWidth=C.width,f.sendResolutionHeight=C.height),y.avgEncodeMs&&(f.encodeDelay=y.avgEncodeMs),I&&I.bitrateMax&&(f.targetSendBitrate=1e3*I.bitrateMax),f.sendPackets=y.packets,f.sendPacketsLost=y.packetsLost,f.sendJitterMs=y.jitterMs,f.sendRttMs=y.rttMs,f.totalDuration=h?h.totalDuration+1:1,f.totalFreezeTime=h?h.totalFreezeTime:0,this.isLocalVideoFreeze(y)&&(f.totalFreezeTime+=1),y.scalabilityMode&&this.scalabilityMode!==y.scalabilityMode&&(L.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(y.scalabilityMode)),this.scalabilityMode=y.scalabilityMode)}this.trafficStats&&(f.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var u;this.localStats.set(a,f),((h==null?void 0:h.sendResolutionWidth)!==f.sendResolutionWidth||(h==null?void 0:h.sendResolutionHeight)!==f.sendResolutionHeight)&&((u=this.onStatsChanged)===null||u===void 0||u.call(this,"resolution",{width:f.sendResolutionWidth,height:f.sendResolutionHeight})),f&&E&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,E.track,f);break}case we.LocalAudioTrack:{const h=l,f=pd({},hT),v=t.getStats(),E=t.getLocalMedia(a);if(v){const y=v.audioSend.find(C=>C.ssrc===(E==null?void 0:E.ssrcs[0].ssrcId));if(y){if(y.codec!=="opus"&&y.codec!=="aac"&&y.codec!=="PCMU"&&y.codec!=="PCMA"&&y.codec!=="G722"||(f.codecType=y.codec),y.inputLevel)f.sendVolumeLevel=Math.round(32767*y.inputLevel);else{const C=t.getLocalAudioVolume();C&&(f.sendVolumeLevel=Math.round(32767*C))}f.sendBytes=y.bytes,f.sendPackets=y.packets,f.sendPacketsLost=y.packetsLost,f.sendJitterMs=y.jitterMs,f.sendRttMs=y.rttMs,f.sendBitrate=h?8*Math.max(0,f.sendBytes-h.sendBytes):0}}this.trafficStats&&(f.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(we.LocalAudioTrack,f),f&&E&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,E.track,f);break}}})}updateRemoteStats(t){Array.from(this.remoteStats.entries()).forEach(r=>{let[a,{videoStats:l,audioStats:u,videoPcStats:h}]=r;const f=u,v=l,E=h,y=pd({},bL),C=pd({},TL),I=pd({},Iee),{audioTrack:k,videoTrack:W,audioSSRC:$,videoSSRC:z}=t.getRemoteMedia(a),X=t.getStats(),ie=X==null?void 0:X.audioRecv.find(Ce=>Ce.ssrc===$),oe=X==null?void 0:X.videoRecv.find(Ce=>Ce.ssrc===z),Re=this.trafficStats&&this.trafficStats.peer_delay.find(Ce=>Ce.peer_uid===a);if(ie&&(ie.codec!=="opus"&&ie.codec!=="aac"&&ie.codec!=="PCMU"&&ie.codec!=="PCMA"&&ie.codec!=="G722"||(y.codecType=ie.codec),ie.outputLevel?y.receiveLevel=Math.round(32767*ie.outputLevel):k&&(y.receiveLevel=Math.round(32767*k.getVolumeLevel())),y.receiveBytes=ie.bytes,y.receivePackets=ie.packets,y.receivePacketsLost=ie.packetsLost,y.packetLossRate=y.receivePacketsLost/(y.receivePackets+y.receivePacketsLost),y.receiveBitrate=f?8*Math.max(0,y.receiveBytes-f.receiveBytes):0,y.totalDuration=f?f.totalDuration+1:1,y.totalFreezeTime=f?f.totalFreezeTime:0,y.freezeRate=y.totalFreezeTime/y.totalDuration,y.receiveDelay=ie.jitterBufferMs,y.totalDuration>10&&zh.isRemoteAudioFreeze(k)&&(y.totalFreezeTime+=1)),oe){oe.codec!=="H264"&&oe.codec!=="H265"&&oe.codec!=="VP8"&&oe.codec!=="VP9"&&oe.codec!=="AV1X"&&oe.codec!=="AV1"||(C.codecType=oe.codec),C.receiveBytes=oe.bytes,C.receiveBitrate=v?8*Math.max(0,C.receiveBytes-v.receiveBytes):0,C.decodeFrameRate=oe.decodeFrameRate<0?0:oe.decodeFrameRate,C.renderFrameRate=oe.decodeFrameRate<0?0:oe.decodeFrameRate,oe.outputFrame&&(C.renderFrameRate=oe.outputFrame.frameRate),oe.receivedFrame?(C.receiveFrameRate=oe.receivedFrame.frameRate,C.receiveResolutionHeight=oe.receivedFrame.height,C.receiveResolutionWidth=oe.receivedFrame.width):W&&(C.receiveResolutionHeight=W._videoHeight||0,C.receiveResolutionWidth=W._videoWidth||0),oe.framesRateFirefox!==void 0&&(C.receiveFrameRate=Math.round(oe.framesRateFirefox)),C.receivePackets=oe.packets,C.receivePacketsLost=oe.packetsLost,C.packetLossRate=C.receivePacketsLost/(C.receivePackets+C.receivePacketsLost),C.totalDuration=v?v.totalDuration+1:1,C.totalFreezeTime=v?v.totalFreezeTime:0,C.receiveDelay=oe.jitterBufferMs||0;const Ce=!!z&&t.getRemoteVideoIsReady(z);W&&Ce&&zh.isRemoteVideoFreeze(W,oe,E)&&(C.totalFreezeTime+=1),C.freezeRate=C.totalFreezeTime/C.totalDuration}Re&&(y.end2EndDelay=Re.B_ad,C.end2EndDelay=Re.B_vd,y.transportDelay=Re.B_ed,C.transportDelay=Re.B_ed,y.currentPacketLossRate=Re.B_ealr4/100,C.currentPacketLossRate=Re.B_evlr4/100,I.uplinkNetworkQuality=Re.B_punq?Re.B_punq:0,I.downlinkNetworkQuality=Re.B_pdnq?Re.B_pdnq:0),this.remoteStats.set(a,{audioStats:y,videoStats:C,videoPcStats:oe,networkStats:I}),k&&this.exceptionMonitor.setRemoteAudioStats(k,y),W&&this.exceptionMonitor.setRemoteVideoStats(W,C)})}}function KM(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function jv(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KM(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):KM(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}function f0(i){return i.match(/^[\.\:\d]+$/)?"".concat(i.replace(/[^\d]/g,"-"),".").concat(Z("TURN_DOMAIN")):(L.info("Cannot recognized as IP address ".concat(i,". Used As Host instead")),i)}function qM(i,t){var r,a;const l=Z("GATEWAY_DOMAINS");let u=l[1]&&t.indexOf(l[1])!==-1?1:0;i.addresses=i.addresses||[];const h=i.addresses.map(v=>v.domain_prefix?{address:"".concat(v.domain_prefix,".").concat(l[u++%l.length],":").concat(v.port)}:v.ip.match(/^[\.\:\d]+$/)?{ip:v.ip,port:v.port,address:"".concat(v.ip.replace(/[^\d]/g,"-"),".").concat(l[u++%l.length],":").concat(v.port)}:(L.info("Cannot recognized as IP address ".concat(v.ip,". Used As Host instead")),{ip:v.ip,port:v.port,address:"".concat(v.ip,":").concat(v.port)}));if((r=i.detail)!==null&&r!==void 0&&r[18]&&typeof((a=i.detail)===null||a===void 0?void 0:a[18])=="string"){const v=i.detail[18],E=v==null?void 0:v.split(";");for(let y=0;y<E.length;y++){var f;const C=cT(f=E[y]).call(f);h[y]&&C&&(h[y].ip6=C)}}return{gatewayAddrs:h,uid:i.uid,cid:i.cid,cert:i.cert,vid:i.detail&&i.detail[8],uni_lbs_ip:i.detail&&i.detail[1],res:i,csIp:i.detail&&i.detail[502]}}function ca(i){return typeof i=="number"?i:i.exact||i.ideal||i.max||i.min||0}function Vv(i){const t=i._encoderConfig;if(!t)return{};const r={resolution:t.width&&t.height?"".concat(ca(t.width),"x").concat(ca(t.height)):void 0,maxVideoBW:t.bitrateMax,minVideoBW:t.bitrateMin};return typeof t.frameRate=="number"?(r.maxFrameRate=t.frameRate,r.minFrameRate=t.frameRate):t.frameRate&&(r.maxFrameRate=t.frameRate.max||t.frameRate.ideal||t.frameRate.exact||t.frameRate.min,r.minFrameRate=t.frameRate.min||t.frameRate.ideal||t.frameRate.exact||t.frameRate.max),r}function YM(i){const t={connectionType:0,googRtt:i.rtt};switch(i.selectedCandidatePair.localCandidate.candidateType){case"relay":{const r=i.selectedCandidatePair.localCandidate.relayProtocol;r==="udp"&&(t.connectionType=1),r==="tcp"&&(t.connectionType=3),r==="tls"&&(t.connectionType=4);break}case"srflx":t.connectionType=2}return t}function XM(i){return i>=0&&i<.17?1:i>=.17&&i<.36?2:i>=.36&&i<.59?3:i>=.59&&i<=1?4:i>1?5:0}function qT(i,t){let r,a,l;switch(t){case Fr.CHOOSE_SERVER:a=4096,l="choose server";break;case Fr.CLOUD_PROXY:a=1048576,l="proxy";break;case Fr.CLOUD_PROXY_5:a=4194304,l="proxy5";break;case Fr.CLOUD_PROXY_FALLBACK:a=4194310,l="proxy fallback";break;default:throw new ue(G.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:i.detail&&i.detail[502],retry:!1})}if(i.response_body.forEach(u=>{u.buffer&&u.buffer.flag===a&&(r={code:u.buffer.code,addresses:(u.buffer.edges_services||[]).map(h=>jv(jv({},h),{},{ticket:u.buffer.cert})),server_ts:i.enter_ts,uid:u.buffer.uid,cid:u.buffer.cid,cname:u.buffer.cname,detail:jv(jv({},u.buffer.detail),i.detail),flag:u.buffer.flag,opid:i.opid,cert:u.buffer.cert})}),!r)throw new ue(G.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(l," from multi unilbs response"),{csIp:i.detail&&i.detail[502]});return r}async function Wte(i,t){return await me.all(i.addresses.map(async r=>({address:f0(r.ip),tcpport:r.port,udpport:r.port,username:t&&Z("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?t.toString():Qo.username,password:t&&Z("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await QQ(t.toString()):Qo.password})))}function YT(i,t){const r=t._videoHeight||t.getMediaStreamTrack(!0).getSettings().height;return r?Math.max(r/ca(i.height),1):(L.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function Jl(i){let{candidateType:t,relayProtocol:r,type:a,address:l,port:u,protocol:h}=i;return a==="local-candidate"?{candidateType:t,relayProtocol:r,protocol:h}:{candidateType:t,relayProtocol:r,address:l,port:u,protocol:h}}function JM(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}class zte extends An{get url(){return this._url?this._url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(t){var r;Ke(r=["tryNext","recover"]).call(r,t)&&this.resetReconnectCount(t),this._reconnectMode=t}get state(){return this._state}set state(t){t!==this._state&&(this._state=t,this._state==="reconnecting"?this.emit(qn.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(qn.CONNECTED):this._state==="closed"?this.emit(qn.CLOSED):this._state==="failed"&&this.emit(qn.FAILED))}constructor(t,r,a,l){super(),w(this,"connectionID",0),w(this,"currentURLIndex",0),w(this,"reconnectReason",void 0),w(this,"_reconnectMode","tryNext"),w(this,"_name",void 0),w(this,"_state","closed"),w(this,"_retryConfig",void 0),w(this,"_reconnectCount",0),w(this,"_forceCloseTimeout",5e3),w(this,"_onlineReconnectListener",void 0),w(this,"_closeEstablishingTransmitter",()=>{}),w(this,"_store",void 0),w(this,"_joinChannelServiceRecordIndex",void 0),w(this,"_useCompress",void 0),w(this,"_inflateLength",0),w(this,"_deflateLength",0),this._store=l,this._name=t,this._retryConfig=function(u){for(var h=1;h<arguments.length;h++){var f=arguments[h]!=null?arguments[h]:{};h%2?JM(Object(f),!0).forEach(function(v){w(u,v,f[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(f)):JM(Object(f)).forEach(function(v){Object.defineProperty(u,v,Object.getOwnPropertyDescriptor(f,v))})}return u}({},r),this._useCompress=a}resetReconnectCount(t){L.debug("".concat(this._name," reset reconnect count, reason: ").concat(t)),this._reconnectCount=0}close(t,r){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this._reconnectInterrupter&&this._reconnectInterrupter(),this._transmitter){this._transmitter.onclose=null,this._transmitter.onopen=null,this._transmitter.onmessage=null;const a=this._transmitter;r?setTimeout(()=>a.close(),500):a.close(),this._transmitter=void 0}this.state=t?"failed":"closed",this._closeEstablishingTransmitter&&this._closeEstablishingTransmitter()}reconnect(t,r){if(!this._transmitter)return void L.warning("[".concat(this._name,"] can not reconnect, no websocket"));var a;t!==void 0&&(this.reconnectMode=t),L.debug("[".concat(this._name,"] reconnect is triggered initiative")),typeof this._joinChannelServiceRecordIndex=="number"&&((a=this._store)===null||a===void 0||a.recordJoinChannelService({status:"error",errors:[new Error(r)]},this._joinChannelServiceRecordIndex));const l=this._transmitter.onclose;this._transmitter.onclose=null,this._transmitter.close(),l&&l.bind(this._transmitter)({code:9999,reason:r})}getInflateData(){const t=this._inflateLength,r=this._deflateLength;return this.clearInflateData(),{inflateLength:t,deflateLength:r}}setInflateData(t){this._deflateLength=this._deflateLength+t.originLength,this._inflateLength=this._inflateLength+t.compressedLength}clearInflateData(){this._inflateLength=0,this._deflateLength=0}}var xa;(function(i){i[i.Default=0]="Default",i[i.Ack=1]="Ack"})(xa||(xa={}));class Gte{constructor(t,r,a){w(this,"version",1),w(this,"initialRTO",void 0),w(this,"maxBatchAckCount",void 0),w(this,"maxRTO",void 0),w(this,"initialRTT",void 0),w(this,"ID",void 0),w(this,"rtt",void 0),w(this,"packetNumber",1),w(this,"rtoRatioMap",new Map),w(this,"timeoutMap",new Map),w(this,"unorderedPacketQueue",[]),w(this,"batchAckPacketQueue",[]),w(this,"lastOrderedPacketNumber",0),w(this,"batchAckTimer",void 0),w(this,"sendImpl",void 0),w(this,"receiveImpl",void 0),this.sendImpl=t,this.receiveImpl=r,this.ID=un(7,"transmitter-"),this.initialRTO=(a==null?void 0:a.initialRTO)!==void 0?a.initialRTO:Z("TRANSMITTER_INITIAL_RTO"),this.initialRTT=(a==null?void 0:a.initialRTT)!==void 0?a.initialRTT:Z("TRANSMITTER_INITIAL_RTT"),this.rtt=(a==null?void 0:a.initialRTT)!==void 0?a.initialRTT:Z("TRANSMITTER_INITIAL_RTT"),this.maxBatchAckCount=(a==null?void 0:a.maxBatchAckCount)!==void 0?a.maxBatchAckCount:Z("TRANSMITTER_MAX_BATCH_ACK_COUNT"),this.maxRTO=(a==null?void 0:a.maxRTO)!==void 0?a.maxRTO:Z("TRANSMITTER_MAX_RTO")}packetize(t,r){return{type:xa.Default,version:this.version,packetNumber:r,payload:t}}serialize(t){switch(t.type){case xa.Default:{let r;typeof t.payload=="string"?r=new TextEncoder().encode(t.payload):r=t.payload;const a=new ArrayBuffer(r.length+15),l=new DataView(a);return l.setUint16(0,t.version),l.setUint8(2,t.type),l.setUint32(3,t.packetNumber),Uk(l,7,BigInt(t.sendTs)),new Uint8Array(l.buffer).set(r,15),a}case xa.Ack:{const r=new ArrayBuffer(16),a=new DataView(r);return a.setUint16(0,t.version),a.setUint8(2,t.type),a.setUint32(3,t.maxAckPacketNumber),a.setUint8(7,t.shift),Uk(a,8,BigInt(t.ackSendTs)),r}}}deserialize(t){const r=new DataView(t),a=r.getUint16(0),l=r.getUint8(2);switch(l){case xa.Default:{const u=r.getUint32(3),h=Fk(r,7),f=t.slice(15),v=new TextDecoder().decode(f);return{version:a,type:l,packetNumber:u,sendTs:Number(h),payload:v}}case xa.Ack:{const u=r.getUint32(3),h=r.getUint8(7),f=Fk(r,8);return{version:a,type:l,maxAckPacketNumber:u,shift:h,ackSendTs:Number(f)}}default:throw L.error("[".concat(this.ID,"] Unrecognized packet type ").concat(l)),new Error("Unrecognized packet type ".concat(l))}}sendMessage(t){const r=this.packetize(t,this.packetNumber);this.packetNumber=this.packetNumber===4294967295?1:this.packetNumber+1;const a=this.calculateRTO(r),l=window.setTimeout(()=>{this.resendMessage(r)},a);this.timeoutMap.set(r.packetNumber,l),this.sendPacket(r)}onData(t){const r=this.deserialize(t);r.type===xa.Default?this.ack(r):r.type===xa.Ack&&(this.updateRTT(r,Math.round(performance.now())),this.clearRTO(r))}close(){this.rtt=this.initialRTT,this.packetNumber=1,Array.from(this.timeoutMap.entries()).forEach(t=>{let[r,a]=t;window.clearTimeout(a)}),this.timeoutMap=new Map,this.rtoRatioMap=new Map,this.unorderedPacketQueue=[],this.batchAckPacketQueue=[],this.lastOrderedPacketNumber=0,this.batchAckTimer!==void 0&&window.clearTimeout(this.batchAckTimer)}resendMessage(t){const r=this.calculateRTO(t),a=window.setTimeout(()=>{this.resendMessage(t)},r);this.timeoutMap.set(t.packetNumber,a),this.sendPacket(t)}calculateRTO(t){const r=this.rtoRatioMap.get(t.packetNumber);if(r===void 0)return this.rtoRatioMap.set(t.packetNumber,1),this.initialRTO;{const a=9*this.rtt/8*r;return this.rtoRatioMap.set(t.packetNumber,r+1),a>this.maxRTO?this.maxRTO:a}}updateRTT(t,r){const a=t.ackSendTs;this.rtt=this.rtt*(7/8)+(r-a-this.rtt)/8}ack(t){if(t.packetNumber===this.lastOrderedPacketNumber+1)for(this.batchAckPacketQueue.length>=this.maxBatchAckCount&&this.batchAck(),this.batchAckTimer?this.batchAckPacketQueue.push(t):(this.batchAckPacketQueue.push(t),this.batchAckTimer=window.setTimeout(()=>{this.batchAck()},this.rtt/8)),this.lastOrderedPacketNumber+=1,this.receiveImpl(t.payload);;){const r=this.unorderedPacketQueue[0];if(!r){this.unorderedPacketQueue.shift();break}this.batchAckTimer&&this.batchAck(),this.receiveImpl(r.payload),this.unorderedPacketQueue.shift(),this.lastOrderedPacketNumber+=1}else if(t.packetNumber<=this.lastOrderedPacketNumber){const r={ackSendTs:t.sendTs,maxAckPacketNumber:t.packetNumber,shift:0,type:xa.Ack,version:this.version};this.sendPacket(r)}else if(t.packetNumber>this.lastOrderedPacketNumber){this.unorderedPacketQueue[t.packetNumber-this.lastOrderedPacketNumber-2]=t;const r={ackSendTs:t.sendTs,maxAckPacketNumber:t.packetNumber,shift:0,type:xa.Ack,version:this.version};this.sendPacket(r)}}batchAck(){window.clearTimeout(this.batchAckTimer),this.batchAckTimer=void 0;const t={ackSendTs:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].sendTs,maxAckPacketNumber:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].packetNumber,shift:this.batchAckPacketQueue.length-1,type:xa.Ack,version:this.version};this.sendPacket(t),this.batchAckPacketQueue=[]}sendPacket(t){t.type===xa.Default&&(t.sendTs=Math.round(performance.now()));const r=this.serialize(t);this.sendImpl(r)}clearRTO(t){for(let r=t.maxAckPacketNumber-t.shift;r<=t.maxAckPacketNumber;r++){const a=this.timeoutMap.get(r);a!==void 0&&window.clearTimeout(a),this.timeoutMap.delete(r),this.rtoRatioMap.delete(r)}}}class QM extends zte{constructor(t,r){super(t,r,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3?arguments[3]:void 0),w(this,"_initMutex",void 0),w(this,"_reconnectInterrupter",void 0),w(this,"_url",void 0),w(this,"_transmitter",void 0),w(this,"_addresses",void 0),w(this,"_reliableTransmission",void 0),this._initMutex=new Mr("datachannel");const{timeout:a,timeoutFactor:l}=r,u=Math.max(300,Math.floor(3*a/5)),h=Math.max(1.2,Math.floor(8*l)/10);Li.ONLINE&&(this._retryConfig.timeout=u,this._retryConfig.timeoutFactor=h),or.on(Wc.NETWORK_STATE_CHANGE,(f,v)=>{f!==v&&(this.resetReconnectCount("network state change: ".concat(v," -> ").concat(f)),f===Li.ONLINE?(this._retryConfig.timeout=u,this._retryConfig.timeoutFactor=h):(this._retryConfig.timeout=a,this._retryConfig.timeoutFactor=l))})}getConnection(){if(this._reliableTransmission)return this._reliableTransmission}async init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;this._forceCloseTimeout=r;const a=(l,u)=>{this._addresses=t,this.currentURLIndex=this._addresses.findIndex(f=>f.fingerprint||Z("FINGERPRINT"));const h=this._addresses[this.currentURLIndex];this.state="connecting",this.createTransmitterConnection(h).then(l).catch(u),this.once(qn.CLOSED,()=>u(new ue(G.WS_DISCONNECT))),this.once(qn.CONNECTED,()=>l())};return this._initMutex.lock().then(l=>new me((u,h)=>{a(u,h)}).then(()=>{l()}).catch(()=>{l()}))}sendMessage(t){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this._transmitter||!this._reliableTransmission)throw new ue(G.WS_ABORT,"datachannel is not ready");try{r||(t=JSON.stringify(t)),this._reliableTransmission.sendMessage(t)}catch(a){throw new ue(G.WS_ERR,"send datachannel signal message error"+a.toString())}}unbindDcCloseEventListener(){this._transmitter&&(this._transmitter.onclose=null)}sendMessageWithJSON(t){const r=JSON.stringify(t);return{compressed:r,compressedLength:r.length,origin:t}}sendMessageWithUint8Array(t){return{compressed:t,compressedLength:t.byteLength,origin:t}}createTransmitterConnection(t){return this.connectionID+=1,this._joinChannelServiceRecordIndex=void 0,this._url="dc://".concat(t.ip,":").concat(t.port),new me((r,a)=>{var l;const u=()=>{L.debug("[".concat(this._name,"] datachannel opened:"),this._url),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),r()},h=async y=>{var C;if((C=this._closeEstablishingTransmitter)===null||C===void 0||C.call(this),L.debug("[".concat(this._name,"] datachannel close ").concat(this._url,", code: ").concat(y.code,", reason: ").concat(y.reason,", current mode: ").concat(this.reconnectMode)),this._reconnectCount<this._retryConfig.maxRetryCount){this.state==="connected"&&(this.reconnectReason=y.reason,this.state="reconnecting");const I=mo(this,qn.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,k=await this.reconnectWithAction(I);if(this.state==="closed")return void L.debug("[".concat(this.connectionID,"] dc is closed, no need to reconnect"));if(!k)return a(new ue(G.WS_DISCONNECT,"datachannel reconnect failed: ".concat(y.code))),void this.close(!0);r()}else a(new ue(G.WS_DISCONNECT,"datachannel close: ".concat(y.code))),this.close()},f=y=>{var C;(C=this._reliableTransmission)===null||C===void 0||C.onData(y.data)};this._transmitter&&(this._transmitter.onclose=null,this._transmitter.close()),this._reliableTransmission&&(this._reliableTransmission.close(),this._reliableTransmission=void 0),L.debug("[".concat(this._name,"] start connect, address: ").concat(JSON.stringify(t)));const v=(l=this._store)===null||l===void 0?void 0:l.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"}),E=Date.now();Ln(this,qn.TO_CONNECT_DATACHANNEL,t).then(y=>{var C,I;if(!y)throw new Error("transmissonInfo not exist yet");const{transmitter:k,close:W}=y;this._transmitter=k,(C=this._store)===null||C===void 0||C.signalChannelOpen();const $=Date.now()-E;L.debug("[choose dc] dc open cost ".concat($,"ms")),this._reliableTransmission=new Gte(z=>{var X;this._transmitter&&this._transmitter.readyState==="open"&&((X=this._transmitter)===null||X===void 0||X.send(z))},z=>{typeof z=="string"&&this.emit(qn.ON_MESSAGE,z)}),this._closeEstablishingTransmitter=()=>{var z;(z=this._reliableTransmission)===null||z===void 0||z.close(),this._reliableTransmission=void 0,W()},u&&u(),k.onclose=h,k.onmessage=f,(I=this._store)===null||I===void 0||I.recordJoinChannelService({endTs:Date.now(),status:"success"},v),this._joinChannelServiceRecordIndex=v}).catch(y=>{var C;if((C=this._store)===null||C===void 0||C.recordJoinChannelService({endTs:Date.now(),status:y instanceof ue&&y.code===G.WS_ABORT?"aborted":"error",errors:[y]},v),this.state!=="closed"){if(y instanceof ue&&y.code===G.WS_ERR){const I=new ue(G.WS_ERR,"init datachannel failed! Error: ".concat(y.toString()));return L.error("[".concat(this._name,"]").concat(I)),void a(I)}h&&h(y)}else a(new ue(G.WS_DISCONNECT,"datachannel is closed: ".concat(y.toString())))})})}async reconnectWithAction(t){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this._reconnectCount>=this._retryConfig.maxRetryCount||!this._addresses||this.state==="closed")return!1;this._onlineReconnectListener||or.networkState!==Li.OFFLINE||(this._onlineReconnectListener=or.onlineWaiter&&or.onlineWaiter.then(()=>{this._onlineReconnectListener=void 0}));let a=!0;if(this._reconnectInterrupter=()=>{a=!1},r){const f=Zg(this._reconnectCount,this._retryConfig);L.debug("[".concat(this._name,"] wait ").concat(f,"ms to reconnect datachannel, mode: ").concat(t)),await me.race([ni(f),this._onlineReconnectListener||new me(()=>{})])}if(this.state==="closed"||!a)return!1;this._reconnectCount+=1;const l=async(f,v)=>{this.emit(qn.RECONNECT_CREATE_CONNECTION,v),await this.createTransmitterConnection(f)};try{if(t==="retry"){const f=this._addresses[this.currentURLIndex];this.emit(qn.RECONNECT_WAITTING_FINISH,t),await l(f,t)}else if(t==="tryNext"){this.currentURLIndex+=1;for(let v=this.currentURLIndex;v<this._addresses.length;v++){if(this._addresses[v].fingerprint||Z("FINGERPRINT")){this.currentURLIndex=v;break}this.currentURLIndex+=1}if(this.currentURLIndex>=this._addresses.length)return L.debug("[".concat(this._name,"] the available addresses are exhausted, change to recover")),await this.reconnectWithAction("recover",!1);L.debug("[".concat(this._name,"] datachannel url length: ").concat(this._addresses.length," current index: ").concat(this.currentURLIndex));const f=this._addresses[this.currentURLIndex];this.emit(qn.RECONNECT_WAITTING_FINISH,t),await l(f,t)}else t==="recover"&&(L.debug("[".concat(this._name,"] start to failback to websocket")),this.resetReconnectCount("recover mode"),this.emit(qn.RECONNECT_WAITTING_FINISH,t),this.emit(qn.FAILBACK));return!0}catch(f){var u,h;return L.error("[".concat(this._name,"] reconnect failed"),f.toString()),f!=null&&(u=f.data)!==null&&u!==void 0&&u.desc&&Array.isArray(f.data.desc)&&f.data.desc.length&&Ke(h=f.data.desc).call(h,"dynamic key expired")?(this.emit(qn.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):await this.reconnectWithAction(t,r)}}}class Jc extends An{get connectionState(){return this._connectionState}set connectionState(t){t!==this._connectionState&&(this._connectionState=t,t===wt.CONNECTED?this.emit(Le.WS_CONNECTED):t===wt.RECONNECTING?this.emit(Le.WS_RECONNECTING,this._websocketReconnectReason):t===wt.CLOSED&&this.emit(Le.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}constructor(t,r){super(),w(this,"_disconnectedReason",void 0),w(this,"_websocketReconnectReason",void 0),w(this,"_connectionState",wt.CLOSED),w(this,"reconnectToken",void 0),w(this,"websocket",void 0),w(this,"openConnectionTime",void 0),w(this,"clientId",void 0),w(this,"lastMsgTime",Date.now()),w(this,"uploadCache",[]),w(this,"uploadCacheInterval",void 0),w(this,"rttRolling",new xb(5)),w(this,"pingpongTimer",void 0),w(this,"inflateDataTimer",void 0),w(this,"pingpongTimeoutCount",0),w(this,"joinResponse",void 0),w(this,"multiIpOption",void 0),w(this,"initError",void 0),w(this,"spec",void 0),w(this,"store",void 0),w(this,"onWebsocketMessage",a=>{if(a instanceof ArrayBuffer)return void this.emit(Le.ON_BINARY_DATA,a);const l=JSON.parse(a);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(l,"_id")){const u="res-@".concat(l._id);this.emit(u,l._result,l._message)}else if(Object.prototype.hasOwnProperty.call(l,"_type")&&(this.emit(l._type,l._message),l._type===lt.ON_NOTIFICATION&&this.handleNotification(l._message),l._type===lt.ON_USER_BANNED))switch(l._message.error_code){case 14:this.close(It.UID_BANNED);break;case 15:this.close(It.IP_BANNED);break;case 16:this.close(It.CHANNEL_BANNED)}}),this.clientId=t.clientId,this.spec=t,this.store=r,this.websocket=new QM("gateway-".concat(this.clientId),this.spec.retryConfig,!0,r),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===wt.CONNECTED&&this.reconnect("retry",vc.OFFLINE)})}async request(t,r,a,l){const u=un(6,""),h={_id:u,_type:t,_message:r},f=this.websocket.connectionID,v=()=>new me((W,$)=>{if(this.connectionState===wt.CONNECTED)return W();const z=()=>{this.off(Le.WS_CLOSED,X),W()},X=()=>{this.off(Le.WS_CONNECTED,z),$(new ue(G.WS_ABORT))};this.once(Le.WS_CONNECTED,z),this.once(Le.WS_CLOSED,X),t!==$e.PUBLISH&&t!==$e.SUBSCRIBE&&t!==$e.UNSUBSCRIBE&&t!==$e.UNPUBLISH&&t!==$e.CONTROL&&t!==$e.RESTART_ICE||this.once(Le.DISCONNECT_P2P,()=>{$(new ue(G.DISCONNECT_P2P))}),t!==$e.PUBLISH&&t!==$e.RESTART_ICE||this.once(Le.ABORT_P2P_EXECUTION,()=>{$(new ue(G.DISCONNECT_P2P))})});if(this.connectionState!==wt.CONNECTING&&this.connectionState!==wt.RECONNECTING||t===$e.JOIN||t===$e.REJOIN||await v(),t===$e.LEAVE&&(this.websocket.unbindDcCloseEventListener(),l=!0),this.websocket.sendMessage(h,!0,!1),l)return;const E=new me((W,$)=>{let z=!1;const X=(oe,Re)=>{z=!0,W({isSuccess:oe==="success",message:Re||{}}),this.off(Le.WS_CLOSED,ie),this.off(Le.WS_RECONNECTING,ie),this.emit(Le.REQUEST_SUCCESS,t,r)};this.once("res-@".concat(u),X);const ie=()=>{$(new ue(G.WS_ABORT,"type: ".concat(t))),this.off(Le.WS_CLOSED,ie),this.off(Le.WS_RECONNECTING,ie),this.off("res-@".concat(u),X)};this.once(Le.WS_CLOSED,ie),this.once(Le.WS_RECONNECTING,ie),ni(Z("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==f||z||(L.warning("dc request timeout, type: ".concat(t)),this.emit(Le.REQUEST_TIMEOUT,t,r))})});let y=null;try{y=await E}catch(W){if(this.connectionState===wt.CLOSED||t===$e.LEAVE)throw new ue(G.WS_ABORT);return!this.spec.forceWaitGatewayResponse||a?W.throw():t===$e.JOIN||t===$e.REJOIN?null:(await v(),await this.request(t,r))}if(y.isSuccess)return y.message;const C=Number(y.message.error_code||y.message.code),I=rd(C),k=new ue(G.UNEXPECTED_RESPONSE,"".concat(I.desc,": ").concat(y.message.error_str),{code:C,data:y.message});return I.action==="success"?y.message:(L.warning("[".concat(this.websocket.connectionID,"] unexpected response from type ").concat(t,", error_code: ").concat(C,", message: ").concat(I.desc,", action: ").concat(I.action)),C===Xe.ERR_TOO_MANY_BROADCASTERS?((t===$e.JOIN||t===$e.REJOIN)&&(this.initError=k,this.close()),k.throw()):I.action==="failed"?k.throw():I.action==="quit"?(this.initError=k,this.close(),k.throw()):(C===Xe.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=y.message.option,L.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",vc.MULTI_IP)):this.reconnect(I.action,vc.SERVER_ERROR),t===$e.JOIN||t===$e.REJOIN?null:await this.request(t,r)))}waitMessage(t,r){return new me(a=>{const l=u=>{(!r||r(u))&&(this.off(t,l),a(u))};this.on(t,l)})}upload(t,r){const a={_type:t,_message:r};try{this.websocket.sendMessage(a)}catch{const u=Z("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(a),this.uploadCache.length>u&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==wt.CONNECTED)return;const h=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(h._type,h._message)},Z("UPLOAD_CACHE_INTERVAL")||2e3))}}send(t,r){const a={_type:t,_message:r};this.websocket.sendMessage(a)}init(t,r){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new me((a,l)=>{this.once(Le.WS_CONNECTED,()=>a(this.joinResponse)),this.once(Le.WS_CLOSED,()=>l(this.initError||new ue(G.WS_ABORT))),this.connectionState=wt.CONNECTING,this.websocket.init(t).catch(l),this.websocket.once(qn.FAILBACK,()=>{this.openConnectionTime===void 0&&l(new ue(G.INIT_DATACHANNEL_TIMEOUT))}),this.inflateDataTimer&&window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=window.setInterval(()=>{this.handleInflateData()},2e4),setTimeout(()=>{r&&this.openConnectionTime===void 0&&(L.debug("[".concat(this.clientId,"] init datachannel timeout while join with failback to websocket")),l(new ue(G.INIT_DATACHANNEL_TIMEOUT)))},Z("DC_JOIN_WITH_FAILBACK"))})}close(t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.inflateDataTimer&&(this.handleInflateData(),window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=t||It.LEAVE,this.connectionState=wt.CLOSED,L.debug("[".concat(this.clientId,"] ")+"will close datachannel in signal"),this.websocket.close(),t===It.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new QM("gateway-".concat(this.clientId),this.spec.retryConfig,!0,this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(Le.ABORT_P2P_EXECUTION);const t=await Ln(this,Le.DATACHANNEL_CONNECTING),r=await this.request($e.JOIN,t);if(!r)return this.emit(Le.REPORT_JOIN_GATEWAY,G.TIMEOUT,this.url||""),!1;this.joinResponse=r,this.emit(Le.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=wt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new ue(G.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const t=zc(this,Le.REQUEST_REJOIN_INFO);t.token=this.reconnectToken;const r=await this.request($e.REJOIN,t);return!!r&&(this.connectionState=wt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),r.peers&&r.peers.forEach(a=>{this.emit(lt.ON_USER_ONLINE,{uid:a.uid}),a.audio&&this.emit(lt.ON_ADD_AUDIO_STREAM,{uid:a.uid,uint_id:a.uint_id,audio:!0,ssrcId:a.audio_ssrc}),a.video&&this.emit(lt.ON_ADD_VIDEO_STREAM,{uid:a.uid,uint_id:a.uint_id,video:!0,ssrcId:a.video_ssrc}),a.audio_mute?this.emit(lt.MUTE_AUDIO,{uid:a.uid}):this.emit(lt.UNMUTE_AUDIO,{uid:a.uid}),a.video_mute?this.emit(lt.MUTE_VIDEO,{uid:a.uid}):this.emit(lt.UNMUTE_VIDEO,{uid:a.uid}),a.audio_enable_local?this.emit(lt.ENABLE_LOCAL_AUDIO,{uid:a.uid}):this.emit(lt.DISABLE_LOCAL_AUDIO,{uid:a.uid}),a.video_enable_local?this.emit(lt.ENABLE_LOCAL_VIDEO,{uid:a.uid}):this.emit(lt.DISABLE_LOCAL_VIDEO,{uid:a.uid}),a.audio||a.video||this.emit(lt.ON_REMOVE_STREAM,{uid:a.uid,uint_id:a.uint_id})}),!0)}reconnect(t,r){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(t,r)}handleNotification(t){L.debug("[".concat(this.clientId,"] receive notification: "),t);const r=rd(t.code);if(r.action!=="success"){if(r.action!=="failed")return r.action==="quit"?(r.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(It.UID_BANNED),void this.close()):void this.reconnect(r.action,vc.SERVER_ERROR);L.error("[".concat(this.clientId,"] ignore error: "),r.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const t=Z("PING_PONG_TIME_OUT"),r=Date.now();this.pingpongTimeoutCount>=t&&(L.warning("PINGPONG Timeout. Last Socket Message: ".concat(r-this.lastMsgTime,"ms")),r-this.lastMsgTime>Z("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",vc.TIMEOUT):this.request($e.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const a=Date.now()-r;this.rttRolling.add(a),Z("REPORT_STATS")&&this.send($e.PING_BACK,{pingpongElapse:a})}).catch(a=>{})}handleInflateData(){const{inflateLength:t,deflateLength:r}=this.websocket.getInflateData();t!==0&&r!==0&&this.upload(Eo.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:r,ws_inflate_length:t})}handleWebsocketEvents(){this.websocket.on(qn.RECONNECT_WAITTING_FINISH,t=>{this.emit(Le.WS_RECONNECT_WAITTING_FINISH,t)}),this.websocket.on(qn.RECONNECT_CREATE_CONNECTION,t=>{this.emit(Le.WS_RECONNECT_CREATE_CONNECTION,t)}),this.websocket.on(qn.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(qn.CLOSED,()=>{this.connectionState=wt.CLOSED}),this.websocket.on(qn.FAILED,()=>{this._disconnectedReason=It.NETWORK_ERROR,this.connectionState=wt.CLOSED}),this.websocket.on(qn.RECONNECTING,t=>{this._websocketReconnectReason=t,this.joinResponse=void 0,this.connectionState===wt.CONNECTED?this.connectionState=wt.RECONNECTING:this.connectionState=wt.CONNECTING}),this.websocket.on(qn.WILL_RECONNECT,(t,r)=>{if(zc(this,Le.IS_P2P_DISCONNECTED)&&t==="retry")return L.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(Le.NEED_RENEW_SESSION),this.emit(Le.DISCONNECT_P2P),r("tryNext");t!=="retry"&&(L.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(t)),this.reconnectToken=void 0,this.emit(Le.NEED_RENEW_SESSION),this.emit(Le.DISCONNECT_P2P)),r(t)}),this.websocket.on(qn.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(t=>{L.warning("[".concat(this.clientId,"] rejoin failed ").concat(t)),this.reconnect("tryNext",vc.SERVER_ERROR)}):this.join().catch(t=>{if(this.emit(Le.REPORT_JOIN_GATEWAY,t.message||t.code,this.url||""),t instanceof ue&&t.code===G.UNEXPECTED_RESPONSE&&t.data.code===Xe.ERR_NO_AUTHORIZED)return L.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",vc.SERVER_ERROR);L.error("[".concat(this.clientId,"] join gateway request failed"),t.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",vc.SERVER_ERROR):(this.initError=t,this.close())})}),this.websocket.on(qn.REQUEST_NEW_URLS,(t,r)=>{Ln(this,Le.REQUEST_RECOVER,this.multiIpOption).then(t).catch(r)}),this.websocket.on(qn.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(lt.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(qn.TO_CONNECT_DATACHANNEL,async(t,r,a)=>Ln(this,Le.DATACHANNEL_PRECONNECT,t).then(r).catch(a)),this.websocket.on(qn.FAILBACK,()=>{this.openConnectionTime!==void 0&&this.emit(Le.DATACHANNEL_FAILBACK)})}}class $v extends An{constructor(t){super(),w(this,"_signal",void 0),w(this,"_sequence",0),w(this,"_userMap",new Map),w(this,"_encoder",new TextEncoder),this._signal=t}async send(t,r,a,l,u){var h,f,v;typeof r!="string"&&(r=JSON.stringify(r)),l=(h=l)!==null&&h!==void 0?h:un(6,""),u=(f=u)!==null&&f!==void 0?f:this._sequence++;const E={_id:l,_type:t,_seq:(v=u)!==null&&v!==void 0?v:this._sequence++,_message:r};if(Z("SHOW_P2P_LOG")&&L.debug("send message",E),this.sendStreamMessage(JSON.stringify(E)),a)return;const y=new me((I,k)=>{const W=window.setTimeout(()=>{this.off("res-@".concat(l),$),L.warning("[external-signal] request timeout, type: ".concat(t)),this._userMap.size===0?k(new be(G.INVALID_REMOTE_USER)):k(new be(G.TIMEOUT))},Z("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),$=(z,X)=>{W&&window.clearTimeout(W),z==="success"?I({isSuccess:!0,message:X}):k(new be(G.UNEXPECTED_ERROR,X))};this.once("res-@".concat(l),$)});let C;try{C=await y}catch(I){if(I.code===G.TIMEOUT)return await this.send(t,r,!1,l,u);throw I}return C.isSuccess?C.message:void 0}sendStreamMessage(t){this._splitMessage(t).forEach(r=>{this._signal.request($e.DATA_STREAM,{payload:Xg(this._encoder.encode(r))})})}onMessage(t){const{_uid:r}=t;let a;const l=this._userMap.get(r);if(l?a=l.splitMessageMap:(a=new Map,this._userMap.set(r,{isStart:!1,splitMessageMap:a,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map})),"id"in t&&"total"in t){var u;const{id:h,total:f}=t,v=(u=a.get(h))!==null&&u!==void 0?u:[];if(v.push(t),a.has(h)||a.set(h,v),v.length!==f)return;{const E=Nf(v).call(v,(y,C)=>y.index-C.index).map(y=>y.payload).join("");a.delete(h),(t=JSON.parse(E))._uid=r}}this.handleReceivedMessage(t)}setStart(t){this._userMap.has(t)?this._userMap.get(t).isStart=!0:this._userMap.set(t,{isStart:!0,splitMessageMap:new Map,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map}),this.handleReceivedMessage()}setEnd(t){return this._userMap.delete(t),this._userMap.size===0}ack(t,r,a){this.send(mn.ACK,JSON.stringify({success:!a,message:r}),!0,t)}handleReceivedMessage(t){const r=()=>{this._userMap.forEach(E=>{const{receivedMessagesMap:y,nextExpectedSequenceNumber:C}=E;for(;y.has(C);){const I=y.get(C);y.delete(C),this.receiveMessage(I),E.nextExpectedSequenceNumber++}})};if(!t)return void r();const{_uid:a,_seq:l}=t,u=this._userMap.get(a),{receivedMessagesMap:h,isStart:f,nextExpectedSequenceNumber:v}=u;l<v?L.debug("[external-signal] receive old message, seq: ".concat(l)):(h.set(l,t),f&&l===v&&(this.receiveMessage(t),h.delete(v),u.nextExpectedSequenceNumber++,r()))}receiveMessage(t){const{_id:r,_type:a,_message:l,_uid:u}=t;if(Z("SHOW_P2P_LOG")&&L.debug("",t),r)switch(t._type){case mn.PUBLISH:const h=JSON.parse(l);this._signal.emit(a,h,u),this.ack(t._id);break;case mn.CONTROL:case mn.UNPUBLISH:case mn.DO_SUBSCRIBE:case mn.DO_UNSUBSCRIBE:{const f=JSON.parse(l);f.uid=u,Ln(this._signal,a,f).then(v=>{this.ack(t._id,v)}).catch(v=>{this.ack(t._id,void 0,!0)});break}case mn.ACK:{const{success:f,message:v}=JSON.parse(l);this.emit("res-@".concat(r),f?"success":"failed",v);break}case mn.CALL:Ln(this,a,l).then(f=>{this.ack(r,f)});break;case mn.RESTART_ICE:case mn.EXCHANGE_SDP:case mn.SUBSCRIBE:case mn.UNSUBSCRIBE:Ln(this._signal,a,l).then(f=>{this.ack(r,f)}).catch(f=>{this.ack(t._id,void 0,!0)});break;case mn.CANDIDATE:this._signal.emit(a,l),this.ack(r);break;case mn.JOIN:this.emit(a,JSON.parse(l));break;default:this.emit(a,l),this.ack(r)}}_splitMessage(t){if(t.length<$v.MAX_MESSAGE_SIZE)return[t];const r=[],a=un(6,"");let l=0;const u=Math.ceil(t.length/800);for(;t.length>0;){l++;const h=t.slice(0,800);r.push({id:a,index:l,total:u,payload:h}),t=t.slice(800)}return r.map(h=>JSON.stringify(h))}clear(){this._sequence=0,this._userMap.clear()}}w($v,"MAX_MESSAGE_SIZE",1024);class ZM extends An{get connectionState(){return this._connectionState}set connectionState(t){t!==this._connectionState&&(this._connectionState=t,t===wt.CONNECTED?this.emit(Le.WS_CONNECTED):t===wt.RECONNECTING?this.emit(Le.WS_RECONNECTING,this._websocketReconnectReason):t===wt.CLOSED&&this.emit(Le.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(t,r){super(),w(this,"_disconnectedReason",void 0),w(this,"_websocketReconnectReason",void 0),w(this,"_connectionState",wt.CLOSED),w(this,"reconnectToken",void 0),w(this,"_userInRoom",!1),w(this,"_userOnlineTime",void 0),w(this,"websocket",void 0),w(this,"openConnectionTime",void 0),w(this,"clientId",void 0),w(this,"lastMsgTime",Date.now()),w(this,"uploadCache",[]),w(this,"uploadCacheInterval",void 0),w(this,"rttRolling",new xb(5)),w(this,"pingpongTimer",void 0),w(this,"wsInflateDataTimer",void 0),w(this,"pingpongTimeoutCount",0),w(this,"joinResponse",void 0),w(this,"multiIpOption",void 0),w(this,"initError",void 0),w(this,"spec",void 0),w(this,"store",void 0),w(this,"_external_signal",void 0),w(this,"onWebsocketMessage",a=>{if(a.data instanceof ArrayBuffer)return void this.emit(Le.ON_BINARY_DATA,a.data);const l=JSON.parse(a.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(l,"_id")){const u="res-@".concat(l._id);this.emit(u,l._result,l._message)}else if(Object.prototype.hasOwnProperty.call(l,"_type")){switch(l._type){case lt.ON_DATA_STREAM:return void this.handleDataStream(l._message);case lt.MUTE_AUDIO:case lt.MUTE_VIDEO:case lt.ON_P2P_LOST:return;case lt.ON_USER_ONLINE:this.emit(l._type,l._message);const{uid:u}=l._message;return this._external_signal.setStart(u),void this._external_signal.send(mn.JOIN,{onlineTime:this._userOnlineTime},!0)}if(this.emit(l._type,l._message),l._type===lt.ON_NOTIFICATION&&this.handleNotification(l._message),l._type===lt.ON_USER_BANNED)switch(l._message.error_code){case 14:this.close(It.UID_BANNED);break;case 15:this.close(It.IP_BANNED);break;case 16:this.close(It.CHANNEL_BANNED)}if(l._type===lt.ON_USER_LICENSE_BANNED)switch(l._message.error_code){case Xe.ERR_LICENSE_MISSING:this.close(It.LICENSE_MISSING);break;case Xe.ERR_LICENSE_EXPIRED:this.close(It.LICENSE_EXPIRED);break;case Xe.ERR_LICENSE_MINUTES_EXCEEDED:this.close(It.LICENSE_MINUTES_EXCEEDED);break;case Xe.ERR_LICENSE_PERIOD_INVALID:this.close(It.LICENSE_PERIOD_INVALID);break;case Xe.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(It.LICENSE_MULTIPLE_SDK_SERVICE);break;case Xe.ERR_LICENSE_ILLEGAL:this.close(It.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=t.clientId,this.spec=t,this.store=r,this.websocket=new qf("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Z("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Z("JOIN_GATEWAY_USE_443PORT_ONLY"),r),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===wt.CONNECTED&&this.reconnect("retry",Ir.OFFLINE)}),this._external_signal=new $v(this),this._handleSignalP2PEvents()}async request(t,r,a,l){const u=un(6,""),h={_id:u,_type:t,_message:r},f=this.websocket.connectionID,v=()=>new me((W,$)=>{if(this.connectionState===wt.CONNECTED)return W();const z=()=>{this.off(Le.WS_CLOSED,X),W()},X=()=>{this.off(Le.WS_CONNECTED,z),$(new be(G.WS_ABORT))};this.once(Le.WS_CONNECTED,z),this.once(Le.WS_CLOSED,X),t!==$e.PUBLISH&&t!==$e.SUBSCRIBE&&t!==$e.UNSUBSCRIBE&&t!==$e.UNPUBLISH&&t!==$e.CONTROL&&t!==$e.RESTART_ICE||this.once(Le.DISCONNECT_P2P,()=>{$(new be(G.DISCONNECT_P2P))}),t!==$e.PUBLISH&&t!==$e.RESTART_ICE||this.once(Le.ABORT_P2P_EXECUTION,()=>{$(new be(G.DISCONNECT_P2P))})});if(this.connectionState!==wt.CONNECTING&&this.connectionState!==wt.RECONNECTING||t===$e.JOIN||t===$e.REJOIN||await v(),this.websocket.sendMessage(h,!0),l)return;const E=new me((W,$)=>{let z=!1;const X=(oe,Re)=>{z=!0,W({isSuccess:oe==="success",message:Re||{}}),this.off(Le.WS_CLOSED,ie),this.off(Le.WS_RECONNECTING,ie),this.emit(Le.REQUEST_SUCCESS,t,r)};this.once("res-@".concat(u),X);const ie=()=>{$(new be(G.WS_ABORT,"type: ".concat(t))),this.off(Le.WS_CLOSED,ie),this.off(Le.WS_RECONNECTING,ie),this.off("res-@".concat(u),X)};this.once(Le.WS_CLOSED,ie),this.once(Le.WS_RECONNECTING,ie),ni(Z("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==f||z||(L.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(t)),this.emit(Le.REQUEST_TIMEOUT,t,r))})});let y=null;try{y=await E}catch(W){if(this.connectionState===wt.CLOSED||t===$e.LEAVE)throw new be(G.WS_ABORT);return!this.spec.forceWaitGatewayResponse||a?W.throw():t===$e.JOIN||t===$e.REJOIN?null:(await v(),await this.request(t,r))}if(y.isSuccess)return y.message;const C=Number(y.message.error_code||y.message.code),I=rd(C),k=new be(G.UNEXPECTED_RESPONSE,"".concat(I.desc,": ").concat(y.message.error_str),{code:C,data:y.message});return I.action==="success"?y.message:(L.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(t,", error_code: ").concat(C,", message: ").concat(I.desc,", action: ").concat(I.action)),C===Xe.ERR_TOO_MANY_BROADCASTERS?((t===$e.JOIN||t===$e.REJOIN)&&(this.initError=k,this.close()),k.throw()):I.action==="failed"?k.throw():I.action==="quit"?(this.initError=k,this.close(),k.throw()):(C===Xe.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=y.message.option,L.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Ir.MULTI_IP)):this.reconnect(I.action,Ir.SERVER_ERROR),t===$e.JOIN||t===$e.REJOIN?null:await this.request(t,r)))}waitMessage(t,r){return new me(a=>{const l=u=>{(!r||r(u))&&(this.off(t,l),a(u))};this.on(t,l)})}upload(t,r){const a={_type:t,_message:r};try{this.websocket.sendMessage(a)}catch{const u=Z("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(a),this.uploadCache.length>u&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==wt.CONNECTED)return;const h=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(h._type,h._message)},Z("UPLOAD_CACHE_INTERVAL")||2e3))}}send(t,r){const a={_type:t,_message:r};this.websocket.sendMessage(a)}async sendExtensionMessage(t,r,a){return await this.waitTillUserOnline(),await this._external_signal.send(t,r,a)}init(t,r){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new me((a,l)=>{this.once(Le.WS_CONNECTED,()=>a(this.joinResponse)),this.once(Le.WS_CLOSED,()=>l(this.initError||new be(G.WS_ABORT))),this.connectionState=wt.CONNECTING,this.websocket.init(t).catch(l),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=t||It.LEAVE,this.connectionState=wt.CLOSED,L.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),t===It.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new qf("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Z("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Z("JOIN_GATEWAY_USE_443PORT_ONLY"),this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(Le.ABORT_P2P_EXECUTION);const t=await Ln(this,Le.REQUEST_JOIN_INFO),r=await this.request($e.JOIN,t);if(!r)return this.emit(Le.REPORT_JOIN_GATEWAY,G.TIMEOUT,this.url||""),!1;this.joinResponse=r,this.emit(Le.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=wt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),this._userOnlineTime=new Date().getTime(),this._external_signal.clear(),!0}async rejoin(){if(!this.reconnectToken)throw new be(G.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const t=zc(this,Le.REQUEST_REJOIN_INFO);return t.token=this.reconnectToken,!!await this.request($e.REJOIN,t)&&(this.connectionState=wt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0)}reconnect(t,r){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(t,r)}handleDataStream(t){try{var r;const a=Yg(t.payload),l=new TextDecoder().decode(a),u=JSON.parse(l);"total"in u&&"id"in u||Ke(r=Object.values(mn)).call(r,u._type)?(t.seq&&delete t.seq,u._uid=t.uid,this._external_signal.onMessage(u)):this.emit(lt.ON_DATA_STREAM,t)}catch{}}handleNotification(t){L.debug("[".concat(this.clientId,"] receive notification: "),t);const r=rd(t.code);if(r.action!=="success"){if(r.action!=="failed")return r.action==="quit"?(r.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(It.UID_BANNED),void this.close()):void this.reconnect(r.action,Ir.SERVER_ERROR);L.error("[".concat(this.clientId,"] ignore error: "),r.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const t=Z("PING_PONG_TIME_OUT"),r=Date.now();this.pingpongTimeoutCount>=t&&(L.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(r-this.lastMsgTime,"ms")),r-this.lastMsgTime>Z("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Ir.TIMEOUT):this.request($e.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const a=Date.now()-r;this.rttRolling.add(a),Z("REPORT_STATS")&&this.send($e.PING_BACK,{pingpongElapse:a})}).catch(a=>{})}handleWsInflateData(){const{wsInflateLength:t,wsDeflateLength:r}=this.websocket.getWsInflateData();t!==0&&r!==0&&this.upload(Eo.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:r,ws_inflate_length:t})}handleWebsocketEvents(){this.websocket.on(rt.RECONNECT_WAITTING_FINISH,t=>{this.emit(Le.WS_RECONNECT_WAITTING_FINISH,t)}),this.websocket.on(rt.RECONNECT_CREATE_CONNECTION,t=>{this.emit(Le.WS_RECONNECT_CREATE_CONNECTION,t)}),this.websocket.on(rt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(rt.CLOSED,()=>{this.connectionState=wt.CLOSED}),this.websocket.on(rt.FAILED,()=>{this._disconnectedReason=It.NETWORK_ERROR,this.connectionState=wt.CLOSED}),this.websocket.on(rt.RECONNECTING,t=>{this._websocketReconnectReason=t,this.joinResponse=void 0,this.connectionState===wt.CONNECTED?this.connectionState=wt.RECONNECTING:this.connectionState=wt.CONNECTING}),this.websocket.on(rt.WILL_RECONNECT,(t,r,a)=>{if(zc(this,Le.IS_P2P_DISCONNECTED)&&t==="retry")return L.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(Le.NEED_RENEW_SESSION),this.emit(Le.DISCONNECT_P2P),a("tryNext");t!=="retry"&&(L.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(t)),this.reconnectToken=void 0,this.emit(Le.NEED_RENEW_SESSION),this.emit(Le.DISCONNECT_P2P)),a(t)}),this.websocket.on(rt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(t=>{L.warning("[".concat(this.clientId,"] rejoin failed ").concat(t)),this.reconnect("tryNext",Ir.SERVER_ERROR)}):this.join().catch(t=>{if(this.emit(Le.REPORT_JOIN_GATEWAY,t.message||t.code,this.url||""),t instanceof be&&t.code===G.UNEXPECTED_RESPONSE&&t.data.code===Xe.ERR_NO_AUTHORIZED)return L.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",Ir.SERVER_ERROR);L.error("[".concat(this.clientId,"] join gateway request failed"),t.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Ir.SERVER_ERROR):(this.initError=t,this.close())})}),this.websocket.on(rt.REQUEST_NEW_URLS,(t,r)=>{Ln(this,Le.REQUEST_RECOVER,this.multiIpOption).then(t).catch(r)}),this.websocket.on(rt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(lt.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}_handleSignalP2PEvents(){this._external_signal.on(mn.JOIN,async t=>{if(this._userOnlineTime&&this._userOnlineTime<t.onlineTime){const r=await Ln(this,Le.P2P_START,void 0),a=await this._external_signal.send(mn.CALL,r);this.emit(Le.P2P_CONNECTION,a,!0)}this._userInRoom=!0,this.emit("user-online")}),this.on(lt.ON_USER_OFFLINE,async t=>{this._external_signal.clear(),this._userInRoom=!1}),this._external_signal.on(mn.CALL,async(t,r,a)=>{this._userInRoom=!0,this.emit("user-online");try{r(await Ln(this,Le.P2P_START,t))}catch(l){a(l)}})}async waitTillUserOnline(){return new me(t=>{if(this._userInRoom)t();else{const r=()=>{this.off("user-online",r),t()};this.on("user-online",r)}})}}function eF(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function cs(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eF(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):eF(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}const XT=new Map;class Kte extends An{get state(){return this._state}set state(t){if(t===this._state)return;const r=this._state;this._state=t,t==="DISCONNECTED"&&this._disconnectedReason?this.emit(Fn.CONNECTION_STATE_CHANGE,t,r,this._disconnectedReason):this.emit(Fn.CONNECTION_STATE_CHANGE,t,r)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(t){L.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(t)),this._joinGatewayStartTime=t}constructor(t,r){super(),w(this,"store",void 0),w(this,"joinInfo",void 0),w(this,"key",void 0),w(this,"ntpOffset",0),w(this,"signal",void 0),w(this,"role",void 0),w(this,"inChannelInfo",{joinAt:null,duration:0}),w(this,"spec",void 0),w(this,"_state","DISCONNECTED"),w(this,"_statsCollector",void 0),w(this,"_disconnectedReason",void 0),w(this,"isSignalRecover",!1),w(this,"hasChangeBGPAddress",!1),w(this,"trafficStatsInterval",void 0),w(this,"networkQualityInterval",void 0),w(this,"_joinGatewayStartTime",0),w(this,"_signalTimeout",!1),w(this,"_clientRoleOptions",void 0),w(this,"_isProactiveJoin",!1),this.store=t,this.spec=r,this.signal=this.store.useP2P?new ZM(cs(cs({},r),{},{retryConfig:r.websocketRetryConfig}),t):this.store.useDataChannel?new Jc(cs(cs({},r),{},{retryConfig:r.websocketRetryConfig}),t):new EL(cs(cs({},r),{},{retryConfig:r.websocketRetryConfig}),t),this._statsCollector=r.statsCollector,this.role=r.role||"audience",this._clientRoleOptions=r.clientRoleOptions,this.handleSignalEvents()}async join(t,r,a){if(this.signal instanceof Jc){let v=!1;t.cloudProxyServer!=="disabled"?(L.debug("[".concat(this.store.clientId,"] Dc is not supported, because cloudProxyServer are not supported (").concat(t.cloudProxyServer,")")),v=!0):"".concat(t.apResponse.cid,"_").concat(t.apResponse.cert).length>255||"".concat(t.apResponse.cid,"_").concat(t.apResponse.cert).length<22?(L.debug("[".concat(this.store.clientId,"] Dc is not supported, because ticket length is incorrect, it has to be between 22 and 255")),v=!0):t.apResponse.addresses.some(E=>E.fingerprint)||Z("FINGERPRINT")||(L.debug("[".concat(this.store.clientId,"] Dc is not supported, because fingerprint does not exist")),v=!0),v&&this.resetSignal()}this.store.joinGatewayStart(),t.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const l=Date.now();let u=XT.get(t.cname);if(u||(u=new Map,XT.set(t.cname,u)),this._isProactiveJoin=!0,u.has(t.uid)){const v=new ue(G.UID_CONFLICT);throw He.joinGateway(t.sid,{lts:l,succ:!1,ec:v.message,addr:null,uid:t.uid,cid:t.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!t.proxyServer,signalChannel:this.signal instanceof Jc?"1":"0"}),this._isProactiveJoin=!1,v}u.set(t.uid,!0),this.joinInfo=t,this.key=r;let h=0;this.joinGatewayStartTime=l;const f=t.proxyServer;try{let v;if(L.debug("[".concat(this.store.clientId,"] use ").concat(this.signal instanceof Jc?"datachannel":"websocket"," join uid ").concat(h)),this.signal instanceof Jc)v=await this.signal.init(t.apResponse.addresses,a);else{const E=t.gatewayAddrs.map(y=>{let{address:C}=y;const[I,k]=C.split(":"),W={host:I,port:k};return t.proxyServer&&(W.proxy=t.proxyServer),W});v=await this.signal.init(E,a)}h=v.uid,L.debug("[".concat(this.store.clientId,"] ").concat(this.signal instanceof Jc?"datachannel":"websocket"," join uid ").concat(h," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(v){throw v&&v.code===G.INIT_WEBSOCKET_TIMEOUT?(L.warning("[".concat(this.store.clientId,"] User join failed"),v.toString()),v):v&&v.code===G.INIT_DATACHANNEL_TIMEOUT?(L.warning("[".concat(this.store.clientId,"] User join datachannel failed"),v.toString()),this.resetSignal(),v):(L.error("[".concat(this.store.clientId,"] User join failed"),v.toString()),He.joinGateway(t.sid,{lts:l,succ:!1,ec:v.message,addr:this.signal.url,uid:t.uid,cid:t.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!f,signalChannel:this.signal instanceof Jc?"1":"0"}),this._isProactiveJoin=!1,u.delete(t.uid),this.signal.close(),v)}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),L.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(v=>{L.warning("[".concat(this.store.clientId,"] get traffic stats error"),v.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(Fn.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(Fn.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(Fn.NETWORK_QUALITY,{uplinkNetworkQuality:XM(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:XM(this._statsCollector.trafficStats.B_dnq)}):this.emit(Fn.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),h}async leave(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],r=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){r!==It.FALLBACK&&(this.state="DISCONNECTING");try{t||this.signal.connectionState!==wt.CONNECTED||await function(a,l){return l===1/0?a:me.race([a,ZQ(l)])}(this.signal.request($e.LEAVE,void 0,!0),3e3)}catch(a){L.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),a)}this.signal.close(r),r!==It.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(t,r,a){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ue(G.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const l={state:"offer",p2p_id:this.store.p2pId,ortc:r,mode:this.spec.mode,extend:Z("PUB_EXTEND"),twcc:!!Z("PUBLISH_TWCC"),rtx:!!Z("USE_PUB_RTX")};try{return(await this.signal.request($e.PUBLISH,l,!0))._message}catch(u){if(a&&u.data&&u.data.code===Xe.ERR_PUBLISH_REQUEST_INVALID)return L.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),u.toString()),await this.tryUnpubBeforeRepub(t,r),this.publish(t,r,!1);throw u}}async publishDataChannel(t,r,a){var l;if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ue(G.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const u={stream_id:r.streamId,ordered:r.ordered?1:0,max_retrans_times:(l=r.maxRetransmits)!==null&&l!==void 0?l:10,channel_id:r.channelId,metadata:r.metadata};try{await this.signal.request($e.PUBLISH_DATASTREAM,u,!0)}catch(h){if(a&&h.data&&h.data.code===Xe.ERR_PUBLISH_REQUEST_INVALID)return L.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),h.toString()),await this.tryUnpubDataChannelBeforeRepub(t,r),this.publishDataChannel(t,r,!1);throw h}}async unpublish(t,r){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ue(G.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request($e.UNPUBLISH,{stream_id:r,ortc:t},!0)}catch(a){L.warning("[".concat(this.store.clientId,"] unpublish warning: "),a)}}async unpublishDataChannel(t){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ue(G.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await me.all(t.map(r=>this.signal.request($e.UNPUBLISH_DATASTREAM,{channel_id:r},!0)))}catch(r){L.warning("unpublish datachannels warning: ",r)}}async subscribe(t,r,a){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ue(G.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const l={stream_id:t,stream_type:r.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!Z("SUBSCRIBE_TWCC"),rtx:!!Z("USE_SUB_RTX"),extend:Z("SUB_EXTEND"),ssrcId:r.ssrcId,svc:Array.isArray(Z("SVC"))&&Z("SVC").length!==0?Z("SVC"):void 0};try{return(await this.signal.request($e.SUBSCRIBE,l,!0))._message}catch(u){if(a&&u.data&&u.data.code===Xe.ERR_SUBSCRIBE_REQUEST_INVALID)return L.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),u.toString()),await this.tryUnsubBeforeResub(t,r),await this.subscribe(t,r,!1);throw u}}async subscribeDataChannel(t,r,a){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ue(G.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const l={uid:t,stream_id:r.id,channel_id:r.datachannelId};try{return void await this.signal.request($e.SUBSCRIBE_DATASTREAM,l,!0)}catch(u){if(a&&u.data&&u.data.code===Xe.ERR_SUBSCRIBE_REQUEST_INVALID)return L.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),u.toString()),await this.tryUnsubDataChannelBeforeResub(t,r),await this.subscribeDataChannel(t,r,!1);throw u}}async subscribeAll(t,r){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ue(G.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const a={p2p_id:this.store.p2pId,users:t,dtx:!1,rtx:!!Z("USE_SUB_RTX")};try{return await this.signal.request($e.SUBSCRIBE_STREAMS,a,!0)}catch(l){if(r&&l.data&&l.data.code===Xe.ERR_SUBSCRIBE_REQUEST_INVALID)return L.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),l.toString()),await this.tryMassUnsubBeforeResub(t),await this.subscribeAll(t,!1);throw l}}async setVideoProfile(t){const r=function(a){if(!(a.bitrateMax&&a.bitrateMin&&a.frameRate&&a.height&&a.width))return;let l=a.frameRate,u=a.width,h=a.height,f=!0;return typeof l!="number"&&(l=l.exact||l.ideal||l.max||l.min||0,l||(f=!1)),typeof u!="number"&&(u=u.exact||u.ideal||u.max||u.min||0,u||(f=!1)),typeof h!="number"&&(h=h.exact||h.ideal||h.max||h.min||0,l||(f=!1)),f?{stream_type:0,width:u,height:h,fps:l,start_bps:1e3*a.bitrateMax,min_bps:1e3*a.bitrateMin,target_bps:1e3*a.bitrateMax}:void 0}(t);if(r)return this.signal.request($e.SET_VIDEO_PROFILE,r);L.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(t,r){try{await this.signal.request($e.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:t,stream_id:r},!0)}catch(a){L.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),a)}}async unsubscribeDataChannel(t,r){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new ue(G.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await me.all(t.map(a=>this.signal.request($e.UNSUBSCRIBE_DATASTREAM,{stream_id:a,uid:r},!0)))}catch(a){L.warning("unsubscribeDataChannel warning: ",a)}}async massUnsubscribe(t){try{await this.signal.request($e.UNSUBSCRIBE_STREAMS,t,!0)}catch(r){L.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),r)}}async reconnectPC(t){const{iceParameters:r,dtlsParameters:a,rtpCapabilities:l}=t;return{gatewayEstablishParams:await this.signal.request($e.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:r,dtlsParameters:a,rtpCapabilities:l}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request($e.GATEWAY_INFO)}async renewToken(t){await this.signal.request($e.RENEW_TOKEN,t),this.key=t.token}async setClientRole(t,r){if(r&&(this._clientRoleOptions=Object.assign({},r)),this.state!=="CONNECTED")return void(this.role=t);let a,l=0;t==="audience"?this._clientRoleOptions&&this._clientRoleOptions.delay?(a=this._clientRoleOptions.delay,l=1):l=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:l=0,await this.signal.request($e.SET_CLIENT_ROLE,{role:t,level:l,delay:a,client_ts:Date.now()}),this.role=t}async setRemoteVideoStreamType(t,r){await this.signal.request($e.SWITCH_VIDEO_STREAM,{stream_id:t,stream_type:r})}async setDefaultRemoteVideoStreamType(t){await this.signal.request($e.DEFAULT_VIDEO_STREAM,{stream_type:t})}async setStreamFallbackOption(t,r){await this.signal.request($e.SET_FALLBACK_OPTION,{stream_id:t,fallback_type:r})}async pickSVCLayer(t,r){await this.signal.request($e.PICK_SVC_LAYER,{stream_id:t,spatial_layer:r.spatialLayer,temporal_layer:r.temporalLayer})}async setRTM2Flag(t){await this.signal.request($e.SET_RTM2_FLAG,{rtm2_flag:t})}async sendExtensionMessage(t,r,a){if(this.signal instanceof ZM)return this.signal.sendExtensionMessage(t,r,a)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),cs({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request($e.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const t=XT.get(this.joinInfo.cname);t&&t.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const t=function(r){let a;return a=r.startsWith("dc")?r.match(/(dc\:\/\/)?([^:]+):(\d+)/):r.match(/(wss\:\/\/)?([^:]+):(\d+)/),a?{username:Qo.username,password:Qo.password,turnServerURL:a[2],tcpport:parseInt(a[3])+30,udpport:parseInt(a[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],t&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(cs(cs({},Qo),{},{turnServerURL:t.turnServerURL,tcpport:t.tcpport,udpport:t.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const t=await this.signal.request($e.TRAFFIC_STATS,void 0,!0);t.timestamp=Date.now(),t.ntp_offset!=null&&(this.ntpOffset=t.ntp_offset),t.peer_delay.forEach(r=>{const a=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(l=>l.peer_uid===r.peer_uid);a&&a.B_st!==r.B_st&&ns(()=>{this.emit(Fn.STREAM_TYPE_CHANGE,r.peer_uid,r.B_st)})}),this._statsCollector.updateTrafficStats(t)}getJoinMessage(t){if(!this.joinInfo||!this.key)throw new ue(G.UNEXPECTED_ERROR,"can not generate join message, no join info");const r=Object.assign({},this.joinInfo.apResponse);let a=Z("REPORT_APP_SCENARIO");if(typeof a!="string")try{a=JSON.stringify(a)}catch{a=void 0}a&&a.length>128&&(a=void 0);const l=cs({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:Ra,browser:navigator.userAgent,process_id:Z("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:r,extend:Z("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:a,attributes:{userAttributes:{enablePublishedUserList:Z("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:Z("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:typeof Z("SUBSCRIBE_AUDIO_FILTER_TOPN")=="number"?Z("SUBSCRIBE_AUDIO_FILTER_TOPN"):void 0,enablePublishAudioFilter:typeof Z("ENABLE_PUBLISH_AUDIO_FILTER")=="boolean"?Z("ENABLE_PUBLISH_AUDIO_FILTER"):void 0,enableUserLicenseCheck:typeof Z("ENABLE_USER_LICENSE_CHECK")=="boolean"?Z("ENABLE_USER_LICENSE_CHECK"):void 0,enableRTX:Z("USE_PUB_RTX")===!0||Z("USE_SUB_RTX")===!0||void 0,disableFEC:Z("DISABLE_FEC"),enableNTPReport:!!Z("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:!!Z("ENABLE_INSTANT_VIDEO")||void 0,enableDataStream2:typeof Z("ENABLE_DATASTREAM_2")=="boolean"?Z("ENABLE_DATASTREAM_2"):void 0,rtm2Flag:typeof Z("RTM2_FLAG")=="number"?Z("RTM2_FLAG"):void 0,enableUserAutoRebalanceCheck:!!Z("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:typeof Z("USE_XR")=="boolean"?Z("USE_XR"):void 0}},join_ts:this.joinGatewayStartTime},t);return this.joinInfo.stringUid&&(l.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(l.aes_mode=this.joinInfo.aesmode,Z("ENCRYPT_AES")?(l.aes_secret=this.joinInfo.aespassword,l.aes_encrypt=!0):l.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(l.aes_salt=this.joinInfo.aessalt)),r.addresses[this.signal.websocket.currentURLIndex]&&(l.ap_response.ticket=r.addresses[this.signal.websocket.currentURLIndex].ticket,delete r.addresses),this.joinInfo.defaultVideoStream!==void 0&&(l.default_video_stream=this.joinInfo.defaultVideoStream),l}getRejoinMessage(){if(!this.joinInfo)throw new ue(G.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(Le.WS_RECONNECT_WAITTING_FINISH,t=>{var r;Ke(r=["tryNext","recover"]).call(r,t)&&this.joinInfo&&He.adjustSessionStartTime(this.joinInfo.sid)}),this.signal.on(Le.WS_RECONNECT_CREATE_CONNECTION,t=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(Le.WS_RECONNECTING,t=>{this.joinInfo&&He.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:t||Ir.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",He.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(Le.WS_CLOSED,t=>{let r;switch(t){case It.LEAVE:r=Ir.LEAVE;break;case It.UID_BANNED:case It.IP_BANNED:case It.CHANNEL_BANNED:case It.SERVER_ERROR:r=Ir.SERVER_ERROR;break;case It.FALLBACK:r=Ir.FALLBACK;break;case It.LICENSE_MISSING:case It.LICENSE_EXPIRED:case It.LICENSE_MINUTES_EXCEEDED:case It.LICENSE_PERIOD_INVALID:case It.LICENSE_MULTIPLE_SDK_SERVICE:case It.LICENSE_ILLEGAL:case It.TOKEN_EXPIRE:r=t;break;default:r=Ir.NETWORK_ERROR}L.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(r||"undefined -> "+Ir.NETWORK_ERROR)),this.joinInfo&&He.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:t===It.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:r}),this._disconnectedReason=t,t!==It.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(Le.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo&&(this.role==="audience"&&this._clientRoleOptions&&(this._clientRoleOptions.level||this._clientRoleOptions.delay)&&(L.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions.level,", delay: ").concat(this._clientRoleOptions.delay)),this.setClientRole(this.role,this._clientRoleOptions)),He.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof Jc?"1":"0"}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1)){const t=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!t)return void L.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(t));an("EVENT_REPORT_DOMAIN",t[1]),an("EVENT_REPORT_BACKUP_DOMAIN",t[1]),an("LOG_UPLOAD_SERVER","".concat(t[1],":6444"))}}),this.signal.on(lt.ON_UPLINK_STATS,t=>{this._statsCollector.updateUplinkStats(t)}),this.signal.on(Le.REQUEST_RECOVER,(t,r,a)=>{if(!this.joinInfo)return a(new ue(G.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));t&&(this.joinInfo.multiIP=t,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,Ln(this,Fn.REQUEST_NEW_GATEWAY_LIST).then(r).catch(a)}),this.signal.on(Le.REQUEST_JOIN_INFO,async t=>{var r;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void t(this.getJoinMessage({ortc:{}}));const{iceParameters:a,dtlsParameters:l,rtpCapabilities:u}=await Ln(this,Fn.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:(r=this.joinInfo)===null||r===void 0?void 0:r.turnServer});t(this.getJoinMessage({ortc:{iceParameters:a,dtlsParameters:l,rtpCapabilities:u,version:"2"}}))}),this.signal.on(Le.REQUEST_REJOIN_INFO,t=>{t(this.getRejoinMessage())}),this.signal.on(Le.REPORT_JOIN_GATEWAY,(t,r)=>{this.joinInfo&&(He.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:t,addr:r,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof Jc?"1":"0"}),this._isProactiveJoin=!1)}),this.signal.on(Le.IS_P2P_DISCONNECTED,t=>{t(zc(this,Fn.IS_P2P_DISCONNECTED))}),this.signal.on(Le.DISCONNECT_P2P,()=>{this.emit(Fn.DISCONNECT_P2P)}),this.signal.on(Le.NEED_RENEW_SESSION,()=>{this.emit(Fn.NEED_RENEW_SESSION)}),this.signal.on(Le.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(Le.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(Le.JOIN_RESPONSE,t=>{const r=this.getCurrentGatewayAddress();this.emit(Fn.JOIN_RESPONSE,t,r)}),this.signal.on(Le.DATACHANNEL_PRECONNECT,async(t,r,a)=>{this.updateTurnConfigFromSignal();const l=this.getCurrentGatewayAddress();return Ln(this,Fn.DATACHANNEL_PRECONNECT,t,l).then(r).catch(a)}),this.signal.on(Le.DATACHANNEL_CONNECTING,async t=>{const{iceParameters:r,dtlsParameters:a,rtpCapabilities:l}=await Ln(this,Fn.REQUEST_DC_CONNECTION_PARAMS);t(this.getJoinMessage({ortc:{iceParameters:r,dtlsParameters:a,rtpCapabilities:l,version:"2"}}))}),this.signal.on(Le.DATACHANNEL_FAILBACK,()=>{L.warning("[".concat(this.store.clientId,"] User join datachannel failed")),this.reset(),this.resetSignal(),this.emit(Fn.DATACHANNEL_FAILBACK)})}async tryUnsubBeforeResub(t,r){try{await this.signal.request($e.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:t,ortc:[r]},!0)}catch(a){throw L.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),a),a}}async tryUnsubDataChannelBeforeResub(t,r){try{await this.signal.request($e.UNSUBSCRIBE,{stream_id:r.id},!0)}catch(a){throw L.warning("unsubscribe datachannel warning",a),a}}async tryUnpubBeforeRepub(t,r){try{await this.signal.request($e.UNPUBLISH,{stream_id:t,ortc:r},!0)}catch(a){throw L.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),a),a}}async tryUnpubDataChannelBeforeRepub(t,r){try{await this.signal.request($e.UNPUBLISH_DATASTREAM,{channnel_id:r.channelId},!0)}catch(a){throw L.warning("unpublish datastream warning: ",a),a}}async tryMassUnsubBeforeResub(t){const r={users:t.map(a=>({stream_id:a.stream_id,stream_type:a.stream_type}))};try{await this.signal.request($e.UNSUBSCRIBE_STREAMS,r,!0)}catch(a){throw L.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),a),a}}async muteLocal(t,r){const a={action:t.find(l=>l.stream_type===rn.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:t,stream_id:r};try{await this.signal.request($e.CONTROL,a,!0,!0)}catch(l){throw L.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),l),l}}async unmuteLocal(t,r){const a={action:t.find(l=>l.stream_type===rn.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:t,stream_id:r};try{await this.signal.request($e.CONTROL,a,!0,!0)}catch(l){throw L.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),l),l}}async muteRemote(t,r){const a={action:t===Ue.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:r};try{await this.signal.request($e.CONTROL,a,!0,!0)}catch(l){throw L.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),l),l}}async unmuteRemote(t,r){const a={action:t===Ue.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:r};try{await this.signal.request($e.CONTROL,a,!0,!0)}catch(l){throw L.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),l),l}}uploadStats(t,r){this.signal.upload(t,r)}getSignalRTT(){return this.signal.rtt}async restartICE(t){const r={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:t};try{return await this.signal.request($e.RESTART_ICE,r,!0)}catch(a){throw L.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),a),a}}reconnect(){this.state==="CONNECTED"&&this.signal.reconnect(void 0,Ir.P2P_FAILED)}getCurrentGatewayAddress(){var t;if(!Z("GATEWAY_WSS_ADDRESS"))return(t=this.joinInfo)!==null&&t!==void 0&&t.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(t){await this.signal.request($e.SET_PARAMETER,{enablePublishAudioFilter:t})}resetSignal(){this.signal&&(this.signal.removeAllListeners(),this.signal.close(It.FALLBACK)),this.store.useDataChannel=!1,this.signal=new EL(cs(cs({},this.spec),{},{retryConfig:this.spec.websocketRetryConfig}),this.store),this.handleSignalEvents(),this.emit(Fn.RESET_SIGNAL,dv.websocket)}}let Hv=0,JT=0;function Qc(i,t,r,a){return new me((l,u)=>{t.timeout=t.timeout||Z("HTTP_CONNECT_TIMEOUT"),t.responseType=t.responseType||"json",t.data&&!r?(t.data=JSON.stringify(t.data),Hv+=mc(t.data)):r&&(t.data.size?Hv+=t.data.size:t.data instanceof FormData?Hv+=Kk(t.data):Hv+=mc(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=i,go.request(t).then(h=>{typeof h.data=="string"?JT+=mc(h.data):h.data instanceof ArrayBuffer||h.data instanceof Uint8Array?JT+=h.data.byteLength:JT+=mc(JSON.stringify(h.data)),a&&l({data:h.data,headers:h.headers}),l(h.data)}).catch(h=>{go.isCancel(h)?u(new ue(G.OPERATION_ABORTED,"cancel token canceled")):h.code==="ECONNABORTED"?u(new ue(G.NETWORK_TIMEOUT,h.message)):h.response?u(new ue(G.NETWORK_RESPONSE_ERROR,h.response.status)):u(new ue(G.NETWORK_ERROR,h.message))})})}/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */(function(){var i;function t(Ie){var xe=0;return function(){return xe<Ie.length?{done:!1,value:Ie[xe++]}:{done:!0}}}var r=typeof Object.defineProperties=="function"?Object.defineProperty:function(Ie,xe,Be){return Ie==Array.prototype||Ie==Object.prototype||(Ie[xe]=Be.value),Ie},a,l=function(Ie){Ie=[typeof globalThis=="object"&&globalThis,Ie,typeof window=="object"&&window,typeof self=="object"&&self,typeof Tt=="object"&&Tt];for(var xe=0;xe<Ie.length;++xe){var Be=Ie[xe];if(Be&&Be.Math==Math)return Be}throw Error("Cannot find global object")}(this);function u(Ie,xe){if(xe)e:{var Be=l;Ie=Ie.split(".");for(var at=0;at<Ie.length-1;at++){var Gt=Ie[at];if(!(Gt in Be))break e;Be=Be[Gt]}(xe=xe(at=Be[Ie=Ie[Ie.length-1]]))!=at&&xe!=null&&r(Be,Ie,{configurable:!0,writable:!0,value:xe})}}function h(Ie){return(Ie={next:Ie})[Symbol.iterator]=function(){return this},Ie}function f(Ie){var xe=typeof Symbol<"u"&&Symbol.iterator&&Ie[Symbol.iterator];return xe?xe.call(Ie):{next:t(Ie)}}if(u("Symbol",function(Ie){function xe(Gt,Pe){this.A=Gt,r(this,"description",{configurable:!0,writable:!0,value:Pe})}if(Ie)return Ie;xe.prototype.toString=function(){return this.A};var Be="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",at=0;return function Gt(Pe){if(this instanceof Gt)throw new TypeError("Symbol is not a constructor");return new xe(Be+(Pe||"")+"_"+at++,Pe)}}),u("Symbol.iterator",function(Ie){if(Ie)return Ie;Ie=Symbol("Symbol.iterator");for(var xe="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Be=0;Be<xe.length;Be++){var at=l[xe[Be]];typeof at=="function"&&typeof at.prototype[Ie]!="function"&&r(at.prototype,Ie,{configurable:!0,writable:!0,value:function(){return h(t(this))}})}return Ie}),typeof Object.setPrototypeOf=="function")a=Object.setPrototypeOf;else{var v;e:{var E={};try{E.__proto__={a:!0},v=E.a;break e}catch{}v=!1}a=v?function(Ie,xe){if(Ie.__proto__=xe,Ie.__proto__!==xe)throw new TypeError(Ie+" is not extensible");return Ie}:null}var y=a;function C(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function I(Ie){if(Ie.m)throw new TypeError("Generator is already running");Ie.m=!0}function k(Ie,xe){return Ie.h=3,{value:xe}}function W(Ie){this.g=new C,this.G=Ie}function $(Ie,xe,Be,at){try{var Gt=xe.call(Ie.g.j,Be);if(!(Gt instanceof Object))throw new TypeError("Iterator result "+Gt+" is not an object");if(!Gt.done)return Ie.g.m=!1,Gt;var Pe=Gt.value}catch(U){return Ie.g.j=null,Ie.g.s(U),z(Ie)}return Ie.g.j=null,at.call(Ie.g,Pe),z(Ie)}function z(Ie){for(;Ie.g.h;)try{var xe=Ie.G(Ie.g);if(xe)return Ie.g.m=!1,{value:xe.value,done:!1}}catch(Be){Ie.g.v=void 0,Ie.g.s(Be)}if(Ie.g.m=!1,Ie.g.l){if(xe=Ie.g.l,Ie.g.l=null,xe.F)throw xe.D;return{value:xe.return,done:!0}}return{value:void 0,done:!0}}function X(Ie){this.next=function(xe){return Ie.o(xe)},this.throw=function(xe){return Ie.s(xe)},this.return=function(xe){return function(Be,at){I(Be.g);var Gt=Be.g.j;return Gt?$(Be,"return"in Gt?Gt.return:function(Pe){return{value:Pe,done:!0}},at,Be.g.return):(Be.g.return(at),z(Be))}(Ie,xe)},this[Symbol.iterator]=function(){return this}}function ie(Ie,xe){return xe=new X(new W(xe)),y&&Ie.prototype&&y(xe,Ie.prototype),xe}if(C.prototype.o=function(Ie){this.v=Ie},C.prototype.s=function(Ie){this.l={D:Ie,F:!0},this.h=this.C||this.u},C.prototype.return=function(Ie){this.l={return:Ie},this.h=this.u},W.prototype.o=function(Ie){return I(this.g),this.g.j?$(this,this.g.j.next,Ie,this.g.o):(this.g.o(Ie),z(this))},W.prototype.s=function(Ie){return I(this.g),this.g.j?$(this,this.g.j.throw,Ie,this.g.o):(this.g.s(Ie),z(this))},u("Array.prototype.entries",function(Ie){return Ie||function(){return function(xe,Be){xe instanceof String&&(xe+="");var at=0,Gt=!1,Pe={next:function(){if(!Gt&&at<xe.length){var U=at++;return{value:Be(U,xe[U]),done:!1}}return Gt=!0,{done:!0,value:void 0}}};return Pe[Symbol.iterator]=function(){return Pe},Pe}(this,function(xe,Be){return[xe,Be]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var oe=function(Ie,xe){for(var Be=0;Be<Ie.length;Be++)xe(Ie[Be])},Re=function(Ie){return Ie.replace(/\r?\n|\r/g,`\r
`)},Ce=function(Ie,xe,Be){return xe instanceof Blob?(Be=Be!==void 0?Be+"":typeof xe.name=="string"?xe.name:"blob",xe.name===Be&&Object.prototype.toString.call(xe)!=="[object Blob]"||(xe=new File([xe],Be)),[String(Ie),xe]):[String(Ie),String(xe)]},ge=function(Ie,xe){if(Ie.length<xe)throw new TypeError(xe+" argument required, but only "+Ie.length+" present.")},_e=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,Se=_e.FormData,De=_e.XMLHttpRequest&&_e.XMLHttpRequest.prototype.send,Ne=_e.Request&&_e.fetch,vt=_e.navigator&&_e.navigator.sendBeacon,Ft=_e.Element&&_e.Element.prototype,Bn=_e.Symbol&&Symbol.toStringTag;Bn&&(Blob.prototype[Bn]||(Blob.prototype[Bn]="Blob"),"File"in _e&&!File.prototype[Bn]&&(File.prototype[Bn]="File"));try{new File([],"")}catch{_e.File=function(xe,Be,at){return xe=new Blob(xe,at||{}),Object.defineProperties(xe,{name:{value:Be},lastModified:{value:+(at&&at.lastModified!==void 0?new Date(at.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),Bn&&Object.defineProperty(xe,Bn,{value:"File"}),xe}}var fr=function(Ie){return Ie.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},bn=function(Ie){this.i=[];var xe=this;Ie&&oe(Ie.elements,function(Be){if(Be.name&&!Be.disabled&&Be.type!=="submit"&&Be.type!=="button"&&!Be.matches("form fieldset[disabled] *"))if(Be.type==="file"){var at=Be.files&&Be.files.length?Be.files:[new File([],"",{type:"application/octet-stream"})];oe(at,function(Gt){xe.append(Be.name,Gt)})}else Be.type==="select-multiple"||Be.type==="select-one"?oe(Be.options,function(Gt){!Gt.disabled&&Gt.selected&&xe.append(Be.name,Gt.value)}):Be.type==="checkbox"||Be.type==="radio"?Be.checked&&xe.append(Be.name,Be.value):(at=Be.type==="textarea"?Re(Be.value):Be.value,xe.append(Be.name,at))})};if((i=bn.prototype).append=function(Ie,xe,Be){ge(arguments,2),this.i.push(Ce(Ie,xe,Be))},i.delete=function(Ie){ge(arguments,1);var xe=[];Ie=String(Ie),oe(this.i,function(Be){Be[0]!==Ie&&xe.push(Be)}),this.i=xe},i.entries=function Ie(){var xe,Be=this;return ie(Ie,function(at){if(at.h==1&&(xe=0),at.h!=3)return xe<Be.i.length?at=k(at,Be.i[xe]):(at.h=0,at=void 0),at;xe++,at.h=2})},i.forEach=function(Ie,xe){ge(arguments,1);for(var Be=f(this),at=Be.next();!at.done;at=Be.next()){var Gt=f(at.value);at=Gt.next().value,Gt=Gt.next().value,Ie.call(xe,Gt,at,this)}},i.get=function(Ie){ge(arguments,1);var xe=this.i;Ie=String(Ie);for(var Be=0;Be<xe.length;Be++)if(xe[Be][0]===Ie)return xe[Be][1];return null},i.getAll=function(Ie){ge(arguments,1);var xe=[];return Ie=String(Ie),oe(this.i,function(Be){Be[0]===Ie&&xe.push(Be[1])}),xe},i.has=function(Ie){ge(arguments,1),Ie=String(Ie);for(var xe=0;xe<this.i.length;xe++)if(this.i[xe][0]===Ie)return!0;return!1},i.keys=function Ie(){var xe,Be,at,Gt,Pe=this;return ie(Ie,function(U){if(U.h==1&&(xe=f(Pe),Be=xe.next()),U.h!=3)return Be.done?void(U.h=0):(at=Be.value,Gt=f(at),k(U,Gt.next().value));Be=xe.next(),U.h=2})},i.set=function(Ie,xe,Be){ge(arguments,2),Ie=String(Ie);var at=[],Gt=Ce(Ie,xe,Be),Pe=!0;oe(this.i,function(U){U[0]===Ie?Pe&&(Pe=!at.push(Gt)):at.push(U)}),Pe&&at.push(Gt),this.i=at},i.values=function Ie(){var xe,Be,at,Gt,Pe=this;return ie(Ie,function(U){if(U.h==1&&(xe=f(Pe),Be=xe.next()),U.h!=3)return Be.done?void(U.h=0):(at=Be.value,(Gt=f(at)).next(),k(U,Gt.next().value));Be=xe.next(),U.h=2})},bn.prototype._asNative=function(){for(var Ie=new Se,xe=f(this),Be=xe.next();!Be.done;Be=xe.next()){var at=f(Be.value);Be=at.next().value,at=at.next().value,Ie.append(Be,at)}return Ie},bn.prototype._blob=function(){var Ie="----formdata-polyfill-"+Math.random(),xe=[],Be="--"+Ie+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(at,Gt){return typeof at=="string"?xe.push(Be+fr(Re(Gt))+`"\r
\r
`+Re(at)+`\r
`):xe.push(Be+fr(Re(Gt))+'"; filename="'+fr(at.name)+`"\r
Content-Type: `+(at.type||"application/octet-stream")+`\r
\r
`,at,`\r
`)}),xe.push("--"+Ie+"--"),new Blob(xe,{type:"multipart/form-data; boundary="+Ie})},bn.prototype[Symbol.iterator]=function(){return this.entries()},bn.prototype.toString=function(){return"[object FormData]"},Ft&&!Ft.matches&&(Ft.matches=Ft.matchesSelector||Ft.mozMatchesSelector||Ft.msMatchesSelector||Ft.oMatchesSelector||Ft.webkitMatchesSelector||function(Ie){for(var xe=(Ie=(this.document||this.ownerDocument).querySelectorAll(Ie)).length;0<=--xe&&Ie.item(xe)!==this;);return-1<xe}),Bn&&(bn.prototype[Bn]="FormData"),De){var Mo=_e.XMLHttpRequest.prototype.setRequestHeader;_e.XMLHttpRequest.prototype.setRequestHeader=function(Ie,xe){Mo.call(this,Ie,xe),Ie.toLowerCase()==="content-type"&&(this.B=!0)},_e.XMLHttpRequest.prototype.send=function(Ie){Ie instanceof bn?(Ie=Ie._blob(),this.B||this.setRequestHeader("Content-Type",Ie.type),De.call(this,Ie)):De.call(this,Ie)}}Ne&&(_e.fetch=function(Ie,xe){return xe&&xe.body&&xe.body instanceof bn&&(xe.body=xe.body._blob()),Ne.call(this,Ie,xe)}),vt&&(_e.navigator.sendBeacon=function(Ie,xe){return xe instanceof bn&&(xe=xe._asNative()),vt.call(this,Ie,xe)}),_e.FormData=bn}})();const Wv=()=>{const i=Z("AREAS");return i.length===0&&i.push(Vt.GLOBAL),Qu(i).call(i,(t,r,a)=>{const l=tF(r);return l?a===0?l:"".concat(t,",").concat(l):t},"")},tF=i=>i===Vt.OVERSEA?"".concat(Gr.ASIA,",").concat(Gr.EUROPE,",").concat(Gr.AFRICA,",").concat(Gr.NORTH_AMERICA,",").concat(Gr.SOUTH_AMERICA,",").concat(Gr.OCEANIA):Gr[i],qte=i=>{const t={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return i.map(r=>{const a=hv[r],l=Object.keys(a);l&&l.map(u=>{u!=="CODE"&&(t[u]=t[u].concat(a[u]))})}),t},zv={GLOBAL:{ASIA:[Vt.CHINA,Vt.JAPAN,Vt.INDIA,Vt.KOREA,Vt.HKMC],EUROPE:[],NORTH_AMERICA:[Vt.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},Gv=Object.keys(zv[Vt.GLOBAL]),QT=[Vt.CHINA,Vt.NORTH_AMERICA,Vt.EUROPE,Vt.ASIA,Vt.JAPAN,Vt.INDIA,Vt.OCEANIA,Vt.SOUTH_AMERICA,Vt.AFRICA,Vt.KOREA,Vt.HKMC,Vt.US],Yte=function(i,t){let r=[];if(Ke(i).call(i,Vt.GLOBAL)){const u=[Vt.GLOBAL,Vt.OVERSEA],h=Object.keys(hv);if(t===Vt.GLOBAL)throw new ue(G.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(t===Vt.CHINA)r=[Vt.OVERSEA];else if(l=t,Ke(Gv).call(Gv,l)){const f=(a=t,zv[Vt.GLOBAL][a]||[]),v=[...u,t,...f];r=h.filter(E=>!Ke(v).call(v,E))}else if(function(f){let v=!1;return Gv.forEach(E=>{var y;Ke(y=zv[Vt.GLOBAL][E]).call(y,f)&&(v=!0)}),v}(t)){const f=function(E){let y;return Gv.forEach(C=>{var I;Ke(I=zv[Vt.GLOBAL][C]).call(I,E)&&(y=C)}),y}(t),v=[...u,f,t];r=h.filter(E=>!Ke(v).call(v,E))}else r=i;r=function(f){const v=[];return QT.forEach(E=>{Ke(f).call(f,E)&&v.push(E)}),v.concat(f.filter(E=>!Ke(QT).call(QT,E)))}(r)}else r=i;var a,l;return r};function nF(i){var t,r;if(!i&&Ke(t=Z("AREAS")).call(t,Vt.EXTENSIONS))return L.debug("update area from ap : reset"),void ZT(qZ,!0);if(!Ke(r=Z("AREAS")).call(r,Vt.GLOBAL)||!i)return;let a=hv.EXTENSIONS;a&&(a={CODE:tF(Vt.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(i,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(i,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(i,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(i,".agora.io"),"cds-ap-web-2-".concat(i,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(i,".agora.io"),"sua-ap-web-2-".concat(i,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(i,".agora.io"),"uap-ap-web-2-".concat(i,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(i,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(i,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(i,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(i,".agora.io")]},L.debug("update area from ap success: ".concat(i,",config is "),a),an("AREAS",[Vt.EXTENSIONS],!0),Object.keys(a).map(l=>{l==="LOG_UPLOAD_SERVER"||l==="EVENT_REPORT_DOMAIN"||l==="EVENT_REPORT_BACKUP_DOMAIN"||l==="PROXY_SERVER_TYPE3"?an(l,a[l][0]):an(l,a[l])}))}function ZT(i){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=He.reportApiInvoke(null,{name:hr.SET_AREA,options:i,tag:Dn.TRACER});try{let a=[];if(typeof i=="string"&&(a=[i]),Array.isArray(i)&&(i.forEach(u=>{if(!Ke(sL).call(sL,u))throw new ue(G.INVALID_PARAMS,"invalid area code")}),a=i),Object.prototype.toString.call(i)==="[object Object]"){const{areaCode:u,excludedArea:h}=i;if(!u)throw new ue(G.INVALID_PARAMS,"area code is needed");let f=u;typeof u=="string"&&(f=[u]),a=h?Yte(f,h):f}if(!t){if(Fl.AREAS){const u=new ue(G.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return r.onError(u),void L.warning("setArea is prohibited because of config-distribute")}if(Ke(a).call(a,Vt.GLOBAL)&&Z("AREAS")===Vt.EXTENSIONS){const u=new ue(G.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return r.onError(u),void L.warning("setArea is prohibited because of ap extensions")}}an("AREAS",a,t);const l=qte(a);Object.keys(l).map(u=>{u==="LOG_UPLOAD_SERVER"||u==="EVENT_REPORT_DOMAIN"||u==="EVENT_REPORT_BACKUP_DOMAIN"||u==="PROXY_SERVER_TYPE3"?an(u,l[u][0]):an(u,l[u])}),L.debug("set area success:",a.join(","))}catch(a){throw r.onError(a),a}r.onSuccess()}function rF(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function eR(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rF(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):rF(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}let tR=1;function Xte(i,t,r,a,l){tR+=1;const u={sid:r.sid,command:"convergeAllocateEdge",uid:"666",appId:r.appId,ts:Math.floor(Date.now()/1e3),seq:tR,requestId:tR,version:Ra,cname:r.cname},h={service_name:t,json_body:JSON.stringify(u)};let f,v,E=i[0];return Ls(async()=>{f=Date.now();const y=await Qc(E,{data:h,cancelToken:a,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(v=Date.now()-f,y.code!==0){const k=new ue(G.UNEXPECTED_RESPONSE,"live streaming ap error, code"+y.code,{retry:!0,responseTime:v});throw L.error(k.toString()),k}const C=JSON.parse(y.json_body);if(C.code!==200){const k=new ue(G.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(C.code,", reason: ").concat(C.reason),{code:C.code,responseTime:v});throw L.error(k.toString()),k}if(!C.servers||C.servers.length===0){const k=new ue(G.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:C.code,responseTime:v});throw L.error(k.toString()),k}const I=function(k,W){return{addressList:k.servers.map($=>"wss://".concat($.address.replace(/\./g,"-"),".").concat(Z("WORKER_DOMAIN"),":").concat($.wss,"?serviceName=").concat(encodeURIComponent(W))),workerToken:k.workerToken,vid:k.vid}}(C,t);return Z("LIVE_STREAMING_ADDRESS")&&(I.addressList=Z("LIVE_STREAMING_ADDRESS")instanceof Array?Z("LIVE_STREAMING_ADDRESS"):[Z("LIVE_STREAMING_ADDRESS")]),eR(eR({},I),{},{responseTime:v})},(y,C)=>(He.apworkerEvent(r.sid,{success:!0,sc:200,serviceName:t,responseDetail:JSON.stringify(y.addressList),firstSuccess:C===0,responseTime:v,serverIp:i[C%i.length]}),!1),(y,C)=>(He.apworkerEvent(r.sid,{success:!1,sc:y.data&&y.data.code||200,serviceName:t,responseTime:v,serverIp:i[C%i.length]}),!!(y.code!==G.OPERATION_ABORTED&&y.code!==G.UNEXPECTED_RESPONSE||y.data&&y.data.retry)&&(E=i[(C+1)%i.length],!0)),l)}let nR=1;function iF(i,t,r,a){let{url:l,areaCode:u}=i;const h=Date.now();let f;const[v,E]=cF(t,u,[Fr.CHOOSE_SERVER]);let y=or.networkState;return Ls(async()=>{y&&or.networkState===Li.OFFLINE&&or.onlineWaiter&&await me.race([or.onlineWaiter,ni(a&&a.maxRetryTimeout||sr.maxRetryTimeout)]),y=or.networkState;const{data:C,headers:I}=await Qc(l,{data:v,cancelToken:r,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);f=I.http3==="1"?1:-1,He.reportResourceTiming(l,t.sid),aF(C,l,t,h,[Fr.CHOOSE_SERVER],f);const k=qT(C,Fr.CHOOSE_SERVER);return sF(k),qM(k,l)},C=>(C&&He.joinChooseServer(t.sid,{lts:h,succ:!0,csAddr:l,opid:E,serverList:C.gatewayAddrs.map(I=>I.address),ec:null,cid:C.cid.toString(),uid:C.uid.toString(),csIp:C.csIp,unilbsServerIds:[Fr.CHOOSE_SERVER].toString(),isHttp3:f}),!1),C=>C.code!==G.OPERATION_ABORTED&&(C.code===G.CAN_NOT_GET_GATEWAY_SERVER?C.data.retry:(He.joinChooseServer(t.sid,{lts:h,succ:!1,csAddr:l,serverList:null,opid:E,ec:C.code,csIp:C.data&&C.data.csIp,unilbsServerIds:[Fr.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:y}),isHttp3:f}),L.warning("[".concat(t.clientId,"] Choose server network error, retry"),C),!0)),a)}function oF(i,t,r,a){let l,{url:u,areaCode:h,serviceIds:f}=i;const v=Date.now(),[E,y]=cF(t,h,f);let C;return Ls(async()=>{C&&or.networkState===Li.OFFLINE&&or.onlineWaiter&&await me.race([or.onlineWaiter,ni(a&&a.maxRetryTimeout||sr.maxRetryTimeout)]),C=or.networkState;const{data:I,headers:k}=await Qc(u,{data:E,cancelToken:r,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);l=k.http3==="1"?1:-1,He.reportResourceTiming(u,t.sid),aF(I,u,t,v,f,l);const W=qT(I,Fr.CHOOSE_SERVER),$=qT(I,t.cloudProxyServer==="proxy5"?Fr.CLOUD_PROXY_5:t.cloudProxyServer==="proxy3"||t.cloudProxyServer==="proxy4"?Fr.CLOUD_PROXY:Fr.CLOUD_PROXY_FALLBACK);return sF(W),{gatewayInfo:qM(W,u),proxyInfo:$,url:u}},I=>(I.gatewayInfo&&He.joinChooseServer(t.sid,{lts:v,succ:!0,csAddr:u,serverList:I.gatewayInfo.gatewayAddrs.map(k=>k.address),ec:null,opid:y,cid:I.gatewayInfo.cid.toString(),uid:I.gatewayInfo.uid.toString(),csIp:I.gatewayInfo.csIp,unilbsServerIds:f.toString(),isHttp3:l}),I.proxyInfo&&He.joinWebProxyAP(t.sid,{lts:v,sucess:1,apServerAddr:u,turnServerAddrList:I.proxyInfo.addresses.map(k=>k.ip).join(","),errorCode:null,eventType:t.cloudProxyServer,unilbsServerIds:f.toString()}),!1),I=>I.code!==G.OPERATION_ABORTED&&(I.code===G.CAN_NOT_GET_GATEWAY_SERVER?I.data.retry:(He.joinWebProxyAP(t.sid,{lts:v,sucess:0,apServerAddr:u,turnServerAddrList:null,errorCode:I.code,eventType:t.cloudProxyServer,unilbsServerIds:f.toString(),extend:JSON.stringify({networkState:C})}),L.warning("[".concat(t.clientId,"] multi unilbs network error, retry"),I),!0)),a)}const aF=(i,t,r,a,l,u)=>{const h=[],f=v=>{v.flag===4096?He.joinChooseServer(r.sid,{lts:a,succ:!1,csAddr:t,opid:i.opid,serverList:null,ec:v.error.message,csIp:v.error.data&&v.error.data.csIp,unilbsServerIds:l.toString(),isHttp3:u}):v.flag!==1048576&&v.flag!==4194304&&v.flag!==4194310||He.joinWebProxyAP(r.sid,{lts:a,sucess:0,apServerAddr:t,turnServerAddrList:null,errorCode:v.error.code,eventType:r.cloudProxyServer,unilbsServerIds:l.toString()})};if(i.response_body.forEach(v=>{const E=v.buffer.code;if(v.uri===23&&E===0&&!v.buffer.edges_services)if(v.buffer.flag===4194310)L.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),v.buffer.edges_services=[];else{const y={error:new ue(G.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:i.detail[502]}),flag:v.buffer.flag};h.push(y),f(y)}if(E!==0){const y=fv(E),C={error:new ue(G.CAN_NOT_GET_GATEWAY_SERVER,y.desc,{desc:y.desc,retry:y.retry,csIp:i.detail[502]}),flag:v.buffer.flag};v.buffer.flag===4194310?L.warning(C.error.toString()):h.push(C),f(C)}}),h.length)throw L.warning("[".concat(r.clientId,"] multi unilbs ").concat(t," failed, ").concat(h.map(v=>"flag: ".concat(v.flag,", message: ").concat(v.error.message,", retry: ").concat(v.error.data.retry)).join(" | "))),new ue(G.CAN_NOT_GET_GATEWAY_SERVER,h.map(v=>"flag: ".concat(v.flag,", message: ").concat(v.error.message)).join(" | "),{retry:!!h.find(v=>v.error.data.retry),csIp:i.detail[502],desc:[...new Set(h.map(v=>{var E;return v==null||(E=v.error)===null||E===void 0||(E=E.data)===null||E===void 0?void 0:E.desc}).filter(v=>!!v))]})},sF=i=>{var t,r,a,l;if(i.addresses&&i.addresses.length===0&&i.code===0)throw new ue(G.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:i.detail&&i.detail[502]});if(Z("AP_AREA")&&((a=i.detail)!==null&&a!==void 0&&a[23]&&typeof((l=i.detail)===null||l===void 0?void 0:l[23])=="string"?nF(i.detail[23].toLowerCase()):nF()),(t=i.detail)!==null&&t!==void 0&&t[19]&&typeof((r=i.detail)===null||r===void 0?void 0:r[19])=="string"){const h=i.detail[19],f=h==null?void 0:h.split(";");for(let v=0;v<f.length;v++){var u;const E=cT(u=f[v]).call(u);i.addresses[v]&&f&&(i.addresses[v].fingerprint=E)}}if(Z("GATEWAY_ADDRESS")&&Z("GATEWAY_ADDRESS").length>0){L.debug("assign gateway address to",Z("GATEWAY_ADDRESS"));const h=Z("GATEWAY_ADDRESS").map(f=>{var v,E;const y=(v=(E=i.addresses.find(C=>C.ip===f.ip&&C.port===f.port))===null||E===void 0?void 0:E.fingerprint)!==null&&v!==void 0?v:"";return{ip:f.ip,port:f.port,ticket:i.addresses[0]&&i.addresses[0].ticket,fingerprint:y}});i.addresses=h}},Jte=(i,t)=>{if(i.response_body&&i.response_body.length){const r=i.response_body[0];if(r.buffer.code!==0){const a=fv(r.buffer.code);throw new ue(G.UPDATE_TICKET_FAILED,"[".concat(r.buffer.code,"]: ").concat(a.desc),{retry:a.retry})}return r.buffer.ticket}throw L.debug("update ticket request received ap response without response body:",t),new ue(G.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},cF=(i,t,r)=>{const a=Math.floor(Math.random()*1e12),l={appid:i.appId,client_ts:Date.now(),opid:a,sid:i.sid,request_bodies:[{uri:22,buffer:{cname:i.cname,detail:eR({6:i.stringUid,11:t,12:Z("USE_NEW_TOKEN")?"1":void 0,22:t},Z("AP_RTM")?{26:"RTM2"}:{}),key:i.token,service_ids:r,uid:i.uid||0}}]};l.request_bodies.forEach(h=>{i.multiIP&&i.multiIP.gateway_ip&&(h.buffer.detail[5]=JSON.stringify({vocs_ip:[i.multiIP.uni_lbs_ip],vos_ip:[i.multiIP.gateway_ip]}))});const u=new FormData;return u.append("request",JSON.stringify(l)),[u,a]},Qte=(i,t)=>{const r=Math.floor(Math.random()*1e12),a={appid:i.appId,client_ts:Date.now(),opid:r,sid:i.sid,request_bodies:[{uri:28,buffer:{cname:i.cname,detail:{1:"",6:i.stringUid,12:"1"},token:i.token,service_ids:t,uid:i.uid||0,edges_services:i.apResponse.addresses.map(u=>({ip:u.ip,port:u.port}))}}]},l=new FormData;return l.append("request",JSON.stringify(a)),[l,r]};let Gh=0;function Kh(i){return me.all(i.map(t=>t.then(r=>{throw r},r=>r))).then(t=>{throw t},t=>t)}const m0=async i=>{let{fragementLength:t,referenceList:r,asyncMapHandler:a,allFailedhandler:l,promisesCollector:u}=i,h=0;const f=t;let v,E=0;const y=async()=>{const C=(()=>{const I=h*f,k=I+f;return r.slice(I,k).map(a)})();u&&u.push(...C);try{v=await Kh(C)}catch(I){if(E+=f,h++,!(E>=r.length))return void await y();l(I)}C.forEach(I=>I.cancel())};return await y(),v};async function rR(i,t,r,a){return{gatewayInfo:await async function(u,h,f,v){let E=null;const y=[],C=async()=>{const k=Z("WEBCS_DOMAIN").slice(0,Z("AJAX_REQUEST_CONCURRENT")).map(z=>({url:u.proxyServer?"https://".concat(u.proxyServer,"/ap/?url=").concat(z+"/api/v2/transpond/webrtc?v=2"):"https://".concat(z,"/api/v2/transpond/webrtc?v=2"),areaCode:Wv()})),W=v.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:k.map(z=>z.url)}),$=await m0({fragementLength:Z("FRAGEMENT_LENGTH"),referenceList:k,asyncMapHandler:z=>(L.debug("[".concat(u.clientId,"] Connect to choose_server:"),z.url),iF(z,u,h,f)),allFailedhandler:z=>{throw v.recordJoinChannelService({endTs:Date.now(),status:"error",errors:z},W),z[0]},promisesCollector:y});return v.recordJoinChannelService({endTs:Date.now(),status:"success"},W),$},I=async()=>{if(await ni(1e3),E!==null)return E;const k=Z("WEBCS_DOMAIN_BACKUP_LIST").map(z=>({url:u.proxyServer?"https://".concat(u.proxyServer,"/ap/?url=").concat(z+"/api/v2/transpond/webrtc?v=2"):"https://".concat(z,"/api/v2/transpond/webrtc?v=2"),areaCode:Wv()})),W=v.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:k.map(z=>z.url)}),$=await m0({fragementLength:Z("FRAGEMENT_LENGTH"),referenceList:k,asyncMapHandler:z=>(L.debug("[".concat(u.clientId,"] Connect to backup choose_server:"),z.url),iF(z,u,h,f)),allFailedhandler:z=>{throw v.recordJoinChannelService({endTs:Date.now(),status:"error",errors:z},W),z[0]},promisesCollector:y});return v.recordJoinChannelService({endTs:Date.now(),status:"success"},W),$};try{return E=await Kh([C(),I()]),y.length&&y.forEach(k=>k.cancel&&typeof k.cancel=="function"&&k.cancel()),E}catch(k){throw k[0]}}(i,t,r,a)}}async function lF(i,t,r,a,l){const u=i.cloudProxyServer;if(u==="disabled"){if(!a)return;if(i.useLocalAccessPoint)return await rR(i,t,r,l);if(Z("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:E,proxyInfo:y}=await dF(i,t,r,l);return i.turnServer&&i.turnServer.mode!=="auto"||(i.turnServer={mode:"manual",servers:y.map(C=>({turnServerURL:C.address,tcpport:C.tcpport||Qo.tcpport,udpport:C.udpport||Qo.udpport,username:C.username||Qo.username,password:C.password||Qo.password,forceturn:!1,security:!0}))}),{gatewayInfo:E}}return await rR(i,t,r,l)}const{proxyInfo:h,gatewayInfo:f}=await dF(i,t,r,l),v={gatewayInfo:f};return i.turnServer={mode:"manual",servers:h.map(E=>({turnServerURL:E.address,tcpport:u==="proxy3"?void 0:E.tcpport?E.tcpport:Qo.tcpport,udpport:u==="proxy4"?void 0:E.udpport?E.udpport:Qo.udpport,username:E.username||Qo.username,password:E.password||Qo.password,forceturn:u!=="proxy4",security:u==="proxy5"}))},L.debug("[".concat(i.clientId,"] set proxy server: ").concat(i.proxyServer,", mode: ").concat(u)),v}async function uF(i,t,r,a,l){const u=Z("ACCOUNT_REGISTER").slice(0,Z("AJAX_REQUEST_CONCURRENT"));let h=[];h=t.proxyServer?u.map(v=>"https://".concat(t.proxyServer,"/ap/?url=").concat(v+"/api/v1")):u.map(v=>"https://".concat(v,"/api/v1"));const f=l==null?void 0:l.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:h});try{const v=await async function(E,y,C,I,k){const W=Date.now(),$={sid:C.sid,opid:10,appid:C.appId,string_uid:y};let z=E[0];const X=await Ls(()=>Qc(z+"".concat(z.indexOf("?")===-1?"?":"&","action=stringuid"),{data:$,cancelToken:I,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(ie,oe)=>{if(ie.code===0){if(ie.uid<=0||ie.uid>=Math.pow(2,32))throw L.error("Invalid Uint Uid ".concat(y," => ").concat(ie.uid),ie),He.reqUserAccount($.sid,{lts:W,success:!1,serverAddr:z,stringUid:$.string_uid,uid:ie.uid,errorCode:G.INVALID_UINT_UID_FROM_STRING_UID,extend:$}),new ue(G.INVALID_UINT_UID_FROM_STRING_UID);return He.reqUserAccount($.sid,{lts:W,success:!0,serverAddr:z,stringUid:$.string_uid,uid:ie.uid,errorCode:null,extend:$}),!1}const Re=fv(ie.code);return Re.retry&&(z=E[(oe+1)%E.length]),He.reqUserAccount($.sid,{lts:W,success:!1,serverAddr:z,stringUid:$.string_uid,uid:ie.uid,errorCode:Re.desc,extend:$}),Re.retry},(ie,oe)=>ie.code!==G.OPERATION_ABORTED&&(He.reqUserAccount($.sid,{lts:W,success:!1,serverAddr:z,stringUid:$.string_uid,uid:null,errorCode:ie.code,extend:$}),z=E[(oe+1)%E.length],!0),k);if(X.code!==0){const ie=fv(X.code);throw new ue(G.UNEXPECTED_RESPONSE,ie.desc)}return X}(h,i,t,r,a);return l==null||l.recordJoinChannelService({status:"success",endTs:Date.now()},f),v.uid}catch(v){throw l==null||l.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[v]},f),v}}async function Zte(i,t,r){const a=Z("CDS_AP").slice(0,Z("AJAX_REQUEST_CONCURRENT")).map(f=>i.proxyServer?"https://".concat(i.proxyServer,"/ap/?url=").concat(f+"/api/v1"):"https://".concat(f,"/api/v1?action=config")).map(f=>function(v,E,y,C){const I=Wt(),k={flag:64,cipher_method:0,features:{device:I.name,system:I.os,system_general:navigator.userAgent,vendor:E.appId,version:Ra,cname:E.cname,sid:E.sid,session_id:E.sid,detail:"",proxyServer:E.proxyServer}};return Ls(()=>Qc(v,{data:k,timeout:1e3,cancelToken:y,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,W=>W.code!==G.OPERATION_ABORTED,C)}(f,i,t,r));let l=null,u=null,h={};try{l=await Kh(a)}catch(f){if(f.code===G.OPERATION_ABORTED)throw f;u=f}if(a.forEach(f=>f.cancel()),He.reportApiInvoke(i.sid,{name:hr.REQUEST_CONFIG_DISTRIBUTE,options:{error:u,res:l}}).onSuccess(),l&&l.test_tags)try{h=function(f){if(!f.test_tags)return{};const v=f.test_tags,E=Object.keys(v),y={};return E.forEach(C=>{var I;const k=cT(I=C.slice(4)).call(I),W=JSON.parse(v[C])[1];y[k]=W}),y}(l)}catch{}return h}async function dF(i,t,r,a){const l=Z("PROXY_SERVER_TYPE3"),u=(k,W,$)=>{let z=$||l;return Array.isArray(z)&&(z=W%2==0?l[1]:l[0]),"https://".concat(z,"/ap/?url=").concat(k)};let h=null;const f=[],v=async()=>{const k=Z("WEBCS_DOMAIN").slice(0,Z("AJAX_REQUEST_CONCURRENT")).map((z,X)=>{let ie;return ie=i.cloudProxyServer==="disabled"&&i.proxyServer?u("".concat(z,"/api/v2/transpond/webrtc?v=2"),X,i.proxyServer):i.cloudProxyServer==="disabled"||i.cloudProxyServer==="fallback"?"https://".concat(z,"/api/v2/transpond/webrtc?v=2"):u("".concat(z,"/api/v2/transpond/webrtc?v=2"),X),{url:ie,areaCode:Wv(),serviceIds:[Fr.CHOOSE_SERVER,i.cloudProxyServer==="proxy5"?Fr.CLOUD_PROXY_5:i.cloudProxyServer==="proxy3"||i.cloudProxyServer==="proxy4"?Fr.CLOUD_PROXY:Fr.CLOUD_PROXY_FALLBACK]}}),W=a.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:k.map(z=>z.url)}),$=await m0({fragementLength:Z("FRAGEMENT_LENGTH"),referenceList:k,asyncMapHandler:z=>(L.debug("[".concat(i.clientId,"] Connect to choose_server:"),z.url),oF(z,i,t,r)),allFailedhandler:z=>{throw a.recordJoinChannelService({endTs:Date.now(),status:"error",errors:z},W),z[0]},promisesCollector:f});return a.recordJoinChannelService({endTs:Date.now(),status:"success"},W),$},E=async()=>{if(await ni(1e3),h!==null)return h;const k=Z("WEBCS_DOMAIN_BACKUP_LIST").map((z,X)=>{let ie;return ie=i.cloudProxyServer==="disabled"&&i.proxyServer?u("".concat(z,"/api/v2/transpond/webrtc?v=2"),X,i.proxyServer):i.cloudProxyServer==="disabled"||i.cloudProxyServer==="fallback"?"https://".concat(z,"/api/v2/transpond/webrtc?v=2"):u("".concat(z,"/api/v2/transpond/webrtc?v=2"),X),{url:ie,areaCode:Wv(),serviceIds:[Fr.CHOOSE_SERVER,i.cloudProxyServer==="proxy5"?Fr.CLOUD_PROXY_5:i.cloudProxyServer==="proxy3"||i.cloudProxyServer==="proxy4"?Fr.CLOUD_PROXY:Fr.CLOUD_PROXY_FALLBACK]}}),W=a.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:k.map(z=>z.url)}),$=await m0({fragementLength:Z("FRAGEMENT_LENGTH"),referenceList:k,asyncMapHandler:z=>(L.debug("[".concat(i.clientId,"] Connect to backup choose_server:"),z.url),oF(z,i,t,r)),allFailedhandler:z=>{throw a.recordJoinChannelService({endTs:Date.now(),status:"error",errors:z},W),z[0]},promisesCollector:f});return a.recordJoinChannelService({endTs:Date.now(),status:"success"},W),$};let y,C,I;try{({gatewayInfo:y,proxyInfo:C,url:I}=await Kh([v(),E()]))}catch(k){throw k[0]}if(f.length&&f.forEach(k=>k.cancel&&typeof k.cancel=="function"&&k.cancel()),!y||!C)throw new ue(G.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(i.apUrl=I,i.cloudProxyServer!=="disabled"&&Array.isArray(l)&&I){const k=/^https?:\/\/(.+?)(\/.*)?$/.exec(I)[1];Ke(l).call(l,k)&&(i.proxyServer=k,L.setProxyServer(k),He.setProxyServer(k))}return h={gatewayInfo:y,proxyInfo:await Wte(C,y.uid)},h}async function hF(i,t,r,a){const l=Z("UAP_AP").slice(0,Z("AJAX_REQUEST_CONCURRENT")).map(u=>t.proxyServer?"https://".concat(t.proxyServer,"/ap/?url=").concat(u+"/api/v1?action=uap"):"https://".concat(u,"/api/v1?action=uap"));return await Xte(l,i,t,r,a)}async function ene(i,t,r){const a=Z("UAP_AP").slice(0,Z("AJAX_REQUEST_CONCURRENT")).map(l=>i.proxyServer?"https://".concat(i.proxyServer,"/ap/?url=").concat(l+"/api/v1?action=uap"):"https://".concat(l,"/api/v1?action=uap")).map(l=>function(u,h,f,v){const E={command:"convergeAllocateEdge",sid:h.sid,appId:h.appId,token:h.token,ts:Date.now(),version:Ra,cname:h.cname,uid:h.uid.toString(),requestId:nR,seq:nR};nR+=1;const y={service_name:"tele_channel",json_body:JSON.stringify(E)};return Ls(async()=>{const C=await Qc(u,{data:y,cancelToken:f,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(C.code!==0){const k=new ue(G.UNEXPECTED_RESPONSE,"cross channel ap error, code"+C.code,{retry:!0});throw L.error(k.toString()),k}const I=JSON.parse(C.json_body);if(I.code!==200){const k=new ue(G.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(I.code,", reason: ").concat(I.reason));throw L.error(k.toString()),k}if(!I.servers||I.servers.length===0){const k=new ue(G.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw L.error(k.toString()),k}return{vid:I.vid,workerToken:I.workerToken,addressList:(Z("CHANNEL_MEDIA_RELAY_SERVERS")||I.servers).map(k=>"wss://".concat(k.address.replace(/\./g,"-"),".").concat(Z("WORKER_DOMAIN"),":").concat(k.wss))}},void 0,C=>!!(C.code!==G.OPERATION_ABORTED&&C.code!==G.UNEXPECTED_RESPONSE||C.data&&C.data.retry),v)}(l,i,t,r));try{const l=await Kh(a);return a.forEach(u=>u.cancel()),l}catch(l){throw l[0]}}async function tne(i,t,r){let a=null;const l=[],u=async h=>{const f=Z(h?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(v=>i.proxyServer?"https://".concat(i.proxyServer,"/ap/?url=").concat(v+"/api/v2/transpond/webrtc?v=2"):"https://".concat(v,"/api/v2/transpond/webrtc?v=2"));return h&&(await ni(1e3),a!==null)?a:await m0({fragementLength:Z("FRAGEMENT_LENGTH"),referenceList:f,asyncMapHandler:v=>(L.debug("[".concat(i.clientId,"] update ticket, Connect to ").concat(h?"backup":""," choose_server:"),v),function(E,y,C,I){const[k]=Qte(y,[Fr.CHOOSE_SERVER]);let W=or.networkState;return Ls(async()=>{W&&or.networkState===Li.OFFLINE&&or.onlineWaiter&&await me.race([or.onlineWaiter,ni(I&&I.maxRetryTimeout||sr.maxRetryTimeout)]),W=or.networkState;const $=await Qc(E,{data:k,cancelToken:C,headers:{"Content-Type":"multipart/form-data;"}},!0);return Jte($,E)},()=>!1,$=>$.code!==G.OPERATION_ABORTED&&($.code===G.UPDATE_TICKET_FAILED?$.data.retry:(L.warning("[".concat(y.clientId,"] update ticket network error, retry"),$),!0)),I)}(v,i,t,r)),allFailedhandler:v=>{throw v[0]},promisesCollector:l})};try{return a=await Kh([u(!1),u(!0)]),l.length&&l.forEach(h=>h.cancel&&typeof h.cancel=="function"&&h.cancel()),a}catch(h){throw h[0]}}function pF(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function fF(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pF(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):pF(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}class nne extends An{constructor(){super(),w(this,"configs",void 0),w(this,"joinInfo",void 0),w(this,"cancelToken",void 0),w(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),w(this,"interval",void 0),w(this,"mutex",new Mr("config-distribute")),w(this,"mutableParamsRead",!1)}startGetConfigDistribute(t,r){this.joinInfo=t,this.cancelToken=r,this.interval&&this.stopGetConfigDistribute(),Z("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},Z("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,He.reportApiInvoke(null,{options:void 0,name:hr.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:Dn.TRACER}).onSuccess(JSON.stringify(Fl))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void L.debug("[config-distribute] get config distribute interrupted have no joininfo");let t;const r=await this.mutex.lock();try{t=await Zte(this.joinInfo,this.cancelToken,this.retryConfig),L.debug("[config-distribute] get config distribute",JSON.stringify(t)),t.limit_bitrate&&this.handleBitrateLimit(t.limit_bitrate),this.cacheGlobalParameterConfig(t),this.configs=t}catch(a){const l=new ue(G.NETWORK_RESPONSE_ERROR,a);L.warning("[config-distribute] ".concat(l.toString()))}finally{r()}}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(t){var r;(r=t)&&r.uplink&&r.id&&r.uplink.max_bitrate!==void 0&&r.uplink.min_bitrate!==void 0&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==t.id&&this.emit(Kf.UPDATE_BITRATE_LIMIT,t):this.emit(Kf.UPDATE_BITRATE_LIMIT,t))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&fF({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(t){var r;const a=Nf(r=Object.keys(t).filter(u=>/^webrtc_ng_global_parameter/.test(u))).call(r);for(let u=0;u<a.length;u++)for(let h=a.length-1;h>u;h--){const f=a[h];if(typeof t[f].__priority=="number"){const v=t[f].__priority,E=a[h-1];if(typeof t[E].__priority=="number"){if(!(v>t[E].__priority))continue;{const y=f;a[h]=a[h-1],a[h-1]=y}}else{const y=f;a[h]=a[h-1],a[h-1]=y}}}const l={};a.forEach(u=>{const h=t[u],f=h.__expires;Object.keys(h).forEach(v=>{v==="__priority"||v==="__expires"||Object.prototype.hasOwnProperty.call(l,v)||(l[v]=fF({value:h[v]},f&&{expires:f}))})});try{(function(f){try{const v=Date.now();Object.keys(f).forEach(E=>{switch(E){case"ENABLE_EVENT_REPORT":case"UPLOAD_LOG":if(Object.prototype.hasOwnProperty.call($i,E)){const{value:y,expires:C}=f[E];if(C&&C<=v)return;Fl[E]=y,$i[E]=y,L.debug("Update global parameters from config distribute",E,y)}}})}catch(v){L.error("Error update config immediately: ".concat(f),v.message)}})(l);const u=JSON.stringify(l),h=window.btoa(u);window.localStorage.setItem("websdk_ng_global_parameter",h),L.debug("Caching global parameters ".concat(u))}catch(u){L.error("Error caching global parameters:",u.message)}}}function mF(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function g0(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mF(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):mF(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}class rne extends An{constructor(t,r,a,l){super(),w(this,"spec",void 0),w(this,"token",void 0),w(this,"websocket",void 0),w(this,"pingpongTimer",void 0),w(this,"reconnectMode","retry"),w(this,"serviceMode",void 0),w(this,"reqId",0),w(this,"commandReqId",0),w(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),w(this,"handleWebSocketMessage",u=>{if(!u.data)return;const h=JSON.parse(u.data);h.requestId?this.emit("@".concat(h.requestId,"-").concat(h.sid),h):this.serviceMode===Er.INJECT?this.emit(rs.INJECT_STREAM_STATUS,h):(He.workerEvent(this.spec.sid,{actionType:"status",serverCode:h.code,workerType:this.serviceMode===Er.TRANSCODE?1:2}),this.emit(rs.PUBLISH_STREAM_STATUS,h))}),this.spec=r,this.token=t,this.serviceMode=l,this.websocket=new Yf("live-streaming",a),this.websocket.on(rt.CONNECTED,this.handleWebSocketOpen),this.websocket.on(rt.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(rt.REQUEST_NEW_URLS,(u,h)=>{Ln(this,rs.REQUEST_NEW_ADDRESS).then(u).catch(h)}),this.websocket.on(rt.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(t){return this.websocket.init(t)}async request(t,r,a,l){this.reqId+=1,t==="request"&&(this.commandReqId+=1);const u=this.commandReqId,h=this.reqId;if(!h||!this.websocket)throw new ue(G.UNEXPECTED_ERROR);const f=g0({command:t,sdkVersion:Ra==="4.19.2"?"0.0.1":Ra,seq:h,requestId:h,allocate:a,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},r);if(this.websocket.state==="closed")throw new ue(G.WS_DISCONNECT);const v=()=>new me((I,k)=>{this.websocket.once(rt.CLOSED,()=>k(new ue(G.WS_ABORT))),this.websocket.once(rt.CONNECTED,I)});this.websocket.state!=="connected"&&await v(),f.clientRequest&&(f.clientRequest.workerToken=this.token);const E=new me((I,k)=>{const W=()=>{k(new ue(G.WS_ABORT))};this.websocket.once(rt.RECONNECTING,W),this.websocket.once(rt.CLOSED,W),this.once("@".concat(h,"-").concat(this.spec.sid),$=>{I($)})});l&&He.workerEvent(this.spec.sid,g0(g0({},l),{},{requestId:u,actionType:"request",payload:JSON.stringify(r.clientRequest),serverCode:0,code:0}));const y=Date.now();this.websocket.sendMessage(f);let C=null;try{C=await E}catch(I){if(this.websocket.state==="closed")throw I;return await v(),await this.request(t,r,a)}return l&&He.workerEvent(this.spec.sid,g0(g0({},l),{},{requestId:u,actionType:"response",payload:JSON.stringify(C.serverResponse),serverCode:C.code,success:C.code===200,responseTime:Date.now()-y})),C.code!==200&&this.handleResponseError(C),C}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const t=Ra==="4.19.2"?"0.0.1":Ra;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:t,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(t){switch(t.code){case er.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void L.warning("live stream response already exists stream");case er.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case er.LIVE_STREAM_RESPONSE_BAD_STREAM:case er.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new ue(G.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:t.code}).throw();case er.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(t.serverResponse.command==="UnpublishStream"||t.serverResponse.command==="UninjectStream")return;throw new ue(G.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case er.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new ue(G.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:t.code}).throw();case er.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const r=new ue(G.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(rs.WARNING,r,t.serverResponse.url)}case er.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const r=new ue(G.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(rs.WARNING,r,t.serverResponse.url)}case er.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new ue(G.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case er.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new ue(G.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:t.code}).throw();case er.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const r=new ue(G.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(rs.WARNING,r,t.serverResponse.url)}case er.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new ue(G.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:t.code}).throw();case er.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new ue(G.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case er.LIVE_STREAM_RESPONSE_WORKER_LOST:case er.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(t.serverResponse.command==="UnpublishStream"||t.serverResponse.command==="UninjectStream")return;throw new ue(G.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case er.ERROR_FAIL_SEND_MESSAGE:if(t.serverResponse.command==="UnpublishStream"||t.serverResponse.command==="UninjectStream")return;if(t.serverResponse.command==="UpdateTranscoding"||t.serverResponse.command==="ControlStream")return new ue(G.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:t.code}).throw();throw new ue(G.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case er.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case er.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case er.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case er.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new ue(G.LIVE_STREAMING_CDN_ERROR,"",{code:t.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(Jg)},6e3)}}function gF(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function eo(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gF(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):gF(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}class ine extends An{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:sr,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:sr;super(),w(this,"onLiveStreamWarning",void 0),w(this,"onLiveStreamError",void 0),w(this,"onInjectStatusChange",void 0),w(this,"spec",void 0),w(this,"retryTimeout",1e4),w(this,"connection",void 0),w(this,"httpRetryConfig",void 0),w(this,"wsRetryConfig",void 0),w(this,"streamingTasks",new Map),w(this,"isStartingStreamingTask",!1),w(this,"taskMutex",new Mr("live-streaming")),w(this,"cancelToken",go.CancelToken.source()),w(this,"transcodingConfig",void 0),w(this,"injectConfig",eo({},ree)),w(this,"injectLoopTimes",0),w(this,"uapResponse",void 0),w(this,"lastTaskId",1),w(this,"statusError",new Map),this.spec=t,this.httpRetryConfig=a,this.wsRetryConfig=r}async setTranscodingConfig(t){const r=eo(eo({},nee),t);r.videoCodecProfile!==66&&r.videoCodecProfile!==77&&r.videoCodecProfile!==100&&(L.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(r.videoCodecProfile," -> 100")),r.videoCodecProfile=100),r.transcodingUsers||(r.transcodingUsers=r.userConfigs),r.transcodingUsers&&(r.transcodingUsers=r.transcodingUsers.map(h=>eo(eo(eo({},tee),h),{},{zOrder:h.zOrder?h.zOrder+1:1}))),function(h){kn(h.width)||cn(h.width,"config.width",0,1e4),kn(h.height)||cn(h.height,"config.height",0,1e4),kn(h.videoBitrate)||cn(h.videoBitrate,"config.videoBitrate",1,1e6),kn(h.videoFrameRate)||cn(h.videoFrameRate,"config.videoFrameRate"),kn(h.lowLatency)||Yu(h.lowLatency,"config.lowLatency"),kn(h.audioSampleRate)||wr(h.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),kn(h.audioBitrate)||cn(h.audioBitrate,"config.audioBitrate",1,128),kn(h.audioChannels)||wr(h.audioChannels,"config.audioChannels",[1,2,3,4,5]),kn(h.videoGop)||cn(h.videoGop,"config.videoGop"),kn(h.videoCodecProfile)||wr(h.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),kn(h.userCount)||cn(h.userCount,"config.userCount",0,17),kn(h.backgroundColor)||cn(h.backgroundColor,"config.backgroundColor",0,16777215),kn(h.userConfigExtraInfo)||di(h.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),h.transcodingUsers&&!kn(h.transcodingUsers)&&(Hc(h.transcodingUsers,"config.transcodingUsers"),h.transcodingUsers.forEach((f,v)=>{tT(f.uid),kn(f.x)||cn(f.x,"transcodingUser[".concat(v,"].x"),0,1e4),kn(f.y)||cn(f.y,"transcodingUser[".concat(v,"].y"),0,1e4),kn(f.width)||cn(f.width,"transcodingUser[".concat(v,"].width"),0,1e4),kn(f.height)||cn(f.height,"transcodingUser[".concat(v,"].height"),0,1e4),kn(f.zOrder)||cn(f.zOrder-1,"transcodingUser[".concat(v,"].zOrder"),0,100),kn(f.alpha)||cn(f.alpha,"transcodingUser[".concat(v,"].alpha"),0,1,!1)})),kn(h.watermark)||rT(h.watermark,"watermark"),kn(h.backgroundImage)||rT(h.backgroundImage,"backgroundImage"),h.images&&!kn(h.images)&&(Hc(h.images,"config.images"),h.images.forEach((f,v)=>{rT(f,"images[".concat(v,"]"))}))}(r);const a=[];r.images&&a.push(...r.images.map(h=>eo(eo(eo({},nT),h),{},{zOrder:255}))),r.backgroundImage&&(a.push(eo(eo(eo({},nT),r.backgroundImage),{},{zOrder:0})),delete r.backgroundImage),r.watermark&&(a.push(eo(eo(eo({},nT),r.watermark),{},{zOrder:255})),delete r.watermark),r.images=a,r.transcodingUsers&&(r.userConfigs=r.transcodingUsers.map(h=>eo({},h)),r.userCount=r.transcodingUsers.length,delete r.transcodingUsers);const l=(r.userConfigs||[]).map(h=>typeof h.uid=="number"?me.resolve(h.uid):uF(h.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await me.all(l)).forEach((h,f)=>{r.userConfigs&&r.userConfigs[f]&&(r.userConfigs[f].uid=h)}),this.transcodingConfig=r,this.connection)try{var u;const h=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(gc(u=this.streamingTasks).call(u)).map(f=>f.taskId).join("#")});L.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(h.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(h){if(!h.data||!h.data.retry)throw h;h.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(f=>{L.warning("[".concat(this.spec.clientId,"] live streaming receive error"),h.toString(),"try to republish",f.url),this.startLiveStreamingTask(f.url,f.mode,h).then(()=>{L.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(f.url," success"))}).catch(v=>{L.error("[".concat(this.spec.clientId,"] live streaming republish failed"),f.url,v.toString()),this.onLiveStreamError&&this.onLiveStreamError(f.url,v)})})}}setInjectStreamConfig(t,r){this.injectConfig=Object.assign({},this.injectConfig,t),this.injectLoopTimes=r}async startLiveStreamingTask(t,r,a){var l;if(Array.from(gc(l=this.streamingTasks).call(l)).find(v=>v.mode===Er.INJECT)&&r===Er.INJECT)return new ue(G.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw();if(!this.transcodingConfig&&r===Er.TRANSCODE)throw new ue(G.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");let u={command:"PublishStream",ts:Date.now(),url:t,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};L.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(t,", mode: ").concat(r));const h=await this.taskMutex.lock();if(!this.connection&&a)return void h();if(this.streamingTasks.get(t)&&!a)return h(),new ue(G.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(r))}catch(v){throw h(),v}switch(r){case Er.TRANSCODE:u.transcodingConfig=eo({},this.transcodingConfig);break;case Er.RAW:break;case Er.INJECT:u={cname:this.spec.cname,command:"InjectStream",sid:this.spec.sid,transcodingConfig:this.injectConfig,ts:Date.now(),url:t,loopTimes:this.injectLoopTimes}}this.uapResponse&&this.uapResponse.vid&&(u.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const f=this.lastTaskId++;try{const v=new me((y,C)=>{ni(this.retryTimeout).then(()=>{if(a)return C(a);const I=this.statusError.get(t);return I?(this.statusError.delete(t),C(I)):void 0})}),E=await me.race([this.connection.request("request",{clientRequest:u},!0,{url:t,command:"PublishStream",workerType:r===Er.TRANSCODE?1:2,requestByUser:!a,tid:f.toString()}),v]);this.isStartingStreamingTask=!1,L.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(E.code)),this.streamingTasks.set(t,{clientRequest:u,mode:r,url:t,taskId:f}),h()}catch(v){if(h(),this.isStartingStreamingTask=!1,!v.data||!v.data.retry||a)throw v;return v.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(t,r,v)):await this.startLiveStreamingTask(t,r,v)}}stopLiveStreamingTask(t){return new me((r,a)=>{const l=this.streamingTasks.get(t);if(!l||!this.connection)return new ue(G.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const u=l.mode;l.abortTask=()=>{L.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(t),r()},this.connection.request("request",{clientRequest:{command:u===Er.INJECT?"UninjectStream":"UnpublishStream",url:l.url}},!1,{url:t,command:"UnPublishStream",workerType:u===Er.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(h=>{L.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(h.code)),this.streamingTasks.delete(t),this.streamingTasks.size===0&&u!==Er.INJECT&&(this.connection&&this.connection.close(),this.connection=void 0),r(),u===Er.INJECT&&this.onInjectStatusChange&&this.onInjectStatusChange(Bl.INJECT_STREAM_STATUS_STOP_SUCCESS,this.spec.uid,t)}).catch(a)})}async controlInjectStream(t,r,a,l){const u=this.streamingTasks.get(t);if(!u||!this.connection||u.mode!==Er.INJECT)throw new ue(G.INVALID_OPERATION,"can not find inject stream task to control");return(await this.connection.request("request",{clientRequest:{command:"ControlStream",url:t,control:r,audioVolume:a,position:l}})).serverResponse}resetAllTask(){var t;const r=Array.from(gc(t=this.streamingTasks).call(t));this.terminate();for(const a of r)this.startLiveStreamingTask(a.url,a.mode).catch(l=>{this.onLiveStreamError&&this.onLiveStreamError(a.url,l)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=go.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(t){if(this.connection)throw new ue(G.UNEXPECTED_ERROR,"live streaming connection has already connected");const r=await Ln(this,Ph.REQUEST_WORKER_MANAGER_LIST,t);return this.uapResponse=r,this.connection=new rne(r.workerToken,this.spec,this.wsRetryConfig,t),this.connection.on(rs.WARNING,(a,l)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(l,a)),this.connection.on(rs.PUBLISH_STREAM_STATUS,a=>this.handlePublishStreamServer(a)),this.connection.on(rs.INJECT_STREAM_STATUS,a=>this.handleInjectStreamServerStatus(a)),this.connection.on(rs.REQUEST_NEW_ADDRESS,(a,l)=>{if(!this.connection)return l(new ue(G.UNEXPECTED_ERROR,"can not get new live streaming address list"));Ln(this,Ph.REQUEST_WORKER_MANAGER_LIST,t).then(u=>{this.uapResponse=u,a(u.addressList)}).catch(l)}),await this.connection.init(r.addressList),this.connection}handlePublishStreamServer(t){const r=t.serverStatus&&t.serverStatus.url||"empty_url",a=this.streamingTasks.get(r),l=t.reason;switch(t.code){case er.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case er.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case er.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case er.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const h=new ue(G.LIVE_STREAMING_CDN_ERROR,"",{code:t.code});if(a)return L.error(h.toString()),this.onLiveStreamError&&this.onLiveStreamError(r,h);if(!this.isStartingStreamingTask)return;this.statusError.set(r,h)}case er.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const h=new ue(G.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,l);return this.onLiveStreamWarning&&this.onLiveStreamWarning(r,h)}case er.LIVE_STREAM_RESPONSE_WORKER_LOST:case er.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var u;if(!this.connection)return;this.connection.tryNextAddress();const h=Array.from(gc(u=this.streamingTasks).call(u));for(const f of h)f.abortTask?f.abortTask():(L.warning("[".concat(this.spec.clientId,"] publish stream status code"),t.code,"try to republish",f.url),this.startLiveStreamingTask(f.url,f.mode,new ue(G.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:t.code})).then(()=>{L.debug("[".concat(this.spec.clientId,"] republish live stream success"),f.url)}).catch(v=>{L.error(v.toString()),this.onLiveStreamError&&this.onLiveStreamError(f.url,v)}));return}}}handleInjectStreamServerStatus(t){const r=Number(t.uid),a=t.serverStatus&&t.serverStatus.url;switch(t.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(Bl.INJECT_STREAM_STATUS_START_SUCCESS,r,a));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(Bl.INJECT_STREAM_STATUS_START_ALREADY_EXISTS,r,a),void this.streamingTasks.delete(a);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(Bl.INJECT_STREAM_STATUS_START_UNAUTHORIZED,r,a),void this.streamingTasks.delete(a);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(Bl.INJECT_STREAM_STATUS_BROKEN,r,a),void this.streamingTasks.delete(a);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(Bl.INJECT_STREAM_STATUS_START_TIMEOUT,r,a),void this.streamingTasks.delete(a);default:return void L.debug("inject stream server status",t)}}hasUrl(t){return this.streamingTasks.has(t)}}class Kv{constructor(){w(this,"destChannelMediaInfos",new Map),w(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(t){aL(t),this.srcChannelMediaInfo=t}addDestChannelInfo(t){aL(t),this.destChannelMediaInfos.set(t.channelName,t)}removeDestChannelInfo(t){eT(t),this.destChannelMediaInfos.delete(t)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function vF(i){if(!(i instanceof Kv))return new ue(G.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const t=i.getSrcChannelMediaInfo(),r=i.getDestChannelMediaInfo();if(!t)return new ue(G.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(r.size===0)return new ue(G.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class one extends An{constructor(t,r,a){super(),w(this,"ws",void 0),w(this,"requestId",1),w(this,"heartBeatTimer",void 0),w(this,"joinInfo",void 0),w(this,"clientId",void 0),w(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),w(this,"onClose",l=>{this.emit("close"),this.dispose()}),w(this,"onMessage",l=>{const u=JSON.parse(l.data);if(!u||u.command!=="serverResponse"||!u.requestId)return u&&u.command==="serverStatus"&&u.serverStatus&&u.serverStatus.command?(this.emit("status",u.serverStatus),void this.emit(u.serverStatus.command,u.serverStatus)):void 0;this.emit("req_".concat(u.requestId),u)}),this.joinInfo=t,this.clientId=r,this.ws=new Yf("cross-channel-".concat(this.clientId),a),this.ws.on(rt.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(rt.CONNECTED,this.onOpen),this.ws.on(rt.ON_MESSAGE,this.onMessage),this.ws.on(rt.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(t){const r=this.requestId++;return t.requestId=r,t.seq=r,this.ws.sendMessage(t),r}waitStatus(t){return new me((r,a)=>{const l=window.setTimeout(()=>{a(new ue(G.TIMEOUT,"wait status timeout, status: ".concat(t)))},5e3);this.once(t,u=>{window.clearTimeout(l),u.state&&u.state!==0?a(new ue(G.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(t))):r(void 0)}),this.once("dispose",()=>{window.clearTimeout(l),a(new ue(G.WS_ABORT))})})}async request(t){if(this.ws.state==="closed")throw new ue(G.WS_DISCONNECT);const r=()=>new me((h,f)=>{this.ws.once(rt.CLOSED,()=>f(new ue(G.WS_ABORT))),this.ws.once(rt.CONNECTED,h)});this.ws.state!=="connected"&&await r();const a=this.sendMessage(t),l=new me((h,f)=>{const v=()=>{f(new ue(G.WS_ABORT))};this.ws.once(rt.RECONNECTING,v),this.ws.once(rt.CLOSED,v),this.once("req_".concat(a),h),ni(3e3).then(()=>{this.removeAllListeners("req_".concat(a)),this.ws.off(rt.RECONNECTING,v),this.ws.off(rt.CLOSED,v),f(new ue(G.TIMEOUT,"cross channel ws request timeout"))})}),u=await l;if(!u||u.code!==200)throw new ue(G.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(u)));return u}async connect(t){this.ws.removeAllListeners(rt.REQUEST_NEW_URLS),this.ws.on(rt.REQUEST_NEW_URLS,r=>{r(t)}),await this.ws.init(t)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(t){const r=this.requestId++;return t.requestId=r,this.ws.sendMessage(t),r}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class ane extends An{set state(t){t!==this._state&&(t!==Hi.RELAY_STATE_FAILURE&&(this.errorCode=jl.RELAY_OK),this.emit("state",t,this.errorCode),this._state=t)}get state(){return this._state}constructor(t,r,a,l,u){super(),w(this,"joinInfo",void 0),w(this,"sid",void 0),w(this,"clientId",void 0),w(this,"cancelToken",go.CancelToken.source()),w(this,"workerToken",void 0),w(this,"requestId",0),w(this,"signal",void 0),w(this,"prevChannelMediaConfig",void 0),w(this,"httpRetryConfig",void 0),w(this,"_resolution",void 0),w(this,"_state",Hi.RELAY_STATE_IDLE),w(this,"errorCode",jl.RELAY_OK),w(this,"onStatus",h=>{L.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(h))),h&&h.command&&(h.command==="onAudioPacketReceived"&&this.emit("event",Ms.PACKET_RECEIVED_AUDIO_FROM_SRC),h.command==="onVideoPacketReceived"&&this.emit("event",Ms.PACKET_RECEIVED_VIDEO_FROM_SRC),h.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=jl.SRC_TOKEN_EXPIRED,this.state=Hi.RELAY_STATE_FAILURE),h.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=jl.DEST_TOKEN_EXPIRED,this.state=Hi.RELAY_STATE_FAILURE))}),w(this,"onReconnect",async()=>{L.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",Ms.NETWORK_DISCONNECTED),this.state=Hi.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(h=>{this.state!==Hi.RELAY_STATE_IDLE&&(L.error("auto restart channel media relay failed",h.toString()),this.errorCode=jl.SERVER_CONNECTION_LOST,this.state=Hi.RELAY_STATE_FAILURE)})}),this.joinInfo=t,this.clientId=r,this.sid=Ib(),this.signal=new one(this.joinInfo,this.clientId,a),this.httpRetryConfig=l,this._resolution=u}async startChannelMediaRelay(t){if(this.state!==Hi.RELAY_STATE_IDLE)throw new ue(G.INVALID_OPERATION);this.state=Hi.RELAY_STATE_CONNECTING,await this.connect(),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(t)}catch(r){throw r.data&&r.data.serverResponse&&r.data.serverResponse.command==="SetSourceChannel"?new ue(G.CROSS_CHANNEL_FAILED_JOIN_SRC):r.data&&r.data.serverResponse&&r.serverResponse.command==="SetDestChannelStatus"?new ue(G.CROSS_CHANNEL_FAILED_JOIN_DEST):r.data&&r.data.serverResponse&&r.serverResponse.command==="StartPacketTransfer"?new ue(G.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):r}this.prevChannelMediaConfig=t}async updateChannelMediaRelay(t){if(this.state!==Hi.RELAY_STATE_RUNNING)throw new ue(G.INVALID_OPERATION);await this.sendUpdateMessage(t),this.prevChannelMediaConfig=t}async setVideoProfile(t){if(this._resolution=t,this.state!==Hi.RELAY_STATE_RUNNING)throw new ue(G.INVALID_OPERATION);const r=this.genMessage(Si.SetVideoProfile);await this.signal.request(r),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),L.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=Hi.RELAY_STATE_IDLE,this.dispose()}dispose(){L.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=go.CancelToken.source(),this.state=Hi.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const t=await ene(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=t.workerToken,await this.signal.connect(t.addressList),this.emit("event",Ms.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(t){const r=this.genMessage(Si.StopPacketTransfer);await this.signal.request(r),await this.signal.waitStatus("Normal Quit"),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const a=this.genMessage(Si.SetSdkProfile,t);await this.signal.request(a),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const l=this.genMessage(Si.SetSourceChannel,t);await this.signal.request(l),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",Ms.PACKET_JOINED_SRC_CHANNEL),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const u=this.genMessage(Si.SetSourceUserId,t);await this.signal.request(u),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const h=this.genMessage(Si.SetDestChannel,t);await this.signal.request(h),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",Ms.PACKET_JOINED_DEST_CHANNEL),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const f=this.genMessage(Si.StartPacketTransfer,t);await this.signal.request(f),this.emit("event",Ms.PACKET_SENT_TO_DEST_CHANNEL),this.state=Hi.RELAY_STATE_RUNNING,L.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(t){const r=this.genMessage(Si.UpdateDestChannel,t);await this.signal.request(r),this.emit("event",Ms.PACKET_UPDATE_DEST_CHANNEL),L.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const t=this.genMessage(Si.StopPacketTransfer);await this.signal.request(t),L.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(t,r){const a=[],l=[],u=[];this.requestId+=1;const h={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:Ra,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};h.sdkVersion==="4.19.2"&&(h.sdkVersion="0.0.1");let f=null,v=null;switch(t){case Si.SetSdkProfile:return h.clientRequest={command:"SetSdkProfile",type:"multi_channel"},h;case Si.SetSourceChannel:if(v=r&&r.getSrcChannelMediaInfo(),!v)throw new ue(G.UNEXPECTED_ERROR,"can not find source config");return h.clientRequest={command:"SetSourceChannel",uid:"0",channelName:v.channelName,token:v.token||this.joinInfo.appId},h;case Si.SetSourceUserId:if(v=r&&r.getSrcChannelMediaInfo(),!v)throw new ue(G.UNEXPECTED_ERROR,"can not find source config");return h.clientRequest={command:"SetSourceUserId",uid:v.uid+""},h;case Si.SetDestChannel:if(f=r&&r.getDestChannelMediaInfo(),!f)throw new ue(G.UNEXPECTED_ERROR,"can not find dest config");return f.forEach(E=>{a.push(E.channelName),l.push(E.uid+""),u.push(E.token||this.joinInfo.appId)}),h.clientRequest={command:"SetDestChannel",channelName:a,uid:l,token:u},h;case Si.StartPacketTransfer:return h.clientRequest={command:"StartPacketTransfer"},h;case Si.Reconnect:return h.clientRequest={command:"Reconnect"},h;case Si.StopPacketTransfer:return h.clientRequest={command:"StopPacketTransfer"},h;case Si.UpdateDestChannel:if(f=r&&r.getDestChannelMediaInfo(),!f)throw new ue(G.UNEXPECTED_ERROR,"can not find dest config");return f.forEach(E=>{a.push(E.channelName),l.push(E.uid+""),u.push(E.token||this.joinInfo.appId)}),h.clientRequest={command:"UpdateDestChannel",channelName:a,uid:l,token:u},h;case Si.SetVideoProfile:h.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return h}}class mi{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio)return this._audioTrack}get videoTrack(){if(this.hasVideo)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(t,r){w(this,"uid",void 0),w(this,"_uintid",void 0),w(this,"_trust_in_room_",!0),w(this,"_trust_audio_enabled_state_",!0),w(this,"_trust_video_enabled_state_",!0),w(this,"_trust_audio_mute_state_",!0),w(this,"_trust_video_mute_state_",!0),w(this,"_audio_muted_",!1),w(this,"_video_muted_",!1),w(this,"_audio_enabled_",!0),w(this,"_video_enabled_",!0),w(this,"_audio_added_",!1),w(this,"_video_added_",!1),w(this,"_trust_video_stream_added_state_",!0),w(this,"_trust_audio_stream_added_state_",!0),w(this,"_audioTrack",void 0),w(this,"_videoTrack",void 0),w(this,"_dataChannels",[]),w(this,"_audioSSRC",void 0),w(this,"_videoSSRC",void 0),w(this,"_audioOrtc",void 0),w(this,"_videoOrtc",void 0),w(this,"_cname",void 0),w(this,"_rtxSsrcId",void 0),this.uid=t,this._uintid=r}}var sne=Ik,cne=hc;Zn({target:"Promise",stat:!0,forced:!0},{withResolvers:function(){var i=cne.f(this);return{promise:i.promise,resolve:i.resolve,reject:i.reject}}});var lne=hc,une=Eh;Zn({target:"Promise",stat:!0,forced:!0},{try:function(i){var t=lne.f(this),r=une(i);return(r.error?t.reject:t.resolve)(r.value),t.promise}});var iR=it(sne),EF=ch.f("asyncIterator"),dne=it(EF);function oR(i,t){this.v=i,this.k=t}function v0(i){var t,r;function a(u,h){try{var f=i[u](h),v=f.value,E=v instanceof oR;iR.resolve(E?v.v:v).then(function(y){if(E){var C=u==="return"?"return":"next";if(!v.k||y.done)return a(C,y);y=i[C](y).value}l(f.done?"return":"normal",y)},function(y){a("throw",y)})}catch(y){l("throw",y)}}function l(u,h){switch(u){case"return":t.resolve({value:h,done:!0});break;case"throw":t.reject(h);break;default:t.resolve({value:h,done:!1})}(t=t.next)?a(t.key,t.arg):r=null}this._invoke=function(u,h){return new iR(function(f,v){var E={key:u,arg:h,resolve:f,reject:v,next:null};r?r=r.next=E:(t=r=E,a(u,h))})},typeof i.return!="function"&&(this.return=void 0)}function Na(i){return function(){return new v0(i.apply(this,arguments))}}function zt(i){return new oR(i,0)}function qv(i){var t={},r=!1;function a(l,u){return r=!0,{done:!1,value:new oR(u=new iR(function(h){h(i[l](u))}),1)}}return t[fh!==void 0&&uD||"@@iterator"]=function(){return this},t.next=function(l){return r?(r=!1,l):a("next",l)},typeof i.throw=="function"&&(t.throw=function(l){if(r)throw r=!1,l;return a("throw",l)}),typeof i.return=="function"&&(t.return=function(l){return r?(r=!1,l):a("return",l)}),t}v0.prototype[typeof fh=="function"&&dne||"@@asyncIterator"]=function(){return this},v0.prototype.next=function(i){return this._invoke("next",i)},v0.prototype.throw=function(i){return this._invoke("throw",i)},v0.prototype.return=function(i){return this._invoke("return",i)};var _F=it(EF),yF={exports:{}};(function(i,t){i.exports=(()=>{var r={8:(u,h,f)=>{f.r(h),f.d(h,{Parser:()=>vt,Printer:()=>Mo,parse:()=>at,print:()=>Gt});const v=`
`,E="".concat("\r").concat(v),y=" ";let C;function I(Pe){return Pe>="0"&&Pe<="9"}function k(Pe){return Pe>="!"&&Pe<="~"}function W(Pe){return k(Pe)||Pe>=""&&Pe<=""}function $(Pe){return Pe==="!"||Pe>="#"&&Pe<="'"||Pe>="*"&&Pe<="+"||Pe>="-"&&Pe<="."||Pe>="0"&&Pe<="9"||Pe>="A"&&Pe<="Z"||Pe>="^"&&Pe<="~"}function z(Pe){return Pe>="1"&&Pe<="9"}function X(Pe){return Pe>="A"&&Pe<="Z"||Pe>="a"&&Pe<="z"}function ie(Pe){return Pe==="d"||Pe==="h"||Pe==="m"||Pe==="s"}function oe(Pe){return Pe>""&&Pe<"	"||Pe>"\v"&&Pe<"\f"||Pe>""&&Pe<""}function Re(Pe){return X(Pe)||I(Pe)||Pe==="+"||Pe==="/"}function Ce(Pe){return I(Pe)||X(Pe)||Pe==="+"||Pe==="/"||Pe==="-"||Pe==="_"}function ge(Pe){return X(Pe)||I(Pe)||Pe==="+"||Pe==="/"}function _e(Pe,U){var Y=Object.keys(Pe);if(Object.getOwnPropertySymbols){var re=Object.getOwnPropertySymbols(Pe);U&&(re=re.filter(function(Oe){return Object.getOwnPropertyDescriptor(Pe,Oe).enumerable})),Y.push.apply(Y,re)}return Y}function Se(Pe){for(var U=1;U<arguments.length;U++){var Y=arguments[U]!=null?arguments[U]:{};U%2?_e(Object(Y),!0).forEach(function(re){De(Pe,re,Y[re])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Pe,Object.getOwnPropertyDescriptors(Y)):_e(Object(Y)).forEach(function(re){Object.defineProperty(Pe,re,Object.getOwnPropertyDescriptor(Y,re))})}return Pe}function De(Pe,U,Y){return U in Pe?Object.defineProperty(Pe,U,{value:Y,enumerable:!0,configurable:!0,writable:!0}):Pe[U]=Y,Pe}(function(Pe){Pe.VERSION="v",Pe.ORIGIN="o",Pe.SESSION_NAME="s",Pe.INFORMATION="i",Pe.URI="u",Pe.EMAIL="e",Pe.PHONE="p",Pe.CONNECTION="c",Pe.BANDWIDTH="b",Pe.TIME="t",Pe.REPEAT="r",Pe.ZONE_ADJUSTMENTS="z",Pe.KEY="k",Pe.ATTRIBUTE="a",Pe.MEDIA="m"})(C||(C={}));class Ne{consumeText(U,Y){let re=Y;for(;re<U.length;){const Oe=U[re];if(Oe==="\0"||Oe==="\r"||Oe===v)break;re+=1}if(re-Y==0)throw new Error("Invalid text, at ".concat(U));return re}consumeUnicastAddress(U,Y,re){return this.consumeTill(U,Y,y)}consumeOneOrMore(U,Y,re){let Oe=Y;for(;re(U[Oe]);)Oe++;if(Oe-Y==0)throw new Error("Invalid rule at ".concat(Y,"."));return Oe}consumeSpace(U,Y){if(U[Y]===y)return Y+1;throw new Error("Invalid space at ".concat(Y,"."))}consumeIP4Address(U,Y){let re=Y;for(let Oe=0;Oe<4;Oe++)if(re=this.consumeDecimalUChar(U,re),Oe!==3){if(U[re]!==".")throw new Error("Invalid IP4 address.");re++}return re}consumeDecimalUChar(U,Y){let re=Y;for(let pt=0;pt<3&&I(U[re]);pt++,re++);if(re-Y==0)throw new Error("Invalid decimal uchar.");const Oe=parseInt(U.slice(Y,re));if(Oe>=0&&Oe<=255)return re;throw new Error("Invalid decimal uchar")}consumeIP6Address(U,Y){let re=this.consumeHexpart(U,Y);return U[re]===":"&&(re+=1,re=this.consumeIP4Address(U,re)),re}consumeHexpart(U,Y){let re=Y;if(U[re]===":"&&U[re+1]===":"){re+=2;try{re=this.consumeHexseq(U,re)}catch{}return re}if(re=this.consumeHexseq(U,re),U[re]===":"&&U[re+1]===":"){re+=2;try{re=this.consumeHexseq(U,re)}catch{}return re}return re}consumeHexseq(U,Y){let re=Y;for(;re=this.consumeHex4(U,re),U[re]===":"&&U[re+1]!==":";)re+=1;return re}consumeHex4(U,Y){let re=0;for(;re<4;re++)if(!((Oe=U[Y+re])>="0"&&Oe<="9"||Oe>="a"&&Oe<="f"||Oe>="A"&&Oe<="F")){if(re===0)throw new Error("Invalid hex 4");break}var Oe;return Y+re}consumeFQDN(U,Y){let re=Y;for(;I(U[re])||X(U[re])||U[re]==="-"||U[re]===".";)re+=1;if(re-Y<4)throw new Error("Invalid FQDN");return re}consumeExtnAddr(U,Y){return this.consumeOneOrMore(U,Y,W)}consumeMulticastAddress(U,Y,re){switch(re){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(U,Y);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(U,Y);default:try{return this.consumeFQDN(U,Y)}catch{return this.consumeExtnAddr(U,Y)}}}consumeIP6MulticastAddress(U,Y){const re=this.consumeHexpart(U,Y);return U[re]==="/"?this.consumeInteger(U,re+1):re}consumeIP4MulticastAddress(U,Y){let re=Y+3;const Oe=U.slice(Y,re),pt=parseInt(Oe);if(pt<224||pt>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let Sn=0;Sn<3;Sn++){if(U[re]!==".")throw new Error("Invalid IP4 multicast address.");re+=1,re=this.consumeDecimalUChar(U,re)}return U[re]==="/"&&(re+=1),re=this.consumeTTL(U,re),U[re]==="/"&&(re=this.consumeInteger(U,re)),re}consumeInteger(U,Y){if(!z(U[Y]))throw new Error("Invalid integer.");for(Y+=1;I(U[Y]);)Y+=1;return Y}consumeTTL(U,Y){if(U[Y]==="0")return Y+1;if(!z(U[Y]))throw new Error("Invalid TTL.");Y+=1;for(let re=0;re<2&&I(U[Y]);re++)Y+=1;return Y}consumeToken(U,Y){return this.consumeOneOrMore(U,Y,$)}consumeTime(U,Y){let re=Y;if(U[re]==="0")return re+1;for(z(U[re])&&(re+=1);I(U[re]);)re++;if(re-Y<10)throw new Error("Invalid time");return re}consumeAddress(U,Y){return this.consumeTill(U,Y,y)}consumeTypedTime(U,Y){let re=Y;return re=this.consumeOneOrMore(U,re,I),ie(U[re])?re+1:re}consumeRepeatInterval(U,Y){if(!z(U[Y]))throw new Error("Invalid repeat interval");for(Y+=1;I(U[Y]);)Y+=1;return ie(U[Y])&&(Y+=1),Y}consumePort(U,Y){return this.consumeOneOrMore(U,Y,I)}consume(U,Y,re){for(let Oe=0;Oe<re.length;Oe++){if(Y+Oe>=U.length)throw new Error("consume exceeding value length");if(U[Y+Oe]!==re[Oe])throw new Error("consume ".concat(re," failed at ").concat(Oe))}return Y+re.length}consumeTill(U,Y,re){let Oe=Y;for(;Oe<U.length&&(typeof re!="string"||U[Oe]!==re)&&(typeof re!="function"||!re(U[Oe]));)Oe++;return Oe}}class vt extends Ne{constructor(){super(),De(this,"records",[]),De(this,"currentLine",0)}parse(U){const Y=this.probeEOL(U);this.records=U.split(Y).filter(mr=>!!mr.trim()).map(this.parseLine),this.currentLine=0;const re=this.parseVersion(),Oe=this.parseOrigin(),pt=this.parseSessionName(),Sn=this.parseInformation(),vi=this.parseUri(),Fo=this.parseEmail(),Zc=this.parsePhone(),uE=this.parseConnection(),dE=this.parseBandWidth(),Ma=this.parseTimeFields(),iu=this.parseKey(),Zh=this.parseSessionAttribute(),Xn=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:re,origin:Oe,sessionName:pt,information:Sn,uri:vi,emails:Fo,phones:Zc,connection:uE,bandwidths:dE,timeFields:Ma,key:iu,attributes:Zh,mediaDescriptions:Xn}}getCurrentRecord(){const U=this.records[this.currentLine];if(!U)throw new Error("Record doesn't exit.");return U}probeEOL(U){for(let Y=0;Y<U.length;Y++)if(U[Y]===v)return U[Y-1]==="\r"?E:v;throw new Error("Invalid newline character.")}parseLine(U,Y){if(U.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const re=U[0];if(U[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:re,value:U.slice(2),line:Y,cur:0}}parseSessionAttribute(){const U=new Bn;for(;this.currentLine<this.records.length;){const Y=this.getCurrentRecord();if(Y.type!==C.ATTRIBUTE)break;const re={attField:this.extractOneOrMore(Y,Oe=>$(Oe)&&Oe!==":"),_cur:0};Y.value[Y.cur]===":"&&(Y.cur+=1,re.attValue=this.extractOneOrMore(Y,oe)),U.parse(re),this.currentLine++}return U.digest()}parseMediaAttributes(U){const Y=new fr(U);for(;this.currentLine<this.records.length;){const re=this.getCurrentRecord();if(re.type!==C.ATTRIBUTE)break;const Oe={attField:this.extractOneOrMore(re,pt=>$(pt)&&pt!==":"),_cur:0};re.value[re.cur]===":"&&(re.cur+=1,Oe.attValue=this.extractOneOrMore(re,oe)),Y.parse(Oe),this.currentLine++}return Y.digest()}parseKey(){const U=this.getCurrentRecord();if(U.type===C.KEY){if(U.value==="prompt"||U.value==="clear:"||U.value==="base64:"||U.value==="uri:")return U.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const U=this.getCurrentRecord();if(U.type===C.ZONE_ADJUSTMENTS){const Y=[];for(;;)try{const re=this.extract(U,this.consumeTime);this.consumeSpaceForRecord(U);let Oe=!1;U.value[U.cur]==="-"&&(Oe=!0,U.cur+=1);const pt=this.extract(U,this.consumeTypedTime);Y.push({time:re,typedTime:pt,back:Oe})}catch{break}if(Y.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,Y}return[]}parseRepeat(){const U=[];for(;;){const Y=this.getCurrentRecord();if(Y.type!==C.REPEAT)break;{const re=this.extract(Y,this.consumeRepeatInterval),Oe=this.parseTypedTime(Y);U.push({repeatInterval:re,typedTimes:Oe}),this.currentLine++}}return U}parseTypedTime(U){const Y=[];for(;;)try{this.consumeSpaceForRecord(U),Y.push(this.extract(U,this.consumeTypedTime))}catch{break}if(Y.length===0)throw new Error("Invalid typed time.");return Y}parseTime(){const U=this.getCurrentRecord(),Y=this.extract(U,this.consumeTime);this.consumeSpaceForRecord(U);const re=this.extract(U,this.consumeTime);return this.currentLine++,{startTime:Y,stopTime:re}}parseBandWidth(){const U=[];for(;this.currentLine<this.records.length;){const Y=this.getCurrentRecord();if(Y.type!==C.BANDWIDTH)break;{const re=this.extractOneOrMore(Y,$);if(Y.value[Y.cur]!==":")throw new Error("Invalid bandwidth field.");Y.cur++;const Oe=this.extractOneOrMore(Y,I);U.push({bwtype:re,bandwidth:Oe}),this.currentLine++}}return U}parseVersion(){const U=this.getCurrentRecord();if(U.type!==C.VERSION)throw new Error("first sdp record must be version");const Y=U.value.slice(0,this.consumeOneOrMore(U.value,0,I));if(Y.length!==U.value.length)throw new Error('invalid proto version, "v='.concat(U.value,'"'));return this.currentLine++,Y}parseOrigin(){const U=this.getCurrentRecord();if(U.type!==C.ORIGIN)throw new Error("second line of sdp must be origin");const Y=this.extractOneOrMore(U,W);this.consumeSpaceForRecord(U);const re=this.extractOneOrMore(U,I);this.consumeSpaceForRecord(U);const Oe=this.extractOneOrMore(U,I);this.consumeSpaceForRecord(U);const pt=this.extractOneOrMore(U,$);this.consumeSpaceForRecord(U);const Sn=this.extractOneOrMore(U,$);this.consumeSpaceForRecord(U);const vi=this.extract(U,this.consumeUnicastAddress);return this.currentLine++,{username:Y,sessId:re,sessVersion:Oe,nettype:pt,addrtype:Sn,unicastAddress:vi}}parseSessionName(){const U=this.getCurrentRecord();if(U.type===C.SESSION_NAME){const Y=this.extract(U,this.consumeText);return this.currentLine++,Y}}parseInformation(){const U=this.getCurrentRecord();if(U.type!==C.INFORMATION)return;const Y=this.extract(U,this.consumeText);return this.currentLine++,Y}parseUri(){const U=this.getCurrentRecord();if(U.type===C.URI)return this.currentLine++,U.value}parseEmail(){const U=[];for(;;){const Y=this.getCurrentRecord();if(Y.type!==C.EMAIL)break;U.push(Y.value),this.currentLine++}return U}parsePhone(){const U=[];for(;;){const Y=this.getCurrentRecord();if(Y.type!==C.PHONE)break;U.push(Y.value),this.currentLine++}return U}parseConnection(){const U=this.getCurrentRecord();if(U.type===C.CONNECTION){const Y=this.extractOneOrMore(U,$);this.consumeSpaceForRecord(U);const re=this.extractOneOrMore(U,$);this.consumeSpaceForRecord(U);const Oe=this.extract(U,this.consumeAddress);return this.currentLine++,{nettype:Y,addrtype:re,address:Oe}}}parseMedia(){const U=this.getCurrentRecord(),Y=this.extract(U,this.consumeToken);this.consumeSpaceForRecord(U);let re=this.extract(U,this.consumePort);U.value[U.cur]==="/"&&(U.cur+=1,re+=this.extract(U,this.consumeInteger)),this.consumeSpaceForRecord(U);const Oe=[];for(Oe.push(this.extract(U,this.consumeToken));U.value[U.cur]==="/";)U.cur+=1,Oe.push(this.extract(U,this.consumeToken));if(Oe.length===0)throw new Error("Invalid proto");const pt=this.parseFmt(U);return this.currentLine++,{mediaType:Y,port:re,protos:Oe,fmts:pt}}parseTimeFields(){const U=[];for(;this.getCurrentRecord().type===C.TIME;){const Y=this.parseTime(),re=this.parseRepeat(),Oe=this.parseZone();U.push({time:Y,repeats:re,zones:Oe})}return U}parseMediaDescription(){const U=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===C.MEDIA;){const Y=this.parseMedia(),re=this.parseInformation(),Oe=this.parseConnections(),pt=this.parseBandWidth(),Sn=this.parseKey(),vi=this.parseMediaAttributes(Y);U.push({media:Y,information:re,connections:Oe,bandwidths:pt,key:Sn,attributes:vi})}return U}parseConnections(){const U=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===C.CONNECTION;)U.push(this.parseConnection());return U}parseFmt(U){const Y=[];for(;;)try{this.consumeSpaceForRecord(U),Y.push(this.extract(U,this.consumeToken))}catch{break}if(Y.length===0)throw new Error("Invalid fmts");return Y}extract(U,Y,...re){const Oe=Y.call(this,U.value,U.cur,...re),pt=U.value.slice(U.cur,Oe);return U.cur=Oe,pt}extractOneOrMore(U,Y){const re=this.consumeOneOrMore(U.value,U.cur,Y),Oe=U.value.slice(U.cur,re);return U.cur=re,Oe}consumeSpaceForRecord(U){if(U.value[U.cur]!==y)throw new Error("Invalid space at ".concat(U.cur,"."));U.cur+=1}}class Ft extends Ne{constructor(...U){super(...U),De(this,"attributes",void 0),De(this,"digested",!1)}extractOneOrMore(U,Y,re){const Oe=this.consumeOneOrMore(U.attValue,U._cur,Y),pt=U.attValue.slice(U._cur,Oe),[Sn,vi]=re||[];if(typeof Sn=="number"&&pt.length<Sn)throw new Error("error in length, should be more or equal than ".concat(Sn," characters."));if(typeof vi=="number"&&pt.length>vi)throw new Error("error in length, should be less or equal than ".concat(vi," characters."));return U._cur=Oe,pt}consumeAttributeSpace(U){if(U.attValue[U._cur]!==y)throw new Error("Invalid space at ".concat(U._cur,"."));U._cur+=1}extract(U,Y,...re){if(!U.attValue)throw new Error("Nothing to extract from attValue.");const Oe=Y.call(this,U.attValue,U._cur,...re),pt=U.attValue.slice(U._cur,Oe);return U._cur=Oe,pt}atEnd(U){if(!U.attValue)throw new Error;return U._cur>=U.attValue.length}peekChar(U){if(!U.attValue)throw new Error;return U.attValue[U._cur]}peek(U,Y){if(!U.attValue)throw new Error;for(let re=0;re<Y.length;re++)if(Y[re]!==U.attValue[U._cur+re])return!1;return!0}parseIceUfrag(U){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(U,Re,[4,256])}parseIcePwd(U){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(U,Re,[22,256])}parseIceOptions(U){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const Y=[];for(;!this.atEnd(U);){Y.push(this.extractOneOrMore(U,Re));try{this.consumeAttributeSpace(U)}catch(re){if(this.atEnd(U))break;throw re}}this.attributes.iceOptions=Y}parseFingerprint(U){const Y=this.extract(U,this.consumeToken);this.consumeAttributeSpace(U);const re=this.extract(U,this.consumeTill);this.attributes.fingerprints.push({hashFunction:Y,fingerprint:re})}parseExtmap(U){const Y=this.extractOneOrMore(U,I);let re;this.peekChar(U)==="/"&&(this.extract(U,this.consume,"/"),re=this.extract(U,this.consumeToken)),this.consumeAttributeSpace(U);const Oe=this.extract(U,this.consumeTill,y),pt=Se(Se({entry:parseInt(Y,10)},re&&{direction:re}),{},{extensionName:Oe});this.peekChar(U)===y&&(this.consumeAttributeSpace(U),pt.extensionAttributes=this.extract(U,this.consumeTill)),this.attributes.extmaps.push(pt)}parseSetup(U){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const Y=this.extract(U,this.consumeTill);if(Y!=="active"&&Y!=="passive"&&Y!=="actpass"&&Y!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=Y}}class Bn extends Ft{constructor(...U){super(...U),De(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(U){if(this.digested)throw new Error("already digested");try{switch(U.attField){case"group":this.parseGroup(U);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(U);break;case"ice-pwd":this.parseIcePwd(U);break;case"ice-options":this.parseIceOptions(U);break;case"fingerprint":this.parseFingerprint(U);break;case"setup":this.parseSetup(U);break;case"tls-id":this.parseTlsId(U);break;case"identity":this.parseIdentity(U);break;case"extmap":this.parseExtmap(U);break;case"msid-semantic":this.parseMsidSemantic(U);break;default:U.ignored=!0,this.attributes.unrecognized.push(U)}}catch(Y){throw console.error("parsing session attribute ".concat(U.attField,' error, "a=').concat(U.attField,":").concat(U.attValue,'"')),Y}if(!U.ignored&&U.attValue&&!this.atEnd(U))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(U){const Y=this.extract(U,this.consumeToken),re=[];for(;!this.atEnd(U)&&this.peekChar(U)===y;)this.consumeAttributeSpace(U),re.push(this.extract(U,this.consumeToken));this.attributes.groups.push({semantic:Y,identificationTag:re})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(U){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(U,Ce)}parseIdentity(U){const Y=this.extractOneOrMore(U,ge),re=[];for(;!this.atEnd(U)&&this.peekChar(U)===y;){this.consumeAttributeSpace(U);const Oe=this.extract(U,this.consumeToken);this.extract(U,this.consume,"=");const pt=this.extractOneOrMore(U,Sn=>Sn!==y&&oe(Sn));re.push({name:Oe,value:pt})}this.attributes.identities.push({assertionValue:Y,extensions:re})}parseMsidSemantic(U){this.peekChar(U)===y&&this.consumeAttributeSpace(U);const Y={semantic:this.extract(U,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(U)}catch{break}if(this.peekChar(U)==="*"){this.extract(U,this.consume,"*"),Y.applyForAll=!0;break}{const re=this.extract(U,this.consumeTill,y);Y.identifierList.push(re)}}this.attributes.msidSemantic=Y}}class fr extends Ft{constructor(U){super(),De(this,"attributes",void 0),U.protos.indexOf("RTP")!==-1||U.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(U){if(this.digested)throw new Error("already digested");try{switch(U.attField){case"extmap":this.parseExtmap(U);break;case"setup":this.parseSetup(U);break;case"ice-ufrag":this.parseIceUfrag(U);break;case"ice-pwd":this.parseIcePwd(U);break;case"ice-options":this.parseIceOptions(U);break;case"candidate":this.parseCandidate(U);break;case"remote-candidate":this.parseRemoteCandidate(U);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(U);break;case"rtpmap":this.parseRtpmap(U);break;case"ptime":this.parsePtime(U);break;case"maxptime":this.parseMaxPtime(U);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(U);break;case"ssrc":this.parseSSRC(U);break;case"fmtp":this.parseFmtp(U);break;case"rtcp-fb":this.parseRtcpFb(U);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(U);break;case"mid":this.parseMid(U);break;case"msid":this.parseMsid(U);break;case"imageattr":this.parseImageAttr(U);break;case"rid":this.parseRid(U);break;case"simulcast":this.parseSimulcast(U);break;case"sctp-port":this.parseSctpPort(U);break;case"max-message-size":this.parseMaxMessageSize(U);break;case"ssrc-group":this.parseSSRCGroup(U);break;default:U.ignored=!0,this.attributes.unrecognized.push(U)}}catch(Y){throw console.error("parsing media attribute ".concat(U.attField,' error, "a=').concat(U.attField,":").concat(U.attValue,'"')),Y}if(!U.ignored&&U.attValue&&!this.atEnd(U))throw new Error("attribute parsing error")}parseCandidate(U){const Y=this.extractOneOrMore(U,Re,[1,32]);this.consumeAttributeSpace(U);const re=this.extractOneOrMore(U,I,[1,5]);this.consumeAttributeSpace(U);const Oe=this.extract(U,this.consumeToken);this.consumeAttributeSpace(U);const pt=this.extractOneOrMore(U,I,[1,10]);this.consumeAttributeSpace(U);const Sn=this.extract(U,this.consumeAddress);this.consumeAttributeSpace(U);const vi=this.extract(U,this.consumePort);this.consumeAttributeSpace(U),this.extract(U,this.consume,"typ"),this.consumeAttributeSpace(U);const Fo={foundation:Y,componentId:re,transport:Oe,priority:pt,connectionAddress:Sn,port:vi,type:this.extract(U,this.consumeToken),extension:{}};for(this.peek(U," raddr")&&(this.extract(U,this.consume," raddr"),this.consumeAttributeSpace(U),Fo.relAddr=this.extract(U,this.consumeAddress)),this.peek(U," rport")&&(this.extract(U,this.consume," rport"),this.consumeAttributeSpace(U),Fo.relPort=this.extract(U,this.consumePort));this.peekChar(U)===y;){this.consumeAttributeSpace(U);const Zc=this.extract(U,this.consumeToken);this.consumeAttributeSpace(U),Fo.extension[Zc]=this.extractOneOrMore(U,k)}this.attributes.candidates.push(Fo)}parseRemoteCandidate(U){const Y=[];for(;;){const re=this.extractOneOrMore(U,I,[1,5]);this.consumeAttributeSpace(U);const Oe=this.extract(U,this.consumeAddress);this.consumeAttributeSpace(U);const pt=this.extract(U,this.consumePort);Y.push({componentId:re,connectionAddress:Oe,port:pt});try{this.consumeAttributeSpace(U)}catch{break}}this.attributes.remoteCandidatesList.push(Y)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(U){const Y=this.extract(U,this.consumeToken);this.consumeAttributeSpace(U);const re=this.extract(U,this.consumeTill,"/");this.extract(U,this.consume,"/");const Oe={encodingName:re,clockRate:this.extractOneOrMore(U,I)};this.atEnd(U)||this.peekChar(U)!=="/"||(this.extract(U,this.consume,"/"),Oe.encodingParameters=parseInt(this.extract(U,this.consumeTill),10));const pt=this.attributes.payloads.find(Sn=>Sn.payloadType===parseInt(Y,10));pt?pt.rtpMap=Oe:this.attributes.payloads.push({payloadType:parseInt(Y,10),rtpMap:Oe,rtcpFeedbacks:[]})}parsePtime(U){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(U,this.consumeTill)}parseMaxPtime(U){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(U,this.consumeTill)}parseDirection(U){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=U.attField}parseSSRC(U){const Y=this.extractOneOrMore(U,I);this.consumeAttributeSpace(U);const re=this.extract(U,this.consumeTill,":");let Oe;this.peekChar(U)===":"&&(this.extract(U,this.consume,":"),Oe=this.extract(U,this.consumeTill));const pt=this.attributes.ssrcs.find(Sn=>Sn.ssrcId===parseInt(Y,10));pt?pt.attributes[re]=Oe:this.attributes.ssrcs.push({ssrcId:parseInt(Y,10),attributes:{[re]:Oe}})}parseFmtp(U){const Y=this.extract(U,this.consumeTill,y);this.consumeAttributeSpace(U);const re=this.extract(U,this.consumeTill),Oe={};re.split(";").forEach(Sn=>{let[vi,Fo]=Sn.split("=");vi=vi.trim();const Zc=typeof Fo=="string"?Fo.trim():null;typeof vi=="string"&&vi.length>0&&(Oe[vi]=Zc)});const pt=this.attributes.payloads.find(Sn=>Sn.payloadType===parseInt(Y,10));pt?pt.fmtp={parameters:Oe}:this.attributes.payloads.push({payloadType:parseInt(Y,10),rtcpFeedbacks:[],fmtp:{parameters:Oe}})}parseFmtParameters(U){const Y={},re=this.extract(U,this.consumeTill,"=");U._cur++;const Oe=this.extract(U,this.consumeTill,";");for(Y[re]=Oe;U.attValue[U._cur]===";";){const pt=this.extract(U,this.consumeTill,"=");U._cur++;const Sn=this.extract(U,this.consumeTill,";");Y[pt]=Sn}return Y}parseRtcpFb(U){let Y="";Y=this.peekChar(U)==="*"?this.extract(U,this.consume,"*"):this.extract(U,this.consumeTill,y),this.consumeAttributeSpace(U);const re=this.extract(U,this.consumeTill,y);let Oe;if(re==="trr-int")Oe={type:re,interval:this.extract(U,this.consumeTill)};else{const pt={type:re};this.peekChar(U)===y&&(this.consumeAttributeSpace(U),pt.parameter=this.extract(U,this.consumeToken),this.peekChar(U)===y&&(pt.additional=this.extract(U,this.consumeTill))),Oe=pt}if(Y==="*")this.attributes.rtcpFeedbackWildcards.push(Oe);else{const pt=this.attributes.payloads.find(Sn=>Sn.payloadType===parseInt(Y,10));pt?pt.rtcpFeedbacks.push(Oe):this.attributes.payloads.push({payloadType:parseInt(Y,10),rtcpFeedbacks:[Oe]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(U){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const Y={port:this.extract(U,this.consumePort)};this.peekChar(U)===y&&(this.consumeAttributeSpace(U),Y.netType=this.extractOneOrMore(U,$),this.consumeAttributeSpace(U),Y.addressType=this.extractOneOrMore(U,$),this.consumeAttributeSpace(U),Y.address=this.extract(U,this.consumeAddress)),this.attributes.rtcp=Y}parseMsid(U){const Y={id:this.extractOneOrMore(U,$,[1,64])};this.peekChar(U)===y&&(this.consumeAttributeSpace(U),Y.appdata=this.extractOneOrMore(U,$,[1,64])),this.attributes.msids.push(Y)}parseImageAttr(U){this.attributes.imageattr.push(U.attValue)}parseRid(U){const Y=this.extractOneOrMore(U,Oe=>X(Oe)||I(Oe)||Oe==="_"||Oe==="-");this.consumeAttributeSpace(U);const re={id:Y,direction:this.extract(U,this.consumeToken),params:[]};if(this.peekChar(U)===y){if(this.consumeAttributeSpace(U),this.peek(U,"pt=")){this.extract(U,this.consume,"pt=");const Oe=[];for(;;){const pt=this.extract(U,this.consumeToken);Oe.push(pt);try{this.extract(U,this.consume,",")}catch{break}}re.payloads=Oe,this.peekChar(U)===y&&this.extract(U,this.consume,y)}for(;;){const Oe=this.extract(U,this.consumeToken);switch(Oe){case"depend":{const pt={type:Oe,rids:this.extract(U,this.consume,"=").split(",")};re.params.push(pt);break}default:{const pt={type:Oe};this.peekChar(U)==="="&&(this.extract(U,this.consume,"="),pt.val=this.extract(U,this.consumeTill,";")),re.params.push(pt)}}try{this.extract(U,this.consume,";")}catch{break}}}this.attributes.rids.push(re)}parseSimulcast(U){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=U.attValue,this.extract(U,this.consumeTill)}parseSctpPort(U){this.attributes.sctpPort=this.extractOneOrMore(U,I,[1,5])}parseMaxMessageSize(U){this.attributes.maxMessageSize=this.extractOneOrMore(U,I,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(U){this.attributes.mid=this.extract(U,this.consumeToken)}parseSSRCGroup(U){const Y=this.extract(U,this.consumeToken),re=[];for(;;)try{this.consumeAttributeSpace(U);const Oe=this.extract(U,this.consumeInteger);re.push(parseInt(Oe,10))}catch{break}this.attributes.ssrcGroups.push({semantic:Y,ssrcIds:re})}}function bn(Pe,U,Y){return U in Pe?Object.defineProperty(Pe,U,{value:Y,enumerable:!0,configurable:!0,writable:!0}):Pe[U]=Y,Pe}class Mo{constructor(){bn(this,"eol",E)}print(U,Y){let re="";return Y&&(this.eol=Y),re+=this.printVersion(U.version),re+=this.printOrigin(U.origin),re+=this.printSessionName(U.sessionName),re+=this.printInformation(U.information),re+=this.printUri(U.uri),re+=this.printEmail(U.emails),re+=this.printPhone(U.phones),re+=this.printConnection(U.connection),re+=this.printBandwidth(U.bandwidths),re+=this.printTimeFields(U.timeFields),re+=this.printKey(U.key),re+=this.printSessionAttributes(U.attributes),re+=this.printMediaDescription(U.mediaDescriptions),re}printVersion(U){return"v=".concat(U).concat(this.eol)}printOrigin(U){return"o=".concat(U.username," ").concat(U.sessId," ").concat(U.sessVersion," ").concat(U.nettype," ").concat(U.addrtype," ").concat(U.unicastAddress).concat(this.eol)}printSessionName(U){return U?"s=".concat(U).concat(this.eol):""}printInformation(U){return U?"i=".concat(U).concat(this.eol):""}printUri(U){return U?"u=".concat(U).concat(this.eol):""}printEmail(U){let Y="";for(const re of U)Y+="e=".concat(re).concat(this.eol);return Y}printPhone(U){let Y="";for(const re of U)Y+="e=".concat(re).concat(this.eol);return Y}printConnection(U){return U?"c=".concat(U.nettype," ").concat(U.addrtype," ").concat(U.address).concat(this.eol):""}printBandwidth(U){let Y="";for(const re of U)Y+="b=".concat(re.bwtype,":").concat(re.bandwidth).concat(this.eol);return Y}printTimeFields(U){let Y="";for(const re of U){Y+="t=".concat(re.time.startTime," ").concat(re.time.startTime).concat(this.eol);for(const Oe of re.repeats)Y+="r=".concat(Oe.repeatInterval," ").concat(Oe.typedTimes.join(" ")).concat(this.eol);re.zoneAdjustments&&(Y+="z=",Y+="z=".concat(re.zoneAdjustments.map(Oe=>"".concat(Oe.time," ").concat(Oe.back?"-":""," ").concat(Oe.typedTime)).join(" ")).concat(this.eol),Y+=this.eol)}return Y}printKey(U){return U?"k=".concat(U).concat(this.eol):""}printAttributes(U){let Y="";for(const re of U)Y+="a=".concat(re.attField).concat(re.attValue?":".concat(re.attValue):"").concat(this.eol);return Y}printMediaDescription(U){let Y="";for(const re of U)Y+=this.printMedia(re.media),Y+=this.printInformation(re.information),Y+=this.printConnections(re.connections),Y+=this.printBandwidth(re.bandwidths),Y+=this.printKey(re.key),Y+=this.printMediaAttributes(re);return Y}printConnections(U){let Y="";for(const re of U)Y+=this.printConnection(re);return Y}printMedia(U){return"m=".concat(U.mediaType," ").concat(U.port," ").concat(U.protos.join("/")," ").concat(U.fmts.join(" ")).concat(this.eol)}printSessionAttributes(U){return new xe(this.eol).print(U)}printMediaAttributes(U){return new Be(this.eol).print(U)}}class Ie{constructor(U){bn(this,"eol",void 0),this.eol=U}printIceUfrag(U){return U===void 0?"":"a=ice-ufrag:".concat(U).concat(this.eol)}printIcePwd(U){return U===void 0?"":"a=ice-pwd:".concat(U).concat(this.eol)}printIceOptions(U){return U===void 0?"":"a=ice-options:".concat(U.join(y)).concat(this.eol)}printFingerprints(U){return U.length>0?U.map(Y=>"a=fingerprint:".concat(Y.hashFunction).concat(y).concat(Y.fingerprint)).join(this.eol)+this.eol:""}printExtmap(U){return U.map(Y=>"a=extmap:".concat(Y.entry).concat(Y.direction?"/".concat(Y.direction):"").concat(y).concat(Y.extensionName).concat(Y.extensionAttributes?"".concat(y).concat(Y.extensionAttributes):"").concat(this.eol)).join("")}printSetup(U){return U===void 0?"":"a=setup:".concat(U).concat(this.eol)}printUnrecognized(U){return U.map(Y=>"a=".concat(Y.attField).concat(Y.attValue?":".concat(Y.attValue):"").concat(this.eol)).join("")}}class xe extends Ie{print(U){let Y="";return Y+=this.printGroups(U.groups),Y+=this.printMsidSemantic(U.msidSemantic),Y+=this.printIceLite(U.iceLite),Y+=this.printIceUfrag(U.iceUfrag),Y+=this.printIcePwd(U.icePwd),Y+=this.printIceOptions(U.iceOptions),Y+=this.printFingerprints(U.fingerprints),Y+=this.printSetup(U.setup),Y+=this.printTlsId(U.tlsId),Y+=this.printIdentity(U.identities),Y+=this.printExtmap(U.extmaps),Y+=this.printUnrecognized(U.unrecognized),Y}printGroups(U){let Y="";return U.length>0&&(Y+=U.map(re=>"a=group:".concat(re.semantic).concat(re.identificationTag.map(Oe=>"".concat(y).concat(Oe)).join("")).concat(this.eol)).join("")),Y}printIceLite(U){return U===void 0?"":"a=ice-lite"+this.eol}printTlsId(U){return U?"a=tls-id:".concat(U).concat(this.eol):""}printIdentity(U){return U.length===0?"":U.map(Y=>"a=identity:".concat(Y.assertionValue).concat(Y.extensions.map(re=>"".concat(y).concat(re.name).concat(re.value?"=".concat(re.value):"")))).join(this.eol)+this.eol}printMsidSemantic(U){if(!U)return"";let Y="a=msid-semantic:".concat(U.semantic);return U.applyForAll?Y+="".concat(y,"*"):U.identifierList.length>0&&(Y+=U.identifierList.map(re=>"".concat(y).concat(re))),Y+this.eol}}class Be extends Ie{print(U){const Y=U.attributes;let re="";return re+=this.printRTCP(Y.rtcp),re+=this.printIceUfrag(Y.iceUfrag),re+=this.printIcePwd(Y.icePwd),re+=this.printIceOptions(Y.iceOptions),re+=this.printCandidates(Y.candidates),re+=this.printRemoteCandidatesList(Y.remoteCandidatesList),re+=this.printEndOfCandidates(Y.endOfCandidates),re+=this.printFingerprints(Y.fingerprints),re+=this.printSetup(Y.setup),re+=this.printMid(Y.mid),re+=this.printExtmap(Y.extmaps),re+=this.printRTPRelated(Y),re+=this.printPtime(Y.ptime),re+=this.printMaxPtime(Y.maxPtime),re+=this.printDirection(Y.direction),re+=this.printSSRCGroups(Y.ssrcGroups),re+=this.printSSRC(Y.ssrcs),re+=this.printRTCPMux(Y.rtcpMux),re+=this.printRTCPMuxOnly(Y.rtcpMuxOnly),re+=this.printRTCPRsize(Y.rtcpRsize),re+=this.printMSId(Y.msids),re+=this.printImageattr(Y.imageattr),re+=this.printRid(Y.rids),re+=this.printSimulcast(Y.simulcast),re+=this.printSCTPPort(Y.sctpPort),re+=this.printMaxMessageSize(Y.maxMessageSize),re+=this.printUnrecognized(Y.unrecognized),re}printCandidates(U){return U.map(Y=>"a=candidate:".concat(Y.foundation).concat(y).concat(Y.componentId).concat(y).concat(Y.transport).concat(y).concat(Y.priority).concat(y).concat(Y.connectionAddress).concat(y).concat(Y.port).concat(y,"typ").concat(y).concat(Y.type).concat(Y.relAddr?"".concat(y,"raddr").concat(y).concat(Y.relAddr):"").concat(Y.relPort?"".concat(y,"rport").concat(y).concat(Y.relPort):"").concat(Object.keys(Y.extension).map(re=>"".concat(y).concat(re).concat(y).concat(Y.extension[re])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(U){return U.map(Y=>"a=remote-candidates:".concat(Y.join(y)).concat(this.eol)).join("")}printEndOfCandidates(U){return U===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(U){if(!U.payloads)return"";const Y=U.payloads;let re="";re+=U.rtcpFeedbackWildcards.map(Oe=>this.printRTCPFeedback("*",Oe)).join("");for(const Oe of Y)re+=this.printRtpMap(Oe.payloadType,Oe.rtpMap),re+=this.printFmtp(Oe.payloadType,Oe.fmtp),re+=Oe.rtcpFeedbacks.map(pt=>this.printRTCPFeedback(Oe.payloadType,pt)).join("");return re}printFmtp(U,Y){if(!Y)return"";const re=Object.keys(Y.parameters);return re.length===1&&Y.parameters[re[0]]===null?"a=fmtp:".concat(U).concat(y).concat(re[0]).concat(this.eol):"a=fmtp:".concat(U).concat(y).concat(Object.keys(Y.parameters).map(Oe=>"".concat(Oe,"=").concat(Y.parameters[Oe])).join(";")).concat(this.eol)}printRtpMap(U,Y){return Y?"a=rtpmap:".concat(U).concat(y).concat(Y.encodingName,"/").concat(Y.clockRate).concat(Y.encodingParameters?"/".concat(Y.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(U,Y){let re="a=rtcp-fb:".concat(U).concat(y),Oe=Y;return Oe.type==="trr-int"?re+="ttr-int".concat(y).concat(Oe.interval):(re+="".concat(Oe.type),Oe.parameter&&(re+="".concat(y).concat(Oe.parameter),Oe.additional&&(re+="".concat(y).concat(Oe.additional)))),re+this.eol}printPtime(U){return U===void 0?"":"a=ptime:".concat(U).concat(this.eol)}printMaxPtime(U){return U===void 0?"":"a=maxptime:".concat(U).concat(this.eol)}printDirection(U){return U===void 0?"":"a=".concat(U).concat(this.eol)}printSSRC(U){return U.map(Y=>Object.keys(Y.attributes).map(re=>"a=ssrc:".concat(Y.ssrcId.toString(10)).concat(y).concat(re).concat(Y.attributes[re]?":".concat(Y.attributes[re]):"").concat(this.eol)).join("")).join("")}printRTCPMux(U){return U===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(U){return U===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(U){return U===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(U){if(U===void 0)return"";let Y="a=rtcp:".concat(U.port);return U.netType&&(Y+="".concat(y).concat(U.netType)),U.addressType&&(Y+="".concat(y).concat(U.addressType)),U.address&&(Y+="".concat(y).concat(U.address)),Y+this.eol}printMSId(U){return U.map(Y=>"a=msid:".concat(Y.id).concat(Y.appdata?"".concat(y).concat(Y.appdata):"").concat(this.eol)).join("")}printImageattr(U){return U.map(Y=>"a=imageattr:".concat(Y).concat(this.eol)).join("")}printRid(U){return U.map(Y=>{let re="a=rid:".concat(Y.id).concat(y).concat(Y.direction);return Y.payloads&&(re+="".concat(y,"pt=").concat(Y.payloads.join(","))),Y.params.length>0&&(re+="".concat(y).concat(Y.params.map(Oe=>Oe.type==="depend"?"depend=".concat(Oe.rids.join(",")):"".concat(Oe.type,"=").concat(Oe.val)).join(";"))),re+this.eol}).join("")}printSimulcast(U){return U===void 0?"":"a=simulcast:".concat(U).concat(this.eol)}printSCTPPort(U){return U===void 0?"":"a=sctp-port:".concat(U).concat(this.eol)}printMaxMessageSize(U){return U===void 0?"":"a=max-message-size:".concat(U).concat(this.eol)}printMid(U){return U===void 0?"":"a=mid:".concat(U).concat(this.eol)}printSSRCGroups(U){return U.map(Y=>"a=ssrc-group:".concat(Y.semantic).concat(Y.ssrcIds.map(re=>"".concat(y).concat(re.toString(10))).join("")).concat(this.eol)).join("")}}function at(Pe){return new vt().parse(Pe)}function Gt(Pe,U){return new Mo().print(Pe,U)}}},a={};function l(u){if(a[u])return a[u].exports;var h=a[u]={exports:{}};return r[u](h,h.exports,l),h.exports}return l.d=(u,h)=>{for(var f in h)l.o(h,f)&&!l.o(u,f)&&Object.defineProperty(u,f,{enumerable:!0,get:h[f]})},l.o=(u,h)=>Object.prototype.hasOwnProperty.call(u,h),l.r=u=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(u,"__esModule",{value:!0})},l(8)})()})(yF);var Hn=yF.exports;function SF(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function CF(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SF(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):SF(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}function aR(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;const{filterRTX:l,filterVideoFec:u,filterAudioFec:h,filterAudioCodec:f,filterVideoCodec:v}=t,{useXR:E}=r;let y=[],C=[],I=[],k=[],W=!1,$=!1;if(Hn.parse(i).mediaDescriptions.forEach(z=>{a&&a!==z.attributes.direction||(z.media.mediaType!=="video"||W||(C=z.attributes.payloads,k=z.attributes.extmaps,W=!0),z.media.mediaType!=="audio"||$||(y=z.attributes.payloads,I=z.attributes.extmaps,$=!0))}),!k||C.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!I||y.length===0)throw new Error("Cannot get audio capabilities from SDP.");return C.forEach(z=>{var X;(X=z.rtpMap)!==null&&X!==void 0&&X.clockRate&&(z.rtpMap.clockRate=parseInt(z.rtpMap.clockRate)),E&&z.rtcpFeedbacks.push({type:"rrtr"})}),y.forEach(z=>{var X;(X=z.rtpMap)!==null&&X!==void 0&&X.clockRate&&(z.rtpMap.clockRate=parseInt(z.rtpMap.clockRate)),E&&z.rtcpFeedbacks.push({type:"rrtr"})}),l&&(y=y.filter(z=>{var X;return((X=z.rtpMap)===null||X===void 0?void 0:X.encodingName.toLowerCase())!=="rtx"}),C=C.filter(z=>{var X;return((X=z.rtpMap)===null||X===void 0?void 0:X.encodingName.toLowerCase())!=="rtx"})),u&&(C=C.filter(z=>{var X;return!/(red)|(ulpfec)|(flexfec)/i.test(((X=z.rtpMap)===null||X===void 0?void 0:X.encodingName)||"")})),h&&(y=y.filter(z=>{var X;return!/(red)|(ulpfec)|(flexfec)/i.test(((X=z.rtpMap)===null||X===void 0?void 0:X.encodingName)||"")})),f&&(f==null?void 0:f.length)>0&&(y=y.filter(z=>{var X;return Ke(f).call(f,((X=z.rtpMap)===null||X===void 0?void 0:X.encodingName.toLowerCase())||"")})),v&&(v==null?void 0:v.length)>0&&(C=C.filter(z=>{var X;return Ke(v).call(v,((X=z.rtpMap)===null||X===void 0?void 0:X.encodingName.toLowerCase())||"")})),{audioCodecs:y,videoCodecs:C,audioExtensions:I,videoExtensions:k}}function fd(i){const t=Hn.parse(i);let r,a;for(const l of t.mediaDescriptions){if(!r){const u=l.attributes.iceUfrag,h=l.attributes.icePwd;if(!u||!h)throw new Error("Cannot get iceUfrag or icePwd from SDP.");r={iceUfrag:u,icePwd:h}}if(!a){const u=l.attributes.fingerprints;u.length>0&&(a={fingerprints:u})}}if(!a&&t.attributes.fingerprints.length>0&&(a={fingerprints:t.attributes.fingerprints}),!a||!r)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:r,dtlsParameters:a}}function bF(i,t){const r=[],a=i.attributes.ssrcGroups.filter(h=>h.semantic==="FID"),l=i.attributes.ssrcGroups.find(h=>h.semantic==="SIM"),u=i.attributes.ssrcs;if(l)l.ssrcIds.forEach(h=>{var f;const v=(f=a.find(E=>E.ssrcIds[0]===h))===null||f===void 0?void 0:f.ssrcIds[1];r.push({ssrcId:h,rtx:t?v:void 0})});else if(a.length>0){const h=a[0].ssrcIds[0],f=a[0].ssrcIds[1];r.push({ssrcId:h,rtx:t?f:void 0})}else{if(u.length===0)throw new Error("No ssrcs found on local media description.");r.push({ssrcId:u[0].ssrcId})}return r}function TF(i,t){const{cname:r}=i;let a;t&&t.ip&&typeof t.port=="number"?(a=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:t.ip,port:t.port.toString(),type:"host",extension:{}}],L.debug("Using remote candidate from AP ".concat(t.ip,":").concat(t.port)),t.ip6&&(a.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:t.ip6,port:t.port.toString(),type:"host",extension:{}}),L.debug("Using IPV6 remote candidate from AP ".concat(t.ip6,":").concat(t.port)))):a=i.iceParameters.candidates.map(f=>({foundation:f.foundation,componentId:"1",transport:f.protocol,priority:f.priority.toString(),connectionAddress:f.ip,port:f.port.toString(),type:f.type,extension:{}}));const l={fingerprints:i.dtlsParameters.fingerprints.map(f=>({hashFunction:f.algorithm,fingerprint:f.fingerprint}))},u={iceUfrag:i.iceParameters.iceUfrag,icePwd:i.iceParameters.icePwd};let h;switch(i.dtlsParameters.role){case"server":h="passive";break;case"client":h="active";break;case"auto":h="actpass"}return{dtlsParameters:l,iceParameters:u,candidates:a,rtpCapabilities:Jv(i.rtpCapabilities),setup:h,cname:r}}function Pa(i,t,r){const a=[],l=[];return i.forEach(u=>{let{ssrcId:h,rtx:f}=u;const v=un(8,"track-"),E={ssrcId:h,attributes:CF({label:v,mslabel:r=r||un(10,""),msid:"".concat(r," ").concat(v)},t&&{cname:t})};if(a.push(E),f!==void 0){const y={ssrcId:f,attributes:CF({label:v,mslabel:r,msid:"".concat(r," ").concat(v)},t&&{cname:t})};a.push(y),l.push({semantic:"FID",ssrcIds:[h,f]})}}),i.length>1&&l.push({semantic:"SIM",ssrcIds:i.map(u=>{let{ssrcId:h}=u;return h})}),{ssrcs:a,ssrcGroups:l}}function md(i,t){t instanceof en&&i.attributes.payloads.forEach(r=>{var a;const l=(a=r.rtpMap)===null||a===void 0?void 0:a.encodingName.toLowerCase();if(!l||["opus","pcmu","pcma","g722"].indexOf(l)===-1)return;r.fmtp||(r.fmtp={parameters:{}}),r.fmtp.parameters.minptime="10",r.fmtp.parameters.useinbandfec="1";const u=t._encoderConfig;u&&l!=="pcmu"&&l!=="pcma"&&l!=="g722"&&(u.bitrate&&!Cn()&&(r.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*u.bitrate))),u.sampleRate&&(r.fmtp.parameters.maxplaybackrate="".concat(u.sampleRate),r.fmtp.parameters["sprop-maxcapturerate"]="".concat(u.sampleRate)),u.stereo&&(r.fmtp.parameters.stereo="1",r.fmtp.parameters["sprop-stereo"]="1"))})}function sR(i){const t=i.attributes.unrecognized.findIndex(r=>r.attField==="x-google-flag"&&r.attValue==="conference");t!==-1&&i.attributes.unrecognized.splice(t,1)}function cR(i,t){var r;if(!(t instanceof bt&&t._encoderConfig&&t._hints.indexOf(vn.SCREEN_TRACK)===-1))return;const a=t._encoderConfig;fn().supportMinBitrate&&a.bitrateMin&&i.attributes.payloads.forEach(l=>{var u,h;Ke(u=["h264","h265","vp8","vp9","av1"]).call(u,((h=l.rtpMap)===null||h===void 0?void 0:h.encodingName.toLowerCase())||"")&&(l.fmtp||(l.fmtp={parameters:{}}),l.fmtp.parameters["x-google-min-bitrate"]="".concat(a.bitrateMin))}),fn().supportMinBitrate&&!Ke(r=t._hints).call(r,vn.LOW_STREAM)&&a.bitrateMax&&i.attributes.payloads.forEach(l=>{var u,h;Ke(u=["h264","h265","vp8","vp9","av1"]).call(u,((h=l.rtpMap)===null||h===void 0?void 0:h.encodingName.toLowerCase())||"")&&(l.fmtp||(l.fmtp={parameters:{}}),l.fmtp.parameters["x-google-start-bitrate"]="".concat(Z("X_GOOGLE_START_BITRATE")||Math.floor(a.bitrateMax)))})}function RF(i){if(i.media.mediaType!=="video")return;const t=Wt();if(t.name!==Zt.SAFARI&&t.os!==Rr.IOS)return;const r=i.attributes.extmaps.findIndex(a=>/video-orientation/g.test(a.extensionName));r!==-1&&i.attributes.extmaps.splice(r,1)}function Yv(i,t,r){if(!t)return;let a,l;if(i.media.mediaType==="video"?(a=r.videoExtensions,l=r.videoCodecs):(a=r.audioExtensions,l=r.audioCodecs),t.twcc===!0){const u=a.find(h=>h.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");u&&(i.attributes.extmaps.find(f=>f.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01")||i.attributes.extmaps.push({entry:u.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"}),function(f,v){return v.filter(E=>!!f.find(y=>y.payloadType===E.payloadType&&!!y.rtcpFeedbacks.find(C=>C.type==="transport-cc")))}(l,i.attributes.payloads).forEach(f=>{f.rtcpFeedbacks.find(v=>v.type==="transport-cc")||f.rtcpFeedbacks.push({type:"transport-cc"})}))}else if(t.twcc===!1){const u=i.attributes.extmaps.findIndex(h=>h.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");u!==-1&&i.attributes.extmaps.splice(u,1),i.attributes.payloads.forEach(h=>{const f=h.rtcpFeedbacks.findIndex(v=>v.type==="transport-cc");f!==-1&&h.rtcpFeedbacks.splice(f,1)})}if(t.remb===!0){const u=a.find(h=>h.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");u&&(i.attributes.extmaps.find(f=>f.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time")||i.attributes.extmaps.push({entry:u.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}),function(f,v){return v.filter(E=>!!f.find(y=>y.payloadType===E.payloadType&&!!y.rtcpFeedbacks.find(C=>C.type==="goog-remb")))}(l,i.attributes.payloads).forEach(f=>{f.rtcpFeedbacks.find(v=>v.type==="goog-remb")||f.rtcpFeedbacks.push({type:"goog-remb"})}))}else if(t.remb===!1){const u=i.attributes.extmaps.findIndex(h=>h.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");u!==-1&&i.attributes.extmaps.splice(u,1),i.attributes.payloads.forEach(h=>{const f=h.rtcpFeedbacks.findIndex(v=>v.type==="goog-remb");f!==-1&&h.rtcpFeedbacks.splice(f,1)})}}function lR(i,t,r){if(Cn()||i.media.mediaType!=="video"||!(t instanceof bt)||r!=="vp9"&&r!=="vp8"||r==="vp8"&&!Z("SIMULCAST")||t._scalabilityMode===void 0||t._scalabilityMode.numSpatialLayers<=1)return;const a=r==="vp8"?2:t._scalabilityMode.numSpatialLayers,l=i.attributes.ssrcs[0],u=i.attributes.ssrcGroups.find(f=>f.semantic==="FID"&&f.ssrcIds[0]===l.ssrcId),h={semantic:"SIM",ssrcIds:[l.ssrcId]};for(let f=1;f<a;f++)i.attributes.ssrcs.push({ssrcId:l.ssrcId+f,attributes:ar(l.attributes)}),h.ssrcIds.push(l.ssrcId+f),u&&(i.attributes.ssrcs.push({ssrcId:u.ssrcIds[1]+f,attributes:ar(l.attributes)}),i.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[l.ssrcId+f,u.ssrcIds[1]+f]}));i.attributes.ssrcGroups.unshift(h)}async function wF(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{filterRTX:r,filterVideoFec:a,filterAudioFec:l,filterAudioCodec:u,filterVideoCodec:h}=i,{useXR:f}=t,v=new RTCPeerConnection;v.addTransceiver("video",{direction:"sendonly"}),v.addTransceiver("audio",{direction:"sendonly"}),v.addTransceiver("video",{direction:"recvonly"}),v.addTransceiver("audio",{direction:"recvonly"});const E=(await v.createOffer()).sdp,y=aR(E,{filterRTX:r,filterVideoFec:a,filterAudioFec:l,filterAudioCodec:u,filterVideoCodec:h},{useXR:f},"sendonly"),C=aR(E,{filterRTX:r,filterVideoFec:a,filterAudioFec:l,filterAudioCodec:u,filterVideoCodec:h},{useXR:f},"recvonly"),I={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},k={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},W={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(Xv(y,C,"videoExtensions",I,k,W),Xv(y,C,"videoCodecs",I,k,W),Xv(y,C,"audioExtensions",I,k,W),Xv(y,C,"audioCodecs",I,k,W),Z("RAISE_H264_BASELINE_PRIORITY")){const $=W.videoCodecs.findIndex(z=>{var X,ie;return((X=z.rtpMap)===null||X===void 0?void 0:X.encodingName.toLocaleLowerCase())==="h264"&&((ie=z.fmtp)===null||ie===void 0?void 0:ie.parameters["profile-level-id"])==="42001f"});if($!==-1){const z=W.videoCodecs.findIndex(X=>{var ie;return((ie=X.rtpMap)===null||ie===void 0?void 0:ie.encodingName.toLocaleLowerCase())==="h264"});if(z<$){L.debug("raising H264 baseline profile priority");const X=W.videoCodecs[$];W.videoCodecs.splice($,1),W.videoCodecs.splice(z,0,X)}z!==-1&&(k.videoCodecs=k.videoCodecs.filter(X=>{var ie,oe;return!(((ie=X.rtpMap)===null||ie===void 0?void 0:ie.encodingName.toLocaleLowerCase())==="h264"&&((oe=X.fmtp)===null||oe===void 0?void 0:oe.parameters["profile-level-id"])!=="42001f")})),z!==-1&&Z("FILTER_SEND_H264_BASELINE")&&(I.videoCodecs=I.videoCodecs.filter(X=>{var ie,oe;return!(((ie=X.rtpMap)===null||ie===void 0?void 0:ie.encodingName.toLocaleLowerCase())==="h264"&&((oe=X.fmtp)===null||oe===void 0?void 0:oe.parameters["profile-level-id"])!=="42001f")}))}}try{v.close()}catch{}return{send:I,recv:k,sendrecv:W}}function Xv(i,t,r,a,l,u){if(r==="videoExtensions"||r==="audioExtensions"){const h=[];return i[r].forEach(f=>{t[r].some((v,E)=>{if(f.entry===v.entry&&f.extensionName===v.extensionName)return h.push(E),!0})?u[r].push(f):a[r].push(f)}),void t[r].forEach((f,v)=>{h.indexOf(v)===-1&&l[r].push(f)})}if(r==="videoCodecs"||r==="audioCodecs"){const h=[];return i[r].forEach(f=>{t[r].some((v,E)=>{if(f.payloadType===v.payloadType&&JSON.stringify(f)===JSON.stringify(v))return h.push(E),!0})?u[r].push(f):a[r].push(f)}),void t[r].forEach((f,v)=>{h.indexOf(v)===-1&&l[r].push(f)})}}function Jv(i){const{send:t,recv:r,sendrecv:a}=i;if(!a){if(!t||!r)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:t,recv:r}}let l,u;return t?(l={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},l.audioCodecs=[...t.audioCodecs,...a.audioCodecs],l.videoCodecs=[...t.videoCodecs,...a.videoCodecs],l.audioExtensions=[...t.audioExtensions,...a.audioExtensions],l.videoExtensions=[...t.videoExtensions,...a.videoExtensions]):l=a,r?(u={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},u.audioCodecs=[...r.audioCodecs,...a.audioCodecs],u.videoCodecs=[...r.videoCodecs,...a.videoCodecs],u.audioExtensions=[...r.audioExtensions,...a.audioExtensions],u.videoExtensions=[...r.videoExtensions,...a.videoExtensions]):u=a,{send:l,recv:u}}function Ql(i){i.media.mediaType==="audio"&&i.attributes.payloads.filter(t=>{var r;return((r=t.rtpMap)===null||r===void 0?void 0:r.encodingName.toLowerCase())==="opus"}).forEach(t=>{t.fmtp||(t.fmtp={parameters:{}}),t.fmtp.parameters.stereo="1",t.fmtp.parameters["sprop-stereo"]="1"})}function Qv(i){i.mediaDescriptions.forEach(t=>{t.media.mediaType!=="video"&&t.media.mediaType!=="audio"||t.attributes.payloads.forEach(r=>{r.rtcpFeedbacks.findIndex(a=>a.type==="rrtr")===-1&&r.rtcpFeedbacks.push({type:"rrtr"})})})}function Zv(i,t,r,a){let l=[];if(i===Ue.VIDEO){if(Z("H264_PROFILE_LEVEL_ID")&&a==="h264"&&(l=t.videoCodecs.filter(u=>{var h;return Ke(h=u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").call(h,a)&&u&&u.fmtp&&u.fmtp.parameters["profile-level-id"]===Z("H264_PROFILE_LEVEL_ID")})),!Array.isArray(l)||l.length===0){const u=r.videoCodecs.filter(h=>{var f;return Ke(f=h.rtpMap&&h.rtpMap.encodingName.toLowerCase()||"").call(f,a)});u.length!==0&&(l=t.videoCodecs.filter(h=>u.some(f=>f.payloadType===h.payloadType)))}if(Z("USE_PUB_RTX")){const u=l.map(f=>f.payloadType.toString()),h=t.videoCodecs.filter(f=>f.rtpMap&&f.rtpMap.encodingName==="rtx"&&Ke(u).call(u,f.fmtp&&f.fmtp.parameters.apt||""));l=[...l,...h]}l.length===0&&(L.warning("codec ".concat(a," not included in rtpCapabilities, fallback to default payloads: ").concat(t.videoCodecs[0].rtpMap&&t.videoCodecs[0].rtpMap.encodingName)),l=t.videoCodecs)}else l=t.audioCodecs.filter(u=>{var h;return Ke(h=u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").call(h,a)}),l.length===0&&(L.warning("codec ".concat(a," not included in rtpCapabilities, fallback to opus")),l=t.audioCodecs.filter(u=>{var h;return Ke(h=u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").call(h,"opus")}));return l}function IF(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function AF(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IF(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):IF(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}function ls(i){if(Array.isArray(i))return i.map(r=>r);if(!OF(i))return i;const t={};for(const r in i){const a=i[r];OF(a)||Array.isArray(a)?t[r]=ls(a):t[r]=a}return t}function OF(i){return!(typeof i!="object"||Array.isArray(i)||!i)}class uR{constructor(t){w(this,"input",[]),w(this,"size",void 0),this.size=t}add(t){this.input.push(t),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}}const Rc={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},E0={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:Rc,remoteCandidate:Rc}},xF={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0},NF={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},PF={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},DF={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0};function kF(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function LF(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kF(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):kF(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}class dR{constructor(t,r){w(this,"onFirstVideoReceived",void 0),w(this,"onFirstVideoDecoded",void 0),w(this,"onFirstAudioReceived",void 0),w(this,"onFirstVideoDecodedTimeout",void 0),w(this,"onFirstAudioDecoded",void 0),w(this,"onSelectedLocalCandidateChanged",void 0),w(this,"onSelectedRemoteCandidateChanged",void 0),w(this,"videoIsReady",!1),w(this,"videoIsReady2",{}),w(this,"pc",void 0),w(this,"options",void 0),w(this,"intervalTimer",void 0),w(this,"stats",ls(E0)),w(this,"isFirstVideoReceived",{}),w(this,"isFirstVideoDecoded",{}),w(this,"isFirstAudioReceived",{}),w(this,"isFirstAudioDecoded",{}),w(this,"isFirstVideoDecodedTimeout",{}),w(this,"lossRateWindowStats",[]),this.pc=t,this.options=r,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new me(t=>{t({local:LF({},Rc),remote:LF({},Rc)})})}setVideoIsReady(t){this.videoIsReady=t}setVideoIsReady2(t,r){this.videoIsReady2[t]=r}getVideoIsReady(t){return this.videoIsReady2[t]||!1}setIsFirstAudioDecoded(t){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(t){this.lossRateWindowStats.push(t),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const r=this.lossRateWindowStats.length,a=["videoSend","audioSend","videoRecv","audioRecv"];let l=0,u=0,h=0,f=0;for(const v of a)t[v].forEach((E,y)=>{if(!this.lossRateWindowStats[r-1][v][y]||!this.lossRateWindowStats[0][v][y])return;const C=this.lossRateWindowStats[r-1][v][y].packets-this.lossRateWindowStats[0][v][y].packets,I=this.lossRateWindowStats[r-1][v][y].packetsLost-this.lossRateWindowStats[0][v][y].packetsLost;v==="videoSend"||v==="audioSend"?(l+=C,h+=I):(u+=C,f+=I),Number.isNaN(C)||Number.isNaN(C)?E.packetLostRate=0:E.packetLostRate=C<=0||I<=0?0:I/(C+I)});t.sendPacketLossRate=l<=0||h<=0?0:h/(l+h),t.recvPacketLossRate=u<=0||f<=0?0:f/(u+f)}}function MF(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function hne(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MF(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):MF(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}class pne extends dR{constructor(){super(...arguments),w(this,"_stats",E0),w(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const t=await this._getStats(),r=this.statsResponsesToObjects(t);this._stats=ls(E0);const a=r.filter(u=>u.type==="ssrc");this.processSSRCStats(a);const l=r.find(u=>u.type==="VideoBwe");l&&this.processBandwidthStats(l),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(t){this._stats.bitrate={actualEncoded:Number(t.googActualEncBitrate),targetEncoded:Number(t.googTargetEncBitrate),retransmit:Number(t.googRetransmitBitrate),transmit:Number(t.googTransmitBitrate)},this._stats.sendBandwidth=Number(t.googAvailableSendBandwidth)}processSSRCStats(t){t.forEach(r=>{var a;const l=Ke(a=r.id).call(a,"send");switch("".concat(r.mediaType,"_").concat(l?"send":"recv")){case"video_send":{const u=ls(NF);u.codec=r.googCodecName,u.adaptionChangeReason="none",r.googCpuLimitedResolution&&(u.adaptionChangeReason="cpu"),r.googBandwidthLimitedResolution&&(u.adaptionChangeReason="bandwidth"),u.avgEncodeMs=Number(r.googAvgEncodeMs),u.inputFrame={width:Number(r.googFrameWidthInput)||Number(r.googFrameWidthSent),height:Number(r.googFrameHeightInput)||Number(r.googFrameHeightSent),frameRate:Number(r.googFrameRateInput)},u.sentFrame={width:Number(r.googFrameWidthSent),height:Number(r.googFrameHeightSent),frameRate:Number(r.googFrameRateInput)},u.firsCount=Number(r.googFirReceived),u.nacksCount=Number(r.googNacksReceived),u.plisCount=Number(r.googPlisReceived),u.frameCount=Number(r.framesEncoded),u.bytes=Number(r.bytesSent),u.packets=Number(r.packetsSent),u.packetsLost=Number(r.packetsLost),u.ssrc=Number(r.ssrc),u.rttMs=Number(r.googRtt||0),this._stats.videoSend.push(u),this._stats.rtt=u.rttMs;break}case"video_recv":{const u=ls(xF),h=this.lastDecodeVideoReceiverStats.get(Number(r.ssrc));if(u.codec=r.googCodecName,u.targetDelayMs=Number(r.googTargetDelayMs),u.renderDelayMs=Number(r.googRenderDelayMs),u.currentDelayMs=Number(r.googCurrentDelayMs),u.minPlayoutDelayMs=Number(r.googMinPlayoutDelayMs),u.decodeMs=Number(r.googDecodeMs),u.maxDecodeMs=Number(r.googMaxDecodeMs),u.receivedFrame={width:Number(r.googFrameWidthReceived),height:Number(r.googFrameHeightReceived),frameRate:Number(r.googFrameRateReceived)},u.decodedFrame={width:Number(r.googFrameWidthReceived),height:Number(r.googFrameHeightReceived),frameRate:Number(r.googFrameRateDecoded)},u.decodeFrameRate=Number(r.googFrameRateDecoded),u.outputFrame={width:Number(r.googFrameWidthReceived),height:Number(r.googFrameHeightReceived),frameRate:Number(r.googFrameRateOutput)},u.jitterBufferMs=Number(r.googJitterBufferMs),u.firsCount=Number(r.googFirsSent),u.nacksCount=Number(r.googNacksSent),u.plisCount=Number(r.googPlisSent),u.framesDecodeCount=Number(r.framesDecoded),u.bytes=Number(r.bytesReceived),u.packets=Number(r.packetsReceived),u.packetsLost=Number(r.packetsLost),u.ssrc=Number(r.ssrc),u.packets>0&&!this.isFirstVideoReceived[u.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(u.ssrc),this.isFirstVideoReceived[u.ssrc]=!0),u.framesDecodeCount>0&&!this.isFirstVideoDecoded[u.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(u.ssrc,u.decodedFrame.width,u.decodedFrame.height),this.isFirstVideoDecoded[u.ssrc]=!0),h){const f=h.stats,v=Date.now()-h.lts;u.framesDecodeFreezeTime=f.framesDecodeFreezeTime,u.framesDecodeInterval=f.framesDecodeInterval,u.framesDecodeCount>f.framesDecodeCount&&this.isFirstVideoDecoded[u.ssrc]?(h.lts=Date.now(),u.framesDecodeInterval=v,u.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(r.ssrc,10))?u.framesDecodeFreezeTime+=u.framesDecodeInterval:this.setVideoIsReady2(parseInt(r.ssrc,10),!0))):u.framesDecodeCount<h.stats.framesDecodeCount&&(u.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(u.ssrc,{stats:hne({},u),lts:Date.now()}),this._stats.videoRecv.push(u);break}case"audio_recv":{const u=ls(DF);u.codec=r.googCodecName,u.outputLevel=Math.abs(Number(r.audioOutputLevel))/32767,u.decodingCNG=Number(r.googDecodingCNG),u.decodingCTN=Number(r.googDecodingCTN),u.decodingCTSG=Number(r.googDecodingCTSG),u.decodingNormal=Number(r.googDecodingNormal),u.decodingPLC=Number(r.googDecodingPLC),u.decodingPLCCNG=Number(r.googDecodingPLCCNG),u.expandRate=Number(r.googExpandRate),u.accelerateRate=Number(r.googAccelerateRate),u.preemptiveExpandRate=Number(r.googPreemptiveExpandRate),u.secondaryDecodedRate=Number(r.googSecondaryDecodedRate),u.speechExpandRate=Number(r.googSpeechExpandRate),u.preferredJitterBufferMs=Number(r.googPreferredJitterBufferMs),u.jitterBufferMs=Number(r.googJitterBufferMs),u.jitterMs=Number(r.googJitterReceived),u.bytes=Number(r.bytesReceived),u.packets=Number(r.packetsReceived),u.packetsLost=Number(r.packetsLost),u.ssrc=Number(r.ssrc),u.receivedFrames=Number(r.googDecodingCTN)||Number(r.packetsReceived),u.droppedFrames=Number(r.googDecodingPLC)+Number(r.googDecodingPLCCNG)||Number(r.packetsLost),u.receivedFrames>0&&!this.isFirstAudioReceived[u.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(u.ssrc),this.isFirstAudioReceived[u.ssrc]=!0),u.decodingNormal>0&&!this.isFirstAudioDecoded[u.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(u.ssrc),this.isFirstAudioDecoded[u.ssrc]=!0),this._stats.audioRecv.push(u);break}case"audio_send":{const u=ls(PF);u.codec=r.googCodecName,u.inputLevel=Math.abs(Number(r.audioInputLevel))/32767,u.aecReturnLoss=Number(r.googEchoCancellationReturnLoss||0),u.aecReturnLossEnhancement=Number(r.googEchoCancellationReturnLossEnhancement||0),u.residualEchoLikelihood=Number(r.googResidualEchoLikelihood||0),u.residualEchoLikelihoodRecentMax=Number(r.googResidualEchoLikelihoodRecentMax||0),u.bytes=Number(r.bytesSent),u.packets=Number(r.packetsSent),u.packetsLost=Number(r.packetsLost),u.ssrc=Number(r.ssrc),u.rttMs=Number(r.googRtt||0),this._stats.rtt=u.rttMs,this._stats.audioSend.push(u);break}}})}_getStats(){return new me((t,r)=>{this.pc.getStats(t,r)})}statsResponsesToObjects(t){const r=[];return t.result().forEach(a=>{const l={id:a.id,timestamp:a.timestamp.valueOf().toString(),type:a.type};a.names().forEach(u=>{l[u]=a.stat(u)}),r.push(l)}),r}}function FF(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function gd(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FF(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):FF(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}class UF extends dR{constructor(){super(...arguments),w(this,"_stats",E0),w(this,"report",void 0),w(this,"lastDecodeVideoReceiverStats",new Map),w(this,"lastVideoFramesRecv",new Map),w(this,"lastVideoFramesSent",new Map),w(this,"lastVideoFramesDecode",new Map),w(this,"lastVideoJBDelay",new Map),w(this,"lastAudioJBDelay",new Map),w(this,"mediaBytesSent",new Map),w(this,"mediaBytesRetransmit",new Map),w(this,"mediaBytesTargetEncode",new Map),w(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=ls(E0),this.report.forEach(t=>{switch(t.type){case vo.OUTBOUND:case vo.INBOUND:{const r=t.mediaType||t.kind,a=!r&&"frameWidth"in t,l=!r&&!("frameWidth"in t);t.type===vo.OUTBOUND?r==="audio"||l?this.processAudioOutboundStats(t):(r==="video"||a)&&this.processVideoOutboundStats(t):t.type===vo.INBOUND&&(r==="audio"||l?this.processAudioInboundStats(t):(r==="video"||a)&&this.processVideoInboundStats(t));break}case vo.TRANSPORT:{const r=this.report.get(t.selectedCandidatePairId);r&&this.processCandidatePairStats(r);break}case vo.CANDIDATE_PAIR:t.selected&&this.processCandidatePairStats(t)}}),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const t=await this.pc.getStats(),r={local:gd({},Rc),remote:gd({},Rc)};return t.forEach(a=>{let l;if(a.type===vo.TRANSPORT&&(l=t.get(a.selectedCandidatePairId)),a.type===vo.CANDIDATE_PAIR&&a.selected&&(l=a),l){const u=(h,f)=>{h.type=f.type,h.id=f.id,f.address&&(h.address=f.address),f.candidateType&&(h.candidateType=f.candidateType),f.port&&(h.port=f.port),f.priority&&(h.priority=f.priority),f.protocol&&(h.protocol=f.protocol),f.relayProtocol&&(h.relayProtocol=f.relayProtocol)};if(l.localCandidateId){const h=t.get(l.localCandidateId);h&&u(r.local,h)}if(l.remoteCandidateId){const h=t.get(l.remoteCandidateId);h&&u(r.remote,h)}}}),r}processCandidatePairStats(t){if(this._stats.sendBandwidth=t.availableOutgoingBitrate||0,t.currentRoundTripTime&&(this._stats.rtt=1e3*t.currentRoundTripTime),this._stats.videoSend.forEach(r=>{t.currentRoundTripTime&&(r.rttMs=1e3*t.currentRoundTripTime)}),this._stats.audioSend.forEach(r=>{t.currentRoundTripTime&&(r.rttMs=1e3*t.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=t.id,t.localCandidateId){const r=this.report.get(t.localCandidateId);r&&this.processCandidateStats(r)}if(t.remoteCandidateId){const r=this.report.get(t.remoteCandidateId);r&&this.processCandidateStats(r)}}processCandidateStats(t){let r;t.type===vo.LOCAL_CANDIDATE&&(r=this._stats.selectedCandidatePair.localCandidate),t.type===vo.REMOTE_CANDIDATE&&(r=this._stats.selectedCandidatePair.remoteCandidate),r&&(r.type=t.type,r.id=t.id,t.address&&(r.address=t.address),t.candidateType&&(r.candidateType=t.candidateType),t.port&&(r.port=t.port),t.priority&&(r.priority=t.priority),t.protocol&&(r.protocol=t.protocol),t.relayProtocol&&(r.relayProtocol=t.relayProtocol),t.type===vo.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==r.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(gd({},r),gd({},this.stats.selectedCandidatePair.localCandidate)),t.type===vo.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==r.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(gd({},r),gd({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(t){let r=this._stats.audioRecv.find(a=>a.ssrc===t.ssrc);r||(r=ls(DF),this._stats.audioRecv.push(r)),r.ssrc=t.ssrc,r.packets=t.packetsReceived,r.packetsLost=t.packetsLost,r.bytes=t.bytesReceived,r.jitterMs=1e3*t.jitter,this.processAudioTrackReceiverStats(t,t.trackId,r),t.codecId&&(r.codec=this.getCodecFromCodecStats(t.codecId)),r.receivedFrames||(r.receivedFrames=t.packetsReceived),r.droppedFrames||(r.droppedFrames=t.packetsLost),r.receivedFrames>0&&!this.isFirstAudioReceived[r.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(r.ssrc),this.isFirstAudioReceived[r.ssrc]=!0),r.outputLevel&&r.outputLevel>0&&!this.isFirstAudioDecoded[r.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(r.ssrc),this.isFirstAudioDecoded[r.ssrc]=!0),typeof t.concealedSamples=="number"&&(r.concealedSamples=t.concealedSamples)}processVideoInboundStats(t){let r=this._stats.videoRecv.find(h=>h.ssrc===t.ssrc);r||(r=ls(xF),this._stats.videoRecv.push(r)),r.ssrc=t.ssrc,r.packets=t.packetsReceived,r.packetsLost=t.packetsLost,r.bytes=t.bytesReceived,r.firsCount=t.firCount,r.nacksCount=t.nackCount,r.plisCount=t.pliCount,r.framesDecodeCount=t.framesDecoded,r.totalInterFrameDelay=t.totalInterFrameDelay,r.totalSquaredInterFrameDelay=t.totalSquaredInterFrameDelay;const a=this.lastDecodeVideoReceiverStats.get(r.ssrc),l=this.lastVideoFramesDecode.get(r.ssrc),u=Date.now();if(r.framesDecodeCount>0&&!this.isFirstVideoDecoded[r.ssrc]){const h=r.decodedFrame?r.decodedFrame.width:0,f=r.decodedFrame?r.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(r.ssrc,h,f),this.isFirstVideoDecoded[r.ssrc]=!0}if(a){const h=a.stats,f=u-a.lts;r.framesDecodeFreezeTime=h.framesDecodeFreezeTime,r.framesDecodeInterval=h.framesDecodeInterval,!this.isFirstVideoDecoded[r.ssrc]&&f>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[r.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(r.ssrc),this.isFirstVideoDecodedTimeout[r.ssrc]=!0),r.framesDecodeCount>h.framesDecodeCount&&this.isFirstVideoDecoded[r.ssrc]?(a.lts=Date.now(),r.framesDecodeInterval=f,r.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(t.ssrc))?r.framesDecodeFreezeTime+=r.framesDecodeInterval:this.setVideoIsReady2(parseInt(t.ssrc,10),!0))):r.framesDecodeCount<h.framesDecodeCount&&(r.framesDecodeInterval=0),t.framesDecoded&&t.qpSum&&(a.stats.framesDecodeCount>t.framesDecoded?r.qpSumPerFrame=t.qpSum/t.framesDecoded:r.qpSumPerFrame=(t.qpSum-a.qpSum)/(t.framesDecoded-a.stats.framesDecodeCount))}l&&u-l.lts>=800?(r.decodeFrameRate=Math.round((r.framesDecodeCount-l.count)/((u-l.lts)/1e3)),this.lastVideoFramesDecode.set(r.ssrc,{count:r.framesDecodeCount,lts:u,rate:r.decodeFrameRate})):l?r.decodeFrameRate=l.rate:this.lastVideoFramesDecode.set(r.ssrc,{count:r.framesDecodeCount,lts:u,rate:0}),t.totalDecodeTime&&(r.decodeMs=1e3*t.totalDecodeTime),this.processVideoTrackReceiverStats(t,t.trackId,r),t.codecId&&(r.codec=this.getCodecFromCodecStats(t.codecId)),t.framerateMean&&(r.framesRateFirefox=t.framerateMean),r.packets>0&&!this.isFirstVideoReceived[r.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(r.ssrc),this.isFirstVideoReceived[r.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(r.ssrc,{stats:gd({},r),lts:a?a.lts:Date.now(),qpSum:t.qpSum})}processVideoOutboundStats(t){let r=this._stats.videoSend.find(l=>l.ssrc===t.ssrc);r||(r=ls(NF),this._stats.videoSend.push(r));const a=this.mediaBytesSent.get(t.ssrc);if(a)a.add(t.bytesSent);else{const l=new uR(10);l.add(t.bytesSent),this.mediaBytesSent.set(t.ssrc,l)}if(t.retransmittedBytesSent!==void 0){const l=this.mediaBytesRetransmit.get(t.ssrc);if(l)l.add(t.retransmittedBytesSent);else{const u=new uR(10);u.add(t.retransmittedBytesSent),this.mediaBytesRetransmit.set(t.ssrc,u)}}if(t.totalEncodedBytesTarget){const l=this.mediaBytesTargetEncode.get(t.ssrc);if(l)l.add(t.totalEncodedBytesTarget);else{const u=new uR(10);u.add(t.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(t.ssrc,u)}}if(r.ssrc=t.ssrc,r.bytes=t.bytesSent,r.packets=t.packetsSent,r.firsCount=t.firCount,r.nacksCount=t.nackCount,r.plisCount=t.pliCount,r.frameCount=t.framesEncoded,r.adaptionChangeReason=t.qualityLimitationReason,r.scalabilityMode=t.scalabilityMode,t.totalEncodeTime&&t.framesEncoded){const l=this.lastEncoderMs.get(t.ssrc);if(!l||l.lastFrameCount>t.framesEncoded)r.avgEncodeMs=1e3*t.totalEncodeTime/t.framesEncoded;else{const u=t.framesEncoded-l.lastFrameCount,h=t.totalEncodeTime-l.lastEncoderTime;r.avgEncodeMs=1e3*h/u}}if(t.framesEncoded&&t.qpSum){const l=this.lastEncoderMs.get(t.ssrc);!l||l.lastFrameCount>t.framesEncoded?r.qpSumPerFrame=t.qpSum/t.framesEncoded:r.qpSumPerFrame=(t.qpSum-l.lastQpSum)/(t.framesEncoded-l.lastFrameCount)}if(this.lastEncoderMs.set(t.ssrc,{lastFrameCount:t.framesEncoded,lastEncoderTime:t.totalEncodeTime,lastQpSum:t.qpSum,lts:Date.now()}),t.codecId&&(r.codec=this.getCodecFromCodecStats(t.codecId)),t.mediaSourceId&&this.processVideoMediaSource(t.mediaSourceId,r),this.processVideoTrackSenderStats(t,t.trackId,r),t.remoteId)this.processRemoteInboundStats(t.remoteId,r);else{const l=this.findRemoteStatsId(t.ssrc,vo.REMOTE_INBOUND);l&&this.processRemoteInboundStats(l,r)}}processAudioOutboundStats(t){let r=this._stats.audioSend.find(a=>a.ssrc===t.ssrc);if(r||(r=ls(PF),this._stats.audioSend.push(r)),r.ssrc=t.ssrc,r.packets=t.packetsSent,r.bytes=t.bytesSent,t.mediaSourceId&&this.processAudioMediaSource(t.mediaSourceId,r),t.codecId&&(r.codec=this.getCodecFromCodecStats(t.codecId)),this.processAudioTrackSenderStats(t,t.trackId,r),t.remoteId)this.processRemoteInboundStats(t.remoteId,r);else{const a=this.findRemoteStatsId(t.ssrc,vo.REMOTE_INBOUND);a&&this.processRemoteInboundStats(a,r)}}findRemoteStatsId(t,r){var a;const l=Array.from(gc(a=this.report).call(a)).find(u=>u.type===r&&u.ssrc===t);return l?l.id:null}processVideoMediaSource(t,r){const a=this.report.get(t);a&&a.width&&a.height&&a.framesPerSecond&&(r.inputFrame={width:a.width,height:a.height,frameRate:a.framesPerSecond})}processAudioMediaSource(t,r){const a=this.report.get(t);a&&(r.inputLevel=a.audioLevel)}processVideoTrackSenderStats(t,r,a){var l,u,h,f;const v=r?this.report.get(r):void 0,E=(l=v==null?void 0:v.framesSent)!==null&&l!==void 0?l:t.framesSent;if(typeof E!="number")return;let y=(u=v==null?void 0:v.frameWidth)!==null&&u!==void 0?u:t.frameWidth,C=(h=v==null?void 0:v.frameHeight)!==null&&h!==void 0?h:t.frameHeight,I=(f=v==null?void 0:v.framesPerSecond)!==null&&f!==void 0?f:t.framesPerSecond;if(typeof y=="number"&&typeof C=="number"||(y=0,C=0),I==null){const k=Date.now(),W=this.lastVideoFramesSent.get(a.ssrc);W&&k-W.lts>=800?(I=Math.round((E-W.count)/((k-W.lts)/1e3)),this.lastVideoFramesSent.set(a.ssrc,{count:E,lts:k,rate:I})):W?I=W.rate:this.lastVideoFramesSent.set(a.ssrc,{count:E,lts:k,rate:0})}a.sentFrame={width:y,height:C,frameRate:Math.max(0,I)}}processVideoTrackReceiverStats(t,r,a){var l,u,h,f,v;const E=r?this.report.get(r):void 0,y=(l=E==null?void 0:E.framesReceived)!==null&&l!==void 0?l:t.framesReceived,C=(u=E==null?void 0:E.frameWidth)!==null&&u!==void 0?u:t.frameWidth,I=(h=E==null?void 0:E.frameHeight)!==null&&h!==void 0?h:t.frameHeight,k=(f=E==null?void 0:E.jitterBufferDelay)!==null&&f!==void 0?f:t.jitterBufferDelay,W=(v=E==null?void 0:E.jitterBufferEmittedCount)!==null&&v!==void 0?v:t.jitterBufferEmittedCount;if(typeof y=="number"){const $=this.lastVideoFramesRecv.get(a.ssrc),z=Date.now();a.framesReceivedCount=y;let X=0;$&&z-$.lts>=800?(X=Math.round((y-$.count)/((z-$.lts)/1e3)),this.lastVideoFramesRecv.set(a.ssrc,{count:y,lts:z,rate:X})):$?X=$.rate:this.lastVideoFramesRecv.set(a.ssrc,{count:y,lts:z,rate:0}),a.receivedFrame={width:C||0,height:I||0,frameRate:X||0},a.decodedFrame={width:C||0,height:I||0,frameRate:a.decodeFrameRate||0},a.outputFrame={width:C||0,height:I||0,frameRate:a.decodeFrameRate||0}}if(k&&W){const $=this.lastVideoJBDelay.get(a.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let z=$.jitterBufferMs;const X=W-$.jitterBufferEmittedCount;X>0&&(z=1e3*(k-$.jitterBufferDelay)/X),a.jitterBufferMs=z,a.currentDelayMs=Math.round(z),this.lastVideoJBDelay.set(a.ssrc,{jitterBufferDelay:k,jitterBufferEmittedCount:W,jitterBufferMs:a.currentDelayMs})}}processAudioTrackSenderStats(t,r,a){var l,u,h,f;const v=r?this.report.get(r):void 0,E=(l=(u=v==null?void 0:v.echoReturnLoss)!==null&&u!==void 0?u:t.echoReturnLoss)!==null&&l!==void 0?l:0,y=(h=(f=v==null?void 0:v.echoReturnLossEnhancement)!==null&&f!==void 0?f:t.echoReturnLossEnhancement)!==null&&h!==void 0?h:0;a.aecReturnLoss=E,a.aecReturnLossEnhancement=y}processAudioTrackReceiverStats(t,r,a){var l,u,h,f,v,E,y;const C=r?this.report.get(r):void 0,I=(l=C==null?void 0:C.removedSamplesForAcceleration)!==null&&l!==void 0?l:t.removedSamplesForAcceleration,k=(u=C==null?void 0:C.totalSamplesReceived)!==null&&u!==void 0?u:t.totalSamplesReceived,W=(h=C==null?void 0:C.jitterBufferDelay)!==null&&h!==void 0?h:t.jitterBufferDelay,$=(f=C==null?void 0:C.jitterBufferEmittedCount)!==null&&f!==void 0?f:t.jitterBufferEmittedCount,z=(v=C==null?void 0:C.audioLevel)!==null&&v!==void 0?v:t==null?void 0:t.audioLevel,X=(E=C==null?void 0:C.totalSamplesDuration)!==null&&E!==void 0?E:t==null?void 0:t.totalSamplesDuration,ie=(y=C==null?void 0:C.concealedSamples)!==null&&y!==void 0?y:t.concealedSamples;if(I&&k&&(a.accelerateRate=I/k),W&&$){const Re=this.lastAudioJBDelay.get(a.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let Ce=Re.jitterBufferMs;const ge=$-Re.jitterBufferEmittedCount;ge>0&&(Ce=1e3*(W-Re.jitterBufferDelay)/ge),a.jitterBufferMs=Math.round(Ce),this.lastAudioJBDelay.set(a.ssrc,{jitterBufferDelay:W,jitterBufferEmittedCount:$,jitterBufferMs:a.jitterBufferMs})}a.outputLevel=z;let oe=1920;X&&k&&(oe=k/X/50,a.receivedFrames=Math.round(k/oe)),ie&&(a.droppedFrames=Math.round(ie/oe))}processRemoteInboundStats(t,r){const a=this.report.get(t);a&&(r.packetsLost=a.packetsLost,a.roundTripTime&&(r.rttMs=1e3*a.roundTripTime),a.jitter&&(r.jitterMs=1e3*a.jitter),a.timestamp&&(r.timestamp=a.timestamp))}getCodecFromCodecStats(t){const r=this.report.get(t);if(!r)return"";const a=r.mimeType.match(/\/(.*)$/);return a&&a[1]?a[1]:""}updateSendBitrate(){let t=0,r=null,a=null;this.mediaBytesSent.forEach(u=>{t+=u.diffMean()}),this.mediaBytesRetransmit.forEach(u=>{r=r===null?u.diffMean():r+u.diffMean()}),this.mediaBytesTargetEncode.forEach(u=>{a=a===null?u.diffMean():a+u.diffMean()});const l=r!==null?t-r:t;this._stats.bitrate={actualEncoded:8*l/(this.options.updateInterval/1e3),transmit:8*t/(this.options.updateInterval/1e3)},r!==null&&(this._stats.bitrate.retransmit=8*r/(this.options.updateInterval/1e3)),a!==null&&(this._stats.bitrate.targetEncoded=8*a/(this.options.updateInterval/1e3))}}class fne extends dR{updateStats(){return me.resolve()}}function eE(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:500,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4;const u=function(){const h=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return h&&h[0]?Number(h[0].split("/")[1]):null}();return u?u<76?new pne(i,{updateInterval:t,lossRateInterval:r,freezeRateLimit:a,firstVideoDecodedTimeout:l}):new UF(i,{updateInterval:t,lossRateInterval:r,freezeRateLimit:a,firstVideoDecodedTimeout:l}):function(h){return!!window.RTCStatsReport&&h.getStats()instanceof me}(i)?new UF(i,{updateInterval:t,lossRateInterval:r,freezeRateLimit:a,firstVideoDecodedTimeout:l}):new fne(i,{updateInterval:t,lossRateInterval:r,freezeRateLimit:a,firstVideoDecodedTimeout:l})}function BF(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function jF(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BF(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):BF(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}class jr extends pv{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}constructor(t,r){super(t,r),w(this,"store",void 0),w(this,"peerConnection",void 0),w(this,"remoteSDP",void 0),w(this,"initialOffer",void 0),w(this,"statsFilter",void 0),w(this,"useRTX",!1),w(this,"localCapabilities",void 0),w(this,"localCandidateCount",0),w(this,"allCandidatesReceived",!1),w(this,"establishPromise",void 0),w(this,"mutex",new Mr("P2PConnection-mutex")),this.store=r,this.peerConnection=new RTCPeerConnection(jr.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.statsFilter=eE(this.peerConnection,Z("STATS_UPDATE_INTERVAL"),void 0,Cn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const t=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!t.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const r=fd(t.sdp),a=aR(t.sdp,{filterRTX:!this.useRTX,filterVideoFec:Z("FILTER_VIDEO_FEC"),filterAudioFec:Z("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=a,this.initialOffer=t,jF(jF({},r),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:a},offerSDP:t.sdp})}catch(t){throw new be(G.GET_LOCAL_CONNECTION_PARAMS_FAILED,t.toString())}}async connect(t,r,a,l,u,h){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new class{constructor(v){w(this,"sessionDesc",void 0),w(this,"localCapabilities",void 0),w(this,"rtpCapabilities",void 0),w(this,"candidates",void 0),w(this,"iceParameters",void 0),w(this,"dtlsParameters",void 0),w(this,"setup",void 0),w(this,"currentMidIndex",void 0),w(this,"cname",void 0),v=ar(v);const{remoteIceParameters:E,remoteDtlsParameters:y,candidates:C,remoteRTPCapabilities:I,remoteSetup:k,localCapabilities:W,sdkCodec:$,cname:z}=v,X=Hn.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=I,this.candidates=C,this.iceParameters=E,this.dtlsParameters=y,this.setup=k,this.localCapabilities=W,this.cname=z;for(let ie=0;ie<X.mediaDescriptions.length;ie++){const oe=X.mediaDescriptions[ie];if(oe.attributes.iceUfrag=E.iceUfrag,oe.attributes.icePwd=E.icePwd,oe.attributes.fingerprints=y.fingerprints,oe.attributes.candidates=C,oe.attributes.setup=k,oe.media.mediaType==="video"){oe.media.fmts=I.videoCodecs.map(Ce=>Ce.payloadType.toString(10));let Re=I.videoCodecs.filter(Ce=>{var ge,_e;return(ge=Ce.rtpMap)===null||ge===void 0?void 0:Ke(_e=ge.encodingName.toLowerCase()).call(_e,$)});Re.length===0&&(Re=I.videoCodecs),oe.attributes.payloads=Re,oe.attributes.extmaps=I.videoExtensions}oe.media.mediaType==="audio"&&(oe.media.fmts=I.audioCodecs.map(Re=>Re.payloadType.toString(10)),oe.attributes.payloads=I.audioCodecs,oe.attributes.extmaps=I.audioExtensions),X.mediaDescriptions[ie]=this.mungMediaDesc(oe)}this.sessionDesc=X,this.currentMidIndex=X.mediaDescriptions.length-1}toString(){return Hn.print(this.sessionDesc)}send(v,E,y){const{ssrcs:C,ssrcGroups:I}=Pa(E,this.cname),k=this.sessionDesc.mediaDescriptions.find(z=>v===Ue.VIDEO?z.media.mediaType==="video":z.media.mediaType==="audio"),W=C[0].attributes.label,$=C[0].attributes.mslabel;return k.attributes.ssrcs=k.attributes.ssrcs.concat(C),k.attributes.ssrcGroups=k.attributes.ssrcGroups.concat(I),{id:W,mslabel:$}}batchSend(v){return v.map(E=>{let{kind:y,ssrcMsg:C}=E;return this.send(y,C,void 0)})}stopSending(v){this.sessionDesc.mediaDescriptions.forEach(E=>{const y=[],C=[],I=[];E.attributes.ssrcs.forEach(k=>{Ke(v).call(v,k.attributes.label||"")?I.push(k):y.push(k)}),E.attributes.ssrcGroups.forEach(k=>{var W;Ke(W=I.map($=>$.ssrcId)).call(W,k.ssrcIds[0])||C.push(k)}),E.attributes.ssrcs=y,E.attributes.ssrcGroups=C})}mute(v){const E=this.sessionDesc.mediaDescriptions.find(y=>y.attributes.mid===v);if(!E)throw new Error("mediaDescription not found with ".concat(v," in remote SDP when calling RemoteSDP.mute."));E.attributes.direction="inactive"}unmute(v){const E=this.sessionDesc.mediaDescriptions.find(y=>y.attributes.mid===v);if(!E)throw new Error("mediaDescription not found with ".concat(v," in remote SDP when calling RemoteSDP.unmute."));E.attributes.direction="sendonly"}receive(v,E,y){v.forEach((C,I)=>{const k=C._mediaStreamTrack,W=this.sessionDesc.mediaDescriptions.findIndex(z=>z.attributes.mid===k.kind),$=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[W],C);this.sessionDesc.mediaDescriptions[W]=$})}stopReceiving(v){}updateCandidates(v){v===hi.TCP?this.candidates.forEach(E=>{this.candidates.findIndex(y=>y.transport==="tcp"&&y.connectionAddress===E.connectionAddress&&y.port===E.port)===-1&&this.candidates.push(AF(AF({},E),{},{foundation:"tcpcandidate",priority:Number(E.priority)-1+"",transport:"tcp",port:Number(E.port)+90+""}))}):this.candidates=this.candidates.filter(E=>E.transport!=="tcp");for(const E of this.sessionDesc.mediaDescriptions)E.attributes.candidates=this.candidates}restartICE(v){v=ar(v),this.iceParameters=v,this.sessionDesc.mediaDescriptions.forEach(E=>{E.attributes.iceUfrag=v.iceUfrag,E.attributes.icePwd=v.icePwd})}predictReceivingMids(v){const E=[];for(let y=0;y<v;y++)E.push((this.currentMidIndex+y+1).toString(10));return E}mungRecvMediaDsec(v,E){const y=ar(v);return md(y,E),cR(y,E),y}updateRecvMedia(v,E){const y=this.sessionDesc.mediaDescriptions.findIndex(C=>C.attributes.mid===v);if(y!==-1){const C=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[y],E);this.sessionDesc.mediaDescriptions[y]=C}}bumpMid(v){this.currentMidIndex+=v}updateTrackLabel(v,E,y){const C=this.sessionDesc.mediaDescriptions.find(k=>v===Ue.VIDEO?k.attributes.mid==="video":k.attributes.mid==="audio");if(C){const k=C.attributes.ssrcs.find(W=>W.attributes.label===E);var I;k&&(k.attributes.label=y,(I=k.attributes.msid)===null||I===void 0||I.replace(E,y))}}mungMediaDesc(v){const E=ar(v);return sR(E),function(y){const C=y.attributes.extmaps.find(I=>I.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");C&&y.attributes.extmaps.splice(y.attributes.extmaps.indexOf(C),1),y.attributes.payloads.forEach(I=>{const k=I.rtcpFeedbacks.findIndex(W=>W.type==="transport-cc");k!==-1&&I.rtcpFeedbacks.splice(k,1)})}(E),E}getSSRC(v){for(const E of this.sessionDesc.mediaDescriptions)for(const y of E.attributes.ssrcs)if(y.attributes.label===v)return[y]}}({remoteIceParameters:t,remoteDtlsParameters:r,candidates:a,remoteRTPCapabilities:l.send,remoteSetup:u,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec,cname:h});const f=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(f){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(f.toString()))}}async updateRemoteRTPCapabilities(t,r){throw new be(G.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}send(t,r){var a=this;return Na(function*(){const l=yield zt(a.mutex.lock());try{if(!a.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const u=t.map(I=>a.peerConnection.addTrack(I._mediaStreamTrack)),h=yield zt(a.peerConnection.createOffer()),f=Hn.parse(h.sdp),v=t.map(I=>{const k=I._mediaStreamTrack,W=f.mediaDescriptions.find($=>$.attributes.mid===k.kind);if(!W)throw new Error("Cannot extract ssrc from mediaDescription.");return function($,z,X){const ie=$.attributes.ssrcs.filter(Re=>Re.attributes.label===z),oe=$.attributes.ssrcGroups;if(ie.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(oe&&ie.length>1){const Re=oe.find(Ce=>Ce.ssrcIds.indexOf(ie[0].ssrcId)!==-1);return Re?[{ssrcId:Re.ssrcIds[0],rtx:X?Re.ssrcIds[1]:void 0}]:[{ssrcId:ie[0].ssrcId}]}return[{ssrcId:ie[0].ssrcId}]}(W,k.id,a.useRTX)});let E;try{E=yield v}catch(I){throw u.forEach(k=>{Di()&&k.replaceTrack(null),a.peerConnection.removeTrack(k)}),I}const y=a.mungSendOfferSDP(h.sdp,t);a.remoteSDP.receive(t,r,E);const C=a.remoteSDP.toString();return yield zt(a.peerConnection.setLocalDescription({type:"offer",sdp:y})),yield zt(a.applySendEncodings(u,t)),yield zt(a.peerConnection.setRemoteDescription({type:"answer",sdp:C})),t.map((I,k)=>{const W=I._mediaStreamTrack.id;return{localSSRC:v[k],id:W}})}catch(u){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(u.toString()))}finally{l()}})()}async stopSending(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const r=this.peerConnection.getSenders().filter(u=>{var h;return t.indexOf(((h=u.track)===null||h===void 0?void 0:h.id)||"")!==-1});if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");r.map(u=>{Di()&&u.replaceTrack(null),this.peerConnection.removeTrack(u)});const a=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(a),this.remoteSDP.stopReceiving(t);const l=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(r){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(r.toString()))}}async receive(t,r,a,l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{id:u,mslabel:h}=this.remoteSDP.send(t,r,l),f=new me((y,C)=>{const I=setTimeout(()=>{C(new Error("Cannot receive track, id: ".concat(u)))},1e4),k=W=>{const $=Wt();if(($.name==="Safari"&&Number($.version)===11||ki())&&W.track.id!==u&&W.streams[0].id===h){var z;const X=W.streams[0].getTracks()[0];return(z=this.remoteSDP)===null||z===void 0||z.updateTrackLabel(t,u,W.track.id),this.peerConnection.removeEventListener("track",k),clearTimeout(I),void y(X)}if(W.track.id===u)return this.peerConnection.removeEventListener("track",k),clearTimeout(I),void y(W.track)};this.peerConnection.addEventListener("track",k)}),v=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:v});const E=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(E),{track:await f,id:u}}catch(u){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async stopReceiving(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(t);const r=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const a=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(a)}catch(r){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}async muteRemote(t){}async unmuteRemote(t){}async muteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const r=this.peerConnection.getSenders().filter(a=>{var l;return t.indexOf(((l=a.track)===null||l===void 0?void 0:l.id)||"")!==-1});if(r.length!==t.length)throw new Error("sender' length doesn't match mids' length.");r.map(a=>{if(Di()&&a.track)a.track.enabled=!1;else{const l=a.getParameters();l.encodings.forEach(u=>u.active=!1),a.setParameters(l)}})}catch(r){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const r=this.peerConnection.getSenders().filter(u=>{var h;return t.indexOf(((h=u.track)===null||h===void 0?void 0:h.id)||"")!==-1});if(r.length!==t.length)throw new Error("Senders' length doesn't match mids' length.");r.map(async u=>{if(Di()&&u.track)u.track.enabled=!0;else{const h=u.getParameters();h.encodings.forEach(f=>f.active=!0),await u.setParameters(h)}});const a=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(a);const l=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(r){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(r.toString()))}}restartICE(t){var r=this;return Na(function*(){const a=yield zt(r.mutex.lock("From P2PConnection.restartICE"));try{if(!r.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(fn().supportPCSetConfiguration){const v=r.peerConnection.getConfiguration(),E=t===hi.RELAY?"relay":"all";v.iceTransportPolicy!==E&&(L.debug("[".concat(r.store.clientId,"] restartICE change iceTransportPolicy from [").concat(v.iceTransportPolicy,"] to [").concat(E,"]")),v.iceTransportPolicy=E,r.peerConnection.setConfiguration(v))}else if(t===hi.RELAY)return;t!==hi.RELAY&&r.remoteSDP.updateCandidates(t);const l=yield zt(r.peerConnection.createOffer({iceRestart:!0}));if(!l.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const u=fd(l.sdp),{remoteIceParameters:h}=yield u.iceParameters;r.remoteSDP.restartICE(h);const f=r.remoteSDP.toString();yield zt(r.peerConnection.setLocalDescription(l)),yield zt(r.peerConnection.setRemoteDescription({type:"answer",sdp:f}))}catch(l){L.warning("[".concat(r.store.clientId,"] restart ICE failed, abort operation"),l)}finally{a()}})()}close(){var t;this.peerConnection.close(),(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}async updateEncoderConfig(t,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const a=await this.peerConnection.createOffer(),l=this.mungSendOfferSDP(a.sdp,[r]);this.remoteSDP.updateRecvMedia(r._mediaStreamTrack.kind,r);const u=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:l}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(a){throw new be(G.EXCHANGE_SDP_FAILED,a.toString())}}async updateSendParameters(t,r){const a=this.peerConnection.getSenders().filter(l=>{var u;return((u=l.track)===null||u===void 0?void 0:u.id)===t});a.length===1&&await this.applySendEncodings(a,[r])}setStatsRemoteVideoIsReady(t,r){this.statsFilter.setVideoIsReady2(t,r)}async replaceTrack(t,r){const a=this.peerConnection.getSenders().find(l=>{var u;return((u=l.track)===null||u===void 0?void 0:u.id)===r});a&&await a.replaceTrack(t._mediaStreamTrack)}createDataChannels(t,r){throw new be(G.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(t){throw new be(G.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t;(t=this.onICEConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=t=>{t.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,L.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,L.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},Z("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const r={iceServers:[],sdpSemantics:"plan-b"};return t.iceServers?r.iceServers=t.iceServers:t.turnServer&&t.turnServer.mode!=="off"&&(bh(t.turnServer.servers)?r.iceServers=t.turnServer.servers:(r.iceServers&&r.iceServers.push(...jr.turnServerConfigToIceServers(t.turnServer.servers)),Z("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&t.turnServer.serversFromGateway&&r.iceServers.push(...jr.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(a=>{a.forceturn&&(r.iceTransportPolicy="relay")}))),r}static turnServerConfigToIceServers(t){const r=[];return t.forEach(a=>{a.security?a.tcpport&&r.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}):(a.udpport&&r.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.udpport,"?transport=udp")}),a.tcpport&&r.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}))}),r}async updateRtpSenderEncodings(t,r){var a;if(r||(r=this.peerConnection.getSenders().find(E=>{var y;return((y=E.track)===null||y===void 0?void 0:y.id)===t._mediaStreamTrack.id})),!r)return L.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(!fn().supportSetRtpSenderParameters)return L.warn("Browser not support set rtp-sender parameters");const l={},u={};if(t instanceof bt)switch(t._optimizationMode){case"motion":l.degradationPreference="maintain-framerate";break;case"detail":l.degradationPreference="maintain-resolution";break;default:l.degradationPreference="balanced"}if(Z("DSCP_TYPE")&&Ll()){var h;const E=Z("DSCP_TYPE");Ke(h=["very-low","low","medium","high"]).call(h,E)&&(u.networkPriority=E)}const f=r.getParameters(),v=(a=f.encodings)===null||a===void 0?void 0:a[0];v&&Object.assign(v,u),Object.assign(f,l),L.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(f.encodings))),await r.setParameters(f)}async applySendEncodings(t,r){try{if(!fn().supportSetRtpSenderParameters||t.length!==r.length)return;for(let a=0;a<t.length;a++){const l=t[a],u=r[a];l&&u&&await this.updateRtpSenderEncodings(u,l)}}catch{L.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(t,r){const a=Hn.parse(t);return r.forEach((l,u)=>{const h=l._mediaStreamTrack,f=a.mediaDescriptions.find(v=>v.attributes.mid===h.kind);f&&md(f,l)}),Hn.print(a)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,r,a)=>{var l;(l=this.onFirstVideoDecoded)===null||l===void 0||l.call(this,t,r,a)},this.statsFilter.onSelectedLocalCandidateChanged=(t,r)=>{var a;(a=this.onSelectedLocalCandidateChanged)===null||a===void 0||a.call(this,t,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,r)=>{var a;(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0||a.call(this,t,r)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const r=this.remoteSDP.batchSend(t).map((u,h)=>{let{id:f,mslabel:v}=u;const{kind:E}=t[h];return new me((y,C)=>{const I=setTimeout(()=>{C(new Error("Cannot receive track, id: ".concat(f)))},1e4),k=W=>{const $=Wt();if($.name==="Safari"&&Number($.version)===11&&W.track.id!==f&&W.streams[0].id===v){var z;const X=W.streams[0].getTracks()[0];return(z=this.remoteSDP)===null||z===void 0||z.updateTrackLabel(E,f,W.track.id),this.peerConnection.removeEventListener("track",k),clearTimeout(I),void y({track:X,id:f})}if(W.track.id===f)return this.peerConnection.removeEventListener("track",k),clearTimeout(I),void y({track:W.track,id:f})};this.peerConnection.addEventListener("track",k)})}),a=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:a});const l=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(l),await me.all(r)}catch(r){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(r.toString()))}}async getRemoteSSRC(t){if(!this.remoteSDP)return;const r=this.remoteSDP.getSSRC(t);return r==null?void 0:r[0].ssrcId}setConfiguration(t){if(fn().supportPCSetConfiguration){const r=jr.resolvePCConfiguration(t);this.peerConnection.setConfiguration(r)}}}function Da(i,t,r){const a=i[t];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const l=this.mutex,u=await l.lock("Locking from P2PConnection.".concat(t));try{for(var h=arguments.length,f=new Array(h),v=0;v<h;v++)f[v]=arguments[v];return await a.apply(this,f)}finally{u()}},r}function VF(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function Zl(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VF(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):VF(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}Te([Da,V("design:type",Function),V("design:paramtypes",[Object,Object,Array,Object,String,String]),V("design:returntype",me)],jr.prototype,"connect",null),Te([Da,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],jr.prototype,"stopSending",null),Te([Da,V("design:type",Function),V("design:paramtypes",[String,Array,String,Object]),V("design:returntype",me)],jr.prototype,"receive",null),Te([Da,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],jr.prototype,"stopReceiving",null),Te([Da,V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],jr.prototype,"muteRemote",null),Te([Da,V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],jr.prototype,"unmuteRemote",null),Te([Da,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],jr.prototype,"muteLocal",null),Te([Da,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],jr.prototype,"unmuteLocal",null),Te([Da,V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],jr.prototype,"close",null),Te([Da,V("design:type",Function),V("design:paramtypes",[String,pi]),V("design:returntype",me)],jr.prototype,"updateEncoderConfig",null),Te([Da,V("design:type",Function),V("design:paramtypes",[String,pi]),V("design:returntype",me)],jr.prototype,"updateSendParameters",null),Te([Da,V("design:type",Function),V("design:paramtypes",[pi,String]),V("design:returntype",me)],jr.prototype,"replaceTrack",null),Te([Da,V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],jr.prototype,"getRemoteSSRC",null);const _0="9",$F=4e4;function HF(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function qh(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HF(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):HF(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}let yr=class B0 extends pv{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var t,r;return(t=(r=this.peerConnection.getReceivers()[0])===null||r===void 0||(r=r.transport)===null||r===void 0?void 0:r.state)!==null&&t!==void 0?t:null}constructor(t,r){super(t,r),w(this,"store",void 0),w(this,"peerConnection",void 0),w(this,"remoteSDP",void 0),w(this,"initialOffer",void 0),w(this,"transportEventReceiver",void 0),w(this,"statsFilter",void 0),w(this,"useXR",Z("USE_XR")),w(this,"localCapabilities",void 0),w(this,"remoteCodecs",void 0),w(this,"localCandidateCount",0),w(this,"allCandidatesReceived",!1),w(this,"dataStreamChannelMap",new Map),w(this,"establishPromise",void 0),w(this,"mutex",new Mr("P2PConnection-mutex")),this.store=r,this.peerConnection=new RTCPeerConnection(B0.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.statsFilter=eE(this.peerConnection,Z("STATS_UPDATE_INTERVAL"),void 0,Cn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async updateRemoteRTPCapabilities(t,r){this.remoteCodecs=r;const a=[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(l=>l.rtpMap&&l.rtpMap.encodingName.toLowerCase()||"").filter(l=>{var u;return Ke(u=Object.keys(ed)).call(u,l)}))];if(He.updateRemoteRTPCapabilities(this.store.sessionId,{mids:t,localCodecs:a,remoteCodecs:this.remoteCodecs}),!this.remoteSDP)return void L.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(a,", codecs: ").concat(r));if(this.remoteSDP.updateRemoteCodec(t,r,this.store.codec)){const l=await this.peerConnection.createOffer(),u=this.logSDPExchange(l.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(l);const h=this.remoteSDP.toString();u==null||u(h),await this.peerConnection.setRemoteDescription({type:"answer",sdp:h})}else L.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const t=await this.peerConnection.createOffer();if(!t.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const r=fd(t.sdp),a=await wF({filterRTX:!Z("USE_PUB_RTX")&&!Z("USE_SUB_RTX"),filterVideoFec:Z("FILTER_VIDEO_FEC"),filterAudioFec:Z("FILTER_AUDIO_FEC"),filterVideoCodec:Z("FILTER_VIDEO_CODEC")},{useXR:this.useXR});return this.localCapabilities=Jv(a),this.initialOffer=t,qh(qh({},r),{},{rtpCapabilities:a,offerSDP:t.sdp})}catch(t){throw new be(G.GET_LOCAL_CONNECTION_PARAMS_FAILED,t.toString())}}async connect(t,r,a,l,u,h){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new class{get localCapabilities(){return ar(this._localCapabilities)}get rtpCapabilities(){return ar(this._rtpCapabilities)}get candidates(){return ar(this._candidates)}get iceParameters(){return ar(this._iceParameters)}get dtlsParameters(){return ar(this._dtlsParameters)}constructor(k){w(this,"sessionDesc",void 0),w(this,"_localCapabilities",void 0),w(this,"_rtpCapabilities",void 0),w(this,"_candidates",void 0),w(this,"_iceParameters",void 0),w(this,"_dtlsParameters",void 0),w(this,"setup",void 0),w(this,"currentMidIndex",void 0),w(this,"cname",void 0),w(this,"firefoxSsrcMidMap",new Map),k=ar(k);const{remoteIceParameters:W,remoteDtlsParameters:$,candidates:z,remoteRTPCapabilities:X,remoteSetup:ie,localCapabilities:oe,cname:Re}=k,Ce=Hn.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`);this._rtpCapabilities=X,this._candidates=z,this._iceParameters=W,this._dtlsParameters=$,this._localCapabilities=oe,this.setup=ie,this.cname=Re;const ge=this.rtpCapabilities.send;for(const _e of Ce.mediaDescriptions){if(_e.attributes.iceUfrag=W.iceUfrag,_e.attributes.icePwd=W.icePwd,_e.attributes.fingerprints=$.fingerprints,_e.attributes.candidates=z,_e.attributes.setup=ie,_e.media.mediaType==="video"&&(_e.media.fmts=ge.videoCodecs.map(Se=>Se.payloadType.toString(10)),_e.attributes.payloads=ge.videoCodecs,_e.attributes.extmaps=ge.videoExtensions,Z("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:Se,ssrcGroups:De}=Pa([{ssrcId:$F,rtx:Z("USE_SUB_RTX")?40001:void 0}],this.cname);_e.attributes.ssrcs=Se,_e.attributes.ssrcGroups=De}if(_e.media.mediaType==="audio"&&(_e.media.fmts=ge.audioCodecs.map(Se=>Se.payloadType.toString(10)),_e.attributes.payloads=ge.audioCodecs,_e.attributes.extmaps=ge.audioExtensions,Ql(_e),Z("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:Se,ssrcGroups:De}=Pa([{ssrcId:2e4}],this.cname);_e.attributes.ssrcs=Se,_e.attributes.ssrcGroups=De}}this.sessionDesc=Ce,this.currentMidIndex=Ce.mediaDescriptions.length-1}preloadRemoteMedia(){const k=Z("PRELOAD_MEDIA_COUNT");this.rtpCapabilities;const W=this.candidates,$=this.dtlsParameters,z=this.iceParameters,X=this.rtpCapabilities.send;for(let ie=1;ie<k;ie++){const oe=2*ie+2e4,Re=2*ie+$F,{ssrcs:Ce,ssrcGroups:ge}=Pa([{ssrcId:oe}],this.cname),{ssrcs:_e,ssrcGroups:Se}=Pa([{ssrcId:Re,rtx:Z("USE_SUB_RTX")?Re+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:_0,protos:["UDP","TLS","RTP","SAVPF"],fmts:X.videoCodecs.map(De=>De.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:z.iceUfrag,icePwd:z.icePwd,unrecognized:[],candidates:W,extmaps:X.videoExtensions,fingerprints:$.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:_e,ssrcGroups:Se,rtcpFeedbackWildcards:[],payloads:X.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*ie)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:_0,protos:["UDP","TLS","RTP","SAVPF"],fmts:X.audioCodecs.map(De=>De.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:z.iceUfrag,icePwd:z.icePwd,unrecognized:[],candidates:W,extmaps:X.audioExtensions,fingerprints:$.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:Ce,ssrcGroups:ge,rtcpFeedbackWildcards:[],payloads:X.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*ie+1)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return Hn.print(this.sessionDesc)}send(k,W,$,z){const{ssrcs:X,ssrcGroups:ie}=Pa(W,this.cname,Z("SYNC_GROUP")?$:void 0),oe=this.findPreloadMediaDesc(X);if(oe){if(Cn()&&this.firefoxSsrcMidMap.set(X[0].ssrcId,oe.attributes.mid),z&&(z.twcc||z.remb)){const Re=this.sessionDesc.mediaDescriptions.indexOf(oe);return this.sessionDesc.mediaDescriptions[Re]=this.mungSendMediaDesc(oe,z),{mid:oe.attributes.mid,needExchangeSDP:!0}}return{mid:oe.attributes.mid,needExchangeSDP:!1}}{const Re=this.findAvailableMediaIndex(k,X);let Ce;return Re===-1||Re===1&&(Di()||Nk())||Re===0&&Z("USE_SUB_RTX")||Pk()?(Ce=this.createOrRecycleSendMedia(k,X,ie,"sendonly",z),this.updateBundleMids()):(Ce=ar(this.sessionDesc.mediaDescriptions[Re]),Ce.attributes.direction="sendonly",Ce.attributes.ssrcs=X,Ce.attributes.ssrcGroups=ie,this.sessionDesc.mediaDescriptions[Re]=this.mungSendMediaDesc(Ce,z)),Cn()&&this.firefoxSsrcMidMap.set(X[0].ssrcId,Ce.attributes.mid),{mid:Ce.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:k,needExchangeSDP:W}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:k.attributes.mid,needExchangeSDP:W}}batchSend(k){const W=k.map(X=>{let{kind:ie,ssrcMsg:oe,mslabel:Re}=X;return this.send(ie,oe,Re)}),$=[];let z=!1;return W.forEach(X=>{let{mid:ie,needExchangeSDP:oe}=X;oe&&(z=!0),$.push(ie)}),{mids:$,needExchangeSDP:z}}stopSending(k){const W=this.sessionDesc.mediaDescriptions.filter($=>$.attributes.mid&&k.indexOf($.attributes.mid)!==-1);if(W.length!==k.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");W.forEach($=>{$.attributes.mid==="0"||Cn()||Pk()?$.attributes.ssrcs=[]:($.attributes.ssrcs=[],$.attributes.direction="inactive",$.media.port="0")}),this.updateBundleMids()}mute(k){const W=this.sessionDesc.mediaDescriptions.find($=>$.attributes.mid===k);if(!W)throw new Error("mediaDescription not found with ".concat(k," in remote SDP when calling RemoteSDP.mute."));W.attributes.direction="inactive"}unmute(k){const W=this.sessionDesc.mediaDescriptions.find($=>$.attributes.mid===k);if(!W)throw new Error("mediaDescription not found with ".concat(k," in remote SDP when calling RemoteSDP.unmute."));W.attributes.direction="sendonly"}muteRemote(k){const W=this.sessionDesc.mediaDescriptions.filter($=>Ke(k).call(k,$.attributes.mid||""));if(W.length!==k.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");W.forEach($=>{$.attributes.direction="inactive"})}unmuteRemote(k){const W=this.sessionDesc.mediaDescriptions.filter($=>Ke(k).call(k,$.attributes.mid||""));if(W.length!==k.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");W.forEach($=>{$.attributes.direction="recvonly"})}receive(k,W,$,z){k.forEach((X,ie)=>{this.createOrRecycleRecvMedia(X,[],"recvonly",W,$,z[ie])}),this.updateBundleMids()}stopReceiving(k){const W=this.sessionDesc.mediaDescriptions.filter($=>k.indexOf($.attributes.mid)!==-1);if(W.length!==k.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");W.forEach($=>{$.media.port="0",$.attributes.direction="inactive"}),this.updateBundleMids()}updateCandidates(k){const W=this._candidates.filter($=>$.transport==="udp");if(k===hi.TCP){if(W.length===0)return;if(Z("TCP_CANDIDATE_ONLY")){const $=this._candidates.filter(z=>z.transport==="tcp");W.forEach(z=>{$.findIndex(X=>X.connectionAddress===z.connectionAddress)===-1&&$.push(Zl(Zl({},z),{},{foundation:"tcpcandidate",priority:Number(z.priority)-1+"",transport:"tcp",port:Number(z.port)+90+""}))}),this._candidates=$}else{const $=[];W.forEach(z=>{$.push(Zl(Zl({},z),{},{foundation:"tcpcandidate",priority:Number(z.priority)-1+"",transport:"tcp",port:Number(z.port)+90+""}))}),this._candidates=[...W,...$]}}else if(k===hi.RELAY){if(W.length!==0)return;{const $=this._candidates.filter(z=>z.transport==="tcp");$.forEach(z=>{W.push(Zl(Zl({},z),{},{foundation:"udpcandidate",priority:Number(z.priority)+1+"",transport:"udp",port:Number(z.port)-90+""}))}),this._candidates=[...W,...$]}}else W.length===0?(this._candidates.filter($=>$.transport==="tcp").forEach($=>{W.push(Zl(Zl({},$),{},{foundation:"udpcandidate",priority:Number($.priority)+1+"",transport:"udp",port:Number($.port)-90+""}))}),this._candidates=W):this._candidates=this._candidates.filter($=>$.transport!=="tcp");for(const $ of this.sessionDesc.mediaDescriptions)$.attributes.candidates=this.candidates}restartICE(k){k=ar(k),this._iceParameters=k,this.sessionDesc.mediaDescriptions.forEach(W=>{W.attributes.iceUfrag=k.iceUfrag,W.attributes.icePwd=k.icePwd})}predictReceivingMids(k){const W=[];for(let $=0;$<k;$++)W.push((this.currentMidIndex+$+1).toString(10));return W}findAvailableMediaIndex(k,W){return this.sessionDesc.mediaDescriptions.findIndex($=>{const z=$.media.mediaType===k&&$.media.port!=="0"&&($.attributes.direction==="sendonly"||$.attributes.direction==="sendrecv")&&$.attributes.ssrcs.length===0;if(Cn()){if(z){const X=this.firefoxSsrcMidMap.get(W[0].ssrcId);return!(X||$.attributes.mid!=="0"&&$.attributes.mid!=="1")||!(!X||X!==$.attributes.mid)}return!1}return z})}createOrRecycleDataChannel(){for(const $ of this.sessionDesc.mediaDescriptions)if($.media.mediaType==="application")return{mediaDesc:$,needExchangeSDP:!1};this.currentMidIndex+=1;const k="".concat(this.currentMidIndex),W={media:{mediaType:"application",port:_0,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(k),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(W),{mediaDesc:W,needExchangeSDP:!0}}createOrRecycleRecvMedia(k,W,$,z,X,ie){const oe=k._mediaStreamTrack.kind,Re=this.rtpCapabilities.recv,Ce=Zv(oe,Re,this.localCapabilities.send,oe===Ue.VIDEO?z:X),ge=oe===Ue.VIDEO?Re.videoExtensions:Re.audioExtensions;this.currentMidIndex+=1;const _e="".concat(this.currentMidIndex);let Se={media:{mediaType:oe,port:_0,protos:["UDP","TLS","RTP","SAVPF"],fmts:Ce.map(Ne=>Ne.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:ge,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:W,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:Ce,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:$,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(_e)}};Se=this.mungRecvMediaDsec(Se,k,ie);const De=this.findFirstClosedMedia(oe);if(De){const Ne=this.sessionDesc.mediaDescriptions.indexOf(De);this.sessionDesc.mediaDescriptions[Ne]=Se}else this.sessionDesc.mediaDescriptions.push(Se);return Se}updateRemoteCodec(k,W,$){const z=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(Se=>Se.rtpMap&&Se.rtpMap.encodingName.toLowerCase()||"").filter(Se=>{var De;return Ke(De=Object.keys(ed)).call(De,Se)}))],X=new Set(W);if(z.every(Se=>X.has(Se)))return L.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(W)),!1;const ie=this._rtpCapabilities.recv.videoCodecs.filter(Se=>W.some(De=>{var Ne;return Ke(Ne=Se.rtpMap&&Se.rtpMap.encodingName.toLowerCase()||"").call(Ne,De)}));if(ie.length===0)return L.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(z," codecs: ").concat(W)),!1;const oe=[...new Set(ie.map(Se=>Se.rtpMap&&Se.rtpMap.encodingName.toLowerCase()||""))];let Re;if(L.debug("updateRemoteCodec, from ".concat(z," to ").concat(oe)),k.length===0)Re=this.sessionDesc.mediaDescriptions.filter(Se=>Se.media.mediaType==="video"&&Se.attributes.direction==="recvonly");else if(Re=this.sessionDesc.mediaDescriptions.filter(Se=>Se.attributes.mid&&Ke(k).call(k,Se.attributes.mid)&&Se.attributes.direction==="recvonly"),Re.length!==k.length)return L.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(k,", codecs: ").concat(W)),!1;this._rtpCapabilities.recv.videoCodecs=ie;const Ce=this.localCapabilities.send,ge=this.rtpCapabilities.recv,_e=Zv(Ue.VIDEO,ge,Ce,$);return Re.forEach(Se=>{const De=_e.map(Ne=>Ne.payloadType.toString(10));L.debug("updateRemoteCodec mid: ".concat(Se.attributes.mid,", from ").concat(Se.attributes.payloads," to ").concat(_e)),Se.attributes.payloads=_e,Se.media.fmts=De}),!0}createOrRecycleSendMedia(k,W,$,z,X){const ie=this.rtpCapabilities.send,oe=k===Ue.VIDEO?ie.videoCodecs:ie.audioCodecs,Re=k===Ue.VIDEO?ie.videoExtensions:ie.audioExtensions;this.currentMidIndex+=1;const Ce="".concat(this.currentMidIndex);let ge={media:{mediaType:k,port:_0,protos:["UDP","TLS","RTP","SAVPF"],fmts:oe.map(Se=>Se.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:Re,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:W,ssrcGroups:$,rtcpFeedbackWildcards:[],payloads:oe,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:z,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(Ce)}};ge=this.mungSendMediaDesc(ge,X);const _e=this.findFirstClosedMedia(k);if(_e){const Se=this.sessionDesc.mediaDescriptions.indexOf(_e);this.sessionDesc.mediaDescriptions[Se]=ge}else this.sessionDesc.mediaDescriptions.push(ge);return ge}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(k=>k.media.port!=="0").map(k=>k.attributes.mid)}mungRecvMediaDsec(k,W,$){const z=ar(k);return sR(z),md(z,W),cR(z,W),RF(z),Yv(z,$,this.localCapabilities.send),z}mungSendMediaDesc(k,W){const $=ar(k);return Yv($,W,this.localCapabilities.recv),Ql($),$}updateRecvMedia(k,W){const $=this.sessionDesc.mediaDescriptions.findIndex(z=>z.attributes.mid===k);if($!==-1){const z=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[$],W);this.sessionDesc.mediaDescriptions[$]=z}}bumpMid(k){this.currentMidIndex+=k}findFirstClosedMedia(k){return this.sessionDesc.mediaDescriptions.find(W=>Cn()?W.media.port==="0"&&W.media.mediaType===k:W.media.port==="0")}findPreloadMediaDesc(k){return this.sessionDesc.mediaDescriptions.find(W=>{var $;return(($=W.attributes)===null||$===void 0||($=$.ssrcs[0])===null||$===void 0?void 0:$.ssrcId)===k[0].ssrcId})}getSSRC(k){var W;return(W=this.sessionDesc.mediaDescriptions.find($=>$.attributes.mid===k))===null||W===void 0?void 0:W.attributes.ssrcs}}({remoteIceParameters:t,remoteDtlsParameters:r,candidates:a,remoteRTPCapabilities:l,remoteSetup:u,localCapabilities:this.localCapabilities,cname:h}),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const f=this.remoteSDP.toString(),v=Hn.parse(this.initialOffer.sdp),E=v.mediaDescriptions.find(k=>k.media.mediaType==="audio");E&&Ql(E),this.useXR&&Qv(v);const y=Hn.print(v),C=this.logSDPExchange(y||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:y}),C==null||C(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f});const I=this.peerConnection.getTransceivers()[0];if(I!=null&&I.receiver&&this.tryBindTransportEvents(I.receiver),Z("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia();const k=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:k});const W=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(W)}}catch(f){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(f.toString()))}}send(t,r,a){var l=this;return Na(function*(){const u=yield zt(l.mutex.lock("From P2PConnection.send"));try{if(!l.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const h=[];t.forEach($=>{const z=l.peerConnection.addTransceiver($._mediaStreamTrack,{direction:"sendonly"});h.push(z),$._updateRtpTransceiver(z)}),Cn()&&Z("SIMULCAST")===!0&&(yield zt(l.applySimulcastForFirefox(h,t)));const f=yield zt(l.peerConnection.createOffer()),v=l.remoteSDP.predictReceivingMids(t.length),E=l.mungSendOfferSDP(f.sdp,t,v),y=Hn.parse(E),C=v.map($=>{const z=y.mediaDescriptions.find(X=>X.attributes.mid===$);if(!z)throw new Error("Cannot extract ssrc from mediaDescription.");return bF(z,Z("USE_PUB_RTX"))});let I;try{I=yield C}catch($){I=[],l.remoteSDP.receive(t,r,a,I);const z=l.remoteSDP.toString();throw yield zt(l.peerConnection.setLocalDescription({type:"offer",sdp:E})),yield zt(l.peerConnection.setRemoteDescription({type:"answer",sdp:z})),yield zt(l.stopSending(v,!0)),$}l.remoteSDP.receive(t,r,a,I);const k=l.remoteSDP.toString(),W=l.logSDPExchange(E,"offer","local","send");return yield zt(l.peerConnection.setLocalDescription({type:"offer",sdp:E})),yield zt(l.applySimulcastEncodings(h,t)),yield zt(l.applySendEncodings(h,t)),W==null||W(k),yield zt(l.peerConnection.setRemoteDescription({type:"answer",sdp:k})),h.map(($,z)=>{const X=v[z];return{localSSRC:C[z],id:X,transceiver:$}})}catch(h){throw h instanceof be?h:new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(h.toString()))}finally{u()}})()}async createDataChannels(t,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let a=this.dataStreamChannelMap.get(t);a&&a.readyState==="open"?L.debug("[P2PConnection] Channels are already available and can be reused directly."):(a=this.peerConnection.createDataChannel("datastream-channel",{ordered:!1,maxRetransmits:Z("DATASTREAM_MAX_RETRANSMITS")}),a.binaryType="arraybuffer",this.dataStreamChannelMap.set(t,a)),r.forEach(u=>{u._updateOriginDataChannel(a)});const{needExchangeSDP:l}=this.remoteSDP.sendDataChannel();if(l){const u=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:u});const h=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(h),L.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else L.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(a){throw a instanceof be?a:new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(a.toString()))}}async stopDataChannels(t){try{const r=this.dataStreamChannelMap.get(t);return r==null||r.close(),void this.dataStreamChannelMap.delete(t)}catch(r){throw r instanceof be?r:new be(G.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(r.toString()))}}async stopSending(t,r){const a=r?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const l=this.peerConnection.getTransceivers().filter(v=>t.indexOf(v.mid)!==-1);if(l.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");l.map(v=>{var E;v.direction="inactive",(E=v.stop)===null||E===void 0||E.call(v)});const u=await this.peerConnection.createOffer(),h=this.logSDPExchange(u.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(u),this.remoteSDP.stopReceiving(t);const f=this.remoteSDP.toString();h==null||h(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(l){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(l.toString()))}finally{a&&a()}}async receive(t,r,a,l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{mid:u,needExchangeSDP:h}=this.remoteSDP.send(t,r,a,l);if(h){const v=this.remoteSDP.toString(),E=this.logSDPExchange(v,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:v});const y=await this.peerConnection.createAnswer(),C=this.mungReceiveAnswerSDP(y.sdp,u,t);E==null||E(C||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:C}),L.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," by exchanging SDP."))}else L.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," no need to exchange SDP."));const f=this.peerConnection.getTransceivers().find(v=>v.mid===u);if(!f)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:f.receiver.track,id:u,transceiver:f}}catch(u){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async batchReceive(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:r,needExchangeSDP:a}=this.remoteSDP.batchSend(t);if(a){const l=this.remoteSDP.toString(),u=this.logSDPExchange(l,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:l});const h=await this.peerConnection.createAnswer();u==null||u(h.sdp||""),await this.peerConnection.setLocalDescription(h),L.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))}else L.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive no need to exchange SDP."));return r.map(l=>{const u=this.peerConnection.getTransceivers().find(h=>h.mid===l);if(!u)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:u.receiver.track,id:l,transceiver:u}})}catch(r){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(r.toString()))}}async stopReceiving(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(t);const r=this.remoteSDP.toString(),a=this.logSDPExchange(r,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(r){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}async muteRemote(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(t," before remote SDP created."));this.remoteSDP.mute(t);const r=this.remoteSDP.toString(),a=this.logSDPExchange(r,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(r){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(r.toString()))}}async unmuteRemote(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(t," before remote SDP created."));this.remoteSDP.unmute(t);const r=this.remoteSDP.toString(),a=this.logSDPExchange(r,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(r){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(r.toString()))}}async muteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(h=>h.mid&&t.indexOf(h.mid)!==-1);if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(h=>{h.direction="inactive"});const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.muteRemote(t);const u=this.remoteSDP.toString();l==null||l(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(r){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(h=>h.mid&&t.indexOf(h.mid)!==-1);if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(async(h,f)=>{h.direction="sendonly"});const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.unmuteRemote(t);const u=this.remoteSDP.toString();l==null||l(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(r){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(r.toString()))}}restartICE(t){var r=this;return Na(function*(){const a=yield zt(r.mutex.lock("From P2PConnection.restartICE"));try{if(!r.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(fn().supportPCSetConfiguration){const E=r.peerConnection.getConfiguration(),y=t===hi.RELAY?"relay":"all";E.iceTransportPolicy!==y&&(L.debug("[".concat(r.store.clientId,"] restartICE change iceTransportPolicy from [").concat(E.iceTransportPolicy,"] to [").concat(y,"]")),E.iceTransportPolicy=y,r.peerConnection.setConfiguration(E))}else if(t===hi.RELAY)return;r.remoteSDP.updateCandidates(t);const l=yield zt(r.peerConnection.createOffer({iceRestart:!0}));if(!l.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const u=fd(l.sdp),{remoteIceParameters:h}=yield u.iceParameters;r.remoteSDP.restartICE(h);const f=r.remoteSDP.toString(),v=r.logSDPExchange(l.sdp||"","offer","local","restartICE");r.store.descriptionStart(),yield zt(r.peerConnection.setLocalDescription(l)),v==null||v(f),yield zt(r.peerConnection.setRemoteDescription({type:"answer",sdp:f}))}catch(l){L.warning("[".concat(r.store.clientId,"] restart ICE failed, abort operation"),l)}finally{a()}})()}close(){var t;this.peerConnection.close(),(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}async updateEncoderConfig(t,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const a=await this.peerConnection.createOffer(),l=this.mungSendOfferSDP(a.sdp,[r],[t]);this.remoteSDP.updateRecvMedia(t,r);const u=this.remoteSDP.toString(),h=this.logSDPExchange(l,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:l}),h==null||h(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(a){throw new be(G.EXCHANGE_SDP_FAILED,a.toString())}}async updateSendParameters(t,r){const a=this.peerConnection.getTransceivers().filter(l=>l.mid===t);a.length===1&&(this.isVP8Simulcast(r)?Cn()||await this.applySimulcastEncodings(a,[r]):await this.applySendEncodings(a,[r]))}setStatsRemoteVideoIsReady(t,r){this.statsFilter.setVideoIsReady2(t,r)}async replaceTrack(t,r){const a=this.peerConnection.getTransceivers().find(l=>l.mid===r);a&&await a.sender.replaceTrack(t._mediaStreamTrack)}async getSelectedCandidatePair(){const t=this.peerConnection.getReceivers();if(t.length>0&&t[0].transport&&t[0].transport.iceTransport&&t[0].transport.iceTransport.getSelectedCandidatePair&&t[0].transport.iceTransport.getSelectedCandidatePair()){const r=t[0].transport.iceTransport,{local:a,remote:l}=r.getSelectedCandidatePair();return{local:qh(qh({},Rc),{},{candidateType:a.type,protocol:a.protocol,address:a.address,port:a.port}),remote:qh(qh({},Rc),{},{candidateType:l.type,protocol:l.protocol,address:l.address,port:l.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t;(t=this.onICEConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=t=>{t.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,L.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,L.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},Z("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const r={iceServers:[]};return t.iceServers?r.iceServers=t.iceServers:t.turnServer&&t.turnServer.mode!=="off"&&(bh(t.turnServer.servers)?r.iceServers=t.turnServer.servers:(r.iceServers&&r.iceServers.push(...B0.turnServerConfigToIceServers(t.turnServer.servers)),Z("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&t.turnServer.serversFromGateway&&r.iceServers.push(...B0.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),Z("FORCE_TURN_TCP")?r.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(a=>{a.forceturn&&(r.iceTransportPolicy="relay")}))),Z("ENABLE_ENCODED_TRANSFORM")&&fn().supportWebRTCEncodedTransform&&(r.encodedInsertableStreams=!0),r}static turnServerConfigToIceServers(t){const r=[];return t.forEach(a=>{a.security?a.tcpport&&r.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(f0(a.turnServerURL),":").concat(a.tcpport,"?transport=tcp")}):(a.udpport&&!Z("FORCE_TURN_TCP")&&r.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.udpport,"?transport=udp")}),a.tcpport&&r.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}))}),r}tryBindTransportEvents(t){const r=t.transport;if(r){this.transportEventReceiver=t,r.onstatechange=()=>{var l;r!=null&&r.state&&((l=this.onDTLSTransportStateChange)===null||l===void 0||l.call(this,r.state))},r.onerror=l=>{var u;(u=this.onDTLSTransportError)===null||u===void 0||u.call(this,"error"in l?l.error:l)};const a=r.iceTransport;a&&(a.onstatechange=()=>{const l=r==null?void 0:r.iceTransport.state;var u;l&&((u=this.onICETransportStateChange)===null||u===void 0||u.call(this,l))},a.getSelectedCandidatePair&&(a.onselectedcandidatepairchange=()=>{if(a.getSelectedCandidatePair()){const{local:l,remote:u}=a.getSelectedCandidatePair();L.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:l.type,protocol:l.protocol}),", remote ").concat(JSON.stringify({candidateType:u.type,protocol:u.protocol,address:u.address,port:u.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(t,r){var a;if(r||(r=this.peerConnection.getSenders().find(y=>y.track===t._mediaStreamTrack)),!r)return L.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(t))return L.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!fn().supportSetRtpSenderParameters)return L.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const l={},u={};switch(t._optimizationMode){case"motion":l.degradationPreference="maintain-framerate";break;case"detail":l.degradationPreference="maintain-resolution";break;default:l.degradationPreference="balanced"}if(t._encoderConfig){var h;const{bitrateMax:y,frameRate:C,scaleResolutionDownBy:I}=t._encoderConfig;y&&(u.maxBitrate=1e3*y),(Ke(h=t._hints).call(h,vn.LOW_STREAM)||t.isUseScaleResolutionDownBy)&&(C&&(u.maxFramerate=ca(C)),I&&I>=1&&(u.scaleResolutionDownBy=I))}if(Z("DSCP_TYPE")&&Ll()){var f;const y=Z("DSCP_TYPE");Ke(f=["very-low","low","medium","high"]).call(f,y)&&(u.networkPriority=y)}const v=r.getParameters(),E=(a=v.encodings)===null||a===void 0?void 0:a[0];Cn()&&!E&&(l.encodings=[u]),E&&Object.assign(E,u),Object.assign(v,l),L.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(v.encodings))),await r.setParameters(v)}async applySendEncodings(t,r){try{if(!fn().supportSetRtpSenderParameters||t.length!==r.length)return;for(let a=0;a<t.length;a++){const l=t[a],u=r[a];u instanceof bt&&!this.isVP8Simulcast(u)&&await this.updateRtpSenderEncodings(u,l.sender)}}catch{L.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(t,r,a){const l=Hn.parse(t);return r.forEach((u,h)=>{const f=a[h],v=l.mediaDescriptions.find(E=>E.attributes.mid===f);v&&(md(v,u),lR(v,u,this.store.codec))}),Hn.print(l)}mungReceiveAnswerSDP(t,r,a){const l=Hn.parse(t),u=l.mediaDescriptions.find(h=>h.attributes.mid===r);return u&&(a===Ue.AUDIO&&u.media.mediaType==="audio"&&Ql(u),this.useXR&&Qv(l)),Hn.print(l)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,r,a)=>{var l;(l=this.onFirstVideoDecoded)===null||l===void 0||l.call(this,t,r,a)},this.statsFilter.onSelectedLocalCandidateChanged=(t,r)=>{var a;(a=this.onSelectedLocalCandidateChanged)===null||a===void 0||a.call(this,t,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,r)=>{var a;(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0||a.call(this,t,r)},this.statsFilter.onFirstVideoDecodedTimeout=t=>{var r;(r=this.onFirstVideoDecodedTimeout)===null||r===void 0||r.call(this,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(t,r){if(t.length===r.length)for(let v=0;v<t.length;v++){var a,l,u,h,f;const E=t[v],y=r[v];if(y instanceof bt&&!Ke(a=y._hints).call(a,vn.LOW_STREAM)&&(l=y._encoderConfig)!==null&&l!==void 0&&l.bitrateMax&&((u=y._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(h=y._scalabilityMode)!==null&&h!==void 0&&h.numSpatialLayers&&((f=y._scalabilityMode)===null||f===void 0?void 0:f.numSpatialLayers)>1&&this.store.codec==="vp8"){const C={},I={high:1e3*(y._encoderConfig.bitrateMax-50),medium:5e4};C.encodings=[{rid:"m",active:!0,maxBitrate:I.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:I.high}];const k=E.sender.getParameters();await E.sender.setParameters(Object.assign(k,C))}}}async applySimulcastEncodings(t,r){if(!Cn()&&t.length===r.length)for(let a=0;a<t.length;a++){const l=r[a];if(l instanceof bt&&this.isVP8Simulcast(l)){const u=t[a],h={},f={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};h.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:f.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:f.medium,scaleResolutionDownBy:4}];const v=u.sender.getParameters();await u.sender.setParameters(Object.assign(v,h))}}}isVP8Simulcast(t){var r,a,l,u,h;return!!(t instanceof bt&&Z("SIMULCAST")&&this.store.codec==="vp8"&&!Ke(r=t._hints).call(r,vn.LOW_STREAM)&&(a=t._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&((l=t._encoderConfig)===null||l===void 0?void 0:l.bitrateMax)>200&&(u=t._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((h=t._scalabilityMode)===null||h===void 0?void 0:h.numSpatialLayers)>1)}logSDPExchange(t,r,a,l){if(Z("SDP_LOGGING"))return L.upload("[".concat(this.store.clientId,"] exchanging ").concat(a," ").concat(r," SDP during P2PConnection.").concat(l,`
`),t),r==="offer"?u=>{this.logSDPExchange(u,"answer",a==="local"?"remote":"local",l)}:void 0}async getRemoteSSRC(t){if(!this.remoteSDP)return;const r=this.remoteSDP.getSSRC(t);return r==null?void 0:r[0].ssrcId}setConfiguration(t){if(fn().supportPCSetConfiguration){const r=B0.resolvePCConfiguration(t);this.peerConnection.setConfiguration(r)}}};function Lo(i,t,r){const a=i[t];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const l=this.mutex,u=await l.lock("From P2PConnection.".concat(t));try{for(var h=arguments.length,f=new Array(h),v=0;v<h;v++)f[v]=arguments[v];return await a.apply(this,f)}finally{u()}},r}function hR(i,t){let r=document.createElement("video"),a=document.createElement("canvas");r.setAttribute("style","display:none"),a.setAttribute("style","display:none"),r.setAttribute("muted",""),r.muted=!0,r.setAttribute("autoplay",""),r.autoplay=!0,r.setAttribute("playsinline",""),a.width=ca(t.width),a.height=ca(t.height);const l=ca(t.framerate||15);document.body.append(r),document.body.append(a);let u=i._mediaStreamTrack;r.srcObject=new MediaStream([u]),r.play();const h=a.getContext("2d");if(!h)throw new ue(G.UNEXPECTED_ERROR,"can not get canvas context");const f=fn(),v=a.captureStream(f.supportRequestFrame?0:l).getVideoTracks()[0];v.canvas||(v.canvas=a),a.startCapture=()=>{if(!r)return a.stopCapture&&a.stopCapture();if(r.paused&&r.play(),r.videoHeight>2&&r.videoWidth>2){const y=r.videoWidth,C=r.videoHeight/y,I=a.width*C;Math.abs(I-a.height)>=2&&(L.debug("adjust low stream resolution","".concat(a.width,"x").concat(a.height," -> ").concat(a.width,"x").concat(I)),a.height=I)}h.drawImage(r,0,0,a.width,a.height),v.requestFrame&&v.requestFrame(),u!==i._mediaStreamTrack&&(u=i._mediaStreamTrack,r.srcObject=new MediaStream([u]))},a.stopCapture=gT(()=>a.startCapture&&a.startCapture(),l);const E=v.stop;return v.stop=()=>{E.call(v),r&&(r.remove(),r.srcObject=null,r=null),a&&(a.width=0,a.remove(),a.stopCapture&&a.stopCapture(),a.startCapture=void 0,a.stopCapture=void 0,a=null),L.debug("clean low stream renderer")},v}function WF(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function zF(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WF(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):WF(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}Te([Lo,V("design:type",Function),V("design:paramtypes",[Array,Array]),V("design:returntype",me)],yr.prototype,"updateRemoteRTPCapabilities",null),Te([Lo,V("design:type",Function),V("design:paramtypes",[Object,Object,Array,Object,String,String]),V("design:returntype",me)],yr.prototype,"connect",null),Te([Lo,V("design:type",Function),V("design:paramtypes",[Object,Array]),V("design:returntype",me)],yr.prototype,"createDataChannels",null),Te([Lo,V("design:type",Function),V("design:paramtypes",[String,Array,String,Object]),V("design:returntype",me)],yr.prototype,"receive",null),Te([Lo,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],yr.prototype,"batchReceive",null),Te([Lo,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],yr.prototype,"stopReceiving",null),Te([Lo,V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],yr.prototype,"muteRemote",null),Te([Lo,V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],yr.prototype,"unmuteRemote",null),Te([Lo,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],yr.prototype,"muteLocal",null),Te([Lo,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],yr.prototype,"unmuteLocal",null),Te([Lo,V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],yr.prototype,"close",null),Te([Lo,V("design:type",Function),V("design:paramtypes",[String,pi]),V("design:returntype",me)],yr.prototype,"updateEncoderConfig",null),Te([Lo,V("design:type",Function),V("design:paramtypes",[String,pi]),V("design:returntype",me)],yr.prototype,"updateSendParameters",null),Te([Lo,V("design:type",Function),V("design:paramtypes",[pi,String]),V("design:returntype",me)],yr.prototype,"replaceTrack",null),Te([Lo,V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],yr.prototype,"getRemoteSSRC",null);const GF=`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0
a=msid-semantic: WMS
a=ice-lite
m=application 9 UDP/DTLS/SCTP webrtc-datachannel
c=IN IP4 127.0.0.1
a=mid:0
`,tE="9",pR=2e4,fR=4e4;class mne{get localCapabilities(){return ar(this._localCapabilities)}get rtpCapabilities(){return ar(this._rtpCapabilities)}get candidates(){return ar(this._candidates)}get iceParameters(){return ar(this._iceParameters)}get dtlsParameters(){return ar(this._dtlsParameters)}constructor(t){w(this,"sessionDesc",void 0),w(this,"_localCapabilities",void 0),w(this,"_rtpCapabilities",void 0),w(this,"_candidates",void 0),w(this,"_iceParameters",void 0),w(this,"_dtlsParameters",void 0),w(this,"setup",void 0),w(this,"currentMidIndex",void 0),w(this,"cname",void 0),w(this,"firefoxSsrcMidMap",new Map),t=ar(t);const{remoteIceParameters:r,remoteDtlsParameters:a,candidates:l,remoteRTPCapabilities:u,remoteSetup:h,localCapabilities:f,cname:v}=t,E=Hn.parse(GF);this._rtpCapabilities=u,this._candidates=l,this._iceParameters=r,this._dtlsParameters=a,this._localCapabilities=f,this.setup=h,this.cname=v;const y=this.rtpCapabilities.send;for(const C of E.mediaDescriptions){if(C.attributes.iceUfrag=r.iceUfrag,C.attributes.icePwd=r.icePwd,C.attributes.fingerprints=a.fingerprints,C.attributes.candidates=l,C.attributes.setup=h,C.media.mediaType==="application"&&(C.attributes.sctpPort="5000"),C.media.mediaType==="video"&&(C.media.fmts=y.videoCodecs.map(I=>I.payloadType.toString(10)),C.attributes.payloads=y.videoCodecs,C.attributes.extmaps=y.videoExtensions,Z("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:I,ssrcGroups:k}=Pa([{ssrcId:fR,rtx:Z("USE_SUB_RTX")?40001:void 0}],this.cname);C.attributes.ssrcs=I,C.attributes.ssrcGroups=k}if(C.media.mediaType==="audio"&&(C.media.fmts=y.audioCodecs.map(I=>I.payloadType.toString(10)),C.attributes.payloads=y.audioCodecs,C.attributes.extmaps=y.audioExtensions,Ql(C),Z("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:I,ssrcGroups:k}=Pa([{ssrcId:pR}],this.cname);C.attributes.ssrcs=I,C.attributes.ssrcGroups=k}}this.sessionDesc=E,this.currentMidIndex=E.mediaDescriptions.length-1}updateRemoteRTPCapabilities(t){const r=Hn.parse(GF);this._rtpCapabilities=t;const a=this.rtpCapabilities.send;for(const l of r.mediaDescriptions){if(l.attributes.iceUfrag=this._iceParameters.iceUfrag,l.attributes.icePwd=this._iceParameters.icePwd,l.attributes.fingerprints=this._dtlsParameters.fingerprints,l.attributes.candidates=this._candidates,l.attributes.setup=this.setup,l.media.mediaType==="application"&&(l.attributes.sctpPort="5000"),l.media.mediaType==="video"&&(l.media.fmts=a.videoCodecs.map(u=>u.payloadType.toString(10)),l.attributes.payloads=a.videoCodecs,l.attributes.extmaps=a.videoExtensions,Z("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:u,ssrcGroups:h}=Pa([{ssrcId:fR,rtx:Z("USE_SUB_RTX")?40001:void 0}],this.cname);l.attributes.ssrcs=u,l.attributes.ssrcGroups=h}if(l.media.mediaType==="audio"&&(l.media.fmts=a.audioCodecs.map(u=>u.payloadType.toString(10)),l.attributes.payloads=a.audioCodecs,l.attributes.extmaps=a.audioExtensions,Z("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:u,ssrcGroups:h}=Pa([{ssrcId:pR}],this.cname);l.attributes.ssrcs=u,l.attributes.ssrcGroups=h}}this.sessionDesc=r,this.currentMidIndex=r.mediaDescriptions.length-1}preloadRemoteMedia(t){this.rtpCapabilities;const r=this.candidates,a=this.dtlsParameters,l=this.iceParameters,u=this.rtpCapabilities.send;for(let h=1;h<t;h++){const f=2*h+pR,v=2*h+fR,{ssrcs:E,ssrcGroups:y}=Pa([{ssrcId:f}],this.cname),{ssrcs:C,ssrcGroups:I}=Pa([{ssrcId:v,rtx:Z("USE_SUB_RTX")?v+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:tE,protos:["UDP","TLS","RTP","SAVPF"],fmts:u.videoCodecs.map(k=>k.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:l.iceUfrag,icePwd:l.icePwd,unrecognized:[],candidates:r,extmaps:u.videoExtensions,fingerprints:a.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:C,ssrcGroups:I,rtcpFeedbackWildcards:[],payloads:u.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*h-1)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:tE,protos:["UDP","TLS","RTP","SAVPF"],fmts:u.audioCodecs.map(k=>k.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:l.iceUfrag,icePwd:l.icePwd,unrecognized:[],candidates:r,extmaps:u.audioExtensions,fingerprints:a.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:E,ssrcGroups:y,rtcpFeedbackWildcards:[],payloads:u.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*h)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return Hn.print(this.sessionDesc)}send(t,r,a,l){const{ssrcs:u,ssrcGroups:h}=Pa(r,this.cname,Z("SYNC_GROUP")?a:void 0),f=this.findPreloadMediaDesc(u);if(f){if(Cn()&&this.firefoxSsrcMidMap.set(u[0].ssrcId,f.attributes.mid),l&&(l.twcc||l.remb)){const v=this.sessionDesc.mediaDescriptions.indexOf(f);return this.sessionDesc.mediaDescriptions[v]=this.mungSendMediaDesc(f,l),{mid:f.attributes.mid,needExchangeSDP:!0}}return{mid:f.attributes.mid,needExchangeSDP:!1}}{const v=this.findAvailableMediaIndex(t,u);let E;return v===-1||Di()||ki()||Nk()||v===0&&Z("USE_SUB_RTX")?(E=this.createOrRecycleSendMedia(t,u,h,"sendonly",l),this.updateBundleMids()):(E=ar(this.sessionDesc.mediaDescriptions[v]),E.attributes.direction="sendonly",E.attributes.ssrcs=u,E.attributes.ssrcGroups=h,this.sessionDesc.mediaDescriptions[v]=this.mungSendMediaDesc(E,l)),Cn()&&this.firefoxSsrcMidMap.set(u[0].ssrcId,E.attributes.mid),{mid:E.attributes.mid,needExchangeSDP:!0}}}batchSend(t){const r=t.map(u=>{let{kind:h,ssrcMsg:f,mslabel:v}=u;return this.send(h,f,v)}),a=[];let l=!1;return r.forEach(u=>{let{mid:h,needExchangeSDP:f}=u;f&&(l=!0),a.push(h)}),{mids:a,needExchangeSDP:l}}stopSending(t){const r=this.sessionDesc.mediaDescriptions.filter(a=>a.attributes.mid&&t.indexOf(a.attributes.mid)!==-1);if(r.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");r.forEach(a=>{a.attributes.mid==="0"||Cn()||Di()||ki()?a.attributes.ssrcs=[]:(a.attributes.ssrcs=[],a.attributes.direction="inactive",a.media.port="0")}),this.updateBundleMids()}mute(t){const r=this.sessionDesc.mediaDescriptions.find(a=>a.attributes.mid===t);if(!r)throw new Error("mediaDescription not found with ".concat(t," in remote SDP when calling RemoteSDP.mute."));r.attributes.direction="inactive"}unmute(t){const r=this.sessionDesc.mediaDescriptions.find(a=>a.attributes.mid===t);if(!r)throw new Error("mediaDescription not found with ".concat(t," in remote SDP when calling RemoteSDP.unmute."));r.attributes.direction="sendonly"}muteRemote(t){const r=this.sessionDesc.mediaDescriptions.filter(a=>Ke(t).call(t,a.attributes.mid||""));if(r.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");r.forEach(a=>{a.attributes.direction="inactive"})}unmuteRemote(t){const r=this.sessionDesc.mediaDescriptions.filter(a=>Ke(t).call(t,a.attributes.mid||""));if(r.length!==t.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");r.forEach(a=>{a.attributes.direction="recvonly"})}receive(t,r,a,l){t.forEach((u,h)=>{this.createOrRecycleRecvMedia(u,[],"recvonly",r,a,l[h])}),this.updateBundleMids()}stopReceiving(t){const r=this.sessionDesc.mediaDescriptions.filter(a=>t.indexOf(a.attributes.mid)!==-1);if(r.length!==t.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");r.forEach(a=>{a.media.port="0",a.attributes.direction="inactive"}),this.updateBundleMids()}updateCandidates(t){t===hi.TCP?this._candidates.forEach(r=>{this._candidates.findIndex(a=>a.transport==="tcp"&&a.connectionAddress===r.connectionAddress&&a.port===r.port)===-1&&this._candidates.push(zF(zF({},r),{},{foundation:"tcpcandidate",priority:Number(r.priority)-1+"",transport:"tcp",port:Number(r.port)+90+""}))}):this._candidates=this._candidates.filter(r=>r.transport!=="tcp");for(const r of this.sessionDesc.mediaDescriptions)r.attributes.candidates=this.candidates}restartICE(t){t=ar(t),this._iceParameters=t,this.sessionDesc.mediaDescriptions.forEach(r=>{r.attributes.iceUfrag=t.iceUfrag,r.attributes.icePwd=t.icePwd})}predictReceivingMids(t){const r=[];for(let a=0;a<t;a++)r.push((this.currentMidIndex+a+1).toString(10));return r}findAvailableMediaIndex(t,r){return this.sessionDesc.mediaDescriptions.findIndex(a=>{const l=a.media.mediaType===t&&a.media.port!=="0"&&(a.attributes.direction==="sendonly"||a.attributes.direction==="sendrecv")&&a.attributes.ssrcs.length===0;if(Cn()){if(l){const u=this.firefoxSsrcMidMap.get(r[0].ssrcId);return!(u||a.attributes.mid!=="0"&&a.attributes.mid!=="1")||!(!u||u!==a.attributes.mid)}return!1}return l})}createOrRecycleRecvMedia(t,r,a,l,u,h){const f=t._mediaStreamTrack.kind,v=this.rtpCapabilities.recv,E=Zv(f,v,this.localCapabilities.send,f===Ue.VIDEO?l:u),y=f===Ue.VIDEO?v.videoExtensions:v.audioExtensions;this.currentMidIndex+=1;const C="".concat(this.currentMidIndex);let I={media:{mediaType:f,port:tE,protos:["UDP","TLS","RTP","SAVPF"],fmts:E.map(W=>W.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:y,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:r,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:E,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:a,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(C)}};I=this.mungRecvMediaDsec(I,t,h);const k=this.findFirstClosedMedia(f);if(k){const W=this.sessionDesc.mediaDescriptions.indexOf(k);this.sessionDesc.mediaDescriptions[W]=I}else this.sessionDesc.mediaDescriptions.push(I);return I}updateRemoteCodec(t,r,a){const l=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(I=>I.rtpMap&&I.rtpMap.encodingName.toLowerCase()||"").filter(I=>{var k;return Ke(k=Object.keys(ed)).call(k,I)}))],u=new Set(r);if(l.every(I=>u.has(I)))return L.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(r)),!1;const h=this._rtpCapabilities.recv.videoCodecs.filter(I=>r.some(k=>{var W;return Ke(W=I.rtpMap&&I.rtpMap.encodingName.toLowerCase()||"").call(W,k)}));if(h.length===0)return L.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(l," codecs: ").concat(r)),!1;const f=[...new Set(h.map(I=>I.rtpMap&&I.rtpMap.encodingName.toLowerCase()||""))];let v;if(L.debug("updateRemoteCodec, from ".concat(l," to ").concat(f)),t.length===0)v=this.sessionDesc.mediaDescriptions.filter(I=>I.media.mediaType==="video"&&I.attributes.direction==="recvonly");else if(v=this.sessionDesc.mediaDescriptions.filter(I=>I.attributes.mid&&Ke(t).call(t,I.attributes.mid)&&I.attributes.direction==="recvonly"),v.length!==t.length)return L.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(t,", codecs: ").concat(r)),!1;this._rtpCapabilities.recv.videoCodecs=h;const E=this.localCapabilities.send,y=this.rtpCapabilities.recv,C=Zv(Ue.VIDEO,y,E,a);return v.forEach(I=>{const k=C.map(W=>W.payloadType.toString(10));L.debug("updateRemoteCodec mid: ".concat(I.attributes.mid,", from ").concat(I.attributes.payloads," to ").concat(C)),I.attributes.payloads=C,I.media.fmts=k}),!0}createOrRecycleSendMedia(t,r,a,l,u){const h=this.rtpCapabilities.send,f=t===Ue.VIDEO?h.videoCodecs:h.audioCodecs,v=t===Ue.VIDEO?h.videoExtensions:h.audioExtensions;this.currentMidIndex+=1;const E="".concat(this.currentMidIndex);let y={media:{mediaType:t,port:tE,protos:["UDP","TLS","RTP","SAVPF"],fmts:f.map(I=>I.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:v,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:r,ssrcGroups:a,rtcpFeedbackWildcards:[],payloads:f,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:l,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(E)}};y=this.mungSendMediaDesc(y,u);const C=this.findFirstClosedMedia(t);if(C){const I=this.sessionDesc.mediaDescriptions.indexOf(C);this.sessionDesc.mediaDescriptions[I]=y}else this.sessionDesc.mediaDescriptions.push(y);return y}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(t=>t.media.port!=="0").map(t=>t.attributes.mid)}mungRecvMediaDsec(t,r,a){const l=ar(t);return sR(l),md(l,r),cR(l,r),RF(l),Yv(l,a,this.localCapabilities.send),l}mungSendMediaDesc(t,r){const a=ar(t);return Yv(a,r,this.localCapabilities.recv),Ql(a),a}updateRecvMedia(t,r){const a=this.sessionDesc.mediaDescriptions.findIndex(l=>l.attributes.mid===t);if(a!==-1){const l=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[a],r);this.sessionDesc.mediaDescriptions[a]=l}}bumpMid(t){this.currentMidIndex+=t}findFirstClosedMedia(t){return this.sessionDesc.mediaDescriptions.find(r=>Cn()?r.media.port==="0"&&r.media.mediaType===t:r.media.port==="0")}findPreloadMediaDesc(t){return this.sessionDesc.mediaDescriptions.find(r=>{var a;return((a=r.attributes)===null||a===void 0||(a=a.ssrcs[0])===null||a===void 0?void 0:a.ssrcId)===t[0].ssrcId})}getSSRC(t){var r;return(r=this.sessionDesc.mediaDescriptions.find(a=>a.attributes.mid===t))===null||r===void 0?void 0:r.attributes.ssrcs}}function KF(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function nE(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KF(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):KF(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}class gi extends pv{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}constructor(t,r,a){super(t,r),w(this,"store",void 0),w(this,"peerConnection",void 0),w(this,"remoteSDP",void 0),w(this,"initialOffer",void 0),w(this,"transportEventReceiver",void 0),w(this,"statsFilter",void 0),w(this,"useXR",Z("USE_XR")),w(this,"localCapabilities",void 0),w(this,"localCandidateCount",0),w(this,"allCandidatesReceived",!1),w(this,"remoteCodecs",void 0),w(this,"dataStreamChannelMap",new Map),w(this,"establishPromise",void 0),w(this,"mutex",new Mr("NVExtentionsConnection-mutex")),w(this,"rtcMedia",void 0),this.store=r,this.peerConnection=a,this.statsFilter=eE(this.peerConnection,Z("STATS_UPDATE_INTERVAL"),void 0,Cn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(t){try{const r=await this.peerConnection.createOffer();if(!r.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const a=fd(r.sdp),l=await wF({filterRTX:!Z("USE_PUB_RTX")&&!Z("USE_SUB_RTX"),filterVideoFec:Z("FILTER_VIDEO_FEC"),filterAudioFec:Z("FILTER_AUDIO_FEC"),filterVideoCodec:Z("FILTER_VIDEO_CODEC")},{useXR:this.useXR});return this.localCapabilities=l,this.initialOffer=r,nE(nE({},a),{},{rtpCapabilities:l,offerSDP:r.sdp})}catch(r){throw new ue(G.GET_LOCAL_CONNECTION_PARAMS_FAILED,r.toString())}}async connect(t,r,a,l,u,h){try{if(!this.initialOffer)throw new Error("Cannot establish NVConnection without initial offer.");this.remoteSDP=new mne({remoteIceParameters:t,remoteDtlsParameters:r,candidates:a,remoteRTPCapabilities:l,remoteSetup:u,localCapabilities:Jv(this.localCapabilities),cname:h});const f=this.remoteSDP.toString(),v=Hn.parse(this.initialOffer.sdp),E=v.mediaDescriptions.find(I=>I.media.mediaType==="audio");E&&Ql(E),this.useXR&&Qv(v);const y=Hn.print(v),C=this.logSDPExchange(y||"","offer","local","connect");await this.peerConnection.setLocalDescription({type:"offer",sdp:y}),C==null||C(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(f){throw new ue(G.EXCHANGE_SDP_FAILED,"NV.connect failed; ".concat(f.toString()))}}async updateRemoteRTPCapabilities(t,r){let a;this.remoteCodecs=r,this.localCapabilities&&(a=Jv(this.localCapabilities));const l=[...new Set(a&&a.send.videoCodecs.map(u=>u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").filter(u=>{var h;return Ke(h=Object.keys(ed)).call(h,u)}))];if(He.updateRemoteRTPCapabilities(this.store.sessionId,{mids:t,localCodecs:l,remoteCodecs:this.remoteCodecs}),!this.remoteSDP)return void L.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(l,", codecs: ").concat(r));if(this.remoteSDP.updateRemoteCodec(t,r,this.store.codec)){const u=await this.peerConnection.createOffer(),h=this.logSDPExchange(u.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(u);const f=this.remoteSDP.toString();h==null||h(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}else L.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async updateRemoteConnect(t){var r,a,l,u;(r=this.remoteSDP)===null||r===void 0||r.updateRemoteRTPCapabilities(t),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&((u=this.remoteSDP)===null||u===void 0||u.updateRemoteCodec([],this.remoteCodecs,this.store.codec)),(a=this.remoteSDP)===null||a===void 0||a.preloadRemoteMedia(2);const h=(l=this.remoteSDP)===null||l===void 0?void 0:l.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:h});const f=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(f),L.debug("[NVExtentionsConnection] updateRemoteRTPCapabilities by exchanging SDP.")}send(t,r,a){var l=this;return Na(function*(){const u=yield zt(l.mutex.lock("From NVExtentionsConnection.send"));try{if(!l.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.send before remote SDP created");const h=[];t.forEach($=>{const z=l.peerConnection.addTransceiver($._mediaStreamTrack,{direction:"sendonly"});h.push(z)}),Cn()&&Z("SIMULCAST")===!0&&(yield zt(l.applySimulcastForFirefox(h,t)));const f=yield zt(l.peerConnection.createOffer()),v=l.remoteSDP.predictReceivingMids(t.length),E=l.mungSendOfferSDP(f.sdp,t,v),y=Hn.parse(E),C=v.map($=>{const z=y.mediaDescriptions.find(X=>X.attributes.mid===$);if(!z)throw new Error("Cannot extract ssrc from mediaDescription.");return bF(z,Z("USE_PUB_RTX"))});let I;try{I=yield C}catch($){I=[],l.remoteSDP.receive(t,r,a,I);const z=l.remoteSDP.toString();throw yield zt(l.peerConnection.setLocalDescription({type:"offer",sdp:E})),yield zt(l.peerConnection.setRemoteDescription({type:"answer",sdp:z})),yield zt(l.stopSending(v,!0)),$}l.remoteSDP.receive(t,r,a,I);const k=l.remoteSDP.toString(),W=l.logSDPExchange(E,"offer","local","send");return yield zt(l.peerConnection.setLocalDescription({type:"offer",sdp:E})),yield zt(l.applySimulcastEncodings(h,t)),yield zt(l.applySendEncodings(h,t)),W==null||W(k),yield zt(l.peerConnection.setRemoteDescription({type:"answer",sdp:k})),h.map(($,z)=>{const X=v[z];return{localSSRC:C[z],id:X,transceiver:$}})}catch(h){throw h instanceof ue?h:new ue(G.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.send failed; ".concat(h.toString()))}finally{u()}})()}async stopSending(t,r){const a=r?void 0:await this.mutex.lock("From NVExtentionsConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopSending before remote SDP created");const l=this.peerConnection.getTransceivers().filter(v=>t.indexOf(v.mid)!==-1);if(l.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call NVExtentionsConnection.stopSending.");l.map(v=>{var E;v.direction="inactive",(E=v.stop)===null||E===void 0||E.call(v)});const u=await this.peerConnection.createOffer(),h=this.logSDPExchange(u.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(u),this.remoteSDP.stopReceiving(t);const f=this.remoteSDP.toString();h==null||h(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(l){throw new ue(G.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.stopSending failed; ".concat(l.toString()))}finally{a&&a()}}async createDataChannels(t,r){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.createDataChannels before remote SDP created");let a=this.dataStreamChannelMap.get(t);return a&&a.readyState==="open"?L.debug("[P2PConnection] Channels are already available and can be reused directly."):(a=this.peerConnection.createDataChannel("datastream-channel",{ordered:!1,maxRetransmits:Z("DATASTREAM_MAX_RETRANSMITS")}),a.binaryType="arraybuffer",this.dataStreamChannelMap.set(t,a)),void r.forEach(l=>{l._updateOriginDataChannel(a)})}catch(a){throw a instanceof ue?a:new ue(G.DATACHANNEL_FAILED,"NVExtentionsConnection.createDataChannels failed; ".concat(a.toString()))}}async stopDataChannels(t){try{const r=this.dataStreamChannelMap.get(t);return r==null||r.close(),void this.dataStreamChannelMap.delete(t)}catch(r){throw r instanceof ue?r:new ue(G.DATACHANNEL_FAILED,"NVExtentionsConnection.stopDataChannels failed; ".concat(r.toString()))}}async receive(t,r,a,l){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.receive ".concat(t," before remoteSDP created."));const{mid:u,needExchangeSDP:h}=this.remoteSDP.send(t,r,a,l);if(h){const v=this.remoteSDP.toString(),E=this.logSDPExchange(v,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:v});const y=await this.peerConnection.createAnswer(),C=this.mungReceiveAnswerSDP(y.sdp,u,t);E==null||E(C||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:C}),L.debug("[NVExtentionsConnection] receive ".concat(t," by exchanging SDP."))}else L.debug("[NVExtentionsConnection] receive ".concat(t," no need to exchange SDP."));const f=this.peerConnection.getTransceivers().find(v=>v.mid===u);if(!f)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:f.receiver.track,id:u}}catch(u){throw new ue(G.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(u.toString()))}}async batchReceive(t){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.batchReceive before remoteSDP created.");const{mids:r,needExchangeSDP:a}=this.remoteSDP.batchSend(t);if(a){const l=this.remoteSDP.toString(),u=this.logSDPExchange(l,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:l});const h=await this.peerConnection.createAnswer();u==null||u(h.sdp||""),await this.peerConnection.setLocalDescription(h),L.debug("[NVExtentionsConnection] batchReceive by exchanging SDP.")}else L.debug("[NVExtentionsConnection] batchReceive no need to exchange SDP.");return r.map(l=>{const u=this.peerConnection.getTransceivers().find(h=>h.mid===l);if(!u)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:u.receiver.track,id:l}})}catch(r){throw new ue(G.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(r.toString()))}}async stopReceiving(t){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(t);const r=this.remoteSDP.toString(),a=this.logSDPExchange(r,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(r){throw new ue(G.EXCHANGE_SDP_FAILED,"NVExtentionsConnection stopReceiving failed; ".concat(r.toString()))}}async muteRemote(t){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteRemote mid=".concat(t," before remote SDP created."));this.remoteSDP.mute(t);const r=this.remoteSDP.toString(),a=this.logSDPExchange(r,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(r){throw new ue(G.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteRemote failed; ".concat(r.toString()))}}async unmuteRemote(t){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteRemote mid=".concat(t," before remote SDP created."));this.remoteSDP.unmute(t);const r=this.remoteSDP.toString(),a=this.logSDPExchange(r,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const l=await this.peerConnection.createAnswer();a==null||a(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(r){throw new ue(G.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteRemote failed; ".concat(r.toString()))}}async muteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(h=>h.mid&&t.indexOf(h.mid)!==-1);if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(h=>{h.direction="inactive"});const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.muteRemote(t);const u=this.remoteSDP.toString();l==null||l(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(r){throw new ue(G.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(h=>h.mid&&t.indexOf(h.mid)!==-1);if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(async(h,f)=>{h.direction="sendonly"});const a=await this.peerConnection.createOffer(),l=this.logSDPExchange(a.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(a),this.remoteSDP.unmuteRemote(t);const u=this.remoteSDP.toString();l==null||l(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(r){throw new ue(G.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteLocal failed; ".concat(r.toString()))}}restartICE(t){var r=this;return Na(function*(){const a=yield zt(r.mutex.lock("From NVExtentionsConnection.restartICE"));try{if(!r.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(fn().supportPCSetConfiguration){const E=r.peerConnection.getConfiguration(),y=t===hi.RELAY?"relay":"all";E.iceTransportPolicy!==y&&(L.debug("restartICE change iceTransportPolicy from [".concat(E.iceTransportPolicy,"] to [").concat(y,"]")),E.iceTransportPolicy=y,r.peerConnection.setConfiguration(E))}else if(t===hi.RELAY)return;t!==hi.RELAY&&r.remoteSDP.updateCandidates(t);const l=yield zt(r.peerConnection.createOffer({iceRestart:!0}));if(!l.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const u=fd(l.sdp),{remoteIceParameters:h}=yield u.iceParameters;r.remoteSDP.restartICE(h);const f=r.remoteSDP.toString(),v=r.logSDPExchange(l.sdp||"","offer","local","restartICE");yield zt(r.peerConnection.setLocalDescription(l)),v==null||v(f),yield zt(r.peerConnection.setRemoteDescription({type:"answer",sdp:f}))}catch(l){L.warning("restart ICE failed, abort operation",l)}finally{a()}})()}close(){var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}async updateEncoderConfig(t,r){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.updateEncoderConfig before remote SDP created.");const a=await this.peerConnection.createOffer(),l=this.mungSendOfferSDP(a.sdp,[r],[t]);this.remoteSDP.updateRecvMedia(t,r);const u=this.remoteSDP.toString(),h=this.logSDPExchange(l,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:l}),h==null||h(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(a){throw new ue(G.EXCHANGE_SDP_FAILED,a.toString())}}async updateSendParameters(t,r){const a=this.peerConnection.getTransceivers().filter(l=>l.mid===t);a.length===1&&(this.isVP8Simulcast(r)?Cn()||await this.applySimulcastEncodings(a,[r]):await this.applySendEncodings(a,[r]))}setStatsRemoteVideoIsReady(t,r){this.statsFilter.setVideoIsReady2(t,r)}async replaceTrack(t,r){const a=this.peerConnection.getTransceivers().find(l=>l.mid===r);a&&await a.sender.replaceTrack(t._mediaStreamTrack)}getP2PConnectionParams(){var t;if((t=this.peerConnection.currentLocalDescription)===null||t===void 0||!t.sdp||!this.localCapabilities)throw new Error;return nE(nE({},fd(this.peerConnection.currentLocalDescription.sdp)),{},{rtpCapabilities:this.localCapabilities})}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t;(t=this.onICEConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=t=>{t.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,L.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,L.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},Z("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const r={iceServers:[]};return t.iceServers?r.iceServers=t.iceServers:t.turnServer&&t.turnServer.mode!=="off"&&(bh(t.turnServer.servers)?r.iceServers=t.turnServer.servers:(r.iceServers&&r.iceServers.push(...gi.turnServerConfigToIceServers(t.turnServer.servers)),Z("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&t.turnServer.serversFromGateway&&r.iceServers.push(...gi.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),Z("FORCE_TURN_TCP")?r.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(a=>{a.forceturn&&(r.iceTransportPolicy="relay")}))),r}static turnServerConfigToIceServers(t){const r=[];return t.forEach(a=>{a.security?a.tcpport&&r.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(f0(a.turnServerURL),":").concat(a.tcpport,"?transport=tcp")}):(a.udpport&&!Z("FORCE_TURN_TCP")&&r.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.udpport,"?transport=udp")}),a.tcpport&&r.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}))}),r}async applySendEncodings(t,r){try{if(!fn().supportSetRtpSenderParameters||t.length!==r.length)return;for(let C=0;C<t.length;C++){const I=t[C],k=r[C];if(k&&k instanceof bt){var a,l,u;if(this.isVP8Simulcast(k))continue;const W={},$={};switch(k._optimizationMode){case"motion":W.degradationPreference="maintain-framerate";break;case"detail":W.degradationPreference="maintain-resolution";break;default:W.degradationPreference="balanced"}var h,f,v,E;if((a=k._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&($.maxBitrate=1e3*((h=k._encoderConfig)===null||h===void 0?void 0:h.bitrateMax)),Ke(l=k._hints).call(l,vn.LOW_STREAM)&&((f=k._encoderConfig)!==null&&f!==void 0&&f.frameRate&&($.maxFramerate=ca(k._encoderConfig.frameRate)),(v=k._encoderConfig)!==null&&v!==void 0&&v.scaleResolutionDownBy&&((E=k._encoderConfig)===null||E===void 0?void 0:E.scaleResolutionDownBy)>1&&($.scaleResolutionDownBy=k._encoderConfig.scaleResolutionDownBy)),Z("DSCP_TYPE")&&Ll()){var y;const ie=Z("DSCP_TYPE");Ke(y=["very-low","low","medium","high"]).call(y,ie)&&($.networkPriority=ie)}const z=I.sender.getParameters(),X=(u=z.encodings)===null||u===void 0?void 0:u[0];Cn()&&!X&&(W.encodings=[$]),X&&Object.assign(X,$),Object.assign(z,W),await I.sender.setParameters(z)}}}catch{L.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(t,r,a){const l=Hn.parse(t);return r.forEach((u,h)=>{const f=a[h],v=l.mediaDescriptions.find(E=>E.attributes.mid===f);v&&(md(v,u),lR(v,u,this.store.codec))}),Hn.print(l)}mungReceiveAnswerSDP(t,r,a){const l=Hn.parse(t),u=l.mediaDescriptions.find(h=>h.attributes.mid===r);return u&&a===Ue.AUDIO&&u.media.mediaType==="audio"&&Ql(u),this.useXR&&Qv(l),Hn.print(l)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,r,a)=>{var l;(l=this.onFirstVideoDecoded)===null||l===void 0||l.call(this,t,r,a)},this.statsFilter.onSelectedLocalCandidateChanged=(t,r)=>{var a;(a=this.onSelectedLocalCandidateChanged)===null||a===void 0||a.call(this,t,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,r)=>{var a;(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0||a.call(this,t,r)},this.statsFilter.onFirstVideoDecodedTimeout=t=>{var r;(r=this.onFirstVideoDecodedTimeout)===null||r===void 0||r.call(this,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(t,r){if(t.length===r.length)for(let v=0;v<t.length;v++){var a,l,u,h,f;const E=t[v],y=r[v];if(y instanceof bt&&!Ke(a=y._hints).call(a,vn.LOW_STREAM)&&(l=y._encoderConfig)!==null&&l!==void 0&&l.bitrateMax&&((u=y._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(h=y._scalabilityMode)!==null&&h!==void 0&&h.numSpatialLayers&&((f=y._scalabilityMode)===null||f===void 0?void 0:f.numSpatialLayers)>1&&this.store.codec==="vp8"){const C={},I={high:1e3*(y._encoderConfig.bitrateMax-50),medium:5e4};C.encodings=[{rid:"m",active:!0,maxBitrate:I.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:I.high}];const k=E.sender.getParameters();await E.sender.setParameters(Object.assign(k,C))}}}async applySimulcastEncodings(t,r){if(!Cn()&&t.length===r.length)for(let a=0;a<t.length;a++){const l=r[a];if(l instanceof bt&&this.isVP8Simulcast(l)){const u=t[a],h={},f={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};h.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:f.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:f.medium,scaleResolutionDownBy:4}];const v=u.sender.getParameters();await u.sender.setParameters(Object.assign(v,h))}}}isVP8Simulcast(t){var r,a,l,u,h;return!!(t instanceof bt&&Z("SIMULCAST")&&this.store.codec==="vp8"&&!Ke(r=t._hints).call(r,vn.LOW_STREAM)&&(a=t._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&((l=t._encoderConfig)===null||l===void 0?void 0:l.bitrateMax)>200&&(u=t._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((h=t._scalabilityMode)===null||h===void 0?void 0:h.numSpatialLayers)>1)}logSDPExchange(t,r,a,l){if(Z("SDP_LOGGING"))return L.upload("exchanging ".concat(a," ").concat(r," SDP during NVExtentionsConnection.").concat(l,`
`),t),r==="offer"?u=>{this.logSDPExchange(u,"answer",a==="local"?"remote":"local",l)}:void 0}async getRemoteSSRC(t){if(!this.remoteSDP)return;const r=this.remoteSDP.getSSRC(t);return r==null?void 0:r[0].ssrcId}setConfiguration(t){if(fn().supportPCSetConfiguration){const r=gi.resolvePCConfiguration(t);this.peerConnection.setConfiguration(r)}}}function So(i,t,r){const a=i[t];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const l=this.mutex,u=await l.lock("From NVExtentionsConnection.".concat(t));try{for(var h=arguments.length,f=new Array(h),v=0;v<h;v++)f[v]=arguments[v];return await a.apply(this,f)}finally{u()}},r}function qF(i){var t,r,a,l=2;for(typeof Symbol<"u"&&(r=_F,a=Symbol.iterator);l--;){if(r&&(t=i[r])!=null)return t.call(i);if(a&&(t=i[a])!=null)return new rE(t.call(i));r="@@asyncIterator",a="@@iterator"}throw new TypeError("Object is not async iterable")}function rE(i){function t(r){if(Object(r)!==r)return me.reject(new TypeError(r+" is not an object."));var a=r.done;return me.resolve(r.value).then(function(l){return{value:l,done:a}})}return rE=function(r){this.s=r,this.n=r.next},rE.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(r){var a=this.s.return;return a===void 0?me.resolve({value:r,done:!0}):t(a.apply(this.s,arguments))},throw:function(r){var a=this.s.return;return a===void 0?me.reject(r):t(a.apply(this.s,arguments))}},new rE(i)}Te([So,V("design:type",Function),V("design:paramtypes",[Object,Object,Array,Object,String,String]),V("design:returntype",me)],gi.prototype,"connect",null),Te([So,V("design:type",Function),V("design:paramtypes",[Array,Array]),V("design:returntype",me)],gi.prototype,"updateRemoteRTPCapabilities",null),Te([So,V("design:type",Function),V("design:paramtypes",[Object]),V("design:returntype",me)],gi.prototype,"updateRemoteConnect",null),Te([So,V("design:type",Function),V("design:paramtypes",[Object,Array]),V("design:returntype",me)],gi.prototype,"createDataChannels",null),Te([So,V("design:type",Function),V("design:paramtypes",[String,Array,String,Object]),V("design:returntype",me)],gi.prototype,"receive",null),Te([So,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],gi.prototype,"batchReceive",null),Te([So,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],gi.prototype,"stopReceiving",null),Te([So,V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],gi.prototype,"muteRemote",null),Te([So,V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],gi.prototype,"unmuteRemote",null),Te([So,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],gi.prototype,"muteLocal",null),Te([So,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],gi.prototype,"unmuteLocal",null),Te([So,V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],gi.prototype,"close",null),Te([So,V("design:type",Function),V("design:paramtypes",[String,pi]),V("design:returntype",me)],gi.prototype,"updateEncoderConfig",null),Te([So,V("design:type",Function),V("design:paramtypes",[String,pi]),V("design:returntype",me)],gi.prototype,"updateSendParameters",null),Te([So,V("design:type",Function),V("design:paramtypes",[pi,String]),V("design:returntype",me)],gi.prototype,"replaceTrack",null),Te([So,V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],gi.prototype,"getRemoteSSRC",null);class Sr extends pv{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}constructor(t,r){super(t,r),w(this,"store",void 0),w(this,"peerConnection",void 0),w(this,"cname",void 0),w(this,"mutex",new Mr("DataChannelConnection-mutex")),w(this,"dataChannel",void 0),w(this,"_p2pConnection",void 0),w(this,"establishPromise",void 0),w(this,"_nvMedia",void 0),this.store=r,this.store.dcId=this.store.dcId+1,this.peerConnection=new RTCPeerConnection(Sr.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.dataChannel=this.peerConnection.createDataChannel("agora-signal",{ordered:!1,maxPacketLifeTime:50}),this.dataChannel.binaryType="arraybuffer",this._p2pConnection=new gi(t,r,this.peerConnection),this.bindPCEvents(),this.establishPromise=this._p2pConnection.establishPromise}async establish(){var t;const r=(t=this._nvMedia)===null||t===void 0?void 0:t.getLocalRtpCapabilities();return await this._p2pConnection.establish(r)}getP2PConnectionParams(){return this._p2pConnection.getP2PConnectionParams()}async connect(t,r,a,l,u,h){return this.cname=h,await this._p2pConnection.connect(t,r,a,l,u,h),await new me((f,v)=>{const E=setTimeout(()=>{this.closeSignal(),v(new ue(G.DATACHANNEL_CONNECTION_TIMEOUT,"Datachannel connection timed out, candidates: ".concat(JSON.stringify(a))))},2e3);this.dataChannel.onopen=()=>{if(this.dataChannel.readyState==="open")return clearTimeout(E),void f()},this.dataChannel.onerror=y=>{this.closeSignal(),v(y)}}),{transmitter:this.dataChannel,close:this.closeSignal.bind(this)}}async updateRemoteRTPCapabilities(t,r){return this._p2pConnection.updateRemoteRTPCapabilities(t,r)}send(t,r,a){var l=this;return Na(function*(){const u=yield zt(l.mutex.lock("From DataChannelConnection.send"));try{return yield*qv(qF(l._p2pConnection.send(t,r,a)))}finally{u()}})()}async stopSending(t,r){return this._p2pConnection.stopSending(t,r)}async createDataChannels(t,r){return this._p2pConnection.createDataChannels(t,r)}async stopDataChannels(t){return this._p2pConnection.stopDataChannels(t)}async receive(t,r,a,l){return this._nvMedia?(L.debug("[DataChannelConnection] receive ".concat(t," by DataChannel.")),await this._nvMedia.reveiveByRTCMedia(t,r,this.cname)):(L.debug("[DataChannelConnection] receive ".concat(t," by WebRTC.")),await this._p2pConnection.receive(t,r,a,l))}async batchReceive(t){return[...await this._p2pConnection.batchReceive(t)]}async stopReceiving(t){return await this._p2pConnection.stopReceiving(t)}async muteRemote(t){return await this._p2pConnection.muteRemote(t)}async unmuteRemote(t){return await this._p2pConnection.unmuteRemote(t)}async muteLocal(t){return await this._p2pConnection.muteLocal(t)}async unmuteLocal(t){return await this._p2pConnection.unmuteLocal(t)}restartICE(t){var r=this;return Na(function*(){return yield*qv(qF(r._p2pConnection.restartICE(t)))})()}close(){var t;(t=this._nvMedia)===null||t===void 0||t.close(),this._p2pConnection.close(),this.unbindConnectionEvents(this._p2pConnection)}getStats(){return this._p2pConnection.getStats()}getRemoteVideoIsReady(t){return this._p2pConnection.getRemoteVideoIsReady(t)}updateRemoteConnect(t){var r;(r=this._nvMedia)===null||r===void 0||r.setRemoteRtpCapabilities(t),this._p2pConnection.updateRemoteConnect(t)}async updateEncoderConfig(t,r){return await this._p2pConnection.updateEncoderConfig(t,r)}async updateSendParameters(t,r){return await this._p2pConnection.updateSendParameters(t,r)}setStatsRemoteVideoIsReady(t,r){this._p2pConnection.setStatsRemoteVideoIsReady(t,r)}async replaceTrack(t,r){return await this._p2pConnection.replaceTrack(t,r)}async getRemoteSSRC(t){return this._p2pConnection.getRemoteSSRC(t)}logSDPExchange(t,r,a,l){if(Z("SDP_LOGGING"))return L.upload("exchanging ".concat(a," ").concat(r," SDP during DataChannelConnection.").concat(l,`
`),t),r==="offer"?u=>{this.logSDPExchange(u,"answer",a==="local"?"remote":"local",l)}:void 0}static resolvePCConfiguration(t){const r={iceServers:[]};return t.iceServers?r.iceServers=t.iceServers:t.turnServer&&t.turnServer.mode!=="off"&&(bh(t.turnServer.servers)?r.iceServers=t.turnServer.servers:(r.iceServers&&r.iceServers.push(...Sr.turnServerConfigToIceServers(t.turnServer.servers)),Z("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&t.turnServer.serversFromGateway&&r.iceServers.push(...Sr.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),Z("FORCE_TURN_TCP")?r.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(a=>{a.forceturn&&(r.iceTransportPolicy="relay")}))),r}static turnServerConfigToIceServers(t){const r=[];return t.forEach(a=>{a.security?a.tcpport&&r.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(f0(a.turnServerURL),":").concat(a.tcpport,"?transport=tcp")}):(a.udpport&&!Z("FORCE_TURN_TCP")&&r.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.udpport,"?transport=udp")}),a.tcpport&&r.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=tcp")}))}),r}bindPCEvents(){this._p2pConnection.onICEConnectionStateChange=t=>{var r;return(r=this.onICEConnectionStateChange)===null||r===void 0?void 0:r.call(this,t)},this._p2pConnection.onConnectionStateChange=t=>{var r;return(r=this.onConnectionStateChange)===null||r===void 0?void 0:r.call(this,t)},this._p2pConnection.onDTLSTransportStateChange=t=>{var r;return(r=this.onDTLSTransportStateChange)===null||r===void 0?void 0:r.call(this,t)},this._p2pConnection.onDTLSTransportError=t=>{var r;return(r=this.onDTLSTransportError)===null||r===void 0?void 0:r.call(this,t)},this._p2pConnection.onICETransportStateChange=t=>{var r;return(r=this.onICETransportStateChange)===null||r===void 0?void 0:r.call(this,t)},this._p2pConnection.onFirstAudioReceived=t=>{var r;return(r=this.onFirstAudioReceived)===null||r===void 0?void 0:r.call(this,t)},this._p2pConnection.onFirstVideoReceived=t=>{var r;return(r=this.onFirstVideoReceived)===null||r===void 0?void 0:r.call(this,t)},this._p2pConnection.onFirstAudioDecoded=t=>{var r;return(r=this.onFirstAudioDecoded)===null||r===void 0?void 0:r.call(this,t)},this._p2pConnection.onFirstVideoDecoded=(t,r,a)=>{var l;return(l=this.onFirstVideoDecoded)===null||l===void 0?void 0:l.call(this,t,r,a)},this._p2pConnection.onFirstVideoDecodedTimeout=t=>{var r;return(r=this.onFirstVideoDecodedTimeout)===null||r===void 0?void 0:r.call(this,t)},this._p2pConnection.onSelectedLocalCandidateChanged=(t,r)=>{var a;return(a=this.onSelectedLocalCandidateChanged)===null||a===void 0?void 0:a.call(this,t,r)},this._p2pConnection.onSelectedRemoteCandidateChanged=(t,r)=>{var a;return(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0?void 0:a.call(this,t,r)}}closeSignal(){this.dataChannel.close(),this.peerConnection.close()}unbindConnectionEvents(t){t.onConnectionStateChange=void 0,t.onICEConnectionStateChange=void 0,t.onICETransportStateChange=void 0,t.onDTLSTransportStateChange=void 0,t.onDTLSTransportError=void 0,t.onFirstAudioDecoded=void 0,t.onFirstAudioReceived=void 0,t.onFirstVideoDecoded=void 0,t.onFirstVideoReceived=void 0,t.onSelectedLocalCandidateChanged=void 0,t.onSelectedRemoteCandidateChanged=void 0,t.onFirstVideoDecodedTimeout=void 0}setConfiguration(t){this._p2pConnection.setConfiguration(t)}}function la(i,t,r){const a=i[t];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const l=this.mutex,u=await l.lock("From DataChannelConnection.".concat(t));try{for(var h=arguments.length,f=new Array(h),v=0;v<h;v++)f[v]=arguments[v];return await a.apply(this,f)}finally{u()}},r}function YF(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function XF(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YF(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):YF(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}Te([la,V("design:type",Function),V("design:paramtypes",[Object,Object,Array,Object,String,String]),V("design:returntype",me)],Sr.prototype,"connect",null),Te([la,V("design:type",Function),V("design:paramtypes",[Array,Array]),V("design:returntype",me)],Sr.prototype,"updateRemoteRTPCapabilities",null),Te([la,V("design:type",Function),V("design:paramtypes",[Object,Array]),V("design:returntype",me)],Sr.prototype,"createDataChannels",null),Te([la,V("design:type",Function),V("design:paramtypes",[String,Array,String,Object]),V("design:returntype",me)],Sr.prototype,"receive",null),Te([la,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],Sr.prototype,"stopReceiving",null),Te([la,V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],Sr.prototype,"muteRemote",null),Te([la,V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],Sr.prototype,"unmuteRemote",null),Te([la,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],Sr.prototype,"muteLocal",null),Te([la,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],Sr.prototype,"unmuteLocal",null),Te([la,V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],Sr.prototype,"close",null),Te([la,V("design:type",Function),V("design:paramtypes",[String,pi]),V("design:returntype",me)],Sr.prototype,"updateEncoderConfig",null),Te([la,V("design:type",Function),V("design:paramtypes",[String,pi]),V("design:returntype",me)],Sr.prototype,"updateSendParameters",null),Te([la,V("design:type",Function),V("design:paramtypes",[pi,String]),V("design:returntype",me)],Sr.prototype,"replaceTrack",null),Te([la,V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],Sr.prototype,"getRemoteSSRC",null);class JF extends An{constructor(){super(),w(this,"uplinkStatsUploadInterval",void 0),w(this,"uplinkRelatedStatsUploadInterval",void 0),w(this,"uplinkDenoiserStatsUploadInterval",void 0),w(this,"transportStatsUploadInterval",void 0),w(this,"uplinkExtensionStatsUploadInterval",void 0),w(this,"downlinkExtensionStatsUploadInterval",void 0),w(this,"extensionUsageStatsUploadInterval",void 0),w(this,"downlinkStatsUploadInterval",void 0),w(this,"downlinkRelatedStatsUploadInterval",void 0),w(this,"lastStats",void 0),w(this,"uploadUnplinkStarted",!1),w(this,"uploadDownlinkStarted",!1),w(this,"uploadTransportStarted",!1),w(this,"uploadExtensionUsageStarted",!1),w(this,"requestStats",void 0),w(this,"requestTransportStats",void 0),w(this,"requestLocalMedia",void 0),w(this,"requestRemoteMedia",void 0),w(this,"requestAllTracks",void 0),w(this,"requestVideoIsReady",void 0),w(this,"requestUpload",void 0)}startUploadTransportStats(t){this.uploadTransportStarted||(this.uploadTransportStarted=!0,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=window.setInterval(()=>{var r;const a=(r=this.requestStats)===null||r===void 0?void 0:r.call(this);if(a){const u=YM(a);if(t){var l;const h=(l=this.requestStats)===null||l===void 0?void 0:l.call(this,!0);if(h){const f=YM(h);u.connectionType+=f.connectionType<<3}u.connectionType+=110}else u.connectionType+=100;ns(()=>{var h;(h=this.requestUpload)===null||h===void 0||h.call(this,Eo.TRANSPORT_STATS,u)})}},1e3))}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.extensionUsageStatsUploadInterval&&window.clearInterval(this.extensionUsageStatsUploadInterval);const t=new Map;this.extensionUsageStatsUploadInterval=window.setInterval(async()=>{var r,a,l;const u=Date.now(),h={connectionInterval:Z("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:u};let f=[];const v=((r=this.requestAllTracks)===null||r===void 0?void 0:r.call(this))||[];for(const I of v)!I.muted&&I.enabled&&(f=f.concat(await I.getProcessorUsage()));const E=((a=this.requestRemoteMedia)===null||a===void 0?void 0:a.call(this))||[];for(const[I,k]of E)k.has(Ue.VIDEO)&&I.videoTrack&&(f=f.concat(await I.videoTrack.getProcessorUsage())),k.has(Ue.AUDIO)&&I.audioTrack&&(f=f.concat(await I.audioTrack.getProcessorUsage()));if(f.length===0)return;h.details=function(I,k){const W={};for(const{id:ie,value:oe,level:Re,direction:Ce}of I){var $;const ge=($=k.get(ie))!==null&&$!==void 0?$:0,_e=oe===2?ge+Z("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:ge;var z,X;k.set(ie,_e),W[ie]?(oe===2&&(W[ie].value=oe),Re>W[ie].level&&(W[ie].level=Re),Ce==="remote"&&(W[ie].remoteUidCount+=1),W[ie].totalTs=(z=k.get(ie))!==null&&z!==void 0?z:0):W[ie]={value:oe,level:Re,remoteUidCount:Ce==="local"?0:1,totalTs:(X=k.get(ie))!==null&&X!==void 0?X:0}}return Object.keys(W).map(ie=>{const{level:oe,value:Re,totalTs:Ce}=W[ie];return{id:ie,level:oe,value:Re,totalTs:Ce}})}(f,t);const y=Date.now(),C=y>u?y:u+1;(l=this.requestUpload)===null||l===void 0||l.call(this,Eo.EXTENSION_USAGE_STATS,{usageStats:h,sendTs:C})},Z("EXTENSION_USAGE_UPLOAD_INTERVAL"))}startUploadUplinkStats(){this.uploadUnplinkStarted||(this.uploadUnplinkStarted=!0,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkStatsUploadInterval=window.setInterval(()=>{var t;const r=(t=this.requestStats)===null||t===void 0?void 0:t.call(this);r&&(this.uploadUplinkStats(r),this.lastStats=r)},3e3),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkRelatedStatsUploadInterval=window.setInterval(()=>{var t;const r=(t=this.requestStats)===null||t===void 0?void 0:t.call(this);r&&this.uploadRelatedUplinkStats(r,this.lastStats),this.lastStats=r},1e3),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval=window.setInterval(()=>{var t;const r=(t=this.requestAllTracks)===null||t===void 0?void 0:t.call(this);r&&this.uploadDenoiserStats(r)},2e3),this.uplinkExtensionStatsUploadInterval&&window.clearInterval(this.uplinkExtensionStatsUploadInterval),this.uplinkExtensionStatsUploadInterval=window.setInterval(()=>{var t;const r=(t=this.requestAllTracks)===null||t===void 0?void 0:t.call(this);r&&this.uploadExtensionStats(r)},2e3))}uploadUplinkStats(t){var r;(((r=this.requestLocalMedia)===null||r===void 0?void 0:r.call(this))||[]).forEach(a=>{let[l,{track:u,ssrcs:h}]=a;switch(l){case we.LocalVideoLowTrack:case we.LocalVideoTrack:{const f=function(y,C,I){var k;const W=C.videoSend.find(z=>z.ssrc===y);if(!W)return null;const $={id:un(10,""),timestamp:new Date(C.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:W.ssrc.toString()};switch($.A_vstd=I._originMediaStreamTrack&&!I._originMediaStreamTrack.enabled||I._mediaStreamTrack&&!I._mediaStreamTrack.enabled?"1":"0",W.sentFrame&&($.A_fhs=W.sentFrame.height.toString(),$.A_frs=W.sentFrame.frameRate.toString(),$.A_fws=W.sentFrame.width.toString()),W.adaptionChangeReason){case"none":$.A_ac="0";break;case"cpu":$.A_ac="1";break;case"bandwidth":$.A_ac="2";break;case"other":$.A_ac="3"}return $.A_lvps=fT[I._player?I._player.videoElementStatus:"uninit"].toString(),$.A_nr=(k=W.nacksCount)===null||k===void 0?void 0:k.toString(),W.avgEncodeMs&&($.A_aem=W.avgEncodeMs.toFixed(0).toString()),Z("P2P")&&(W.bytes&&($.bytesSent=W.bytes.toString()),typeof W.packetsLost=="number"&&($.packetsLost=W.packetsLost.toString()),W.packets&&($.packetsSent=W.packets.toString())),$}(h[0].ssrcId,t,u),v=l===we.LocalVideoTrack?function(y,C,I){var k,W,$,z,X,ie,oe,Re;const Ce=C.videoSend.find(Ne=>Ne.ssrc===y);if(!Ce)return null;const ge={id:un(10,""),timestamp:new Date(C.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:Ce.ssrc.toString()},_e=(k=(W=($=Ce.inputFrame)===null||$===void 0?void 0:$.height)!==null&&W!==void 0?W:I==null?void 0:I._videoHeight)!==null&&k!==void 0?k:0,Se=(z=(X=(ie=Ce.inputFrame)===null||ie===void 0?void 0:ie.width)!==null&&X!==void 0?X:I==null?void 0:I._videoWidth)!==null&&z!==void 0?z:0,De=(oe=(Re=Ce.inputFrame)===null||Re===void 0?void 0:Re.frameRate)!==null&&oe!==void 0?oe:0;return _e&&(ge.A_fhi=_e+""),Se&&(ge.A_fwi=Se+""),De&&(ge.A_fri=De+""),ge}(h[0].ssrcId,t,u):null;f&&ns(()=>{var y;return(y=this.requestUpload)===null||y===void 0?void 0:y.call(this,Eo.PUBLISH_STATS,{stream_type:l===we.LocalVideoLowTrack?"low":"high",stats:XF(XF({},f),v)})});const E=function(y){const C={id:"bweforvideo",timestamp:new Date(y.timestamp).toISOString(),type:"VideoBwe"};return y.bitrate.retransmit&&(C.A_rb=y.bitrate.retransmit.toString()),y.bitrate.targetEncoded&&(C.A_teb=y.bitrate.targetEncoded.toString()),C.A_aeb=y.bitrate.actualEncoded.toString(),C.A_tb=y.bitrate.transmit.toString(),y.sendBandwidth!==void 0&&(C.A_asb=y.sendBandwidth.toString()),C}(t);E&&setTimeout(()=>{var y;return(y=this.requestUpload)===null||y===void 0?void 0:y.call(this,Eo.PUBLISH_STATS,{stream_type:l===we.LocalVideoLowTrack?"low":"high",stats:E})},1e3);break}case we.LocalAudioTrack:{const f=function(v,E,y){const C=E.audioSend.find(k=>k.ssrc===v);if(!C)return null;const I={id:un(10,""),timestamp:new Date(E.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:C.ssrc.toString()};return I.A_astd=y._originMediaStreamTrack&&!y._originMediaStreamTrack.enabled||y._mediaStreamTrack&&!y._mediaStreamTrack.enabled?"1":"0",C.inputLevel?I.A_ail=Math.round(100*C.inputLevel).toString():I.A_ail=Math.round(100*y._source.getAccurateVolumeLevel()).toString(),I.A_apil=Math.round(100*y._source.getAccurateVolumeLevel()).toString(),C.aecReturnLoss&&(I.A_ecrl=Math.round(C.aecReturnLoss).toString()),C.aecReturnLossEnhancement&&(I.A_ecrle=Math.round(C.aecReturnLossEnhancement).toString()),Z("P2P")&&(C.bytes&&(I.bytesSent=C.bytes.toString()),typeof C.packetsLost=="number"&&(I.packetsLost=C.packetsLost.toString()),C.packets&&(I.packetsSent=C.packets.toString())),I}(h[0].ssrcId,t,u);f&&ns(()=>{var v;return(v=this.requestUpload)===null||v===void 0?void 0:v.call(this,Eo.PUBLISH_STATS,{stream_type:"high",stats:f})});break}}})}uploadRelatedUplinkStats(t,r){var a;(((a=this.requestLocalMedia)===null||a===void 0?void 0:a.call(this))||[]).filter(l=>{let[u]=l;return u===we.LocalVideoLowTrack||u===we.LocalVideoTrack}).forEach(l=>{let[u,{ssrcs:h}]=l;const f=function(v,E){const y=E.videoSend.find(C=>C.ssrc===v);return y?{mediaType:"video",isVideoMute:!1,frameRateInput:y.inputFrame&&y.inputFrame.frameRate.toString(),frameRateSent:y.sentFrame&&y.sentFrame.frameRate.toString(),googRtt:y.rttMs.toString(),qpSumPerFrame:Math.floor(y.qpSumPerFrame).toString()}:null}(h[0].ssrcId,t);f&&ns(()=>{var v;(v=this.requestUpload)===null||v===void 0||v.call(this,Eo.PUBLISH_RELATED_STATS,{stream_type:u===we.LocalVideoLowTrack?"low":"high",stats:f})})})}uploadDenoiserStats(t){for(let u=0;u<t.length;u++){const h=t[u];if(h instanceof Wl){var r,a,l;const f=(r=(a=h._external).getDenoiserStats)===null||r===void 0?void 0:r.call(a);return void(f&&((l=this.requestUpload)===null||l===void 0||l.call(this,Eo.DENOISER_STATS,f)))}}}uploadExtensionStats(t){for(let r=0;r<t.length;r++)t[r].getProcessorStats().forEach(a=>{var l;(l=this.requestUpload)===null||l===void 0||l.call(this,a.type,a.stats)})}stopUploadUplinkStats(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkStatsUploadInterval=void 0,this.uplinkRelatedStatsUploadInterval=void 0,this.uplinkDenoiserStatsUploadInterval=void 0)}startUploadDownlinkStats(){if(this.uploadDownlinkStarted)return;let t;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);let r=!1;this.downlinkStatsUploadInterval=window.setInterval(()=>{var a;const l=(a=this.requestStats)===null||a===void 0?void 0:a.call(this,!0);l&&(this.uploadDownlinkStats(l,r,t),t=l),r=!r},3e3),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkRelatedStatsUploadInterval=window.setInterval(()=>{var a;const l=(a=this.requestStats)===null||a===void 0?void 0:a.call(this,!0);l&&(this.uploadRelatedDownlinkStats(l,this.lastStats),this.lastStats=l)},1e3),this.downlinkExtensionStatsUploadInterval&&window.clearInterval(this.downlinkExtensionStatsUploadInterval),this.downlinkExtensionStatsUploadInterval=window.setInterval(()=>{var a;const l=(a=this.requestRemoteMedia)===null||a===void 0?void 0:a.call(this);l&&this.uploadDownlinkExtensionStats(l)},2e3)}uploadDownlinkStats(t,r,a){var l;(((l=this.requestRemoteMedia)===null||l===void 0?void 0:l.call(this))||[]).forEach(u=>{let[h,f]=u;if(f.has(Ue.VIDEO)&&h.videoTrack){const v=h.videoTrack?function(E,y,C,I,k){const W=y.videoRecv.find(ie=>ie.ssrc===E);if(!W)return null;const $={id:un(10,""),timestamp:new Date(y.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:W.ssrc.toString()};var z,X;if($.bytesReceived=W.bytes.toString(),$.packetsLost=W.packetsLost.toString(),$.packetsReceived=W.packets.toString(),W.framesRateFirefox&&($.A_frr=W.framesRateFirefox.toString()),W.receivedFrame?($.A_frr=W.receivedFrame.frameRate.toString(),$.A_fhr=W.receivedFrame.height.toString(),$.A_fwr=W.receivedFrame.width.toString()):($.A_fhr=(z=I._videoHeight)===null||z===void 0?void 0:z.toString(),$.A_fwr=(X=I._videoWidth)===null||X===void 0?void 0:X.toString()),$.A_frd=W.decodeFrameRate.toString(),W.outputFrame&&($.A_fro=W.outputFrame.frameRate.toString()),W.jitterBufferMs!==void 0&&($.A_jbm=Math.floor(W.jitterBufferMs).toString()),W.currentDelayMs!==void 0&&($.A_cdm=Math.floor(W.currentDelayMs).toString()),$.A_fs=W.firsCount.toString(),$.A_ns=W.nacksCount.toString(),$.A_ps=W.plisCount.toString(),I&&($.A_vrtd=I._originMediaStreamTrack.enabled&&I._mediaStreamTrack.enabled?"0":"1"),I._player&&I._player.freezeTimeCounterList.length>0&&($.A_vrft=Math.round(I._player.freezeTimeCounterList.splice(0,1)[0]).toString()),k&&I._player&&Kc.visibility==="visible"){const ie=Math.min(6e3,I._player.renderFreezeAccTime);$.A_vrrft=Math.round(ie).toString(),I._player.renderFreezeAccTime=Math.max(0,I._player.renderFreezeAccTime-ie)}if($.A_rvps=fT[I._player?I._player.videoElementStatus:"uninit"].toString(),C){const ie=C.videoRecv.find(oe=>oe.ssrc===E);if(ie&&W.totalInterFrameDelay!==void 0&&W.totalSquaredInterFrameDelay!==void 0&&ie.totalInterFrameDelay!==void 0&&ie.totalSquaredInterFrameDelay!==void 0){const oe=W.totalInterFrameDelay-ie.totalInterFrameDelay,Re=W.totalSquaredInterFrameDelay-ie.totalSquaredInterFrameDelay,Ce=W.framesDecodeCount-ie.framesDecodeCount,ge=oe/Ce*1e3,_e=Math.round(1e3*Math.sqrt((Re-Math.pow(oe,2)/Ce)/Ce));!isNaN(_e)&&ge+_e>Math.max(3*ge,ge+150)&&($.A_ifdsd=_e.toString())}}return $}(h._videoSSRC,t,a,h.videoTrack,r):void 0;v&&ns(()=>{var E;return(E=this.requestUpload)===null||E===void 0?void 0:E.call(this,Eo.SUBSCRIBE_STATS,{stream_id:h.uid,stats:v})})}if(f.has(Ue.AUDIO)&&h.audioTrack){const v=h.audioTrack?function(E,y,C,I){const k=y.audioRecv.find($=>$.ssrc===E);if(!k)return null;const W={id:un(10,""),timestamp:new Date(y.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:k.ssrc.toString()};if(W.bytesReceived=k.bytes.toString(),W.packetsLost=k.packetsLost.toString(),W.packetsReceived=k.packets.toString(),k.outputLevel?W.A_aol=Math.round(100*k.outputLevel).toString():W.A_aol=Math.round(100*I._source.getAccurateVolumeLevel()).toString(),W.A_apol=Math.round(100*I._source.getAccurateVolumeLevel()).toString(),I&&(W.A_artd=I._originMediaStreamTrack.enabled&&I._mediaStreamTrack.enabled?"0":"1"),W.A_jr=k.jitterMs.toString(),W.A_jbm=Math.floor(k.jitterBufferMs).toString(),W.A_cdm=Math.floor(k.jitterBufferMs).toString(),W.A_raps=fT[ko.getPlayerState(I.getTrackId())].toString(),C){const $=C.audioRecv.find(z=>z.ssrc===E);if($){const z=k.concealedSamples-$.concealedSamples;z>0&&(W.A_cs=Math.round(z).toString())}}return W}(h._audioSSRC,t,a,h.audioTrack):void 0;v&&ns(()=>{var E;return(E=this.requestUpload)===null||E===void 0?void 0:E.call(this,Eo.SUBSCRIBE_STATS,{stream_id:h.uid,stats:v})})}})}uploadRelatedDownlinkStats(t,r){var a;(((a=this.requestRemoteMedia)===null||a===void 0?void 0:a.call(this))||[]).forEach(l=>{let[u,h]=l;if(h.has(Ue.VIDEO)&&u.videoTrack){var f;const v=(u._videoSSRC&&((f=this.requestVideoIsReady)===null||f===void 0?void 0:f.call(this,u._videoSSRC))||!1)===!0,E=function(y,C,I,k,W,$){const z=I.videoRecv.find(Re=>Re.ssrc===y),X=W?W.videoRecv.find(Re=>Re.ssrc===y):void 0;if(!z)return null;const ie=zh.isRemoteVideoFreeze($,z,X)&&C,oe={mediaType:"video",isVideoMute:!1,peerId:k,frameRateReceived:z.receivedFrame&&z.receivedFrame.frameRate.toString(),frameRateDecoded:z.decodedFrame&&z.decodedFrame.frameRate.toString(),isFreeze:ie,bytesReceived:z.bytes.toString(),packetsReceived:z.packets.toString(),packetsLost:z.packetsLost.toString(),qpSumPerFrame:Math.floor(z.qpSumPerFrame).toString()};return z.framesRateFirefox&&(oe.frameRateDecoded=z.framesRateFirefox.toString(),oe.frameRateReceived=z.framesRateFirefox.toString()),oe}(u._videoSSRC,v,t,u.uid,r,u.videoTrack);E&&ns(()=>{var y;(y=this.requestUpload)===null||y===void 0||y.call(this,Eo.SUBSCRIBE_RELATED_STATS,{stream_id:u.uid,stats:E})})}if(h.has(Ue.AUDIO)&&u.audioTrack){const v=function(E,y,C,I){const k=y.audioRecv.find($=>$.ssrc===E);if(!k)return null;const W=zh.isRemoteAudioFreeze(I);return{mediaType:"audio",isAudioMute:!1,peerId:C,googJitterReceived:k.jitterMs.toString(),isFreeze:W,bytesReceived:k.bytes.toString(),packetsReceived:k.packets.toString(),packetsLost:k.packetsLost.toString(),frameReceived:k.receivedFrames.toString(),frameDropped:k.droppedFrames.toString()}}(u._audioSSRC,t,u.uid,u.audioTrack);v&&ns(()=>{var E;(E=this.requestUpload)===null||E===void 0||E.call(this,Eo.SUBSCRIBE_RELATED_STATS,{stream_id:u.uid,stats:v})})}})}stopUploadDownlinkStats(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkStatsUploadInterval=void 0,this.downlinkRelatedStatsUploadInterval=void 0)}stopUploadTransportStats(){this.uploadTransportStarted&&(this.uploadTransportStarted=!1,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=void 0)}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.extensionUsageStatsUploadInterval&&window.clearInterval(this.extensionUsageStatsUploadInterval),this.extensionUsageStatsUploadInterval=void 0)}uploadDownlinkExtensionStats(t){t.forEach(r=>{let[a,l]=r;l.has(Ue.VIDEO)&&a.videoTrack&&a.videoTrack.getProcessorStats().forEach(u=>{var h;(h=this.requestUpload)===null||h===void 0||h.call(this,u.type,u.stats)}),l.has(Ue.AUDIO)&&a.audioTrack&&a.audioTrack.getProcessorStats().forEach(u=>{var h;(h=this.requestUpload)===null||h===void 0||h.call(this,u.type,u.stats)})})}}function QF(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function eu(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QF(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):QF(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}function ZF(i){var t,r,a,l=2;for(typeof Symbol<"u"&&(r=_F,a=Symbol.iterator);l--;){if(r&&(t=i[r])!=null)return t.call(i);if(a&&(t=i[a])!=null)return new iE(t.call(i));r="@@asyncIterator",a="@@iterator"}throw new TypeError("Object is not async iterable")}function iE(i){function t(r){if(Object(r)!==r)return me.reject(new TypeError(r+" is not an object."));var a=r.done;return me.resolve(r.value).then(function(l){return{value:l,done:a}})}return iE=function(r){this.s=r,this.n=r.next},iE.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(r){var a=this.s.return;return a===void 0?me.resolve({value:r,done:!0}):t(a.apply(this.s,arguments))},throw:function(r){var a=this.s.return;return a===void 0?me.reject(r):t(a.apply(this.s,arguments))}},new iE(i)}class Vr extends An{get state(){return this._state}set state(t){const r=this._state;this._state=t,this.emit(Je.StateChange,r,this._state)}constructor(t,r){super(),w(this,"store",void 0),w(this,"statsUploader",void 0),w(this,"connection",void 0),w(this,"localTrackMap",new Map),w(this,"remoteUserMap",new Map),w(this,"localDataChannels",[]),w(this,"remoteDataChannelMap",new Map),w(this,"pendingLocalTracks",[]),w(this,"pendingRemoteTracks",[]),w(this,"pendingLocalDataChannels",[]),w(this,"pendingRemoteDataChannels",[]),w(this,"statsCollector",void 0),w(this,"isPlanB",!1),w(this,"shouldForwardP2PCreation",void 0),w(this,"iceFailedCount",0),w(this,"dtlsFailedCount",0),w(this,"mutex",new Mr("P2PChannel-mutex")),w(this,"_state",$t.Disconnected),w(this,"_pcStatsUploadType",Z("NEW_ICE_RESTART")?Fs.FIRST_CONNECTION:Fs.OLD_FIRST_CONNECTION),w(this,"_isInRestartIce",!1),w(this,"_isStartRestartIce",!1),w(this,"_restartStates",["disconnected","failed"]),w(this,"_restartTimer",void 0),w(this,"_isFirstConnected",!0),w(this,"handleMuteLocalTrack",async(a,l,u)=>{const h=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==$t.Connected)return void u(new be(G.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const f=this.filterTobeMutedTracks(a);if(f.length===0)return void l();const v=f.find(y=>y[0]==="videoLowTrack");v&&v[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(f.map(y=>{let[,{id:C}]=y;return C}));const E=this.createMuteMessage(f);await ln(this,Je.RequestMuteLocal,E),l()}catch(f){u(f)}finally{h()}}),w(this,"handleUnmuteLocalTrack",async(a,l,u)=>{const h=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==$t.Connected)return void u(new be(G.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const f=this.filterTobeUnmutedTracks(a);if(f.length===0)return void l();const v=f.find(y=>y[0]==="videoLowTrack");if(v){const y=v[1];if(y.track._originMediaStreamTrack.stop(),!Z("DISABLE_DUAL_STREAM_USE_ENCODING")&&fn().supportDualStreamEncoding){const C=a._mediaStreamTrack.clone();y.track._mediaStreamTrack=C,y.track._originMediaStreamTrack=C}else{const C=hR(a,zc(this,Je.RequestLowStreamParameter));y.track._mediaStreamTrack=C,y.track._originMediaStreamTrack=C}await new me((C,I)=>{this.handleReplaceTrack(y.track,C,I,!0)})}await this.connection.unmuteLocal(f.map(y=>{let[,{id:C}]=y;return C}));const E=this.createUnmuteMessage(f);await ln(this,Je.RequestUnmuteLocal,E),l()}catch(f){u(f)}finally{h()}}),w(this,"handleUpdateVideoEncoder",async(a,l,u)=>{const h=await this.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{const f=this.localTrackMap.get(we.LocalVideoTrack);if(!this.connection||!f||f.track!==a||this.state!==$t.Connected)return void l();const{id:v,track:E}=f;await this.connection.updateSendParameters(v,E),await this.connection.updateEncoderConfig(v,E),this.emit(Je.UpdateVideoEncoder,E),l()}catch(f){u(f)}finally{h()}}),w(this,"handleSetOptimizationMode",async(a,l,u)=>{const h=await this.mutex.lock("Locking from P2PChannel.handleSetOptimizationMode");try{const f=this.localTrackMap.get(we.LocalVideoTrack);if(!this.connection||!f||f.track!==a||this.state!==$t.Connected)return;const{id:v,track:E}=f;await this.connection.updateSendParameters(v,E),l()}catch(f){u(f)}finally{h()}}),w(this,"handleReplaceTrack",async(a,l,u,h)=>{let f;L.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(a.getTrackId(),"]")),typeof h=="boolean"&&h||(f=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var v;const y=Array.from(this.localTrackMap.entries()).find(C=>{let[,{track:I}]=C;return a===I});if(!this.connection||!y||this.state!==$t.Connected)return void l();if(await((v=this.connection)===null||v===void 0?void 0:v.replaceTrack(a,y[1].id)),this.isPlanB){const C=y[1];C.id=a._mediaStreamTrack.id,this.localTrackMap.set(y[0],C)}if(y[0]===we.LocalVideoTrack&&!Z("DISABLE_DUAL_STREAM_USE_ENCODING")&&fn().supportDualStreamEncoding){const C=this.localTrackMap.get(we.LocalVideoLowTrack);if(C){const I=a._mediaStreamTrack.clone();C.track._originMediaStreamTrack.stop(),C.track._mediaStreamTrack=I,C.track._originMediaStreamTrack=I,await new me((k,W)=>{this.handleReplaceTrack(C.track,k,W,!0)})}}l()}catch(y){u(y)}finally{var E;(E=f)===null||E===void 0||E()}}),w(this,"handleGetRTCStats",a=>{a(this.statsCollector.getRTCStats())}),w(this,"handleGetLocalVideoStats",a=>{a(this.statsCollector.getLocalVideoTrackStats())}),w(this,"handleGetLocalAudioStats",a=>{a(this.statsCollector.getLocalAudioTrackStats())}),w(this,"handleGetRemoteVideoStats",a=>this.statsCollector.getRemoteVideoTrackStats(a.uid)[a.uid]),w(this,"handleGetRemoteAudioStats",a=>this.statsCollector.getRemoteAudioTrackStats(a.uid)[a.uid]),this.store=t,this.statsCollector=r,this.statsCollector.addP2PChannel(this),this.statsUploader=new JF,this.bindStatsUploaderEvents(),this.isPlanB=!fn().supportUnifiedPlan||Z("CHROME_FORCE_PLAN_B")&&Ll(),this.shouldForwardP2PCreation=Z("FORWARD_P2P_CREATION")&&fn().supportPCSetConfiguration&&function(){const a=zg();return a===Rr.ANDROID||a===Rr.IOS||a===Rr.HARMONY_OS}(),this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new Sr({},this.store):this.isPlanB?new jr({},this.store):new yr({},this.store),this.bindConnectionEvents(this.connection))}async startP2PConnection(t,r){var a;this.state=$t.New;const l=this.shouldForwardP2PCreation&&((a=this.connection)===null||a===void 0?void 0:a.peerConnectionState)==="closed";if(this.shouldForwardP2PCreation&&!l||(l&&this.connection&&(L.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.connection.close(),this.unbindConnectionEvents(this.connection)),this.connection=this.store.useDataChannel?new Sr(t,this.store):this.isPlanB?new jr(t,this.store):new yr(t,this.store),this.bindConnectionEvents(this.connection)),!this.connection)throw new be(G.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=Z("NEW_ICE_RESTART")?Fs.FIRST_CONNECTION:Fs.OLD_FIRST_CONNECTION,this._isFirstConnected=!0,this._isInRestartIce=!1,this._isStartRestartIce=!1,this.connection.setConfiguration(t),this.connection.establishPromise}async connect(t,r,a,l,u,h){if(!this.connection)throw new be(G.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.connection instanceof Sr?this.connection.updateRemoteConnect(l):(this.store.peerConnectionStart(),await this.connection.connect(t,r,a,l,u,h),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=$t.Connected)}updateRemoteRTPCapabilities(t){const r=Array.from(this.localTrackMap.entries()).filter(a=>{var l;let[u]=a;return Ke(l=[we.LocalVideoLowTrack,we.LocalVideoTrack]).call(l,u)}).map(a=>{let[,{id:l}]=a;return l});this.connection instanceof yr&&this.connection.updateRemoteRTPCapabilities(r,t)}async preConnect(t,r,a,l,u,h){if(!this.connection)throw new be(G.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.store.peerConnectionStart();const f=await this.connection.connect(t,r,a,l,u,h);return this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=$t.Connected,f}getEstablishParams(){if(this.connection instanceof Sr)return this.connection.getP2PConnectionParams();throw new Error("Only DataChannelConnection needs to obtain establishParams")}async publishDataChannel(t){if(!this.connection){if(this.state===$t.Disconnected)throw new be(G.UNEXPECTED_ERROR,"PeerConnection already disconnected.");const a=t.filter(l=>this.pendingLocalDataChannels.findIndex(u=>u.id===l.id)!==-1);return void(this.pendingLocalDataChannels=this.pendingLocalDataChannels.concat(a))}const r=this.filterTobePublishedDataChannels(t);r.length!==0&&(r.forEach(a=>{const l=Date.now();this.store.publish(a.id.toString(),"datachannel",l)}),await this.connection.createDataChannels(this.store.uid,r),r.forEach(a=>{this.localDataChannels.push(a);const l=Date.now();this.store.publish(a.id+"","datachannel",void 0,l)}))}publish(t,r,a){var l=this;return Na(function*(){const u=yield zt(l.mutex.lock("From P2PChannel.publish"));try{if(!l.connection||l.state!==$t.Connected){if(l.state===$t.Disconnected)throw new be(G.UNEXPECTED_ERROR,"PeerConnection already disconnected.");l.throwIfTrackTypeNotMatch(t);const f=t.filter(v=>l.pendingLocalTracks.indexOf(v)===-1);return void(l.pendingLocalTracks=l.pendingLocalTracks.concat(f))}l.store.pubId=l.store.pubId+1,fi.markPublishStart(l.store.clientId,l.store.pubId);const h=l.filterTobePublishedTracks(t,r,a);if(h.length===0)return void(yield zt(l.tryToUnmuteAudio(t)));yield*qv(ZF(l.doPublish(l.connection,h)))}finally{u()}})()}doPublish(t,r){var a=this;return Na(function*(){r.forEach(y=>{let{track:C,type:I}=y;const k=Date.now();a.store.publish(C.getTrackId(),I===we.LocalAudioTrack?"audio":"video",k)}),a.bindLocalTrackEvents(r);const l=yield zt(t.send(r.map(y=>{let{track:C}=y;return C}),a.store.codec,a.store.audioCodec)),u=(yield zt(l.next())).value,h=a.createGatewayPublishMessage(r,u);let f;try{f=yield h}catch(y){throw l.throw(y),(y==null?void 0:y.code)===G.WS_ABORT&&r.forEach(C=>{let{track:I}=C;a.pendingLocalTracks.indexOf(I)===-1&&a.pendingLocalTracks.push(I)}),a.unbindLocalTrackEvents(r),y}const v=a.mapPubResToRemoteConfig(h,f),E=(yield zt(l.next(v))).value;r.forEach(y=>{let{type:C}=y;a.statsCollector.addLocalStats(C)}),a.assignLocalTracks(r,E),a.statsUploader.startUploadUplinkStats(),r.forEach(y=>{let{track:C,type:I}=y;const k=Date.now();a.store.publish(C.getTrackId(),I===we.LocalAudioTrack?"audio":"video",void 0,k)})})()}async updateVideoStreamParameter(t,r){const a=this.localTrackMap.get(r);if(!a)return;if(!(a.track instanceof bt))return L.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");if(!(this.connection instanceof yr||this.connection instanceof jr))return L.warn("[updateVideoStreamParameter]: connection is not P2PConnection or P2PConnectionPlanB");const{track:l}=a,u=function(h,f){const v={};return h.height&&h.width&&(v.scaleResolutionDownBy=YT(h,f)),v.maxFramerate=h.framerate?ca(h.framerate):void 0,v.maxBitrate=h.bitrate?1e3*h.bitrate:void 0,v}(t,l);if(l._encoderConfig||(l._encoderConfig={}),r!==we.LocalVideoLowTrack||!Z("DISABLE_DUAL_STREAM_USE_ENCODING")&&fn().supportDualStreamEncoding)u.scaleResolutionDownBy!=null&&(l._encoderConfig.scaleResolutionDownBy=u.scaleResolutionDownBy);else{const h=l._originMediaStreamTrack;if(!h.canvas)return L.warn("[".concat(l.getTrackId(),"] no canvas on track"));(function(f,v){const E=f.canvas;v.width&&(E.width=ca(v.width)),v.height&&(E.height=ca(v.height)),v.framerate&&(E.stopCapture&&E.stopCapture(),E.stopCapture=gT(()=>{!E.startCapture&&E.stopCapture&&E.stopCapture(),E.startCapture&&E.startCapture()},ca(v.framerate)))})(h,t)}u.maxBitrate!=null&&(l._encoderConfig.bitrateMax=u.maxBitrate/1e3),u.maxFramerate!=null&&(l._encoderConfig.frameRate&&typeof l._encoderConfig.frameRate=="object"?l._encoderConfig.frameRate.max=u.maxFramerate:l._encoderConfig.frameRate={max:u.maxFramerate}),L.debug("[".concat(l.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(l._encoderConfig))),await this.connection.updateRtpSenderEncodings(l)}publishLowStream(t){var r=this;return Na(function*(){if(!r.connection||r.state!==$t.Connected)return;const a=yield zt(r.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const u=r.localTrackMap.get(we.LocalVideoTrack);if(!u)throw new be(G.UNEXPECTED_ERROR,"Could not find high stream");if(r.localTrackMap.has(we.LocalVideoLowTrack))throw new be(G.UNEXPECTED_ERROR,"[".concat(r.store.clientId,"] Can't publish low stream when stream already publish"));const h=[{track:r.getLowVideoTrack(u.track,t),type:we.LocalVideoLowTrack}];if(yield*qv(ZF(r.doPublish(r.connection,h))),u.track.muted||!u.track.enabled){var l;const f=(l=r.localTrackMap.get(we.LocalVideoLowTrack))===null||l===void 0?void 0:l.id;f!==void 0&&(yield zt(r.connection.muteLocal([f])))}}finally{a()}})()}async republish(){this.pendingLocalTracks.length>0&&(L.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Ln(this,Je.RequestRePublish,this.pendingLocalTracks),this.emit(Je.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(L.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await Ln(this,Je.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[])}async reSubscribe(t){for(let r=this.pendingRemoteTracks.length-1;r>=0;r--){const{user:a,kind:l}=this.pendingRemoteTracks[r];(l!==Ue.AUDIO||a._audio_added_&&a._audioSSRC)&&(l!==Ue.VIDEO||a._video_added_&&a._videoSSRC)||this.pendingRemoteTracks.splice(r,1)}if(t)await Ln(this,Je.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:r,kind:a}of this.pendingRemoteTracks)await this.subscribe(r,a,a===Ue.VIDEO?r._videoSSRC:r._audioSSRC);this.pendingRemoteTracks.forEach(r=>{let{user:a}=r;this.emit(Je.MediaReconnectEnd,a.uid)}),this.pendingRemoteTracks=[]}async unpublish(t){if(!this.connection||this.state!==$t.Connected)return void t.forEach(l=>{const u=this.pendingLocalTracks.indexOf(l);u!==-1&&this.pendingLocalTracks.splice(u,1)});const r=this.filterTobeUnpublishedTracks(t);if(r.length===0)return;const a=r.find(l=>l[0]==="videoLowTrack");return a&&a[1].track.close(),this.doUnpublish(this.connection,r)}async unpublishDataChannel(t){if(!this.connection||this.state!==$t.Connected)return void t.forEach(a=>{const l=this.pendingLocalDataChannels.indexOf(a);l!==-1&&this.pendingLocalDataChannels.splice(l,1)});const r=this.filterTobeUnpublishedDataChannels(t);return r.length!==0?(r.forEach(a=>{const l=this.localDataChannels.indexOf(a);l!==-1&&this.localDataChannels.splice(l,1)}),this.localDataChannels.length===0&&await this.connection.stopDataChannels(this.store.uid),r.map(a=>a.id)):void 0}async unpublishLowStream(){if(!this.connection||this.state!==$t.Connected)return;const t=this.localTrackMap.get(we.LocalVideoLowTrack);if(!t)return;t.track.close();const r=[[we.LocalVideoLowTrack,t]];return this.doUnpublish(this.connection,r)}async doUnpublish(t,r){const a=this.createGatewayUnpublishMessage(r);return await t.stopSending(r.map(l=>{let[,{id:u}]=l;return u})),this.withdrawLocalTracks(r),this.unbindLocalTrackEvents(r.map(l=>{let[u,{track:h}]=l;return{type:u,track:h}})),r.forEach(l=>{let[u]=l;this.statsCollector.removeLocalStats(u)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadUplinkStats(),a}async subscribeDataChannel(t,r){if(!this.connection||this.state!==$t.Connected)throw new be(G.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const a=r.filter(l=>{var u;return!((u=this.remoteDataChannelMap.get(t))!==null&&u!==void 0&&u.get(l.id))});if(a.length!==0)return await this.connection.createDataChannels(t.uid,a),a.forEach(l=>{var u;this.remoteDataChannelMap.has(t)?(u=this.remoteDataChannelMap.get(t))===null||u===void 0||u.set(l.id,l):this.remoteDataChannelMap.set(t,new Map([[l.id,l]]));const h=this.pendingRemoteDataChannels.findIndex(f=>{let{user:v,id:E}=f;return v.uid===t.uid&&E===l.id});h!==-1&&this.pendingRemoteDataChannels.splice(h,1)}),a.map(l=>l.id)}async subscribe(t,r,a,l,u){var h;if(!this.connection||this.state!==$t.Connected)throw new be(G.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((h=this.remoteUserMap.get(t))!==null&&h!==void 0&&h.has(r))return;let f,v,E;if(u){const I=u.find(W=>{let{stream_type:$}=W;return $===r});if(!I)throw new be(G.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(r," for user: ").concat(t.uid," because subscribe answer from gateway does not contain stream_type: ").concat(r,"."));const k=await this.connection.receive(r,I.ssrcs,String(t._uintid),I.attributes);this.connection instanceof yr&&(E=k.transceiver),f=k.track,v=k.id}else{const I=await this.connection.receive(r,[{ssrcId:a,rtx:l}],String(t._uintid),void 0);this.connection instanceof yr&&(E=I.transceiver),f=I.track,v=I.id}r===Ue.AUDIO?(t._audioTrack?t._audioTrack._updateOriginMediaStreamTrack(f):(t._audioTrack=new os(f,t.uid,t._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(t._audioTrack.getTrackId()))),E&&t._audioTrack._updateRtpTransceiver(E),this.bindRemoteTrackEvents(t,t._audioTrack)):(t._videoTrack?t._videoTrack._updateOriginMediaStreamTrack(f):(t._videoTrack=new yc(f,t.uid,t._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(t._videoTrack.getTrackId()))),E&&t._videoTrack._updateRtpTransceiver(E),this.bindRemoteTrackEvents(t,t._videoTrack));const y=this.remoteUserMap.get(t);y?y.set(r,v):this.remoteUserMap.set(t,new Map([[r,v]])),this.statsCollector.addRemoteStats(t.uid),this.statsUploader.startUploadDownlinkStats();const C=this.pendingRemoteTracks.findIndex(I=>{let{user:k,kind:W}=I;return k.uid===t.uid&&r===W});C!==-1&&(this.pendingRemoteTracks.splice(C,1),this.emit(Je.MediaReconnectEnd,t.uid))}async massSubscribe(t){return this.massSubscribeNoLock(t)}async massSubscribeNoLock(t){if(!this.connection||this.state!==$t.Connected)throw new be(G.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");t=t.filter(a=>{var l;let{user:u,mediaType:h}=a;return!((l=this.remoteUserMap.get(u))!==null&&l!==void 0&&l.has(h))});const r=await this.connection.batchReceive(t.map(a=>{let{user:l,mediaType:u,ssrcId:h,rtxSsrcId:f}=a;return{kind:u,ssrcMsg:[{ssrcId:h,rtx:f}],mslabel:String(l._uintid)}}));t.forEach((a,l)=>{let{user:u,mediaType:h}=a;const{track:f,id:v,transceiver:E}=r[l];h===Ue.AUDIO?(u._audioTrack?u._audioTrack._updateOriginMediaStreamTrack(f):(u._audioTrack=new os(f,u.uid,u._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(u._audioTrack.getTrackId()))),E&&u._audioTrack._updateRtpTransceiver(E),this.bindRemoteTrackEvents(u,u._audioTrack)):(u._videoTrack?u._videoTrack._updateOriginMediaStreamTrack(f):(u._videoTrack=new yc(f,u.uid,u._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(u._videoTrack.getTrackId()))),E&&u._videoTrack._updateRtpTransceiver(E),this.bindRemoteTrackEvents(u,u._videoTrack));const y=this.remoteUserMap.get(u);y?y.set(h,v):this.remoteUserMap.set(u,new Map([[h,v]])),this.statsCollector.addRemoteStats(u.uid),this.statsUploader.startUploadDownlinkStats();const C=this.pendingRemoteTracks.findIndex(I=>{let{user:k,kind:W}=I;return k.uid===u.uid&&h===W});C!==-1&&(this.pendingRemoteTracks.splice(C,1),this.emit(Je.MediaReconnectEnd,u.uid))})}async unsubscribe(t,r,a){const l=this.pendingRemoteTracks.filter(f=>{let{user:v,kind:E}=f;return r!==void 0?v.uid===t.uid&&r===E:v.uid===t.uid});if(l.forEach(f=>{const v=this.pendingRemoteTracks.indexOf(f);this.pendingRemoteTracks.splice(v,1)}),this.connection&&this.state===$t.Connected||a||l.forEach(f=>{let{kind:v}=f;var E;if(v===Ue.AUDIO)(E=t._audioTrack)===null||E===void 0||E._destroy(),t._audioTrack=void 0;else if(v===Ue.VIDEO){var y;(y=t._videoTrack)===null||y===void 0||y._destroy(),t._videoTrack=void 0}}),!this.connection||this.state!==$t.Connected)return;const u=this.filterTobeUnSubscribedTracks(t,r);if(u.length===0)return;await this.connection.stopReceiving(u.map(f=>{let[,{id:v}]=f;return v}));const h=this.createUnsubscribeMessage(u);return this.withdrawRemoteTracks(u),this.remoteUserMap.size===0&&this.statsUploader.stopUploadDownlinkStats(),u.forEach(f=>{let[v,{kind:E}]=f;var y,C;if(E===Ue.VIDEO&&v._videoSSRC&&((y=this.connection)===null||y===void 0||y.setStatsRemoteVideoIsReady(v._videoSSRC,!1)),E===Ue.VIDEO)this.unbindRemoteTrackEvents(v._videoTrack),a||((C=v._videoTrack)===null||C===void 0||C._destroy(),v._videoTrack=void 0);else if(E===Ue.AUDIO){var I;this.unbindRemoteTrackEvents(v._audioTrack),!a&&((I=v._audioTrack)===null||I===void 0||I._destroy(),v._audioTrack=void 0)}}),h}async unsubscribeDataChannel(t,r){if(r.forEach(u=>{const h=this.pendingRemoteDataChannels.findIndex(f=>f.id===u.id);h!==-1&&this.pendingRemoteDataChannels.splice(h,1)}),!this.connection)return;const a=this.filterTobeUnSubscribedDataChannels(t,r);if(a.length===0)return;r.forEach(u=>{u._close()});const l=this.remoteDataChannelMap.get(t);return a.forEach(u=>{l&&l.delete(u.id)}),l&&l.size===0&&(this.remoteDataChannelMap.delete(t),await this.connection.stopDataChannels(t.uid)),a.map(u=>u.id)}async massUnsubscribe(t){return this.massUnsubscribeNoLock(t)}async massUnsubscribeNoLock(t){let r=[];for(const{user:u,mediaType:h}of t){const f=this.pendingRemoteTracks.filter(v=>{let{user:E,kind:y}=v;return h!==void 0?E.uid===u.uid&&h===y:E.uid===u.uid});f.forEach(v=>{const E=this.pendingRemoteTracks.indexOf(v);this.pendingRemoteTracks.splice(E,1)}),r=r.concat(f)}if(!this.connection||this.state!==$t.Connected)return void r.forEach(u=>{let{user:h,kind:f}=u;var v;if(f===Ue.AUDIO)(v=h._audioTrack)===null||v===void 0||v._destroy(),h._audioTrack=void 0;else if(f===Ue.VIDEO){var E;(E=h._videoTrack)===null||E===void 0||E._destroy(),h._videoTrack=void 0}});const a=Qu(t).call(t,(u,h)=>{let{user:f,mediaType:v}=h;const E=this.filterTobeUnSubscribedTracks(f,v);return u.concat(E)},[]);if(a.length===0)return;await this.connection.stopReceiving(a.map(u=>{let[,{id:h}]=u;return h}));const l=this.createUnsubscribeAllMessage(a);return this.withdrawRemoteTracks(a),this.remoteUserMap.size===0&&this.statsUploader.stopUploadDownlinkStats(),a.forEach(u=>{let[h,{kind:f}]=u;var v,E;if(f===Ue.VIDEO&&h._videoSSRC&&((v=this.connection)===null||v===void 0||v.setStatsRemoteVideoIsReady(h._videoSSRC,!1)),f===Ue.VIDEO)this.unbindRemoteTrackEvents(h._videoTrack),(E=h._videoTrack)===null||E===void 0||E._destroy(),h._videoTrack=void 0;else if(f===Ue.AUDIO){var y;this.unbindRemoteTrackEvents(h._audioTrack),(y=h._audioTrack)===null||y===void 0||y._destroy(),h._audioTrack=void 0}}),l}async muteRemote(t,r){if(!this.connection)return;const a=this.remoteUserMap.get(t);if(!a)return void L.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(t.uid,"."));if(!a.get(r))return void L.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(t.uid," media type ").concat(r,"."));const l=r===Ue.VIDEO?t._videoSSRC:t._audioSSRC;l!==void 0&&this.connection.setStatsRemoteVideoIsReady(l,!1)}async unmuteRemote(t,r){return this.unmuteRemoteNoLock(t,r)}async unmuteRemoteNoLock(t,r){if(!this.connection)return;const a=this.remoteUserMap.get(t);if(!a)return void L.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(t.uid,"."));a.get(r)||L.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(t.uid," media type ").concat(r,"."))}getAllTracks(t){const r=this.localTrackMap.get(we.LocalAudioTrack);if((r==null?void 0:r.track)instanceof cr){const a=r.track;return Array.from(this.localTrackMap.entries()).filter(l=>{let[u]=l;return u!==we.LocalAudioTrack}).filter(l=>{let[u]=l;return!(t&&u===we.LocalVideoLowTrack)}).map(l=>{let[,{track:u}]=l;return u}).concat(a.trackList)}return Array.from(this.localTrackMap.entries()).filter(a=>{let[l]=a;return!(t&&l===we.LocalVideoLowTrack)}).map(a=>{let[,{track:l}]=a;return l})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(t,r,a,l,u){if(t){const f=this.localTrackMap.get(we.LocalAudioTrack),v=l?this.localTrackMap.get(we.LocalVideoLowTrack):this.localTrackMap.get(we.LocalVideoTrack);He.publish(this.store.sessionId,{eventElapse:fi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:t,ec:r,audioName:f==null?void 0:f.track.getTrackLabel(),videoName:v==null?void 0:v.track.getTrackLabel(),screenshare:(v==null?void 0:v.track._hints.indexOf(vn.SCREEN_TRACK))!==-1,audio:!!f,video:!!v,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:u})}else{var h;a||(a=[]);const f=a.find(E=>E instanceof en),v=l?(h=this.localTrackMap.get(we.LocalVideoTrack))===null||h===void 0?void 0:h.track:a.find(E=>E instanceof bt);He.publish(this.store.sessionId,{eventElapse:fi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:t,ec:r,audioName:f==null?void 0:f.getTrackLabel(),videoName:v==null?void 0:v.getTrackLabel(),screenshare:(v==null?void 0:v._hints.indexOf(vn.SCREEN_TRACK))!==-1,audio:!!f,video:!!v,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:u})}}reportSubscribeEvent(t,r,a,l){const u=l===Ue.VIDEO?a._videoSSRC:a._audioSSRC;u&&He.subscribe(this.store.sessionId,{succ:t,ec:r,video:l===Ue.VIDEO,audio:l===Ue.AUDIO,peerid:a.uid,subscribeRequestid:l===Ue.VIDEO?a._videoSSRC:a._audioSSRC,p2pid:this.store.p2pId,eventElapse:fi.measureFromSubscribeStart(this.store.clientId,u)})}reset(){L.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new Mr("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new Sr({},this.store):this.isPlanB?new jr({},this.store):new yr({},this.store),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const t=this.localTrackMap.get(we.LocalAudioTrack);if((t==null?void 0:t.track)instanceof cr){if(t.track.trackList.length>0){const r=t.track;t.track.trackList.forEach(a=>{r.removeAudioTrack(a)})}t.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=$t.Disconnected}getStats(){var t;return(t=this.connection)===null||t===void 0?void 0:t.getStats()}getRemoteVideoIsReady(t){var r;return((r=this.connection)===null||r===void 0?void 0:r.getRemoteVideoIsReady(t))||!1}getLocalAudioVolume(){const t=this.localTrackMap.get(we.LocalAudioTrack);if(t)return t.track.getVolumeLevel()}getLocalVideoSize(){const t=this.localTrackMap.get(we.LocalVideoTrack);if(t)return{width:t.track._videoWidth||0,height:t.track._videoHeight||0}}getEncoderConfig(t){const r=this.localTrackMap.get(t);return r&&r.track instanceof bt||r&&r.track instanceof en?r.track._encoderConfig:void 0}getLocalMedia(t){return this.localTrackMap.get(t)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(t,r){if(!t)return this.remoteUserMap.size>0;const a=this.remoteUserMap.get(t);return!!a&&(!r||a.has(r))}async hasRemoteMediaWithLock(t,r){if(!t)return this.remoteUserMap.size>0;const a=this.remoteUserMap.get(t);return!!a&&(!r||a.has(r))}getRemoteMedia(t){var r;const a=Array.from(Xo(r=this.remoteUserMap).call(r)).find(l=>l.uid===t);return a?{audioTrack:a.audioTrack,audioSSRC:a._audioSSRC,videoTrack:a.videoTrack,videoSSRC:a._videoSSRC}:{}}getAudioLevels(){let t=Array.from(this.remoteUserMap.entries()).map(a=>{let[l]=a;return{uid:l.uid,level:l.audioTrack?100*l.audioTrack._source.getAccurateVolumeLevel():0}});const r=this.localTrackMap.get(we.LocalAudioTrack);return r&&t.push({level:100*r.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),t=Nf(t).call(t,(a,l)=>a.level-l.level),t}async disconnectForReconnect(){this.connection&&(L.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=$t.Reconnecting,Z("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(t=>{let[r]=t;var a;r._videoTrack&&r._videoTrack._player&&((a=r._videoTrack._player.getVideoElement())===null||a===void 0||a.pause(),r._videoTrack._player.isKeepLastFrame=!0,r._videoTrack._originMediaStreamTrack.stop())}),this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new Sr({},this.store):this.isPlanB?new jr({},this.store):new yr({},this.store),this.bindConnectionEvents(this.connection)),this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(t=>{var r;let[a,{track:l}]=t;switch(a){case we.LocalVideoTrack:Ke(r=l._hints).call(r,vn.LOW_STREAM)?l.close():this.pendingLocalTracks.push(l);break;case we.LocalAudioTrack:l instanceof cr?this.pendingLocalTracks=this.pendingLocalTracks.concat(l.trackList):this.pendingLocalTracks.push(l);case we.LocalVideoLowTrack:}}),this.emit(Je.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(t=>{let[r,a]=t;Array.from(Xo(a).call(a)).forEach(l=>{this.setPendingRemoteMedia(r,l)}),this.emit(Je.MediaReconnectStart,r.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.localDataChannels.length!==0&&(this.localDataChannels.forEach(t=>{this.pendingLocalDataChannels.push(t)}),this.localDataChannels.length=0),this.remoteDataChannelMap.size!==0&&(Array.from(this.remoteDataChannelMap.entries()).forEach(t=>{let[r,a]=t;Array.from(Xo(a).call(a)).forEach(l=>{this.setPendingRemoteDataChannel(r,l)})}),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),L.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(t,r){for(const a of this.pendingRemoteDataChannels){const{user:l,id:u}=a;if((t instanceof mi?t.uid:t)===l.uid&&u===r)return!0}return!1}setPendingRemoteDataChannel(t,r){this.hasPendingRemoteDataChannel(t,r)||this.pendingRemoteDataChannels.push({user:t,id:r})}hasPendingRemoteMedia(t,r){for(const a of this.pendingRemoteTracks){const{user:l,kind:u}=a;if((t instanceof mi?t.uid:t)===l.uid&&r===u)return!0}return!1}setPendingRemoteMedia(t,r){this.hasPendingRemoteMedia(t,r)||this.pendingRemoteTracks.push({user:t,kind:r})}restartICE(t){var r=this;return Na(function*(){if(!r.connection||r.state!==$t.Connected||r.connection instanceof Sr)return;const a=yield zt(r.mutex.lock("From P2PChannel.restartICE"));let l;try{l=yield zt(r.connection.restartICE(t));const h=yield zt(l.next());if(h.done)return;const f=h.value,v=yield f;switch(r.reportPCDisconnectedOrFailed(t),t){case hi.TCP:r._pcStatsUploadType=Fs.TCP_RESTART;break;case hi.RELAY:r._pcStatsUploadType=Fs.RELAY_RESTART;break;default:r._pcStatsUploadType=Fs.OLD_RESTART}r._isInRestartIce=!0,l.next(v)}catch(h){var u;(u=l)===null||u===void 0||u.throw(h)}finally{a()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const t=this.connection.getStats(),r=this.localTrackMap.get(we.LocalVideoTrack),a=this.localTrackMap.get(we.LocalAudioTrack),l=t.videoSend.find(W=>W.ssrc===(r==null?void 0:r.ssrcs[0].ssrcId)),u=t.audioSend.find(W=>W.ssrc===(a==null?void 0:a.ssrcs[0].ssrcId));if(!l||!u)return 1;const h=mo(this,Je.NeedSignalRTT),f=l?l.rttMs:void 0,v=u?u.rttMs:void 0,E=f&&v?(f+v)/2:f||v,y=(E&&h?(E+h)/2:E||h)||0,C=100*t.sendPacketLossRate*.7/50+.3*y/1500,I=C<.17?1:C<.36?2:C<.59?3:C<.1?4:5,k=r==null?void 0:r.track;if(k&&k._encoderConfig&&k._hints.indexOf(vn.SCREEN_TRACK)===-1){const W=k._encoderConfig.bitrateMax,$=t.bitrate.actualEncoded;if(W&&$){const z=(1e3*W-$)/(1e3*W);return rL[z<.15?0:z<.3?1:z<.45?2:z<.6?3:4][I]}}return I}getDownlinkNetworkQuality(){if(!this.connection)return 0;const t=this.connection.getStats();let r=0;return Array.from(this.remoteUserMap.entries()).forEach(a=>{let[l]=a;const u=l._audioSSRC,h=l._videoSSRC,f=t.audioRecv.find($=>$.ssrc===u),v=t.videoRecv.find($=>$.ssrc===h);if(!f&&!v)return void(r+=1);const E=mo(this,Je.NeedSignalRTT),y=t.rtt,C=(y&&E?(y+E)/2:y||E)||0,I=f?f.jitterMs:void 0,k=t.recvPacketLossRate;let W=.7*k*100/50+.3*C/1500;I&&(W=.6*k*100/50+.2*C/1500+.2*I/400),r+=W<.1?1:W<.17?2:W<.36?3:W<.59?4:5}),this.remoteUserMap.size>0?Math.round(r/this.remoteUserMap.size):r}async muteLocalTrack(t){return new me((r,a)=>{this.handleMuteLocalTrack(t,r,a)})}filterTobePublishedTracks(t,r,a){const l=[],u=fn(),h=this.getAllTracks();t=Th(t=t.filter(E=>h.indexOf(E)===-1));let f=!1,v=!1;for(const E of t){if(E instanceof bt&&(this.localTrackMap.has(we.LocalVideoTrack)||f?new be(G.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(l.push({track:E,type:we.LocalVideoTrack}),f=!0),r)){const y=this.getLowVideoTrack(E,a);l.push({track:y,type:we.LocalVideoLowTrack})}if(E instanceof en){const y=this.localTrackMap.get(we.LocalAudioTrack);if(y){if(!(y.track instanceof cr))throw new be(G.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(E._bypassWebAudio)throw new be(G.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");y.track.addAudioTrack(E),this.bindLocalAudioTrackEvents(E,!0)}else if(v){const C=l.find(I=>{let{type:k}=I;return k===we.LocalAudioTrack});if(!(C.track instanceof cr))throw new be(G.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(E._bypassWebAudio)throw new be(G.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");C.track.addAudioTrack(E)}else{if(!u.webAudioMediaStreamDest||E instanceof cr||E._bypassWebAudio)l.push({track:E,type:we.LocalAudioTrack});else{const C=new cr;C.addAudioTrack(E),l.push({track:C,type:we.LocalAudioTrack})}v=!0}}}return l}filterTobeUnpublishedTracks(t){const r=[],a=this.getAllTracks();t=Th(t=t.filter(l=>a.indexOf(l)!==-1));for(const l of t){if(l instanceof en){const u=this.localTrackMap.get(we.LocalAudioTrack);if(!u)continue;u.track instanceof cr?(u.track.removeAudioTrack(l),this.unbindLocalAudioTrackEvents(l),u.track.trackList.length===0&&(r.push([we.LocalAudioTrack,u]),u.track.close())):r.push([we.LocalAudioTrack,u])}if(l instanceof bt){const u=this.localTrackMap.get(we.LocalVideoTrack);if(!u)continue;r.push([we.LocalVideoTrack,u]);const h=this.localTrackMap.get(we.LocalVideoLowTrack);h&&r.push([we.LocalVideoLowTrack,h])}}return r}filterTobePublishedDataChannels(t){return t=(t=Th(t)).filter(r=>this.localDataChannels.findIndex(a=>a.id===r.id)===-1)}filterTobeUnpublishedDataChannels(t){return t=(t=(t=Th(t)).filter(r=>this.localDataChannels.indexOf(r)!==-1)).filter(r=>r._originDataChannel)}bindLocalTrackEvents(t){t.forEach(r=>{let{track:a,type:l}=r;switch(l){case we.LocalVideoTrack:a.addListener(Fe.GET_STATS,this.handleGetLocalVideoStats),a.addListener(Fe.GET_RTC_STATS,this.handleGetRTCStats),a.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.addListener(Fe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),a.addListener(Fe.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),a.addListener(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),a.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case we.LocalAudioTrack:this.bindLocalAudioTrackEvents(a);case we.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(t,r){t instanceof cr?t.trackList.forEach(a=>{a.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.addListener(Fe.GET_STATS,this.handleGetLocalAudioStats),a.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(t.addListener(Fe.GET_STATS,this.handleGetLocalAudioStats),t.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),r||t.addListener(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(t){t||(t=Array.from(this.localTrackMap.entries()).map(r=>{let[a,{track:l}]=r;return{track:l,type:a}})),t.forEach(r=>{let{track:a,type:l}=r;switch(l){case we.LocalVideoTrack:a.off(Fe.GET_STATS,this.handleGetLocalVideoStats),a.off(Fe.GET_RTC_STATS,this.handleGetRTCStats),a.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.off(Fe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),a.off(Fe.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),a.off(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),a.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case we.LocalAudioTrack:this.unbindLocalAudioTrackEvents(a);case we.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(t){t instanceof cr?t.trackList.forEach(r=>{r.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(Fe.GET_STATS,this.handleGetLocalAudioStats),r.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(t.off(Fe.GET_STATS,this.handleGetLocalAudioStats),t.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(t,r){r instanceof yc&&r.addListener(Fe.GET_STATS,a=>{a(this.handleGetRemoteVideoStats(t))}),r instanceof os&&r.addListener(Fe.GET_STATS,a=>{a(this.handleGetRemoteAudioStats(t))})}unbindRemoteTrackEvents(t){t&&t.removeAllListeners(Fe.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(t=>{let[r,a]=t;a.has(Ue.AUDIO)&&this.unbindRemoteTrackEvents(r._audioTrack),a.has(Ue.VIDEO)&&this.unbindRemoteTrackEvents(r._videoTrack)})}createGatewayPublishMessage(t,r){return t.map((a,l)=>{var u;let h,f,{track:v,type:E}=a;switch(E){case we.LocalAudioTrack:h=rn.Audio,f={dtx:v instanceof Wl&&v._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case we.LocalVideoTrack:h=Ke(u=v._hints).call(u,vn.SCREEN_TRACK)?rn.Screen:rn.High,f=eu(eu({},Vv(v)),{},{codec:this.store.codec});break;case we.LocalVideoLowTrack:h=rn.Low,f=eu(eu({},Vv(v)),{},{codec:this.store.codec})}return{stream_type:h,attributes:f,ssrcs:r[l]}})}createGatewayUnpublishMessage(t){return t.map(r=>{var a;let l,[u,{track:h,ssrcs:f,id:v}]=r;switch(u){case we.LocalVideoTrack:l=Ke(a=h._hints).call(a,vn.SCREEN_TRACK)?rn.Screen:rn.High;break;case we.LocalAudioTrack:l=rn.Audio;break;case we.LocalVideoLowTrack:l=rn.Low}return{stream_type:l,ssrcs:f,mid:v}})}assignLocalTracks(t,r){t.forEach((a,l)=>{let{track:u,type:h}=a;this.localTrackMap.set(h,{track:u,id:r[l].id,ssrcs:r[l].localSSRC})})}withdrawLocalTracks(t){t.forEach(r=>{let[a]=r;this.localTrackMap.delete(a)})}bindConnectionEvents(t){t.onConnectionStateChange=async r=>{if(L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(r,")")),this.emit(Je.PeerConnectionStateChange,r),r!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),r==="connected"&&(this._restartTimer&&(clearTimeout(this._restartTimer),this._restartTimer=void 0),(this._isFirstConnected||this._isInRestartIce)&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isInRestartIce=!1,this._isFirstConnected=!1,this._isStartRestartIce=!1),Z("NEW_ICE_RESTART")){var a;if(Ke(a=this._restartStates).call(a,r)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const l=f=>{(t.iceConnectionState==="disconnected"||t.iceConnectionState==="checking"||t.iceConnectionState==="failed")&&(L.debug("[".concat(this.store.clientId,"] [P2PChannel] start use restartICE, type is ").concat(f)),mo(this,Je.QueryClientConnectionState)==="CONNECTED"&&this.emit(Je.RequestRestartICE,f))},u=()=>{t.iceConnectionState!=="disconnected"&&t.iceConnectionState!=="checking"&&t.iceConnectionState!=="failed"||(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),L.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(Je.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},h=Z("ICE_RESTART_INTERVAL");return void(this._restartTimer=window.setTimeout(()=>{if(Z("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&fn().supportPCSetConfiguration)l(hi.RELAY),this._restartTimer=window.setTimeout(u,h);else if(Cn())l(hi.UDP),this._restartTimer=window.setTimeout(u,4e3);else{if(l(hi.TCP),fn().supportPCSetConfiguration)return void(this._restartTimer=window.setTimeout(()=>{l(hi.RELAY),this._restartTimer=window.setTimeout(u,h)},h));this._restartTimer=window.setTimeout(u,h)}},800))}}else{if(r==="disconnected"&&t.iceConnectionState==="disconnected")return setTimeout(()=>{t.iceConnectionState==="disconnected"&&Z("ICE_RESTART")&&mo(this,Je.QueryClientConnectionState)==="CONNECTED"&&this.emit(Je.RequestRestartICE)},800),void setTimeout(()=>{t.peerConnectionState==="disconnected"&&(L.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isInRestartIce=!1,setTimeout(()=>this.emit(Je.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);r==="failed"&&(L.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCDisconnectedOrFailed(),setTimeout(()=>this.emit(Je.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},t.onICEConnectionStateChange=r=>{r!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(r,")")),He.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:r,tag:Dn.TRACER}).onSuccess(),this.emit(Je.IceConnectionStateChange,r)},t.onICETransportStateChange=r=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(r,")"))},t.onDTLSTransportStateChange=r=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(r,")"))},t.onDTLSTransportError=r=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(r,")"))},t.onFirstAudioDecoded=r=>{var a;const l=Array.from(Xo(a=this.remoteUserMap).call(a)).find(h=>h._audioSSRC===r);var u;l&&(this.store.subscribe(l.uid,"audio",void 0,void 0,void 0,Date.now()),(u=l.audioTrack)===null||u===void 0||u.emit(id.FIRST_FRAME_DECODED),He.firstRemoteFrame(this.store.sessionId,Ar.FIRST_AUDIO_DECODE,On.FIRST_AUDIO_DECODE,{peer:l._uintid,subscribeElapse:fi.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId}))},t.onFirstAudioReceived=r=>{var a;const l=Array.from(Xo(a=this.remoteUserMap).call(a)).find(u=>u._audioSSRC===r);l&&He.firstRemoteFrame(this.store.sessionId,Ar.FIRST_AUDIO_RECEIVED,On.FIRST_AUDIO_RECEIVED,{peer:l._uintid,subscribeElapse:fi.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId})},t.onFirstVideoDecoded=(r,a,l)=>{this.reportVideoFirstFrameDecoded(r,a,l)},t.onFirstVideoReceived=r=>{var a;const l=Array.from(Xo(a=this.remoteUserMap).call(a)).find(u=>u._videoSSRC===r);l&&He.firstRemoteFrame(this.store.sessionId,Ar.FIRST_VIDEO_RECEIVED,On.FIRST_VIDEO_RECEIVED,{peer:l._uintid,subscribeElapse:fi.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId})},t.onSelectedLocalCandidateChanged=(r,a)=>{const l=r.candidateType==="relay",u=a.candidateType==="relay";a.candidateType!=="unknown"&&l===u||this.emit(Je.ConnectionTypeChange,l),L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(Jl(a))," -> ").concat(JSON.stringify(Jl(r)),")"))},t.onSelectedRemoteCandidateChanged=(r,a)=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(Jl(a))," -> ").concat(JSON.stringify(Jl(r)),")"))},t.onFirstVideoDecodedTimeout=r=>{this.reportVideoFirstFrameDecoded(r,void 0,void 0,!0)}}unbindConnectionEvents(t){t.onConnectionStateChange=void 0,t.onICEConnectionStateChange=void 0,t.onICETransportStateChange=void 0,t.onDTLSTransportStateChange=void 0,t.onDTLSTransportError=void 0,t.onFirstAudioDecoded=void 0,t.onFirstAudioReceived=void 0,t.onFirstVideoDecoded=void 0,t.onFirstVideoReceived=void 0,t.onSelectedLocalCandidateChanged=void 0,t.onSelectedRemoteCandidateChanged=void 0,t.onFirstVideoDecodedTimeout=void 0}filterTobeMutedTracks(t){const r=[];if(this.getAllTracks().indexOf(t)===-1)return r;const a=this.localTrackMap.get(we.LocalAudioTrack);if(t instanceof en&&(a==null?void 0:a.track)instanceof cr)return a.track.isActive||r.push([we.LocalAudioTrack,a]),r;const l=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:h}]=u;return t===h});if(l&&(r.push(l),l[0]===we.LocalVideoTrack)){const u=this.localTrackMap.get(we.LocalVideoLowTrack);u&&r.push([we.LocalVideoLowTrack,u])}return r}filterTobeUnmutedTracks(t){const r=[],a=this.localTrackMap.get(we.LocalAudioTrack);if(t instanceof en&&(a==null?void 0:a.track)instanceof cr)return a.track.isActive&&r.push([we.LocalAudioTrack,a]),r;const l=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:h}]=u;return t===h});if(l)if(l[0]===we.LocalVideoTrack){r.push(l);const u=this.localTrackMap.get(we.LocalVideoLowTrack);u&&r.push([we.LocalVideoLowTrack,u])}else r.push(l);return r}createMuteMessage(t){return t.map(r=>{var a;let l,[u,{track:h,ssrcs:f,id:v}]=r;switch(u){case we.LocalAudioTrack:l=rn.Audio;break;case we.LocalVideoTrack:l=Ke(a=h._hints).call(a,vn.SCREEN_TRACK)?rn.Screen:rn.High;break;case we.LocalVideoLowTrack:l=rn.Low}return{stream_type:l,ssrcs:f,mid:v}})}createUnmuteMessage(t){return t.map(r=>{var a;let l,[u,{track:h,ssrcs:f,id:v}]=r;switch(u){case we.LocalAudioTrack:l=rn.Audio;break;case we.LocalVideoTrack:l=Ke(a=h._hints).call(a,vn.SCREEN_TRACK)?rn.Screen:rn.High;break;case we.LocalVideoLowTrack:l=rn.Low}return{stream_type:l,ssrcs:f,mid:v}})}filterTobeUnSubscribedTracks(t,r){const a=[],l=this.remoteUserMap.get(t);if(!l)return a;if(r){const u=l.get(r);if(!u)return a;a.push([t,{kind:r,id:u}])}else Array.from(l.entries()).forEach(u=>{let[h,f]=u;a.push([t,{kind:h,id:f}])});return a}filterTobeUnSubscribedDataChannels(t,r){const a=[];return r.forEach(l=>{var u;(u=this.remoteDataChannelMap.get(t))!==null&&u!==void 0&&u.has(l.id)&&a.push(l)}),a}createUnsubscribeMessage(t){const r=[];return t.forEach(a=>{let[l,{kind:u,id:h}]=a;switch(u){case Ue.VIDEO:return void(l._videoSSRC&&r.push({stream_type:Ue.VIDEO,ssrcId:l._videoSSRC}));case Ue.AUDIO:return void(l._audioSSRC&&r.push({stream_type:Ue.AUDIO,ssrcId:l._audioSSRC}))}}),r}createUnsubscribeAllMessage(t){const r=new Map;return t.forEach(a=>{let[l,{kind:u}]=a;if(r.has(l)){let h=r.get(l);u===Ue.VIDEO?h|=pr.Video:h|=pr.Audio,r.set(l,h)}else u===Ue.VIDEO?r.set(l,pr.Video):r.set(l,pr.Audio)}),{users:Array.from(r.entries()).map(a=>{let[l,u]=a;return{stream_id:l.uid,stream_type:u}})}}withdrawRemoteTracks(t){t.forEach(r=>{let[a,{kind:l}]=r;const u=this.remoteUserMap.get(a);u&&(u.delete(l),Array.from(u.entries()).length===0&&this.remoteUserMap.delete(a))})}async updateBitrateLimit(t){const r=this.localTrackMap.get(we.LocalVideoTrack),a=this.localTrackMap.get(we.LocalVideoLowTrack);r&&await r.track.setBitrateLimit(t.uplink),a&&t.low_stream_uplink&&await a.track.setBitrateLimit({max_bitrate:t.low_stream_uplink.bitrate,min_bitrate:t.low_stream_uplink.bitrate||0})}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}mapPubResToRemoteConfig(t,r){return t.map((a,l)=>{var u;let{stream_type:h}=a;return(u=r.find(f=>{let{stream_type:v}=f;return h===v}))===null||u===void 0?void 0:u.attributes})}async tryToUnmuteAudio(t){for(let a=0;a<t.length;a++)if(t[a]instanceof en){var r;const l=this.filterTobeUnmutedTracks(t[a]);if(l.length===0)continue;await((r=this.connection)===null||r===void 0?void 0:r.unmuteLocal(l.map(h=>{let[,{id:f}]=h;return f})));const u=this.createUnmuteMessage(l);return void await ln(this,Je.RequestUnmuteLocal,u)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=t=>{var r;return!((r=this.connection)===null||r===void 0||!r.getRemoteVideoIsReady(t))},this.statsUploader.requestUpload=(t,r)=>this.emit(Je.RequestUploadStats,t,r),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await ni(Zg(this.dtlsFailedCount,sr)),this.emit(Je.RequestReconnect)}async reconnectP2P(){const t=Array.from(this.localTrackMap.entries()),r=this.createGatewayUnpublishMessage(t);Array.from(this.remoteUserMap.entries()),r.length>0&&await Ln(this,Je.RequestUnpublishForReconnectPC,r),this.disconnectForReconnect(),this.emit(Je.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(we.LocalVideoTrack)||this.pendingLocalTracks.some(t=>t instanceof bt)}throwIfTrackTypeNotMatch(t){if(t.filter(r=>r instanceof bt).length>1)throw new be(G.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t.filter(r=>r instanceof en).length>1&&(t.some(r=>r instanceof en&&r._bypassWebAudio)||!fn().webAudioMediaStreamDest))throw new be(G.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const r of t){if(r instanceof bt&&this.pendingLocalTracks.some(a=>a instanceof bt))throw new be(G.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(r instanceof en&&this.pendingLocalTracks.some(a=>a instanceof en)&&(!fn().webAudioMediaStreamDest||r._bypassWebAudio||this.pendingLocalTracks.some(a=>a instanceof en&&a._bypassWebAudio)))throw new be(G.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(t,r){const a=!Z("DISABLE_DUAL_STREAM_USE_ENCODING")&&fn().supportDualStreamEncoding,l=eu(eu({},{width:160,height:120,framerate:15,bitrate:50}),r);let u;u=a?t._mediaStreamTrack.clone():hR(t,l);const h=un(8,"track-low-"),f=new bt(u,eu(eu({},a&&{scaleResolutionDownBy:YT(l,t)}),{},{frameRate:l.framerate,bitrateMax:l.bitrate,bitrateMin:l.bitrate}),void 0,void 0,h);return f.on(Lh.TRANSCEIVER_UPDATED,v=>{t._updateRtpTransceiver(v,$l.LOW_STREAM)}),f._hints.push(vn.LOW_STREAM),t.addListener(Fe.NEED_CLOSE,()=>{f.close()}),f}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(t,r,a){let l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(this.connection&&this.connection instanceof yr){var u,h,f,v;const E=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:y,dtlsTransportState:C,peerConnectionState:I}=this.connection,{local:k,remote:W}=await this.connection.getSelectedCandidatePair();He.pcStats(this.store.sessionId,{startTime:E,eventElapse:t-E||0,iceconnectionsate:y,dtlsstate:C,connectionstate:I,intSucc:r?1:2,error:l,selectedLocalCandidateProtocol:(u=k==null?void 0:k.protocol)!==null&&u!==void 0?u:"",selectedLocalCandidateType:(h=k.candidateType)!==null&&h!==void 0?h:"",selectedLocalCandidateAddress:"".concat(k.address,":").concat(k.port),selectedRemoteCandidateProtocol:(f=W.protocol)!==null&&f!==void 0?f:"",selectedRemoteCandidateType:(v=W.candidateType)!==null&&v!==void 0?v:"",selectedRemoteCandidateAddress:"".concat(W.address,":").concat(W.port),restartCnt:a})}}reportVideoFirstFrameDecoded(t,r,a,l){var u;const h=Array.from(Xo(u=this.remoteUserMap).call(u)).find(f=>f._videoSSRC===t);if(h){l||this.store.subscribe(h.uid,"video",void 0,void 0,void 0,void 0,Date.now());const f=this.store.keyMetrics,v=f.subscribe.find(E=>E.userId===h.uid&&E.type==="video");He.firstRemoteVideoDecode(this.store.sessionId,Ar.FIRST_VIDEO_DECODE,On.FIRST_VIDEO_DECODE,{peer:h._uintid,videowidth:r,videoheight:a,subscribeElapse:fi.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId,apEnd:f.requestAPEnd||0,apStart:f.requestAPStart||0,joinGwEnd:f.joinGatewayEnd||0,joinGwStart:f.joinGatewayStart||0,pcEnd:f.peerConnectionEnd||0,pcStart:f.peerConnectionStart||0,subscriberEnd:(v==null?void 0:v.subscribeEnd)||0,subscriberStart:(v==null?void 0:v.subscribeStart)||0,videoAddNotify:(v==null?void 0:v.streamAdded)||0,state:l?1:0})}}async remoteMediaSsrcChanged(t,r,a){if(!this.connection)return!1;const l=this.remoteUserMap.get(t);if(!l)return!1;const u=l.get(r);if(!u)return!1;const h=await this.connection.getRemoteSSRC(u);return h!==void 0&&h!==a}resetConnection(t){L.debug("[".concat(this.store.clientId,"] [P2PChannel] reset connection to ").concat(t)),this.state===$t.Connected?(L.debug("[".concat(this.store.clientId,"] [P2PChannel] fallback to websocket but P2PChannel state still connected, disconnect first")),this.disconnectForReconnect()):(this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=t===dv.datachannel?new Sr({},this.store):this.isPlanB?new jr({},this.store):new yr({},this.store),this.bindConnectionEvents(this.connection)))}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(t=>{let[r,{track:a}]=t;r===we.LocalVideoLowTrack?a._updateRtpTransceiver(void 0,$l.LOW_STREAM):a._updateRtpTransceiver(void 0)})}reportPCDisconnectedOrFailed(t){this.connection&&this.connection instanceof yr&&(this.connection.iceConnectionState!=="disconnected"&&this.connection.iceConnectionState!=="checking"&&this.connection.iceConnectionState!=="failed"||(this._isFirstConnected?(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isFirstConnected=!1):this._pcStatsUploadType===Fs.TCP_RESTART&&t===hi.RELAY?this.reportPCStats(Date.now(),!1,this._pcStatsUploadType):this.reportPCStats(Date.now(),!1,Fs.DISCONNECTED_OR_FAILED)))}}function Ri(i,t,r){const a=i[t];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const l=this.mutex,u=await l.lock("From P2PChannel.".concat(t));try{for(var h=arguments.length,f=new Array(h),v=0;v<h;v++)f[v]=arguments[v];return await a.apply(this,f)}finally{u()}},r}function gne(i){let t=nU();return function(r,a){let l=r.appId;l!==void 0&&(nn(a,10),wc(a,l));let u=r.cid;u!==void 0&&(nn(a,16),nn(a,u));let h=r.cname;h!==void 0&&(nn(a,26),wc(a,h));let f=r.deviceId;f!==void 0&&(nn(a,34),wc(a,f));let v=r.elapse;v!==void 0&&(nn(a,40),tu(a,v));let E=r.fileSize;E!==void 0&&(nn(a,48),tu(a,Yh(E)));let y=r.height;y!==void 0&&(nn(a,56),tu(a,Yh(y)));let C=r.jpg;C!==void 0&&(nn(a,66),nn(a,C.length),function(Mo,Ie){let xe=Xh(Mo,Ie.length);Mo.bytes.set(Ie,xe)}(a,C));let I=r.networkType;I!==void 0&&(nn(a,72),tu(a,Yh(I)));let k=r.osType;k!==void 0&&(nn(a,80),tu(a,Yh(k)));let W=r.requestId;W!==void 0&&(nn(a,90),wc(a,W));let $=r.sdkVersion;$!==void 0&&(nn(a,98),wc(a,$));let z=r.sequence;z!==void 0&&(nn(a,104),tu(a,Yh(z)));let X=r.sid;X!==void 0&&(nn(a,114),wc(a,X));let ie=r.timestamp;ie!==void 0&&(nn(a,120),tu(a,ie));let oe=r.uid;oe!==void 0&&(nn(a,128),nn(a,oe));let Re=r.vid;Re!==void 0&&(nn(a,136),nn(a,Re));let Ce=r.width;Ce!==void 0&&(nn(a,144),tu(a,Yh(Ce)));let ge=r.service;ge!==void 0&&(nn(a,152),nn(a,ge));let _e=r.callbackData;_e!==void 0&&(nn(a,162),wc(a,_e));let Se=r.jpgEncryption;Se!==void 0&&(nn(a,168),nn(a,Se));let De=r.requestType;De!==void 0&&(nn(a,176),nn(a,De));let Ne=r.scorePorn;Ne!==void 0&&(nn(a,185),_R(a,Ne));let vt=r.scoreSexy;vt!==void 0&&(nn(a,193),_R(a,vt));let Ft=r.scoreNeutral;Ft!==void 0&&(nn(a,201),_R(a,Ft));let Bn=r.scene;Bn!==void 0&&(nn(a,208),nn(a,Bn));let fr=r.ossFilePrefix;fr!==void 0&&(nn(a,218),wc(a,fr));let bn=r.serviceVendor;if(bn!==void 0)for(let Mo of bn){nn(a,226);let Ie=nU();_ne(Mo,Ie),nn(a,Ie.limit),bne(a,Ie),Cne(Ie)}}(i,t),function(r){let a=r.bytes,l=r.limit;return a.length===l?a:a.subarray(0,l)}(t)}function vne(i){return function(r){let a={};e:for(;!rU(r);){let l=Ic(r);switch(l>>>3){case 0:break e;case 1:a.code=Ic(r);break;case 2:a.msg=iU(r,Ic(r));break;case 3:{let u=yne(r);a.data=Ene(r),r.limit=u;break}default:eU(r,7&l)}}return a}({bytes:t=i,offset:0,limit:t.length});var t}function Ene(i){let t={};e:for(;!rU(i);){let r=Ic(i);switch(r>>>3){case 0:break e;case 1:t.requestId=iU(i,Ic(i));break;case 2:t.requestType=Ic(i)>>>0;break;case 3:t.scorePorn=ER(i);break;case 4:t.scoreSexy=ER(i);break;case 5:t.scoreNeutral=ER(i);break;case 6:t.requestScene=Ic(i)>>>0;break;case 7:t.scene=Ic(i)>>>0;break;default:eU(i,7&r)}}return t}function _ne(i,t){let r=i.service;r!==void 0&&(nn(t,8),nn(t,r));let a=i.vendor;a!==void 0&&(nn(t,16),nn(t,a));let l=i.token;l!==void 0&&(nn(t,26),wc(t,l));let u=i.callbackUrl;u!==void 0&&(nn(t,34),wc(t,u))}function yne(i){let t=Ic(i),r=i.limit;return i.limit=i.offset+t,r}function eU(i,t){switch(t){case 0:for(;128&oU(i););break;case 2:gR(i,Ic(i));break;case 5:gR(i,4);break;case 1:gR(i,8);break;default:throw new Error("Unimplemented type: "+t)}}Te([Ri,V("design:type",Function),V("design:paramtypes",[Object,Boolean]),V("design:returntype",me)],Vr.prototype,"startP2PConnection",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[Object,Object,Array,Object,String,String]),V("design:returntype",me)],Vr.prototype,"connect",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",void 0)],Vr.prototype,"updateRemoteRTPCapabilities",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[Object,Object,Array,Object,String,String]),V("design:returntype",me)],Vr.prototype,"preConnect",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],Vr.prototype,"publishDataChannel",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],Vr.prototype,"unpublish",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],Vr.prototype,"unpublishDataChannel",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",me)],Vr.prototype,"unpublishLowStream",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[mi,Array]),V("design:returntype",me)],Vr.prototype,"subscribeDataChannel",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[mi,String,Number,Number,Array]),V("design:returntype",me)],Vr.prototype,"subscribe",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],Vr.prototype,"massSubscribe",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[mi,String,Boolean]),V("design:returntype",me)],Vr.prototype,"unsubscribe",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[mi,Array]),V("design:returntype",me)],Vr.prototype,"unsubscribeDataChannel",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],Vr.prototype,"massUnsubscribe",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[mi,String]),V("design:returntype",me)],Vr.prototype,"muteRemote",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[mi,String]),V("design:returntype",me)],Vr.prototype,"unmuteRemote",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[mi,String]),V("design:returntype",me)],Vr.prototype,"hasRemoteMediaWithLock",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",me)],Vr.prototype,"disconnectForReconnect",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[Object]),V("design:returntype",me)],Vr.prototype,"updateBitrateLimit",null),Te([Ri,V("design:type",Function),V("design:paramtypes",[mi,String,Number]),V("design:returntype",me)],Vr.prototype,"remoteMediaSsrcChanged",null);let Sne=new Float32Array(1);new Uint8Array(Sne.buffer);let mR=new Float64Array(1),Co=new Uint8Array(mR.buffer);function Yh(i){return{low:i|=0,high:i>>31,unsigned:i>=0}}let tU=[];function nU(){const i=tU.pop();return i?(i.offset=i.limit=0,i):{bytes:new Uint8Array(64),offset:0,limit:0}}function Cne(i){tU.push(i)}function gR(i,t){if(i.offset+t>i.limit)throw new Error("Skip past limit");i.offset+=t}function rU(i){return i.offset>=i.limit}function Xh(i,t){let r=i.bytes,a=i.offset,l=i.limit,u=a+t;if(u>r.length){let h=new Uint8Array(2*u);h.set(r),i.bytes=h}return i.offset=u,u>l&&(i.limit=u),a}function vR(i,t){let r=i.offset;if(r+t>i.limit)throw new Error("Read past limit");return i.offset+=t,r}function iU(i,t){let r=vR(i,t),a=String.fromCharCode,l=i.bytes,u="",h="";for(let f=0;f<t;f++){let v,E,y,C,I=l[f+r];128&I?(224&I)==192?f+1>=t?h+=u:(v=l[f+r+1],(192&v)!=128?h+=u:(C=(31&I)<<6|63&v,C<128?h+=u:(h+=a(C),f++))):(240&I)==224?f+2>=t?h+=u:(v=l[f+r+1],E=l[f+r+2],(49344&(v|E<<8))!=32896?h+=u:(C=(15&I)<<12|(63&v)<<6|63&E,C<2048||C>=55296&&C<=57343?h+=u:(h+=a(C),f+=2))):(248&I)==240?f+3>=t?h+=u:(v=l[f+r+1],E=l[f+r+2],y=l[f+r+3],(12632256&(v|E<<8|y<<16))!=8421504?h+=u:(C=(7&I)<<18|(63&v)<<12|(63&E)<<6|63&y,C<65536||C>1114111?h+=u:(C-=65536,h+=a(55296+(C>>10),56320+(1023&C)),f+=3))):h+=u:h+=a(I)}return h}function wc(i,t){let r=t.length,a=0;for(let h=0;h<r;h++){let f=t.charCodeAt(h);f>=55296&&f<=56319&&h+1<r&&(f=(f<<10)+t.charCodeAt(++h)-56613888),a+=f<128?1:f<2048?2:f<65536?3:4}nn(i,a);let l=Xh(i,a),u=i.bytes;for(let h=0;h<r;h++){let f=t.charCodeAt(h);f>=55296&&f<=56319&&h+1<r&&(f=(f<<10)+t.charCodeAt(++h)-56613888),f<128?u[l++]=f:(f<2048?u[l++]=f>>6&31|192:(f<65536?u[l++]=f>>12&15|224:(u[l++]=f>>18&7|240,u[l++]=f>>12&63|128),u[l++]=f>>6&63|128),u[l++]=63&f|128)}}function bne(i,t){let r=Xh(i,t.limit),a=i.bytes,l=t.bytes;for(let u=0,h=t.limit;u<h;u++)a[u+r]=l[u]}function oU(i){return i.bytes[vR(i,1)]}function aU(i,t){let r=Xh(i,1);i.bytes[r]=t}function ER(i){let t=vR(i,8),r=i.bytes;return Co[0]=r[t++],Co[1]=r[t++],Co[2]=r[t++],Co[3]=r[t++],Co[4]=r[t++],Co[5]=r[t++],Co[6]=r[t++],Co[7]=r[t++],mR[0]}function _R(i,t){let r=Xh(i,8),a=i.bytes;mR[0]=t,a[r++]=Co[0],a[r++]=Co[1],a[r++]=Co[2],a[r++]=Co[3],a[r++]=Co[4],a[r++]=Co[5],a[r++]=Co[6],a[r++]=Co[7]}function Ic(i){let t,r=0,a=0;do t=oU(i),r<32&&(a|=(127&t)<<r),r+=7;while(128&t);return a}function nn(i,t){for(t>>>=0;t>=128;)aU(i,127&t|128),t>>>=7;aU(i,t)}function tu(i,t){let r=t.low>>>0,a=(t.low>>>28|t.high<<4)>>>0,l=t.high>>>24,u=l===0?a===0?r<16384?r<128?1:2:r<1<<21?3:4:a<16384?a<128?5:6:a<1<<21?7:8:l<128?9:10,h=Xh(i,u),f=i.bytes;switch(u){case 10:f[h+9]=l>>>7&1;case 9:f[h+8]=u!==9?128|l:127&l;case 8:f[h+7]=u!==8?a>>>21|128:a>>>21&127;case 7:f[h+6]=u!==7?a>>>14|128:a>>>14&127;case 6:f[h+5]=u!==6?a>>>7|128:a>>>7&127;case 5:f[h+4]=u!==5?128|a:127&a;case 4:f[h+3]=u!==4?r>>>21|128:r>>>21&127;case 3:f[h+2]=u!==3?r>>>14|128:r>>>14&127;case 2:f[h+1]=u!==2?r>>>7|128:r>>>7&127;case 1:f[h]=u!==1?128|r:127&r}}function sU(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}const Tne=new Map([["moderation",1],["supervise",2]]);class oE extends An{get connectionState(){return this._connectionState}set connectionState(t){if(this._connectionState===t)return;const r=this._connectionState;this._connectionState=t,this.emit(_r.CONNECTION_STATE_CHANGE,r,t)}get inspectType(){return this._inspectType}set inspectType(t){var r;this._inspectMode=Qu(r=t.map(a=>Tne.get(a)||0)).call(r,(a,l)=>a+l),this._inspectType=t}get quality(){return this._quality}set quality(t){this._quality=t>1?1:t<.1?.1:t,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(t){super(),w(this,"name","AgoraRTCVideoContentInspect"),w(this,"_connectionState",ea.CONNECTING),w(this,"_innerConnectionState",void 0),w(this,"sequence",0),w(this,"inspectStartTime",void 0),w(this,"workerManagerConnection",void 0),w(this,"workerConnection",void 0),w(this,"workerMessageLengthLimit",void 0),w(this,"inspectIntervalMinimum",void 0),w(this,"qualityRatio",void 0),w(this,"_connectInfo",void 0),w(this,"_cancelTokenSource",go.CancelToken.source()),w(this,"_retryConfig",void 0),w(this,"wmSequence",0),w(this,"inspectInterval",void 0),w(this,"inspectTimer",null),w(this,"ossFilePrefix",void 0),w(this,"extraInfo",void 0),w(this,"_inspectType",void 0),w(this,"_inspectMode",void 0),w(this,"_quality",1),w(this,"qualityTimer",null),w(this,"_inspectId",void 0),w(this,"_needWorkUrlOnly",!1),w(this,"inspectImage",()=>{if(this.connectionState!==ea.CONNECTED)throw new ue(G.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===ea.CONNECTED?this.requestToInspectImage():L.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=un(5,"inspect-"),this.workerMessageLengthLimit=Z("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=Z("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=Z("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=t.interval,this.ossFilePrefix=t.ossFilePrefix,this.extraInfo=t.extraInfo,this.inspectType=t.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new Yf("worker-manager-"+this._inspectId,sr),this.on(_r.STATE_CHANGE,(r,a)=>{this._innerConnectionState=r,L.debug("[".concat(this._inspectId,"] Inspect operation :").concat(ta[r]," ").concat(a||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new Yf("worker-"+this._inspectId,sr),this.handleWorkerEvents()}async init(t,r){this.emit(_r.STATE_CHANGE,ta.CONNECT_AP),this._connectInfo=t;const a=this._cancelTokenSource.token;return this._retryConfig=r,new me((l,u)=>{this.on(_r.CONNECTION_STATE_CHANGE,(h,f)=>{f===ea.CONNECTED&&l()}),this.requestAP(t,a,r).then(h=>{this.connectWorkerManager(h)}).catch(h=>{u(h)})})}async requestAP(t,r,a){const l=Z("WEBCS_DOMAIN").map(f=>"https://".concat(f,"/api/v1")),u=await function(f,v,E,y){let{appId:C,areaCode:I,cname:k,sid:W,token:$,uid:z}=v;Gh++;const X="image_moderation_api",ie={service_name:X,json_body:JSON.stringify({appId:C,areaCode:I,cname:k,command:"allocateEdge",requestId:Gh,seq:Gh,sid:W,token:$,ts:Date.now(),uid:z+""})};let oe,Re,Ce=f[0];return Ls(async()=>{oe=Date.now();const ge=await Qc(Ce,{data:ie,cancelToken:E,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(Re=Date.now()-oe,ge.code!==0){const Ne=new ue(G.UNEXPECTED_RESPONSE,"image inspect ap error, code"+ge.code,{retry:!0,responseTime:Re});throw L.error(Ne.toString()),Ne}const _e=JSON.parse(ge.json_body);if(_e.code!==200){const Ne=new ue(G.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(_e.code,", reason: ").concat(_e.reason),{code:_e.code,responseTime:Re});throw L.error(Ne.toString()),Ne}if(!_e.servers||!Array.isArray(_e.servers)||_e.servers.length===0){const Ne=new ue(G.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:_e.code,responseTime:Re});throw L.error(Ne.toString()),Ne}const Se=Z("VIDEO_INSPECT_WORKER_MANAGER_HOST"),De=Z("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:_e.servers.map(Ne=>{let{address:vt,wss:Ft}=Ne;if(vt&&Ft)return"wss://".concat(vt.replace(/\./g,"-"),".").concat(Se,":").concat(De||Ft)}).filter(Ne=>!!Ne),workerToken:_e.workerToken,vid:_e.vid,responseTime:Re}},(ge,_e)=>(He.apworkerEvent(W,{success:!0,sc:200,serviceName:X,responseDetail:JSON.stringify(ge.addressList),firstSuccess:_e===0,responseTime:Re,serverIp:f[_e%f.length]}),!1),(ge,_e)=>(He.apworkerEvent(W,{success:!1,sc:ge.data&&ge.data.code||200,serviceName:X,responseTime:Re,serverIp:f[_e%f.length]}),!!(ge.code!==G.OPERATION_ABORTED&&ge.code!==G.UNEXPECTED_RESPONSE||ge.data&&ge.data.retry)&&(Ce=f[(_e+1)%f.length],!0)),y)}(l,t,r,a);this.emit(_r.STATE_CHANGE,ta.AP_CONNECTED);const{addressList:h}=u;return this.wmSequence++,h}async connectWorkerManager(t){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=r,this.emit(_r.STATE_CHANGE,ta.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(t,1e4)}async connectWorker(t){await this.workerConnection.init([t])}handleWorkerManagerEvents(){this.workerManagerConnection.on(rt.CONNECTED,async()=>{this.emit(_r.STATE_CHANGE,ta.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.19.2",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(rt.CLOSED,()=>{this._innerConnectionState<ta.GET_WORKER_MANAGER_RESPONSE&&L.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(rt.FAILED,()=>{this._innerConnectionState<ta.GET_WORKER_MANAGER_RESPONSE&&L.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(rt.RECONNECTING,()=>{this._innerConnectionState<ta.GET_WORKER_MANAGER_RESPONSE&&L.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(rt.ON_MESSAGE,async t=>{this.emit(_r.STATE_CHANGE,ta.GET_WORKER_MANAGER_RESPONSE);const r=this.workerManagerConnection.url;this.workerManagerConnection.close();const a=JSON.parse(t.data);if(a.code!==200)throw L.error("[".concat(this._inspectId,"] Unexpected code ").concat(a.code," from worker manager")),new ue(G.UNEXPECTED_RESPONSE,"response code of worker is unexpected",a);if(!(a.serverResponse&&a.serverResponse.portWss&&r))throw L.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(a))),new ue(G.UNEXPECTED_RESPONSE,"response content of worker is unexpected",a);{const l=Z("VIDEO_INSPECT_WORKER_PORT")||a.serverResponse.portWss,u=r.replace(/:\d+\/?$/,":".concat(l));this.emit(_r.STATE_CHANGE,ta.CONNECT_WORKER,u),this._needWorkUrlOnly?this.emit(_r.REQUEST_NEW_WORKER_URL,u):await this.connectWorker(u)}}),this.workerManagerConnection.on(rt.WILL_RECONNECT,(t,r,a)=>{a(t)}),this.workerManagerConnection.on(rt.REQUEST_NEW_URLS,(t,r)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(t).catch(r)})}handleWorkerEvents(){this.workerConnection.on(rt.CONNECTED,async()=>{this.emit(_r.STATE_CHANGE,ta.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=ea.CONNECTED}),this.workerConnection.on(rt.ON_MESSAGE,async t=>{if(t.data instanceof ArrayBuffer){const a=vne(new Uint8Array(t.data));if(Z("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&L.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(a)),a.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(_r.INSPECT_RESULT,void 0,void 0);if(a.data&&a.data.scorePorn&&a.data.scoreSexy&&a.data.scoreNeutral){var r;const l={porn:a.data.scorePorn,sexy:a.data.scoreSexy,neutral:a.data.scoreNeutral},u=Qu(r=Object.keys(l)).call(r,(f,v)=>l[f]>l[v]?f:v,"porn"),h=Object.keys(l).find(f=>f===u);this.emit(_r.INSPECT_RESULT,h)}else this.emit(_r.INSPECT_RESULT,void 0,new ue(G.UNEXPECTED_RESPONSE,a.code+"","There is an unexpected data on message"))}else this.emit(_r.INSPECT_RESULT,void 0,new ue(G.UNEXPECTED_RESPONSE,a.code+"",a.msg))}else L.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(_r.INSPECT_RESULT,void 0,new ue(G.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(rt.CLOSED,()=>{this.connectionState=ea.CLOSED}),this.workerConnection.on(rt.FAILED,()=>{this.connectionState=ea.CLOSED}),this.workerConnection.on(rt.RECONNECTING,()=>{this.connectionState=this.connectionState===ea.CONNECTED?ea.RECONNECTING:ea.CONNECTING}),this.workerConnection.on(rt.WILL_RECONNECT,(t,r,a)=>{t==="recover"&&a(t),a("tryNext")}),this.workerConnection.on(rt.REQUEST_NEW_URLS,(t,r)=>{this.workerManagerConnection.close(),this.once(_r.REQUEST_NEW_WORKER_URL,a=>{t([a])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(a=>{this.connectWorkerManager(a,!0)}).catch(a=>{r(a)})})}static intToLong(t){return{low:t|=0,high:t>>31,unsigned:t>=0}}async requestToInspectImage(){this.sequence++;const t=mo(this,_r.CLIENT_LOCAL_VIDEO_TRACK),r={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(t){if(!t.isPlaying)return void this.emit(_r.INSPECT_RESULT,void 0,new ue(G.INVALID_OPERATION,"Only the track being played can be inspected"));const a=await this.generateRequestData(t,r);this.workerConnection.sendMessage(a,!0,!0)}else this.emit(_r.INSPECT_RESULT,void 0,new ue(G.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(t,r){let{appId:a,cname:l,cid:u,vid:h,sid:f,uid:v}=r;const E=Date.now(),y=await t.getCurrentFrameImage("image/jpeg",this.quality),C=await QL(y,a,l),I=this.sequence+"-"+u+"-"+v+"-"+E+"-"+un(12,""),k={appId:a,cid:u,cname:l,deviceId:"",elapse:oE.intToLong(Number(E-this.inspectStartTime)),fileSize:C.byteLength,jpgEncryption:2,height:y.height,width:y.width,jpg:C,networkType:6,osType:7,requestId:I,sdkVersion:"4.19.2",sequence:this.sequence,sid:f,timestamp:oE.intToLong(E),uid:v,vid:h,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};this.extraInfo===void 0&&delete k.callbackData,this.ossFilePrefix===void 0&&delete k.ossFilePrefix;const W=gne(k);if(W.byteLength<this.workerMessageLengthLimit){if(Z("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const $=function(z){for(var X=1;X<arguments.length;X++){var ie=arguments[X]!=null?arguments[X]:{};X%2?sU(Object(ie),!0).forEach(function(oe){w(z,oe,ie[oe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(z,Object.getOwnPropertyDescriptors(ie)):sU(Object(ie)).forEach(function(oe){Object.defineProperty(z,oe,Object.getOwnPropertyDescriptor(ie,oe))})}return z}({},k);delete $.jpg,L.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify($))}return W}{const $=this.quality*this.qualityRatio;return this.quality=$,await this.generateRequestData(t,{appId:a,cname:l,cid:u,vid:h,sid:f,uid:v})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=go.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=ea.CLOSED,this.emit(_r.STATE_CHANGE,ta.CLOSED)}}function Rne(i){let t=function(){const r=Ane.pop();return r?(r.offset=r.limit=0,r):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(r,a){let l=r.appId;l!==void 0&&(lr(a,10),vd(a,l));let u=r.cid;u!==void 0&&(lr(a,16),lr(a,u));let h=r.cname;h!==void 0&&(lr(a,26),vd(a,h));let f=r.deviceId;f!==void 0&&(lr(a,34),vd(a,f));let v=r.elapse;v!==void 0&&(lr(a,40),nu(a,v));let E=r.fileSize;E!==void 0&&(lr(a,48),nu(a,Jh(E)));let y=r.height;y!==void 0&&(lr(a,56),nu(a,Jh(y)));let C=r.jpg;C!==void 0&&(lr(a,66),lr(a,C.length),lU(a,C));let I=r.networkType;I!==void 0&&(lr(a,72),nu(a,Jh(I)));let k=r.osType;k!==void 0&&(lr(a,80),nu(a,Jh(k)));let W=r.requestId;W!==void 0&&(lr(a,90),vd(a,W));let $=r.sdkVersion;$!==void 0&&(lr(a,98),vd(a,$));let z=r.sequence;z!==void 0&&(lr(a,104),nu(a,Jh(z)));let X=r.sid;X!==void 0&&(lr(a,114),vd(a,X));let ie=r.timestamp;ie!==void 0&&(lr(a,120),nu(a,ie));let oe=r.uid;oe!==void 0&&(lr(a,128),lr(a,oe));let Re=r.vid;Re!==void 0&&(lr(a,136),lr(a,Re));let Ce=r.width;Ce!==void 0&&(lr(a,144),nu(a,Jh(Ce)));let ge=r.service;ge!==void 0&&(lr(a,152),lr(a,ge));let _e=r.callbackData;_e!==void 0&&(lr(a,162),lr(a,_e.length),lU(a,_e));let Se=r.ticket;Se!==void 0&&(lr(a,170),vd(a,Se))}(i,t),function(r){let a=r.bytes,l=r.limit;return a.length===l?a:a.subarray(0,l)}(t)}function wne(i){return function(r){let a={};e:for(;!One(r);){let l=y0(r);switch(l>>>3){case 0:break e;case 1:a.code=y0(r);break;case 2:a.msg=uU(r,y0(r));break;case 3:a.requestId=uU(r,y0(r));break;case 4:a.timestamp=xne(r,!1);break;default:Ine(r,7&l)}}return a}({bytes:t=i,offset:0,limit:t.length});var t}function Ine(i,t){switch(t){case 0:for(;128&us(i););break;case 2:yR(i,y0(i));break;case 5:yR(i,4);break;case 1:yR(i,8);break;default:throw new Error("Unimplemented type: "+t)}}function Jh(i){return{low:i|=0,high:i>>31,unsigned:i>=0}}let Ane=[];function yR(i,t){if(i.offset+t>i.limit)throw new Error("Skip past limit");i.offset+=t}function One(i){return i.offset>=i.limit}function aE(i,t){let r=i.bytes,a=i.offset,l=i.limit,u=a+t;if(u>r.length){let h=new Uint8Array(2*u);h.set(r),i.bytes=h}return i.offset=u,u>l&&(i.limit=u),a}function cU(i,t){let r=i.offset;if(r+t>i.limit)throw new Error("Read past limit");return i.offset+=t,r}function lU(i,t){let r=aE(i,t.length);i.bytes.set(t,r)}function uU(i,t){let r=cU(i,t),a=String.fromCharCode,l=i.bytes,u="",h="";for(let f=0;f<t;f++){let v,E,y,C,I=l[f+r];128&I?(224&I)==192?f+1>=t?h+=u:(v=l[f+r+1],(192&v)!=128?h+=u:(C=(31&I)<<6|63&v,C<128?h+=u:(h+=a(C),f++))):(240&I)==224?f+2>=t?h+=u:(v=l[f+r+1],E=l[f+r+2],(49344&(v|E<<8))!=32896?h+=u:(C=(15&I)<<12|(63&v)<<6|63&E,C<2048||C>=55296&&C<=57343?h+=u:(h+=a(C),f+=2))):(248&I)==240?f+3>=t?h+=u:(v=l[f+r+1],E=l[f+r+2],y=l[f+r+3],(12632256&(v|E<<8|y<<16))!=8421504?h+=u:(C=(7&I)<<18|(63&v)<<12|(63&E)<<6|63&y,C<65536||C>1114111?h+=u:(C-=65536,h+=a(55296+(C>>10),56320+(1023&C)),f+=3))):h+=u:h+=a(I)}return h}function vd(i,t){let r=t.length,a=0;for(let h=0;h<r;h++){let f=t.charCodeAt(h);f>=55296&&f<=56319&&h+1<r&&(f=(f<<10)+t.charCodeAt(++h)-56613888),a+=f<128?1:f<2048?2:f<65536?3:4}lr(i,a);let l=aE(i,a),u=i.bytes;for(let h=0;h<r;h++){let f=t.charCodeAt(h);f>=55296&&f<=56319&&h+1<r&&(f=(f<<10)+t.charCodeAt(++h)-56613888),f<128?u[l++]=f:(f<2048?u[l++]=f>>6&31|192:(f<65536?u[l++]=f>>12&15|224:(u[l++]=f>>18&7|240,u[l++]=f>>12&63|128),u[l++]=f>>6&63|128),u[l++]=63&f|128)}}function us(i){return i.bytes[cU(i,1)]}function dU(i,t){let r=aE(i,1);i.bytes[r]=t}function y0(i){let t,r=0,a=0;do t=us(i),r<32&&(a|=(127&t)<<r),r+=7;while(128&t);return a}function lr(i,t){for(t>>>=0;t>=128;)dU(i,127&t|128),t>>>=7;dU(i,t)}function xne(i,t){let r,a=0,l=0,u=0;return r=us(i),a=127&r,128&r&&(r=us(i),a|=(127&r)<<7,128&r&&(r=us(i),a|=(127&r)<<14,128&r&&(r=us(i),a|=(127&r)<<21,128&r&&(r=us(i),l=127&r,128&r&&(r=us(i),l|=(127&r)<<7,128&r&&(r=us(i),l|=(127&r)<<14,128&r&&(r=us(i),l|=(127&r)<<21,128&r&&(r=us(i),u=127&r,128&r&&(r=us(i),u|=(127&r)<<7))))))))),{low:a|l<<28,high:l>>>4|u<<24,unsigned:t}}function nu(i,t){let r=t.low>>>0,a=(t.low>>>28|t.high<<4)>>>0,l=t.high>>>24,u=l===0?a===0?r<16384?r<128?1:2:r<1<<21?3:4:a<16384?a<128?5:6:a<1<<21?7:8:l<128?9:10,h=aE(i,u),f=i.bytes;switch(u){case 10:f[h+9]=l>>>7&1;case 9:f[h+8]=u!==9?128|l:127&l;case 8:f[h+7]=u!==8?a>>>21|128:a>>>21&127;case 7:f[h+6]=u!==7?a>>>14|128:a>>>14&127;case 6:f[h+5]=u!==6?a>>>7|128:a>>>7&127;case 5:f[h+4]=u!==5?128|a:127&a;case 4:f[h+3]=u!==4?r>>>21|128:r>>>21&127;case 3:f[h+2]=u!==3?r>>>14|128:r>>>14&127;case 2:f[h+1]=u!==2?r>>>7|128:r>>>7&127;case 1:f[h]=u!==1?128|r:127&r}}const hU={},pU={},sE=4294967296,fU=sE*sE,mU=fU/2,SR=vU(0,!0),gU=vU(0),Nne=Qh(0,-2147483648,!1),Pne=Qh(-1,2147483647,!1),Dne=Qh(-1,-1,!0);function vU(i,t){let r,a,l;return t?(l=0<=(i>>>=0)&&i<256)&&(a=pU[i],a)?a:(r=Qh(i,0,!0),l&&(pU[i]=r),r):(l=-128<=(i|=0)&&i<128)&&(a=hU[i],a)?a:(r=Qh(i,i<0?-1:0,!1),l&&(hU[i]=r),r)}function Qh(i,t,r){return{low:0|i,high:0|t,unsigned:!!r}}function kne(i,t){if(isNaN(i))return t?SR:gU;if(t){if(i<0)return SR;if(i>=fU)return Dne}else{if(i<=-mU)return Nne;if(i+1>=mU)return Pne}return i<0?t?SR:gU:Qh(i%sE|0,i/sE|0,t)}function EU(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}class CR extends An{get connectionState(){return this._connectionState}set connectionState(t){if(this._connectionState===t)return;const r=this._connectionState;this._connectionState=t,this.emit(Ia.CONNECTION_STATE_CHANGE,t,r)}get quality(){return this._quality}set quality(t){this._quality=t>1?1:t<.1?.1:t,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(t){var r;super(),w(this,"name","AgoraRTCImageModeration"),w(this,"_connectionState",Do.CONNECTING),w(this,"_sequence",0),w(this,"_moderationStartTime",void 0),w(this,"_workerConnection",void 0),w(this,"_workerMessageLengthLimit",void 0),w(this,"_qualityRatio",void 0),w(this,"_connectInfo",void 0),w(this,"_cancelTokenSource",go.CancelToken.source()),w(this,"_retryConfig",void 0),w(this,"_moderationInterval",void 0),w(this,"_moderationTimer",null),w(this,"_moderationMode",1),w(this,"_quality",1),w(this,"_qualityTimer",null),w(this,"_ticket",void 0),w(this,"_moderationIntervalMinimum",void 0),w(this,"_uploadFailedNum",0),w(this,"_uploadNum",0),w(this,"_uploadTimer",null),w(this,"_moderationId",void 0),w(this,"inspectImage",()=>{if(this.connectionState!==Do.CONNECTED)throw new ue(G.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===Do.CONNECTED?this.requestToInspectImage():L.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=un(5,"image-moderation-"),this._workerMessageLengthLimit=Z("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=Z("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=(r=t.interval)!==null&&r!==void 0?r:1e3,this._qualityRatio=Z("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new Yf("worker-"+this._moderationId,sr),this.on(Ia.STATE_CHANGE,(a,l)=>{L.debug("[".concat(this._moderationId,"] Moderation operation :").concat(Vl[a]," ").concat(l||""))}),this.handleWorkerEvents()}async init(t,r){this.emit(Ia.STATE_CHANGE,Vl.CONNECT_AP),this._connectInfo=t;const a=this._cancelTokenSource.token;return this._retryConfig=r,new me((l,u)=>{this.on(Ia.CONNECTION_STATE_CHANGE,(h,f)=>{h===Do.CONNECTED&&l()}),this.requestAP(t,a,r).then(h=>{this.connectWorker(h)}).catch(h=>{u(h)})})}updateConfig(t){var r;this._moderationInterval=(r=t.interval)!==null&&r!==void 0?r:1e3,L.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(t))),this.connectionState===Do.CONNECTED&&this.inspectImage()}async requestAP(t,r,a){const l=Z("WEBCS_DOMAIN").map(v=>"https://".concat(v,"/api/v1")),u=await function(v,E,y,C){let{appId:I,areaCode:k,cname:W,sid:$,token:z,uid:X}=E;Gh++;const ie="moderation_plugin",oe={service_name:ie,json_body:JSON.stringify({appId:I,areaCode:k,cname:W,command:"allocateEdge",requestId:Gh,seq:Gh,sid:$,appToken:z,ts:Date.now(),uid:X+""})};let Re,Ce,ge=v[0];return Ls(async()=>{Re=Date.now();const _e=await Qc(ge,{data:oe,cancelToken:y,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(Ce=Date.now()-Re,_e.code!==0){const Ne=new ue(G.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+_e.code,{retry:!0,responseTime:Ce});throw L.error(Ne.toString()),Ne}const Se=JSON.parse(_e.json_body);if(Se.code!==200){const Ne=new ue(G.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(Se.code,", reason: ").concat(Se.reason),{code:Se.code,responseTime:Ce});throw L.error(Ne.toString()),Ne}if(!Se.servers||!Array.isArray(Se.servers)||Se.servers.length===0){const Ne=new ue(G.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:Se.code,responseTime:Ce});throw L.error(Ne.toString()),Ne}if(!Se.servers.some(Ne=>!!Ne.wss)){const Ne=new ue(G.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:Se.code,responseTime:Ce});throw L.error(Ne.toString()),Ne}const De=Z("IMAGE_MODERATION_WORKER_HOST");return{addressList:Se.servers.map(Ne=>{let{address:vt,wss:Ft}=Ne;if(vt&&Ft)return"wss://".concat(vt.replace(/\./g,"-"),".").concat(De,":").concat(Ft,"/moderation")}).filter(Ne=>!!Ne),workerToken:Se.workerToken,vid:Se.vid,ticket:Se.appTicket,responseTime:Ce}},(_e,Se)=>(He.apworkerEvent($,{success:!0,sc:200,serviceName:ie,responseDetail:JSON.stringify(_e.addressList),firstSuccess:Se===0,responseTime:Ce,serverIp:v[Se%v.length]}),!1),(_e,Se)=>(He.apworkerEvent($,{success:!1,sc:_e.data&&_e.data.code||200,serviceName:ie,responseTime:Ce,serverIp:v[Se%v.length]}),!!(_e.code!==G.OPERATION_ABORTED&&_e.code!==G.UNEXPECTED_RESPONSE||_e.data&&_e.data.retry)&&(ge=v[(Se+1)%v.length],!0)),C)}(l,t,r,a);this.emit(Ia.STATE_CHANGE,Vl.AP_CONNECTED);const{addressList:h,ticket:f}=u;return this._ticket=f,h}async connectWorker(t){this.emit(Ia.STATE_CHANGE,Vl.CONNECT_WORKER),await this._workerConnection.init(t,1e4)}handleWorkerEvents(){this._workerConnection.on(rt.CONNECTED,async()=>{this.emit(Ia.STATE_CHANGE,Vl.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=Do.CONNECTED}),this._workerConnection.on(rt.CLOSED,()=>{this.connectionState=Do.CLOSED}),this._workerConnection.on(rt.FAILED,()=>{this.connectionState=Do.CLOSED}),this._workerConnection.on(rt.RECONNECTING,()=>{this.connectionState=this.connectionState===Do.CONNECTED?Do.RECONNECTING:Do.CONNECTING}),this._workerConnection.on(rt.ON_MESSAGE,async t=>{if(t.data instanceof ArrayBuffer){const r=wne(new Uint8Array(t.data));Z("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&L.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(r)),this._uploadNum++,r.code===void 0||r.code===0||(this._uploadFailedNum++,L.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(r.code,", msg is ").concat(r.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{He.reportApiInvoke(this._connectInfo.sid||null,{name:hr.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,r.code],tag:Dn.TRACER}).onError(new ue(G.IMAGE_MODERATION_UPLOAD_FAILED,r.msg)),this._uploadTimer=null},Z("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else L.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(rt.WILL_RECONNECT,(t,r,a)=>{t==="recover"&&a(t),a("tryNext")}),this._workerConnection.on(rt.REQUEST_NEW_URLS,(t,r)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(t).catch(r)})}static intToLong(t){return{low:t|=0,high:t>>31,unsigned:t>=0}}async requestToInspectImage(){const t=mo(this,Ia.CLIENT_LOCAL_VIDEO_TRACK),r={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(t){if(!t.isPlaying)return void(Z("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&L.debug("Only the track being played can be inspected"));this._sequence++;const a=await this.generateRequestData(t,r);this._workerConnection.sendMessage(a,!0,!0)}else Z("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&L.debug("Only the track being published can be inspected")}async generateRequestData(t,r){let{appId:a,cname:l,cid:u,vid:h,sid:f,uid:v}=r;const E=Date.now(),y=await t.getCurrentFrameImage("image/jpeg",this.quality),C=await QL(y,a,l),I=this._sequence+"-"+u+"-"+v+"-"+E+"-"+un(12,""),k={appId:a,cid:u,cname:l,deviceId:"",elapse:CR.intToLong(Number(E-this._moderationStartTime)),fileSize:y.buffer.byteLength,height:y.height,width:y.width,jpg:C,networkType:6,osType:7,requestId:I,sdkVersion:"4.19.2",sequence:this._sequence,sid:f,timestamp:kne(E),uid:v,vid:h,service:this._moderationMode,ticket:this._ticket},W=Rne(k);if(W.byteLength<this._workerMessageLengthLimit){if(Z("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const $=function(z){for(var X=1;X<arguments.length;X++){var ie=arguments[X]!=null?arguments[X]:{};X%2?EU(Object(ie),!0).forEach(function(oe){w(z,oe,ie[oe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(z,Object.getOwnPropertyDescriptors(ie)):EU(Object(ie)).forEach(function(oe){Object.defineProperty(z,oe,Object.getOwnPropertyDescriptor(ie,oe))})}return z}({},k);delete $.jpg,L.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify($))}return W}{const $=this.quality*this._qualityRatio;return this.quality=$,await this.generateRequestData(t,{appId:a,cname:l,cid:u,vid:h,sid:f,uid:v})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=go.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=Do.CLOSED,this.emit(Ia.STATE_CHANGE,Vl.CLOSED)}}function _U(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function cE(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_U(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):_U(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}class zi extends hL{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var t,r;return(t=(r=this.peerConnection.getReceivers()[0])===null||r===void 0||(r=r.transport)===null||r===void 0?void 0:r.state)!==null&&t!==void 0?t:null}constructor(t,r,a){super(t,r),w(this,"direction",void 0),w(this,"store",void 0),w(this,"peerConnection",void 0),w(this,"transportEventReceiver",void 0),w(this,"statsFilter",void 0),w(this,"localCandidateCount",0),w(this,"allCandidatesReceived",!1),w(this,"mutex",new Mr("P2PConnection-mutex")),w(this,"dataChannel",void 0),w(this,"onLocalCandidate",void 0),this.store=r,this.peerConnection=new RTCPeerConnection(zi.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.direction=a??Nh.SEND_ONLY,this.dataChannel=this.peerConnection.createDataChannel("agora-p2p-signal",{ordered:!0}),this.statsFilter=eE(this.peerConnection,Z("STATS_UPDATE_INTERVAL"),void 0,Cn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(t){try{if(t){await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();if(await this.peerConnection.setLocalDescription(r),!r.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");return r.sdp}{const r=await this.peerConnection.createOffer();if(!r.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");return await this.peerConnection.setLocalDescription(r),r.sdp}}catch(r){throw new be(G.GET_LOCAL_CONNECTION_PARAMS_FAILED,r.toString())}}async connect(t){try{await this.peerConnection.setRemoteDescription({type:"answer",sdp:t})}catch(r){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(r.toString()))}}async addRemoteCandidate(t){try{await this.peerConnection.addIceCandidate(t)}catch(r){throw new be(G.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(r.toString()))}}async send(t){try{const r=[];t.forEach(u=>{const h=this.peerConnection.addTransceiver(u._mediaStreamTrack,{direction:"sendonly"});r.push(h)}),Cn()&&Z("SIMULCAST")===!0&&await this.applySimulcastForFirefox(r,t),await this.applySimulcastEncodings(r,t),await this.applySendEncodings(r,t);const a=await this.peerConnection.createOffer();if(await this.peerConnection.setLocalDescription(a),!a.sdp)throw new Error("Cannot get offer.sdp when trying to send PeerConnection.");const l=r.map(u=>{const h=this.getLocalSSRC(u.mid,a.sdp);if(!h)throw new Error("Cannot get ssrc when trying to send PeerConnection.");return{mid:u.mid,localSSRC:[{ssrcId:h}]}});return{sdp:a.sdp,trackMessage:l}}catch(r){throw r instanceof be?r:new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(r.toString()))}}async stopSending(t,r){const a=r?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{const l=this.peerConnection.getTransceivers().filter(h=>t.indexOf(h.mid)!==-1);if(l.length!==t.length)throw new Error("Transceivers' length (".concat(l.length,") doesn't match mids' length (").concat(t.length,") when trying to call P2PConnection.stopSending."));l.map(h=>{var f;h.direction="inactive",(f=h.stop)===null||f===void 0||f.call(h),this.peerConnection.removeTrack(h.sender)});const u=await this.peerConnection.createOffer();if(await this.peerConnection.setLocalDescription(u),!u.sdp)throw new Error("Cannot get offer.sdp when trying to send PeerConnection.");return u.sdp}catch(l){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(l.toString()))}finally{a&&a()}}async receive(t,r,a){try{await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const l=await this.peerConnection.createAnswer();if(!l.sdp)throw new Error("Cannot get answer sdp when trying to receive track.");await this.peerConnection.setLocalDescription(l),L.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," by exchanging SDP."));const u=this.getRemoteMid(a,r);if(u===void 0)throw new Error("Cannot get transceiver mid when trying to receive track.");const h=this.peerConnection.getTransceivers().find(f=>f.mid===u);if(!h||h.mid===null)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:h.receiver.track,mid:h.mid,sdp:l.sdp}}catch(l){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(l.toString()))}}async setDescription(t,r){try{if(t==="remote"){await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const a=await this.peerConnection.createAnswer();if(!a.sdp)throw new Error("Cannot get answer sdp when trying to receive track.");return await this.peerConnection.setLocalDescription(a),L.debug("[".concat(this.store.clientId,"] [P2PConnection] exchanging SDP, type is ").concat(t)),a.sdp}await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(a){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection.setDescription failed; ".concat(a.toString()))}}async stopReceiving(t,r){try{const a=this.peerConnection.getTransceivers().filter(u=>t.indexOf(u.mid)!==-1);if(a.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");a.map(u=>{var h;u.direction="inactive",(h=u.stop)===null||h===void 0||h.call(u)}),await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const l=await this.peerConnection.createAnswer();if(await this.peerConnection.setLocalDescription(l),!l.sdp)throw new Error("Cannot get answer sdp when trying to receive track.");return l.sdp}catch(a){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(a.toString()))}}async restartICE(){try{const t=await this.peerConnection.createOffer({iceRestart:!0});if(!t.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");return this.store.descriptionStart(),await this.peerConnection.setLocalDescription(t),t.sdp}catch(t){throw new be(G.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(t.toString()))}}close(){var t;this.peerConnection.close(),(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transportEventReceiver=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}async updateEncoderConfig(t,r){}async updateSendParameters(t,r){const a=this.peerConnection.getTransceivers().filter(l=>l.mid===t);a.length===1&&(this.isVP8Simulcast(r)?Cn()||await this.applySimulcastEncodings(a,[r]):await this.applySendEncodings(a,[r]))}setStatsRemoteVideoIsReady(t,r){this.statsFilter.setVideoIsReady2(t,r)}async replaceTrack(t,r){const a=this.peerConnection.getTransceivers().find(l=>l.mid===r);a&&await a.sender.replaceTrack(t._mediaStreamTrack)}async getSelectedCandidatePair(){const t=this.peerConnection.getReceivers();if(t.length>0&&t[0].transport&&t[0].transport.iceTransport&&t[0].transport.iceTransport.getSelectedCandidatePair&&t[0].transport.iceTransport.getSelectedCandidatePair()){const r=t[0].transport.iceTransport,{local:a,remote:l}=r.getSelectedCandidatePair();return{local:cE(cE({},Rc),{},{candidateType:a.type,protocol:a.protocol,address:a.address,port:a.port}),remote:cE(cE({},Rc),{},{candidateType:l.type,protocol:l.protocol,address:l.address,port:l.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t;(t=this.onICEConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=t=>{var r;t.candidate&&((r=this.onLocalCandidate)===null||r===void 0||r.call(this,t.candidate)),t.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,L.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,L.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},Z("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const r={iceServers:[]};return t.iceServers?r.iceServers=t.iceServers:t.turnServer&&t.turnServer.mode!=="off"&&(bh(t.turnServer.servers)?r.iceServers=t.turnServer.servers:(r.iceServers&&r.iceServers.push(...zi.turnServerConfigToIceServers(t.turnServer.servers)),Z("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&t.turnServer.serversFromGateway&&r.iceServers.push(...zi.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),Z("FORCE_TURN_TCP")?r.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(a=>{a.forceturn&&(r.iceTransportPolicy="relay")}))),Z("ENABLE_ENCODED_TRANSFORM")&&fn().supportWebRTCEncodedTransform&&(r.encodedInsertableStreams=!0),r}static turnServerConfigToIceServers(t){const r=[];return t.forEach(a=>{a.tcpport&&(r.push({username:a.username,credential:a.password,credentialType:"password",urls:"turns:".concat(f0(a.turnServerURL),":").concat(a.tcpport,"?transport=tcp")}),r.push({username:a.username,credential:a.password,credentialType:"password",urls:"turn:".concat(a.turnServerURL,":").concat(a.tcpport,"?transport=udp")}),r.push({username:a.username,credential:a.password,credentialType:"password",urls:"stun:".concat(a.turnServerURL,":").concat(a.tcpport)}))}),r}tryBindTransportEvents(t){const r=t.transport;if(r){this.transportEventReceiver=t,r.onstatechange=()=>{var l;r!=null&&r.state&&((l=this.onDTLSTransportStateChange)===null||l===void 0||l.call(this,r.state))},r.onerror=l=>{var u;(u=this.onDTLSTransportError)===null||u===void 0||u.call(this,"error"in l?l.error:l)};const a=r.iceTransport;a&&(a.onstatechange=()=>{const l=r==null?void 0:r.iceTransport.state;var u;l&&((u=this.onICETransportStateChange)===null||u===void 0||u.call(this,l))},a.getSelectedCandidatePair&&(a.onselectedcandidatepairchange=()=>{if(a.getSelectedCandidatePair()){const{local:l,remote:u}=a.getSelectedCandidatePair();L.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:l.type,protocol:l.protocol}),", remote ").concat(JSON.stringify({candidateType:u.type,protocol:u.protocol,address:u.address,port:u.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(t,r){var a;if(r||(r=this.peerConnection.getSenders().find(y=>y.track===t._mediaStreamTrack)),!r)return L.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(t))return L.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!fn().supportSetRtpSenderParameters)return L.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const l={},u={};switch(t._optimizationMode){case"motion":l.degradationPreference="maintain-framerate";break;case"detail":l.degradationPreference="maintain-resolution";break;default:l.degradationPreference="balanced"}if(t._encoderConfig){var h;const{bitrateMax:y,frameRate:C,scaleResolutionDownBy:I}=t._encoderConfig;y&&(u.maxBitrate=1e3*y),Ke(h=t._hints).call(h,vn.LOW_STREAM)&&(C&&(u.maxFramerate=ca(C)),I&&I>=1&&(u.scaleResolutionDownBy=I))}if(Z("DSCP_TYPE")&&Ll()){var f;const y=Z("DSCP_TYPE");Ke(f=["very-low","low","medium","high"]).call(f,y)&&(u.networkPriority=y)}const v=r.getParameters(),E=(a=v.encodings)===null||a===void 0?void 0:a[0];Cn()&&!E&&(l.encodings=[u]),E&&Object.assign(E,u),Object.assign(v,l),L.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(v.encodings))),await r.setParameters(v)}async applySendEncodings(t,r){try{if(!fn().supportSetRtpSenderParameters||t.length!==r.length)return;for(let a=0;a<t.length;a++){const l=t[a],u=r[a];u instanceof bt&&!this.isVP8Simulcast(u)&&await this.updateRtpSenderEncodings(u,l.sender)}}catch{L.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(t,r,a){const l=Hn.parse(t);return r.forEach((u,h)=>{const f=a[h],v=l.mediaDescriptions.find(E=>E.attributes.mid===f);v&&(md(v,u),lR(v,u,this.store.codec))}),Hn.print(l)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,r,a)=>{var l;(l=this.onFirstVideoDecoded)===null||l===void 0||l.call(this,t,r,a)},this.statsFilter.onSelectedLocalCandidateChanged=(t,r)=>{var a;(a=this.onSelectedLocalCandidateChanged)===null||a===void 0||a.call(this,t,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,r)=>{var a;(a=this.onSelectedRemoteCandidateChanged)===null||a===void 0||a.call(this,t,r)},this.statsFilter.onFirstVideoDecodedTimeout=t=>{var r;(r=this.onFirstVideoDecodedTimeout)===null||r===void 0||r.call(this,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(t,r){if(t.length===r.length)for(let v=0;v<t.length;v++){var a,l,u,h,f;const E=t[v],y=r[v];if(y instanceof bt&&!Ke(a=y._hints).call(a,vn.LOW_STREAM)&&(l=y._encoderConfig)!==null&&l!==void 0&&l.bitrateMax&&((u=y._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(h=y._scalabilityMode)!==null&&h!==void 0&&h.numSpatialLayers&&((f=y._scalabilityMode)===null||f===void 0?void 0:f.numSpatialLayers)>1&&this.store.codec==="vp8"){const C={},I={high:1e3*(y._encoderConfig.bitrateMax-50),medium:5e4};C.encodings=[{rid:"m",active:!0,maxBitrate:I.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:I.high}];const k=E.sender.getParameters();await E.sender.setParameters(Object.assign(k,C))}}}async applySimulcastEncodings(t,r){if(!Cn()&&t.length===r.length)for(let a=0;a<t.length;a++){const l=r[a];if(l instanceof bt&&this.isVP8Simulcast(l)){const u=t[a],h={},f={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};h.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:f.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:f.medium,scaleResolutionDownBy:4}];const v=u.sender.getParameters();await u.sender.setParameters(Object.assign(v,h))}}}isVP8Simulcast(t){var r,a,l,u,h;return!!(t instanceof bt&&Z("SIMULCAST")&&this.store.codec==="vp8"&&!Ke(r=t._hints).call(r,vn.LOW_STREAM)&&(a=t._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&((l=t._encoderConfig)===null||l===void 0?void 0:l.bitrateMax)>200&&(u=t._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((h=t._scalabilityMode)===null||h===void 0?void 0:h.numSpatialLayers)>1)}logSDPExchange(t,r,a,l){if(Z("SDP_LOGGING"))return L.upload("[".concat(this.store.clientId,"] exchanging ").concat(a," ").concat(r," SDP during P2PConnection.").concat(l,`
`),t),r==="offer"?u=>{this.logSDPExchange(u,"answer",a==="local"?"remote":"local",l)}:void 0}getLocalSSRC(t,r){var a,l;if(r=(a=r)!==null&&a!==void 0?a:(l=this.currentLocalDescription)===null||l===void 0?void 0:l.sdp){var u;const h=(u=Hn.parse(r).mediaDescriptions.find(f=>f.attributes.mid===t))===null||u===void 0?void 0:u.attributes.ssrcs;return h==null?void 0:h[0].ssrcId}}getRemoteMid(t,r){var a,l;if(r=(a=r)!==null&&a!==void 0?a:(l=this.currentRemoteDescription)===null||l===void 0?void 0:l.sdp){var u;return(u=Hn.parse(r).mediaDescriptions.find(h=>h.attributes.ssrcs.some(f=>f.ssrcId===t)))===null||u===void 0?void 0:u.attributes.mid}}async getRemoteSSRC(t,r){var a,l;if(r=(a=r)!==null&&a!==void 0?a:(l=this.currentRemoteDescription)===null||l===void 0?void 0:l.sdp){var u;const h=(u=Hn.parse(r).mediaDescriptions.find(f=>f.attributes.mid===t))===null||u===void 0?void 0:u.attributes.ssrcs;return h==null?void 0:h[0].ssrcId}}}function ds(i,t,r){const a=i[t];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const l=this.mutex,u=await l.lock("From P2PConnection.".concat(t));try{for(var h=arguments.length,f=new Array(h),v=0;v<h;v++)f[v]=arguments[v];return await a.apply(this,f)}finally{u()}},r}var ka;function yU(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function ru(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yU(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):yU(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}Te([ds,V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],zi.prototype,"establish",null),Te([ds,V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],zi.prototype,"connect",null),Te([ds,V("design:type",Function),V("design:paramtypes",[RTCIceCandidate]),V("design:returntype",me)],zi.prototype,"addRemoteCandidate",null),Te([ds,V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],zi.prototype,"send",null),Te([ds,V("design:type",Function),V("design:paramtypes",[String,String,Number]),V("design:returntype",me)],zi.prototype,"receive",null),Te([ds,V("design:type",Function),V("design:paramtypes",[String,String]),V("design:returntype",me)],zi.prototype,"setDescription",null),Te([ds,V("design:type",Function),V("design:paramtypes",[Array,String]),V("design:returntype",me)],zi.prototype,"stopReceiving",null),Te([ds,V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",me)],zi.prototype,"restartICE",null),Te([ds,V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],zi.prototype,"close",null),Te([ds,V("design:type",Function),V("design:paramtypes",[String,pi]),V("design:returntype",me)],zi.prototype,"updateEncoderConfig",null),Te([ds,V("design:type",Function),V("design:paramtypes",[String,pi]),V("design:returntype",me)],zi.prototype,"updateSendParameters",null),Te([ds,V("design:type",Function),V("design:paramtypes",[pi,String]),V("design:returntype",me)],zi.prototype,"replaceTrack",null),function(i){i.SEND_ONLY="SEND_ONLY",i.RECEIVE_ONLY="RECEIVE_ONLY"}(ka||(ka={}));class Un extends An{get state(){return this._state}set state(t){const r=this._state;this._state=t,this.emit(Je.StateChange,r,this._state)}constructor(t,r){super(),w(this,"store",void 0),w(this,"statsUploader",void 0),w(this,"sendConnection",void 0),w(this,"recvConnection",void 0),w(this,"localTrackMap",new Map),w(this,"remoteUserMap",new Map),w(this,"localDataChannels",[]),w(this,"pendingLocalTracks",[]),w(this,"pendingRemoteTracks",[]),w(this,"statsCollector",void 0),w(this,"dtlsFailedCount",0),w(this,"sendMutex",new Mr("P2PChannel2-send-mutex")),w(this,"recvMutex",new Mr("P2PChannel2-recv-mutex")),w(this,"_state",$t.Disconnected),w(this,"_restartStates",["disconnected","failed"]),w(this,"_restartTimer",void 0),w(this,"handleMuteLocalTrack",async(a,l,u)=>{const h=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==$t.Connected)return void u(new be(G.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const E=this.filterTobeMutedTracks(a);if(E.length===0)return void l();const y=E.find(X=>X[0]==="videoLowTrack");y&&y[1].track._originMediaStreamTrack.stop();let C=!1;var f,v;a.trackMediaType==="video"?C=!((f=this.localTrackMap.get(we.LocalAudioTrack))===null||f===void 0||!f.track._muted):C=((v=this.localTrackMap.get(we.LocalVideoTrack))===null||v===void 0?void 0:v.id)===void 0;const I=E.filter(X=>{let[ie,oe]=X;return(ie!==we.LocalAudioTrack||C)&&oe.id!==void 0}).map(X=>{let[,ie]=X;return ie});let k;I.length>0&&(k=await this.sendConnection.stopSending(I.map(X=>X.id)),I.forEach(X=>{X.id=void 0,X.ssrcs=void 0}));const W=this.createMuteMessage(E),$=a.trackMediaType==="video"?Ec.MUTE_LOCAL_VIDEO:Ec.MUTE_LOCAL_AUDIO,z=await Ln(this,Je.RequestP2PMuteLocal,{action:$,sdp:k,message:W,isMuteAll:C});z&&await this.sendConnection.setDescription("local",z),(k||a.trackMediaType==="audio")&&await ln(this,Je.RequestMuteLocal,W),l()}catch(E){u(E)}finally{h()}}),w(this,"handleUnmuteLocalTrack",async(a,l,u)=>{const h=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==$t.Connected)return void u(new be(G.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const f=this.filterTobeUnmutedTracks(a);if(f.length===0)return void l();const v=this.createUnmuteMessage(f),E=a.trackMediaType==="video"?Ec.UNMUTE_LOCAL_VIDEO:Ec.UNMUTE_LOCAL_AUDIO;await ln(this,Je.RequestP2PMuteLocal,{action:E,message:v}),l()}catch(f){u(f)}finally{h()}}),w(this,"handleUpdateVideoEncoder",async(a,l,u)=>{const h=await this.sendMutex.lock("Locking from P2PChannel2.handleSetVideoEncoder");try{const f=this.localTrackMap.get(we.LocalVideoTrack);if(!this.sendConnection||!f||f.track!==a||this.state!==$t.Connected)return void l();const{id:v,track:E}=f;v&&(await this.sendConnection.updateSendParameters(v,E),await this.sendConnection.updateEncoderConfig(v,E),this.emit(Je.UpdateVideoEncoder,E)),l()}catch(f){u(f)}finally{h()}}),w(this,"handleSetOptimizationMode",async(a,l,u)=>{const h=await this.sendMutex.lock("Locking from P2PChannel2.handleSetOptimizationMode");try{const f=this.localTrackMap.get(we.LocalVideoTrack);if(!this.sendConnection||!f||f.track!==a||this.state!==$t.Connected)return;const{id:v,track:E}=f;v&&await this.sendConnection.updateSendParameters(v,E),l()}catch(f){u(f)}finally{h()}}),w(this,"handleReplaceTrack",async(a,l,u,h)=>{let f;L.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(a.getTrackId(),"]")),typeof h=="boolean"&&h||(f=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var v;const y=Array.from(this.localTrackMap.entries()).find(C=>{let[,{track:I}]=C;return a===I});if(!this.sendConnection||!y||y[1].id===void 0||this.state!==$t.Connected)return void l();if(await((v=this.sendConnection)===null||v===void 0?void 0:v.replaceTrack(a,y[1].id)),y[0]===we.LocalVideoTrack&&fn().supportDualStreamEncoding){const C=this.localTrackMap.get(we.LocalVideoLowTrack);if(C){const I=a._mediaStreamTrack.clone();C.track._originMediaStreamTrack.stop(),C.track._mediaStreamTrack=I,C.track._originMediaStreamTrack=I,await new me((k,W)=>{this.handleReplaceTrack(C.track,k,W,!0)})}}l()}catch(y){u(y)}finally{var E;(E=f)===null||E===void 0||E()}}),w(this,"handleGetLocalVideoStats",a=>{a(this.statsCollector.getLocalVideoTrackStats())}),w(this,"handleGetLocalAudioStats",a=>{a(this.statsCollector.getLocalAudioTrackStats())}),w(this,"handleGetRemoteVideoStats",a=>this.statsCollector.getRemoteVideoTrackStats(a.uid)[a.uid]),w(this,"handleGetRemoteAudioStats",a=>this.statsCollector.getRemoteAudioTrackStats(a.uid)[a.uid]),this.store=t,this.statsCollector=r,this.statsCollector.addP2PChannel(this),this.statsUploader=new JF,this.bindStatsUploaderEvents()}async startP2PConnection(t,r){throw new be(G.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(t,r,a,l,u,h){throw new be(G.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(t,r){if(this.state=$t.New,this.sendConnection&&(L.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset P2PConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),this.recvConnection&&(L.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset P2PConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),this.sendConnection=new zi(t,this.store),this.bindConnectionEvents(this.sendConnection),this.recvConnection=new zi(t,this.store,Nh.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection),r){this.store.peerConnectionStart(),await this.recvConnection.establish(r);const a=await this.sendConnection.establish(r);return this.statsUploader.startUploadTransportStats(!0),this.statsUploader.startUploadExtensionUsageStats(),this.state=$t.Connected,a}return await this.recvConnection.establish(r),this.sendConnection.establish(r)}async p2pConnect(t){if(!this.sendConnection||!this.recvConnection)throw new be(G.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.recvConnection.connect(t),await this.sendConnection.connect(t),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=$t.Connected}async addRemoteCandidate(t){if(!this.sendConnection||!this.recvConnection)throw new be(G.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(t),await this.sendConnection.addRemoteCandidate(t)}async publish(t,r,a){if(!this.sendConnection||this.state!==$t.Connected){this.throwIfTrackTypeNotMatch(t);const h=t.filter(f=>this.pendingLocalTracks.indexOf(f)===-1);return void(this.pendingLocalTracks=this.pendingLocalTracks.concat(h))}this.store.pubId=this.store.pubId+1,fi.markPublishStart(this.store.clientId,this.store.pubId);const l=this.filterTobePublishedTracks(t,r,a);if(l.length===0)return void await this.tryToUnmuteAudio(t);l.forEach(h=>{let{track:f,type:v}=h;const E=Date.now();this.store.publish(f.getTrackId(),v===we.LocalAudioTrack?"audio":"video",E)}),this.bindLocalTrackEvents(l);const u=this.createGatewayPublishMessage(l);return this.assignLocalTracks(l),l.forEach(h=>{let{track:f,type:v}=h;const E=Date.now();this.store.publish(f.getTrackId(),v===we.LocalAudioTrack?"audio":"video",void 0,E)}),u}async dopublish(t){if(!this.sendConnection||this.state!==$t.Connected)return;const r=this.localTrackMap.get(t);if(r){const{sdp:a,trackMessage:l}=await this.sendConnection.send([r.track]),{mid:u,localSSRC:h}=l[0];r.id=u,r.ssrcs=h,this.statsCollector.addLocalStats(t),this.statsUploader.startUploadUplinkStats();const f=await Ln(this,Je.RequestP2PPublish,{kind:t===we.LocalAudioTrack?Ue.AUDIO:Ue.VIDEO,sdp:a,ssrcId:h[0].ssrcId});await this.sendConnection.setDescription("local",f);const v=this.createUnmuteMessage([[t,r]]);await ln(this,Je.RequestUnmuteLocal,v)}}async setDescription(t,r){let a,l;t==="local"?(a=await this.sendMutex.lock("From P2PChannel.restartICE"),l=this.sendConnection):(a=await this.recvMutex.lock("From P2PChannel.restartICE"),l=this.recvConnection);try{return!l||this.state!==$t.Connected?void 0:await l.setDescription(t,r)}finally{a()}}publishLowStream(t){return Na(function*(){throw new be(G.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}async republish(){this.pendingLocalTracks.length>0&&(L.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Ln(this,Je.RequestRePublish,this.pendingLocalTracks),this.emit(Je.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublish(t){if(!this.sendConnection||this.state!==$t.Connected)return void(t.length===0?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter(v=>!Ke(t).call(t,v)));const r=this.filterTobeUnpublishedTracks(t);if(r.length===0)return;this.unbindLocalTrackEvents(r.map(v=>{let[E,{track:y}]=v;return{type:E,track:y}}));const a=r.filter(v=>{let[,{id:E}]=v;return E!==void 0});if(!this.sendConnection||this.state!==$t.Connected)return void t.forEach(v=>{const E=this.pendingLocalTracks.indexOf(v);E!==-1&&this.pendingLocalTracks.splice(E,1)});const l=r.find(v=>v[0]==="videoLowTrack");l&&l[1].track.close();let u;const h=this.createGatewayUnpublishMessage(r);a.length>0&&(u=await this.sendConnection.stopSending(a.map(v=>{let[,{id:E}]=v;return E}))),this.withdrawLocalTracks(r),this.unbindLocalTrackEvents(r.map(v=>{let[E,{track:y}]=v;return{type:E,track:y}})),r.forEach(v=>{let[E]=v;this.statsCollector.removeLocalStats(E)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadUplinkStats();const f=this.createMuteMessage(r);return await me.all(f.map(async v=>{await ln(this,Je.RequestMuteLocal,[v])})),{sdp:u,unpubMsg:h}}async unpublishLowStream(){throw new be(G.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async doUnpublish(t){if(!this.sendConnection||this.state!==$t.Connected)return;const r=[];if(t!==Ue.AUDIO){const a=this.localTrackMap.get(we.LocalVideoTrack);(a==null?void 0:a.id)!==void 0&&r.push([we.LocalVideoTrack,a]);const l=this.localTrackMap.get(we.LocalVideoLowTrack);(l==null?void 0:l.id)!==void 0&&r.push([we.LocalVideoLowTrack,l]),this.statsCollector.removeLocalStats(we.LocalVideoTrack),this.statsCollector.removeLocalStats(we.LocalVideoLowTrack)}if(t!==Ue.VIDEO){const a=this.localTrackMap.get(we.LocalAudioTrack);(a==null?void 0:a.id)!==void 0&&r.push([we.LocalAudioTrack,a]),this.statsCollector.removeLocalStats(we.LocalAudioTrack)}if(r.length>0){const a=await this.sendConnection.stopSending(r.map(h=>{let[,f]=h;return f.id}));r.forEach(h=>{let[,f]=h;f.id=void 0,f.ssrcs=void 0});const l=await Ln(this,Je.RequestP2PUnPublish,{sdp:a,kind:t});await this.sendConnection.setDescription("local",l);const u=this.createMuteMessage(r);await me.all(u.map(async h=>{await ln(this,Je.RequestMuteLocal,[h])}))}}async subscribe(t,r,a,l){var u;if(!this.recvConnection||this.state!==$t.Connected)throw new be(G.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if((u=this.remoteUserMap.get(t))!==null&&u!==void 0&&u.has(r))return;const{track:h,mid:f,sdp:v}=await this.recvConnection.receive(r,a,l);r===Ue.AUDIO?(t._audioSSRC=l,t._audioTrack?t._audioTrack._updateOriginMediaStreamTrack(h):(t._audioTrack=new os(h,t.uid,t._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(t._audioTrack.getTrackId()))),this.bindRemoteTrackEvents(t,t._audioTrack)):(t._videoSSRC=l,t._videoTrack?t._videoTrack._updateOriginMediaStreamTrack(h):(t._videoTrack=new yc(h,t.uid,t._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(t._videoTrack.getTrackId()))),this.bindRemoteTrackEvents(t,t._videoTrack));const E=this.remoteUserMap.get(t);E?E.set(r,f):this.remoteUserMap.set(t,new Map([[r,f]])),this.statsCollector.addRemoteStats(t.uid),this.statsUploader.startUploadDownlinkStats(),await ln(this,Je.RequestP2PUnmuteRemote,r);const y=this.pendingRemoteTracks.findIndex(C=>{let{user:I,kind:k}=C;return I.uid===t.uid&&r===k});return y!==-1&&(this.pendingRemoteTracks.splice(y,1),this.emit(Je.MediaReconnectEnd,t.uid)),v}async unsubscribe(t,r,a,l){const u=this.pendingRemoteTracks.filter(v=>{let{user:E,kind:y}=v;return a!==void 0?E.uid===t.uid&&a===y:E.uid===t.uid});if(u.forEach(v=>{const E=this.pendingRemoteTracks.indexOf(v);this.pendingRemoteTracks.splice(E,1)}),this.recvConnection&&this.state===$t.Connected||l||u.forEach(v=>{let{kind:E}=v;var y;if(E===Ue.AUDIO)(y=t._audioTrack)===null||y===void 0||y._destroy(),t._audioTrack=void 0;else if(E===Ue.VIDEO){var C;(C=t._videoTrack)===null||C===void 0||C._destroy(),t._videoTrack=void 0}}),!this.recvConnection||this.state!==$t.Connected)return;const h=this.filterTobeUnSubscribedTracks(t,a);if(h.length===0)return void(a!==Ue.VIDEO&&ln(this,Je.RequestP2PMuteRemote,Ue.AUDIO));const f=await this.recvConnection.stopReceiving(h.map(v=>{let[,{id:E}]=v;return E}),r);return this.withdrawRemoteTracks(h),this.remoteUserMap.size===0&&this.statsUploader.stopUploadDownlinkStats(),h.forEach(v=>{let[E,{kind:y}]=v;var C,I;if(y===Ue.VIDEO&&E._videoSSRC&&((C=this.recvConnection)===null||C===void 0||C.setStatsRemoteVideoIsReady(E._videoSSRC,!1)),y===Ue.VIDEO)this.unbindRemoteTrackEvents(E._videoTrack),l||((I=E._videoTrack)===null||I===void 0||I._destroy(),E._videoTrack=void 0);else if(y===Ue.AUDIO){var k;this.unbindRemoteTrackEvents(E._audioTrack),!l&&((k=E._audioTrack)===null||k===void 0||k._destroy(),E._audioTrack=void 0)}}),h.filter(v=>{let[,{kind:E}]=v;return E!==Ue.AUDIO}).forEach(v=>{let[,{kind:E}]=v;ln(this,Je.RequestP2PMuteRemote,E)}),a!==Ue.VIDEO&&ln(this,Je.RequestP2PMuteRemote,Ue.AUDIO),f}getAllDataChannels(){return this.localDataChannels}async massSubscribe(t){throw new be(G.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(t){throw new be(G.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(t){throw new be(G.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(t){throw new be(G.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(t,r){if(!this.recvConnection)return;const a=this.remoteUserMap.get(t);if(!a)return void L.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(t.uid,"."));if(!a.get(r))return void L.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(t.uid," media type ").concat(r,"."));const l=r===Ue.VIDEO?t._videoSSRC:t._audioSSRC;l!==void 0&&this.recvConnection.setStatsRemoteVideoIsReady(l,!1)}async unmuteRemote(t,r){return this.unmuteRemoteNoLock(t,r)}async unmuteRemoteNoLock(t,r){if(!this.recvConnection)return;const a=this.remoteUserMap.get(t);if(!a)return void L.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(t.uid,"."));a.get(r)||L.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(t.uid," media type ").concat(r,"."))}getAllTracks(t){const r=this.localTrackMap.get(we.LocalAudioTrack);if((r==null?void 0:r.track)instanceof cr){const a=r.track;return Array.from(this.localTrackMap.entries()).filter(l=>{let[u]=l;return u!==we.LocalAudioTrack}).filter(l=>{let[u]=l;return!(t&&u===we.LocalVideoLowTrack)}).map(l=>{let[,{track:u}]=l;return u}).concat(a.trackList)}return Array.from(this.localTrackMap.entries()).filter(a=>{let[l]=a;return!(t&&l===we.LocalVideoLowTrack)}).map(a=>{let[,{track:l}]=a;return l})}reportPublishEvent(t,r,a,l,u){if(t){const f=this.localTrackMap.get(we.LocalAudioTrack),v=l?this.localTrackMap.get(we.LocalVideoLowTrack):this.localTrackMap.get(we.LocalVideoTrack);He.publish(this.store.sessionId,{eventElapse:fi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:t,ec:r,audioName:f==null?void 0:f.track.getTrackLabel(),videoName:v==null?void 0:v.track.getTrackLabel(),screenshare:(v==null?void 0:v.track._hints.indexOf(vn.SCREEN_TRACK))!==-1,audio:!!f,video:!!v,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:u})}else{var h;a||(a=[]);const f=a.find(E=>E instanceof en),v=l?(h=this.localTrackMap.get(we.LocalVideoTrack))===null||h===void 0?void 0:h.track:a.find(E=>E instanceof bt);He.publish(this.store.sessionId,{eventElapse:fi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:t,ec:r,audioName:f==null?void 0:f.getTrackLabel(),videoName:v==null?void 0:v.getTrackLabel(),screenshare:(v==null?void 0:v._hints.indexOf(vn.SCREEN_TRACK))!==-1,audio:!!f,video:!!v,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:u})}}reportSubscribeEvent(t,r,a,l){const u=l===Ue.VIDEO?a._videoSSRC:a._audioSSRC;u&&He.subscribe(this.store.sessionId,{succ:t,ec:r,video:l===Ue.VIDEO,audio:l===Ue.AUDIO,peerid:a.uid,subscribeRequestid:l===Ue.VIDEO?a._videoSSRC:a._audioSSRC,p2pid:this.store.p2pId,eventElapse:fi.measureFromSubscribeStart(this.store.clientId,u)})}reset(){L.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new Mr("P2PChannel2-send-mutex"),this.sendMutex=new Mr("P2PChannel2-recv-mutex"),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const t=this.localTrackMap.get(we.LocalAudioTrack);if((t==null?void 0:t.track)instanceof cr){if(t.track.trackList.length>0){const r=t.track;t.track.trackList.forEach(a=>{r.removeAudioTrack(a)})}t.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.state=$t.Disconnected}getStats(t){var r,a;return t?(a=this.recvConnection)===null||a===void 0?void 0:a.getStats():(r=this.sendConnection)===null||r===void 0?void 0:r.getStats()}getRemoteVideoIsReady(t){var r;return((r=this.recvConnection)===null||r===void 0?void 0:r.getRemoteVideoIsReady(t))||!1}getLocalAudioVolume(){const t=this.localTrackMap.get(we.LocalAudioTrack);if(t)return t.track.getVolumeLevel()}getLocalVideoSize(){const t=this.localTrackMap.get(we.LocalVideoTrack);if(t)return{width:t.track._videoWidth||0,height:t.track._videoHeight||0}}getEncoderConfig(t){const r=this.localTrackMap.get(t);return r&&r.track instanceof bt||r&&r.track instanceof en?r.track._encoderConfig:void 0}getLocalMedia(t){return this.localTrackMap.get(t)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(t,r){if(!t)return this.remoteUserMap.size>0;const a=this.remoteUserMap.get(t);return!!a&&(!r||a.has(r))}async hasRemoteMediaWithLock(t,r){if(!t)return this.remoteUserMap.size>0;const a=this.remoteUserMap.get(t);return!!a&&(!r||a.has(r))}getRemoteMedia(t){var r;const a=Array.from(Xo(r=this.remoteUserMap).call(r)).find(l=>l.uid===t);return a?{audioTrack:a.audioTrack,audioSSRC:a._audioSSRC,videoTrack:a.videoTrack,videoSSRC:a._videoSSRC}:{}}getAudioLevels(){let t=Array.from(this.remoteUserMap.entries()).map(a=>{let[l]=a;return{uid:l.uid,level:l.audioTrack?100*l.audioTrack._source.getAccurateVolumeLevel():0}});const r=this.localTrackMap.get(we.LocalAudioTrack);return r&&t.push({level:100*r.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),t=Nf(t).call(t,(a,l)=>a.level-l.level),t}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(L.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=$t.Reconnecting,Z("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(t=>{let[r]=t;var a;r._videoTrack&&r._videoTrack._player&&((a=r._videoTrack._player.getVideoElement())===null||a===void 0||a.pause(),r._videoTrack._player.isKeepLastFrame=!0,r._videoTrack._originMediaStreamTrack.stop())}),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(t=>{var r;let[a,{track:l}]=t;switch(a){case we.LocalVideoTrack:Ke(r=l._hints).call(r,vn.LOW_STREAM)?l.close():this.pendingLocalTracks.push(l);break;case we.LocalAudioTrack:l instanceof cr?this.pendingLocalTracks=this.pendingLocalTracks.concat(l.trackList):this.pendingLocalTracks.push(l);case we.LocalVideoLowTrack:}}),this.emit(Je.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(t=>{let[r,a]=t;Array.from(Xo(a).call(a)).forEach(l=>{this.setPendingRemoteMedia(r,l)}),this.emit(Je.MediaReconnectStart,r.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),L.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(t,r){for(const a of this.pendingRemoteTracks){const{user:l,kind:u}=a;if((t instanceof mi?t.uid:t)===l.uid&&r===u)return!0}return!1}setPendingRemoteMedia(t,r){this.hasPendingRemoteMedia(t,r)||this.pendingRemoteTracks.push({user:t,kind:r})}async restartICE(t){let r;r=t.direction===Nh.SEND_ONLY?await this.sendMutex.lock("From P2PChannel.restartICE"):await this.recvMutex.lock("From P2PChannel.restartICE");try{const a=await t.restartICE(),l=await Ln(this,Je.RequestP2PRestartICE,a);t.setDescription("local",l)}finally{r()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const t=this.sendConnection.getStats(),r=this.localTrackMap.get(we.LocalVideoTrack),a=this.localTrackMap.get(we.LocalAudioTrack),l=t.videoSend.find(W=>{var $;return W.ssrc===(r==null||($=r.ssrcs)===null||$===void 0?void 0:$[0].ssrcId)}),u=t.audioSend.find(W=>{var $;return W.ssrc===(a==null||($=a.ssrcs)===null||$===void 0?void 0:$[0].ssrcId)});if(!l||!u)return 1;const h=mo(this,Je.NeedSignalRTT),f=l?l.rttMs:void 0,v=u?u.rttMs:void 0,E=f&&v?(f+v)/2:f||v,y=(E&&h?(E+h)/2:E||h)||0,C=100*t.sendPacketLossRate*.7/50+.3*y/1500,I=C<.17?1:C<.36?2:C<.59?3:C<.1?4:5,k=r==null?void 0:r.track;if(k&&k._encoderConfig&&k._hints.indexOf(vn.SCREEN_TRACK)===-1){const W=k._encoderConfig.bitrateMax,$=t.bitrate.actualEncoded;if(W&&$){const z=(1e3*W-$)/(1e3*W);return rL[z<.15?0:z<.3?1:z<.45?2:z<.6?3:4][I]}}return I}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const t=this.recvConnection.getStats();let r=0;return Array.from(this.remoteUserMap.entries()).forEach(a=>{let[l]=a;const u=l._audioSSRC,h=l._videoSSRC,f=t.audioRecv.find($=>$.ssrc===u),v=t.videoRecv.find($=>$.ssrc===h);if(!f&&!v)return void(r+=1);const E=mo(this,Je.NeedSignalRTT),y=t.rtt,C=(y&&E?(y+E)/2:y||E)||0,I=f?f.jitterMs:void 0,k=t.recvPacketLossRate;let W=.7*k*100/50+.3*C/1500;I&&(W=.6*k*100/50+.2*C/1500+.2*I/400),r+=W<.1?1:W<.17?2:W<.36?3:W<.59?4:5}),this.remoteUserMap.size>0?Math.round(r/this.remoteUserMap.size):r}async muteLocalTrack(t){return new me((r,a)=>{this.handleMuteLocalTrack(t,r,a)})}filterTobePublishedTracks(t,r,a){const l=[],u=fn(),h=this.getAllTracks();t=Th(t=t.filter(E=>h.indexOf(E)===-1));let f=!1,v=!1;for(const E of t){if(E instanceof bt&&(this.localTrackMap.has(we.LocalVideoTrack)||f?new be(G.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(l.push({track:E,type:we.LocalVideoTrack}),f=!0),r)){const y=this.getLowVideoTrack(E,a);l.push({track:y,type:we.LocalVideoLowTrack})}if(E instanceof en){const y=this.localTrackMap.get(we.LocalAudioTrack);if(y){if(!(y.track instanceof cr))throw new be(G.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(E._bypassWebAudio)throw new be(G.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");y.track.addAudioTrack(E),this.bindLocalAudioTrackEvents(E,!0)}else if(v){const C=l.find(I=>{let{type:k}=I;return k===we.LocalAudioTrack});if(!(C.track instanceof cr))throw new be(G.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(E._bypassWebAudio)throw new be(G.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");C.track.addAudioTrack(E)}else{if(!u.webAudioMediaStreamDest||E instanceof cr||E._bypassWebAudio)l.push({track:E,type:we.LocalAudioTrack});else{const C=new cr;C.addAudioTrack(E),l.push({track:C,type:we.LocalAudioTrack})}v=!0}}}return l}filterTobeUnpublishedTracks(t){const r=[],a=this.getAllTracks();t=Th(t=t.filter(l=>a.indexOf(l)!==-1));for(const l of t){if(l instanceof en){const u=this.localTrackMap.get(we.LocalAudioTrack);if(!u)continue;u.track instanceof cr?(u.track.removeAudioTrack(l),this.unbindLocalAudioTrackEvents(l),u.track.trackList.length===0&&(r.push([we.LocalAudioTrack,u]),u.track.close())):r.push([we.LocalAudioTrack,u])}if(l instanceof bt){const u=this.localTrackMap.get(we.LocalVideoTrack);if(!u)continue;r.push([we.LocalVideoTrack,u]);const h=this.localTrackMap.get(we.LocalVideoLowTrack);h&&r.push([we.LocalVideoLowTrack,h])}}return r}bindLocalTrackEvents(t){t.forEach(r=>{let{track:a,type:l}=r;switch(l){case we.LocalVideoTrack:a.addListener(Fe.GET_STATS,this.handleGetLocalVideoStats),a.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.addListener(Fe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),a.addListener(Fe.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),a.addListener(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),a.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case we.LocalAudioTrack:this.bindLocalAudioTrackEvents(a);case we.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(t,r){t instanceof cr?t.trackList.forEach(a=>{a.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.addListener(Fe.GET_STATS,this.handleGetLocalAudioStats),a.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(t.addListener(Fe.GET_STATS,this.handleGetLocalAudioStats),t.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),r||t.addListener(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(t){t||(t=Array.from(this.localTrackMap.entries()).map(r=>{let[a,{track:l}]=r;return{track:l,type:a}})),t.forEach(r=>{let{track:a,type:l}=r;switch(l){case we.LocalVideoTrack:a.off(Fe.GET_STATS,this.handleGetLocalVideoStats),a.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.off(Fe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),a.off(Fe.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),a.off(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),a.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case we.LocalAudioTrack:this.unbindLocalAudioTrackEvents(a);case we.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(t){t instanceof cr?t.trackList.forEach(r=>{r.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(Fe.GET_STATS,this.handleGetLocalAudioStats),r.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(t.off(Fe.GET_STATS,this.handleGetLocalAudioStats),t.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(t,r){r instanceof yc&&r.addListener(Fe.GET_STATS,a=>{a(this.handleGetRemoteVideoStats(t))}),r instanceof os&&r.addListener(Fe.GET_STATS,a=>{a(this.handleGetRemoteAudioStats(t))})}unbindRemoteTrackEvents(t){t&&t.removeAllListeners(Fe.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(t=>{let[r,a]=t;a.has(Ue.AUDIO)&&this.unbindRemoteTrackEvents(r._audioTrack),a.has(Ue.VIDEO)&&this.unbindRemoteTrackEvents(r._videoTrack)})}createGatewayPublishMessage(t){return t.map(r=>{var a;let l,u,{track:h,type:f}=r;switch(f){case we.LocalAudioTrack:l=rn.Audio,u={dtx:h instanceof Wl&&h._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case we.LocalVideoTrack:l=Ke(a=h._hints).call(a,vn.SCREEN_TRACK)?rn.Screen:rn.High,u=ru(ru({},Vv(h)),{},{codec:this.store.codec});break;case we.LocalVideoLowTrack:l=rn.Low,u=ru(ru({},Vv(h)),{},{codec:this.store.codec})}return{kind:f===we.LocalAudioTrack?Ue.AUDIO:Ue.VIDEO,stream_type:l,attributes:u,isMuted:h.muted||!h.enabled}})}createGatewayUnpublishMessage(t){return t.map(r=>{var a;let l,[u,{track:h,ssrcs:f,id:v}]=r;switch(u){case we.LocalVideoTrack:l=Ke(a=h._hints).call(a,vn.SCREEN_TRACK)?rn.Screen:rn.High;break;case we.LocalAudioTrack:l=rn.Audio;break;case we.LocalVideoLowTrack:l=rn.Low}return{stream_type:l,ssrcs:f,mid:v}})}assignLocalTracks(t){t.forEach(r=>{let{track:a,type:l}=r;this.localTrackMap.set(l,{track:a})})}withdrawLocalTracks(t){t.forEach(r=>{let[a]=r;this.localTrackMap.delete(a)})}bindConnectionEvents(t){t.onConnectionStateChange=async r=>{var a;if(L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(r,")")),this.emit(Je.PeerConnectionStateChange,r),r!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),Ke(a=this._restartStates).call(a,r)||t.direction===Nh.SEND_ONLY){if(this._restartTimer)return;const l=()=>{(t.iceConnectionState==="disconnected"||t.iceConnectionState==="checking"||t.iceConnectionState==="failed")&&(L.debug("[".concat(this.store.clientId,"] [P2PChannel] start use restartICE")),mo(this,Je.QueryClientConnectionState)==="CONNECTED"&&this.restartICE(t))};this._restartTimer=window.setTimeout(()=>{l(),this._restartTimer=void 0},800)}},t.onICEConnectionStateChange=r=>{r!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(r,")")),He.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:r,tag:Dn.TRACER}).onSuccess(),this.emit(Je.IceConnectionStateChange,r)},t.onICETransportStateChange=r=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(r,")"))},t.onDTLSTransportStateChange=r=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(r,")"))},t.onDTLSTransportError=r=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(r,")"))},t.onFirstAudioDecoded=r=>{var a;const l=Array.from(Xo(a=this.remoteUserMap).call(a)).find(h=>h._audioSSRC===r);var u;l&&(this.store.subscribe(l.uid,"audio",void 0,void 0,void 0,Date.now()),(u=l.audioTrack)===null||u===void 0||u.emit(id.FIRST_FRAME_DECODED),He.firstRemoteFrame(this.store.sessionId,Ar.FIRST_AUDIO_DECODE,On.FIRST_AUDIO_DECODE,{peer:l._uintid,subscribeElapse:fi.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId}))},t.onFirstAudioReceived=r=>{var a;const l=Array.from(Xo(a=this.remoteUserMap).call(a)).find(u=>u._audioSSRC===r);l&&He.firstRemoteFrame(this.store.sessionId,Ar.FIRST_AUDIO_RECEIVED,On.FIRST_AUDIO_RECEIVED,{peer:l._uintid,subscribeElapse:fi.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId})},t.onFirstVideoDecoded=(r,a,l)=>{this.reportVideoFirstFrameDecoded(r,a,l)},t.onFirstVideoReceived=r=>{var a;const l=Array.from(Xo(a=this.remoteUserMap).call(a)).find(u=>u._videoSSRC===r);l&&He.firstRemoteFrame(this.store.sessionId,Ar.FIRST_VIDEO_RECEIVED,On.FIRST_VIDEO_RECEIVED,{peer:l._uintid,subscribeElapse:fi.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId})},t.onSelectedLocalCandidateChanged=(r,a)=>{const l=r.candidateType==="relay",u=a.candidateType==="relay";a.candidateType!=="unknown"&&l===u||this.emit(Je.ConnectionTypeChange,l),L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(Jl(a))," -> ").concat(JSON.stringify(Jl(r)),")"))},t.onSelectedRemoteCandidateChanged=(r,a)=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(Jl(a))," -> ").concat(JSON.stringify(Jl(r)),")"))},t.onFirstVideoDecodedTimeout=r=>{this.reportVideoFirstFrameDecoded(r,void 0,void 0,!0)},t.onLocalCandidate=r=>{this.emit(Je.LocalCandidate,r)}}unbindConnectionEvents(t){t.onConnectionStateChange=void 0,t.onICEConnectionStateChange=void 0,t.onICETransportStateChange=void 0,t.onDTLSTransportStateChange=void 0,t.onDTLSTransportError=void 0,t.onFirstAudioDecoded=void 0,t.onFirstAudioReceived=void 0,t.onFirstVideoDecoded=void 0,t.onFirstVideoReceived=void 0,t.onSelectedLocalCandidateChanged=void 0,t.onSelectedRemoteCandidateChanged=void 0,t.onFirstVideoDecodedTimeout=void 0,t.onLocalCandidate=void 0}filterTobeMutedTracks(t){const r=[];if(this.getAllTracks().indexOf(t)===-1)return r;const a=this.localTrackMap.get(we.LocalAudioTrack);if(t instanceof en&&(a==null?void 0:a.track)instanceof cr)return a.track.isActive||r.push([we.LocalAudioTrack,a]),r;const l=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:h}]=u;return t===h});if(l&&(r.push(l),l[0]===we.LocalVideoTrack)){const u=this.localTrackMap.get(we.LocalVideoLowTrack);u&&r.push([we.LocalVideoLowTrack,u])}return r}filterTobeUnmutedTracks(t){const r=[],a=this.localTrackMap.get(we.LocalAudioTrack);if(t instanceof en&&(a==null?void 0:a.track)instanceof cr)return a.track.isActive&&r.push([we.LocalAudioTrack,a]),r;const l=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:h}]=u;return t===h});if(l)if(l[0]===we.LocalVideoTrack){r.push(l);const u=this.localTrackMap.get(we.LocalVideoLowTrack);u&&r.push([we.LocalVideoLowTrack,u])}else r.push(l);return r}createMuteMessage(t){return t.map(r=>{var a;let l,[u,{track:h,ssrcs:f,id:v}]=r;switch(u){case we.LocalAudioTrack:l=rn.Audio;break;case we.LocalVideoTrack:l=Ke(a=h._hints).call(a,vn.SCREEN_TRACK)?rn.Screen:rn.High;break;case we.LocalVideoLowTrack:l=rn.Low}return{stream_type:l,ssrcs:f,mid:v}})}createUnmuteMessage(t){return t.map(r=>{var a;let l,[u,{track:h,ssrcs:f,id:v}]=r;switch(u){case we.LocalAudioTrack:l=rn.Audio;break;case we.LocalVideoTrack:l=Ke(a=h._hints).call(a,vn.SCREEN_TRACK)?rn.Screen:rn.High;break;case we.LocalVideoLowTrack:l=rn.Low}return{stream_type:l,ssrcs:f,mid:v}})}filterTobeUnSubscribedTracks(t,r){const a=[],l=this.remoteUserMap.get(t);if(!l)return a;if(r){const u=l.get(r);if(!u)return a;a.push([t,{kind:r,id:u}])}else Array.from(l.entries()).forEach(u=>{let[h,f]=u;a.push([t,{kind:h,id:f}])});return a}createUnsubscribeMessage(t){const r=[];return t.forEach(a=>{let[l,{kind:u,id:h}]=a;switch(u){case Ue.VIDEO:return void(l._videoSSRC&&r.push({stream_type:Ue.VIDEO,ssrcId:l._videoSSRC}));case Ue.AUDIO:return void(l._audioSSRC&&r.push({stream_type:Ue.AUDIO,ssrcId:l._audioSSRC}))}}),r}withdrawRemoteTracks(t){t.forEach(r=>{let[a,{kind:l}]=r;const u=this.remoteUserMap.get(a);u&&(u.delete(l),Array.from(u.entries()).length===0&&this.remoteUserMap.delete(a))})}async updateBitrateLimit(t){const r=this.localTrackMap.get(we.LocalVideoTrack),a=this.localTrackMap.get(we.LocalVideoLowTrack);r&&await r.track.setBitrateLimit(t.uplink),a&&t.low_stream_uplink&&await a.track.setBitrateLimit({max_bitrate:t.low_stream_uplink.bitrate,min_bitrate:t.low_stream_uplink.bitrate||0})}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const t=this.sendConnection.peerConnectionState,r=this.recvConnection.peerConnectionState;return t!=="connected"&&r!=="connected"}return!0}async tryToUnmuteAudio(t){for(let r=0;r<t.length;r++)if(t[r]instanceof en){const a=this.filterTobeUnmutedTracks(t[r]);if(a.length===0)continue;const l=this.createUnmuteMessage(a);return void await ln(this,Je.RequestUnmuteLocal,l)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=t=>this.getStats(t),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter(t=>{let[,{ssrcs:r}]=t;return!!r}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=t=>{var r;return!((r=this.recvConnection)===null||r===void 0||!r.getRemoteVideoIsReady(t))},this.statsUploader.requestUpload=(t,r)=>this.emit(Je.RequestUploadStats,t,r),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await ni(Zg(this.dtlsFailedCount,sr)),this.emit(Je.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(we.LocalVideoTrack)||this.pendingLocalTracks.some(t=>t instanceof bt)}throwIfTrackTypeNotMatch(t){if(t.filter(r=>r instanceof bt).length>1)throw new be(G.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t.filter(r=>r instanceof en).length>1&&(t.some(r=>r instanceof en&&r._bypassWebAudio)||!fn().webAudioMediaStreamDest))throw new be(G.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const r of t){if(r instanceof bt&&this.pendingLocalTracks.some(a=>a instanceof bt))throw new be(G.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(r instanceof en&&this.pendingLocalTracks.some(a=>a instanceof en)&&(!fn().webAudioMediaStreamDest||r._bypassWebAudio||this.pendingLocalTracks.some(a=>a instanceof en&&a._bypassWebAudio)))throw new be(G.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(t,r){const a=!Z("DISABLE_DUAL_STREAM_USE_ENCODING")&&fn().supportDualStreamEncoding,l=ru(ru({},{width:160,height:120,framerate:15,bitrate:50}),r);let u;u=a?t._mediaStreamTrack.clone():hR(t,l);const h=un(8,"track-low-"),f=new bt(u,ru(ru({},a&&{scaleResolutionDownBy:YT(l,t)}),{},{frameRate:l.framerate,bitrateMax:l.bitrate,bitrateMin:l.bitrate}),void 0,void 0,h);return f.on(Lh.TRANSCEIVER_UPDATED,v=>{t._updateRtpTransceiver(v,$l.LOW_STREAM)}),f._hints.push(vn.LOW_STREAM),t.addListener(Fe.NEED_CLOSE,()=>{f.close()}),f}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(t,r,a,l){var u;const h=Array.from(Xo(u=this.remoteUserMap).call(u)).find(f=>f._videoSSRC===t);if(h){l||this.store.subscribe(h.uid,"video",void 0,void 0,void 0,void 0,Date.now());const f=this.store.keyMetrics,v=f.subscribe.find(E=>E.userId===h.uid&&E.type==="video");He.firstRemoteVideoDecode(this.store.sessionId,Ar.FIRST_VIDEO_DECODE,On.FIRST_VIDEO_DECODE,{peer:h._uintid,videowidth:r,videoheight:a,subscribeElapse:fi.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId,apEnd:f.requestAPEnd||0,apStart:f.requestAPStart||0,joinGwEnd:f.joinGatewayEnd||0,joinGwStart:f.joinGatewayStart||0,pcEnd:f.peerConnectionEnd||0,pcStart:f.peerConnectionStart||0,subscriberEnd:(v==null?void 0:v.subscribeEnd)||0,subscriberStart:(v==null?void 0:v.subscribeStart)||0,videoAddNotify:(v==null?void 0:v.streamAdded)||0,state:l?1:0})}}async remoteMediaSsrcChanged(t,r,a){if(!this.recvConnection)return!1;const l=this.remoteUserMap.get(t);if(!l)return!1;const u=l.get(r);if(!u)return!1;const h=await this.recvConnection.getRemoteSSRC(u);return h!==void 0&&h!==a}resetConnection(t){L.debug("[".concat(this.store.clientId,"] [P2PChannel2] reset connection to ").concat(t)),this.state===$t.Connected?(L.debug("[".concat(this.store.clientId,"] [P2PChannel2] fallback to websocket but P2PChannel2 state still connected, disconnect first")),this.disconnectForReconnect()):(this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0))}async publishDataChannel(t){throw new be(G.NOT_SUPPORTED)}async unpublishDataChannel(t){throw new be(G.NOT_SUPPORTED)}async subscribeDataChannel(t,r){throw new be(G.NOT_SUPPORTED)}async unsubscribeDataChannel(t,r){throw new be(G.NOT_SUPPORTED)}hasPendingRemoteDataChannel(t,r){throw new be(G.NOT_SUPPORTED)}setPendingRemoteDataChannel(t,r){throw new be(G.NOT_SUPPORTED)}async preConnect(t,r,a,l,u,h){throw new be(G.NOT_SUPPORTED)}getEstablishParams(){throw new be(G.NOT_SUPPORTED)}async reSubscribe(t){throw new be(G.NOT_SUPPORTED)}async updateVideoStreamParameter(t,r){throw new be(G.NOT_SUPPORTED)}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(t=>{let[r,{track:a}]=t;r===we.LocalVideoLowTrack?a._updateRtpTransceiver(void 0,$l.LOW_STREAM):a._updateRtpTransceiver(void 0)})}}function La(i){return function(t,r,a){const l=t[r];if(typeof l!="function")throw new Error("Cannot use mutex on object property.");return a.value=async function(){for(var u=arguments.length,h=new Array(u),f=0;f<u;f++)h[f]=arguments[f];switch(i){case ka.SEND_ONLY:{const v=await this.sendMutex.lock("From P2PChannel2.".concat(r));try{return await l.apply(this,h)}finally{v()}}case ka.RECEIVE_ONLY:{const v=await this.recvMutex.lock("From P2PChannel2.".concat(r));try{return await l.apply(this,h)}finally{v()}}default:{const v=await this.sendMutex.lock("From P2PChannel2.".concat(r)),E=await this.recvMutex.lock("From P2PChannel2.".concat(r));try{return await l.apply(this,h)}finally{v(),E()}}}},a}}function SU(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function CU(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SU(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):SU(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}Te([La(),V("design:type",Function),V("design:paramtypes",[Object,String]),V("design:returntype",me)],Un.prototype,"startP2P",null),Te([La(),V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],Un.prototype,"p2pConnect",null),Te([La(ka.SEND_ONLY),V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],Un.prototype,"dopublish",null),Te([La(ka.SEND_ONLY),V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],Un.prototype,"unpublish",null),Te([La(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",me)],Un.prototype,"unpublishLowStream",null),Te([La(ka.SEND_ONLY),V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],Un.prototype,"doUnpublish",null),Te([La(ka.RECEIVE_ONLY),V("design:type",Function),V("design:paramtypes",[mi,String,String,Number]),V("design:returntype",me)],Un.prototype,"subscribe",null),Te([La(ka.RECEIVE_ONLY),V("design:type",Function),V("design:paramtypes",[mi,String,String,Boolean]),V("design:returntype",me)],Un.prototype,"unsubscribe",null),Te([La(ka.RECEIVE_ONLY),V("design:type",Function),V("design:paramtypes",[mi,String]),V("design:returntype",me)],Un.prototype,"muteRemote",null),Te([La(ka.RECEIVE_ONLY),V("design:type",Function),V("design:paramtypes",[mi,String]),V("design:returntype",me)],Un.prototype,"unmuteRemote",null),Te([La(ka.RECEIVE_ONLY),V("design:type",Function),V("design:paramtypes",[mi,String]),V("design:returntype",me)],Un.prototype,"hasRemoteMediaWithLock",null),Te([La(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",me)],Un.prototype,"disconnectForReconnect",null),Te([La(ka.RECEIVE_ONLY),V("design:type",Function),V("design:paramtypes",[mi,String,Number]),V("design:returntype",me)],Un.prototype,"remoteMediaSsrcChanged",null);const Lne=Date.now(),Mne=20,bR=new Map,lE=new Map;async function bU(i){const t=bR.get(i),r=Array.isArray(t)&&t[t.length-1],a=lE.get(i);if(!r)return void(a.isSyncing=!1);const l={uid:r.uid,payload:Yg(r.payload)};a.firstRecvTs===0&&(a.firstRecvTs=r.recvTs,a.firstSendTs=r.sendTs);const u=r.sendTs-a.firstSendTs,h=u-(Date.now()-a.firstRecvTs);h>0&&(a.firstRecvTs=Date.now()-u);let f=r.mediaDelay+h;f<=0?(t.pop(),TU(r.context,l),f=0):f=Math.min(f,Mne),setTimeout(()=>t.length&&bU(i),f)}function TU(i,t){i.safeEmit(At.STREAM_MESSAGE,t.uid,t.payload),i.onStreamMessage&&i.onStreamMessage(t)}function Fne(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if(!i.syncWithAudio)return TU(r,{uid:i.uid,payload:Yg(i.payload)});const a="".concat(r.id,"-").concat(i.uid),l=bR.get(a)||[],u=l.findIndex(E=>i.sendTs>=E.sendTs),h=CU(CU({},i),{},{context:r,mediaDelay:t,recvTs:Date.now()});u===-1?l.push(h):l.splice(u,0,h),bR.set(a,l);let f=!1;var v;lE.has(a)?f=!((v=lE.get(a))===null||v===void 0||!v.isSyncing):lE.set(a,{isSyncing:f,firstRecvTs:0,firstSendTs:0}),f||bU(a)}const Une=Wt().name;function Bne(){return!function(i,t,r){const a=Wt();if(a.os!==Rr.IOS||!a.osVersion)return!1;const l=a.osVersion.split(".");return r?t&&Number(l[0])===i&&Number(l[1])<t||Number(l[0])<i:t?Number(l[0])===i&&Number(l[1])<=t||Number(l[0])<i:Number(l[0])<=i}(16,0,!0)&&!function(i,t,r){const a=Wt();if(a.name!==Zt.SAFARI||!a.osVersion)return!1;const l=a.version.split(".");return r?t&&Number(l[0])===i&&Number(l[1])<t||Number(l[0])<i:t?Number(l[0])===i&&Number(l[1])<=t||Number(l[0])<i:Number(l[0])<=i}(16,0,!0)}function RU(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function S0(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RU(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):RU(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}Mr.setLogger(L);class dn extends An{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var t;return((t=this._config)===null||t===void 0?void 0:t.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(t){let r;if(super(),w(this,"store",void 0),w(this,"_uid",void 0),w(this,"_channelName",void 0),w(this,"_uintUid",void 0),w(this,"_users",[]),w(this,"_config",void 0),w(this,"_clientId",void 0),w(this,"_appId",void 0),w(this,"_sessionId",null),w(this,"_key",void 0),w(this,"_joinInfo",void 0),w(this,"_gateway",void 0),w(this,"_statsCollector",void 0),w(this,"_configDistribute",void 0),w(this,"_leaveMutex",new Mr("client-leave")),w(this,"_publishMutex",new Mr("client-publish")),w(this,"_renewTokenMutex",new Mr("client-renewtoken")),w(this,"_subscribeMutex",new Mr("client-subscribe")),w(this,"_encryptionMode","none"),w(this,"_encryptionSecret",null),w(this,"_encryptionSalt",null),w(this,"_proxyServer",void 0),w(this,"_turnServer",{servers:[],mode:"auto"}),w(this,"_cloudProxyServerMode","disabled"),w(this,"_isDualStreamEnabled",!1),w(this,"_defaultStreamFallbackType",void 0),w(this,"_lowStreamParameter",void 0),w(this,"_streamFallbackTypeCacheMap",new Map),w(this,"_remoteStreamTypeCacheMap",new Map),w(this,"_axiosCancelSource",go.CancelToken.source()),w(this,"_audioVolumeIndicationInterval",void 0),w(this,"_networkQualityInterval",void 0),w(this,"_userOfflineTimeout",void 0),w(this,"_streamRemovedTimeout",void 0),w(this,"_injectStreamingClient",void 0),w(this,"_liveTranscodeStreamingClient",void 0),w(this,"_liveRawStreamingClient",void 0),w(this,"_channelMediaRelayClient",void 0),w(this,"_networkQualitySensitivity","normal"),w(this,"_p2pChannel",void 0),w(this,"_useLocalAccessPoint",!1),w(this,"_setLocalAPVersion",void 0),w(this,"_joinAndNotLeaveYet",!1),w(this,"_numberOfJoinCount",0),w(this,"_remoteDefaultVideoStreamType",void 0),w(this,"_inspect",void 0),w(this,"_moderation",void 0),w(this,"_license",void 0),w(this,"_pendingPublishedUsers",[]),w(this,"ntpAlignErrorCount",0),w(this,"remoteInboundOffset",0),w(this,"_handleLocalTrackEnable",(a,l,u)=>{this.publish(a,!1).then(l).catch(u)}),w(this,"_handleLocalTrackDisable",(a,l,u)=>{this.unpublish(a).then(l).catch(u)}),w(this,"_handleUserOnline",a=>{if(Z("BLOCK_LOCAL_CLIENT")&&td(a.uid,this.channelName))return void L.debug("[".concat(a.uid,"] will be ignored in local"));this.isStringUID&&typeof a.uid!="string"&&L.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const l=this._users.find(u=>u.uid===a.uid);if(l)l._trust_in_room_=!0;else{const u=new mi(a.uid,a.uint_id||a.uid);this._users.push(u),L.debug("[".concat(this._clientId,"] user online"),a.uid),this.safeEmit(At.USER_JOINED,u)}}),w(this,"_handleUserOffline",a=>{if(Z("BLOCK_LOCAL_CLIENT")&&td(a.uid,this.channelName))return;const l=this._users.find(u=>u.uid===a.uid);l&&(this._handleRemoveStream(a),this._handleRemoveDataChannels(a),wb(this._users,l),this._remoteStreamTypeCacheMap.delete(l.uid),this._streamFallbackTypeCacheMap.delete(l.uid),L.debug("[".concat(this._clientId,"] user offline"),a.uid,"reason:",a.reason),this.safeEmit(At.USER_LEAVED,l,a.reason))}),w(this,"_handleAddAudioOrVideoStream",(a,l,u,h,f,v,E)=>{if(Z("BLOCK_LOCAL_CLIENT")&&td(l,this.channelName))return;const y=this._users.find(I=>I.uid===l);if(!y)return void L.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));L.debug("[".concat(this._clientId,"] stream added with uid ").concat(l,", type ").concat(a)),this.store.subscribe(y.uid,a,void 0,void 0,void 0,Date.now());const C=a==="audio"?y.hasAudio:y.hasVideo;y._uintid||(y._uintid=f||l),a==="audio"?y._trust_audio_stream_added_state_=!0:y._trust_video_stream_added_state_=!0,a==="audio"?(y._audio_added_=!0,u!==void 0&&(y._audioSSRC=u),h!==void 0&&(y._cname=h),v&&(y._audioOrtc=v)):(y._video_added_=!0,u!==void 0&&(y._videoSSRC=u),h!==void 0&&(y._cname=h),E!==void 0&&(y._rtxSsrcId=E),v&&(y._videoOrtc=v)),(a==="audio"?y.hasAudio:y.hasVideo)&&!C&&(L.info("[".concat(this._clientId,"] remote user ").concat(y.uid," published ").concat(a)),this.safeEmit(At.USER_PUBLISHED,y,a)),a==="video"?He.onGatewayStream(this._sessionId,Ar.ON_ADD_VIDEO_STREAM,On.ON_ADD_VIDEO_STREAM,{peer:f||l,ssrc:y._videoSSRC}):He.onGatewayStream(this._sessionId,Ar.ON_ADD_AUDIO_STREAM,On.ON_ADD_AUDIO_STREAM,{peer:f||l,ssrc:y._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(y,a,u).then(I=>{if(I&&(L.debug("[".concat(this._clientId,"] resubscribe ").concat(a," for user ").concat(y.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof Vr))return this._p2pChannel.unsubscribe(y,a,!0).then(()=>this._subscribe(y,a,!0).catch(k=>{L.error("[".concat(this._clientId,"] resubscribe error"),k.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(y,a)&&(L.debug("[".concat(this._clientId,"] resubscribe ").concat(a," for user ").concat(y.uid," after reconnect.")),this._subscribe(y,a,!0).catch(I=>{L.error("[".concat(this._clientId,"] resubscribe error"),I.toString())}))}),w(this,"_handleRemoveStream",(a,l,u)=>{if(Z("BLOCK_LOCAL_CLIENT")&&td(a.uid,this.channelName))return;const h=this._users.find(v=>v.uid===a.uid);if(!h)return void L.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));L.debug("[".concat(this._clientId,"] stream removed with uid ").concat(a.uid));let f=()=>{};if(h.hasAudio&&h.hasVideo?f=()=>{L.info("[".concat(this._clientId,"] remote user ").concat(h.uid," unpublished audio track")),this.safeEmit(At.USER_UNPUBLISHED,h,"audio"),L.info("[".concat(this._clientId,"] remote user ").concat(h.uid," unpublished video track")),this.safeEmit(At.USER_UNPUBLISHED,h,"video")}:h.hasVideo?f=()=>{L.info("[".concat(this._clientId,"] remote user ").concat(h.uid," unpublished video track")),this.safeEmit(At.USER_UNPUBLISHED,h,"video")}:h.hasAudio&&(f=()=>{L.info("[".concat(this._clientId,"] remote user ").concat(h.uid," unpublished audio track")),this.safeEmit(At.USER_UNPUBLISHED,h,"audio")}),h._trust_audio_stream_added_state_=!0,h._trust_video_stream_added_state_=!0,h._audio_added_=!1,h._video_added_=!1,this._p2pChannel instanceof Vr)this._p2pChannel.unsubscribe(h).then(v=>{if(v)return this._gateway.unsubscribe(v,h.uid)});else if(l&&u)if(a.sdp){const{sdp:v}=a;this._p2pChannel.unsubscribe(h,v).then(E=>{E&&l(E)}).catch(u)}else l&&l();h._audioSSRC=void 0,h._videoSSRC=void 0,h._audioOrtc=void 0,h._videoOrtc=void 0,h._rtxSsrcId=void 0,He.onGatewayStream(this._sessionId,Ar.ON_REMOVE_STREAM,On.ON_REMOVE_STREAM,{peer:a.uint_id||a.uid}),f()}),w(this,"_handleSetStreamLocalEnable",(a,l,u)=>{if(Z("BLOCK_LOCAL_CLIENT")&&td(l,this.channelName))return;const h=this._users.find(E=>E.uid===l);if(!h)return void L.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));L.debug("[".concat(this._clientId,"] local ").concat(a," ").concat(u?"enabled":"disabled"," with uid ").concat(l));const f=a==="audio"?h.hasAudio:h.hasVideo;if(a==="audio"){h._trust_audio_enabled_state_=!0;const E=h._audio_enabled_;if(h._audio_enabled_=u,h._audio_enabled_===E)return;{const y=h._audio_enabled_?"enable-local-audio":"disable-local-audio";L.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(l,", msg: ").concat(y)),this.safeEmit(At.USER_INFO_UPDATED,l,y)}}else{h._trust_video_enabled_state_=!0;const E=h._video_enabled_;if(h._video_enabled_=u,h._video_enabled_===E)return;{const y=h._video_enabled_?"enable-local-video":"disable-local-video";L.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(l,", msg: ").concat(y)),this.safeEmit(At.USER_INFO_UPDATED,l,y)}}const v=a==="audio"?h.hasAudio:h.hasVideo;return f!==v?!f&&v?(L.info("[".concat(this._clientId,"] remote user ").concat(l," published ").concat(a)),void this.safeEmit(At.USER_PUBLISHED,h,a)):(a==="video"&&h._videoTrack&&h._videoTrack._destroy(),a==="audio"&&h._audioTrack,this._p2pChannel.muteRemote(h,a),L.info("[".concat(this._clientId,"] remote user ").concat(l," unpublished ").concat(a)),void this.safeEmit(At.USER_UNPUBLISHED,h,a)):void 0}),w(this,"_handleMuteStream",(a,l,u,h,f,v)=>{if(Z("BLOCK_LOCAL_CLIENT")&&td(a,this.channelName))return;L.debug("[".concat(this._clientId,"] receive mute message"),a,l,u);const E=this._users.find(I=>I.uid===a);if(!E)return void L.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(a));const y=l==="audio"?E.hasAudio:E.hasVideo;if(l==="audio"){E._trust_audio_mute_state_=!0;const I=E._audio_muted_;if(E._audio_muted_=u,E._audio_muted_===I)return;{const k=E._audio_muted_?"mute-audio":"unmute-audio";L.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(a,", msg: ").concat(k)),this.safeEmit(At.USER_INFO_UPDATED,a,k)}}else{E._trust_video_mute_state_=!0;const I=E._video_muted_;if(E._video_muted_=u,E._video_muted_===I)return;{const k=E._video_muted_?"mute-video":"unmute-video";L.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(a,", msg: ").concat(k)),this.safeEmit(At.USER_INFO_UPDATED,a,k)}}const C=l==="audio"?E.hasAudio:E.hasVideo;if(y!==C){if(!y&&C)return!this.store.useP2P&&!(l==="audio"?E._audioSSRC:E._videoSSRC)?void L.warning("[".concat(this._clientId,"] remote user ").concat(a," receive ").concat(l," unmute message  before add stream message, ").concat(l," SSRC doesn't exist yet.")):(L.info("[".concat(this._clientId,"] remote user ").concat(a," published ").concat(l)),void this.safeEmit(At.USER_PUBLISHED,E,l));l==="video"&&E._videoTrack&&E._videoTrack._destroy(),l==="audio"&&E._audioTrack,f&&v&&this._p2pChannel instanceof Un&&(h?this._p2pChannel.unsubscribe(E,h,l).then(I=>{f(I)}).catch(v):f()),this._p2pChannel.muteRemote(E,l),L.info("[".concat(this._clientId,"] remote user ").concat(a," unpublished ").concat(l)),this.safeEmit(At.USER_UNPUBLISHED,E,l)}}),w(this,"_handleP2PLost",async a=>{L.debug("[".concat(this._clientId,"] receive p2p lost"),a),parseInt(a.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():L.warning("[".concat(this._clientId,"] P2PLost stream not found"),a)}),w(this,"_handleTokenWillExpire",()=>{L.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(At.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),w(this,"_handleBeforeUnload",a=>{a.type==="beforeunload"&&a.returnValue!==void 0&&a.returnValue!==""||(this.leave(),L.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),w(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.safeEmit(At.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const a={downlinkNetworkQuality:0,uplinkNetworkQuality:0};a.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),a.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(At.NETWORK_QUALITY,a)}),w(this,"_handleP2PAddAudioOrVideoStream",(a,l)=>{const u=this._users.find(f=>f.uid===l);if(!u)return void L.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));L.debug("[".concat(this._clientId,"] stream added with uid ").concat(l,", type ").concat(a)),this.store.subscribe(u.uid,a,void 0,void 0,void 0,Date.now());const h=a==="audio"?u.hasAudio:u.hasVideo;a==="audio"?u._trust_audio_stream_added_state_=!0:u._trust_video_stream_added_state_=!0,a==="audio"?u._audio_added_=!0:u._video_added_=!0,(a==="audio"?u.hasAudio:u.hasVideo)&&!h&&(L.info("[".concat(this._clientId,"] remote user ").concat(u.uid," published ").concat(a)),this.safeEmit(At.USER_PUBLISHED,u,a)),this._p2pChannel.hasPendingRemoteMedia(u,a)&&(L.debug("[".concat(this._clientId,"] resubscribe ").concat(a," for user ").concat(u.uid," after reconnect.")),this._subscribe(u,a,!0).catch(f=>{L.error("[".concat(this._clientId,"] resubscribe error"),f.toString())}))}),this._config=t,this._clientId=un(5,"client-"),this.store=new WZ(t.codec,t.audioCodec,t.mode,this._clientId),this.store.clientCreated(),t.proxyServer&&this.setProxyServer(t.proxyServer,!0),t.turnServer&&this.setTurnServer(t.turnServer,!0),L.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(Ra," build: ").concat(Xb,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),t.clientRoleOptions)try{Wk(t.clientRoleOptions),r=Object.assign({},t.clientRoleOptions)}catch(a){L.warning("[".concat(this._clientId,"] ").concat(a.toString()))}this._statsCollector=new zh(this.store),this._statsCollector.onStatsException=(a,l,u)=>{L.debug("[".concat(this._clientId,"] receive exception msg, code: ").concat(a,", msg: ").concat(l,", uid: ").concat(u)),this.safeEmit(At.EXCEPTION,{code:a,msg:l,uid:u})},this._statsCollector.onUploadPublishDuration=(a,l,u,h)=>{const f=this._users.find(v=>v.uid===a);f&&He.peerPublishStatus(this._sessionId,{subscribeElapse:h,audioPublishDuration:l,videoPublishDuration:u,peer:f._uintid})},this.store.useDataChannel=fn().supportDataChannel&&Z("SIGNAL_CHANNEL"),this.store.useP2P=Z("P2P"),this._gateway=new Kte(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:t.websocketRetryConfig||sr,httpRetryConfig:t.httpRetryConfig||sr,forceWaitGatewayResponse:t.forceWaitGatewayResponse===void 0||t.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:t.role,clientRoleOptions:r}),this._configDistribute=new nne,this.store.useP2P?(this._p2pChannel=new Un(this.store,this._statsCollector),this._handleP2PEvents()):this._p2pChannel=new Vr(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(t,r,a,l,u){let h=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],f=arguments.length>6&&arguments[6]!==void 0&&arguments[6];an("JOIN_GATEWAY_USE_443PORT_ONLY",h),an("JOIN_GATEWAY_USE_DUAL_DOMAIN",f);const v=this._gateway.signal.websocket;return v instanceof qf&&(v.use443PortOnly=h,v.tryDoubleDomain=f),async function(E,y,C){Hg.get(E)||Hg.set(E,[]),Wg.get(E)||Wg.set(E,y),pc.get(E)||pc.set(E,0);const I=Hg.get(E),k=Wg.get(E);if(!I||!k)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(pc.get(E)===k){const ie=jf();I.push(ie),await ie.promise}pc.set(E,pc.get(E)+1);for(var W=arguments.length,$=new Array(W>3?W-3:0),z=3;z<W;z++)$[z-3]=arguments[z];const X=await C(...$);return pc.set(E,pc.get(E)-1),pc.get(E)===k-1&&I.length>0&&(I[0].resolve(),I.shift()),pc.get(E)===0&&(Hg.set(E,[]),Wg.set(E,0),pc.set(E,0)),X}("client.join",Z("JOIN_MAX_CONCURRENCY"),this.join.bind(this),t,r,a,l,u)}async join(t,r,a,l,u){const h=++this._numberOfJoinCount;this.store.joinStart(),l&&(this.store.uid=l);const f=HZ(),v=q2()?window.isSecureContext:"Browser Not Support";if(!q2()&&!f||!window.isSecureContext){const $="The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser";L.warning($)}const E=Ib();this.connectionState==="DISCONNECTED"&&(this.store.avoidJoinStart=Math.round(Date.now()),L.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart)));const y=He.reportApiInvoke(E,{name:hr.JOIN,options:[t,r,a,l],states:{isHttps:f,isSecureContext:v},tag:Dn.TRACER});He.setAppId(t);try{if(!a&&a!==null)throw new ue(G.INVALID_PARAMS,"Invalid token: ".concat(a,". If you don not use token, set it to null"));a&&di(a,"token",1,2047),di(t,"appid",1,2047),eT(r),l&&tT(l),u&&di(u,"optionalInfo",1,2047)}catch($){throw y.onError($),$}if(L.info("[".concat(this._clientId,"] start join channel ").concat(r,", join number: ").concat(h)),this._leaveMutex.isLocked&&(L.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),L.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const $=new ue(G.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw y.onError($),$}this._sessionId||(this._sessionId=E,this.store.sessionId=this._sessionId),this._gateway.state="CONNECTING";const C=S0({clientId:this._clientId,appId:t,sid:this._sessionId,cname:r,uid:typeof l!="string"?l:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:a||t,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:u,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType});if(this._useLocalAccessPoint&&(C.setLocalAPVersion=this._setLocalAPVersion),typeof l=="string"&&(C.stringUid=l,this._uintUid?(C.uid=this._uintUid,this._uintUid=void 0):C.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(C.aesmode=this._encryptionMode,C.aespassword=await JQ(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new ue(G.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(C.aessalt=this._encryptionSalt)}this._startSession(this._sessionId,{channel:r,appId:t});const I=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&I===this._sessionId&&He.joinChannelTimeout(this._sessionId,5)},5e3);try{var k;let $;const z=C.cloudProxyServer;if(Ke(k=["proxy3","proxy4","proxy5"]).call(k,z)){const Re=Z("PROXY_SERVER_TYPE3");Array.isArray(Re)?C.proxyServer=Re[0]:C.proxyServer=Re}if(He.setProxyServer(C.proxyServer),L.setProxyServer(C.proxyServer),this.store.requestAPStart(),C.stringUid&&!C.uid){const Re=await uF(C.stringUid,C,this._axiosCancelSource.token,this._config.httpRetryConfig||sr,this.store);L.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(C.stringUid," => ").concat(Re)),C.uid=Re,$=await lF(C,this._axiosCancelSource.token,this._config.httpRetryConfig||sr,!0,this.store)}else $=await lF(C,this._axiosCancelSource.token,this._config.httpRetryConfig||sr,!0,this.store);if(!this._joinAndNotLeaveYet)throw new ue(G.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(C,this._axiosCancelSource.token),this._configDistribute.on(Kf.UPDATE_BITRATE_LIMIT,Re=>{this._p2pChannel.updateBitrateLimit(Re)})},0),this._key=a||t;const X=$.gatewayInfo;this._joinInfo=S0(S0({},C),{},{cid:X.cid,uid:C.uid?C.uid:X.uid,vid:X.vid,apResponse:X.res,uni_lbs_ip:X.uni_lbs_ip,gatewayAddrs:X.gatewayAddrs});const ie=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new ue(G.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));y.onSuccess(ie),this._appId=t,this._channelName=C.cname,this._uid=ie,this.store.uid=ie,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(Di()?"beforeunload":"pagehide",this._handleBeforeUnload)},0);const oe=C.stringUid?"string uid: ".concat(C.stringUid,",uid: ").concat(C.uid):"uid: ".concat(this._uid);return L.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(r,",").concat(oe)),setTimeout(()=>{L.startUpload()},5e3),this.store.joinEnd(),W=this,Ke(Ul).call(Ul,W)||Ul.push(W),ie}catch($){const z=Array.isArray($)?$[0]:$;throw z&&z.code===G.OPERATION_ABORTED?L.warning("[".concat(this._clientId,"] join number: ").concat(h,", Joining channel failed, rollback"),z):L.error("[".concat(this._clientId,"] join number: ").concat(h,", Joining channel failed, rollback"),z),z.code!==G.OPERATION_ABORTED&&this._numberOfJoinCount===h&&(this._gateway.state="DISCONNECTED",this._reset()),y.onError(z),z}var W}_joinGateway(){if(!this._joinInfo||!this._key)throw new ue(G.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!Z("JOIN_WITH_FALLBACK_SIGNAL_PROXY"))).then(t=>t).catch(t=>{if(t.code===G.INIT_WEBSOCKET_TIMEOUT)return this._gateway.leave(!0,It.FALLBACK),t;if(t.code===G.INIT_DATACHANNEL_TIMEOUT)return this._gateway.leave(!0,It.FALLBACK),t;throw t}).then(t=>{if(t instanceof ue){if(t.code===G.INIT_WEBSOCKET_TIMEOUT){if(L.info("[".concat(this._clientId,"] join timeout, fallback to proxy")),!this._joinInfo||!this._key)throw new ue(G.INVALID_OPERATION);this._joinInfo.cloudProxyServer="fallback",this._cloudProxyServerMode="fallback",this.store.cloudProxyServerMode="fallback";const r=Z("PROXY_SERVER_TYPE3");if(Array.isArray(r))if(this._joinInfo.apUrl){const l=/^https?:\/\/(.+?)(\/.*)?$/.exec(this._joinInfo.apUrl)[1].split("."),u=l.slice(l.length-2).join(".");r.forEach(h=>{this._joinInfo&&Ke(h).call(h,u)&&(this._joinInfo.proxyServer=h)}),this._joinInfo.proxyServer||(this._joinInfo.proxyServer=r[0])}else this._joinInfo.proxyServer=r[0];else this._joinInfo.proxyServer=r;const a=Z("LOG_UPLOAD_SERVER").match(/.+:(\d{1,5})$/);return a&&a[1]&&a[1]!=="443"&&L.setProxyServer(this._joinInfo.proxyServer),Z("STATS_COLLECTOR_PORT").toString()!=="443"&&He.setProxyServer(this._joinInfo.proxyServer),He.reportApiInvoke(this._sessionId,{name:hr.JOIN_FALLBACK_TO_PROXY,options:[this._joinInfo.proxyServer],tag:Dn.TRACER}).onSuccess(),this.safeEmit(At.JOIN_FALLBACK_TO_PROXY,this._joinInfo.proxyServer),Z("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&this._joinInfo.turnServer.servers.forEach(l=>{"forceturn"in l&&(l.forceturn=!0)}),this._gateway.join(this._joinInfo,this._key)}if(L.info("[".concat(this._clientId,"] join by datachannel timeout, fallback to websocket")),!this._joinInfo||!this._key)throw new ue(G.INVALID_OPERATION);return He.reportApiInvoke(this._sessionId,{name:hr.DATACHANNEL_FAILBACK,options:[this.store.clientId],tag:Dn.TRACER}).onSuccess(),this._joinGateway()}return t}).then(t=>t)}async leave(){L.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(Di()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(r){const a=Ul.indexOf(r);a!==-1&&Ul.splice(a,1)}(this);const t=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return L.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void t();await this._gateway.leave(this.connectionState!=="CONNECTED"),L.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),t()}async publish(t){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!Array.isArray(t)){if(!(t instanceof pi))return this._publishDataChannel(t);t=[t]}if(t.length===0)throw new ue(G.INVALID_PARAMS,"param list is empty");const a=t;if(this._gateway.role==="audience")throw new ue(G.INVALID_OPERATION,"audience can not publish stream");for(const u of a){if(!(u instanceof pi))throw new ue(G.INVALID_PARAMS,"parameter is not local track");if(!u._enabled&&r)throw new ue(G.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(u.getTrackId()))}L.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(a.map(u=>"".concat(u.getTrackId()," "))));const l=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),r&&a.forEach(u=>{const h=this._configDistribute.getBitrateLimit();u instanceof bt&&h&&u.setBitrateLimit(h.uplink)});try{await this._publishHighStream(a),L.info("[".concat(this._clientId,"] Publish success, id ").concat(a.map(u=>"".concat(u.getTrackId()," "))))}catch(u){throw L.error("[".concat(this._clientId,"] publish error"),u.toString()),u}finally{l()}}async _publishDataChannel(t){cn(t.id,"id",0,65535,!0),Yu(t.ordered,"ordered"),di(t.metadata,"metadata",0,512),L.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(t.id));const r=await this._publishMutex.lock();try{if(this._p2pChannel.getAllDataChannels().findIndex(l=>l.id===t.id)!==-1)throw new ue(G.INVALID_PARAMS,"Invalid id: ".concat(t.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||this._uid===void 0)throw new ue(G.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ue(G.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&Z("FORCE_TURN")&&!Z("TURN_ENABLE_TCP")&&!Z("TURN_ENABLE_UDP"))throw new ue(G.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const a=new WM(t);await this._p2pChannel.publishDataChannel([a]);try{const l={streamId:t.id,ordered:t.ordered,maxRetransmits:Z("DATASTREAM_MAX_RETRANSMITS"),metadata:t.metadata,channelId:a._originDataChannelId};await this._gateway.publishDataChannel(this._uid,l,!0)}catch(l){if(l.code!==G.DISCONNECT_P2P)throw l}return await a._waitTillOpen(),L.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(a.id)),a}catch(a){throw L.error("[".concat(this._clientId,"] publish datachannels error"),a.toString()),a}finally{r()}}async unpublish(t){if(!this._joinInfo||this._uid===void 0)throw new ue(G.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let r=[];if(t)if(Array.isArray(t))r=t;else{if(!(t instanceof pi))return this._unpublishDataChannel([t]);r=[t]}else this.store.useP2P||await this._unpublishDataChannel(),r=this._p2pChannel.getAllTracks(!0);L.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(r.map(l=>"".concat(l.getTrackId()," "))," "));const a=await this._publishMutex.lock();try{if(this._p2pChannel instanceof Un){const l=await this._p2pChannel.unpublish(r);if(l){const u=await this._gateway.sendExtensionMessage(mn.UNPUBLISH,l);u&&await this._p2pChannel.setDescription("local",u)}}else{const l=await this._p2pChannel.unpublish(r);l&&await this._gateway.unpublish(l,this._uid),L.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(r.map(u=>"".concat(u.getTrackId()))))}}catch(l){throw L.error("[".concat(this._clientId,"] unpublish error"),l.toString()),l}finally{a&&a()}}async _unpublishDataChannel(t){t!==void 0&&t.length!==0||(t=this._p2pChannel.getAllDataChannels()),L.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(t.map(a=>"".concat(a.id," "))," "));const r=await this._publishMutex.lock();try{const a=await this._p2pChannel.unpublishDataChannel(t);a&&await this._gateway.unpublishDataChannel(a),L.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(t.map(l=>"".concat(l.id))))}catch(a){throw L.error("[".concat(this._clientId,"] unpublish dataChannel error"),a.toString()),a}finally{r&&r()}}async subscribe(t,r,a){return r==="datachannel"?this._subscribeDataChannel(t,a):this._subscribe(t,r)}async _subscribeDataChannel(t,r){var a;if(cn(r,"channelId",0,65535,!0),!this._joinInfo)throw new ue(G.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ue(G.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));if(!this._users.find(f=>f===t))throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", this user is not in the channel")),new ue(G.INVALID_REMOTE_USER,"user is not in the channel");if(!t.hasAudio&&!t.hasVideo&&t._dataChannels.length===0)throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", user is not published")),new ue(G.INVALID_REMOTE_USER,"user is not published");const l=(a=t._dataChannels)===null||a===void 0?void 0:a.find(f=>f.id===r);if(!l)throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid," with mediaType datachannel, remote datachannel is not published")),new ue(G.REMOTE_USER_IS_NOT_PUBLISHED);const u=await this._subscribeMutex.lock();L.info("[".concat(this._clientId,"] subscribe user ").concat(t.uid,", mediaType: datachannel"));try{const f=await this._p2pChannel.subscribeDataChannel(t,[l]);if(f&&Ke(f).call(f,l.id))try{var h;if(!l._originDataChannelId)throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid," with mediaType datachannel, cannot get RTCDatachannel")),new ue(G.REMOTE_USER_IS_NOT_PUBLISHED);const v={id:l.id,datachannelId:l._originDataChannelId,ordered:l.ordered,maxRetransmits:l.maxRetransmits,metadata:(h=l.metadata)!==null&&h!==void 0?h:""};await this._gateway.subscribeDataChannel(t.uid,v,!0)}catch(v){if((v==null?void 0:v.code)!==G.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(t,[l]),v;await this._p2pChannel.unsubscribeDataChannel(t,[l]),this._p2pChannel.setPendingRemoteDataChannel(t,l.id)}return await l._waitTillOpen(),L.info("[".concat(this._clientId,"] subscribe success user ").concat(t.uid,", mediaType: datachannel")),l}finally{u()}}async _p2pSubscribe(t,r,a){if(wr(r,"mediaType",["audio","video"]),!this._joinInfo)throw new ue(G.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ue(G.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(h=>h===t)){const h=new ue(G.INVALID_REMOTE_USER,"user is not in the channel");throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", this user is not in the channel")),h}if(!t.hasAudio&&!t.hasVideo){const h=new ue(G.INVALID_REMOTE_USER,"user is not published");throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", user is not published")),h}if(!a&&(r==="audio"&&!t.hasAudio||r==="video"&&!t.hasVideo)){const h=new ue(G.REMOTE_USER_IS_NOT_PUBLISHED);throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid," with mediaType ").concat(r,", remote track is not published")),h}const l=await this._subscribeMutex.lock();L.info("[".concat(this._clientId,"] subscribe user ").concat(t.uid,", mediaType: ").concat(r));const u=r==="audio"?we.LocalAudioTrack:this._joinInfo.defaultVideoStream===Ev.LOW_STREAM?we.LocalVideoLowTrack:we.LocalVideoTrack;try{await this._p2pChannel.hasRemoteMediaWithLock(t,r)?await this._p2pChannel.unmuteRemote(t,r):(this.store.subscribe(t.uid,r,Date.now()),this._p2pChannel instanceof Un&&await this._gateway.sendExtensionMessage(mn.SUBSCRIBE,{trackType:u})),L.info("[".concat(this._clientId,"] subscribe success user ").concat(t.uid,", mediaType: ").concat(r)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(t.uid,this._defaultStreamFallbackType).catch(f=>{L.warning("[".concat(this._clientId,"] auto set fallback failed"),f)});const h=r==="audio"?t._audioTrack:t._videoTrack;if(!h)throw new ue(G.UNEXPECTED_ERROR,"can not find remote track in user object");return h}catch(h){throw L.error("[".concat(this._clientId,"] subscribe user ").concat(t.uid," error"),h),h}finally{l()}}async _subscribe(t,r,a){if(this._p2pChannel instanceof Un)return this._p2pSubscribe(t,r);if(wr(r,"mediaType",["audio","video"]),!this._joinInfo)throw new ue(G.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ue(G.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(E=>E===t)){const E=new ue(G.INVALID_REMOTE_USER,"user is not in the channel");throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", this user is not in the channel")),E}if(!t.hasAudio&&!t.hasVideo){const E=new ue(G.INVALID_REMOTE_USER,"user is not published");throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid,", user is not published")),E}if(!(a||(r!=="audio"||t.hasAudio&&t._audioSSRC!==void 0)&&(r!=="video"||t.hasVideo&&t._videoSSRC!==void 0))){const E=new ue(G.REMOTE_USER_IS_NOT_PUBLISHED);throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid," with mediaType ").concat(r,", remote track is not published")),E}let l=r==="audio"?t._audioSSRC:t._videoSSRC,u=r==="audio"?t._audioOrtc:t._videoOrtc,h=r==="video"?t._rtxSsrcId:void 0,f={stream_type:r==="audio"?Ue.AUDIO:Ue.VIDEO,ssrcId:l};const v=await this._subscribeMutex.lock();L.info("[".concat(this._clientId,"] subscribe user ").concat(t.uid,", mediaType: ").concat(r));try{if(await this._p2pChannel.hasRemoteMediaWithLock(t,r))await this._p2pChannel.unmuteRemote(t,r);else try{const y=r==="audio"?t._audioSSRC:t._videoSSRC;y!==void 0&&y!==l&&(l=y,u=r==="audio"?t._audioOrtc:t._videoOrtc,h=r==="video"?t._rtxSsrcId:void 0,f={stream_type:r==="audio"?Ue.AUDIO:Ue.VIDEO,ssrcId:l}),fi.markSubscribeStart(this.store.clientId,l),this.store.subscribe(t.uid,r,Date.now()),await this._p2pChannel.subscribe(t,r,l,h,u);try{await this._gateway.subscribe(t.uid,f,!0)}catch(C){if((C==null?void 0:C.code)!==G.WS_ABORT)throw await this._p2pChannel.unsubscribe(t,r),C;await this._p2pChannel.unsubscribe(t,r,!0),this._p2pChannel.setPendingRemoteMedia(t,r)}this.store.subscribe(t.uid,r,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,t,r)}catch(y){throw this._p2pChannel.reportSubscribeEvent(!1,y==null?void 0:y.code,t,r),y}L.info("[".concat(this._clientId,"] subscribe success user ").concat(t.uid,", mediaType: ").concat(r)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(t.uid,this._defaultStreamFallbackType).catch(y=>{L.warning("[".concat(this._clientId,"] auto set fallback failed"),y)});const E=r==="audio"?t._audioTrack:t._videoTrack;if(!E)throw new ue(G.UNEXPECTED_ERROR,"can not find remote track in user object");return E}catch(E){throw L.error("[".concat(this._clientId,"] subscribe user ").concat(t.uid," error"),E),E}finally{v()}}async massSubscribe(t){if(Hc(t,"subscribeList"),!this._joinInfo)throw new ue(G.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ue(G.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const r=Date.now(),a=new Map,l=await this._subscribeMutex.lock();L.info("[".concat(this._clientId,"]start massSubscribe user ").concat(t.map(v=>{let{user:E,mediaType:y}=v;return"user: ".concat(E==null?void 0:E.uid,", mediaType: ").concat(y)}).join("; ")));const u=(t=[...t]).map(v=>{let{user:E,mediaType:y}=v;return{user:E,mediaType:y}}),h=await this._p2pChannel.globalLock();try{var f;for(let E=t.length-1;E>=0;E--){const y=t[E],{user:C,mediaType:I}=y;if(wr(I,"mediaType",["audio","video"]),!C){const $=new ue(G.INVALID_PARAMS,"user property does not exist in subscribeList item");throw L.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),$}if(!this._users.find($=>$===C)){const $=new ue(G.INVALID_REMOTE_USER,"user is not in the channel");L.error("[".concat(this._clientId,"] can not massSubscribe ").concat(C.uid,", this user is not in the channel")),u[E].error=$,t.splice(E,1);continue}if(I==="audio"&&(!C.hasAudio||C._audioSSRC===void 0)||I==="video"&&(!C.hasVideo||C._videoSSRC===void 0)){const $=new ue(G.REMOTE_USER_IS_NOT_PUBLISHED);L.error("[".concat(this._clientId,"] can not subscribe ").concat(C.uid," with mediaType ").concat(I,", remote user is not published")),u[E].error=$,t.splice(E,1);continue}const k=pr.Video|pr.LwoVideo,W=a.get(C);if(W){if(I==="video"?W&k:W&pr.Audio){t.splice(E,1),L.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(C.uid,", mediaType:").concat(I," twice"));continue}a.set(C,W|(I==="video"?k:pr.Audio))}else a.set(C,I==="video"?k:pr.Audio)}for(let E=t.length-1;E>=0;E--){const y=t[E],{user:C,mediaType:I}=y,k=pr.Video|pr.LwoVideo;if(this._p2pChannel.hasRemoteMedia(C,I)){await this._p2pChannel.unmuteRemoteNoLock(C,I);const W=a.get(C);a.set(C,I==="video"?W^k:W^pr.Audio),t.splice(E,1)}}this.store.massSubscribe(t.map(E=>({userId:E.user.uid,type:E.mediaType})),r);const v=Qu(f=Array.from(a.entries())).call(f,(E,y)=>{let[C,I]=y;if(I===0)return E;const k={stream_id:C.uid,stream_type:I};return I&pr.Audio&&(k.audio_ssrc=C._audioSSRC),I&pr.Video&&(k.video_ssrc=C._videoSSRC),E.push(k),E},[]);try{t.length>0&&await this._p2pChannel.massSubscribeNoLock(t.map(y=>{let{user:C,mediaType:I}=y;return{user:C,mediaType:I,ssrcId:I===Ue.VIDEO?C._videoSSRC:C._audioSSRC,rtxSsrcId:I===Ue.VIDEO?C._rtxSsrcId:void 0}}));const E=new Map;if(v.length>0){const y=await this._gateway.subscribeAll(v,!0);((y==null?void 0:y.users)||[]).forEach(C=>{let{stream_id:I,video_error_code:k,audio_error_code:W,error_code:$}=C;(k||W||$)&&E.set(I,{video_error_code:k,audio_error_code:W,error_code:$})})}if(Array.from(E.entries()).length>0){const y=Array.from(E.entries()).map(C=>{let I,[k,W]=C;return W.error_code||W.video_error_code&&W.audio_error_code?I=void 0:W.video_error_code?I=Ue.VIDEO:W.audio_error_code&&(I=Ue.AUDIO),{user:this.remoteUsers.find($=>$.uid===k),mediaType:I}});await this._p2pChannel.massUnsubscribeNoLock(y)}for(const y of u){const C=E.get(y.user.uid);if(C){const I=C.error_code||y.mediaType==="audio"&&C.audio_error_code||y.mediaType==="video"&&C.video_error_code;if(I){const k=rd(I);L.error("user:".concat(y.user.uid," mediaType:").concat(y.mediaType," has massSubscribe error ").concat(k.desc)),y.error=new ue(G.SUBSCRIBE_FAILED,"code ".concat(I,": ").concat(k.desc))}}y.error||(y.mediaType==="video"?y.track=y.user.videoTrack:y.track=y.user.audioTrack)}return this.store.massSubscribe(u.filter(y=>!y.error).map(y=>({userId:y.user.uid,type:y.mediaType})),void 0,Date.now()),u.forEach(y=>{var C;He.subscribe(this.store.sessionId,{succ:!!y.error,ec:((C=y.error)===null||C===void 0?void 0:C.code)||null,video:y.mediaType===Ue.VIDEO,audio:y.mediaType===Ue.AUDIO,peerid:y.user.uid,subscribeRequestid:y.mediaType===Ue.VIDEO?y.user._videoSSRC:y.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-r)},!0)}),L.info("[".concat(this._clientId,"] massSubscribe success ").concat(t.map(y=>{let{user:C,mediaType:I}=y;return"user: ".concat(C==null?void 0:C.uid,", mediaType: ").concat(I)}).join("; "))),u}catch(E){throw await this._p2pChannel.massUnsubscribeNoLock(t),E}}finally{h(),l()}}async unsubscribe(t,r,a){if(r||this.store.useP2P){if(r==="datachannel")return this._unsubscribeDataChannel(t,a)}else await this._unsubscribeDataChannel(t,a);if(r&&wr(r,"mediaType",["audio","video"]),!this._joinInfo)throw new ue(G.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(u=>u===t)){const u=new ue(G.INVALID_REMOTE_USER,"user is not in the channel");throw L.error("[".concat(this._clientId,"] can not unsubscribe ").concat(t.uid,", user is not in the channel")),u}L.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(t.uid,", mediaType: ").concat(r));const l=await this._subscribeMutex.lock();try{if(this._p2pChannel instanceof Un)await this._gateway.sendExtensionMessage(mn.UNSUBSCRIBE,{mediaType:r});else{const u=await this._p2pChannel.unsubscribe(t,r);u&&await this._gateway.unsubscribe(u,t.uid),L.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(t.uid,", mediaType: ").concat(r))}}catch(u){if(u.code===G.DISCONNECT_P2P)return void L.warning("disconnecting p2p, abort unsubscribe request.");throw L.error("[".concat(this._clientId,"] unsubscribe user ").concat(t.uid," error"),u.toString()),u}finally{l()}}async _unsubscribeDataChannel(t,r){if(r&&cn(r,"id",0,65535,!0),!this._joinInfo)throw new ue(G.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!this._users.find(l=>l===t)){const l=new ue(G.INVALID_REMOTE_USER,"user is not in the channel");throw L.error("[".concat(this._clientId,"] can not unsubscribe ").concat(t.uid,", user is not in the channel")),l}let a;if(typeof r=="number"){const l=t._dataChannels.find(u=>u.id===r);l&&(a=[l])}else a=t._dataChannels;if(a===void 0){const l=new ue(G.REMOTE_USER_IS_NOT_PUBLISHED);throw L.error("[".concat(this._clientId,"] can not unsubscribe ").concat(t.uid," with channelId ").concat(r,", remote datachannel is not published")),l}L.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(t.uid,", mediaType: datachannel, ids: ").concat(a.map(l=>l.id)));try{const l=await this._p2pChannel.unsubscribeDataChannel(t,a);l&&await this._gateway.unsubscribeDataChannel(l,t.uid),L.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(t.uid,", mediaType: datachannel, ids: ").concat(l))}catch(l){if(l.code===G.DISCONNECT_P2P)return void L.warning("disconnecting p2p, abort unsubscribe request.");throw L.error("[".concat(this._clientId,"] unsubscribe user ").concat(t.uid," error"),l.toString()),l}}async massUnsubscribe(t){if(Hc(t,"unsubscribeList"),!this._joinInfo)throw new ue(G.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");L.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(t.map(a=>{let{user:l,mediaType:u}=a;return"user: ".concat(l==null?void 0:l.uid,", mediaType: ").concat(u,";")}).join())),t=[...t];const r=new Map;for(let a=t.length-1;a>=0;a--){const{user:l,mediaType:u}=t[a];if(!l){const f=new ue(G.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw L.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),f}if(wr(u,"mediaType",["video","audio",void 0]),!this._users.find(f=>f===l)){L.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(l.uid,", user is not in the channel")),t.splice(a,1);continue}const h=pr.Video|pr.LwoVideo;if(r.has(l)){const f=r.get(l);let v;switch(u){case"video":v=f&h;break;case"audio":v=f&pr.Audio;break;default:v=f&(pr.Audio|h)}if(v){L.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(l.uid,",mediaType:").concat(u," twice.")),t.splice(a,1);continue}u?u==="audio"?r.set(l,f|pr.Audio):u==="video"&&r.set(l,f|h):r.set(l,f|pr.Audio|h)}else u?u==="audio"?r.set(l,pr.Audio):u==="video"&&r.set(l,h):r.set(l,pr.Audio|h)}try{const a=await this._p2pChannel.massUnsubscribe(t);a&&await this._gateway.massUnsubscribe(a),L.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(t.map(l=>{let{user:u,mediaType:h}=l;return"user: ".concat(u==null?void 0:u.uid,", mediaType: ").concat(h,";")}).join()))}catch(a){if(a.code===G.DISCONNECT_P2P)return void L.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw L.error("[".concat(this._clientId,"] massUnsubscribe error"),a.toString()),a}}async setLowStreamParameter(t){(function(a){if(!a)throw new be(G.INVALID_PARAMS);kn(a.width)||bb(a.width,"streamParameter.width"),kn(a.height)||bb(a.height,"streamParameter.height"),kn(a.framerate)||bb(a.framerate,"streamParameter.framerate"),kn(a.bitrate)||cn(a.bitrate,"streamParameter.bitrate")})(t),(!t.width&&t.height||t.width&&!t.height)&&L.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),L.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(t));const r=this._configDistribute.getLowStreamConfigDistribute();if(r&&r.bitrate&&t.bitrate&&r.bitrate<t.bitrate&&(t.bitrate=r.bitrate),this._lowStreamParameter=t,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(t,we.LocalVideoLowTrack)}async enableDualStream(){if(!fn().supportDualStream)throw He.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new ue(G.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new ue(G.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(t){throw He.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),t}this._isDualStreamEnabled=!0,He.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),L.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new ue(G.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(we.LocalVideoLowTrack))try{const t=await this._p2pChannel.unpublishLowStream();t&&await this._gateway.unpublish(t,this._joinInfo.stringUid||this._joinInfo.uid)}catch(t){throw He.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),t}this._isDualStreamEnabled=!1,He.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),L.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(t,r){if(function(a){wr(a,"role",["audience","host"])}(t),r&&Wk(r),this.mode==="rtc")throw L.warning("[".concat(this._clientId,"]rtc mode can not use setClientRole")),new ue(G.INVALID_OPERATION,"rtc mode can not use setClientRole");if(r&&r.level&&t==="host")throw new ue(G.INVALID_OPERATION,"host mode can not set audience latency level");if(t==="audience"&&this._p2pChannel.hasLocalMedia())throw new ue(G.INVALID_OPERATION,"can not set client role to audience when publishing stream");await this._gateway.setClientRole(t,r),this._config.role=t,L.info("[".concat(this._clientId,"] set client role to ").concat(t,", level: ").concat(r&&r.level))}getRemoteInboundOffset(){var t;const r=(t=this._p2pChannel.getStats())===null||t===void 0?void 0:t.audioSend[0];if(!r||!r.timestamp)return 0;const a=r.timestamp-Date.now();return Math.abs(a)>1e3+r.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?a:0}getNtpWallTimeInMs(){return document.visibilityState==="visible"&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(t,r){if(di(t,"proxyServer"),!r){if(this.connectionState!=="DISCONNECTED")throw new ue(G.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new ue(G.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=t,He.setProxyServer(this._proxyServer),L.setProxyServer(this._proxyServer),L.info("[".concat(this._clientId,"] Set proxy server ").concat(r?"by initialize call":""," success."))}setTurnServer(t,r){if(Array.isArray(t)||(t=[t]),!r){if(this.connectionState!=="DISCONNECTED")throw new ue(G.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new ue(G.INVALID_OPERATION,"You have already set the proxy")}if(bh(t))return this._turnServer={servers:t,mode:"original-manual"},void L.info("[".concat(this._clientId,"] Set original turnserver ").concat(r?"by initialize call":""," success: ").concat(t.map(a=>a.urls).join(","),"."));t.forEach(a=>Hk(a)),this._turnServer={servers:t,mode:"manual"},L.info("[".concat(this._clientId,"] Set turnserver ").concat(r?"by initialize call":""," success."))}setLicense(t){if(this.connectionState!=="DISCONNECTED")throw new ue(G.INVALID_OPERATION,"you should set license before join channel");if(di(t,"license",32,32),!/^[A-Za-z\d]+$/.test(t))throw new ue(G.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=t,L.info("[".concat(this._clientId,"] set license success"),t)}startProxyServer(t){if(this.connectionState!=="DISCONNECTED")throw new ue(G.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new ue(G.INVALID_OPERATION,"You have already set the proxy");const r=[3,4,5];let a;switch(t===void 0&&(t=3),t){case 1:case 2:throw new ue(G.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:a="proxy3";break;case 4:a="proxy4";break;case 5:a="proxy5";break;default:throw new ue(G.INVALID_PARAMS,"proxy server mode must be ".concat(r.join("|")))}this._cloudProxyServerMode=a,this.store.cloudProxyServerMode=a,L.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new ue(G.INVALID_OPERATION,"Stop proxy server after leave channel");He.setProxyServer(),L.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",L.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(t){if(!t.accessPoints)throw new ue(G.INVALID_PARAMS,"accessPoints is required.");Hc(t.accessPoints.serverList,"accessPoints.serverList"),di(t.accessPoints.domain,"accessPoints.domain");const r=(k,W)=>{cn(k,W,0,65535,!0)};let a=443;if(t.accessPoints.port&&(r(t.accessPoints.port,"accessPoints.port"),a=t.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new ue(G.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");Z("CLOSE_AFB_FOR_LOCAL_AP")&&(an("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),an("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const l=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,u=t.accessPoints.domain,h=t.accessPoints.serverList.map(k=>l.test(k)?"".concat(k.replace(/\./g,"-"),".").concat(u):k),f=h.map(k=>"".concat(k,":").concat(a));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,an("WEBCS_DOMAIN",f),an("WEBCS_DOMAIN_BACKUP_LIST",f),an("GATEWAY_DOMAINS",[u]),t.report&&t.report.hostname&&Array.isArray(t.report.hostname)&&t.report.hostname.length?(Hc(t.report.hostname,"report.hostname"),an("EVENT_REPORT_DOMAIN",t.report.hostname[0]),an("EVENT_REPORT_BACKUP_DOMAIN",t.report.hostname[1]||t.report.hostname[0])):(an("EVENT_REPORT_DOMAIN",h[0]),an("EVENT_REPORT_BACKUP_DOMAIN",h[1]||h[0]));let v=6443;t.report&&t.report.port&&(r(t.report.port,"report.port"),v=t.report.port),an("STATS_COLLECTOR_PORT",v),t.report?an("ENABLE_EVENT_REPORT",!0):an("ENABLE_EVENT_REPORT",!1);let E="";t.log&&t.log.hostname&&Array.isArray(t.log.hostname)&&t.log.hostname.length?(Hc(t.log.hostname,"log.hostname"),E=t.log.hostname[0]):E=h[0];let y=6444;t.log&&t.log.port&&(r(t.log.port,"log.port"),y=t.log.port),an("LOG_UPLOAD_SERVER","".concat(E,":").concat(y));let C=[];t.cds&&t.cds.hostname&&Array.isArray(t.cds.hostname)&&t.cds.hostname.length?(Hc(t.cds.hostname,"cds.hostname"),C=t.cds.hostname):C=h;let I=443;t.cds&&t.cds.port&&(r(t.cds.port,"cds.port"),I=t.cds.port),an("CDS_AP",C.map(k=>"".concat(k,":").concat(I))),t.cds?an("ENABLE_CONFIG_DISTRIBUTE",!0):an("ENABLE_CONFIG_DISTRIBUTE",!1),L.info("set local access point v2 success")}setLocalAccessPoints(t,r){if(Hc(t,"serverList"),di(r,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new ue(G.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const a=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;t=t.map(l=>a.test(l)?"".concat(l.replace(/\./g,"-"),".").concat(r):l),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,an("WEBCS_DOMAIN",t),an("WEBCS_DOMAIN_BACKUP_LIST",t),an("GATEWAY_DOMAINS",[r]),an("EVENT_REPORT_DOMAIN",t[0]),an("EVENT_REPORT_BACKUP_DOMAIN",t[1]||t[0]),an("LOG_UPLOAD_SERVER","".concat(t[0],":6444")),L.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(t){if(wr(t,"streamType",[0,1]),this._remoteDefaultVideoStreamType=t,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(t),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(r){throw L.error("[".concat(this._clientId,"] set default remote video stream type error"),r.toString()),r}else L.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(t))}async setRemoteVideoStreamType(t,r){wr(r,"streamType",[0,1]);try{await this._gateway.setRemoteVideoStreamType(t,r),setTimeout(()=>{const a=this._users.find(l=>l.uid===t);a&&a.videoTrack&&a.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(a){throw L.error("[".concat(this._clientId,"] set remote video stream type error"),a.toString()),a}L.info("[".concat(this._clientId,"] set remote ").concat(t," video stream type to ").concat(r)),this._remoteStreamTypeCacheMap.set(t,r)}async setStreamFallbackOption(t,r){wr(r,"fallbackType",[0,1,2]);try{await this._gateway.setStreamFallbackOption(t,r)}catch(a){throw L.error("[".concat(this._clientId,"] set stream fallback option"),a.toString()),a}L.info("[".concat(this._clientId,"] set remote ").concat(t," stream fallback type to ").concat(r)),this._streamFallbackTypeCacheMap.set(t,r)}setEncryptionConfig(t,r,a){(function(u){wr(u,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])})(t),di(r,"secret");const l=["aes-128-gcm2","aes-256-gcm2"];if(Ke(l).call(l,t)){if(!a||!(a instanceof Uint8Array&&a.length===32))throw new ue(G.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(a)throw new ue(G.INVALID_PARAMS,"current encrypt mode does not need salt");new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(r)||L.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=t,this._encryptionSecret=r,a&&(this._encryptionSalt=Xg(a))}async renewToken(t){if(di(t,"token",1,2047),!this._key||!this._joinInfo)throw new ue(G.INVALID_OPERATION,"renewToken should not be called before user join");const r=this._key;this._key=t,this._joinInfo&&(this._joinInfo.token=t);const a=await this._renewTokenMutex.lock();try{if(Z("USE_NEW_TOKEN")){L.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const l=await tne(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||sr);L.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:t,ticket:l})}else L.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:t});L.debug("[".concat(this._clientId,"] renewToken success"))}catch(l){throw this._key=r,this._joinInfo.token=r,L.error("[".concat(this._clientId,"] renewToken failed"),l.toString()),l}finally{a()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?L.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const t=this._p2pChannel.getAudioLevels();this.safeEmit(At.VOLUME_INDICATOR,t)},Z("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const t=this._statsCollector.getRTCStats(),r=this._gateway.getInChannelInfo();return t.Duration=Math.round(r.duration/1e3),t}async startLiveStreaming(t,r){if(!r){if(this.codec!=="h264")throw new ue(G.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new ue(G.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(t)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(t))throw new ue(G.LIVE_STREAMING_TASK_CONFLICT);const a=r?Er.TRANSCODE:Er.RAW;return this._createLiveStreamingClient(a).startLiveStreamingTask(t,a)}setLiveTranscoding(t){return this._createLiveStreamingClient(Er.TRANSCODE).setTranscodingConfig(t)}async stopLiveStreaming(t){const r=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(a=>a&&a.hasUrl(t));if(!r.length)throw new ue(G.INVALID_PARAMS,"can not find live streaming url to stop");await me.all(r.map(a=>a&&a.stopLiveStreamingTask(t)))}async addInjectStreamUrl(t,r){if(!this._joinInfo)throw new ue(G.INVALID_OPERATION,"can not addInjectStreamUrl, no joininfo");const a=this._createLiveStreamingClient(Er.INJECT);a.setInjectStreamConfig(r,0),await a.startLiveStreamingTask(t,Er.INJECT)}async removeInjectStreamUrl(){var t;const r=this._createLiveStreamingClient(Er.INJECT),a=Array.from(gc(t=r.streamingTasks).call(t)).find(l=>l.mode===Er.INJECT);if(!this._joinInfo||!a)throw new ue(G.INVALID_OPERATION,"can remove addInjectStreamUrl, no joininfo or inject task");await r.stopLiveStreamingTask(a.url)}async startChannelMediaRelay(t){vF(t),await this._createChannelMediaRelayClient().startChannelMediaRelay(t)}async updateChannelMediaRelay(t){vF(t),await this._createChannelMediaRelayClient().updateChannelMediaRelay(t)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}sendStreamMessage(t){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new ue(G.INVALID_OPERATION,"can not send data stream, not joined");if((typeof t=="string"||t instanceof Uint8Array)&&(t={payload:t}),typeof t.payload=="string"){const a=new TextEncoder;t.payload=a.encode(t.payload)}if(new Blob([t.payload]).size>1024)throw new ue(G.INVALID_PARAMS,"stream message out of range.");return this._gateway.signal.request($e.DATA_STREAM,{payload:Xg(t.payload),syncWithAudio:t.syncWithAudio,sendTs:Date.now()-Lne},!r)}sendMetadata(t){if(!this._joinInfo)throw new ue(G.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([t]).size>1024)throw new ue(G.METADATA_OUT_OF_RANGE);return this._gateway.signal.request($e.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:Xg(t)})}async sendCustomReportMessage(t){if(Array.isArray(t)||(t=[t]),t.forEach(GZ),!this._joinInfo)throw new ue(G.INVALID_OPERATION,"can not send custom report, not joined");await He.sendCustomReportMessage(this._joinInfo.sid,t)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(t,r){wr(r.spatialLayer,"spatialLayer",[0,1,2,3]),wr(r.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(t,r)}catch(a){throw L.error("[".concat(this._clientId,"] pick SVC layer failed"),a.toString()),a}}setRTM2Flag(t){if(wr(t,"flag",[0,1]),!this._joinInfo)throw new ue(G.INVALID_OPERATION,"Can't setRtm2Flag, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ue(G.INVALID_OPERATION,"Can't setRtm2Flag in ".concat(this.connectionState," state"));return this._gateway.setRTM2Flag(t)}_reset(){if(L.debug("[".concat(this._clientId,"] reset client")),this._axiosCancelSource.cancel(),this._axiosCancelSource=go.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._pendingPublishedUsers=[],this._users.forEach(t=>{t._audioTrack&&t._audioTrack._destroy(),t._videoTrack&&t._videoTrack._destroy(),t._dataChannels&&(t._dataChannels.forEach(r=>r._close()),t._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new Mr("client-publish"),this._subscribeMutex=new Mr("client-subscribe"),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._injectStreamingClient&&(this._injectStreamingClient.terminate(),this._injectStreamingClient.removeAllListeners(),this._injectStreamingClient=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession(t,r){const a=t||Ib();t?L.debug("[".concat(this._clientId,"] new Session ").concat(a)):L.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(a)),this._sessionId=a,this.store.sessionId=a,r?He.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:r.channel,appid:r.appId,mode:this.mode}):this._joinInfo?He.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:this._joinInfo.cname,appid:this._joinInfo.appId,mode:this.mode}):this._gateway.joinInfo&&He.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:this._gateway.joinInfo.cname,appid:this._gateway.joinInfo.appId,mode:this.mode}),this._joinInfo&&(this._joinInfo.sid=a),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=a)}async _publishHighStream(t){if(!this._joinInfo||this._uid===void 0)throw new ue(G.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ue(G.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&Z("FORCE_TURN")&&!Z("TURN_ENABLE_TCP")&&!Z("TURN_ENABLE_UDP"))throw new ue(G.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");L.debug("[".concat(this._clientId,"] publish high stream"));try{if(this._p2pChannel instanceof Un){const a=await this._p2pChannel.publish(t,this._isDualStreamEnabled,this._lowStreamParameter);if(a)try{await this._gateway.sendExtensionMessage(mn.PUBLISH,a)}catch(l){throw this._p2pChannel.unpublish(t),l}}else{const a=await this._p2pChannel.publish(t,this._isDualStreamEnabled,this._lowStreamParameter),l=(await a.next()).value;if(l){var r;let u;try{u=await this._gateway.publish(this._uid,l,!0)}catch(h){if(h.code!==G.DISCONNECT_P2P)throw a.throw(h),h}await a.next(((r=u)===null||r===void 0?void 0:r.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const u of t)u instanceof bt&&u._encoderConfig&&this._gateway.setVideoProfile(u._encoderConfig),!u.muted&&u.enabled||await this._p2pChannel.muteLocalTrack(u)}}catch(a){if(this._p2pChannel.reportPublishEvent(!1,a==null?void 0:a.code,t),(a==null?void 0:a.code)===G.WS_ABORT)return;throw a}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new ue(G.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new ue(G.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));L.debug("[".concat(this._clientId,"] publish low stream"));const t=this._configDistribute.getLowStreamConfigDistribute();t&&t.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&t.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=t.bitrate));try{const a=await this._p2pChannel.publishLowStream(this._lowStreamParameter),l=(await a.next()).value;if(l){var r;let u;try{u=await this._gateway.publish(this._uid,l,!0)}catch(h){if(h.code!==G.DISCONNECT_P2P)throw a.throw(h),h}a.next(((r=u)===null||r===void 0?void 0:r.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(a){if(this._p2pChannel.reportPublishEvent(!1,a==null?void 0:a.code,void 0,!0),(a==null?void 0:a.code)===G.WS_ABORT)return;throw a}}_createLiveStreamingClient(t){if(!this._joinInfo||!this._appId)return new ue(G.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const r=()=>new ine(this._joinInfo,this._config.websocketRetryConfig||sr,this._config.httpRetryConfig||sr),a=l=>{l.onLiveStreamError=(u,h)=>{He.reportApiInvoke(this._sessionId,{name:hr.ON_LIVE_STREAM_ERROR,options:[u,h],tag:Dn.TRACER}).onSuccess(),this.safeEmit(At.LIVE_STREAMING_ERROR,u,h)},l.onLiveStreamWarning=(u,h)=>{He.reportApiInvoke(this._sessionId,{name:hr.ON_LIVE_STREAM_WARNING,options:[u,h],tag:Dn.TRACER}).onSuccess(),this.safeEmit(At.LIVE_STREAMING_WARNING,u,h)},l.on(Ph.REQUEST_WORKER_MANAGER_LIST,(u,h,f)=>{if(!this._joinInfo)return f(new ue(G.INVALID_OPERATION,"can not find join info to get worker manager"));hF(u,this._joinInfo,this._axiosCancelSource.token,sr).then(h).catch(f)})};switch(t){case Er.RAW:return this._liveRawStreamingClient||(this._liveRawStreamingClient=r(),a(this._liveRawStreamingClient)),this._liveRawStreamingClient;case Er.TRANSCODE:return this._liveTranscodeStreamingClient||(this._liveTranscodeStreamingClient=r(),a(this._liveTranscodeStreamingClient)),this._liveTranscodeStreamingClient;case Er.INJECT:return this._injectStreamingClient||(this._injectStreamingClient=r(),this._injectStreamingClient.on(Ph.REQUEST_WORKER_MANAGER_LIST,(l,u,h)=>{if(!this._joinInfo)return h(new ue(G.INVALID_OPERATION,"can not find join info to get worker manager"));hF(l,this._joinInfo,this._axiosCancelSource.token,sr).then(u).catch(h)}),this._injectStreamingClient.onInjectStatusChange=(l,u,h)=>{this.safeEmit(At.INJECT_STREAM_STATUS,l,u,h)}),this._injectStreamingClient}}_createChannelMediaRelayClient(){if(!this._joinInfo)return new ue(G.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:t,sendResolutionHeight:r}=this.getLocalVideoStats(),a={width:t,height:r};this._channelMediaRelayClient=new ane(this._joinInfo,this._clientId,this._config.websocketRetryConfig||sr,this._config.httpRetryConfig||sr,a),this._channelMediaRelayClient.on("state",l=>{l===Hi.RELAY_STATE_FAILURE&&this._channelMediaRelayClient&&this._channelMediaRelayClient.dispose(),this.safeEmit(At.CHANNEL_MEDIA_RELAY_STATE,l)}),this._channelMediaRelayClient.on("event",l=>{this.safeEmit(At.CHANNEL_MEDIA_RELAY_EVENT,l)}),this._statsCollector.onStatsChanged=(l,u)=>{var h;l==="resolution"&&((h=this._channelMediaRelayClient)===null||h===void 0||h.setVideoProfile(u))}}return this._channelMediaRelayClient}_handleUpdateDataChannel(t,r){const{added:a,deleted:l}=t,u=[];Array.isArray(a)&&a.length>0&&a.forEach(h=>{const{uid:f,stream_id:v,ordered:E,max_retrans_times:y,metadata:C}=h,I=this._users.find(k=>k._uintid===f);if(!I)return void L.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"));if(L.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(f)),Ke(u).call(u,I)||u.push(I),I._uintid||(I._uintid=f),I._dataChannels.findIndex(k=>k.id===h.stream_id)===-1){const k={id:v,ordered:!!E,maxRetransmits:y,metadata:C},W=new $te(k);I._dataChannels.push(W),L.info("[".concat(this._clientId,"] remote user ").concat(I.uid," published datachannel")),r||this.safeEmit(At.USER_PUBLISHED,I,"datachannel",k)}this._p2pChannel.hasPendingRemoteDataChannel(I,h.stream_id)&&(L.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(I.uid," after reconnect.")),this._subscribeDataChannel(I,h.stream_id).catch(k=>{L.error("[".concat(this._clientId,"] resubscribe datachannel error"),k.toString())}))}),r&&(this.safeEmit(At.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(l)&&l.length>0&&l.forEach(h=>{const{uid:f,stream_id:v}=h,E=this._users.find(C=>C._uintid===f);if(!E)return void L.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const y=E._dataChannels.find(C=>C.id===h.stream_id);y&&(L.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(f)),this._p2pChannel.unsubscribeDataChannel(E,[y]).then(C=>{if(C)return E._dataChannels=E._dataChannels.filter(I=>I!==y),this._gateway.unsubscribeDataChannel(C,E.uid)}),L.info("[".concat(this._clientId,"] remote user ").concat(f," unpublished datachannel ,id:").concat(y.id)),this.safeEmit(At.USER_UNPUBLISHED,E,"datachannel",y._config))})}_handleRemoveDataChannels(t){const r=this._users.find(a=>a.uid===t.uid);if(r){if(r._dataChannels!==void 0&&r._dataChannels.length>0){L.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(t.uid));const a=()=>{L.info("[".concat(this._clientId,"] remote user ").concat(r.uid," unpublished datachannel")),r._dataChannels.forEach(l=>{this.safeEmit(At.USER_UNPUBLISHED,r,"datachannel",l._config)})};this._p2pChannel.unsubscribeDataChannel(r,r._dataChannels).then(l=>{if(l)return this._gateway.unsubscribeDataChannel(l,r.uid)}),a()}}else L.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(Fn.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(Fn.CONNECTION_STATE_CHANGE,(t,r,a)=>{var l;if(a===It.FALLBACK)return;const u=()=>{this.safeEmit(At.CONNECTION_STATE_CHANGE,t,r,a)};if(He.reportApiInvoke(this._sessionId||((l=this._gateway.joinInfo)===null||l===void 0?void 0:l.sid)||null,{name:hr.CONNECTION_STATE_CHANGE,options:[t,r,a],tag:Dn.TRACER}).onSuccess(JSON.stringify({cur:t,prev:r,reason:a})),L.info("[".concat(this._clientId,"] connection state change: ").concat(r," -> ").concat(t)),t==="DISCONNECTED")return this._reset(),void u();if(t==="RECONNECTING")this._users.forEach(f=>{f._trust_in_room_=!1,f._trust_audio_enabled_state_=!1,f._trust_video_enabled_state_=!1,f._trust_audio_mute_state_=!1,f._trust_video_mute_state_=!1,f._trust_audio_stream_added_state_=!1,f._trust_video_stream_added_state_=!1,f._audioSSRC=void 0,f._videoSSRC=void 0,f._videoOrtc=void 0,f._audioOrtc=void 0,f._cname=void 0,f._rtxSsrcId=void 0}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(t==="CONNECTED"){var h;this._streamFallbackTypeCacheMap.forEach((f,v)=>{this._gateway.setStreamFallbackOption(v,f).catch(E=>{L.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),E)})}),this._remoteStreamTypeCacheMap.forEach((f,v)=>{this._gateway.setRemoteVideoStreamType(v,f).catch(E=>{L.warning("[".concat(this._clientId,"] auto set remote stream type failed"),E)})}),this._remoteDefaultVideoStreamType!==void 0&&((h=this._joinInfo)===null||h===void 0?void 0:h.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{L.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(f=>{L.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(f))}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(f=>!f._trust_in_room_).forEach(f=>{L.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(f.uid)),this._handleUserOffline({uid:f.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(f=>{f._trust_audio_mute_state_||(L.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(f.uid)),this._handleMuteStream(f.uid,Ue.AUDIO,!1)),f._trust_video_mute_state_||(L.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(f.uid)),this._handleMuteStream(f.uid,Ue.VIDEO,!1)),f._trust_audio_enabled_state_||(L.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(f.uid)),this._handleSetStreamLocalEnable("audio",f.uid,!0)),f._trust_video_enabled_state_||(L.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(f.uid)),this._handleSetStreamLocalEnable("video",f.uid,!0)),f._trust_video_stream_added_state_||(L.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(f.uid)),this._handleResetAddStream(f,"video")),f._trust_audio_stream_added_state_||(L.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(f.uid)),this._handleResetAddStream(f,"audio")),f._video_added_||f._audio_added_||(L.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(f.uid)),this._handleRemoveStream({uid:f.uid,uint_id:f._uintid}))}))},1e3))}u()}),this._gateway.on(Fn.REQUEST_NEW_GATEWAY_LIST,(t,r)=>{if(!this._joinInfo)return r(new ue(G.UNEXPECTED_ERROR,"can not recover, no join info"));rR(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||sr,this.store).then(a=>{this._joinInfo&&(this._joinInfo.apResponse=a.gatewayInfo.res,this._joinInfo.gatewayAddrs=a.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=a.gatewayInfo.uni_lbs_ip);const l=[];a.gatewayInfo.gatewayAddrs.forEach(u=>{let{address:h}=u;const[f,v]=h.split(":");this._joinInfo&&this._joinInfo.proxyServer?l.push({proxy:this._joinInfo.proxyServer,host:f,port:v}):l.push({host:f,port:v})}),t(l)}).catch(r)}),this._gateway.on(Fn.NETWORK_QUALITY,t=>{this._networkQualitySensitivity==="normal"&&this.safeEmit(At.NETWORK_QUALITY,t)}),this._gateway.on(Fn.STREAM_TYPE_CHANGE,(t,r)=>{this.safeEmit(At.STREAM_TYPE_CHANGED,t,r),He.reportApiInvoke(this._sessionId,{name:hr.STREAM_TYPE_CHANGE,options:[t,r],tag:Dn.TRACER}).onSuccess(JSON.stringify({uid:t,streamType:r}))}),this._gateway.on(Fn.IS_P2P_DISCONNECTED,t=>{this._p2pChannel.isP2PDisconnected()?t(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?t(!1):t(!0)}),this._gateway.on(Fn.NEED_RENEW_SESSION,()=>{this._startSession()}),this._gateway.on(Fn.REQUEST_P2P_CONNECTION_PARAMS,async(t,r,a)=>{try{r(await this._p2pChannel.startP2PConnection(t))}catch(l){a(l)}}),this._gateway.on(Fn.JOIN_RESPONSE,(t,r)=>{if(this.store.useP2P)return;const{dtlsParameters:a,iceParameters:l,candidates:u,rtpCapabilities:h,setup:f,cname:v}=TF(t.ortc,r);this._p2pChannel.connect(l,a,u,h,f,v)}),this._gateway.on(Fn.REQUEST_DC_CONNECTION_PARAMS,t=>{t(this._p2pChannel.getEstablishParams())}),this._gateway.on(Fn.RESET_SIGNAL,t=>{this._p2pChannel.resetConnection(t),this._handleGatewaySignalEvents()}),this._gateway.on(Fn.DATACHANNEL_FAILBACK,()=>{this._joinGateway()}),this._gateway.on(Fn.DATACHANNEL_PRECONNECT,async(t,r,a,l)=>{var u,h,f,v,E,y;await this._p2pChannel.startP2PConnection({turnServer:(u=this._joinInfo)===null||u===void 0?void 0:u.turnServer},!0);const C=function(I,k){let W;return k&&k.ip&&typeof k.port=="number"?(W=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:k.ip,port:k.port.toString(),type:"host",extension:{}}],L.debug("Using remote candidate from AP ".concat(k.ip,":").concat(k.port)),k.ip6&&(W.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:k.ip6,port:k.port.toString(),type:"host",extension:{}}),L.debug("Using IPV6 remote candidate from AP ".concat(k.ip6,":").concat(k.port)))):W=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:I.ip,port:I.port.toString(),type:"host",extension:{}}],W}(t,r);return this._p2pChannel.preConnect({iceUfrag:"".concat((h=this._joinInfo)===null||h===void 0?void 0:h.apResponse.cid,"_").concat((f=this._joinInfo)===null||f===void 0?void 0:f.apResponse.cert),icePwd:"".concat((v=this._joinInfo)===null||v===void 0?void 0:v.apResponse.cid,"_").concat((E=this._joinInfo)===null||E===void 0?void 0:E.apResponse.cert)},{fingerprints:[{hashFunction:"sha-256",fingerprint:(y=Z("FINGERPRINT"))!==null&&y!==void 0?y:t.fingerprint}]},C,{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},"active","o/i14u9pJrxRKAsu").then(a).catch(l)})}_handleGatewaySignalEvents(){this._gateway.signal.on(lt.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(lt.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(lt.ON_ADD_AUDIO_STREAM,t=>this._handleAddAudioOrVideoStream("audio",t.uid,t.ssrcId,t.cname,t.uint_id,t.ortc)),this._gateway.signal.on(lt.ON_ADD_VIDEO_STREAM,t=>this._handleAddAudioOrVideoStream("video",t.uid,t.ssrcId,t.cname,t.uint_id,t.ortc,t.rtxSsrcId)),this._gateway.signal.on(lt.ON_REMOTE_DATASTREAM_UPDATE,t=>{this._handleUpdateDataChannel(t)}),this._gateway.signal.on(lt.ON_REMOTE_FULL_DATASTREAM_INFO,t=>{this._handleUpdateDataChannel({added:t.datastreams,deleted:[]},!0)}),this._gateway.signal.on(lt.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(lt.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(lt.MUTE_AUDIO,t=>this._handleMuteStream(t.uid,Ue.AUDIO,!0)),this._gateway.signal.on(lt.UNMUTE_AUDIO,t=>this._handleMuteStream(t.uid,Ue.AUDIO,!1)),this._gateway.signal.on(lt.MUTE_VIDEO,t=>this._handleMuteStream(t.uid,Ue.VIDEO,!0)),this._gateway.signal.on(lt.UNMUTE_VIDEO,t=>this._handleMuteStream(t.uid,Ue.VIDEO,!1)),this._gateway.signal.on(lt.RECEIVE_METADATA,t=>{const r=Yg(t.metadata);this.safeEmit(At.RECEIVE_METADATA,t.uid,r)}),this._gateway.signal.on(lt.ON_DATA_STREAM,async t=>{if(!t)return;let r=0;if(t.ordered||t.syncWithAudio){const a=this._p2pChannel.getStats(),l=this.remoteUsers.find(h=>h.uid===t.uid),u=a==null?void 0:a.audioRecv.find(h=>h.ssrc===(l==null?void 0:l._audioSSRC));r=u==null?void 0:u.jitterBufferMs}r==null&&(r=0),Fne(t,r,{id:this._clientId,onStreamMessage:typeof this.onStreamMessage=="function"?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})}),this._gateway.signal.on(lt.ON_CRYPT_ERROR,()=>{Hf(()=>{L.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(At.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(lt.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(lt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{L.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,It.TOKEN_EXPIRE),this.safeEmit(At.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(lt.ON_STREAM_FALLBACK_UPDATE,t=>{L.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(t.stream_id,", attr: ").concat(t.stream_type)),this.safeEmit(At.STREAM_FALLBACK,t.stream_id,t.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(lt.ON_PUBLISH_STREAM,t=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:t.proxy})),L.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(t))))}),this._gateway.signal.on(lt.ENABLE_LOCAL_VIDEO,t=>{this._handleSetStreamLocalEnable("video",t.uid,!0)}),this._gateway.signal.on(lt.DISABLE_LOCAL_VIDEO,t=>{this._handleSetStreamLocalEnable("video",t.uid,!1)}),this._gateway.signal.on(Le.REQUEST_TIMEOUT,(t,r)=>{if(this._joinInfo)switch(t){case $e.PUBLISH:{if(!r)return;const u=r.ortc;if(u){var a,l;const h=u.some(E=>{let{stream_type:y}=E;return y===rn.Audio}),f=u.some(E=>{let{stream_type:y}=E;return y!==rn.Audio}),v=u.some(E=>{let{stream_type:y}=E;return y===rn.Screen||y===rn.ScreenLow});r.state==="offer"&&He.publish(this._joinInfo.sid,{eventElapse:fi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:G.TIMEOUT,audio:h,video:f,p2pid:r.p2p_id,publishRequestid:this.store.pubId,screenshare:v,audioName:h?(a=u.find(E=>{let{stream_type:y}=E;return y===rn.Audio}))===null||a===void 0||(a=a.ssrcs[0])===null||a===void 0?void 0:a.ssrcId.toString():void 0,videoName:f?(l=u.find(E=>{let{stream_type:y}=E;return y!==rn.Audio}))===null||l===void 0||(l=l.ssrcs[0])===null||l===void 0?void 0:l.ssrcId.toString():void 0})}break}case $e.SUBSCRIBE:r&&He.subscribe(this._joinInfo.sid,{succ:!1,ec:G.TIMEOUT,audio:r.stream_type===Ue.AUDIO,video:r.stream_type===Ue.VIDEO,peerid:r.stream_id,subscribeRequestid:r.ssrcId,p2pid:this.store.p2pId,eventElapse:fi.measureFromSubscribeStart(this.store.clientId,r.ssrcId)})}}),this._gateway.signal.on(lt.ON_P2P_OK,t=>{this.uid,this._uid}),this._gateway.signal.on(lt.ON_PUBLISHED_USER_LIST,t=>{if(t==null||!t.users)return;Z("BLOCK_LOCAL_CLIENT")&&(t.users=t.users.filter(l=>!td(l.string_id||l.stream_id,this.channelName)));const r=[],a=[];for(const l of t.users){let u=this._users.find(C=>C._uintid===l.stream_id);u?u._trust_in_room_=!0:(u=new mi(l.string_id||l.stream_id,l.stream_id),this._users.push(u),this.getListeners(At.PUBLISHED_USER_LIST).length===0&&(L.debug("[".concat(this._clientId,"] user online"),l.stream_id),this.safeEmit(At.USER_JOINED,u)));const h=pr.Audio&l.stream_type,f=(pr.Video|pr.LwoVideo)&l.stream_type,v=(65280&l.stream_type)!=0,E=h&&u.hasAudio,y=f&&u.hasVideo;f&&(u._trust_video_stream_added_state_=!0,u._video_added_=!0,u._videoSSRC=l.video_ssrc,u._rtxSsrcId=l.video_rtx),h&&(u._trust_audio_stream_added_state_=!0,u._audio_added_=!0,u._audioSSRC=l.audio_ssrc),h&&!E&&this.getListeners(At.PUBLISHED_USER_LIST).length===0&&(L.info("[".concat(this._clientId,"] remote user ").concat(u.uid," published audio")),this.safeEmit(At.USER_PUBLISHED,u,"audio")),f&&!y&&this.getListeners(At.PUBLISHED_USER_LIST).length===0&&(L.info("[".concat(this._clientId,"] remote user ").concat(u.uid," published video")),this.safeEmit(At.USER_PUBLISHED,u,"video")),(h&&!E||f&&!y||v)&&r.push(u),f&&this._p2pChannel.hasPendingRemoteMedia(u,"video")&&a.push({user:u,mediaType:"video"}),h&&this._p2pChannel.hasPendingRemoteMedia(u,"audio")&&a.push({user:u,mediaType:"audio"})}a.length>0&&(L.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(a.map(l=>"user: ".concat(l.user.uid,", mediaType: ").concat(l.mediaType)).join("; ")," ")),this.massSubscribe(a).catch(l=>{L.error("[".concat(this._clientId,"] mass resubscribe error"),l.toString())})),this.getListeners(At.PUBLISHED_USER_LIST).length>0?Z("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=r:(L.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(r.map(l=>l.uid).join(", "))),this.safeEmit(At.PUBLISHED_USER_LIST,r)):L.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(r.map(l=>l.uid).join(", ")))}),this._gateway.signal.on(lt.ON_RTP_CAPABILITY_CHANGE,t=>{const{video_codec:r}=t;this._p2pChannel instanceof Vr&&this._p2pChannel.updateRemoteRTPCapabilities(r.map(a=>a.toLowerCase()).filter(a=>{var l;return Ke(l=Object.keys(ed)).call(l,a)}))})}_handleP2PEvents(){this._gateway.signal.on(lt.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(mn.PUBLISH,async(t,r)=>{t.forEach(a=>a.kind===Ue.VIDEO?(this._handleP2PAddAudioOrVideoStream("video",r),a.isMuted?this._handleMuteStream(r,Ue.VIDEO,!0):this._handleMuteStream(r,Ue.VIDEO,!1)):(this._handleP2PAddAudioOrVideoStream("audio",r),a.isMuted?this._handleMuteStream(r,Ue.AUDIO,!0):this._handleMuteStream(r,Ue.AUDIO,!1)))}),this._gateway.signal.on(Le.P2P_START,async(t,r)=>{if(this._p2pChannel instanceof Un){var a;r(await this._p2pChannel.startP2P({turnServer:(a=this._joinInfo)===null||a===void 0?void 0:a.turnServer},t))}}),this._gateway.signal.on(Le.P2P_CONNECTION,async t=>{this._p2pChannel instanceof Un&&await this._p2pChannel.p2pConnect(t)}),this._gateway.signal.on(Le.P2P_REMOTE_CANDIDATE_UPDATE,t=>{this._p2pChannel instanceof Un&&this._p2pChannel.addRemoteCandidate(JSON.parse(t))}),this._gateway.signal.on(mn.SUBSCRIBE,async(t,r,a)=>{if(this._p2pChannel instanceof Un){const{trackType:l}=JSON.parse(t);try{await this._p2pChannel.dopublish(l),r()}catch(u){a(u)}}}),this._gateway.signal.on(mn.UNSUBSCRIBE,async(t,r,a)=>{if(this._p2pChannel instanceof Un){const{mediaType:l}=JSON.parse(t);try{await this._p2pChannel.doUnpublish(l),r()}catch(u){a(u)}}}),this._gateway.signal.on(mn.EXCHANGE_SDP,async(t,r,a)=>{if(this._p2pChannel instanceof Un){const{type:l,sdp:u}=JSON.parse(t);try{r(await this._p2pChannel.setDescription(l,u))}catch(h){a(h)}}}),this._gateway.signal.on(mn.UNPUBLISH,async(t,r,a)=>{if(this._p2pChannel instanceof Un){const{unpubMsg:l,uid:u}=t;if(l.length===1){const h=l[0].stream_type===rn.Audio?Ue.AUDIO:Ue.VIDEO;this._handleMuteStream(u,h,!0);const{sdp:f}=t;if(this._p2pChannel instanceof Un&&f){const v=this._users.find(E=>E.uid===u);if(!v)return L.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(u)),void r();this._p2pChannel.unsubscribe(v,f,h).then(E=>{E&&r(E)}).catch(a)}else r()}else this._handleRemoveStream(t,r,a)}}),this._gateway.signal.on(mn.CONTROL,async(t,r,a)=>{const{action:l,sdp:u,isMuteAll:h,uid:f}=t;switch(l){case Ec.MUTE_LOCAL_VIDEO:this._handleMuteStream(f,Ue.VIDEO,!0,u,r,a);break;case Ec.MUTE_LOCAL_AUDIO:r(),this._handleMuteStream(f,Ue.AUDIO,!0);break;case Ec.UNMUTE_LOCAL_VIDEO:r(),this._handleP2PAddAudioOrVideoStream("video",f),this._handleMuteStream(f,Ue.VIDEO,!1);break;case Ec.UNMUTE_LOCAL_AUDIO:r(),this._handleP2PAddAudioOrVideoStream("audio",f),this._handleMuteStream(f,Ue.AUDIO,!1)}h&&this._handleRemoveStream(t,r,a)}),this._gateway.signal.on(mn.DO_SUBSCRIBE,async(t,r,a)=>{if(this._p2pChannel instanceof Un){const{kind:l,sdp:u,ssrcId:h,uid:f}=t,v=this._users.find(E=>E.uid===f);if(!v)return L.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)")),void r();try{r(await this._p2pChannel.subscribe(v,l,u,h))}catch(E){a(E)}}}),this._gateway.signal.on(mn.DO_UNSUBSCRIBE,async(t,r,a)=>{if(this._p2pChannel instanceof Un){const{uid:l,kind:u,sdp:h}=t,f=this._users.find(v=>v.uid===l);if(!f)return L.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)")),void r();try{r(await this._p2pChannel.unsubscribe(f,h,u))}catch(v){a(v)}}}),this._gateway.signal.on(mn.RESTART_ICE,async(t,r,a)=>{if(this._p2pChannel instanceof Un)try{r(await this._p2pChannel.setDescription("remote",t))}catch(l){a(l)}}),this._p2pChannel.on(Je.RequestP2PRestartICE,async(t,r,a)=>{try{r(await this._gateway.sendExtensionMessage(mn.RESTART_ICE,t))}catch(l){a(l)}}),this._p2pChannel.on(Je.LocalCandidate,t=>{this._gateway.sendExtensionMessage(mn.CANDIDATE,JSON.stringify(t))}),this._p2pChannel.on(Je.RequestP2PMuteLocal,async(t,r,a)=>{try{r(await this._gateway.sendExtensionMessage(mn.CONTROL,t))}catch(l){a(l)}}),this._p2pChannel.on(Je.RequestP2PPublish,async(t,r,a)=>{try{r(await this._gateway.sendExtensionMessage(mn.DO_SUBSCRIBE,t))}catch(l){a(l)}}),this._p2pChannel.on(Je.RequestP2PUnPublish,async(t,r,a)=>{try{r(await this._gateway.sendExtensionMessage(mn.DO_UNSUBSCRIBE,t))}catch(l){a(l)}}),this._p2pChannel.on(Je.RequestP2PUnmuteRemote,async(t,r,a)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(t,this._joinInfo.stringUid||this._joinInfo.uid),r()}catch(l){l.code===G.DISCONNECT_P2P?r():a(l)}else r()}),this._p2pChannel.on(Je.RequestP2PMuteRemote,async(t,r,a)=>{if(this._joinInfo)try{await this._gateway.muteRemote(t,this._joinInfo.stringUid||this._joinInfo.uid),r()}catch(l){l.code===G.DISCONNECT_P2P?r():a(l)}else r()}),this._p2pChannel.on(Je.StateChange,(t,r)=>{r===$t.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){this._p2pChannel.on(Je.RequestMuteLocal,async(t,r,a)=>{if(this._joinInfo)try{await this._gateway.muteLocal(t,this._joinInfo.stringUid||this._joinInfo.uid),r()}catch(l){l.code===G.DISCONNECT_P2P?r():a(l)}else r()}),this._p2pChannel.on(Je.RequestUnmuteLocal,async(t,r,a)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(t,this._joinInfo.stringUid||this._joinInfo.uid),r()}catch(l){l.code===G.DISCONNECT_P2P?r():a(l)}else r()}),this._p2pChannel.on(Je.RequestRePublish,(t,r,a)=>{this.publish(t,!1).then(r).catch(a)}),this._p2pChannel.on(Je.RequestRePublishDataChannel,(t,r,a)=>{me.all(t.map(async l=>{await this._p2pChannel.publishDataChannel([l]);const u={streamId:l.id,ordered:l.ordered,maxRetransmits:l.maxRetransmits,metadata:l.metadata,channelId:l._originDataChannelId};try{await this._gateway.publishDataChannel(this._uid,u,!0)}catch(h){if(h.code!==G.DISCONNECT_P2P)throw h}})).then(r).catch(a)}),this._p2pChannel.on(Je.RequestReSubscribe,async(t,r,a)=>{try{for(const{user:l,kind:u}of t)u===Ue.VIDEO?await this.subscribe(l,"video"):await this.subscribe(l,"audio");r()}catch(l){a(l)}}),this._p2pChannel.on(Je.RequestUploadStats,(t,r)=>{this._gateway.uploadStats(t,r)}),this._p2pChannel.on(Je.MediaReconnectStart,t=>{this.safeEmit(At.MEDIA_RECONNECT_START,t)}),this._p2pChannel.on(Je.MediaReconnectEnd,t=>{this.safeEmit(At.MEDIA_RECONNECT_END,t)}),this._p2pChannel.on(Je.NeedSignalRTT,t=>{t(this._gateway.getSignalRTT())}),this._p2pChannel.on(Je.RequestRestartICE,async t=>{if(this._p2pChannel instanceof Un)return;const r=await this._p2pChannel.restartICE(t),a=await r.next();if(a.done)return;const l=a.value;let u;try{u=await this._gateway.restartICE({iceParameters:l})}catch(f){return void r.throw(f)}const{iceParameters:h}=function(f){const v=f.iceParameters;return{iceParameters:{iceUfrag:v.iceUfrag,icePwd:v.icePwd}}}(u);await r.next({remoteIceParameters:h})}),this._p2pChannel.on(Je.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(Je.RequestReconnectPC,async()=>{var t;const{iceParameters:r,dtlsParameters:a,rtpCapabilities:l}=await this._p2pChannel.startP2PConnection({turnServer:(t=this._joinInfo)===null||t===void 0?void 0:t.turnServer}),{gatewayEstablishParams:u,gatewayAddress:h}=await this._gateway.reconnectPC({iceParameters:r,dtlsParameters:a,rtpCapabilities:l}),{dtlsParameters:f,iceParameters:v,candidates:E,rtpCapabilities:y,setup:C,cname:I}=TF(u,h);await this._p2pChannel.connect(v,f,E,y,C,I),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(Je.RequestUnpublishForReconnectPC,async(t,r,a)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(t,this._uid),r()):a()}),this._p2pChannel.on(Je.P2PLost,()=>{this.safeEmit(At.P2P_LOST,this.store.uid)}),this._p2pChannel.on(Je.UpdateVideoEncoder,t=>{t._encoderConfig&&this._gateway.setVideoProfile(t._encoderConfig)}),this._p2pChannel.on(Je.ConnectionTypeChange,t=>{this.safeEmit(At.IS_USING_CLOUD_PROXY,t)}),this._p2pChannel.on(Je.RequestLowStreamParameter,t=>{t(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(Je.QueryClientConnectionState,t=>{t(this.connectionState)})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(t){if(this.connectionState!=="CONNECTED"||!this._joinInfo)throw new ue(G.INVALID_OPERATION,"[".concat(this._clientId,"] Client did not join channel"));if(this._inspect)throw new ue(G.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));if(!t)throw new ue(G.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig is necessary"));if(!t.inspectType||!Array.isArray(t.inspectType))throw new ue(G.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.inspectType is necessary and is an instance of Array."));{const r=[...new Set(t.inspectType)];r.forEach(a=>{var l;if(!Ke(l=["supervise","moderation"]).call(l,a))throw new ue(G.INVALID_PARAMS,"[".concat(this._clientId,"] ").concat(a," is not a valid inspect type."))}),t.inspectType=r}if(t&&t.extraInfo&&t.extraInfo.length>1024)throw new ue(G.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.extraInfo length cannot exceed 1024 bytes"));try{const r=new oE(t);this._inspect=r,this.handleVideoInspectEvents(this._inspect),await r.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},sr)}catch(r){throw Array.isArray(r)?r[0]:r}}async disableContentInspect(){if(!this._inspect)throw new ue(G.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(t){throw Array.isArray(t)?t[0]:t}}async setImageModeration(t,r){if(Yu(t,"enabled"),t){if(!r)throw new ue(G.INVALID_PARAMS,"[".concat(this._clientId,"] config is necessary"));if(cn(r.interval,"interval",1e3,1/0),this.connectionState!=="CONNECTED"||!this._joinInfo)throw new ue(G.INVALID_OPERATION,"[".concat(this._clientId,'] can not enable image moderation, not joined"'));try{if(this._moderation)return void this._moderation.updateConfig(r);const a=new CR(r);this._moderation=a,this.handleImageModerationEvents(this._moderation),await a.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},sr)}catch(a){throw Array.isArray(a)?a[0]:a}}else{if(!this._moderation)throw new ue(G.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(a){throw Array.isArray(a)?a[0]:a}}}handleImageModerationEvents(t){t.on(Ia.CONNECTION_STATE_CHANGE,(r,a)=>{if(this.safeEmit(At.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,r,a),r===Do.CONNECTED){if(this.connectionState!=="CONNECTED")throw this.setImageModeration(!1),new ue(G.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");t.inspectImage()}}),t.on(Ia.CLIENT_LOCAL_VIDEO_TRACK,r=>{r(this.localTracks.filter(a=>a.trackMediaType==="video")[0])})}handleVideoInspectEvents(t){t.on(_r.CONNECTION_STATE_CHANGE,(r,a)=>{if(this.safeEmit(At.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,r,a),a===ea.CONNECTED){if(this.connectionState!=="CONNECTED")return void this.safeEmit(At.CONTENT_INSPECT_ERROR,new ue(G.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));t.inspectImage()}}),t.on(_r.INSPECT_RESULT,(r,a)=>{var l;if((a==null?void 0:a.code)===G.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return L.debug("Stop inspect content because that has left channel"),this==null||(l=this._inspect)===null||l===void 0||l.close(),void(this._inspect=void 0);this.safeEmit(At.CONTENT_INSPECT_RESULT,r,a)}),t.on(_r.CLIENT_LOCAL_VIDEO_TRACK,r=>{r(this.localTracks.filter(a=>a.trackMediaType==="video")[0])})}getJoinChannelServiceRecords(){return L.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(t){Yu(t,"enabled"),an("ENABLE_PUBLISH_AUDIO_FILTER",t),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(t)}_handleResetAddStream(t,r){switch(r){case"audio":t._audio_added_=!1,t._trust_audio_stream_added_state_=!0;break;case"video":t._video_added_=!1,t._trust_video_stream_added_state_=!0}}}Te([Ze(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",me)],dn.prototype,"leave",null),Te([Ze({argsMap:(i,t)=>{if(!Array.isArray(t)){if(!(t instanceof pi))return[t];t=[t]}return t.map(r=>r?Object(r).toString():"null")}}),V("design:type",Function),V("design:paramtypes",[Object,Boolean]),V("design:returntype",me)],dn.prototype,"publish",null),Te([Ze({argsMap:(i,t)=>(t||(t=[]),t instanceof WM?[t.getChannelId()]:(Array.isArray(t)||(t=[t]),t.map(r=>r.getTrackId())))}),V("design:type",Function),V("design:paramtypes",[Object]),V("design:returntype",me)],dn.prototype,"unpublish",null),Te([Ze({argsMap:(i,t,r,a)=>[t.uid,r,a]}),V("design:type",Function),V("design:paramtypes",[mi,String,Number]),V("design:returntype",me)],dn.prototype,"subscribe",null),Te([Ze({argsMap:(i,t)=>t.map(r=>{let{user:a,mediaType:l}=r;return[a==null?void 0:a.uid,l]})}),V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],dn.prototype,"massSubscribe",null),Te([Ze({argsMap:(i,t,r,a)=>[t.uid,r,a]}),V("design:type",Function),V("design:paramtypes",[mi,String,Number]),V("design:returntype",me)],dn.prototype,"unsubscribe",null),Te([Ze({argsMap:(i,t)=>t.map(r=>{let{user:a,mediaType:l}=r;return{uid:a==null?void 0:a.uid,mediaType:l}})}),V("design:type",Function),V("design:paramtypes",[Array]),V("design:returntype",me)],dn.prototype,"massUnsubscribe",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[Object]),V("design:returntype",me)],dn.prototype,"setLowStreamParameter",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",me)],dn.prototype,"enableDualStream",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",me)],dn.prototype,"disableDualStream",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[String,Object]),V("design:returntype",me)],dn.prototype,"setClientRole",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[String,Boolean]),V("design:returntype",void 0)],dn.prototype,"setProxyServer",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[Object,Boolean]),V("design:returntype",void 0)],dn.prototype,"setTurnServer",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",void 0)],dn.prototype,"setLicense",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[Number]),V("design:returntype",void 0)],dn.prototype,"startProxyServer",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],dn.prototype,"stopProxyServer",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[Object]),V("design:returntype",void 0)],dn.prototype,"setLocalAccessPointsV2",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[Array,String]),V("design:returntype",void 0)],dn.prototype,"setLocalAccessPoints",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[Number]),V("design:returntype",me)],dn.prototype,"setRemoteDefaultVideoStreamType",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[Object,Number]),V("design:returntype",me)],dn.prototype,"setRemoteVideoStreamType",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[Object,Number]),V("design:returntype",me)],dn.prototype,"setStreamFallbackOption",null),Te([Ze({argsMap:(i,t)=>[t]}),V("design:type",Function),V("design:paramtypes",[String,String,Uint8Array]),V("design:returntype",void 0)],dn.prototype,"setEncryptionConfig",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],dn.prototype,"renewToken",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",void 0)],dn.prototype,"enableAudioVolumeIndicator",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[String,Boolean]),V("design:returntype",me)],dn.prototype,"startLiveStreaming",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[Object]),V("design:returntype",me)],dn.prototype,"setLiveTranscoding",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[String]),V("design:returntype",me)],dn.prototype,"stopLiveStreaming",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[String,Object]),V("design:returntype",me)],dn.prototype,"addInjectStreamUrl",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",me)],dn.prototype,"removeInjectStreamUrl",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[Kv]),V("design:returntype",me)],dn.prototype,"startChannelMediaRelay",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[Kv]),V("design:returntype",me)],dn.prototype,"updateChannelMediaRelay",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",me)],dn.prototype,"stopChannelMediaRelay",null),Te([Ze({argsMap:(i,t)=>(Array.isArray(t)||(t=[t]),[JSON.stringify(t)])}),V("design:type",Function),V("design:paramtypes",[Object]),V("design:returntype",me)],dn.prototype,"sendCustomReportMessage",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[Object,Object]),V("design:returntype",me)],dn.prototype,"pickSVCLayer",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[Number]),V("design:returntype",me)],dn.prototype,"setRTM2Flag",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[Object]),V("design:returntype",me)],dn.prototype,"enableContentInspect",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",me)],dn.prototype,"disableContentInspect",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[Boolean,Object]),V("design:returntype",me)],dn.prototype,"setImageModeration",null),Te([Ze({reportResult:!0}),V("design:type",Function),V("design:paramtypes",[]),V("design:returntype",Array)],dn.prototype,"getJoinChannelServiceRecords",null),Te([Ze(),V("design:type",Function),V("design:paramtypes",[Boolean]),V("design:returntype",me)],dn.prototype,"setPublishAudioFilterEnabled",null);class C0{constructor(t,r){w(this,"id",0),w(this,"element",void 0),w(this,"peerPair",void 0),w(this,"context",void 0),w(this,"audioPlayerElement",void 0),w(this,"audioTrack",void 0),C0.count+=1,this.id=C0.count,this.element=t,this.context=r}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=t=>{const r=document.createElement("audio");r.srcObject=new MediaStream([t.track]),r.play(),this.audioPlayerElement=r}}async switchSdp(){if(!this.peerPair)return;const t=async(a,l)=>{const u=l==="offer"?await a.createOffer():await a.createAnswer();return await a.setLocalDescription(u),a.iceGatheringState==="complete"?a.localDescription:new me(h=>{a.onicegatheringstatechange=()=>{a.iceGatheringState==="complete"&&h(a.localDescription)}})},r=async(a,l)=>await a.setRemoteDescription(l);try{const a=await t(this.peerPair[0],"offer");await r(this.peerPair[1],a);const l=await t(this.peerPair[1],"answer");await r(this.peerPair[0],l)}catch(a){throw new ue(G.LOCAL_AEC_ERROR,a.toString()).print()}}async getTracksFromMediaElement(t){if(this.audioTrack)return this.audioTrack;let r;try{t instanceof HTMLVideoElement&&(t.captureStream?t.captureStream():t.mozCaptureStream()),r=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(t).connect(r)}catch(l){throw new ue(G.LOCAL_AEC_ERROR,l.toString()).print()}if(!r)throw new ue(G.LOCAL_AEC_ERROR,"no dest node when local aec").print();const a=r.stream.getAudioTracks()[0];return this.audioTrack=a,a}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const t=this.element,r=await this.getTracksFromMediaElement(t);this.peerPair&&this.peerPair[0].addTrack(r),await this.switchSdp()}close(){L.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(t=>{t.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}w(C0,"count",0);const jne=window.AudioContext||window.webkitAudioContext;class wU{constructor(){w(this,"units",[]),w(this,"context",void 0)}processExternalMediaAEC(t){if(!this._doesEnvironmentNeedAEC())return L.debug("the system does not need to process local aec"),-1;this.context||(this.context=new jne);let r=this.units.find(a=>a&&a.getElement()===t);return r||(r=new C0(t,this.context),this.units.push(r)),r.startEchoCancellation(),L.debug("start processing local audio echo cancellation, id is",r.id),r.id}_doesEnvironmentNeedAEC(){return Wt().name!==Zt.SAFARI}}Te([Ze({report:He}),V("design:type",Function),V("design:paramtypes",[HTMLAudioElement]),V("design:returntype",Number)],wU.prototype,"processExternalMediaAEC",null);const Vne=new wU;function IU(i,t){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),r.push.apply(r,a)}return r}function AU(i){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IU(Object(r),!0).forEach(function(a){w(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):IU(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}const TR=window||document;function OU(i){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!TR)return;const r=Or._cspEventHandlerPointer;if(r&&t)return void console.error(r,t);const a=l=>{if(!(l&&l.blockedURI&&(Or.onSecurityPolicyViolation||Or.getListeners(Us.SECURITY_POLICY_VIOLATION).length>0)))return;const u=l.blockedURI;Z("CSP_DETECTED_HOSTNAME_LIST").some(h=>Ke(u).call(u,h))&&(Or.onSecurityPolicyViolation&&typeof Or.onSecurityPolicyViolation=="function"&&Or.onSecurityPolicyViolation(l),Or.getListeners(Us.SECURITY_POLICY_VIOLATION).length>0&&Or.safeEmit(Us.SECURITY_POLICY_VIOLATION,l))};r&&TR.removeEventListener("securitypolicyviolation",r),(t||i&&typeof i=="function"||Or.getListeners(Us.SECURITY_POLICY_VIOLATION).length>0)&&TR.addEventListener("securitypolicyviolation",a),Or._cspEventHandlerPointer=a}an("PROCESS_ID","process-".concat(un(8,""),"-").concat(un(4,""),"-").concat(un(4,""),"-").concat(un(4,""),"-").concat(un(12,""))),function(){const i=Wt();Ti.getDisplayMedia=function(t){return!!(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)}(),Ti.getStreamFromExtension=i.name===Zt.CHROME&&Number(i.version)>34,Ti.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const t=new RTCPeerConnection;let r=!1;try{t.addTransceiver("audio"),r=!0}catch{}return t.close(),r}(),Ti.supportMinBitrate=i.name===Zt.CHROME||i.name===Zt.EDGE,Ti.supportSetRtpSenderParameters=function(){const t=Wt();return!window.RTCRtpSender||!window.RTCRtpSender.prototype.setParameters||!window.RTCRtpSender.prototype.getParameters?!1:!!Ll()||!(!Di()&&!Gg())||t.name===Zt.FIREFOX&&Number(t.version)>=64}(),i.name===Zt.SAFARI&&(Number(i.version)>=14?Ti.supportDualStream=!0:Ti.supportDualStream=!1),Ti.webAudioMediaStreamDest=function(){const t=Wt();return!(t.name===Zt.SAFARI&&Number(t.version)<12)}(),Ti.supportReplaceTrack=function(){return window.RTCRtpSender?typeof RTCRtpSender.prototype.replaceTrack=="function":!1}(),Ti.supportWebGL=typeof WebGLRenderingContext<"u",Ti.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,Ll()||(Ti.webAudioWithAEC=!0),Ti.supportShareAudio=function(){const t=Wt();return(t.os===Rr.WIN_10||t.os===Rr.WIN_81||t.os===Rr.WIN_7||t.os===Rr.LINUX||t.os===Rr.MAC_OS)&&t.name===Zt.CHROME&&Number(t.version)>=74}(),Ti.supportDataChannel=function(){return!!(Sb(76)||function(t){const r=Wt();return!(r.name!==Zt.FIREFOX||!r.osVersion)&&Number(r.version)>=t}(68)||function(t){const r=Wt();return!(r.name!==Zt.SAFARI||!r.osVersion)&&Number(r.version)>=t}(14))}(),Ti.supportPCSetConfiguration=function(){const t=window.RTCPeerConnection;return!Cn()&&!!t&&t.prototype.setConfiguration instanceof Function}(),Ti.supportWebRTCEncodedTransform=function(){const t=Wt();return t.name==="Chrome"&&Number(t.version)>=86}(),Ti.supportWebRTCInsertableStream=function(){const t=Wt();return(t.name===Zt.CHROME||t.name===Zt.EDGE)&&Number(t.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),ns(()=>{Ti.supportDualStreamEncoding=function(){const t=Wt();return Z("DISABLE_WEBAUDIO")?!0:t.name==="Safari"&&Number(t.version)>=14||!!(t.name==="Chrome"&&/Windows/i.test(t.os||"")&&Number(t.version)>=100&&Z("CHROME_DUAL_STREAM_USE_ENCODING"))}(),L.info("browser compatibility",JSON.stringify(Ti),JSON.stringify(i))})}(),function(){let i;try{i=window.localStorage.getItem("websdk_ng_global_parameter")}catch(t){return void L.error("Error loading sdk config",t.message)}if(i)try{const t=JSON.parse(window.atob(i)),r=Date.now();L.debug("Loading global parameters from cache",t),Object.keys(t).forEach(a=>{if(Object.prototype.hasOwnProperty.call($i,a)){const{value:l,expires:u}=t[a];if(u&&u<=r)return;Fl[a]=l,$i[a]=l}})}catch(t){L.error("Error loading mutableParamsCache: ".concat(i),t.message)}}(),Array.isArray(Fl.AREAS)&&Fl.AREAS.length>0&&ZT(Fl.AREAS,!0);const Or=function(i){const t=new An,r=i,a={getListeners:t.getListeners.bind(t),on:(l,u)=>(function(h,f){h===Us.SECURITY_POLICY_VIOLATION&&OU(f,!0)}(l,u),t.on.bind(t)(l,u)),addListener:t.addListener.bind(t),once:t.once.bind(t),off:t.off.bind(t),removeAllListeners:t.removeAllListeners.bind(t),emit:t.emit.bind(t),safeEmit:t.safeEmit.bind(t)};return AU(AU({},r),a)}({__TRACK_LIST__:kh,VERSION:Ra,BUILD:Xb,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:(i,t,r)=>{L.debug("setParameter key:".concat(i,", value:").concat(JSON.stringify(t))),an(i,t,r)},getParameter:Z,getSupportedCodec:async function(){let i={audio:[],video:[]};try{let t=new RTCPeerConnection;t.addTransceiver("video",{direction:"recvonly"}),t.addTransceiver("audio",{direction:"recvonly"});const r=(await t.createOffer()).sdp;if(!r)return i;t.close(),t=null,i=function(a){const l={video:[],audio:[]};return a.match(/ VP8/i)&&l.video.push("VP8"),a.match(/ VP9/i)&&l.video.push("VP9"),a.match(/ AV1/i)&&l.video.push("AV1"),a.match(/ H264/i)&&l.video.push("H264"),a.match(/ H265/i)&&l.video.push("H265"),a.match(/ opus/i)&&l.audio.push("OPUS"),a.match(/ PCMU/i)&&l.audio.push("PCMU"),a.match(/ PCMA/i)&&l.audio.push("PCMA"),a.match(/ G722/i)&&l.audio.push("G722"),l}(r)}catch(t){throw new ue(G.CREATE_OFFER_FAILED,t.toString&&t.toString()).print()}return i},checkSystemRequirements:function(){const i=He.reportApiInvoke(null,{name:hr.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:Dn.TRACER});let t=!1;try{const u=window.RTCPeerConnection,h=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,f=window.WebSocket;t=!!(u&&h&&f)}catch(u){return L.error("check system requirement failed: ",u),!1}let r=!1;const a=Wt();a.name===Zt.CHROME&&Number(a.version)>=58&&(!XQ()||YQ())&&(r=!0),a.name===Zt.FIREFOX&&Number(a.version)>=56&&(r=!0),a.name===Zt.OPERA&&Number(a.version)>=45&&(r=!0),a.name===Zt.SAFARI&&Number(a.version)>=11&&(r=!0),(kk()||Wt().name===Zt.QQ)&&(r=!0),L.debug("checkSystemRequirements, api:",t,"browser",r);const l=t&&r;return i.onSuccess(l),l},getDevices:function(i){return ia.enumerateDevices(!0,!0,i)},getMicrophones:function(i){return ia.getRecordingDevices(i)},getCameras:function(i){return ia.getCamerasDevices(i)},getElectronScreenSources:PL,getPlaybackDevices:function(i){return ia.getSpeakers(i)},createClient:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const t=He.reportApiInvoke(null,{name:hr.CREATE_CLIENT,options:[i],tag:Dn.TRACER});try{(function(r){wr(r.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),wr(r.mode,"config.mode",["rtc","live"]),r.audioCodec!==void 0&&wr(r.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),r.proxyServer!==void 0&&di(r.proxyServer,"config.proxyServer",1,1e4),r.turnServer!==void 0&&Hk(r.turnServer),r.httpRetryConfig!==void 0&&$k(r.httpRetryConfig),r.websocketRetryConfig!==void 0&&$k(r.websocketRetryConfig)})(i)}catch(r){throw t.onError(r),r}return Bne()||(i.codec="vp8",L.debug("browser not support vp9, force use vp8"),an("FILTER_VIDEO_CODEC",["vp8"])),i.audioCodec===void 0&&(i.audioCodec="opus"),t.onSuccess(),new dn(S0(S0({forceWaitGatewayResponse:!0},i),{},{role:i.mode==="rtc"?"host":i.role||"audience"}))},createCameraVideoTrack:async function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=He.reportApiInvoke(null,{tag:Dn.TRACER,name:hr.CREATE_CAM_VIDEO_TRACK,options:[Rv({},i)]}),r=Tv(i),a=un(8,"track-cam-");let l=null;const u=i.encoderConfig==="720p_auto";L.info("start create camera video track with config",JSON.stringify(i),"trackId",a);try{l=(await ra({video:r},a)).getVideoTracks()[0]||null}catch(f){throw t.onError(f),f}if(!l){const f=new be(G.UNEXPECTED_ERROR,"can not find track in media stream");return t.onError(f),f.throw(L)}i.optimizationMode&&RT(a,l,i,_c(i.encoderConfig));const h=new Gl(l,i,r,i.scalabiltyMode?gv(i.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},i.optimizationMode,a);return u&&h.startMonitorStats(),t.onSuccess(h.getTrackId()),L.info("create camera video success, trackId:",a),h},createCustomVideoTrack:function(i){const t=He.reportApiInvoke(null,{tag:Dn.TRACER,name:hr.CREATE_CUSTOM_VIDEO_TRACK,options:[i]}),r=new bt(i.mediaStreamTrack,{width:i.width,height:i.height,frameRate:i.frameRate,bitrateMax:i.bitrateMax,bitrateMin:i.bitrateMin},i.scalabiltyMode?gv(i.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},i.optimizationMode,un(8,"track-cus-"),[vn.CUSTOM_TRACK]);return t.onSuccess(r.getTrackId()),L.info("create custom video track success with config",i,"trackId",r.getTrackId()),r},createScreenVideoTrack:async function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const r=He.reportApiInvoke(null,{tag:Dn.TRACER,name:hr.CREATE_SCREEN_VIDEO_TRACK,options:[Rv({},i),t]}),a=i.encoderConfig==="720p_auto";i.encoderConfig?typeof i.encoderConfig=="string"||i.encoderConfig.width&&i.encoderConfig.height||(i.encoderConfig.width={max:1920},i.encoderConfig.height={max:1080}):i.encoderConfig="1080p_2";const l=function(C){const I={};C.screenSourceType&&(I.mediaSource=C.screenSourceType),C.extensionId&&yb()&&(I.extensionId=C.extensionId);const{displaySurface:k,selfBrowserSurface:W,surfaceSwitching:$,systemAudio:z}=C;(Sb(107)||Ok(107)||xk(93))&&(k&&(wr(k,"displaySurface",["browser","window","monitor"]),I.displaySurface=k),W?(wr(W,"selfBrowserSurface",["exclude","include"]),I.selfBrowserSurface=W):I.selfBrowserSurface="include",$&&(wr($,"surfaceSwitching",["exclude","include"]),I.surfaceSwitching=$)),(Sb(105)||Ok(105)||xk(91))&&z&&(wr(z,"systemAudio",["exclude","include"]),I.systemAudio=z),C.electronScreenSourceId&&(I.sourceId=C.electronScreenSourceId);const X=C.encoderConfig?uT(C.encoderConfig):null;return I.mandatory={chromeMediaSource:"desktop",maxWidth:X?X.width:void 0,maxHeight:X?X.height:void 0},X&&(X.frameRate&&(typeof X.frameRate=="number"?(I.mandatory.maxFrameRate=X.frameRate,I.mandatory.minFrameRate=X.frameRate):(I.mandatory.maxFrameRate=X.frameRate.max||X.frameRate.ideal||X.frameRate.exact||void 0,I.mandatory.minFrameRate=X.frameRate.min||X.frameRate.ideal||X.frameRate.exact||void 0),I.frameRate=X.frameRate),X.width&&(I.width=X.width),X.height&&(I.height=X.height)),I}(i),u=un(8,"track-scr-v-");let h=null,f=null;const v=fn();if(!v.supportShareAudio&&t==="enable"){const C=new be(G.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return r.onError(C),C.throw(L)}L.info("start create screen video track with config",i,"withAudio",t,"trackId",u);try{const C=await ra({screen:l,screenAudio:t==="auto"?v.supportShareAudio:t==="enable"},u);h=C.getVideoTracks()[0]||null,f=C.getAudioTracks()[0]||null}catch(C){throw r.onError(C),C}if(!h){const C=new be(G.UNEXPECTED_ERROR,"can not find track in media stream");return r.onError(C),C.throw(L)}if(!f&&t==="enable"){h&&h.stop();const C=new be(G.SHARE_AUDIO_NOT_ALLOWED);return r.onError(C),C.throw(L)}i.optimizationMode||(i.optimizationMode="detail"),i.optimizationMode&&(RT(u,h,i,i.encoderConfig&&uT(i.encoderConfig)||void 0),i.encoderConfig&&typeof i.encoderConfig!="string"&&(i.encoderConfig.bitrateMin=i.encoderConfig.bitrateMax));const E=new bt(h,i.encoderConfig?uT(i.encoderConfig):{},i.scalabiltyMode?gv(i.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},i.optimizationMode,u,[vn.SCREEN_TRACK]);if(a&&E.startMonitorStats(),!f)return r.onSuccess(E.getTrackId()),L.info("create screen video track success","video:",E.getTrackId()),E;const y=new en(f,void 0,un(8,"track-scr-a-"),!1,!0);return r.onSuccess([E.getTrackId(),y.getTrackId()]),L.info("create screen video track success","video:",E.getTrackId(),"audio:",y.getTrackId()),[E,y]},createMicrophoneAndCameraTracks:async function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=He.reportApiInvoke(null,{tag:Dn.TRACER,name:hr.CREATE_MIC_AND_CAM_TRACKS,options:[i,t]}),a=t.encoderConfig==="720p_auto",l=Tv(t),u=WL(i),h=un(8,"track-mic-"),f=un(8,"track-cam-");let v=null,E=null;L.info("start create camera video track(".concat(f,") and microphone audio track(").concat(h,") with config, audio: ").concat(JSON.stringify(i),", video: ").concat(JSON.stringify(t)));try{const I=await ra({audio:u,video:l},"".concat(h,"-").concat(f));v=I.getAudioTracks()[0],E=I.getVideoTracks()[0]}catch(I){throw r.onError(I),I}if(!v||!E){const I=new be(G.UNEXPECTED_ERROR,"can not find tracks in media stream");return r.onError(I),I.throw(L)}t.optimizationMode&&RT(f,E,t,_c(t.encoderConfig));const y=new Wl(v,i,u,h),C=new Gl(E,t,l,t.scalabiltyMode?gv(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,f);return a&&C.startMonitorStats(),r.onSuccess([y.getTrackId(),C.getTrackId()]),L.info("create camera video track(".concat(f,") and microphone audio track(").concat(h,") success")),[y,C]},createMicrophoneAudioTrack:async function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=He.reportApiInvoke(null,{tag:Dn.TRACER,name:hr.CREATE_MIC_AUDIO_TRACK,options:[i]}),r=WL(i),a=un(8,"track-mic-");let l=null;L.info("start create microphone audio track with config",JSON.stringify(i),"trackId",a);try{l=(await ra({audio:r},a)).getAudioTracks()[0]||null}catch(h){throw t.onError(h),h}if(!l){const h=new be(G.UNEXPECTED_ERROR,"can not find track in media stream");return t.onError(h),h.throw(L)}const u=new Wl(l,i,r,a);return t.onSuccess(u.getTrackId()),L.info("create microphone audio track success, trackId:",a),u},createCustomAudioTrack:function(i){const t=He.reportApiInvoke(null,{tag:Dn.TRACER,name:hr.CREATE_CUSTOM_AUDIO_TRACK,options:[i]}),r=new en(i.mediaStreamTrack,i.encoderConfig?vv(i.encoderConfig):{},un(8,"track-cus-"),!1,!0);return L.info("create custom audio track success with config",i,"trackId",r.getTrackId()),t.onSuccess(r.getTrackId()),r},createBufferSourceAudioTrack:async function(i){var t;const{cacheOnlineFile:r,encoderConfig:a}=i;let{source:l}=i;const u={source:l instanceof AudioBuffer?"AudioBuffer":l instanceof File?(t=File.name)!==null&&t!==void 0?t:"File":l,cacheOnlineFile:r,encoderConfig:a},h=He.reportApiInvoke(null,{tag:Dn.TRACER,name:hr.CREATE_BUFFER_AUDIO_TRACK,options:[u]});if(Z("DISABLE_WEBAUDIO"))throw new be(G.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");const f=un(8,"track-buf-");L.info("start create buffer source audio track with config",JSON.stringify(u),"trackId",f);const v=l;if(!(l instanceof AudioBuffer))try{l=await Lee(l,r)}catch(C){return h.onError(C),C.throw(L)}const E=new kee(l),y=new zl(v,E,a?vv(a):{},f);return L.info("create buffer source audio track success, trackId:",f),h.onSuccess(y.getTrackId()),y},setAppType:function(i){if(L.debug("setAppType: ".concat(i)),!(Number.isInteger(i)&&i>=0))throw L.debug("Invalid appType"),new ue(G.INVALID_PARAMS,"invalid app type",i);an("APP_TYPE",Math.floor(i))},setLogLevel:function(i){L.setLogLevel(i)},enableLogUpload:function(){Z("USE_NEW_LOG")?an("UPLOAD_LOG",!0):L.enableLogUpload()},disableLogUpload:function(){Z("USE_NEW_LOG")?an("UPLOAD_LOG",!1):L.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new Kv},checkAudioTrackIsActive:async function(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const r=He.reportApiInvoke(null,{tag:Dn.TRACER,name:hr.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[t]});if(!(i instanceof en||i instanceof os)){const v=new ue(G.INVALID_TRACK,"the parameter is not a audio track");return r.onError(v),v.throw()}t&&t<1e3&&(t=1e3);const a=i instanceof en?i.getTrackLabel():"remote_track",l=i.getVolumeLevel();let u=l,h=l;const f=Date.now();return new me(v=>{const E=setInterval(()=>{const y=i.getVolumeLevel();u=y>u?y:u,h=y<h?y:h;const C=u-h>1e-4,I=Date.now()-f;if(C||I>t){clearInterval(E);const k=C,W={duration:I,deviceLabel:a,maxVolumeLevel:u,result:k};L.info("[track-".concat(i.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(W))),r.onSuccess(W),v(k)}},200)})},checkVideoTrackIsActive:async function(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const r=He.reportApiInvoke(null,{tag:Dn.TRACER,name:hr.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[t]});if(!(i instanceof bt||i instanceof yc)){const C=new ue(G.INVALID_TRACK,"the parameter is not a video track");return r.onError(C),C.throw()}t&&t<1e3&&(t=1e3);const a=i instanceof bt?i.getTrackLabel():"remote_track",l=i.getMediaStreamTrack(!0),u=document.createElement("video");u.style.width="1px",u.style.height="1px",u.setAttribute("muted",""),u.muted=!0,u.setAttribute("playsinline",""),u.controls=!1,(Di()||Gg())&&(u.style.opacity="0.01",u.style.position="fixed",u.style.left="0",u.style.top="0",document.body.appendChild(u)),u.srcObject=new MediaStream([l]),u.play();const h=document.createElement("canvas");h.width=160,h.height=120;let f=0,v=0;try{const C=Date.now();f=await function(I,k,W,$){let z,X=0,ie=null;return new me((oe,Re)=>{function Ce(){X>$&&z&&(z(),oe(X));const ge=W.getContext("2d");if(!ge){const De=new ue(G.UNEXPECTED_ERROR,"can not get canvas 2d context.");return L.error(De.toString()),void Re(De)}ge.drawImage(I,0,0,160,120);const _e=ge.getImageData(0,0,W.width,W.height),Se=Math.floor(_e.data.length/3);if(ie){for(let De=0;De<Se;De+=3)if(_e.data[De]!==ie[De])return X+=1,void(ie=_e.data);ie=_e.data}else ie=_e.data}setTimeout(()=>{z&&(z(),oe(X))},k),z=gT(()=>{Ce()},30)})}(u,t,h,4),v=Date.now()-C}catch(C){throw r.onError(C),C}Une===Zt.SAFARI&&(u.pause(),u.remove()),u.srcObject=null;const E=f>4,y={duration:v,changedPicNum:f,deviceLabel:a,result:E};return L.info("[track-".concat(i.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(y))),r.onSuccess(y),E},setArea:ZT,audioElementPlayCenter:ko,processExternalMediaAEC:function(i){Vne.processExternalMediaAEC(i)},registerExtensions:function(i){i.forEach(t=>{const r=t;r.__registered__=!0,r.logger.hookLog=L.extLog,r.reporter.hookApiInvoke=He.extApiInvoke,r.parameters&&Object.keys(r.parameters).forEach(a=>{r.parameters[a]=Z(a)})})},ChannelMediaRelayError:jl,ChannelMediaRelayEvent:Ms,ChannelMediaRelayState:Hi,RemoteStreamFallbackType:dT,RemoteStreamType:Ev,ConnectionDisconnectedReason:It,AudienceLatencyLevelType:Rb,AREAS:Vt});return Object.defineProperties(Or,{onAudioAutoplayFailed:{get:()=>oa.onAudioAutoplayFailed,set:i=>{oa.onAudioAutoplayFailed=i}},onAutoplayFailed:{get:()=>oa.onAutoplayFailed,set:i=>{oa.onAutoplayFailed=i}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>Or._onSecurityPolicyViolation,set(i){Or._onSecurityPolicyViolation=i,OU(i)}},__CLIENT_LIST__:{get:()=>Z("SHOW_GLOBAL_CLIENT_LIST")?Ul:[]}}),ia.on(Gc.CAMERA_DEVICE_CHANGED,i=>{L.info("camera device changed",JSON.stringify(i)),Or.onCameraChanged&&Or.onCameraChanged(i),Or.safeEmit(Us.CAMERA_CHANGED,i)}),ia.on(Gc.RECORDING_DEVICE_CHANGED,i=>{L.info("microphone device changed",JSON.stringify(i)),Or.onMicrophoneChanged&&Or.onMicrophoneChanged(i),Or.safeEmit(Us.MICROPHONE_CHANGED,i)}),ia.on(Gc.PLAYOUT_DEVICE_CHANGED,i=>{L.debug("playout device changed",JSON.stringify(i)),Or.onPlaybackDeviceChanged&&Or.onPlaybackDeviceChanged(i),Or.safeEmit(Us.PLAYBACK_DEVICE_CHANGED,i)}),ko.onAutoplayFailed=()=>{L.info("detect audio element autoplay failed"),oa.onAudioAutoplayFailed&&oa.onAudioAutoplayFailed()},on.on("autoplay-failed",()=>{L.info("detect webaudio autoplay failed"),oa.onAudioAutoplayFailed&&oa.onAudioAutoplayFailed(),Or.safeEmit(Us.AUTOPLAY_FAILED)}),or.on(Wc.NETWORK_STATE_CHANGE,(i,t)=>{L.info("[network-indicator] network state changed, ".concat(t," => ").concat(i))}),window&&(window.__ARTC__=Or),Or})})(A6);var hre=A6.exports;const ul=yl(hre);var Rw={},O6={exports:{}},Ka={},x6={exports:{}},N6={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function n(ae,Ee){var ve=ae.length;ae.push(Ee);e:for(;0<ve;){var le=ve-1>>>1,de=ae[le];if(0<c(de,Ee))ae[le]=Ee,ae[ve]=de,ve=le;else break e}}function o(ae){return ae.length===0?null:ae[0]}function s(ae){if(ae.length===0)return null;var Ee=ae[0],ve=ae.pop();if(ve!==Ee){ae[0]=ve;e:for(var le=0,de=ae.length,ye=de>>>1;le<ye;){var fe=2*(le+1)-1,ke=ae[fe],Me=fe+1,Ve=ae[Me];if(0>c(ke,ve))Me<de&&0>c(Ve,ke)?(ae[le]=Ve,ae[Me]=ve,le=Me):(ae[le]=ke,ae[fe]=ve,le=fe);else if(Me<de&&0>c(Ve,ve))ae[le]=Ve,ae[Me]=ve,le=Me;else break e}}return Ee}function c(ae,Ee){var ve=ae.sortIndex-Ee.sortIndex;return ve!==0?ve:ae.id-Ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;e.unstable_now=function(){return d.now()}}else{var p=Date,m=p.now();e.unstable_now=function(){return p.now()-m}}var g=[],_=[],S=1,T=null,R=3,N=!1,O=!1,A=!1,M=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(ae){for(var Ee=o(_);Ee!==null;){if(Ee.callback===null)s(_);else if(Ee.startTime<=ae)s(_),Ee.sortIndex=Ee.expirationTime,n(g,Ee);else break;Ee=o(_)}}function F(ae){if(A=!1,D(ae),!O)if(o(g)!==null)O=!0,ce(j);else{var Ee=o(_);Ee!==null&&se(F,Ee.startTime-ae)}}function j(ae,Ee){O=!1,A&&(A=!1,x(K),K=-1),N=!0;var ve=R;try{for(D(Ee),T=o(g);T!==null&&(!(T.expirationTime>Ee)||ae&&!Q());){var le=T.callback;if(typeof le=="function"){T.callback=null,R=T.priorityLevel;var de=le(T.expirationTime<=Ee);Ee=e.unstable_now(),typeof de=="function"?T.callback=de:T===o(g)&&s(g),D(Ee)}else s(g);T=o(g)}if(T!==null)var ye=!0;else{var fe=o(_);fe!==null&&se(F,fe.startTime-Ee),ye=!1}return ye}finally{T=null,R=ve,N=!1}}var B=!1,H=null,K=-1,J=5,q=-1;function Q(){return!(e.unstable_now()-q<J)}function ee(){if(H!==null){var ae=e.unstable_now();q=ae;var Ee=!0;try{Ee=H(!0,ae)}finally{Ee?ne():(B=!1,H=null)}}else B=!1}var ne;if(typeof P=="function")ne=function(){P(ee)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,pe=he.port2;he.port1.onmessage=ee,ne=function(){pe.postMessage(null)}}else ne=function(){M(ee,0)};function ce(ae){H=ae,B||(B=!0,ne())}function se(ae,Ee){K=M(function(){ae(e.unstable_now())},Ee)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ae){ae.callback=null},e.unstable_continueExecution=function(){O||N||(O=!0,ce(j))},e.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<ae?Math.floor(1e3/ae):5},e.unstable_getCurrentPriorityLevel=function(){return R},e.unstable_getFirstCallbackNode=function(){return o(g)},e.unstable_next=function(ae){switch(R){case 1:case 2:case 3:var Ee=3;break;default:Ee=R}var ve=R;R=Ee;try{return ae()}finally{R=ve}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ae,Ee){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var ve=R;R=ae;try{return Ee()}finally{R=ve}},e.unstable_scheduleCallback=function(ae,Ee,ve){var le=e.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?le+ve:le):ve=le,ae){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=ve+de,ae={id:S++,callback:Ee,priorityLevel:ae,startTime:ve,expirationTime:de,sortIndex:-1},ve>le?(ae.sortIndex=ve,n(_,ae),o(g)===null&&ae===o(_)&&(A?(x(K),K=-1):A=!0,se(F,ve-le))):(ae.sortIndex=de,n(g,ae),O||N||(O=!0,ce(j))),ae},e.unstable_shouldYield=Q,e.unstable_wrapCallback=function(ae){var Ee=R;return function(){var ve=R;R=Ee;try{return ae.apply(this,arguments)}finally{R=ve}}}})(N6);x6.exports=N6;var pre=x6.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P6=b,za=pre;function qe(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)n+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var D6=new Set,dm={};function Hd(e,n){Up(e,n),Up(e+"Capture",n)}function Up(e,n){for(dm[e]=n,e=0;e<n.length;e++)D6.add(n[e])}var dl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ww=Object.prototype.hasOwnProperty,fre=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,kU={},LU={};function mre(e){return ww.call(LU,e)?!0:ww.call(kU,e)?!1:fre.test(e)?LU[e]=!0:(kU[e]=!0,!1)}function gre(e,n,o,s){if(o!==null&&o.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return s?!1:o!==null?!o.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function vre(e,n,o,s){if(n===null||typeof n>"u"||gre(e,n,o,s))return!0;if(s)return!1;if(o!==null)switch(o.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function Ho(e,n,o,s,c,d,p){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=s,this.attributeNamespace=c,this.mustUseProperty=o,this.propertyName=e,this.type=n,this.sanitizeURL=d,this.removeEmptyString=p}var co={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){co[e]=new Ho(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];co[n]=new Ho(n,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){co[e]=new Ho(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){co[e]=new Ho(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){co[e]=new Ho(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){co[e]=new Ho(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){co[e]=new Ho(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){co[e]=new Ho(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){co[e]=new Ho(e,5,!1,e.toLowerCase(),null,!1,!1)});var xA=/[\-:]([a-z])/g;function NA(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(xA,NA);co[n]=new Ho(n,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(xA,NA);co[n]=new Ho(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(xA,NA);co[n]=new Ho(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){co[e]=new Ho(e,1,!1,e.toLowerCase(),null,!1,!1)});co.xlinkHref=new Ho("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){co[e]=new Ho(e,1,!1,e.toLowerCase(),null,!0,!0)});function PA(e,n,o,s){var c=co.hasOwnProperty(n)?co[n]:null;(c!==null?c.type!==0:s||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(vre(n,o,c,s)&&(o=null),s||c===null?mre(n)&&(o===null?e.removeAttribute(n):e.setAttribute(n,""+o)):c.mustUseProperty?e[c.propertyName]=o===null?c.type===3?!1:"":o:(n=c.attributeName,s=c.attributeNamespace,o===null?e.removeAttribute(n):(c=c.type,o=c===3||c===4&&o===!0?"":""+o,s?e.setAttributeNS(s,n,o):e.setAttribute(n,o))))}var Sl=P6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,fE=Symbol.for("react.element"),mp=Symbol.for("react.portal"),gp=Symbol.for("react.fragment"),DA=Symbol.for("react.strict_mode"),Iw=Symbol.for("react.profiler"),k6=Symbol.for("react.provider"),L6=Symbol.for("react.context"),kA=Symbol.for("react.forward_ref"),Aw=Symbol.for("react.suspense"),Ow=Symbol.for("react.suspense_list"),LA=Symbol.for("react.memo"),lu=Symbol.for("react.lazy"),M6=Symbol.for("react.offscreen"),MU=Symbol.iterator;function b0(e){return e===null||typeof e!="object"?null:(e=MU&&e[MU]||e["@@iterator"],typeof e=="function"?e:null)}var Xr=Object.assign,wR;function j0(e){if(wR===void 0)try{throw Error()}catch(o){var n=o.stack.trim().match(/\n( *(at )?)/);wR=n&&n[1]||""}return`
`+wR+e}var IR=!1;function AR(e,n){if(!e||IR)return"";IR=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(_){var s=_}Reflect.construct(e,[],n)}else{try{n.call()}catch(_){s=_}e.call(n.prototype)}else{try{throw Error()}catch(_){s=_}e()}}catch(_){if(_&&s&&typeof _.stack=="string"){for(var c=_.stack.split(`
`),d=s.stack.split(`
`),p=c.length-1,m=d.length-1;1<=p&&0<=m&&c[p]!==d[m];)m--;for(;1<=p&&0<=m;p--,m--)if(c[p]!==d[m]){if(p!==1||m!==1)do if(p--,m--,0>m||c[p]!==d[m]){var g=`
`+c[p].replace(" at new "," at ");return e.displayName&&g.includes("<anonymous>")&&(g=g.replace("<anonymous>",e.displayName)),g}while(1<=p&&0<=m);break}}}finally{IR=!1,Error.prepareStackTrace=o}return(e=e?e.displayName||e.name:"")?j0(e):""}function Ere(e){switch(e.tag){case 5:return j0(e.type);case 16:return j0("Lazy");case 13:return j0("Suspense");case 19:return j0("SuspenseList");case 0:case 2:case 15:return e=AR(e.type,!1),e;case 11:return e=AR(e.type.render,!1),e;case 1:return e=AR(e.type,!0),e;default:return""}}function xw(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case gp:return"Fragment";case mp:return"Portal";case Iw:return"Profiler";case DA:return"StrictMode";case Aw:return"Suspense";case Ow:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case L6:return(e.displayName||"Context")+".Consumer";case k6:return(e._context.displayName||"Context")+".Provider";case kA:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case LA:return n=e.displayName||null,n!==null?n:xw(e.type)||"Memo";case lu:n=e._payload,e=e._init;try{return xw(e(n))}catch{}}return null}function _re(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return xw(n);case 8:return n===DA?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function wu(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function F6(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function yre(e){var n=F6(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),s=""+e[n];if(!e.hasOwnProperty(n)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var c=o.get,d=o.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return c.call(this)},set:function(p){s=""+p,d.call(this,p)}}),Object.defineProperty(e,n,{enumerable:o.enumerable}),{getValue:function(){return s},setValue:function(p){s=""+p},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function mE(e){e._valueTracker||(e._valueTracker=yre(e))}function U6(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var o=n.getValue(),s="";return e&&(s=F6(e)?e.checked?"true":"false":e.value),e=s,e!==o?(n.setValue(e),!0):!1}function T_(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Nw(e,n){var o=n.checked;return Xr({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??e._wrapperState.initialChecked})}function FU(e,n){var o=n.defaultValue==null?"":n.defaultValue,s=n.checked!=null?n.checked:n.defaultChecked;o=wu(n.value!=null?n.value:o),e._wrapperState={initialChecked:s,initialValue:o,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function B6(e,n){n=n.checked,n!=null&&PA(e,"checked",n,!1)}function Pw(e,n){B6(e,n);var o=wu(n.value),s=n.type;if(o!=null)s==="number"?(o===0&&e.value===""||e.value!=o)&&(e.value=""+o):e.value!==""+o&&(e.value=""+o);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?Dw(e,n.type,o):n.hasOwnProperty("defaultValue")&&Dw(e,n.type,wu(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function UU(e,n,o){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var s=n.type;if(!(s!=="submit"&&s!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,o||n===e.value||(e.value=n),e.defaultValue=n}o=e.name,o!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,o!==""&&(e.name=o)}function Dw(e,n,o){(n!=="number"||T_(e.ownerDocument)!==e)&&(o==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+o&&(e.defaultValue=""+o))}var V0=Array.isArray;function Np(e,n,o,s){if(e=e.options,n){n={};for(var c=0;c<o.length;c++)n["$"+o[c]]=!0;for(o=0;o<e.length;o++)c=n.hasOwnProperty("$"+e[o].value),e[o].selected!==c&&(e[o].selected=c),c&&s&&(e[o].defaultSelected=!0)}else{for(o=""+wu(o),n=null,c=0;c<e.length;c++){if(e[c].value===o){e[c].selected=!0,s&&(e[c].defaultSelected=!0);return}n!==null||e[c].disabled||(n=e[c])}n!==null&&(n.selected=!0)}}function kw(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(qe(91));return Xr({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function BU(e,n){var o=n.value;if(o==null){if(o=n.children,n=n.defaultValue,o!=null){if(n!=null)throw Error(qe(92));if(V0(o)){if(1<o.length)throw Error(qe(93));o=o[0]}n=o}n==null&&(n=""),o=n}e._wrapperState={initialValue:wu(o)}}function j6(e,n){var o=wu(n.value),s=wu(n.defaultValue);o!=null&&(o=""+o,o!==e.value&&(e.value=o),n.defaultValue==null&&e.defaultValue!==o&&(e.defaultValue=o)),s!=null&&(e.defaultValue=""+s)}function jU(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function V6(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lw(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?V6(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var gE,$6=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,o,s,c){MSApp.execUnsafeLocalFunction(function(){return e(n,o,s,c)})}:e}(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(gE=gE||document.createElement("div"),gE.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=gE.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function hm(e,n){if(n){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=n;return}}e.textContent=n}var G0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sre=["Webkit","ms","Moz","O"];Object.keys(G0).forEach(function(e){Sre.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),G0[n]=G0[e]})});function H6(e,n,o){return n==null||typeof n=="boolean"||n===""?"":o||typeof n!="number"||n===0||G0.hasOwnProperty(e)&&G0[e]?(""+n).trim():n+"px"}function W6(e,n){e=e.style;for(var o in n)if(n.hasOwnProperty(o)){var s=o.indexOf("--")===0,c=H6(o,n[o],s);o==="float"&&(o="cssFloat"),s?e.setProperty(o,c):e[o]=c}}var Cre=Xr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Mw(e,n){if(n){if(Cre[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(qe(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(qe(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(qe(61))}if(n.style!=null&&typeof n.style!="object")throw Error(qe(62))}}function Fw(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Uw=null;function MA(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Bw=null,Pp=null,Dp=null;function VU(e){if(e=Wm(e)){if(typeof Bw!="function")throw Error(qe(280));var n=e.stateNode;n&&(n=xy(n),Bw(e.stateNode,e.type,n))}}function z6(e){Pp?Dp?Dp.push(e):Dp=[e]:Pp=e}function G6(){if(Pp){var e=Pp,n=Dp;if(Dp=Pp=null,VU(e),n)for(e=0;e<n.length;e++)VU(n[e])}}function K6(e,n){return e(n)}function q6(){}var OR=!1;function Y6(e,n,o){if(OR)return e(n,o);OR=!0;try{return K6(e,n,o)}finally{OR=!1,(Pp!==null||Dp!==null)&&(q6(),G6())}}function pm(e,n){var o=e.stateNode;if(o===null)return null;var s=xy(o);if(s===null)return null;o=s[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(qe(231,n,typeof o));return o}var jw=!1;if(dl)try{var T0={};Object.defineProperty(T0,"passive",{get:function(){jw=!0}}),window.addEventListener("test",T0,T0),window.removeEventListener("test",T0,T0)}catch{jw=!1}function bre(e,n,o,s,c,d,p,m,g){var _=Array.prototype.slice.call(arguments,3);try{n.apply(o,_)}catch(S){this.onError(S)}}var K0=!1,R_=null,w_=!1,Vw=null,Tre={onError:function(e){K0=!0,R_=e}};function Rre(e,n,o,s,c,d,p,m,g){K0=!1,R_=null,bre.apply(Tre,arguments)}function wre(e,n,o,s,c,d,p,m,g){if(Rre.apply(this,arguments),K0){if(K0){var _=R_;K0=!1,R_=null}else throw Error(qe(198));w_||(w_=!0,Vw=_)}}function Wd(e){var n=e,o=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,n.flags&4098&&(o=n.return),e=n.return;while(e)}return n.tag===3?o:null}function X6(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function $U(e){if(Wd(e)!==e)throw Error(qe(188))}function Ire(e){var n=e.alternate;if(!n){if(n=Wd(e),n===null)throw Error(qe(188));return n!==e?null:e}for(var o=e,s=n;;){var c=o.return;if(c===null)break;var d=c.alternate;if(d===null){if(s=c.return,s!==null){o=s;continue}break}if(c.child===d.child){for(d=c.child;d;){if(d===o)return $U(c),e;if(d===s)return $U(c),n;d=d.sibling}throw Error(qe(188))}if(o.return!==s.return)o=c,s=d;else{for(var p=!1,m=c.child;m;){if(m===o){p=!0,o=c,s=d;break}if(m===s){p=!0,s=c,o=d;break}m=m.sibling}if(!p){for(m=d.child;m;){if(m===o){p=!0,o=d,s=c;break}if(m===s){p=!0,s=d,o=c;break}m=m.sibling}if(!p)throw Error(qe(189))}}if(o.alternate!==s)throw Error(qe(190))}if(o.tag!==3)throw Error(qe(188));return o.stateNode.current===o?e:n}function J6(e){return e=Ire(e),e!==null?Q6(e):null}function Q6(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=Q6(e);if(n!==null)return n;e=e.sibling}return null}var Z6=za.unstable_scheduleCallback,HU=za.unstable_cancelCallback,Are=za.unstable_shouldYield,Ore=za.unstable_requestPaint,_i=za.unstable_now,xre=za.unstable_getCurrentPriorityLevel,FA=za.unstable_ImmediatePriority,e8=za.unstable_UserBlockingPriority,I_=za.unstable_NormalPriority,Nre=za.unstable_LowPriority,t8=za.unstable_IdlePriority,wy=null,kc=null;function Pre(e){if(kc&&typeof kc.onCommitFiberRoot=="function")try{kc.onCommitFiberRoot(wy,e,void 0,(e.current.flags&128)===128)}catch{}}var Xs=Math.clz32?Math.clz32:Lre,Dre=Math.log,kre=Math.LN2;function Lre(e){return e>>>=0,e===0?32:31-(Dre(e)/kre|0)|0}var vE=64,EE=4194304;function $0(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function A_(e,n){var o=e.pendingLanes;if(o===0)return 0;var s=0,c=e.suspendedLanes,d=e.pingedLanes,p=o&268435455;if(p!==0){var m=p&~c;m!==0?s=$0(m):(d&=p,d!==0&&(s=$0(d)))}else p=o&~c,p!==0?s=$0(p):d!==0&&(s=$0(d));if(s===0)return 0;if(n!==0&&n!==s&&!(n&c)&&(c=s&-s,d=n&-n,c>=d||c===16&&(d&4194240)!==0))return n;if(s&4&&(s|=o&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=s;0<n;)o=31-Xs(n),c=1<<o,s|=e[o],n&=~c;return s}function Mre(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fre(e,n){for(var o=e.suspendedLanes,s=e.pingedLanes,c=e.expirationTimes,d=e.pendingLanes;0<d;){var p=31-Xs(d),m=1<<p,g=c[p];g===-1?(!(m&o)||m&s)&&(c[p]=Mre(m,n)):g<=n&&(e.expiredLanes|=m),d&=~m}}function $w(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function n8(){var e=vE;return vE<<=1,!(vE&4194240)&&(vE=64),e}function xR(e){for(var n=[],o=0;31>o;o++)n.push(e);return n}function $m(e,n,o){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-Xs(n),e[n]=o}function Ure(e,n){var o=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<o;){var c=31-Xs(o),d=1<<c;n[c]=0,s[c]=-1,e[c]=-1,o&=~d}}function UA(e,n){var o=e.entangledLanes|=n;for(e=e.entanglements;o;){var s=31-Xs(o),c=1<<s;c&n|e[s]&n&&(e[s]|=n),o&=~c}}var tr=0;function r8(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var i8,BA,o8,a8,s8,Hw=!1,_E=[],Eu=null,_u=null,yu=null,fm=new Map,mm=new Map,du=[],Bre="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function WU(e,n){switch(e){case"focusin":case"focusout":Eu=null;break;case"dragenter":case"dragleave":_u=null;break;case"mouseover":case"mouseout":yu=null;break;case"pointerover":case"pointerout":fm.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":mm.delete(n.pointerId)}}function R0(e,n,o,s,c,d){return e===null||e.nativeEvent!==d?(e={blockedOn:n,domEventName:o,eventSystemFlags:s,nativeEvent:d,targetContainers:[c]},n!==null&&(n=Wm(n),n!==null&&BA(n)),e):(e.eventSystemFlags|=s,n=e.targetContainers,c!==null&&n.indexOf(c)===-1&&n.push(c),e)}function jre(e,n,o,s,c){switch(n){case"focusin":return Eu=R0(Eu,e,n,o,s,c),!0;case"dragenter":return _u=R0(_u,e,n,o,s,c),!0;case"mouseover":return yu=R0(yu,e,n,o,s,c),!0;case"pointerover":var d=c.pointerId;return fm.set(d,R0(fm.get(d)||null,e,n,o,s,c)),!0;case"gotpointercapture":return d=c.pointerId,mm.set(d,R0(mm.get(d)||null,e,n,o,s,c)),!0}return!1}function c8(e){var n=bd(e.target);if(n!==null){var o=Wd(n);if(o!==null){if(n=o.tag,n===13){if(n=X6(o),n!==null){e.blockedOn=n,s8(e.priority,function(){o8(o)});return}}else if(n===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function n_(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var o=Ww(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(o===null){o=e.nativeEvent;var s=new o.constructor(o.type,o);Uw=s,o.target.dispatchEvent(s),Uw=null}else return n=Wm(o),n!==null&&BA(n),e.blockedOn=o,!1;n.shift()}return!0}function zU(e,n,o){n_(e)&&o.delete(n)}function Vre(){Hw=!1,Eu!==null&&n_(Eu)&&(Eu=null),_u!==null&&n_(_u)&&(_u=null),yu!==null&&n_(yu)&&(yu=null),fm.forEach(zU),mm.forEach(zU)}function w0(e,n){e.blockedOn===n&&(e.blockedOn=null,Hw||(Hw=!0,za.unstable_scheduleCallback(za.unstable_NormalPriority,Vre)))}function gm(e){function n(c){return w0(c,e)}if(0<_E.length){w0(_E[0],e);for(var o=1;o<_E.length;o++){var s=_E[o];s.blockedOn===e&&(s.blockedOn=null)}}for(Eu!==null&&w0(Eu,e),_u!==null&&w0(_u,e),yu!==null&&w0(yu,e),fm.forEach(n),mm.forEach(n),o=0;o<du.length;o++)s=du[o],s.blockedOn===e&&(s.blockedOn=null);for(;0<du.length&&(o=du[0],o.blockedOn===null);)c8(o),o.blockedOn===null&&du.shift()}var kp=Sl.ReactCurrentBatchConfig,O_=!0;function $re(e,n,o,s){var c=tr,d=kp.transition;kp.transition=null;try{tr=1,jA(e,n,o,s)}finally{tr=c,kp.transition=d}}function Hre(e,n,o,s){var c=tr,d=kp.transition;kp.transition=null;try{tr=4,jA(e,n,o,s)}finally{tr=c,kp.transition=d}}function jA(e,n,o,s){if(O_){var c=Ww(e,n,o,s);if(c===null)jR(e,n,s,x_,o),WU(e,s);else if(jre(c,e,n,o,s))s.stopPropagation();else if(WU(e,s),n&4&&-1<Bre.indexOf(e)){for(;c!==null;){var d=Wm(c);if(d!==null&&i8(d),d=Ww(e,n,o,s),d===null&&jR(e,n,s,x_,o),d===c)break;c=d}c!==null&&s.stopPropagation()}else jR(e,n,s,null,o)}}var x_=null;function Ww(e,n,o,s){if(x_=null,e=MA(s),e=bd(e),e!==null)if(n=Wd(e),n===null)e=null;else if(o=n.tag,o===13){if(e=X6(n),e!==null)return e;e=null}else if(o===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return x_=e,null}function l8(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xre()){case FA:return 1;case e8:return 4;case I_:case Nre:return 16;case t8:return 536870912;default:return 16}default:return 16}}var pu=null,VA=null,r_=null;function u8(){if(r_)return r_;var e,n=VA,o=n.length,s,c="value"in pu?pu.value:pu.textContent,d=c.length;for(e=0;e<o&&n[e]===c[e];e++);var p=o-e;for(s=1;s<=p&&n[o-s]===c[d-s];s++);return r_=c.slice(e,1<s?1-s:void 0)}function i_(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function yE(){return!0}function GU(){return!1}function qa(e){function n(o,s,c,d,p){this._reactName=o,this._targetInst=c,this.type=s,this.nativeEvent=d,this.target=p,this.currentTarget=null;for(var m in e)e.hasOwnProperty(m)&&(o=e[m],this[m]=o?o(d):d[m]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?yE:GU,this.isPropagationStopped=GU,this}return Xr(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=yE)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=yE)},persist:function(){},isPersistent:yE}),n}var Jp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$A=qa(Jp),Hm=Xr({},Jp,{view:0,detail:0}),Wre=qa(Hm),NR,PR,I0,Iy=Xr({},Hm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:HA,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==I0&&(I0&&e.type==="mousemove"?(NR=e.screenX-I0.screenX,PR=e.screenY-I0.screenY):PR=NR=0,I0=e),NR)},movementY:function(e){return"movementY"in e?e.movementY:PR}}),KU=qa(Iy),zre=Xr({},Iy,{dataTransfer:0}),Gre=qa(zre),Kre=Xr({},Hm,{relatedTarget:0}),DR=qa(Kre),qre=Xr({},Jp,{animationName:0,elapsedTime:0,pseudoElement:0}),Yre=qa(qre),Xre=Xr({},Jp,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jre=qa(Xre),Qre=Xr({},Jp,{data:0}),qU=qa(Qre),Zre={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eie={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tie={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nie(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=tie[e])?!!n[e]:!1}function HA(){return nie}var rie=Xr({},Hm,{key:function(e){if(e.key){var n=Zre[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=i_(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?eie[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:HA,charCode:function(e){return e.type==="keypress"?i_(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?i_(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),iie=qa(rie),oie=Xr({},Iy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),YU=qa(oie),aie=Xr({},Hm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:HA}),sie=qa(aie),cie=Xr({},Jp,{propertyName:0,elapsedTime:0,pseudoElement:0}),lie=qa(cie),uie=Xr({},Iy,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),die=qa(uie),hie=[9,13,27,32],WA=dl&&"CompositionEvent"in window,q0=null;dl&&"documentMode"in document&&(q0=document.documentMode);var pie=dl&&"TextEvent"in window&&!q0,d8=dl&&(!WA||q0&&8<q0&&11>=q0),XU=String.fromCharCode(32),JU=!1;function h8(e,n){switch(e){case"keyup":return hie.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function p8(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var vp=!1;function fie(e,n){switch(e){case"compositionend":return p8(n);case"keypress":return n.which!==32?null:(JU=!0,XU);case"textInput":return e=n.data,e===XU&&JU?null:e;default:return null}}function mie(e,n){if(vp)return e==="compositionend"||!WA&&h8(e,n)?(e=u8(),r_=VA=pu=null,vp=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return d8&&n.locale!=="ko"?null:n.data;default:return null}}var gie={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function QU(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!gie[e.type]:n==="textarea"}function f8(e,n,o,s){z6(s),n=N_(n,"onChange"),0<n.length&&(o=new $A("onChange","change",null,o,s),e.push({event:o,listeners:n}))}var Y0=null,vm=null;function vie(e){R8(e,0)}function Ay(e){var n=yp(e);if(U6(n))return e}function Eie(e,n){if(e==="change")return n}var m8=!1;if(dl){var kR;if(dl){var LR="oninput"in document;if(!LR){var ZU=document.createElement("div");ZU.setAttribute("oninput","return;"),LR=typeof ZU.oninput=="function"}kR=LR}else kR=!1;m8=kR&&(!document.documentMode||9<document.documentMode)}function e4(){Y0&&(Y0.detachEvent("onpropertychange",g8),vm=Y0=null)}function g8(e){if(e.propertyName==="value"&&Ay(vm)){var n=[];f8(n,vm,e,MA(e)),Y6(vie,n)}}function _ie(e,n,o){e==="focusin"?(e4(),Y0=n,vm=o,Y0.attachEvent("onpropertychange",g8)):e==="focusout"&&e4()}function yie(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ay(vm)}function Sie(e,n){if(e==="click")return Ay(n)}function Cie(e,n){if(e==="input"||e==="change")return Ay(n)}function bie(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var ec=typeof Object.is=="function"?Object.is:bie;function Em(e,n){if(ec(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var o=Object.keys(e),s=Object.keys(n);if(o.length!==s.length)return!1;for(s=0;s<o.length;s++){var c=o[s];if(!ww.call(n,c)||!ec(e[c],n[c]))return!1}return!0}function t4(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function n4(e,n){var o=t4(e);e=0;for(var s;o;){if(o.nodeType===3){if(s=e+o.textContent.length,e<=n&&s>=n)return{node:o,offset:n-e};e=s}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=t4(o)}}function v8(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?v8(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function E8(){for(var e=window,n=T_();n instanceof e.HTMLIFrameElement;){try{var o=typeof n.contentWindow.location.href=="string"}catch{o=!1}if(o)e=n.contentWindow;else break;n=T_(e.document)}return n}function zA(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function Tie(e){var n=E8(),o=e.focusedElem,s=e.selectionRange;if(n!==o&&o&&o.ownerDocument&&v8(o.ownerDocument.documentElement,o)){if(s!==null&&zA(o)){if(n=s.start,e=s.end,e===void 0&&(e=n),"selectionStart"in o)o.selectionStart=n,o.selectionEnd=Math.min(e,o.value.length);else if(e=(n=o.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var c=o.textContent.length,d=Math.min(s.start,c);s=s.end===void 0?d:Math.min(s.end,c),!e.extend&&d>s&&(c=s,s=d,d=c),c=n4(o,d);var p=n4(o,s);c&&p&&(e.rangeCount!==1||e.anchorNode!==c.node||e.anchorOffset!==c.offset||e.focusNode!==p.node||e.focusOffset!==p.offset)&&(n=n.createRange(),n.setStart(c.node,c.offset),e.removeAllRanges(),d>s?(e.addRange(n),e.extend(p.node,p.offset)):(n.setEnd(p.node,p.offset),e.addRange(n)))}}for(n=[],e=o;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<n.length;o++)e=n[o],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Rie=dl&&"documentMode"in document&&11>=document.documentMode,Ep=null,zw=null,X0=null,Gw=!1;function r4(e,n,o){var s=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Gw||Ep==null||Ep!==T_(s)||(s=Ep,"selectionStart"in s&&zA(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),X0&&Em(X0,s)||(X0=s,s=N_(zw,"onSelect"),0<s.length&&(n=new $A("onSelect","select",null,n,o),e.push({event:n,listeners:s}),n.target=Ep)))}function SE(e,n){var o={};return o[e.toLowerCase()]=n.toLowerCase(),o["Webkit"+e]="webkit"+n,o["Moz"+e]="moz"+n,o}var _p={animationend:SE("Animation","AnimationEnd"),animationiteration:SE("Animation","AnimationIteration"),animationstart:SE("Animation","AnimationStart"),transitionend:SE("Transition","TransitionEnd")},MR={},_8={};dl&&(_8=document.createElement("div").style,"AnimationEvent"in window||(delete _p.animationend.animation,delete _p.animationiteration.animation,delete _p.animationstart.animation),"TransitionEvent"in window||delete _p.transitionend.transition);function Oy(e){if(MR[e])return MR[e];if(!_p[e])return e;var n=_p[e],o;for(o in n)if(n.hasOwnProperty(o)&&o in _8)return MR[e]=n[o];return e}var y8=Oy("animationend"),S8=Oy("animationiteration"),C8=Oy("animationstart"),b8=Oy("transitionend"),T8=new Map,i4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xu(e,n){T8.set(e,n),Hd(n,[e])}for(var FR=0;FR<i4.length;FR++){var UR=i4[FR],wie=UR.toLowerCase(),Iie=UR[0].toUpperCase()+UR.slice(1);xu(wie,"on"+Iie)}xu(y8,"onAnimationEnd");xu(S8,"onAnimationIteration");xu(C8,"onAnimationStart");xu("dblclick","onDoubleClick");xu("focusin","onFocus");xu("focusout","onBlur");xu(b8,"onTransitionEnd");Up("onMouseEnter",["mouseout","mouseover"]);Up("onMouseLeave",["mouseout","mouseover"]);Up("onPointerEnter",["pointerout","pointerover"]);Up("onPointerLeave",["pointerout","pointerover"]);Hd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Hd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Hd("onBeforeInput",["compositionend","keypress","textInput","paste"]);Hd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Hd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Hd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var H0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Aie=new Set("cancel close invalid load scroll toggle".split(" ").concat(H0));function o4(e,n,o){var s=e.type||"unknown-event";e.currentTarget=o,wre(s,n,void 0,e),e.currentTarget=null}function R8(e,n){n=(n&4)!==0;for(var o=0;o<e.length;o++){var s=e[o],c=s.event;s=s.listeners;e:{var d=void 0;if(n)for(var p=s.length-1;0<=p;p--){var m=s[p],g=m.instance,_=m.currentTarget;if(m=m.listener,g!==d&&c.isPropagationStopped())break e;o4(c,m,_),d=g}else for(p=0;p<s.length;p++){if(m=s[p],g=m.instance,_=m.currentTarget,m=m.listener,g!==d&&c.isPropagationStopped())break e;o4(c,m,_),d=g}}}if(w_)throw e=Vw,w_=!1,Vw=null,e}function xr(e,n){var o=n[Jw];o===void 0&&(o=n[Jw]=new Set);var s=e+"__bubble";o.has(s)||(w8(n,e,2,!1),o.add(s))}function BR(e,n,o){var s=0;n&&(s|=4),w8(o,e,s,n)}var CE="_reactListening"+Math.random().toString(36).slice(2);function _m(e){if(!e[CE]){e[CE]=!0,D6.forEach(function(o){o!=="selectionchange"&&(Aie.has(o)||BR(o,!1,e),BR(o,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[CE]||(n[CE]=!0,BR("selectionchange",!1,n))}}function w8(e,n,o,s){switch(l8(n)){case 1:var c=$re;break;case 4:c=Hre;break;default:c=jA}o=c.bind(null,n,o,e),c=void 0,!jw||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(c=!0),s?c!==void 0?e.addEventListener(n,o,{capture:!0,passive:c}):e.addEventListener(n,o,!0):c!==void 0?e.addEventListener(n,o,{passive:c}):e.addEventListener(n,o,!1)}function jR(e,n,o,s,c){var d=s;if(!(n&1)&&!(n&2)&&s!==null)e:for(;;){if(s===null)return;var p=s.tag;if(p===3||p===4){var m=s.stateNode.containerInfo;if(m===c||m.nodeType===8&&m.parentNode===c)break;if(p===4)for(p=s.return;p!==null;){var g=p.tag;if((g===3||g===4)&&(g=p.stateNode.containerInfo,g===c||g.nodeType===8&&g.parentNode===c))return;p=p.return}for(;m!==null;){if(p=bd(m),p===null)return;if(g=p.tag,g===5||g===6){s=d=p;continue e}m=m.parentNode}}s=s.return}Y6(function(){var _=d,S=MA(o),T=[];e:{var R=T8.get(e);if(R!==void 0){var N=$A,O=e;switch(e){case"keypress":if(i_(o)===0)break e;case"keydown":case"keyup":N=iie;break;case"focusin":O="focus",N=DR;break;case"focusout":O="blur",N=DR;break;case"beforeblur":case"afterblur":N=DR;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":N=KU;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":N=Gre;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":N=sie;break;case y8:case S8:case C8:N=Yre;break;case b8:N=lie;break;case"scroll":N=Wre;break;case"wheel":N=die;break;case"copy":case"cut":case"paste":N=Jre;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":N=YU}var A=(n&4)!==0,M=!A&&e==="scroll",x=A?R!==null?R+"Capture":null:R;A=[];for(var P=_,D;P!==null;){D=P;var F=D.stateNode;if(D.tag===5&&F!==null&&(D=F,x!==null&&(F=pm(P,x),F!=null&&A.push(ym(P,F,D)))),M)break;P=P.return}0<A.length&&(R=new N(R,O,null,o,S),T.push({event:R,listeners:A}))}}if(!(n&7)){e:{if(R=e==="mouseover"||e==="pointerover",N=e==="mouseout"||e==="pointerout",R&&o!==Uw&&(O=o.relatedTarget||o.fromElement)&&(bd(O)||O[hl]))break e;if((N||R)&&(R=S.window===S?S:(R=S.ownerDocument)?R.defaultView||R.parentWindow:window,N?(O=o.relatedTarget||o.toElement,N=_,O=O?bd(O):null,O!==null&&(M=Wd(O),O!==M||O.tag!==5&&O.tag!==6)&&(O=null)):(N=null,O=_),N!==O)){if(A=KU,F="onMouseLeave",x="onMouseEnter",P="mouse",(e==="pointerout"||e==="pointerover")&&(A=YU,F="onPointerLeave",x="onPointerEnter",P="pointer"),M=N==null?R:yp(N),D=O==null?R:yp(O),R=new A(F,P+"leave",N,o,S),R.target=M,R.relatedTarget=D,F=null,bd(S)===_&&(A=new A(x,P+"enter",O,o,S),A.target=D,A.relatedTarget=M,F=A),M=F,N&&O)t:{for(A=N,x=O,P=0,D=A;D;D=ep(D))P++;for(D=0,F=x;F;F=ep(F))D++;for(;0<P-D;)A=ep(A),P--;for(;0<D-P;)x=ep(x),D--;for(;P--;){if(A===x||x!==null&&A===x.alternate)break t;A=ep(A),x=ep(x)}A=null}else A=null;N!==null&&a4(T,R,N,A,!1),O!==null&&M!==null&&a4(T,M,O,A,!0)}}e:{if(R=_?yp(_):window,N=R.nodeName&&R.nodeName.toLowerCase(),N==="select"||N==="input"&&R.type==="file")var j=Eie;else if(QU(R))if(m8)j=Cie;else{j=yie;var B=_ie}else(N=R.nodeName)&&N.toLowerCase()==="input"&&(R.type==="checkbox"||R.type==="radio")&&(j=Sie);if(j&&(j=j(e,_))){f8(T,j,o,S);break e}B&&B(e,R,_),e==="focusout"&&(B=R._wrapperState)&&B.controlled&&R.type==="number"&&Dw(R,"number",R.value)}switch(B=_?yp(_):window,e){case"focusin":(QU(B)||B.contentEditable==="true")&&(Ep=B,zw=_,X0=null);break;case"focusout":X0=zw=Ep=null;break;case"mousedown":Gw=!0;break;case"contextmenu":case"mouseup":case"dragend":Gw=!1,r4(T,o,S);break;case"selectionchange":if(Rie)break;case"keydown":case"keyup":r4(T,o,S)}var H;if(WA)e:{switch(e){case"compositionstart":var K="onCompositionStart";break e;case"compositionend":K="onCompositionEnd";break e;case"compositionupdate":K="onCompositionUpdate";break e}K=void 0}else vp?h8(e,o)&&(K="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(K="onCompositionStart");K&&(d8&&o.locale!=="ko"&&(vp||K!=="onCompositionStart"?K==="onCompositionEnd"&&vp&&(H=u8()):(pu=S,VA="value"in pu?pu.value:pu.textContent,vp=!0)),B=N_(_,K),0<B.length&&(K=new qU(K,e,null,o,S),T.push({event:K,listeners:B}),H?K.data=H:(H=p8(o),H!==null&&(K.data=H)))),(H=pie?fie(e,o):mie(e,o))&&(_=N_(_,"onBeforeInput"),0<_.length&&(S=new qU("onBeforeInput","beforeinput",null,o,S),T.push({event:S,listeners:_}),S.data=H))}R8(T,n)})}function ym(e,n,o){return{instance:e,listener:n,currentTarget:o}}function N_(e,n){for(var o=n+"Capture",s=[];e!==null;){var c=e,d=c.stateNode;c.tag===5&&d!==null&&(c=d,d=pm(e,o),d!=null&&s.unshift(ym(e,d,c)),d=pm(e,n),d!=null&&s.push(ym(e,d,c))),e=e.return}return s}function ep(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function a4(e,n,o,s,c){for(var d=n._reactName,p=[];o!==null&&o!==s;){var m=o,g=m.alternate,_=m.stateNode;if(g!==null&&g===s)break;m.tag===5&&_!==null&&(m=_,c?(g=pm(o,d),g!=null&&p.unshift(ym(o,g,m))):c||(g=pm(o,d),g!=null&&p.push(ym(o,g,m)))),o=o.return}p.length!==0&&e.push({event:n,listeners:p})}var Oie=/\r\n?/g,xie=/\u0000|\uFFFD/g;function s4(e){return(typeof e=="string"?e:""+e).replace(Oie,`
`).replace(xie,"")}function bE(e,n,o){if(n=s4(n),s4(e)!==n&&o)throw Error(qe(425))}function P_(){}var Kw=null,qw=null;function Yw(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Xw=typeof setTimeout=="function"?setTimeout:void 0,Nie=typeof clearTimeout=="function"?clearTimeout:void 0,c4=typeof Promise=="function"?Promise:void 0,Pie=typeof queueMicrotask=="function"?queueMicrotask:typeof c4<"u"?function(e){return c4.resolve(null).then(e).catch(Die)}:Xw;function Die(e){setTimeout(function(){throw e})}function VR(e,n){var o=n,s=0;do{var c=o.nextSibling;if(e.removeChild(o),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0){e.removeChild(c),gm(n);return}s--}else o!=="$"&&o!=="$?"&&o!=="$!"||s++;o=c}while(o);gm(n)}function Su(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function l4(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"){if(n===0)return e;n--}else o==="/$"&&n++}e=e.previousSibling}return null}var Qp=Math.random().toString(36).slice(2),Dc="__reactFiber$"+Qp,Sm="__reactProps$"+Qp,hl="__reactContainer$"+Qp,Jw="__reactEvents$"+Qp,kie="__reactListeners$"+Qp,Lie="__reactHandles$"+Qp;function bd(e){var n=e[Dc];if(n)return n;for(var o=e.parentNode;o;){if(n=o[hl]||o[Dc]){if(o=n.alternate,n.child!==null||o!==null&&o.child!==null)for(e=l4(e);e!==null;){if(o=e[Dc])return o;e=l4(e)}return n}e=o,o=e.parentNode}return null}function Wm(e){return e=e[Dc]||e[hl],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function yp(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(qe(33))}function xy(e){return e[Sm]||null}var Qw=[],Sp=-1;function Nu(e){return{current:e}}function Nr(e){0>Sp||(e.current=Qw[Sp],Qw[Sp]=null,Sp--)}function Cr(e,n){Sp++,Qw[Sp]=e.current,e.current=n}var Iu={},Oo=Nu(Iu),ha=Nu(!1),Fd=Iu;function Bp(e,n){var o=e.type.contextTypes;if(!o)return Iu;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===n)return s.__reactInternalMemoizedMaskedChildContext;var c={},d;for(d in o)c[d]=n[d];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=c),c}function pa(e){return e=e.childContextTypes,e!=null}function D_(){Nr(ha),Nr(Oo)}function u4(e,n,o){if(Oo.current!==Iu)throw Error(qe(168));Cr(Oo,n),Cr(ha,o)}function I8(e,n,o){var s=e.stateNode;if(n=n.childContextTypes,typeof s.getChildContext!="function")return o;s=s.getChildContext();for(var c in s)if(!(c in n))throw Error(qe(108,_re(e)||"Unknown",c));return Xr({},o,s)}function k_(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Iu,Fd=Oo.current,Cr(Oo,e),Cr(ha,ha.current),!0}function d4(e,n,o){var s=e.stateNode;if(!s)throw Error(qe(169));o?(e=I8(e,n,Fd),s.__reactInternalMemoizedMergedChildContext=e,Nr(ha),Nr(Oo),Cr(Oo,e)):Nr(ha),Cr(ha,o)}var rl=null,Ny=!1,$R=!1;function A8(e){rl===null?rl=[e]:rl.push(e)}function Mie(e){Ny=!0,A8(e)}function Pu(){if(!$R&&rl!==null){$R=!0;var e=0,n=tr;try{var o=rl;for(tr=1;e<o.length;e++){var s=o[e];do s=s(!0);while(s!==null)}rl=null,Ny=!1}catch(c){throw rl!==null&&(rl=rl.slice(e+1)),Z6(FA,Pu),c}finally{tr=n,$R=!1}}return null}var Cp=[],bp=0,L_=null,M_=0,ms=[],gs=0,Ud=null,ol=1,al="";function Ed(e,n){Cp[bp++]=M_,Cp[bp++]=L_,L_=e,M_=n}function O8(e,n,o){ms[gs++]=ol,ms[gs++]=al,ms[gs++]=Ud,Ud=e;var s=ol;e=al;var c=32-Xs(s)-1;s&=~(1<<c),o+=1;var d=32-Xs(n)+c;if(30<d){var p=c-c%5;d=(s&(1<<p)-1).toString(32),s>>=p,c-=p,ol=1<<32-Xs(n)+c|o<<c|s,al=d+e}else ol=1<<d|o<<c|s,al=e}function GA(e){e.return!==null&&(Ed(e,1),O8(e,1,0))}function KA(e){for(;e===L_;)L_=Cp[--bp],Cp[bp]=null,M_=Cp[--bp],Cp[bp]=null;for(;e===Ud;)Ud=ms[--gs],ms[gs]=null,al=ms[--gs],ms[gs]=null,ol=ms[--gs],ms[gs]=null}var Ha=null,Va=null,$r=!1,Ks=null;function x8(e,n){var o=vs(5,null,null,0);o.elementType="DELETED",o.stateNode=n,o.return=e,n=e.deletions,n===null?(e.deletions=[o],e.flags|=16):n.push(o)}function h4(e,n){switch(e.tag){case 5:var o=e.type;return n=n.nodeType!==1||o.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,Ha=e,Va=Su(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,Ha=e,Va=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(o=Ud!==null?{id:ol,overflow:al}:null,e.memoizedState={dehydrated:n,treeContext:o,retryLane:1073741824},o=vs(18,null,null,0),o.stateNode=n,o.return=e,e.child=o,Ha=e,Va=null,!0):!1;default:return!1}}function Zw(e){return(e.mode&1)!==0&&(e.flags&128)===0}function eI(e){if($r){var n=Va;if(n){var o=n;if(!h4(e,n)){if(Zw(e))throw Error(qe(418));n=Su(o.nextSibling);var s=Ha;n&&h4(e,n)?x8(s,o):(e.flags=e.flags&-4097|2,$r=!1,Ha=e)}}else{if(Zw(e))throw Error(qe(418));e.flags=e.flags&-4097|2,$r=!1,Ha=e}}}function p4(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ha=e}function TE(e){if(e!==Ha)return!1;if(!$r)return p4(e),$r=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!Yw(e.type,e.memoizedProps)),n&&(n=Va)){if(Zw(e))throw N8(),Error(qe(418));for(;n;)x8(e,n),n=Su(n.nextSibling)}if(p4(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(qe(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var o=e.data;if(o==="/$"){if(n===0){Va=Su(e.nextSibling);break e}n--}else o!=="$"&&o!=="$!"&&o!=="$?"||n++}e=e.nextSibling}Va=null}}else Va=Ha?Su(e.stateNode.nextSibling):null;return!0}function N8(){for(var e=Va;e;)e=Su(e.nextSibling)}function jp(){Va=Ha=null,$r=!1}function qA(e){Ks===null?Ks=[e]:Ks.push(e)}var Fie=Sl.ReactCurrentBatchConfig;function $s(e,n){if(e&&e.defaultProps){n=Xr({},n),e=e.defaultProps;for(var o in e)n[o]===void 0&&(n[o]=e[o]);return n}return n}var F_=Nu(null),U_=null,Tp=null,YA=null;function XA(){YA=Tp=U_=null}function JA(e){var n=F_.current;Nr(F_),e._currentValue=n}function tI(e,n,o){for(;e!==null;){var s=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,s!==null&&(s.childLanes|=n)):s!==null&&(s.childLanes&n)!==n&&(s.childLanes|=n),e===o)break;e=e.return}}function Lp(e,n){U_=e,YA=Tp=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&n&&(da=!0),e.firstContext=null)}function ys(e){var n=e._currentValue;if(YA!==e)if(e={context:e,memoizedValue:n,next:null},Tp===null){if(U_===null)throw Error(qe(308));Tp=e,U_.dependencies={lanes:0,firstContext:e}}else Tp=Tp.next=e;return n}var Td=null;function QA(e){Td===null?Td=[e]:Td.push(e)}function P8(e,n,o,s){var c=n.interleaved;return c===null?(o.next=o,QA(n)):(o.next=c.next,c.next=o),n.interleaved=o,pl(e,s)}function pl(e,n){e.lanes|=n;var o=e.alternate;for(o!==null&&(o.lanes|=n),o=e,e=e.return;e!==null;)e.childLanes|=n,o=e.alternate,o!==null&&(o.childLanes|=n),o=e,e=e.return;return o.tag===3?o.stateNode:null}var uu=!1;function ZA(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function D8(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function sl(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function Cu(e,n,o){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,Mn&2){var c=s.pending;return c===null?n.next=n:(n.next=c.next,c.next=n),s.pending=n,pl(e,o)}return c=s.interleaved,c===null?(n.next=n,QA(s)):(n.next=c.next,c.next=n),s.interleaved=n,pl(e,o)}function o_(e,n,o){if(n=n.updateQueue,n!==null&&(n=n.shared,(o&4194240)!==0)){var s=n.lanes;s&=e.pendingLanes,o|=s,n.lanes=o,UA(e,o)}}function f4(e,n){var o=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,o===s)){var c=null,d=null;if(o=o.firstBaseUpdate,o!==null){do{var p={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};d===null?c=d=p:d=d.next=p,o=o.next}while(o!==null);d===null?c=d=n:d=d.next=n}else c=d=n;o={baseState:s.baseState,firstBaseUpdate:c,lastBaseUpdate:d,shared:s.shared,effects:s.effects},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=n:e.next=n,o.lastBaseUpdate=n}function B_(e,n,o,s){var c=e.updateQueue;uu=!1;var d=c.firstBaseUpdate,p=c.lastBaseUpdate,m=c.shared.pending;if(m!==null){c.shared.pending=null;var g=m,_=g.next;g.next=null,p===null?d=_:p.next=_,p=g;var S=e.alternate;S!==null&&(S=S.updateQueue,m=S.lastBaseUpdate,m!==p&&(m===null?S.firstBaseUpdate=_:m.next=_,S.lastBaseUpdate=g))}if(d!==null){var T=c.baseState;p=0,S=_=g=null,m=d;do{var R=m.lane,N=m.eventTime;if((s&R)===R){S!==null&&(S=S.next={eventTime:N,lane:0,tag:m.tag,payload:m.payload,callback:m.callback,next:null});e:{var O=e,A=m;switch(R=n,N=o,A.tag){case 1:if(O=A.payload,typeof O=="function"){T=O.call(N,T,R);break e}T=O;break e;case 3:O.flags=O.flags&-65537|128;case 0:if(O=A.payload,R=typeof O=="function"?O.call(N,T,R):O,R==null)break e;T=Xr({},T,R);break e;case 2:uu=!0}}m.callback!==null&&m.lane!==0&&(e.flags|=64,R=c.effects,R===null?c.effects=[m]:R.push(m))}else N={eventTime:N,lane:R,tag:m.tag,payload:m.payload,callback:m.callback,next:null},S===null?(_=S=N,g=T):S=S.next=N,p|=R;if(m=m.next,m===null){if(m=c.shared.pending,m===null)break;R=m,m=R.next,R.next=null,c.lastBaseUpdate=R,c.shared.pending=null}}while(1);if(S===null&&(g=T),c.baseState=g,c.firstBaseUpdate=_,c.lastBaseUpdate=S,n=c.shared.interleaved,n!==null){c=n;do p|=c.lane,c=c.next;while(c!==n)}else d===null&&(c.shared.lanes=0);jd|=p,e.lanes=p,e.memoizedState=T}}function m4(e,n,o){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var s=e[n],c=s.callback;if(c!==null){if(s.callback=null,s=o,typeof c!="function")throw Error(qe(191,c));c.call(s)}}}var k8=new P6.Component().refs;function nI(e,n,o,s){n=e.memoizedState,o=o(s,n),o=o==null?n:Xr({},n,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var Py={isMounted:function(e){return(e=e._reactInternals)?Wd(e)===e:!1},enqueueSetState:function(e,n,o){e=e._reactInternals;var s=Vo(),c=Tu(e),d=sl(s,c);d.payload=n,o!=null&&(d.callback=o),n=Cu(e,d,c),n!==null&&(Js(n,e,c,s),o_(n,e,c))},enqueueReplaceState:function(e,n,o){e=e._reactInternals;var s=Vo(),c=Tu(e),d=sl(s,c);d.tag=1,d.payload=n,o!=null&&(d.callback=o),n=Cu(e,d,c),n!==null&&(Js(n,e,c,s),o_(n,e,c))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var o=Vo(),s=Tu(e),c=sl(o,s);c.tag=2,n!=null&&(c.callback=n),n=Cu(e,c,s),n!==null&&(Js(n,e,s,o),o_(n,e,s))}};function g4(e,n,o,s,c,d,p){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,d,p):n.prototype&&n.prototype.isPureReactComponent?!Em(o,s)||!Em(c,d):!0}function L8(e,n,o){var s=!1,c=Iu,d=n.contextType;return typeof d=="object"&&d!==null?d=ys(d):(c=pa(n)?Fd:Oo.current,s=n.contextTypes,d=(s=s!=null)?Bp(e,c):Iu),n=new n(o,d),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=Py,e.stateNode=n,n._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=c,e.__reactInternalMemoizedMaskedChildContext=d),n}function v4(e,n,o,s){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(o,s),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(o,s),n.state!==e&&Py.enqueueReplaceState(n,n.state,null)}function rI(e,n,o,s){var c=e.stateNode;c.props=o,c.state=e.memoizedState,c.refs=k8,ZA(e);var d=n.contextType;typeof d=="object"&&d!==null?c.context=ys(d):(d=pa(n)?Fd:Oo.current,c.context=Bp(e,d)),c.state=e.memoizedState,d=n.getDerivedStateFromProps,typeof d=="function"&&(nI(e,n,d,o),c.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(n=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),n!==c.state&&Py.enqueueReplaceState(c,c.state,null),B_(e,o,c,s),c.state=e.memoizedState),typeof c.componentDidMount=="function"&&(e.flags|=4194308)}function A0(e,n,o){if(e=o.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(qe(309));var s=o.stateNode}if(!s)throw Error(qe(147,e));var c=s,d=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===d?n.ref:(n=function(p){var m=c.refs;m===k8&&(m=c.refs={}),p===null?delete m[d]:m[d]=p},n._stringRef=d,n)}if(typeof e!="string")throw Error(qe(284));if(!o._owner)throw Error(qe(290,e))}return e}function RE(e,n){throw e=Object.prototype.toString.call(n),Error(qe(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function E4(e){var n=e._init;return n(e._payload)}function M8(e){function n(x,P){if(e){var D=x.deletions;D===null?(x.deletions=[P],x.flags|=16):D.push(P)}}function o(x,P){if(!e)return null;for(;P!==null;)n(x,P),P=P.sibling;return null}function s(x,P){for(x=new Map;P!==null;)P.key!==null?x.set(P.key,P):x.set(P.index,P),P=P.sibling;return x}function c(x,P){return x=Ru(x,P),x.index=0,x.sibling=null,x}function d(x,P,D){return x.index=D,e?(D=x.alternate,D!==null?(D=D.index,D<P?(x.flags|=2,P):D):(x.flags|=2,P)):(x.flags|=1048576,P)}function p(x){return e&&x.alternate===null&&(x.flags|=2),x}function m(x,P,D,F){return P===null||P.tag!==6?(P=YR(D,x.mode,F),P.return=x,P):(P=c(P,D),P.return=x,P)}function g(x,P,D,F){var j=D.type;return j===gp?S(x,P,D.props.children,F,D.key):P!==null&&(P.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===lu&&E4(j)===P.type)?(F=c(P,D.props),F.ref=A0(x,P,D),F.return=x,F):(F=d_(D.type,D.key,D.props,null,x.mode,F),F.ref=A0(x,P,D),F.return=x,F)}function _(x,P,D,F){return P===null||P.tag!==4||P.stateNode.containerInfo!==D.containerInfo||P.stateNode.implementation!==D.implementation?(P=XR(D,x.mode,F),P.return=x,P):(P=c(P,D.children||[]),P.return=x,P)}function S(x,P,D,F,j){return P===null||P.tag!==7?(P=xd(D,x.mode,F,j),P.return=x,P):(P=c(P,D),P.return=x,P)}function T(x,P,D){if(typeof P=="string"&&P!==""||typeof P=="number")return P=YR(""+P,x.mode,D),P.return=x,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case fE:return D=d_(P.type,P.key,P.props,null,x.mode,D),D.ref=A0(x,null,P),D.return=x,D;case mp:return P=XR(P,x.mode,D),P.return=x,P;case lu:var F=P._init;return T(x,F(P._payload),D)}if(V0(P)||b0(P))return P=xd(P,x.mode,D,null),P.return=x,P;RE(x,P)}return null}function R(x,P,D,F){var j=P!==null?P.key:null;if(typeof D=="string"&&D!==""||typeof D=="number")return j!==null?null:m(x,P,""+D,F);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case fE:return D.key===j?g(x,P,D,F):null;case mp:return D.key===j?_(x,P,D,F):null;case lu:return j=D._init,R(x,P,j(D._payload),F)}if(V0(D)||b0(D))return j!==null?null:S(x,P,D,F,null);RE(x,D)}return null}function N(x,P,D,F,j){if(typeof F=="string"&&F!==""||typeof F=="number")return x=x.get(D)||null,m(P,x,""+F,j);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case fE:return x=x.get(F.key===null?D:F.key)||null,g(P,x,F,j);case mp:return x=x.get(F.key===null?D:F.key)||null,_(P,x,F,j);case lu:var B=F._init;return N(x,P,D,B(F._payload),j)}if(V0(F)||b0(F))return x=x.get(D)||null,S(P,x,F,j,null);RE(P,F)}return null}function O(x,P,D,F){for(var j=null,B=null,H=P,K=P=0,J=null;H!==null&&K<D.length;K++){H.index>K?(J=H,H=null):J=H.sibling;var q=R(x,H,D[K],F);if(q===null){H===null&&(H=J);break}e&&H&&q.alternate===null&&n(x,H),P=d(q,P,K),B===null?j=q:B.sibling=q,B=q,H=J}if(K===D.length)return o(x,H),$r&&Ed(x,K),j;if(H===null){for(;K<D.length;K++)H=T(x,D[K],F),H!==null&&(P=d(H,P,K),B===null?j=H:B.sibling=H,B=H);return $r&&Ed(x,K),j}for(H=s(x,H);K<D.length;K++)J=N(H,x,K,D[K],F),J!==null&&(e&&J.alternate!==null&&H.delete(J.key===null?K:J.key),P=d(J,P,K),B===null?j=J:B.sibling=J,B=J);return e&&H.forEach(function(Q){return n(x,Q)}),$r&&Ed(x,K),j}function A(x,P,D,F){var j=b0(D);if(typeof j!="function")throw Error(qe(150));if(D=j.call(D),D==null)throw Error(qe(151));for(var B=j=null,H=P,K=P=0,J=null,q=D.next();H!==null&&!q.done;K++,q=D.next()){H.index>K?(J=H,H=null):J=H.sibling;var Q=R(x,H,q.value,F);if(Q===null){H===null&&(H=J);break}e&&H&&Q.alternate===null&&n(x,H),P=d(Q,P,K),B===null?j=Q:B.sibling=Q,B=Q,H=J}if(q.done)return o(x,H),$r&&Ed(x,K),j;if(H===null){for(;!q.done;K++,q=D.next())q=T(x,q.value,F),q!==null&&(P=d(q,P,K),B===null?j=q:B.sibling=q,B=q);return $r&&Ed(x,K),j}for(H=s(x,H);!q.done;K++,q=D.next())q=N(H,x,K,q.value,F),q!==null&&(e&&q.alternate!==null&&H.delete(q.key===null?K:q.key),P=d(q,P,K),B===null?j=q:B.sibling=q,B=q);return e&&H.forEach(function(ee){return n(x,ee)}),$r&&Ed(x,K),j}function M(x,P,D,F){if(typeof D=="object"&&D!==null&&D.type===gp&&D.key===null&&(D=D.props.children),typeof D=="object"&&D!==null){switch(D.$$typeof){case fE:e:{for(var j=D.key,B=P;B!==null;){if(B.key===j){if(j=D.type,j===gp){if(B.tag===7){o(x,B.sibling),P=c(B,D.props.children),P.return=x,x=P;break e}}else if(B.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===lu&&E4(j)===B.type){o(x,B.sibling),P=c(B,D.props),P.ref=A0(x,B,D),P.return=x,x=P;break e}o(x,B);break}else n(x,B);B=B.sibling}D.type===gp?(P=xd(D.props.children,x.mode,F,D.key),P.return=x,x=P):(F=d_(D.type,D.key,D.props,null,x.mode,F),F.ref=A0(x,P,D),F.return=x,x=F)}return p(x);case mp:e:{for(B=D.key;P!==null;){if(P.key===B)if(P.tag===4&&P.stateNode.containerInfo===D.containerInfo&&P.stateNode.implementation===D.implementation){o(x,P.sibling),P=c(P,D.children||[]),P.return=x,x=P;break e}else{o(x,P);break}else n(x,P);P=P.sibling}P=XR(D,x.mode,F),P.return=x,x=P}return p(x);case lu:return B=D._init,M(x,P,B(D._payload),F)}if(V0(D))return O(x,P,D,F);if(b0(D))return A(x,P,D,F);RE(x,D)}return typeof D=="string"&&D!==""||typeof D=="number"?(D=""+D,P!==null&&P.tag===6?(o(x,P.sibling),P=c(P,D),P.return=x,x=P):(o(x,P),P=YR(D,x.mode,F),P.return=x,x=P),p(x)):o(x,P)}return M}var Vp=M8(!0),F8=M8(!1),zm={},Lc=Nu(zm),Cm=Nu(zm),bm=Nu(zm);function Rd(e){if(e===zm)throw Error(qe(174));return e}function eO(e,n){switch(Cr(bm,n),Cr(Cm,e),Cr(Lc,zm),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:Lw(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=Lw(n,e)}Nr(Lc),Cr(Lc,n)}function $p(){Nr(Lc),Nr(Cm),Nr(bm)}function U8(e){Rd(bm.current);var n=Rd(Lc.current),o=Lw(n,e.type);n!==o&&(Cr(Cm,e),Cr(Lc,o))}function tO(e){Cm.current===e&&(Nr(Lc),Nr(Cm))}var Kr=Nu(0);function j_(e){for(var n=e;n!==null;){if(n.tag===13){var o=n.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var HR=[];function nO(){for(var e=0;e<HR.length;e++)HR[e]._workInProgressVersionPrimary=null;HR.length=0}var a_=Sl.ReactCurrentDispatcher,WR=Sl.ReactCurrentBatchConfig,Bd=0,Yr=null,Mi=null,Gi=null,V_=!1,J0=!1,Tm=0,Uie=0;function To(){throw Error(qe(321))}function rO(e,n){if(n===null)return!1;for(var o=0;o<n.length&&o<e.length;o++)if(!ec(e[o],n[o]))return!1;return!0}function iO(e,n,o,s,c,d){if(Bd=d,Yr=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,a_.current=e===null||e.memoizedState===null?$ie:Hie,e=o(s,c),J0){d=0;do{if(J0=!1,Tm=0,25<=d)throw Error(qe(301));d+=1,Gi=Mi=null,n.updateQueue=null,a_.current=Wie,e=o(s,c)}while(J0)}if(a_.current=$_,n=Mi!==null&&Mi.next!==null,Bd=0,Gi=Mi=Yr=null,V_=!1,n)throw Error(qe(300));return e}function oO(){var e=Tm!==0;return Tm=0,e}function xc(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gi===null?Yr.memoizedState=Gi=e:Gi=Gi.next=e,Gi}function Ss(){if(Mi===null){var e=Yr.alternate;e=e!==null?e.memoizedState:null}else e=Mi.next;var n=Gi===null?Yr.memoizedState:Gi.next;if(n!==null)Gi=n,Mi=e;else{if(e===null)throw Error(qe(310));Mi=e,e={memoizedState:Mi.memoizedState,baseState:Mi.baseState,baseQueue:Mi.baseQueue,queue:Mi.queue,next:null},Gi===null?Yr.memoizedState=Gi=e:Gi=Gi.next=e}return Gi}function Rm(e,n){return typeof n=="function"?n(e):n}function zR(e){var n=Ss(),o=n.queue;if(o===null)throw Error(qe(311));o.lastRenderedReducer=e;var s=Mi,c=s.baseQueue,d=o.pending;if(d!==null){if(c!==null){var p=c.next;c.next=d.next,d.next=p}s.baseQueue=c=d,o.pending=null}if(c!==null){d=c.next,s=s.baseState;var m=p=null,g=null,_=d;do{var S=_.lane;if((Bd&S)===S)g!==null&&(g=g.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),s=_.hasEagerState?_.eagerState:e(s,_.action);else{var T={lane:S,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};g===null?(m=g=T,p=s):g=g.next=T,Yr.lanes|=S,jd|=S}_=_.next}while(_!==null&&_!==d);g===null?p=s:g.next=m,ec(s,n.memoizedState)||(da=!0),n.memoizedState=s,n.baseState=p,n.baseQueue=g,o.lastRenderedState=s}if(e=o.interleaved,e!==null){c=e;do d=c.lane,Yr.lanes|=d,jd|=d,c=c.next;while(c!==e)}else c===null&&(o.lanes=0);return[n.memoizedState,o.dispatch]}function GR(e){var n=Ss(),o=n.queue;if(o===null)throw Error(qe(311));o.lastRenderedReducer=e;var s=o.dispatch,c=o.pending,d=n.memoizedState;if(c!==null){o.pending=null;var p=c=c.next;do d=e(d,p.action),p=p.next;while(p!==c);ec(d,n.memoizedState)||(da=!0),n.memoizedState=d,n.baseQueue===null&&(n.baseState=d),o.lastRenderedState=d}return[d,s]}function B8(){}function j8(e,n){var o=Yr,s=Ss(),c=n(),d=!ec(s.memoizedState,c);if(d&&(s.memoizedState=c,da=!0),s=s.queue,aO(H8.bind(null,o,s,e),[e]),s.getSnapshot!==n||d||Gi!==null&&Gi.memoizedState.tag&1){if(o.flags|=2048,wm(9,$8.bind(null,o,s,c,n),void 0,null),Ki===null)throw Error(qe(349));Bd&30||V8(o,n,c)}return c}function V8(e,n,o){e.flags|=16384,e={getSnapshot:n,value:o},n=Yr.updateQueue,n===null?(n={lastEffect:null,stores:null},Yr.updateQueue=n,n.stores=[e]):(o=n.stores,o===null?n.stores=[e]:o.push(e))}function $8(e,n,o,s){n.value=o,n.getSnapshot=s,W8(n)&&z8(e)}function H8(e,n,o){return o(function(){W8(n)&&z8(e)})}function W8(e){var n=e.getSnapshot;e=e.value;try{var o=n();return!ec(e,o)}catch{return!0}}function z8(e){var n=pl(e,1);n!==null&&Js(n,e,1,-1)}function _4(e){var n=xc();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Rm,lastRenderedState:e},n.queue=e,e=e.dispatch=Vie.bind(null,Yr,e),[n.memoizedState,e]}function wm(e,n,o,s){return e={tag:e,create:n,destroy:o,deps:s,next:null},n=Yr.updateQueue,n===null?(n={lastEffect:null,stores:null},Yr.updateQueue=n,n.lastEffect=e.next=e):(o=n.lastEffect,o===null?n.lastEffect=e.next=e:(s=o.next,o.next=e,e.next=s,n.lastEffect=e)),e}function G8(){return Ss().memoizedState}function s_(e,n,o,s){var c=xc();Yr.flags|=e,c.memoizedState=wm(1|n,o,void 0,s===void 0?null:s)}function Dy(e,n,o,s){var c=Ss();s=s===void 0?null:s;var d=void 0;if(Mi!==null){var p=Mi.memoizedState;if(d=p.destroy,s!==null&&rO(s,p.deps)){c.memoizedState=wm(n,o,d,s);return}}Yr.flags|=e,c.memoizedState=wm(1|n,o,d,s)}function y4(e,n){return s_(8390656,8,e,n)}function aO(e,n){return Dy(2048,8,e,n)}function K8(e,n){return Dy(4,2,e,n)}function q8(e,n){return Dy(4,4,e,n)}function Y8(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function X8(e,n,o){return o=o!=null?o.concat([e]):null,Dy(4,4,Y8.bind(null,n,e),o)}function sO(){}function J8(e,n){var o=Ss();n=n===void 0?null:n;var s=o.memoizedState;return s!==null&&n!==null&&rO(n,s[1])?s[0]:(o.memoizedState=[e,n],e)}function Q8(e,n){var o=Ss();n=n===void 0?null:n;var s=o.memoizedState;return s!==null&&n!==null&&rO(n,s[1])?s[0]:(e=e(),o.memoizedState=[e,n],e)}function Z8(e,n,o){return Bd&21?(ec(o,n)||(o=n8(),Yr.lanes|=o,jd|=o,e.baseState=!0),n):(e.baseState&&(e.baseState=!1,da=!0),e.memoizedState=o)}function Bie(e,n){var o=tr;tr=o!==0&&4>o?o:4,e(!0);var s=WR.transition;WR.transition={};try{e(!1),n()}finally{tr=o,WR.transition=s}}function ej(){return Ss().memoizedState}function jie(e,n,o){var s=Tu(e);if(o={lane:s,action:o,hasEagerState:!1,eagerState:null,next:null},tj(e))nj(n,o);else if(o=P8(e,n,o,s),o!==null){var c=Vo();Js(o,e,s,c),rj(o,n,s)}}function Vie(e,n,o){var s=Tu(e),c={lane:s,action:o,hasEagerState:!1,eagerState:null,next:null};if(tj(e))nj(n,c);else{var d=e.alternate;if(e.lanes===0&&(d===null||d.lanes===0)&&(d=n.lastRenderedReducer,d!==null))try{var p=n.lastRenderedState,m=d(p,o);if(c.hasEagerState=!0,c.eagerState=m,ec(m,p)){var g=n.interleaved;g===null?(c.next=c,QA(n)):(c.next=g.next,g.next=c),n.interleaved=c;return}}catch{}finally{}o=P8(e,n,c,s),o!==null&&(c=Vo(),Js(o,e,s,c),rj(o,n,s))}}function tj(e){var n=e.alternate;return e===Yr||n!==null&&n===Yr}function nj(e,n){J0=V_=!0;var o=e.pending;o===null?n.next=n:(n.next=o.next,o.next=n),e.pending=n}function rj(e,n,o){if(o&4194240){var s=n.lanes;s&=e.pendingLanes,o|=s,n.lanes=o,UA(e,o)}}var $_={readContext:ys,useCallback:To,useContext:To,useEffect:To,useImperativeHandle:To,useInsertionEffect:To,useLayoutEffect:To,useMemo:To,useReducer:To,useRef:To,useState:To,useDebugValue:To,useDeferredValue:To,useTransition:To,useMutableSource:To,useSyncExternalStore:To,useId:To,unstable_isNewReconciler:!1},$ie={readContext:ys,useCallback:function(e,n){return xc().memoizedState=[e,n===void 0?null:n],e},useContext:ys,useEffect:y4,useImperativeHandle:function(e,n,o){return o=o!=null?o.concat([e]):null,s_(4194308,4,Y8.bind(null,n,e),o)},useLayoutEffect:function(e,n){return s_(4194308,4,e,n)},useInsertionEffect:function(e,n){return s_(4,2,e,n)},useMemo:function(e,n){var o=xc();return n=n===void 0?null:n,e=e(),o.memoizedState=[e,n],e},useReducer:function(e,n,o){var s=xc();return n=o!==void 0?o(n):n,s.memoizedState=s.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},s.queue=e,e=e.dispatch=jie.bind(null,Yr,e),[s.memoizedState,e]},useRef:function(e){var n=xc();return e={current:e},n.memoizedState=e},useState:_4,useDebugValue:sO,useDeferredValue:function(e){return xc().memoizedState=e},useTransition:function(){var e=_4(!1),n=e[0];return e=Bie.bind(null,e[1]),xc().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,o){var s=Yr,c=xc();if($r){if(o===void 0)throw Error(qe(407));o=o()}else{if(o=n(),Ki===null)throw Error(qe(349));Bd&30||V8(s,n,o)}c.memoizedState=o;var d={value:o,getSnapshot:n};return c.queue=d,y4(H8.bind(null,s,d,e),[e]),s.flags|=2048,wm(9,$8.bind(null,s,d,o,n),void 0,null),o},useId:function(){var e=xc(),n=Ki.identifierPrefix;if($r){var o=al,s=ol;o=(s&~(1<<32-Xs(s)-1)).toString(32)+o,n=":"+n+"R"+o,o=Tm++,0<o&&(n+="H"+o.toString(32)),n+=":"}else o=Uie++,n=":"+n+"r"+o.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},Hie={readContext:ys,useCallback:J8,useContext:ys,useEffect:aO,useImperativeHandle:X8,useInsertionEffect:K8,useLayoutEffect:q8,useMemo:Q8,useReducer:zR,useRef:G8,useState:function(){return zR(Rm)},useDebugValue:sO,useDeferredValue:function(e){var n=Ss();return Z8(n,Mi.memoizedState,e)},useTransition:function(){var e=zR(Rm)[0],n=Ss().memoizedState;return[e,n]},useMutableSource:B8,useSyncExternalStore:j8,useId:ej,unstable_isNewReconciler:!1},Wie={readContext:ys,useCallback:J8,useContext:ys,useEffect:aO,useImperativeHandle:X8,useInsertionEffect:K8,useLayoutEffect:q8,useMemo:Q8,useReducer:GR,useRef:G8,useState:function(){return GR(Rm)},useDebugValue:sO,useDeferredValue:function(e){var n=Ss();return Mi===null?n.memoizedState=e:Z8(n,Mi.memoizedState,e)},useTransition:function(){var e=GR(Rm)[0],n=Ss().memoizedState;return[e,n]},useMutableSource:B8,useSyncExternalStore:j8,useId:ej,unstable_isNewReconciler:!1};function Hp(e,n){try{var o="",s=n;do o+=Ere(s),s=s.return;while(s);var c=o}catch(d){c=`
Error generating stack: `+d.message+`
`+d.stack}return{value:e,source:n,stack:c,digest:null}}function KR(e,n,o){return{value:e,source:null,stack:o??null,digest:n??null}}function iI(e,n){try{console.error(n.value)}catch(o){setTimeout(function(){throw o})}}var zie=typeof WeakMap=="function"?WeakMap:Map;function ij(e,n,o){o=sl(-1,o),o.tag=3,o.payload={element:null};var s=n.value;return o.callback=function(){W_||(W_=!0,fI=s),iI(e,n)},o}function oj(e,n,o){o=sl(-1,o),o.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var c=n.value;o.payload=function(){return s(c)},o.callback=function(){iI(e,n)}}var d=e.stateNode;return d!==null&&typeof d.componentDidCatch=="function"&&(o.callback=function(){iI(e,n),typeof s!="function"&&(bu===null?bu=new Set([this]):bu.add(this));var p=n.stack;this.componentDidCatch(n.value,{componentStack:p!==null?p:""})}),o}function S4(e,n,o){var s=e.pingCache;if(s===null){s=e.pingCache=new zie;var c=new Set;s.set(n,c)}else c=s.get(n),c===void 0&&(c=new Set,s.set(n,c));c.has(o)||(c.add(o),e=ooe.bind(null,e,n,o),n.then(e,e))}function C4(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function b4(e,n,o,s,c){return e.mode&1?(e.flags|=65536,e.lanes=c,e):(e===n?e.flags|=65536:(e.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(n=sl(-1,1),n.tag=2,Cu(o,n,1))),o.lanes|=1),e)}var Gie=Sl.ReactCurrentOwner,da=!1;function Bo(e,n,o,s){n.child=e===null?F8(n,null,o,s):Vp(n,e.child,o,s)}function T4(e,n,o,s,c){o=o.render;var d=n.ref;return Lp(n,c),s=iO(e,n,o,s,d,c),o=oO(),e!==null&&!da?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~c,fl(e,n,c)):($r&&o&&GA(n),n.flags|=1,Bo(e,n,s,c),n.child)}function R4(e,n,o,s,c){if(e===null){var d=o.type;return typeof d=="function"&&!mO(d)&&d.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(n.tag=15,n.type=d,aj(e,n,d,s,c)):(e=d_(o.type,null,s,n,n.mode,c),e.ref=n.ref,e.return=n,n.child=e)}if(d=e.child,!(e.lanes&c)){var p=d.memoizedProps;if(o=o.compare,o=o!==null?o:Em,o(p,s)&&e.ref===n.ref)return fl(e,n,c)}return n.flags|=1,e=Ru(d,s),e.ref=n.ref,e.return=n,n.child=e}function aj(e,n,o,s,c){if(e!==null){var d=e.memoizedProps;if(Em(d,s)&&e.ref===n.ref)if(da=!1,n.pendingProps=s=d,(e.lanes&c)!==0)e.flags&131072&&(da=!0);else return n.lanes=e.lanes,fl(e,n,c)}return oI(e,n,o,s,c)}function sj(e,n,o){var s=n.pendingProps,c=s.children,d=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cr(wp,ja),ja|=o;else{if(!(o&1073741824))return e=d!==null?d.baseLanes|o:o,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,Cr(wp,ja),ja|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=d!==null?d.baseLanes:o,Cr(wp,ja),ja|=s}else d!==null?(s=d.baseLanes|o,n.memoizedState=null):s=o,Cr(wp,ja),ja|=s;return Bo(e,n,c,o),n.child}function cj(e,n){var o=n.ref;(e===null&&o!==null||e!==null&&e.ref!==o)&&(n.flags|=512,n.flags|=2097152)}function oI(e,n,o,s,c){var d=pa(o)?Fd:Oo.current;return d=Bp(n,d),Lp(n,c),o=iO(e,n,o,s,d,c),s=oO(),e!==null&&!da?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~c,fl(e,n,c)):($r&&s&&GA(n),n.flags|=1,Bo(e,n,o,c),n.child)}function w4(e,n,o,s,c){if(pa(o)){var d=!0;k_(n)}else d=!1;if(Lp(n,c),n.stateNode===null)c_(e,n),L8(n,o,s),rI(n,o,s,c),s=!0;else if(e===null){var p=n.stateNode,m=n.memoizedProps;p.props=m;var g=p.context,_=o.contextType;typeof _=="object"&&_!==null?_=ys(_):(_=pa(o)?Fd:Oo.current,_=Bp(n,_));var S=o.getDerivedStateFromProps,T=typeof S=="function"||typeof p.getSnapshotBeforeUpdate=="function";T||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(m!==s||g!==_)&&v4(n,p,s,_),uu=!1;var R=n.memoizedState;p.state=R,B_(n,s,p,c),g=n.memoizedState,m!==s||R!==g||ha.current||uu?(typeof S=="function"&&(nI(n,o,S,s),g=n.memoizedState),(m=uu||g4(n,o,m,s,R,g,_))?(T||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(n.flags|=4194308)):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=s,n.memoizedState=g),p.props=s,p.state=g,p.context=_,s=m):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),s=!1)}else{p=n.stateNode,D8(e,n),m=n.memoizedProps,_=n.type===n.elementType?m:$s(n.type,m),p.props=_,T=n.pendingProps,R=p.context,g=o.contextType,typeof g=="object"&&g!==null?g=ys(g):(g=pa(o)?Fd:Oo.current,g=Bp(n,g));var N=o.getDerivedStateFromProps;(S=typeof N=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(m!==T||R!==g)&&v4(n,p,s,g),uu=!1,R=n.memoizedState,p.state=R,B_(n,s,p,c);var O=n.memoizedState;m!==T||R!==O||ha.current||uu?(typeof N=="function"&&(nI(n,o,N,s),O=n.memoizedState),(_=uu||g4(n,o,_,s,R,O,g)||!1)?(S||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(s,O,g),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(s,O,g)),typeof p.componentDidUpdate=="function"&&(n.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof p.componentDidUpdate!="function"||m===e.memoizedProps&&R===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||m===e.memoizedProps&&R===e.memoizedState||(n.flags|=1024),n.memoizedProps=s,n.memoizedState=O),p.props=s,p.state=O,p.context=g,s=_):(typeof p.componentDidUpdate!="function"||m===e.memoizedProps&&R===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||m===e.memoizedProps&&R===e.memoizedState||(n.flags|=1024),s=!1)}return aI(e,n,o,s,d,c)}function aI(e,n,o,s,c,d){cj(e,n);var p=(n.flags&128)!==0;if(!s&&!p)return c&&d4(n,o,!1),fl(e,n,d);s=n.stateNode,Gie.current=n;var m=p&&typeof o.getDerivedStateFromError!="function"?null:s.render();return n.flags|=1,e!==null&&p?(n.child=Vp(n,e.child,null,d),n.child=Vp(n,null,m,d)):Bo(e,n,m,d),n.memoizedState=s.state,c&&d4(n,o,!0),n.child}function lj(e){var n=e.stateNode;n.pendingContext?u4(e,n.pendingContext,n.pendingContext!==n.context):n.context&&u4(e,n.context,!1),eO(e,n.containerInfo)}function I4(e,n,o,s,c){return jp(),qA(c),n.flags|=256,Bo(e,n,o,s),n.child}var sI={dehydrated:null,treeContext:null,retryLane:0};function cI(e){return{baseLanes:e,cachePool:null,transitions:null}}function uj(e,n,o){var s=n.pendingProps,c=Kr.current,d=!1,p=(n.flags&128)!==0,m;if((m=p)||(m=e!==null&&e.memoizedState===null?!1:(c&2)!==0),m?(d=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(c|=1),Cr(Kr,c&1),e===null)return eI(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(n.mode&1?e.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(p=s.children,e=s.fallback,d?(s=n.mode,d=n.child,p={mode:"hidden",children:p},!(s&1)&&d!==null?(d.childLanes=0,d.pendingProps=p):d=My(p,s,0,null),e=xd(e,s,o,null),d.return=n,e.return=n,d.sibling=e,n.child=d,n.child.memoizedState=cI(o),n.memoizedState=sI,e):cO(n,p));if(c=e.memoizedState,c!==null&&(m=c.dehydrated,m!==null))return Kie(e,n,p,s,m,c,o);if(d){d=s.fallback,p=n.mode,c=e.child,m=c.sibling;var g={mode:"hidden",children:s.children};return!(p&1)&&n.child!==c?(s=n.child,s.childLanes=0,s.pendingProps=g,n.deletions=null):(s=Ru(c,g),s.subtreeFlags=c.subtreeFlags&14680064),m!==null?d=Ru(m,d):(d=xd(d,p,o,null),d.flags|=2),d.return=n,s.return=n,s.sibling=d,n.child=s,s=d,d=n.child,p=e.child.memoizedState,p=p===null?cI(o):{baseLanes:p.baseLanes|o,cachePool:null,transitions:p.transitions},d.memoizedState=p,d.childLanes=e.childLanes&~o,n.memoizedState=sI,s}return d=e.child,e=d.sibling,s=Ru(d,{mode:"visible",children:s.children}),!(n.mode&1)&&(s.lanes=o),s.return=n,s.sibling=null,e!==null&&(o=n.deletions,o===null?(n.deletions=[e],n.flags|=16):o.push(e)),n.child=s,n.memoizedState=null,s}function cO(e,n){return n=My({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function wE(e,n,o,s){return s!==null&&qA(s),Vp(n,e.child,null,o),e=cO(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function Kie(e,n,o,s,c,d,p){if(o)return n.flags&256?(n.flags&=-257,s=KR(Error(qe(422))),wE(e,n,p,s)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(d=s.fallback,c=n.mode,s=My({mode:"visible",children:s.children},c,0,null),d=xd(d,c,p,null),d.flags|=2,s.return=n,d.return=n,s.sibling=d,n.child=s,n.mode&1&&Vp(n,e.child,null,p),n.child.memoizedState=cI(p),n.memoizedState=sI,d);if(!(n.mode&1))return wE(e,n,p,null);if(c.data==="$!"){if(s=c.nextSibling&&c.nextSibling.dataset,s)var m=s.dgst;return s=m,d=Error(qe(419)),s=KR(d,s,void 0),wE(e,n,p,s)}if(m=(p&e.childLanes)!==0,da||m){if(s=Ki,s!==null){switch(p&-p){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=c&(s.suspendedLanes|p)?0:c,c!==0&&c!==d.retryLane&&(d.retryLane=c,pl(e,c),Js(s,e,c,-1))}return fO(),s=KR(Error(qe(421))),wE(e,n,p,s)}return c.data==="$?"?(n.flags|=128,n.child=e.child,n=aoe.bind(null,e),c._reactRetry=n,null):(e=d.treeContext,Va=Su(c.nextSibling),Ha=n,$r=!0,Ks=null,e!==null&&(ms[gs++]=ol,ms[gs++]=al,ms[gs++]=Ud,ol=e.id,al=e.overflow,Ud=n),n=cO(n,s.children),n.flags|=4096,n)}function A4(e,n,o){e.lanes|=n;var s=e.alternate;s!==null&&(s.lanes|=n),tI(e.return,n,o)}function qR(e,n,o,s,c){var d=e.memoizedState;d===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:s,tail:o,tailMode:c}:(d.isBackwards=n,d.rendering=null,d.renderingStartTime=0,d.last=s,d.tail=o,d.tailMode=c)}function dj(e,n,o){var s=n.pendingProps,c=s.revealOrder,d=s.tail;if(Bo(e,n,s.children,o),s=Kr.current,s&2)s=s&1|2,n.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&A4(e,o,n);else if(e.tag===19)A4(e,o,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(Cr(Kr,s),!(n.mode&1))n.memoizedState=null;else switch(c){case"forwards":for(o=n.child,c=null;o!==null;)e=o.alternate,e!==null&&j_(e)===null&&(c=o),o=o.sibling;o=c,o===null?(c=n.child,n.child=null):(c=o.sibling,o.sibling=null),qR(n,!1,c,o,d);break;case"backwards":for(o=null,c=n.child,n.child=null;c!==null;){if(e=c.alternate,e!==null&&j_(e)===null){n.child=c;break}e=c.sibling,c.sibling=o,o=c,c=e}qR(n,!0,o,null,d);break;case"together":qR(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function c_(e,n){!(n.mode&1)&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function fl(e,n,o){if(e!==null&&(n.dependencies=e.dependencies),jd|=n.lanes,!(o&n.childLanes))return null;if(e!==null&&n.child!==e.child)throw Error(qe(153));if(n.child!==null){for(e=n.child,o=Ru(e,e.pendingProps),n.child=o,o.return=n;e.sibling!==null;)e=e.sibling,o=o.sibling=Ru(e,e.pendingProps),o.return=n;o.sibling=null}return n.child}function qie(e,n,o){switch(n.tag){case 3:lj(n),jp();break;case 5:U8(n);break;case 1:pa(n.type)&&k_(n);break;case 4:eO(n,n.stateNode.containerInfo);break;case 10:var s=n.type._context,c=n.memoizedProps.value;Cr(F_,s._currentValue),s._currentValue=c;break;case 13:if(s=n.memoizedState,s!==null)return s.dehydrated!==null?(Cr(Kr,Kr.current&1),n.flags|=128,null):o&n.child.childLanes?uj(e,n,o):(Cr(Kr,Kr.current&1),e=fl(e,n,o),e!==null?e.sibling:null);Cr(Kr,Kr.current&1);break;case 19:if(s=(o&n.childLanes)!==0,e.flags&128){if(s)return dj(e,n,o);n.flags|=128}if(c=n.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),Cr(Kr,Kr.current),s)break;return null;case 22:case 23:return n.lanes=0,sj(e,n,o)}return fl(e,n,o)}var hj,lI,pj,fj;hj=function(e,n){for(var o=n.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};lI=function(){};pj=function(e,n,o,s){var c=e.memoizedProps;if(c!==s){e=n.stateNode,Rd(Lc.current);var d=null;switch(o){case"input":c=Nw(e,c),s=Nw(e,s),d=[];break;case"select":c=Xr({},c,{value:void 0}),s=Xr({},s,{value:void 0}),d=[];break;case"textarea":c=kw(e,c),s=kw(e,s),d=[];break;default:typeof c.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=P_)}Mw(o,s);var p;o=null;for(_ in c)if(!s.hasOwnProperty(_)&&c.hasOwnProperty(_)&&c[_]!=null)if(_==="style"){var m=c[_];for(p in m)m.hasOwnProperty(p)&&(o||(o={}),o[p]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(dm.hasOwnProperty(_)?d||(d=[]):(d=d||[]).push(_,null));for(_ in s){var g=s[_];if(m=c!=null?c[_]:void 0,s.hasOwnProperty(_)&&g!==m&&(g!=null||m!=null))if(_==="style")if(m){for(p in m)!m.hasOwnProperty(p)||g&&g.hasOwnProperty(p)||(o||(o={}),o[p]="");for(p in g)g.hasOwnProperty(p)&&m[p]!==g[p]&&(o||(o={}),o[p]=g[p])}else o||(d||(d=[]),d.push(_,o)),o=g;else _==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,m=m?m.__html:void 0,g!=null&&m!==g&&(d=d||[]).push(_,g)):_==="children"?typeof g!="string"&&typeof g!="number"||(d=d||[]).push(_,""+g):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&(dm.hasOwnProperty(_)?(g!=null&&_==="onScroll"&&xr("scroll",e),d||m===g||(d=[])):(d=d||[]).push(_,g))}o&&(d=d||[]).push("style",o);var _=d;(n.updateQueue=_)&&(n.flags|=4)}};fj=function(e,n,o,s){o!==s&&(n.flags|=4)};function O0(e,n){if(!$r)switch(e.tailMode){case"hidden":n=e.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var s=null;o!==null;)o.alternate!==null&&(s=o),o=o.sibling;s===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Ro(e){var n=e.alternate!==null&&e.alternate.child===e.child,o=0,s=0;if(n)for(var c=e.child;c!==null;)o|=c.lanes|c.childLanes,s|=c.subtreeFlags&14680064,s|=c.flags&14680064,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)o|=c.lanes|c.childLanes,s|=c.subtreeFlags,s|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=s,e.childLanes=o,n}function Yie(e,n,o){var s=n.pendingProps;switch(KA(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ro(n),null;case 1:return pa(n.type)&&D_(),Ro(n),null;case 3:return s=n.stateNode,$p(),Nr(ha),Nr(Oo),nO(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(TE(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,Ks!==null&&(vI(Ks),Ks=null))),lI(e,n),Ro(n),null;case 5:tO(n);var c=Rd(bm.current);if(o=n.type,e!==null&&n.stateNode!=null)pj(e,n,o,s,c),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!s){if(n.stateNode===null)throw Error(qe(166));return Ro(n),null}if(e=Rd(Lc.current),TE(n)){s=n.stateNode,o=n.type;var d=n.memoizedProps;switch(s[Dc]=n,s[Sm]=d,e=(n.mode&1)!==0,o){case"dialog":xr("cancel",s),xr("close",s);break;case"iframe":case"object":case"embed":xr("load",s);break;case"video":case"audio":for(c=0;c<H0.length;c++)xr(H0[c],s);break;case"source":xr("error",s);break;case"img":case"image":case"link":xr("error",s),xr("load",s);break;case"details":xr("toggle",s);break;case"input":FU(s,d),xr("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!d.multiple},xr("invalid",s);break;case"textarea":BU(s,d),xr("invalid",s)}Mw(o,d),c=null;for(var p in d)if(d.hasOwnProperty(p)){var m=d[p];p==="children"?typeof m=="string"?s.textContent!==m&&(d.suppressHydrationWarning!==!0&&bE(s.textContent,m,e),c=["children",m]):typeof m=="number"&&s.textContent!==""+m&&(d.suppressHydrationWarning!==!0&&bE(s.textContent,m,e),c=["children",""+m]):dm.hasOwnProperty(p)&&m!=null&&p==="onScroll"&&xr("scroll",s)}switch(o){case"input":mE(s),UU(s,d,!0);break;case"textarea":mE(s),jU(s);break;case"select":case"option":break;default:typeof d.onClick=="function"&&(s.onclick=P_)}s=c,n.updateQueue=s,s!==null&&(n.flags|=4)}else{p=c.nodeType===9?c:c.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=V6(o)),e==="http://www.w3.org/1999/xhtml"?o==="script"?(e=p.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=p.createElement(o,{is:s.is}):(e=p.createElement(o),o==="select"&&(p=e,s.multiple?p.multiple=!0:s.size&&(p.size=s.size))):e=p.createElementNS(e,o),e[Dc]=n,e[Sm]=s,hj(e,n,!1,!1),n.stateNode=e;e:{switch(p=Fw(o,s),o){case"dialog":xr("cancel",e),xr("close",e),c=s;break;case"iframe":case"object":case"embed":xr("load",e),c=s;break;case"video":case"audio":for(c=0;c<H0.length;c++)xr(H0[c],e);c=s;break;case"source":xr("error",e),c=s;break;case"img":case"image":case"link":xr("error",e),xr("load",e),c=s;break;case"details":xr("toggle",e),c=s;break;case"input":FU(e,s),c=Nw(e,s),xr("invalid",e);break;case"option":c=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},c=Xr({},s,{value:void 0}),xr("invalid",e);break;case"textarea":BU(e,s),c=kw(e,s),xr("invalid",e);break;default:c=s}Mw(o,c),m=c;for(d in m)if(m.hasOwnProperty(d)){var g=m[d];d==="style"?W6(e,g):d==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,g!=null&&$6(e,g)):d==="children"?typeof g=="string"?(o!=="textarea"||g!=="")&&hm(e,g):typeof g=="number"&&hm(e,""+g):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(dm.hasOwnProperty(d)?g!=null&&d==="onScroll"&&xr("scroll",e):g!=null&&PA(e,d,g,p))}switch(o){case"input":mE(e),UU(e,s,!1);break;case"textarea":mE(e),jU(e);break;case"option":s.value!=null&&e.setAttribute("value",""+wu(s.value));break;case"select":e.multiple=!!s.multiple,d=s.value,d!=null?Np(e,!!s.multiple,d,!1):s.defaultValue!=null&&Np(e,!!s.multiple,s.defaultValue,!0);break;default:typeof c.onClick=="function"&&(e.onclick=P_)}switch(o){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return Ro(n),null;case 6:if(e&&n.stateNode!=null)fj(e,n,e.memoizedProps,s);else{if(typeof s!="string"&&n.stateNode===null)throw Error(qe(166));if(o=Rd(bm.current),Rd(Lc.current),TE(n)){if(s=n.stateNode,o=n.memoizedProps,s[Dc]=n,(d=s.nodeValue!==o)&&(e=Ha,e!==null))switch(e.tag){case 3:bE(s.nodeValue,o,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&bE(s.nodeValue,o,(e.mode&1)!==0)}d&&(n.flags|=4)}else s=(o.nodeType===9?o:o.ownerDocument).createTextNode(s),s[Dc]=n,n.stateNode=s}return Ro(n),null;case 13:if(Nr(Kr),s=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if($r&&Va!==null&&n.mode&1&&!(n.flags&128))N8(),jp(),n.flags|=98560,d=!1;else if(d=TE(n),s!==null&&s.dehydrated!==null){if(e===null){if(!d)throw Error(qe(318));if(d=n.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(qe(317));d[Dc]=n}else jp(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;Ro(n),d=!1}else Ks!==null&&(vI(Ks),Ks=null),d=!0;if(!d)return n.flags&65536?n:null}return n.flags&128?(n.lanes=o,n):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(n.child.flags|=8192,n.mode&1&&(e===null||Kr.current&1?Fi===0&&(Fi=3):fO())),n.updateQueue!==null&&(n.flags|=4),Ro(n),null);case 4:return $p(),lI(e,n),e===null&&_m(n.stateNode.containerInfo),Ro(n),null;case 10:return JA(n.type._context),Ro(n),null;case 17:return pa(n.type)&&D_(),Ro(n),null;case 19:if(Nr(Kr),d=n.memoizedState,d===null)return Ro(n),null;if(s=(n.flags&128)!==0,p=d.rendering,p===null)if(s)O0(d,!1);else{if(Fi!==0||e!==null&&e.flags&128)for(e=n.child;e!==null;){if(p=j_(e),p!==null){for(n.flags|=128,O0(d,!1),s=p.updateQueue,s!==null&&(n.updateQueue=s,n.flags|=4),n.subtreeFlags=0,s=o,o=n.child;o!==null;)d=o,e=s,d.flags&=14680066,p=d.alternate,p===null?(d.childLanes=0,d.lanes=e,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=p.childLanes,d.lanes=p.lanes,d.child=p.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=p.memoizedProps,d.memoizedState=p.memoizedState,d.updateQueue=p.updateQueue,d.type=p.type,e=p.dependencies,d.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),o=o.sibling;return Cr(Kr,Kr.current&1|2),n.child}e=e.sibling}d.tail!==null&&_i()>Wp&&(n.flags|=128,s=!0,O0(d,!1),n.lanes=4194304)}else{if(!s)if(e=j_(p),e!==null){if(n.flags|=128,s=!0,o=e.updateQueue,o!==null&&(n.updateQueue=o,n.flags|=4),O0(d,!0),d.tail===null&&d.tailMode==="hidden"&&!p.alternate&&!$r)return Ro(n),null}else 2*_i()-d.renderingStartTime>Wp&&o!==1073741824&&(n.flags|=128,s=!0,O0(d,!1),n.lanes=4194304);d.isBackwards?(p.sibling=n.child,n.child=p):(o=d.last,o!==null?o.sibling=p:n.child=p,d.last=p)}return d.tail!==null?(n=d.tail,d.rendering=n,d.tail=n.sibling,d.renderingStartTime=_i(),n.sibling=null,o=Kr.current,Cr(Kr,s?o&1|2:o&1),n):(Ro(n),null);case 22:case 23:return pO(),s=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(n.flags|=8192),s&&n.mode&1?ja&1073741824&&(Ro(n),n.subtreeFlags&6&&(n.flags|=8192)):Ro(n),null;case 24:return null;case 25:return null}throw Error(qe(156,n.tag))}function Xie(e,n){switch(KA(n),n.tag){case 1:return pa(n.type)&&D_(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return $p(),Nr(ha),Nr(Oo),nO(),e=n.flags,e&65536&&!(e&128)?(n.flags=e&-65537|128,n):null;case 5:return tO(n),null;case 13:if(Nr(Kr),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(qe(340));jp()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return Nr(Kr),null;case 4:return $p(),null;case 10:return JA(n.type._context),null;case 22:case 23:return pO(),null;case 24:return null;default:return null}}var IE=!1,Ao=!1,Jie=typeof WeakSet=="function"?WeakSet:Set,ft=null;function Rp(e,n){var o=e.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(s){ri(e,n,s)}else o.current=null}function uI(e,n,o){try{o()}catch(s){ri(e,n,s)}}var O4=!1;function Qie(e,n){if(Kw=O_,e=E8(),zA(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var s=o.getSelection&&o.getSelection();if(s&&s.rangeCount!==0){o=s.anchorNode;var c=s.anchorOffset,d=s.focusNode;s=s.focusOffset;try{o.nodeType,d.nodeType}catch{o=null;break e}var p=0,m=-1,g=-1,_=0,S=0,T=e,R=null;t:for(;;){for(var N;T!==o||c!==0&&T.nodeType!==3||(m=p+c),T!==d||s!==0&&T.nodeType!==3||(g=p+s),T.nodeType===3&&(p+=T.nodeValue.length),(N=T.firstChild)!==null;)R=T,T=N;for(;;){if(T===e)break t;if(R===o&&++_===c&&(m=p),R===d&&++S===s&&(g=p),(N=T.nextSibling)!==null)break;T=R,R=T.parentNode}T=N}o=m===-1||g===-1?null:{start:m,end:g}}else o=null}o=o||{start:0,end:0}}else o=null;for(qw={focusedElem:e,selectionRange:o},O_=!1,ft=n;ft!==null;)if(n=ft,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,ft=e;else for(;ft!==null;){n=ft;try{var O=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(O!==null){var A=O.memoizedProps,M=O.memoizedState,x=n.stateNode,P=x.getSnapshotBeforeUpdate(n.elementType===n.type?A:$s(n.type,A),M);x.__reactInternalSnapshotBeforeUpdate=P}break;case 3:var D=n.stateNode.containerInfo;D.nodeType===1?D.textContent="":D.nodeType===9&&D.documentElement&&D.removeChild(D.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(qe(163))}}catch(F){ri(n,n.return,F)}if(e=n.sibling,e!==null){e.return=n.return,ft=e;break}ft=n.return}return O=O4,O4=!1,O}function Q0(e,n,o){var s=n.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var c=s=s.next;do{if((c.tag&e)===e){var d=c.destroy;c.destroy=void 0,d!==void 0&&uI(n,o,d)}c=c.next}while(c!==s)}}function ky(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var o=n=n.next;do{if((o.tag&e)===e){var s=o.create;o.destroy=s()}o=o.next}while(o!==n)}}function dI(e){var n=e.ref;if(n!==null){var o=e.stateNode;switch(e.tag){case 5:e=o;break;default:e=o}typeof n=="function"?n(e):n.current=e}}function mj(e){var n=e.alternate;n!==null&&(e.alternate=null,mj(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[Dc],delete n[Sm],delete n[Jw],delete n[kie],delete n[Lie])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function gj(e){return e.tag===5||e.tag===3||e.tag===4}function x4(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||gj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function hI(e,n,o){var s=e.tag;if(s===5||s===6)e=e.stateNode,n?o.nodeType===8?o.parentNode.insertBefore(e,n):o.insertBefore(e,n):(o.nodeType===8?(n=o.parentNode,n.insertBefore(e,o)):(n=o,n.appendChild(e)),o=o._reactRootContainer,o!=null||n.onclick!==null||(n.onclick=P_));else if(s!==4&&(e=e.child,e!==null))for(hI(e,n,o),e=e.sibling;e!==null;)hI(e,n,o),e=e.sibling}function pI(e,n,o){var s=e.tag;if(s===5||s===6)e=e.stateNode,n?o.insertBefore(e,n):o.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(pI(e,n,o),e=e.sibling;e!==null;)pI(e,n,o),e=e.sibling}var to=null,Hs=!1;function au(e,n,o){for(o=o.child;o!==null;)vj(e,n,o),o=o.sibling}function vj(e,n,o){if(kc&&typeof kc.onCommitFiberUnmount=="function")try{kc.onCommitFiberUnmount(wy,o)}catch{}switch(o.tag){case 5:Ao||Rp(o,n);case 6:var s=to,c=Hs;to=null,au(e,n,o),to=s,Hs=c,to!==null&&(Hs?(e=to,o=o.stateNode,e.nodeType===8?e.parentNode.removeChild(o):e.removeChild(o)):to.removeChild(o.stateNode));break;case 18:to!==null&&(Hs?(e=to,o=o.stateNode,e.nodeType===8?VR(e.parentNode,o):e.nodeType===1&&VR(e,o),gm(e)):VR(to,o.stateNode));break;case 4:s=to,c=Hs,to=o.stateNode.containerInfo,Hs=!0,au(e,n,o),to=s,Hs=c;break;case 0:case 11:case 14:case 15:if(!Ao&&(s=o.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){c=s=s.next;do{var d=c,p=d.destroy;d=d.tag,p!==void 0&&(d&2||d&4)&&uI(o,n,p),c=c.next}while(c!==s)}au(e,n,o);break;case 1:if(!Ao&&(Rp(o,n),s=o.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=o.memoizedProps,s.state=o.memoizedState,s.componentWillUnmount()}catch(m){ri(o,n,m)}au(e,n,o);break;case 21:au(e,n,o);break;case 22:o.mode&1?(Ao=(s=Ao)||o.memoizedState!==null,au(e,n,o),Ao=s):au(e,n,o);break;default:au(e,n,o)}}function N4(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var o=e.stateNode;o===null&&(o=e.stateNode=new Jie),n.forEach(function(s){var c=soe.bind(null,e,s);o.has(s)||(o.add(s),s.then(c,c))})}}function js(e,n){var o=n.deletions;if(o!==null)for(var s=0;s<o.length;s++){var c=o[s];try{var d=e,p=n,m=p;e:for(;m!==null;){switch(m.tag){case 5:to=m.stateNode,Hs=!1;break e;case 3:to=m.stateNode.containerInfo,Hs=!0;break e;case 4:to=m.stateNode.containerInfo,Hs=!0;break e}m=m.return}if(to===null)throw Error(qe(160));vj(d,p,c),to=null,Hs=!1;var g=c.alternate;g!==null&&(g.return=null),c.return=null}catch(_){ri(c,n,_)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)Ej(n,e),n=n.sibling}function Ej(e,n){var o=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(js(n,e),Oc(e),s&4){try{Q0(3,e,e.return),ky(3,e)}catch(A){ri(e,e.return,A)}try{Q0(5,e,e.return)}catch(A){ri(e,e.return,A)}}break;case 1:js(n,e),Oc(e),s&512&&o!==null&&Rp(o,o.return);break;case 5:if(js(n,e),Oc(e),s&512&&o!==null&&Rp(o,o.return),e.flags&32){var c=e.stateNode;try{hm(c,"")}catch(A){ri(e,e.return,A)}}if(s&4&&(c=e.stateNode,c!=null)){var d=e.memoizedProps,p=o!==null?o.memoizedProps:d,m=e.type,g=e.updateQueue;if(e.updateQueue=null,g!==null)try{m==="input"&&d.type==="radio"&&d.name!=null&&B6(c,d),Fw(m,p);var _=Fw(m,d);for(p=0;p<g.length;p+=2){var S=g[p],T=g[p+1];S==="style"?W6(c,T):S==="dangerouslySetInnerHTML"?$6(c,T):S==="children"?hm(c,T):PA(c,S,T,_)}switch(m){case"input":Pw(c,d);break;case"textarea":j6(c,d);break;case"select":var R=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!d.multiple;var N=d.value;N!=null?Np(c,!!d.multiple,N,!1):R!==!!d.multiple&&(d.defaultValue!=null?Np(c,!!d.multiple,d.defaultValue,!0):Np(c,!!d.multiple,d.multiple?[]:"",!1))}c[Sm]=d}catch(A){ri(e,e.return,A)}}break;case 6:if(js(n,e),Oc(e),s&4){if(e.stateNode===null)throw Error(qe(162));c=e.stateNode,d=e.memoizedProps;try{c.nodeValue=d}catch(A){ri(e,e.return,A)}}break;case 3:if(js(n,e),Oc(e),s&4&&o!==null&&o.memoizedState.isDehydrated)try{gm(n.containerInfo)}catch(A){ri(e,e.return,A)}break;case 4:js(n,e),Oc(e);break;case 13:js(n,e),Oc(e),c=e.child,c.flags&8192&&(d=c.memoizedState!==null,c.stateNode.isHidden=d,!d||c.alternate!==null&&c.alternate.memoizedState!==null||(dO=_i())),s&4&&N4(e);break;case 22:if(S=o!==null&&o.memoizedState!==null,e.mode&1?(Ao=(_=Ao)||S,js(n,e),Ao=_):js(n,e),Oc(e),s&8192){if(_=e.memoizedState!==null,(e.stateNode.isHidden=_)&&!S&&e.mode&1)for(ft=e,S=e.child;S!==null;){for(T=ft=S;ft!==null;){switch(R=ft,N=R.child,R.tag){case 0:case 11:case 14:case 15:Q0(4,R,R.return);break;case 1:Rp(R,R.return);var O=R.stateNode;if(typeof O.componentWillUnmount=="function"){s=R,o=R.return;try{n=s,O.props=n.memoizedProps,O.state=n.memoizedState,O.componentWillUnmount()}catch(A){ri(s,o,A)}}break;case 5:Rp(R,R.return);break;case 22:if(R.memoizedState!==null){D4(T);continue}}N!==null?(N.return=R,ft=N):D4(T)}S=S.sibling}e:for(S=null,T=e;;){if(T.tag===5){if(S===null){S=T;try{c=T.stateNode,_?(d=c.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none"):(m=T.stateNode,g=T.memoizedProps.style,p=g!=null&&g.hasOwnProperty("display")?g.display:null,m.style.display=H6("display",p))}catch(A){ri(e,e.return,A)}}}else if(T.tag===6){if(S===null)try{T.stateNode.nodeValue=_?"":T.memoizedProps}catch(A){ri(e,e.return,A)}}else if((T.tag!==22&&T.tag!==23||T.memoizedState===null||T===e)&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===e)break e;for(;T.sibling===null;){if(T.return===null||T.return===e)break e;S===T&&(S=null),T=T.return}S===T&&(S=null),T.sibling.return=T.return,T=T.sibling}}break;case 19:js(n,e),Oc(e),s&4&&N4(e);break;case 21:break;default:js(n,e),Oc(e)}}function Oc(e){var n=e.flags;if(n&2){try{e:{for(var o=e.return;o!==null;){if(gj(o)){var s=o;break e}o=o.return}throw Error(qe(160))}switch(s.tag){case 5:var c=s.stateNode;s.flags&32&&(hm(c,""),s.flags&=-33);var d=x4(e);pI(e,d,c);break;case 3:case 4:var p=s.stateNode.containerInfo,m=x4(e);hI(e,m,p);break;default:throw Error(qe(161))}}catch(g){ri(e,e.return,g)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function Zie(e,n,o){ft=e,_j(e)}function _j(e,n,o){for(var s=(e.mode&1)!==0;ft!==null;){var c=ft,d=c.child;if(c.tag===22&&s){var p=c.memoizedState!==null||IE;if(!p){var m=c.alternate,g=m!==null&&m.memoizedState!==null||Ao;m=IE;var _=Ao;if(IE=p,(Ao=g)&&!_)for(ft=c;ft!==null;)p=ft,g=p.child,p.tag===22&&p.memoizedState!==null?k4(c):g!==null?(g.return=p,ft=g):k4(c);for(;d!==null;)ft=d,_j(d),d=d.sibling;ft=c,IE=m,Ao=_}P4(e)}else c.subtreeFlags&8772&&d!==null?(d.return=c,ft=d):P4(e)}}function P4(e){for(;ft!==null;){var n=ft;if(n.flags&8772){var o=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:Ao||ky(5,n);break;case 1:var s=n.stateNode;if(n.flags&4&&!Ao)if(o===null)s.componentDidMount();else{var c=n.elementType===n.type?o.memoizedProps:$s(n.type,o.memoizedProps);s.componentDidUpdate(c,o.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var d=n.updateQueue;d!==null&&m4(n,d,s);break;case 3:var p=n.updateQueue;if(p!==null){if(o=null,n.child!==null)switch(n.child.tag){case 5:o=n.child.stateNode;break;case 1:o=n.child.stateNode}m4(n,p,o)}break;case 5:var m=n.stateNode;if(o===null&&n.flags&4){o=m;var g=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":g.autoFocus&&o.focus();break;case"img":g.src&&(o.src=g.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var _=n.alternate;if(_!==null){var S=_.memoizedState;if(S!==null){var T=S.dehydrated;T!==null&&gm(T)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(qe(163))}Ao||n.flags&512&&dI(n)}catch(R){ri(n,n.return,R)}}if(n===e){ft=null;break}if(o=n.sibling,o!==null){o.return=n.return,ft=o;break}ft=n.return}}function D4(e){for(;ft!==null;){var n=ft;if(n===e){ft=null;break}var o=n.sibling;if(o!==null){o.return=n.return,ft=o;break}ft=n.return}}function k4(e){for(;ft!==null;){var n=ft;try{switch(n.tag){case 0:case 11:case 15:var o=n.return;try{ky(4,n)}catch(g){ri(n,o,g)}break;case 1:var s=n.stateNode;if(typeof s.componentDidMount=="function"){var c=n.return;try{s.componentDidMount()}catch(g){ri(n,c,g)}}var d=n.return;try{dI(n)}catch(g){ri(n,d,g)}break;case 5:var p=n.return;try{dI(n)}catch(g){ri(n,p,g)}}}catch(g){ri(n,n.return,g)}if(n===e){ft=null;break}var m=n.sibling;if(m!==null){m.return=n.return,ft=m;break}ft=n.return}}var eoe=Math.ceil,H_=Sl.ReactCurrentDispatcher,lO=Sl.ReactCurrentOwner,Es=Sl.ReactCurrentBatchConfig,Mn=0,Ki=null,Ai=null,oo=0,ja=0,wp=Nu(0),Fi=0,Im=null,jd=0,Ly=0,uO=0,Z0=null,ua=null,dO=0,Wp=1/0,nl=null,W_=!1,fI=null,bu=null,AE=!1,fu=null,z_=0,em=0,mI=null,l_=-1,u_=0;function Vo(){return Mn&6?_i():l_!==-1?l_:l_=_i()}function Tu(e){return e.mode&1?Mn&2&&oo!==0?oo&-oo:Fie.transition!==null?(u_===0&&(u_=n8()),u_):(e=tr,e!==0||(e=window.event,e=e===void 0?16:l8(e.type)),e):1}function Js(e,n,o,s){if(50<em)throw em=0,mI=null,Error(qe(185));$m(e,o,s),(!(Mn&2)||e!==Ki)&&(e===Ki&&(!(Mn&2)&&(Ly|=o),Fi===4&&hu(e,oo)),fa(e,s),o===1&&Mn===0&&!(n.mode&1)&&(Wp=_i()+500,Ny&&Pu()))}function fa(e,n){var o=e.callbackNode;Fre(e,n);var s=A_(e,e===Ki?oo:0);if(s===0)o!==null&&HU(o),e.callbackNode=null,e.callbackPriority=0;else if(n=s&-s,e.callbackPriority!==n){if(o!=null&&HU(o),n===1)e.tag===0?Mie(L4.bind(null,e)):A8(L4.bind(null,e)),Pie(function(){!(Mn&6)&&Pu()}),o=null;else{switch(r8(s)){case 1:o=FA;break;case 4:o=e8;break;case 16:o=I_;break;case 536870912:o=t8;break;default:o=I_}o=Ij(o,yj.bind(null,e))}e.callbackPriority=n,e.callbackNode=o}}function yj(e,n){if(l_=-1,u_=0,Mn&6)throw Error(qe(327));var o=e.callbackNode;if(Mp()&&e.callbackNode!==o)return null;var s=A_(e,e===Ki?oo:0);if(s===0)return null;if(s&30||s&e.expiredLanes||n)n=G_(e,s);else{n=s;var c=Mn;Mn|=2;var d=Cj();(Ki!==e||oo!==n)&&(nl=null,Wp=_i()+500,Od(e,n));do try{roe();break}catch(m){Sj(e,m)}while(1);XA(),H_.current=d,Mn=c,Ai!==null?n=0:(Ki=null,oo=0,n=Fi)}if(n!==0){if(n===2&&(c=$w(e),c!==0&&(s=c,n=gI(e,c))),n===1)throw o=Im,Od(e,0),hu(e,s),fa(e,_i()),o;if(n===6)hu(e,s);else{if(c=e.current.alternate,!(s&30)&&!toe(c)&&(n=G_(e,s),n===2&&(d=$w(e),d!==0&&(s=d,n=gI(e,d))),n===1))throw o=Im,Od(e,0),hu(e,s),fa(e,_i()),o;switch(e.finishedWork=c,e.finishedLanes=s,n){case 0:case 1:throw Error(qe(345));case 2:_d(e,ua,nl);break;case 3:if(hu(e,s),(s&130023424)===s&&(n=dO+500-_i(),10<n)){if(A_(e,0)!==0)break;if(c=e.suspendedLanes,(c&s)!==s){Vo(),e.pingedLanes|=e.suspendedLanes&c;break}e.timeoutHandle=Xw(_d.bind(null,e,ua,nl),n);break}_d(e,ua,nl);break;case 4:if(hu(e,s),(s&4194240)===s)break;for(n=e.eventTimes,c=-1;0<s;){var p=31-Xs(s);d=1<<p,p=n[p],p>c&&(c=p),s&=~d}if(s=c,s=_i()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*eoe(s/1960))-s,10<s){e.timeoutHandle=Xw(_d.bind(null,e,ua,nl),s);break}_d(e,ua,nl);break;case 5:_d(e,ua,nl);break;default:throw Error(qe(329))}}}return fa(e,_i()),e.callbackNode===o?yj.bind(null,e):null}function gI(e,n){var o=Z0;return e.current.memoizedState.isDehydrated&&(Od(e,n).flags|=256),e=G_(e,n),e!==2&&(n=ua,ua=o,n!==null&&vI(n)),e}function vI(e){ua===null?ua=e:ua.push.apply(ua,e)}function toe(e){for(var n=e;;){if(n.flags&16384){var o=n.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var s=0;s<o.length;s++){var c=o[s],d=c.getSnapshot;c=c.value;try{if(!ec(d(),c))return!1}catch{return!1}}}if(o=n.child,n.subtreeFlags&16384&&o!==null)o.return=n,n=o;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function hu(e,n){for(n&=~uO,n&=~Ly,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var o=31-Xs(n),s=1<<o;e[o]=-1,n&=~s}}function L4(e){if(Mn&6)throw Error(qe(327));Mp();var n=A_(e,0);if(!(n&1))return fa(e,_i()),null;var o=G_(e,n);if(e.tag!==0&&o===2){var s=$w(e);s!==0&&(n=s,o=gI(e,s))}if(o===1)throw o=Im,Od(e,0),hu(e,n),fa(e,_i()),o;if(o===6)throw Error(qe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,_d(e,ua,nl),fa(e,_i()),null}function hO(e,n){var o=Mn;Mn|=1;try{return e(n)}finally{Mn=o,Mn===0&&(Wp=_i()+500,Ny&&Pu())}}function Vd(e){fu!==null&&fu.tag===0&&!(Mn&6)&&Mp();var n=Mn;Mn|=1;var o=Es.transition,s=tr;try{if(Es.transition=null,tr=1,e)return e()}finally{tr=s,Es.transition=o,Mn=n,!(Mn&6)&&Pu()}}function pO(){ja=wp.current,Nr(wp)}function Od(e,n){e.finishedWork=null,e.finishedLanes=0;var o=e.timeoutHandle;if(o!==-1&&(e.timeoutHandle=-1,Nie(o)),Ai!==null)for(o=Ai.return;o!==null;){var s=o;switch(KA(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&D_();break;case 3:$p(),Nr(ha),Nr(Oo),nO();break;case 5:tO(s);break;case 4:$p();break;case 13:Nr(Kr);break;case 19:Nr(Kr);break;case 10:JA(s.type._context);break;case 22:case 23:pO()}o=o.return}if(Ki=e,Ai=e=Ru(e.current,null),oo=ja=n,Fi=0,Im=null,uO=Ly=jd=0,ua=Z0=null,Td!==null){for(n=0;n<Td.length;n++)if(o=Td[n],s=o.interleaved,s!==null){o.interleaved=null;var c=s.next,d=o.pending;if(d!==null){var p=d.next;d.next=c,s.next=p}o.pending=s}Td=null}return e}function Sj(e,n){do{var o=Ai;try{if(XA(),a_.current=$_,V_){for(var s=Yr.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}V_=!1}if(Bd=0,Gi=Mi=Yr=null,J0=!1,Tm=0,lO.current=null,o===null||o.return===null){Fi=1,Im=n,Ai=null;break}e:{var d=e,p=o.return,m=o,g=n;if(n=oo,m.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){var _=g,S=m,T=S.tag;if(!(S.mode&1)&&(T===0||T===11||T===15)){var R=S.alternate;R?(S.updateQueue=R.updateQueue,S.memoizedState=R.memoizedState,S.lanes=R.lanes):(S.updateQueue=null,S.memoizedState=null)}var N=C4(p);if(N!==null){N.flags&=-257,b4(N,p,m,d,n),N.mode&1&&S4(d,_,n),n=N,g=_;var O=n.updateQueue;if(O===null){var A=new Set;A.add(g),n.updateQueue=A}else O.add(g);break e}else{if(!(n&1)){S4(d,_,n),fO();break e}g=Error(qe(426))}}else if($r&&m.mode&1){var M=C4(p);if(M!==null){!(M.flags&65536)&&(M.flags|=256),b4(M,p,m,d,n),qA(Hp(g,m));break e}}d=g=Hp(g,m),Fi!==4&&(Fi=2),Z0===null?Z0=[d]:Z0.push(d),d=p;do{switch(d.tag){case 3:d.flags|=65536,n&=-n,d.lanes|=n;var x=ij(d,g,n);f4(d,x);break e;case 1:m=g;var P=d.type,D=d.stateNode;if(!(d.flags&128)&&(typeof P.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(bu===null||!bu.has(D)))){d.flags|=65536,n&=-n,d.lanes|=n;var F=oj(d,m,n);f4(d,F);break e}}d=d.return}while(d!==null)}Tj(o)}catch(j){n=j,Ai===o&&o!==null&&(Ai=o=o.return);continue}break}while(1)}function Cj(){var e=H_.current;return H_.current=$_,e===null?$_:e}function fO(){(Fi===0||Fi===3||Fi===2)&&(Fi=4),Ki===null||!(jd&268435455)&&!(Ly&268435455)||hu(Ki,oo)}function G_(e,n){var o=Mn;Mn|=2;var s=Cj();(Ki!==e||oo!==n)&&(nl=null,Od(e,n));do try{noe();break}catch(c){Sj(e,c)}while(1);if(XA(),Mn=o,H_.current=s,Ai!==null)throw Error(qe(261));return Ki=null,oo=0,Fi}function noe(){for(;Ai!==null;)bj(Ai)}function roe(){for(;Ai!==null&&!Are();)bj(Ai)}function bj(e){var n=wj(e.alternate,e,ja);e.memoizedProps=e.pendingProps,n===null?Tj(e):Ai=n,lO.current=null}function Tj(e){var n=e;do{var o=n.alternate;if(e=n.return,n.flags&32768){if(o=Xie(o,n),o!==null){o.flags&=32767,Ai=o;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Fi=6,Ai=null;return}}else if(o=Yie(o,n,ja),o!==null){Ai=o;return}if(n=n.sibling,n!==null){Ai=n;return}Ai=n=e}while(n!==null);Fi===0&&(Fi=5)}function _d(e,n,o){var s=tr,c=Es.transition;try{Es.transition=null,tr=1,ioe(e,n,o,s)}finally{Es.transition=c,tr=s}return null}function ioe(e,n,o,s){do Mp();while(fu!==null);if(Mn&6)throw Error(qe(327));o=e.finishedWork;var c=e.finishedLanes;if(o===null)return null;if(e.finishedWork=null,e.finishedLanes=0,o===e.current)throw Error(qe(177));e.callbackNode=null,e.callbackPriority=0;var d=o.lanes|o.childLanes;if(Ure(e,d),e===Ki&&(Ai=Ki=null,oo=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||AE||(AE=!0,Ij(I_,function(){return Mp(),null})),d=(o.flags&15990)!==0,o.subtreeFlags&15990||d){d=Es.transition,Es.transition=null;var p=tr;tr=1;var m=Mn;Mn|=4,lO.current=null,Qie(e,o),Ej(o,e),Tie(qw),O_=!!Kw,qw=Kw=null,e.current=o,Zie(o),Ore(),Mn=m,tr=p,Es.transition=d}else e.current=o;if(AE&&(AE=!1,fu=e,z_=c),d=e.pendingLanes,d===0&&(bu=null),Pre(o.stateNode),fa(e,_i()),n!==null)for(s=e.onRecoverableError,o=0;o<n.length;o++)c=n[o],s(c.value,{componentStack:c.stack,digest:c.digest});if(W_)throw W_=!1,e=fI,fI=null,e;return z_&1&&e.tag!==0&&Mp(),d=e.pendingLanes,d&1?e===mI?em++:(em=0,mI=e):em=0,Pu(),null}function Mp(){if(fu!==null){var e=r8(z_),n=Es.transition,o=tr;try{if(Es.transition=null,tr=16>e?16:e,fu===null)var s=!1;else{if(e=fu,fu=null,z_=0,Mn&6)throw Error(qe(331));var c=Mn;for(Mn|=4,ft=e.current;ft!==null;){var d=ft,p=d.child;if(ft.flags&16){var m=d.deletions;if(m!==null){for(var g=0;g<m.length;g++){var _=m[g];for(ft=_;ft!==null;){var S=ft;switch(S.tag){case 0:case 11:case 15:Q0(8,S,d)}var T=S.child;if(T!==null)T.return=S,ft=T;else for(;ft!==null;){S=ft;var R=S.sibling,N=S.return;if(mj(S),S===_){ft=null;break}if(R!==null){R.return=N,ft=R;break}ft=N}}}var O=d.alternate;if(O!==null){var A=O.child;if(A!==null){O.child=null;do{var M=A.sibling;A.sibling=null,A=M}while(A!==null)}}ft=d}}if(d.subtreeFlags&2064&&p!==null)p.return=d,ft=p;else e:for(;ft!==null;){if(d=ft,d.flags&2048)switch(d.tag){case 0:case 11:case 15:Q0(9,d,d.return)}var x=d.sibling;if(x!==null){x.return=d.return,ft=x;break e}ft=d.return}}var P=e.current;for(ft=P;ft!==null;){p=ft;var D=p.child;if(p.subtreeFlags&2064&&D!==null)D.return=p,ft=D;else e:for(p=P;ft!==null;){if(m=ft,m.flags&2048)try{switch(m.tag){case 0:case 11:case 15:ky(9,m)}}catch(j){ri(m,m.return,j)}if(m===p){ft=null;break e}var F=m.sibling;if(F!==null){F.return=m.return,ft=F;break e}ft=m.return}}if(Mn=c,Pu(),kc&&typeof kc.onPostCommitFiberRoot=="function")try{kc.onPostCommitFiberRoot(wy,e)}catch{}s=!0}return s}finally{tr=o,Es.transition=n}}return!1}function M4(e,n,o){n=Hp(o,n),n=ij(e,n,1),e=Cu(e,n,1),n=Vo(),e!==null&&($m(e,1,n),fa(e,n))}function ri(e,n,o){if(e.tag===3)M4(e,e,o);else for(;n!==null;){if(n.tag===3){M4(n,e,o);break}else if(n.tag===1){var s=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(bu===null||!bu.has(s))){e=Hp(o,e),e=oj(n,e,1),n=Cu(n,e,1),e=Vo(),n!==null&&($m(n,1,e),fa(n,e));break}}n=n.return}}function ooe(e,n,o){var s=e.pingCache;s!==null&&s.delete(n),n=Vo(),e.pingedLanes|=e.suspendedLanes&o,Ki===e&&(oo&o)===o&&(Fi===4||Fi===3&&(oo&130023424)===oo&&500>_i()-dO?Od(e,0):uO|=o),fa(e,n)}function Rj(e,n){n===0&&(e.mode&1?(n=EE,EE<<=1,!(EE&130023424)&&(EE=4194304)):n=1);var o=Vo();e=pl(e,n),e!==null&&($m(e,n,o),fa(e,o))}function aoe(e){var n=e.memoizedState,o=0;n!==null&&(o=n.retryLane),Rj(e,o)}function soe(e,n){var o=0;switch(e.tag){case 13:var s=e.stateNode,c=e.memoizedState;c!==null&&(o=c.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(qe(314))}s!==null&&s.delete(n),Rj(e,o)}var wj;wj=function(e,n,o){if(e!==null)if(e.memoizedProps!==n.pendingProps||ha.current)da=!0;else{if(!(e.lanes&o)&&!(n.flags&128))return da=!1,qie(e,n,o);da=!!(e.flags&131072)}else da=!1,$r&&n.flags&1048576&&O8(n,M_,n.index);switch(n.lanes=0,n.tag){case 2:var s=n.type;c_(e,n),e=n.pendingProps;var c=Bp(n,Oo.current);Lp(n,o),c=iO(null,n,s,e,c,o);var d=oO();return n.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,pa(s)?(d=!0,k_(n)):d=!1,n.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,ZA(n),c.updater=Py,n.stateNode=c,c._reactInternals=n,rI(n,s,e,o),n=aI(null,n,s,!0,d,o)):(n.tag=0,$r&&d&&GA(n),Bo(null,n,c,o),n=n.child),n;case 16:s=n.elementType;e:{switch(c_(e,n),e=n.pendingProps,c=s._init,s=c(s._payload),n.type=s,c=n.tag=loe(s),e=$s(s,e),c){case 0:n=oI(null,n,s,e,o);break e;case 1:n=w4(null,n,s,e,o);break e;case 11:n=T4(null,n,s,e,o);break e;case 14:n=R4(null,n,s,$s(s.type,e),o);break e}throw Error(qe(306,s,""))}return n;case 0:return s=n.type,c=n.pendingProps,c=n.elementType===s?c:$s(s,c),oI(e,n,s,c,o);case 1:return s=n.type,c=n.pendingProps,c=n.elementType===s?c:$s(s,c),w4(e,n,s,c,o);case 3:e:{if(lj(n),e===null)throw Error(qe(387));s=n.pendingProps,d=n.memoizedState,c=d.element,D8(e,n),B_(n,s,null,o);var p=n.memoizedState;if(s=p.element,d.isDehydrated)if(d={element:s,isDehydrated:!1,cache:p.cache,pendingSuspenseBoundaries:p.pendingSuspenseBoundaries,transitions:p.transitions},n.updateQueue.baseState=d,n.memoizedState=d,n.flags&256){c=Hp(Error(qe(423)),n),n=I4(e,n,s,o,c);break e}else if(s!==c){c=Hp(Error(qe(424)),n),n=I4(e,n,s,o,c);break e}else for(Va=Su(n.stateNode.containerInfo.firstChild),Ha=n,$r=!0,Ks=null,o=F8(n,null,s,o),n.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(jp(),s===c){n=fl(e,n,o);break e}Bo(e,n,s,o)}n=n.child}return n;case 5:return U8(n),e===null&&eI(n),s=n.type,c=n.pendingProps,d=e!==null?e.memoizedProps:null,p=c.children,Yw(s,c)?p=null:d!==null&&Yw(s,d)&&(n.flags|=32),cj(e,n),Bo(e,n,p,o),n.child;case 6:return e===null&&eI(n),null;case 13:return uj(e,n,o);case 4:return eO(n,n.stateNode.containerInfo),s=n.pendingProps,e===null?n.child=Vp(n,null,s,o):Bo(e,n,s,o),n.child;case 11:return s=n.type,c=n.pendingProps,c=n.elementType===s?c:$s(s,c),T4(e,n,s,c,o);case 7:return Bo(e,n,n.pendingProps,o),n.child;case 8:return Bo(e,n,n.pendingProps.children,o),n.child;case 12:return Bo(e,n,n.pendingProps.children,o),n.child;case 10:e:{if(s=n.type._context,c=n.pendingProps,d=n.memoizedProps,p=c.value,Cr(F_,s._currentValue),s._currentValue=p,d!==null)if(ec(d.value,p)){if(d.children===c.children&&!ha.current){n=fl(e,n,o);break e}}else for(d=n.child,d!==null&&(d.return=n);d!==null;){var m=d.dependencies;if(m!==null){p=d.child;for(var g=m.firstContext;g!==null;){if(g.context===s){if(d.tag===1){g=sl(-1,o&-o),g.tag=2;var _=d.updateQueue;if(_!==null){_=_.shared;var S=_.pending;S===null?g.next=g:(g.next=S.next,S.next=g),_.pending=g}}d.lanes|=o,g=d.alternate,g!==null&&(g.lanes|=o),tI(d.return,o,n),m.lanes|=o;break}g=g.next}}else if(d.tag===10)p=d.type===n.type?null:d.child;else if(d.tag===18){if(p=d.return,p===null)throw Error(qe(341));p.lanes|=o,m=p.alternate,m!==null&&(m.lanes|=o),tI(p,o,n),p=d.sibling}else p=d.child;if(p!==null)p.return=d;else for(p=d;p!==null;){if(p===n){p=null;break}if(d=p.sibling,d!==null){d.return=p.return,p=d;break}p=p.return}d=p}Bo(e,n,c.children,o),n=n.child}return n;case 9:return c=n.type,s=n.pendingProps.children,Lp(n,o),c=ys(c),s=s(c),n.flags|=1,Bo(e,n,s,o),n.child;case 14:return s=n.type,c=$s(s,n.pendingProps),c=$s(s.type,c),R4(e,n,s,c,o);case 15:return aj(e,n,n.type,n.pendingProps,o);case 17:return s=n.type,c=n.pendingProps,c=n.elementType===s?c:$s(s,c),c_(e,n),n.tag=1,pa(s)?(e=!0,k_(n)):e=!1,Lp(n,o),L8(n,s,c),rI(n,s,c,o),aI(null,n,s,!0,e,o);case 19:return dj(e,n,o);case 22:return sj(e,n,o)}throw Error(qe(156,n.tag))};function Ij(e,n){return Z6(e,n)}function coe(e,n,o,s){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vs(e,n,o,s){return new coe(e,n,o,s)}function mO(e){return e=e.prototype,!(!e||!e.isReactComponent)}function loe(e){if(typeof e=="function")return mO(e)?1:0;if(e!=null){if(e=e.$$typeof,e===kA)return 11;if(e===LA)return 14}return 2}function Ru(e,n){var o=e.alternate;return o===null?(o=vs(e.tag,n,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=n,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&14680064,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,n=e.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o}function d_(e,n,o,s,c,d){var p=2;if(s=e,typeof e=="function")mO(e)&&(p=1);else if(typeof e=="string")p=5;else e:switch(e){case gp:return xd(o.children,c,d,n);case DA:p=8,c|=8;break;case Iw:return e=vs(12,o,n,c|2),e.elementType=Iw,e.lanes=d,e;case Aw:return e=vs(13,o,n,c),e.elementType=Aw,e.lanes=d,e;case Ow:return e=vs(19,o,n,c),e.elementType=Ow,e.lanes=d,e;case M6:return My(o,c,d,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case k6:p=10;break e;case L6:p=9;break e;case kA:p=11;break e;case LA:p=14;break e;case lu:p=16,s=null;break e}throw Error(qe(130,e==null?e:typeof e,""))}return n=vs(p,o,n,c),n.elementType=e,n.type=s,n.lanes=d,n}function xd(e,n,o,s){return e=vs(7,e,s,n),e.lanes=o,e}function My(e,n,o,s){return e=vs(22,e,s,n),e.elementType=M6,e.lanes=o,e.stateNode={isHidden:!1},e}function YR(e,n,o){return e=vs(6,e,null,n),e.lanes=o,e}function XR(e,n,o){return n=vs(4,e.children!==null?e.children:[],e.key,n),n.lanes=o,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function uoe(e,n,o,s,c){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xR(0),this.expirationTimes=xR(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xR(0),this.identifierPrefix=s,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function gO(e,n,o,s,c,d,p,m,g){return e=new uoe(e,n,o,m,g),n===1?(n=1,d===!0&&(n|=8)):n=0,d=vs(3,null,null,n),e.current=d,d.stateNode=e,d.memoizedState={element:s,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},ZA(d),e}function doe(e,n,o){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mp,key:s==null?null:""+s,children:e,containerInfo:n,implementation:o}}function Aj(e){if(!e)return Iu;e=e._reactInternals;e:{if(Wd(e)!==e||e.tag!==1)throw Error(qe(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(pa(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(qe(171))}if(e.tag===1){var o=e.type;if(pa(o))return I8(e,o,n)}return n}function Oj(e,n,o,s,c,d,p,m,g){return e=gO(o,s,!0,e,c,d,p,m,g),e.context=Aj(null),o=e.current,s=Vo(),c=Tu(o),d=sl(s,c),d.callback=n??null,Cu(o,d,c),e.current.lanes=c,$m(e,c,s),fa(e,s),e}function Fy(e,n,o,s){var c=n.current,d=Vo(),p=Tu(c);return o=Aj(o),n.context===null?n.context=o:n.pendingContext=o,n=sl(d,p),n.payload={element:e},s=s===void 0?null:s,s!==null&&(n.callback=s),e=Cu(c,n,p),e!==null&&(Js(e,c,p,d),o_(e,c,p)),p}function K_(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function F4(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<n?o:n}}function vO(e,n){F4(e,n),(e=e.alternate)&&F4(e,n)}function hoe(){return null}var xj=typeof reportError=="function"?reportError:function(e){console.error(e)};function EO(e){this._internalRoot=e}Uy.prototype.render=EO.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(qe(409));Fy(e,n,null,null)};Uy.prototype.unmount=EO.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;Vd(function(){Fy(null,e,null,null)}),n[hl]=null}};function Uy(e){this._internalRoot=e}Uy.prototype.unstable_scheduleHydration=function(e){if(e){var n=a8();e={blockedOn:null,target:e,priority:n};for(var o=0;o<du.length&&n!==0&&n<du[o].priority;o++);du.splice(o,0,e),o===0&&c8(e)}};function _O(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function By(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function U4(){}function poe(e,n,o,s,c){if(c){if(typeof s=="function"){var d=s;s=function(){var _=K_(p);d.call(_)}}var p=Oj(n,s,e,0,null,!1,!1,"",U4);return e._reactRootContainer=p,e[hl]=p.current,_m(e.nodeType===8?e.parentNode:e),Vd(),p}for(;c=e.lastChild;)e.removeChild(c);if(typeof s=="function"){var m=s;s=function(){var _=K_(g);m.call(_)}}var g=gO(e,0,!1,null,null,!1,!1,"",U4);return e._reactRootContainer=g,e[hl]=g.current,_m(e.nodeType===8?e.parentNode:e),Vd(function(){Fy(n,g,o,s)}),g}function jy(e,n,o,s,c){var d=o._reactRootContainer;if(d){var p=d;if(typeof c=="function"){var m=c;c=function(){var g=K_(p);m.call(g)}}Fy(n,p,e,c)}else p=poe(o,n,e,c,s);return K_(p)}i8=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var o=$0(n.pendingLanes);o!==0&&(UA(n,o|1),fa(n,_i()),!(Mn&6)&&(Wp=_i()+500,Pu()))}break;case 13:Vd(function(){var s=pl(e,1);if(s!==null){var c=Vo();Js(s,e,1,c)}}),vO(e,1)}};BA=function(e){if(e.tag===13){var n=pl(e,134217728);if(n!==null){var o=Vo();Js(n,e,134217728,o)}vO(e,134217728)}};o8=function(e){if(e.tag===13){var n=Tu(e),o=pl(e,n);if(o!==null){var s=Vo();Js(o,e,n,s)}vO(e,n)}};a8=function(){return tr};s8=function(e,n){var o=tr;try{return tr=e,n()}finally{tr=o}};Bw=function(e,n,o){switch(n){case"input":if(Pw(e,o),n=o.name,o.type==="radio"&&n!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<o.length;n++){var s=o[n];if(s!==e&&s.form===e.form){var c=xy(s);if(!c)throw Error(qe(90));U6(s),Pw(s,c)}}}break;case"textarea":j6(e,o);break;case"select":n=o.value,n!=null&&Np(e,!!o.multiple,n,!1)}};K6=hO;q6=Vd;var foe={usingClientEntryPoint:!1,Events:[Wm,yp,xy,z6,G6,hO]},x0={findFiberByHostInstance:bd,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},moe={bundleType:x0.bundleType,version:x0.version,rendererPackageName:x0.rendererPackageName,rendererConfig:x0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Sl.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=J6(e),e===null?null:e.stateNode},findFiberByHostInstance:x0.findFiberByHostInstance||hoe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var OE=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!OE.isDisabled&&OE.supportsFiber)try{wy=OE.inject(moe),kc=OE}catch{}}Ka.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=foe;Ka.createPortal=function(e,n){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_O(n))throw Error(qe(200));return doe(e,n,null,o)};Ka.createRoot=function(e,n){if(!_O(e))throw Error(qe(299));var o=!1,s="",c=xj;return n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(c=n.onRecoverableError)),n=gO(e,1,!1,null,null,o,!1,s,c),e[hl]=n.current,_m(e.nodeType===8?e.parentNode:e),new EO(n)};Ka.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(qe(188)):(e=Object.keys(e).join(","),Error(qe(268,e)));return e=J6(n),e=e===null?null:e.stateNode,e};Ka.flushSync=function(e){return Vd(e)};Ka.hydrate=function(e,n,o){if(!By(n))throw Error(qe(200));return jy(null,e,n,!0,o)};Ka.hydrateRoot=function(e,n,o){if(!_O(e))throw Error(qe(405));var s=o!=null&&o.hydratedSources||null,c=!1,d="",p=xj;if(o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(d=o.identifierPrefix),o.onRecoverableError!==void 0&&(p=o.onRecoverableError)),n=Oj(n,null,e,1,o??null,c,!1,d,p),e[hl]=n.current,_m(e),s)for(e=0;e<s.length;e++)o=s[e],c=o._getVersion,c=c(o._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[o,c]:n.mutableSourceEagerHydrationData.push(o,c);return new Uy(n)};Ka.render=function(e,n,o){if(!By(n))throw Error(qe(200));return jy(null,e,n,!1,o)};Ka.unmountComponentAtNode=function(e){if(!By(e))throw Error(qe(40));return e._reactRootContainer?(Vd(function(){jy(null,null,e,!1,function(){e._reactRootContainer=null,e[hl]=null})}),!0):!1};Ka.unstable_batchedUpdates=hO;Ka.unstable_renderSubtreeIntoContainer=function(e,n,o,s){if(!By(o))throw Error(qe(200));if(e==null||e._reactInternals===void 0)throw Error(qe(38));return jy(e,n,o,!1,s)};Ka.version="18.2.0-next-9e3b772b8-20220608";function Nj(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Nj)}catch(e){console.error(e)}}Nj(),O6.exports=Ka;var Cl=O6.exports;const Pj=yl(Cl),goe=v6({__proto__:null,default:Pj},[Cl]);var B4=Cl;Rw.createRoot=B4.createRoot,Rw.hydrateRoot=B4.hydrateRoot;/**
 * @remix-run/router v1.9.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Am(){return Am=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},Am.apply(this,arguments)}var mu;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(mu||(mu={}));const j4="popstate";function voe(e){e===void 0&&(e={});function n(c,d){let{pathname:p="/",search:m="",hash:g=""}=zd(c.location.hash.substr(1));return!p.startsWith("/")&&!p.startsWith(".")&&(p="/"+p),EI("",{pathname:p,search:m,hash:g},d.state&&d.state.usr||null,d.state&&d.state.key||"default")}function o(c,d){let p=c.document.querySelector("base"),m="";if(p&&p.getAttribute("href")){let g=c.location.href,_=g.indexOf("#");m=_===-1?g:g.slice(0,_)}return m+"#"+(typeof d=="string"?d:Dj(d))}function s(c,d){Vy(c.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(d)+")")}return _oe(n,o,s,e)}function Ui(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function Vy(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function Eoe(){return Math.random().toString(36).substr(2,8)}function V4(e,n){return{usr:e.state,key:e.key,idx:n}}function EI(e,n,o,s){return o===void 0&&(o=null),Am({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof n=="string"?zd(n):n,{state:o,key:n&&n.key||s||Eoe()})}function Dj(e){let{pathname:n="/",search:o="",hash:s=""}=e;return o&&o!=="?"&&(n+=o.charAt(0)==="?"?o:"?"+o),s&&s!=="#"&&(n+=s.charAt(0)==="#"?s:"#"+s),n}function zd(e){let n={};if(e){let o=e.indexOf("#");o>=0&&(n.hash=e.substr(o),e=e.substr(0,o));let s=e.indexOf("?");s>=0&&(n.search=e.substr(s),e=e.substr(0,s)),e&&(n.pathname=e)}return n}function _oe(e,n,o,s){s===void 0&&(s={});let{window:c=document.defaultView,v5Compat:d=!1}=s,p=c.history,m=mu.Pop,g=null,_=S();_==null&&(_=0,p.replaceState(Am({},p.state,{idx:_}),""));function S(){return(p.state||{idx:null}).idx}function T(){m=mu.Pop;let M=S(),x=M==null?null:M-_;_=M,g&&g({action:m,location:A.location,delta:x})}function R(M,x){m=mu.Push;let P=EI(A.location,M,x);o&&o(P,M),_=S()+1;let D=V4(P,_),F=A.createHref(P);try{p.pushState(D,"",F)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;c.location.assign(F)}d&&g&&g({action:m,location:A.location,delta:1})}function N(M,x){m=mu.Replace;let P=EI(A.location,M,x);o&&o(P,M),_=S();let D=V4(P,_),F=A.createHref(P);p.replaceState(D,"",F),d&&g&&g({action:m,location:A.location,delta:0})}function O(M){let x=c.location.origin!=="null"?c.location.origin:c.location.href,P=typeof M=="string"?M:Dj(M);return Ui(x,"No window.location.(origin|href) available to create URL for href: "+P),new URL(P,x)}let A={get action(){return m},get location(){return e(c,p)},listen(M){if(g)throw new Error("A history only accepts one active listener");return c.addEventListener(j4,T),g=M,()=>{c.removeEventListener(j4,T),g=null}},createHref(M){return n(c,M)},createURL:O,encodeLocation(M){let x=O(M);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:R,replace:N,go(M){return p.go(M)}};return A}var $4;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})($4||($4={}));function yoe(e,n,o){o===void 0&&(o="/");let s=typeof n=="string"?zd(n):n,c=Mj(s.pathname||"/",o);if(c==null)return null;let d=kj(e);Soe(d);let p=null;for(let m=0;p==null&&m<d.length;++m)p=xoe(d[m],Doe(c));return p}function kj(e,n,o,s){n===void 0&&(n=[]),o===void 0&&(o=[]),s===void 0&&(s="");let c=(d,p,m)=>{let g={relativePath:m===void 0?d.path||"":m,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};g.relativePath.startsWith("/")&&(Ui(g.relativePath.startsWith(s),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(s.length));let _=Nd([s,g.relativePath]),S=o.concat(g);d.children&&d.children.length>0&&(Ui(d.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+_+'".')),kj(d.children,n,S,_)),!(d.path==null&&!d.index)&&n.push({path:_,score:Aoe(_,d.index),routesMeta:S})};return e.forEach((d,p)=>{var m;if(d.path===""||!((m=d.path)!=null&&m.includes("?")))c(d,p);else for(let g of Lj(d.path))c(d,p,g)}),n}function Lj(e){let n=e.split("/");if(n.length===0)return[];let[o,...s]=n,c=o.endsWith("?"),d=o.replace(/\?$/,"");if(s.length===0)return c?[d,""]:[d];let p=Lj(s.join("/")),m=[];return m.push(...p.map(g=>g===""?d:[d,g].join("/"))),c&&m.push(...p),m.map(g=>e.startsWith("/")&&g===""?"/":g)}function Soe(e){e.sort((n,o)=>n.score!==o.score?o.score-n.score:Ooe(n.routesMeta.map(s=>s.childrenIndex),o.routesMeta.map(s=>s.childrenIndex)))}const Coe=/^:\w+$/,boe=3,Toe=2,Roe=1,woe=10,Ioe=-2,H4=e=>e==="*";function Aoe(e,n){let o=e.split("/"),s=o.length;return o.some(H4)&&(s+=Ioe),n&&(s+=Toe),o.filter(c=>!H4(c)).reduce((c,d)=>c+(Coe.test(d)?boe:d===""?Roe:woe),s)}function Ooe(e,n){return e.length===n.length&&e.slice(0,-1).every((s,c)=>s===n[c])?e[e.length-1]-n[n.length-1]:0}function xoe(e,n){let{routesMeta:o}=e,s={},c="/",d=[];for(let p=0;p<o.length;++p){let m=o[p],g=p===o.length-1,_=c==="/"?n:n.slice(c.length)||"/",S=Noe({path:m.relativePath,caseSensitive:m.caseSensitive,end:g},_);if(!S)return null;Object.assign(s,S.params);let T=m.route;d.push({params:s,pathname:Nd([c,S.pathname]),pathnameBase:Boe(Nd([c,S.pathnameBase])),route:T}),S.pathnameBase!=="/"&&(c=Nd([c,S.pathnameBase]))}return d}function Noe(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[o,s]=Poe(e.path,e.caseSensitive,e.end),c=n.match(o);if(!c)return null;let d=c[0],p=d.replace(/(.)\/+$/,"$1"),m=c.slice(1);return{params:s.reduce((_,S,T)=>{if(S==="*"){let R=m[T]||"";p=d.slice(0,d.length-R.length).replace(/(.)\/+$/,"$1")}return _[S]=koe(m[T]||"",S),_},{}),pathname:d,pathnameBase:p,pattern:e}}function Poe(e,n,o){n===void 0&&(n=!1),o===void 0&&(o=!0),Vy(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],c="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(p,m)=>(s.push(m),"/([^\\/]+)"));return e.endsWith("*")?(s.push("*"),c+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):o?c+="\\/*$":e!==""&&e!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,n?void 0:"i"),s]}function Doe(e){try{return decodeURI(e)}catch(n){return Vy(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+n+").")),e}}function koe(e,n){try{return decodeURIComponent(e)}catch(o){return Vy(!1,'The value for the URL param "'+n+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+o+").")),e}}function Mj(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let o=n.endsWith("/")?n.length-1:n.length,s=e.charAt(o);return s&&s!=="/"?null:e.slice(o)||"/"}function Loe(e,n){n===void 0&&(n="/");let{pathname:o,search:s="",hash:c=""}=typeof e=="string"?zd(e):e;return{pathname:o?o.startsWith("/")?o:Moe(o,n):n,search:joe(s),hash:Voe(c)}}function Moe(e,n){let o=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(c=>{c===".."?o.length>1&&o.pop():c!=="."&&o.push(c)}),o.length>1?o.join("/"):"/"}function JR(e,n,o,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+n+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+o+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Foe(e){return e.filter((n,o)=>o===0||n.route.path&&n.route.path.length>0)}function Uoe(e,n,o,s){s===void 0&&(s=!1);let c;typeof e=="string"?c=zd(e):(c=Am({},e),Ui(!c.pathname||!c.pathname.includes("?"),JR("?","pathname","search",c)),Ui(!c.pathname||!c.pathname.includes("#"),JR("#","pathname","hash",c)),Ui(!c.search||!c.search.includes("#"),JR("#","search","hash",c)));let d=e===""||c.pathname==="",p=d?"/":c.pathname,m;if(s||p==null)m=o;else{let T=n.length-1;if(p.startsWith("..")){let R=p.split("/");for(;R[0]==="..";)R.shift(),T-=1;c.pathname=R.join("/")}m=T>=0?n[T]:"/"}let g=Loe(c,m),_=p&&p!=="/"&&p.endsWith("/"),S=(d||p===".")&&o.endsWith("/");return!g.pathname.endsWith("/")&&(_||S)&&(g.pathname+="/"),g}const Nd=e=>e.join("/").replace(/\/\/+/g,"/"),Boe=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),joe=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Voe=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function $oe(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Fj=["post","put","patch","delete"];new Set(Fj);const Hoe=["get",...Fj];new Set(Hoe);/**
 * React Router v6.16.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function q_(){return q_=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},q_.apply(this,arguments)}const yO=b.createContext(null),Woe=b.createContext(null),$y=b.createContext(null),Hy=b.createContext(null),Zp=b.createContext({outlet:null,matches:[],isDataRoute:!1}),Uj=b.createContext(null);function Wy(){return b.useContext(Hy)!=null}function Bj(){return Wy()||Ui(!1),b.useContext(Hy).location}function jj(e){b.useContext($y).static||b.useLayoutEffect(e)}function zoe(){let{isDataRoute:e}=b.useContext(Zp);return e?iae():Goe()}function Goe(){Wy()||Ui(!1);let e=b.useContext(yO),{basename:n,navigator:o}=b.useContext($y),{matches:s}=b.useContext(Zp),{pathname:c}=Bj(),d=JSON.stringify(Foe(s).map(g=>g.pathnameBase)),p=b.useRef(!1);return jj(()=>{p.current=!0}),b.useCallback(function(g,_){if(_===void 0&&(_={}),!p.current)return;if(typeof g=="number"){o.go(g);return}let S=Uoe(g,JSON.parse(d),c,_.relative==="path");e==null&&n!=="/"&&(S.pathname=S.pathname==="/"?n:Nd([n,S.pathname])),(_.replace?o.replace:o.push)(S,_.state,_)},[n,o,d,c,e])}function Koe(e,n){return qoe(e,n)}function qoe(e,n,o){Wy()||Ui(!1);let{navigator:s}=b.useContext($y),{matches:c}=b.useContext(Zp),d=c[c.length-1],p=d?d.params:{};d&&d.pathname;let m=d?d.pathnameBase:"/";d&&d.route;let g=Bj(),_;if(n){var S;let A=typeof n=="string"?zd(n):n;m==="/"||(S=A.pathname)!=null&&S.startsWith(m)||Ui(!1),_=A}else _=g;let T=_.pathname||"/",R=m==="/"?T:T.slice(m.length)||"/",N=yoe(e,{pathname:R}),O=Zoe(N&&N.map(A=>Object.assign({},A,{params:Object.assign({},p,A.params),pathname:Nd([m,s.encodeLocation?s.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?m:Nd([m,s.encodeLocation?s.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),c,o);return n&&O?b.createElement(Hy.Provider,{value:{location:q_({pathname:"/",search:"",hash:"",state:null,key:"default"},_),navigationType:mu.Pop}},O):O}function Yoe(){let e=rae(),n=$oe(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),o=e instanceof Error?e.stack:null,c={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},d=null;return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},n),o?b.createElement("pre",{style:c},o):null,d)}const Xoe=b.createElement(Yoe,null);class Joe extends b.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,o){return o.location!==n.location||o.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error||o.error,location:o.location,revalidation:n.revalidation||o.revalidation}}componentDidCatch(n,o){console.error("React Router caught the following error during render",n,o)}render(){return this.state.error?b.createElement(Zp.Provider,{value:this.props.routeContext},b.createElement(Uj.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Qoe(e){let{routeContext:n,match:o,children:s}=e,c=b.useContext(yO);return c&&c.static&&c.staticContext&&(o.route.errorElement||o.route.ErrorBoundary)&&(c.staticContext._deepestRenderedBoundaryId=o.route.id),b.createElement(Zp.Provider,{value:n},s)}function Zoe(e,n,o){var s;if(n===void 0&&(n=[]),o===void 0&&(o=null),e==null){var c;if((c=o)!=null&&c.errors)e=o.matches;else return null}let d=e,p=(s=o)==null?void 0:s.errors;if(p!=null){let m=d.findIndex(g=>g.route.id&&(p==null?void 0:p[g.route.id]));m>=0||Ui(!1),d=d.slice(0,Math.min(d.length,m+1))}return d.reduceRight((m,g,_)=>{let S=g.route.id?p==null?void 0:p[g.route.id]:null,T=null;o&&(T=g.route.errorElement||Xoe);let R=n.concat(d.slice(0,_+1)),N=()=>{let O;return S?O=T:g.route.Component?O=b.createElement(g.route.Component,null):g.route.element?O=g.route.element:O=m,b.createElement(Qoe,{match:g,routeContext:{outlet:m,matches:R,isDataRoute:o!=null},children:O})};return o&&(g.route.ErrorBoundary||g.route.errorElement||_===0)?b.createElement(Joe,{location:o.location,revalidation:o.revalidation,component:T,error:S,children:N(),routeContext:{outlet:null,matches:R,isDataRoute:!0}}):N()},null)}var Vj=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Vj||{}),Y_=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Y_||{});function eae(e){let n=b.useContext(yO);return n||Ui(!1),n}function tae(e){let n=b.useContext(Woe);return n||Ui(!1),n}function nae(e){let n=b.useContext(Zp);return n||Ui(!1),n}function $j(e){let n=nae(),o=n.matches[n.matches.length-1];return o.route.id||Ui(!1),o.route.id}function rae(){var e;let n=b.useContext(Uj),o=tae(Y_.UseRouteError),s=$j(Y_.UseRouteError);return n||((e=o.errors)==null?void 0:e[s])}function iae(){let{router:e}=eae(Vj.UseNavigateStable),n=$j(Y_.UseNavigateStable),o=b.useRef(!1);return jj(()=>{o.current=!0}),b.useCallback(function(c,d){d===void 0&&(d={}),o.current&&(typeof c=="number"?e.navigate(c):e.navigate(c,q_({fromRouteId:n},d)))},[e,n])}function yd(e){Ui(!1)}function oae(e){let{basename:n="/",children:o=null,location:s,navigationType:c=mu.Pop,navigator:d,static:p=!1}=e;Wy()&&Ui(!1);let m=n.replace(/^\/*/,"/"),g=b.useMemo(()=>({basename:m,navigator:d,static:p}),[m,d,p]);typeof s=="string"&&(s=zd(s));let{pathname:_="/",search:S="",hash:T="",state:R=null,key:N="default"}=s,O=b.useMemo(()=>{let A=Mj(_,m);return A==null?null:{location:{pathname:A,search:S,hash:T,state:R,key:N},navigationType:c}},[m,_,S,T,R,N,c]);return O==null?null:b.createElement($y.Provider,{value:g},b.createElement(Hy.Provider,{children:o,value:O}))}function aae(e){let{children:n,location:o}=e;return Koe(_I(n),o)}new Promise(()=>{});function _I(e,n){n===void 0&&(n=[]);let o=[];return b.Children.forEach(e,(s,c)=>{if(!b.isValidElement(s))return;let d=[...n,c];if(s.type===b.Fragment){o.push.apply(o,_I(s.props.children,d));return}s.type!==yd&&Ui(!1),!s.props.index||!s.props.children||Ui(!1);let p={id:s.props.id||d.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(p.children=_I(s.props.children,d)),o.push(p)}),o}/**
 * React Router DOM v6.16.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const sae="startTransition",W4=Md[sae];function cae(e){let{basename:n,children:o,future:s,window:c}=e,d=b.useRef();d.current==null&&(d.current=voe({window:c,v5Compat:!0}));let p=d.current,[m,g]=b.useState({action:p.action,location:p.location}),{v7_startTransition:_}=s||{},S=b.useCallback(T=>{_&&W4?W4(()=>g(T)):g(T)},[g,_]);return b.useLayoutEffect(()=>p.listen(S),[p,S]),b.createElement(oae,{basename:n,children:o,location:m.location,navigationType:m.action,navigator:p})}var z4;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(z4||(z4={}));var G4;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(G4||(G4={}));function bs(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function jn(e){"@babel/helpers - typeof";return jn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},jn(e)}function lae(e,n){if(jn(e)!=="object"||e===null)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var s=o.call(e,n||"default");if(jn(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Hj(e){var n=lae(e,"string");return jn(n)==="symbol"?n:String(n)}function K4(e,n){for(var o=0;o<n.length;o++){var s=n[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,Hj(s.key),s)}}function Ts(e,n,o){return n&&K4(e.prototype,n),o&&K4(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function yI(e,n){return yI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,c){return s.__proto__=c,s},yI(e,n)}function ef(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&yI(e,n)}function X_(e){return X_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},X_(e)}function uae(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function J_(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dae(e,n){if(n&&(jn(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return J_(e)}function tf(e){var n=uae();return function(){var s=X_(e),c;if(n){var d=X_(this).constructor;c=Reflect.construct(s,arguments,d)}else c=s.apply(this,arguments);return dae(this,c)}}var Wj={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var n={}.hasOwnProperty;function o(){for(var s=[],c=0;c<arguments.length;c++){var d=arguments[c];if(d){var p=typeof d;if(p==="string"||p==="number")s.push(d);else if(Array.isArray(d)){if(d.length){var m=o.apply(null,d);m&&s.push(m)}}else if(p==="object"){if(d.toString!==Object.prototype.toString&&!d.toString.toString().includes("[native code]")){s.push(d.toString());continue}for(var g in d)n.call(d,g)&&d[g]&&s.push(g)}}}return s.join(" ")}e.exports?(o.default=o,e.exports=o):window.classNames=o})()})(Wj);var hae=Wj.exports;const Ye=yl(hae);function Qe(){return Qe=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},Qe.apply(this,arguments)}var zj={exports:{}},rr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SO=Symbol.for("react.element"),CO=Symbol.for("react.portal"),zy=Symbol.for("react.fragment"),Gy=Symbol.for("react.strict_mode"),Ky=Symbol.for("react.profiler"),qy=Symbol.for("react.provider"),Yy=Symbol.for("react.context"),pae=Symbol.for("react.server_context"),Xy=Symbol.for("react.forward_ref"),Jy=Symbol.for("react.suspense"),Qy=Symbol.for("react.suspense_list"),Zy=Symbol.for("react.memo"),eS=Symbol.for("react.lazy"),fae=Symbol.for("react.offscreen"),Gj;Gj=Symbol.for("react.module.reference");function Rs(e){if(typeof e=="object"&&e!==null){var n=e.$$typeof;switch(n){case SO:switch(e=e.type,e){case zy:case Ky:case Gy:case Jy:case Qy:return e;default:switch(e=e&&e.$$typeof,e){case pae:case Yy:case Xy:case eS:case Zy:case qy:return e;default:return n}}case CO:return n}}}rr.ContextConsumer=Yy;rr.ContextProvider=qy;rr.Element=SO;rr.ForwardRef=Xy;rr.Fragment=zy;rr.Lazy=eS;rr.Memo=Zy;rr.Portal=CO;rr.Profiler=Ky;rr.StrictMode=Gy;rr.Suspense=Jy;rr.SuspenseList=Qy;rr.isAsyncMode=function(){return!1};rr.isConcurrentMode=function(){return!1};rr.isContextConsumer=function(e){return Rs(e)===Yy};rr.isContextProvider=function(e){return Rs(e)===qy};rr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===SO};rr.isForwardRef=function(e){return Rs(e)===Xy};rr.isFragment=function(e){return Rs(e)===zy};rr.isLazy=function(e){return Rs(e)===eS};rr.isMemo=function(e){return Rs(e)===Zy};rr.isPortal=function(e){return Rs(e)===CO};rr.isProfiler=function(e){return Rs(e)===Ky};rr.isStrictMode=function(e){return Rs(e)===Gy};rr.isSuspense=function(e){return Rs(e)===Jy};rr.isSuspenseList=function(e){return Rs(e)===Qy};rr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===zy||e===Ky||e===Gy||e===Jy||e===Qy||e===fae||typeof e=="object"&&e!==null&&(e.$$typeof===eS||e.$$typeof===Zy||e.$$typeof===qy||e.$$typeof===Yy||e.$$typeof===Xy||e.$$typeof===Gj||e.getModuleId!==void 0)};rr.typeOf=Rs;zj.exports=rr;var Kj=zj.exports;function ml(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=[];return Et.Children.forEach(e,function(s){s==null&&!n.keepEmpty||(Array.isArray(s)?o=o.concat(ml(s)):Kj.isFragment(s)&&s.props?o=o.concat(ml(s.props.children,n)):o.push(s))}),o}var SI={},mae=function(n){};function gae(e,n){}function vae(e,n){}function Eae(){SI={}}function qj(e,n,o){!n&&!SI[o]&&(e(!1,o),SI[o]=!0)}function ma(e,n){qj(gae,e,n)}function _ae(e,n){qj(vae,e,n)}ma.preMessage=mae;ma.resetWarned=Eae;ma.noteOnce=_ae;function st(e,n,o){return n=Hj(n),n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function q4(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Ae(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?q4(Object(o),!0).forEach(function(s){st(e,s,o[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):q4(Object(o)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(o,s))})}return e}function Q_(e){return e instanceof HTMLElement||e instanceof SVGElement}function h_(e){return Q_(e)?e:e instanceof Et.Component?Pj.findDOMNode(e):null}function tS(e,n,o){var s=b.useRef({});return(!("value"in s.current)||o(s.current.condition,n))&&(s.current.value=e(),s.current.condition=n),s.current.value}function bO(e,n){typeof e=="function"?e(n):jn(e)==="object"&&e&&"current"in e&&(e.current=n)}function Uc(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];var s=n.filter(function(c){return c});return s.length<=1?s[0]:function(c){n.forEach(function(d){bO(d,c)})}}function nS(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return tS(function(){return Uc.apply(void 0,n)},n,function(s,c){return s.length!==c.length||s.every(function(d,p){return d!==c[p]})})}function nf(e){var n,o,s=Kj.isMemo(e)?e.type.type:e.type;return!(typeof s=="function"&&!((n=s.prototype)!==null&&n!==void 0&&n.render)||typeof e=="function"&&!((o=e.prototype)!==null&&o!==void 0&&o.render))}var CI=b.createContext(null);function yae(e){var n=e.children,o=e.onBatchResize,s=b.useRef(0),c=b.useRef([]),d=b.useContext(CI),p=b.useCallback(function(m,g,_){s.current+=1;var S=s.current;c.current.push({size:m,element:g,data:_}),Promise.resolve().then(function(){S===s.current&&(o==null||o(c.current),c.current=[])}),d==null||d(m,g,_)},[o,d]);return b.createElement(CI.Provider,{value:p},n)}var Yj=function(){if(typeof Map<"u")return Map;function e(n,o){var s=-1;return n.some(function(c,d){return c[0]===o?(s=d,!0):!1}),s}return function(){function n(){this.__entries__=[]}return Object.defineProperty(n.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),n.prototype.get=function(o){var s=e(this.__entries__,o),c=this.__entries__[s];return c&&c[1]},n.prototype.set=function(o,s){var c=e(this.__entries__,o);~c?this.__entries__[c][1]=s:this.__entries__.push([o,s])},n.prototype.delete=function(o){var s=this.__entries__,c=e(s,o);~c&&s.splice(c,1)},n.prototype.has=function(o){return!!~e(this.__entries__,o)},n.prototype.clear=function(){this.__entries__.splice(0)},n.prototype.forEach=function(o,s){s===void 0&&(s=null);for(var c=0,d=this.__entries__;c<d.length;c++){var p=d[c];o.call(s,p[1],p[0])}},n}()}(),bI=typeof window<"u"&&typeof document<"u"&&window.document===document,Z_=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),Sae=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Z_):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}(),Cae=2;function bae(e,n){var o=!1,s=!1,c=0;function d(){o&&(o=!1,e()),s&&m()}function p(){Sae(d)}function m(){var g=Date.now();if(o){if(g-c<Cae)return;s=!0}else o=!0,s=!1,setTimeout(p,n);c=g}return m}var Tae=20,Rae=["top","right","bottom","left","width","height","size","weight"],wae=typeof MutationObserver<"u",Iae=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=bae(this.refresh.bind(this),Tae)}return e.prototype.addObserver=function(n){~this.observers_.indexOf(n)||this.observers_.push(n),this.connected_||this.connect_()},e.prototype.removeObserver=function(n){var o=this.observers_,s=o.indexOf(n);~s&&o.splice(s,1),!o.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){var n=this.updateObservers_();n&&this.refresh()},e.prototype.updateObservers_=function(){var n=this.observers_.filter(function(o){return o.gatherActive(),o.hasActive()});return n.forEach(function(o){return o.broadcastActive()}),n.length>0},e.prototype.connect_=function(){!bI||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),wae?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!bI||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(n){var o=n.propertyName,s=o===void 0?"":o,c=Rae.some(function(d){return!!~s.indexOf(d)});c&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),Xj=function(e,n){for(var o=0,s=Object.keys(n);o<s.length;o++){var c=s[o];Object.defineProperty(e,c,{value:n[c],enumerable:!1,writable:!1,configurable:!0})}return e},zp=function(e){var n=e&&e.ownerDocument&&e.ownerDocument.defaultView;return n||Z_},Jj=rS(0,0,0,0);function ey(e){return parseFloat(e)||0}function Y4(e){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return n.reduce(function(s,c){var d=e["border-"+c+"-width"];return s+ey(d)},0)}function Aae(e){for(var n=["top","right","bottom","left"],o={},s=0,c=n;s<c.length;s++){var d=c[s],p=e["padding-"+d];o[d]=ey(p)}return o}function Oae(e){var n=e.getBBox();return rS(0,0,n.width,n.height)}function xae(e){var n=e.clientWidth,o=e.clientHeight;if(!n&&!o)return Jj;var s=zp(e).getComputedStyle(e),c=Aae(s),d=c.left+c.right,p=c.top+c.bottom,m=ey(s.width),g=ey(s.height);if(s.boxSizing==="border-box"&&(Math.round(m+d)!==n&&(m-=Y4(s,"left","right")+d),Math.round(g+p)!==o&&(g-=Y4(s,"top","bottom")+p)),!Pae(e)){var _=Math.round(m+d)-n,S=Math.round(g+p)-o;Math.abs(_)!==1&&(m-=_),Math.abs(S)!==1&&(g-=S)}return rS(c.left,c.top,m,g)}var Nae=function(){return typeof SVGGraphicsElement<"u"?function(e){return e instanceof zp(e).SVGGraphicsElement}:function(e){return e instanceof zp(e).SVGElement&&typeof e.getBBox=="function"}}();function Pae(e){return e===zp(e).document.documentElement}function Dae(e){return bI?Nae(e)?Oae(e):xae(e):Jj}function kae(e){var n=e.x,o=e.y,s=e.width,c=e.height,d=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,p=Object.create(d.prototype);return Xj(p,{x:n,y:o,width:s,height:c,top:o,right:n+s,bottom:c+o,left:n}),p}function rS(e,n,o,s){return{x:e,y:n,width:o,height:s}}var Lae=function(){function e(n){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=rS(0,0,0,0),this.target=n}return e.prototype.isActive=function(){var n=Dae(this.target);return this.contentRect_=n,n.width!==this.broadcastWidth||n.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var n=this.contentRect_;return this.broadcastWidth=n.width,this.broadcastHeight=n.height,n},e}(),Mae=function(){function e(n,o){var s=kae(o);Xj(this,{target:n,contentRect:s})}return e}(),Fae=function(){function e(n,o,s){if(this.activeObservations_=[],this.observations_=new Yj,typeof n!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=n,this.controller_=o,this.callbackCtx_=s}return e.prototype.observe=function(n){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(n instanceof zp(n).Element))throw new TypeError('parameter 1 is not of type "Element".');var o=this.observations_;o.has(n)||(o.set(n,new Lae(n)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(n){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(n instanceof zp(n).Element))throw new TypeError('parameter 1 is not of type "Element".');var o=this.observations_;o.has(n)&&(o.delete(n),o.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var n=this;this.clearActive(),this.observations_.forEach(function(o){o.isActive()&&n.activeObservations_.push(o)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var n=this.callbackCtx_,o=this.activeObservations_.map(function(s){return new Mae(s.target,s.broadcastRect())});this.callback_.call(n,o,n),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),Qj=typeof WeakMap<"u"?new WeakMap:new Yj,Zj=function(){function e(n){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var o=Iae.getInstance(),s=new Fae(n,o,this);Qj.set(this,s)}return e}();["observe","unobserve","disconnect"].forEach(function(e){Zj.prototype[e]=function(){var n;return(n=Qj.get(this))[e].apply(n,arguments)}});var Uae=function(){return typeof Z_.ResizeObserver<"u"?Z_.ResizeObserver:Zj}(),gu=new Map;function Bae(e){e.forEach(function(n){var o,s=n.target;(o=gu.get(s))===null||o===void 0||o.forEach(function(c){return c(s)})})}var eV=new Uae(Bae);function jae(e,n){gu.has(e)||(gu.set(e,new Set),eV.observe(e)),gu.get(e).add(n)}function Vae(e,n){gu.has(e)&&(gu.get(e).delete(n),gu.get(e).size||(eV.unobserve(e),gu.delete(e)))}var $ae=function(e){ef(o,e);var n=tf(o);function o(){return bs(this,o),n.apply(this,arguments)}return Ts(o,[{key:"render",value:function(){return this.props.children}}]),o}(b.Component);function Hae(e,n){var o=e.children,s=e.disabled,c=b.useRef(null),d=b.useRef(null),p=b.useContext(CI),m=typeof o=="function",g=m?o(c):o,_=b.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),S=!m&&b.isValidElement(g)&&nf(g),T=S?g.ref:null,R=nS(T,c),N=function(){var x;return h_(c.current)||(c.current&&jn(c.current)==="object"?h_((x=c.current)===null||x===void 0?void 0:x.nativeElement):null)||h_(d.current)};b.useImperativeHandle(n,function(){return N()});var O=b.useRef(e);O.current=e;var A=b.useCallback(function(M){var x=O.current,P=x.onResize,D=x.data,F=M.getBoundingClientRect(),j=F.width,B=F.height,H=M.offsetWidth,K=M.offsetHeight,J=Math.floor(j),q=Math.floor(B);if(_.current.width!==J||_.current.height!==q||_.current.offsetWidth!==H||_.current.offsetHeight!==K){var Q={width:J,height:q,offsetWidth:H,offsetHeight:K};_.current=Q;var ee=H===Math.round(j)?j:H,ne=K===Math.round(B)?B:K,he=Ae(Ae({},Q),{},{offsetWidth:ee,offsetHeight:ne});p==null||p(he,M,D),P&&Promise.resolve().then(function(){P(he,M)})}},[]);return b.useEffect(function(){var M=N();return M&&!s&&jae(M,A),function(){return Vae(M,A)}},[c.current,s]),b.createElement($ae,{ref:d},S?b.cloneElement(g,{ref:R}):g)}var Wae=b.forwardRef(Hae),zae="rc-observer-key";function Gae(e,n){var o=e.children,s=typeof o=="function"?[o]:ml(o);return s.map(function(c,d){var p=(c==null?void 0:c.key)||"".concat(zae,"-").concat(d);return b.createElement(Wae,Qe({},e,{key:p,ref:d===0?n:void 0}),c)})}var Gd=b.forwardRef(Gae);Gd.Collection=yae;function Ea(e,n){var o=Ae({},e);return Array.isArray(n)&&n.forEach(function(s){delete o[s]}),o}function TI(e,n){(n==null||n>e.length)&&(n=e.length);for(var o=0,s=new Array(n);o<n;o++)s[o]=e[o];return s}function Kae(e){if(Array.isArray(e))return TI(e)}function tV(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function TO(e,n){if(e){if(typeof e=="string")return TI(e,n);var o=Object.prototype.toString.call(e).slice(8,-1);if(o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set")return Array.from(e);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return TI(e,n)}}function qae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ot(e){return Kae(e)||tV(e)||TO(e)||qae()}var nV=function(n){return+setTimeout(n,16)},rV=function(n){return clearTimeout(n)};typeof window<"u"&&"requestAnimationFrame"in window&&(nV=function(n){return window.requestAnimationFrame(n)},rV=function(n){return window.cancelAnimationFrame(n)});var X4=0,RO=new Map;function iV(e){RO.delete(e)}var ao=function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;X4+=1;var s=X4;function c(d){if(d===0)iV(s),n();else{var p=nV(function(){c(d-1)});RO.set(s,p)}}return c(o),s};ao.cancel=function(e){var n=RO.get(e);return iV(n),rV(n)};function wO(e){for(var n=0,o,s=0,c=e.length;c>=4;++s,c-=4)o=e.charCodeAt(s)&255|(e.charCodeAt(++s)&255)<<8|(e.charCodeAt(++s)&255)<<16|(e.charCodeAt(++s)&255)<<24,o=(o&65535)*1540483477+((o>>>16)*59797<<16),o^=o>>>24,n=(o&65535)*1540483477+((o>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(c){case 3:n^=(e.charCodeAt(s+2)&255)<<16;case 2:n^=(e.charCodeAt(s+1)&255)<<8;case 1:n^=e.charCodeAt(s)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}function Yae(e,n){if(e==null)return{};var o={},s=Object.keys(e),c,d;for(d=0;d<s.length;d++)c=s[d],!(n.indexOf(c)>=0)&&(o[c]=e[c]);return o}function xn(e,n){if(e==null)return{};var o=Yae(e,n),s,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)s=d[c],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(o[s]=e[s])}return o}function iS(e,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=new Set;function c(d,p){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,g=s.has(d);if(ma(!g,"Warning: There may be circular references"),g)return!1;if(d===p)return!0;if(o&&m>1)return!1;s.add(d);var _=m+1;if(Array.isArray(d)){if(!Array.isArray(p)||d.length!==p.length)return!1;for(var S=0;S<d.length;S++)if(!c(d[S],p[S],_))return!1;return!0}if(d&&p&&jn(d)==="object"&&jn(p)==="object"){var T=Object.keys(d);return T.length!==Object.keys(p).length?!1:T.every(function(R){return c(d[R],p[R],_)})}return!1}return c(e,n)}var J4="%",Xae=function(){function e(n){bs(this,e),st(this,"instanceId",void 0),st(this,"cache",new Map),this.instanceId=n}return Ts(e,[{key:"get",value:function(o){return this.cache.get(o.join(J4))||null}},{key:"update",value:function(o,s){var c=o.join(J4),d=this.cache.get(c),p=s(d);p===null?this.cache.delete(c):this.cache.set(c,p)}}]),e}(),RI="data-token-hash",Pd="data-css-hash",Ip="__cssinjs_instance__";function Jae(){var e=Math.random().toString(12).slice(2);if(typeof document<"u"&&document.head&&document.body){var n=document.body.querySelectorAll("style[".concat(Pd,"]"))||[],o=document.head.firstChild;Array.from(n).forEach(function(c){c[Ip]=c[Ip]||e,c[Ip]===e&&document.head.insertBefore(c,o)});var s={};Array.from(document.querySelectorAll("style[".concat(Pd,"]"))).forEach(function(c){var d=c.getAttribute(Pd);if(s[d]){if(c[Ip]===e){var p;(p=c.parentNode)===null||p===void 0||p.removeChild(c)}}else s[d]=!0})}return new Xae(e)}var Qae=b.createContext({hashPriority:"low",cache:Jae(),defaultCache:!0});const IO=Qae;function xo(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function Zae(e,n){if(!e)return!1;if(e.contains)return e.contains(n);for(var o=n;o;){if(o===e)return!0;o=o.parentNode}return!1}var Q4="data-rc-order",Z4="data-rc-priority",ese="rc-util-key",wI=new Map;function oV(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.mark;return n?n.startsWith("data-")?n:"data-".concat(n):ese}function oS(e){if(e.attachTo)return e.attachTo;var n=document.querySelector("head");return n||document.body}function tse(e){return e==="queue"?"prependQueue":e?"prepend":"append"}function aV(e){return Array.from((wI.get(e)||e).children).filter(function(n){return n.tagName==="STYLE"})}function sV(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!xo())return null;var o=n.csp,s=n.prepend,c=n.priority,d=c===void 0?0:c,p=tse(s),m=p==="prependQueue",g=document.createElement("style");g.setAttribute(Q4,p),m&&d&&g.setAttribute(Z4,"".concat(d)),o!=null&&o.nonce&&(g.nonce=o==null?void 0:o.nonce),g.innerHTML=e;var _=oS(n),S=_.firstChild;if(s){if(m){var T=aV(_).filter(function(R){if(!["prepend","prependQueue"].includes(R.getAttribute(Q4)))return!1;var N=Number(R.getAttribute(Z4)||0);return d>=N});if(T.length)return _.insertBefore(g,T[T.length-1].nextSibling),g}_.insertBefore(g,S)}else _.appendChild(g);return g}function cV(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=oS(n);return aV(o).find(function(s){return s.getAttribute(oV(n))===e})}function ty(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=cV(e,n);if(o){var s=oS(n);s.removeChild(o)}}function nse(e,n){var o=wI.get(e);if(!o||!Zae(document,o)){var s=sV("",n),c=s.parentNode;wI.set(e,c),e.removeChild(s)}}function Om(e,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=oS(o);nse(s,o);var c=cV(n,o);if(c){var d,p;if((d=o.csp)!==null&&d!==void 0&&d.nonce&&c.nonce!==((p=o.csp)===null||p===void 0?void 0:p.nonce)){var m;c.nonce=(m=o.csp)===null||m===void 0?void 0:m.nonce}return c.innerHTML!==e&&(c.innerHTML=e),c}var g=sV(e,o);return g.setAttribute(oV(o),n),g}function lV(e){if(Array.isArray(e))return e}function rse(e,n){var o=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(o!=null){var s,c,d,p,m=[],g=!0,_=!1;try{if(d=(o=o.call(e)).next,n===0){if(Object(o)!==o)return;g=!1}else for(;!(g=(s=d.call(o)).done)&&(m.push(s.value),m.length!==n);g=!0);}catch(S){_=!0,c=S}finally{try{if(!g&&o.return!=null&&(p=o.return(),Object(p)!==p))return}finally{if(_)throw c}}return m}}function uV(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function We(e,n){return lV(e)||rse(e,n)||TO(e,n)||uV()}function ise(e,n){if(e.length!==n.length)return!1;for(var o=0;o<e.length;o++)if(e[o]!==n[o])return!1;return!0}var AO=function(){function e(){bs(this,e),st(this,"cache",void 0),st(this,"keys",void 0),st(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return Ts(e,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(o){var s,c,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,p={map:this.cache};return o.forEach(function(m){if(!p)p=void 0;else{var g,_;p=(g=p)===null||g===void 0||(_=g.map)===null||_===void 0?void 0:_.get(m)}}),(s=p)!==null&&s!==void 0&&s.value&&d&&(p.value[1]=this.cacheCallTimes++),(c=p)===null||c===void 0?void 0:c.value}},{key:"get",value:function(o){var s;return(s=this.internalGet(o,!0))===null||s===void 0?void 0:s[0]}},{key:"has",value:function(o){return!!this.internalGet(o)}},{key:"set",value:function(o,s){var c=this;if(!this.has(o)){if(this.size()+1>e.MAX_CACHE_SIZE+e.MAX_CACHE_OFFSET){var d=this.keys.reduce(function(_,S){var T=We(_,2),R=T[1];return c.internalGet(S)[1]<R?[S,c.internalGet(S)[1]]:_},[this.keys[0],this.cacheCallTimes]),p=We(d,1),m=p[0];this.delete(m)}this.keys.push(o)}var g=this.cache;o.forEach(function(_,S){if(S===o.length-1)g.set(_,{value:[s,c.cacheCallTimes++]});else{var T=g.get(_);T?T.map||(T.map=new Map):g.set(_,{map:new Map}),g=g.get(_).map}})}},{key:"deleteByPath",value:function(o,s){var c=o.get(s[0]);if(s.length===1){var d;return c.map?o.set(s[0],{map:c.map}):o.delete(s[0]),(d=c.value)===null||d===void 0?void 0:d[0]}var p=this.deleteByPath(c.map,s.slice(1));return(!c.map||c.map.size===0)&&!c.value&&o.delete(s[0]),p}},{key:"delete",value:function(o){if(this.has(o))return this.keys=this.keys.filter(function(s){return!ise(s,o)}),this.deleteByPath(this.cache,o)}}]),e}();st(AO,"MAX_CACHE_SIZE",20);st(AO,"MAX_CACHE_OFFSET",5);var e3=0,dV=function(){function e(n){bs(this,e),st(this,"derivatives",void 0),st(this,"id",void 0),this.derivatives=Array.isArray(n)?n:[n],this.id=e3,n.length===0&&(n.length>0,void 0),e3+=1}return Ts(e,[{key:"getDerivativeToken",value:function(o){return this.derivatives.reduce(function(s,c){return c(o,s)},void 0)}}]),e}(),QR=new AO;function ny(e){var n=Array.isArray(e)?e:[e];return QR.has(n)||QR.set(n,new dV(n)),QR.get(n)}var ose=new WeakMap,ZR={};function ase(e,n){for(var o=ose,s=0;s<n.length;s+=1){var c=n[s];o.has(c)||o.set(c,new WeakMap),o=o.get(c)}return o.has(ZR)||o.set(ZR,e()),o.get(ZR)}var t3=new WeakMap;function ry(e){var n=t3.get(e)||"";return n||(Object.keys(e).forEach(function(o){var s=e[o];n+=o,s instanceof dV?n+=s.id:s&&jn(s)==="object"?n+=ry(s):n+=s}),t3.set(e,n)),n}function sse(e,n){return wO("".concat(n,"_").concat(ry(e)))}var tm="random-".concat(Date.now(),"-").concat(Math.random()).replace(/\./g,""),hV="_bAmBoO_";function cse(e,n,o){if(xo()){var s,c;Om(e,tm);var d=document.createElement("div");d.style.position="fixed",d.style.left="0",d.style.top="0",n==null||n(d),document.body.appendChild(d);var p=o?o(d):(s=getComputedStyle(d).content)===null||s===void 0?void 0:s.includes(hV);return(c=d.parentNode)===null||c===void 0||c.removeChild(d),ty(tm),p}return!1}var e1=void 0;function lse(){return e1===void 0&&(e1=cse("@layer ".concat(tm," { .").concat(tm,' { content: "').concat(hV,'"!important; } }'),function(e){e.className=tm})),e1}var n3=xo()?b.useLayoutEffect:b.useEffect,qr=function(n,o){var s=b.useRef(!0);n3(function(){return n(s.current)},o),n3(function(){return s.current=!1,function(){s.current=!0}},[])},r3=function(n,o){qr(function(s){if(!s)return n()},o)},use=Ae({},Md),i3=use.useInsertionEffect,dse=function(n,o,s){b.useMemo(n,s),qr(function(){return o(!0)},s)},hse=i3?function(e,n,o){return i3(function(){return e(),n()},o)}:dse;const pse=hse;var fse=Ae({},Md),mse=fse.useInsertionEffect,gse=function(n){var o=[],s=!1;function c(d){s||o.push(d)}return b.useEffect(function(){return s=!1,function(){s=!0,o.length&&o.forEach(function(d){return d()})}},n),c},vse=function(){return function(n){n()}},Ese=typeof mse<"u"?gse:vse;const _se=Ese;function pV(e,n,o,s,c){var d=b.useContext(IO),p=d.cache,m=[e].concat(ot(n)),g=m.join("_"),_=_se([g]),S=function(O){p.update(m,function(A){var M=A||[],x=We(M,2),P=x[0],D=P===void 0?0:P,F=x[1],j=F,B=j||o(),H=[D,B];return O?O(H):H})};b.useMemo(function(){S()},[g]);var T=p.get(m),R=T[1];return pse(function(){c==null||c(R)},function(N){return S(function(O){var A=We(O,2),M=A[0],x=A[1];return N&&M===0&&(c==null||c(R)),[M+1,x]}),function(){p.update(m,function(O){var A=O||[],M=We(A,2),x=M[0],P=x===void 0?0:x,D=M[1],F=P-1;return F===0?(_(function(){return s==null?void 0:s(D,!1)}),null):[P-1,D]})}},[g]),R}var yse={},Sse="css",Cd=new Map;function Cse(e){Cd.set(e,(Cd.get(e)||0)+1)}function bse(e,n){if(typeof document<"u"){var o=document.querySelectorAll("style[".concat(RI,'="').concat(e,'"]'));o.forEach(function(s){if(s[Ip]===n){var c;(c=s.parentNode)===null||c===void 0||c.removeChild(s)}})}}var Tse=0;function Rse(e,n){Cd.set(e,(Cd.get(e)||0)-1);var o=Array.from(Cd.keys()),s=o.filter(function(c){var d=Cd.get(c)||0;return d<=0});o.length-s.length>Tse&&s.forEach(function(c){bse(c,n),Cd.delete(c)})}var fV=function(n,o,s,c){var d=s.getDerivativeToken(n),p=Ae(Ae({},d),o);return c&&(p=c(p)),p};function wse(e,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=b.useContext(IO),c=s.cache.instanceId,d=o.salt,p=d===void 0?"":d,m=o.override,g=m===void 0?yse:m,_=o.formatToken,S=o.getComputedToken,T=ase(function(){return Object.assign.apply(Object,[{}].concat(ot(n)))},n),R=ry(T),N=ry(g),O=pV("token",[p,e.id,R,N],function(){var A=S?S(T,g,e):fV(T,g,e,_),M=sse(A,p);A._tokenKey=M,Cse(M);var x="".concat(Sse,"-").concat(wO(M));return A._hashId=x,[A,x]},function(A){Rse(A[0]._tokenKey,c)});return O}var Ise={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},mV="comm",gV="rule",vV="decl",Ase="@import",Ose="@keyframes",xse="@layer",Nse=Math.abs,OO=String.fromCharCode;function EV(e){return e.trim()}function p_(e,n,o){return e.replace(n,o)}function Pse(e,n){return e.indexOf(n)}function xm(e,n){return e.charCodeAt(n)|0}function Nm(e,n,o){return e.slice(n,o)}function il(e){return e.length}function Dse(e){return e.length}function xE(e,n){return n.push(e),e}var aS=1,Gp=1,_V=0,Cs=0,wi=0,rf="";function xO(e,n,o,s,c,d,p,m){return{value:e,root:n,parent:o,type:s,props:c,children:d,line:aS,column:Gp,length:p,return:"",siblings:m}}function kse(){return wi}function Lse(){return wi=Cs>0?xm(rf,--Cs):0,Gp--,wi===10&&(Gp=1,aS--),wi}function Qs(){return wi=Cs<_V?xm(rf,Cs++):0,Gp++,wi===10&&(Gp=1,aS++),wi}function Dd(){return xm(rf,Cs)}function f_(){return Cs}function sS(e,n){return Nm(rf,e,n)}function II(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Mse(e){return aS=Gp=1,_V=il(rf=e),Cs=0,[]}function Fse(e){return rf="",e}function t1(e){return EV(sS(Cs-1,AI(e===91?e+2:e===40?e+1:e)))}function Use(e){for(;(wi=Dd())&&wi<33;)Qs();return II(e)>2||II(wi)>3?"":" "}function Bse(e,n){for(;--n&&Qs()&&!(wi<48||wi>102||wi>57&&wi<65||wi>70&&wi<97););return sS(e,f_()+(n<6&&Dd()==32&&Qs()==32))}function AI(e){for(;Qs();)switch(wi){case e:return Cs;case 34:case 39:e!==34&&e!==39&&AI(wi);break;case 40:e===41&&AI(e);break;case 92:Qs();break}return Cs}function jse(e,n){for(;Qs()&&e+wi!==47+10;)if(e+wi===42+42&&Dd()===47)break;return"/*"+sS(n,Cs-1)+"*"+OO(e===47?e:Qs())}function Vse(e){for(;!II(Dd());)Qs();return sS(e,Cs)}function $se(e){return Fse(m_("",null,null,null,[""],e=Mse(e),0,[0],e))}function m_(e,n,o,s,c,d,p,m,g){for(var _=0,S=0,T=p,R=0,N=0,O=0,A=1,M=1,x=1,P=0,D="",F=c,j=d,B=s,H=D;M;)switch(O=P,P=Qs()){case 40:if(O!=108&&xm(H,T-1)==58){Pse(H+=p_(t1(P),"&","&\f"),"&\f")!=-1&&(x=-1);break}case 34:case 39:case 91:H+=t1(P);break;case 9:case 10:case 13:case 32:H+=Use(O);break;case 92:H+=Bse(f_()-1,7);continue;case 47:switch(Dd()){case 42:case 47:xE(Hse(jse(Qs(),f_()),n,o,g),g);break;default:H+="/"}break;case 123*A:m[_++]=il(H)*x;case 125*A:case 59:case 0:switch(P){case 0:case 125:M=0;case 59+S:x==-1&&(H=p_(H,/\f/g,"")),N>0&&il(H)-T&&xE(N>32?a3(H+";",s,o,T-1,g):a3(p_(H," ","")+";",s,o,T-2,g),g);break;case 59:H+=";";default:if(xE(B=o3(H,n,o,_,S,c,m,D,F=[],j=[],T,d),d),P===123)if(S===0)m_(H,n,B,B,F,d,T,m,j);else switch(R===99&&xm(H,3)===110?100:R){case 100:case 108:case 109:case 115:m_(e,B,B,s&&xE(o3(e,B,B,0,0,c,m,D,c,F=[],T,j),j),c,j,T,m,s?F:j);break;default:m_(H,B,B,B,[""],j,0,m,j)}}_=S=N=0,A=x=1,D=H="",T=p;break;case 58:T=1+il(H),N=O;default:if(A<1){if(P==123)--A;else if(P==125&&A++==0&&Lse()==125)continue}switch(H+=OO(P),P*A){case 38:x=S>0?1:(H+="\f",-1);break;case 44:m[_++]=(il(H)-1)*x,x=1;break;case 64:Dd()===45&&(H+=t1(Qs())),R=Dd(),S=T=il(D=H+=Vse(f_())),P++;break;case 45:O===45&&il(H)==2&&(A=0)}}return d}function o3(e,n,o,s,c,d,p,m,g,_,S,T){for(var R=c-1,N=c===0?d:[""],O=Dse(N),A=0,M=0,x=0;A<s;++A)for(var P=0,D=Nm(e,R+1,R=Nse(M=p[A])),F=e;P<O;++P)(F=EV(M>0?N[P]+" "+D:p_(D,/&\f/g,N[P])))&&(g[x++]=F);return xO(e,n,o,c===0?gV:m,g,_,S,T)}function Hse(e,n,o,s){return xO(e,n,o,mV,OO(kse()),Nm(e,2,-2),0,s)}function a3(e,n,o,s,c){return xO(e,n,o,vV,Nm(e,0,s),Nm(e,s+1,-1),s,c)}function OI(e,n){for(var o="",s=0;s<e.length;s++)o+=n(e[s],s,e,n)||"";return o}function Wse(e,n,o,s){switch(e.type){case xse:if(e.children.length)break;case Ase:case vV:return e.return=e.return||e.value;case mV:return"";case Ose:return e.return=e.value+"{"+OI(e.children,s)+"}";case gV:if(!il(e.value=e.props.join(",")))return""}return il(o=OI(e.children,s))?e.return=e.value+"{"+o+"}":""}var s3="data-ant-cssinjs-cache-path",yV="_FILE_STYLE__",kd,SV=!0;function zse(){if(!kd&&(kd={},xo())){var e=document.createElement("div");e.className=s3,e.style.position="fixed",e.style.visibility="hidden",e.style.top="-9999px",document.body.appendChild(e);var n=getComputedStyle(e).content||"";n=n.replace(/^"/,"").replace(/"$/,""),n.split(";").forEach(function(c){var d=c.split(":"),p=We(d,2),m=p[0],g=p[1];kd[m]=g});var o=document.querySelector("style[".concat(s3,"]"));if(o){var s;SV=!1,(s=o.parentNode)===null||s===void 0||s.removeChild(o)}document.body.removeChild(e)}}function Gse(e){return zse(),!!kd[e]}function Kse(e){var n=kd[e],o=null;if(n&&xo())if(SV)o=yV;else{var s=document.querySelector("style[".concat(Pd,'="').concat(kd[e],'"]'));s?o=s.innerHTML:delete kd[e]}return[o,n]}var c3=xo(),qse="_skip_check_",CV="_multi_value_";function l3(e){var n=OI($se(e),Wse);return n.replace(/\{%%%\:[^;];}/g,";")}function Yse(e){return jn(e)==="object"&&e&&(qse in e||CV in e)}function Xse(e,n,o){if(!n)return e;var s=".".concat(n),c=o==="low"?":where(".concat(s,")"):s,d=e.split(",").map(function(p){var m,g=p.trim().split(/\s+/),_=g[0]||"",S=((m=_.match(/^\w+/))===null||m===void 0?void 0:m[0])||"";return _="".concat(S).concat(c).concat(_.slice(S.length)),[_].concat(ot(g.slice(1))).join(" ")});return d.join(",")}var Jse=function e(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{root:!0,parentSelectors:[]},c=s.root,d=s.injectHash,p=s.parentSelectors,m=o.hashId,g=o.layer;o.path;var _=o.hashPriority,S=o.transformers,T=S===void 0?[]:S;o.linters;var R="",N={};function O(D){var F=D.getName(m);if(!N[F]){var j=e(D.style,o,{root:!1,parentSelectors:p}),B=We(j,1),H=B[0];N[F]="@keyframes ".concat(D.getName(m)).concat(H)}}function A(D){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return D.forEach(function(j){Array.isArray(j)?A(j,F):j&&F.push(j)}),F}var M=A(Array.isArray(n)?n:[n]);if(M.forEach(function(D){var F=typeof D=="string"&&!c?{}:D;if(typeof F=="string")R+="".concat(F,`
`);else if(F._keyframe)O(F);else{var j=T.reduce(function(B,H){var K;return(H==null||(K=H.visit)===null||K===void 0?void 0:K.call(H,B))||B},F);Object.keys(j).forEach(function(B){var H=j[B];if(jn(H)==="object"&&H&&(B!=="animationName"||!H._keyframe)&&!Yse(H)){var K=!1,J=B.trim(),q=!1;(c||d)&&m?J.startsWith("@")?K=!0:J=Xse(B,m,_):c&&!m&&(J==="&"||J==="")&&(J="",q=!0);var Q=e(H,o,{root:q,injectHash:K,parentSelectors:[].concat(ot(p),[J])}),ee=We(Q,2),ne=ee[0],he=ee[1];N=Ae(Ae({},N),he),R+="".concat(J).concat(ne)}else{let ae=function(Ee,ve){var le=Ee.replace(/[A-Z]/g,function(ye){return"-".concat(ye.toLowerCase())}),de=ve;!Ise[Ee]&&typeof de=="number"&&de!==0&&(de="".concat(de,"px")),Ee==="animationName"&&ve!==null&&ve!==void 0&&ve._keyframe&&(O(ve),de=ve.getName(m)),R+="".concat(le,":").concat(de,";")};var se=ae,pe,ce=(pe=H==null?void 0:H.value)!==null&&pe!==void 0?pe:H;jn(H)==="object"&&H!==null&&H!==void 0&&H[CV]&&Array.isArray(ce)?ce.forEach(function(Ee){ae(B,Ee)}):ae(B,ce)}})}}),!c)R="{".concat(R,"}");else if(g&&lse()){var x=g.split(","),P=x[x.length-1].trim();R="@layer ".concat(P," {").concat(R,"}"),x.length>1&&(R="@layer ".concat(g,"{%%%:%}").concat(R))}return[R,N]};function Qse(e,n){return wO("".concat(e.join("%")).concat(n))}function Zse(){return null}function xI(e,n){var o=e.token,s=e.path,c=e.hashId,d=e.layer,p=e.nonce,m=e.clientOnly,g=e.order,_=g===void 0?0:g,S=b.useContext(IO),T=S.autoClear;S.mock;var R=S.defaultCache,N=S.hashPriority,O=S.container,A=S.ssrInline,M=S.transformers,x=S.linters,P=S.cache,D=o._tokenKey,F=[D].concat(ot(s)),j=c3,B=pV("style",F,function(){var Q=F.join("|");if(Gse(Q)){var ee=Kse(Q),ne=We(ee,2),he=ne[0],pe=ne[1];if(he)return[he,D,pe,{},m,_]}var ce=n(),se=Jse(ce,{hashId:c,hashPriority:N,layer:d,path:s.join("-"),transformers:M,linters:x}),ae=We(se,2),Ee=ae[0],ve=ae[1],le=l3(Ee),de=Qse(F,le);return[le,D,de,ve,m,_]},function(Q,ee){var ne=We(Q,3),he=ne[2];(ee||T)&&c3&&ty(he,{mark:Pd})},function(Q){var ee=We(Q,4),ne=ee[0];ee[1];var he=ee[2],pe=ee[3];if(j&&ne!==yV){var ce={mark:Pd,prepend:"queue",attachTo:O,priority:_},se=typeof p=="function"?p():p;se&&(ce.csp={nonce:se});var ae=Om(ne,he,ce);ae[Ip]=P.instanceId,ae.setAttribute(RI,D),Object.keys(pe).forEach(function(Ee){Om(l3(pe[Ee]),"_effect-".concat(Ee),ce)})}}),H=We(B,3),K=H[0],J=H[1],q=H[2];return function(Q){var ee;if(!A||j||!R)ee=b.createElement(Zse,null);else{var ne;ee=b.createElement("style",Qe({},(ne={},st(ne,RI,J),st(ne,Pd,q),ne),{dangerouslySetInnerHTML:{__html:K}}))}return b.createElement(b.Fragment,null,ee,Q)}}var Pr=function(){function e(n,o){bs(this,e),st(this,"name",void 0),st(this,"style",void 0),st(this,"_keyframe",!0),this.name=n,this.style=o}return Ts(e,[{key:"getName",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return o?"".concat(o,"-").concat(this.name):this.name}}]),e}();function tp(e){return e.notSplit=!0,e}tp(["borderTop","borderBottom"]),tp(["borderTop"]),tp(["borderBottom"]),tp(["borderLeft","borderRight"]),tp(["borderLeft"]),tp(["borderRight"]);var ece=b.createContext({});const NO=ece;function tce(e){return lV(e)||tV(e)||TO(e)||uV()}function Ys(e,n){for(var o=e,s=0;s<n.length;s+=1){if(o==null)return;o=o[n[s]]}return o}function bV(e,n,o,s){if(!n.length)return o;var c=tce(n),d=c[0],p=c.slice(1),m;return!e&&typeof d=="number"?m=[]:Array.isArray(e)?m=ot(e):m=Ae({},e),s&&o===void 0&&p.length===1?delete m[d][p[0]]:m[d]=bV(m[d],p,o,s),m}function Ws(e,n,o){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return n.length&&s&&o===void 0&&!Ys(e,n.slice(0,-1))?e:bV(e,n,o,s)}function nce(e){return jn(e)==="object"&&e!==null&&Object.getPrototypeOf(e)===Object.prototype}function u3(e){return Array.isArray(e)?[]:{}}var rce=typeof Reflect>"u"?Object.keys:Reflect.ownKeys;function Ap(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];var s=u3(n[0]);return n.forEach(function(c){function d(p,m){var g=new Set(m),_=Ys(c,p),S=Array.isArray(_);if(S||nce(_)){if(!g.has(_)){g.add(_);var T=Ys(s,p);S?s=Ws(s,p,[]):(!T||jn(T)!=="object")&&(s=Ws(s,p,u3(_))),rce(_).forEach(function(R){d([].concat(ot(p),[R]),g)})}}else s=Ws(s,p,_)}d([])}),s}const TV=b.createContext(void 0),ice={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"};var oce={locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"};const ace={placeholder:"Select time",rangePlaceholder:["Start time","End time"]},RV=ace,sce={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},oce),timePickerLocale:Object.assign({},RV)},d3=sce,Fa="${label} is not a valid ${type}",cce={locale:"en",Pagination:ice,DatePicker:d3,TimePicker:RV,Calendar:d3,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand"},PageHeader:{back:"Back"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:Fa,method:Fa,array:Fa,object:Fa,number:Fa,date:Fa,boolean:Fa,integer:Fa,float:Fa,regexp:Fa,email:Fa,url:Fa,hex:Fa},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh"},ColorPicker:{presetEmpty:"Empty"}},Kp=cce;let n1=Object.assign({},Kp.Modal);function h3(e){e?n1=Object.assign(Object.assign({},n1),e):n1=Object.assign({},Kp.Modal)}const lce=b.createContext(void 0),PO=lce,uce=(e,n)=>{const o=b.useContext(PO),s=b.useMemo(()=>{var d;const p=n||Kp[e],m=(d=o==null?void 0:o[e])!==null&&d!==void 0?d:{};return Object.assign(Object.assign({},typeof p=="function"?p():p),m||{})},[e,n,o]),c=b.useMemo(()=>{const d=o==null?void 0:o.locale;return o!=null&&o.exist&&!d?Kp.locale:d},[o]);return[s,c]},wV=uce,dce="internalMark",hce=e=>{const{locale:n={},children:o,_ANT_MARK__:s}=e;b.useEffect(()=>(h3(n&&n.Modal),()=>{h3()}),[n]);const c=b.useMemo(()=>Object.assign(Object.assign({},n),{exist:!0}),[n]);return b.createElement(PO.Provider,{value:c},o)},pce=hce,fce="5.6.4",iy=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"];function so(e,n){mce(e)&&(e="100%");var o=gce(e);return e=n===360?e:Math.min(n,Math.max(0,parseFloat(e))),o&&(e=parseInt(String(e*n),10)/100),Math.abs(e-n)<1e-6?1:(n===360?e=(e<0?e%n+n:e%n)/parseFloat(String(n)):e=e%n/parseFloat(String(n)),e)}function NE(e){return Math.min(1,Math.max(0,e))}function mce(e){return typeof e=="string"&&e.indexOf(".")!==-1&&parseFloat(e)===1}function gce(e){return typeof e=="string"&&e.indexOf("%")!==-1}function IV(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function PE(e){return e<=1?"".concat(Number(e)*100,"%"):e}function wd(e){return e.length===1?"0"+e:String(e)}function vce(e,n,o){return{r:so(e,255)*255,g:so(n,255)*255,b:so(o,255)*255}}function p3(e,n,o){e=so(e,255),n=so(n,255),o=so(o,255);var s=Math.max(e,n,o),c=Math.min(e,n,o),d=0,p=0,m=(s+c)/2;if(s===c)p=0,d=0;else{var g=s-c;switch(p=m>.5?g/(2-s-c):g/(s+c),s){case e:d=(n-o)/g+(n<o?6:0);break;case n:d=(o-e)/g+2;break;case o:d=(e-n)/g+4;break}d/=6}return{h:d,s:p,l:m}}function r1(e,n,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?e+(n-e)*(6*o):o<1/2?n:o<2/3?e+(n-e)*(2/3-o)*6:e}function Ece(e,n,o){var s,c,d;if(e=so(e,360),n=so(n,100),o=so(o,100),n===0)c=o,d=o,s=o;else{var p=o<.5?o*(1+n):o+n-o*n,m=2*o-p;s=r1(m,p,e+1/3),c=r1(m,p,e),d=r1(m,p,e-1/3)}return{r:s*255,g:c*255,b:d*255}}function NI(e,n,o){e=so(e,255),n=so(n,255),o=so(o,255);var s=Math.max(e,n,o),c=Math.min(e,n,o),d=0,p=s,m=s-c,g=s===0?0:m/s;if(s===c)d=0;else{switch(s){case e:d=(n-o)/m+(n<o?6:0);break;case n:d=(o-e)/m+2;break;case o:d=(e-n)/m+4;break}d/=6}return{h:d,s:g,v:p}}function _ce(e,n,o){e=so(e,360)*6,n=so(n,100),o=so(o,100);var s=Math.floor(e),c=e-s,d=o*(1-n),p=o*(1-c*n),m=o*(1-(1-c)*n),g=s%6,_=[o,p,d,d,m,o][g],S=[m,o,o,p,d,d][g],T=[d,d,m,o,o,p][g];return{r:_*255,g:S*255,b:T*255}}function PI(e,n,o,s){var c=[wd(Math.round(e).toString(16)),wd(Math.round(n).toString(16)),wd(Math.round(o).toString(16))];return s&&c[0].startsWith(c[0].charAt(1))&&c[1].startsWith(c[1].charAt(1))&&c[2].startsWith(c[2].charAt(1))?c[0].charAt(0)+c[1].charAt(0)+c[2].charAt(0):c.join("")}function yce(e,n,o,s,c){var d=[wd(Math.round(e).toString(16)),wd(Math.round(n).toString(16)),wd(Math.round(o).toString(16)),wd(Sce(s))];return c&&d[0].startsWith(d[0].charAt(1))&&d[1].startsWith(d[1].charAt(1))&&d[2].startsWith(d[2].charAt(1))&&d[3].startsWith(d[3].charAt(1))?d[0].charAt(0)+d[1].charAt(0)+d[2].charAt(0)+d[3].charAt(0):d.join("")}function Sce(e){return Math.round(parseFloat(e)*255).toString(16)}function f3(e){return Ba(e)/255}function Ba(e){return parseInt(e,16)}function Cce(e){return{r:e>>16,g:(e&65280)>>8,b:e&255}}var DI={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function hp(e){var n={r:0,g:0,b:0},o=1,s=null,c=null,d=null,p=!1,m=!1;return typeof e=="string"&&(e=Rce(e)),typeof e=="object"&&(el(e.r)&&el(e.g)&&el(e.b)?(n=vce(e.r,e.g,e.b),p=!0,m=String(e.r).substr(-1)==="%"?"prgb":"rgb"):el(e.h)&&el(e.s)&&el(e.v)?(s=PE(e.s),c=PE(e.v),n=_ce(e.h,s,c),p=!0,m="hsv"):el(e.h)&&el(e.s)&&el(e.l)&&(s=PE(e.s),d=PE(e.l),n=Ece(e.h,s,d),p=!0,m="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(o=e.a)),o=IV(o),{ok:p,format:e.format||m,r:Math.min(255,Math.max(n.r,0)),g:Math.min(255,Math.max(n.g,0)),b:Math.min(255,Math.max(n.b,0)),a:o}}var bce="[-\\+]?\\d+%?",Tce="[-\\+]?\\d*\\.\\d+%?",vu="(?:".concat(Tce,")|(?:").concat(bce,")"),i1="[\\s|\\(]+(".concat(vu,")[,|\\s]+(").concat(vu,")[,|\\s]+(").concat(vu,")\\s*\\)?"),o1="[\\s|\\(]+(".concat(vu,")[,|\\s]+(").concat(vu,")[,|\\s]+(").concat(vu,")[,|\\s]+(").concat(vu,")\\s*\\)?"),Vs={CSS_UNIT:new RegExp(vu),rgb:new RegExp("rgb"+i1),rgba:new RegExp("rgba"+o1),hsl:new RegExp("hsl"+i1),hsla:new RegExp("hsla"+o1),hsv:new RegExp("hsv"+i1),hsva:new RegExp("hsva"+o1),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function Rce(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;var n=!1;if(DI[e])e=DI[e],n=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var o=Vs.rgb.exec(e);return o?{r:o[1],g:o[2],b:o[3]}:(o=Vs.rgba.exec(e),o?{r:o[1],g:o[2],b:o[3],a:o[4]}:(o=Vs.hsl.exec(e),o?{h:o[1],s:o[2],l:o[3]}:(o=Vs.hsla.exec(e),o?{h:o[1],s:o[2],l:o[3],a:o[4]}:(o=Vs.hsv.exec(e),o?{h:o[1],s:o[2],v:o[3]}:(o=Vs.hsva.exec(e),o?{h:o[1],s:o[2],v:o[3],a:o[4]}:(o=Vs.hex8.exec(e),o?{r:Ba(o[1]),g:Ba(o[2]),b:Ba(o[3]),a:f3(o[4]),format:n?"name":"hex8"}:(o=Vs.hex6.exec(e),o?{r:Ba(o[1]),g:Ba(o[2]),b:Ba(o[3]),format:n?"name":"hex"}:(o=Vs.hex4.exec(e),o?{r:Ba(o[1]+o[1]),g:Ba(o[2]+o[2]),b:Ba(o[3]+o[3]),a:f3(o[4]+o[4]),format:n?"name":"hex8"}:(o=Vs.hex3.exec(e),o?{r:Ba(o[1]+o[1]),g:Ba(o[2]+o[2]),b:Ba(o[3]+o[3]),format:n?"name":"hex"}:!1)))))))))}function el(e){return!!Vs.CSS_UNIT.exec(String(e))}var io=function(){function e(n,o){n===void 0&&(n=""),o===void 0&&(o={});var s;if(n instanceof e)return n;typeof n=="number"&&(n=Cce(n)),this.originalInput=n;var c=hp(n);this.originalInput=n,this.r=c.r,this.g=c.g,this.b=c.b,this.a=c.a,this.roundA=Math.round(100*this.a)/100,this.format=(s=o.format)!==null&&s!==void 0?s:c.format,this.gradientType=o.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=c.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var n=this.toRgb();return(n.r*299+n.g*587+n.b*114)/1e3},e.prototype.getLuminance=function(){var n=this.toRgb(),o,s,c,d=n.r/255,p=n.g/255,m=n.b/255;return d<=.03928?o=d/12.92:o=Math.pow((d+.055)/1.055,2.4),p<=.03928?s=p/12.92:s=Math.pow((p+.055)/1.055,2.4),m<=.03928?c=m/12.92:c=Math.pow((m+.055)/1.055,2.4),.2126*o+.7152*s+.0722*c},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(n){return this.a=IV(n),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){var n=this.toHsl().s;return n===0},e.prototype.toHsv=function(){var n=NI(this.r,this.g,this.b);return{h:n.h*360,s:n.s,v:n.v,a:this.a}},e.prototype.toHsvString=function(){var n=NI(this.r,this.g,this.b),o=Math.round(n.h*360),s=Math.round(n.s*100),c=Math.round(n.v*100);return this.a===1?"hsv(".concat(o,", ").concat(s,"%, ").concat(c,"%)"):"hsva(".concat(o,", ").concat(s,"%, ").concat(c,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var n=p3(this.r,this.g,this.b);return{h:n.h*360,s:n.s,l:n.l,a:this.a}},e.prototype.toHslString=function(){var n=p3(this.r,this.g,this.b),o=Math.round(n.h*360),s=Math.round(n.s*100),c=Math.round(n.l*100);return this.a===1?"hsl(".concat(o,", ").concat(s,"%, ").concat(c,"%)"):"hsla(".concat(o,", ").concat(s,"%, ").concat(c,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(n){return n===void 0&&(n=!1),PI(this.r,this.g,this.b,n)},e.prototype.toHexString=function(n){return n===void 0&&(n=!1),"#"+this.toHex(n)},e.prototype.toHex8=function(n){return n===void 0&&(n=!1),yce(this.r,this.g,this.b,this.a,n)},e.prototype.toHex8String=function(n){return n===void 0&&(n=!1),"#"+this.toHex8(n)},e.prototype.toHexShortString=function(n){return n===void 0&&(n=!1),this.a===1?this.toHexString(n):this.toHex8String(n)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var n=Math.round(this.r),o=Math.round(this.g),s=Math.round(this.b);return this.a===1?"rgb(".concat(n,", ").concat(o,", ").concat(s,")"):"rgba(".concat(n,", ").concat(o,", ").concat(s,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var n=function(o){return"".concat(Math.round(so(o,255)*100),"%")};return{r:n(this.r),g:n(this.g),b:n(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var n=function(o){return Math.round(so(o,255)*100)};return this.a===1?"rgb(".concat(n(this.r),"%, ").concat(n(this.g),"%, ").concat(n(this.b),"%)"):"rgba(".concat(n(this.r),"%, ").concat(n(this.g),"%, ").concat(n(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var n="#"+PI(this.r,this.g,this.b,!1),o=0,s=Object.entries(DI);o<s.length;o++){var c=s[o],d=c[0],p=c[1];if(n===p)return d}return!1},e.prototype.toString=function(n){var o=!!n;n=n??this.format;var s=!1,c=this.a<1&&this.a>=0,d=!o&&c&&(n.startsWith("hex")||n==="name");return d?n==="name"&&this.a===0?this.toName():this.toRgbString():(n==="rgb"&&(s=this.toRgbString()),n==="prgb"&&(s=this.toPercentageRgbString()),(n==="hex"||n==="hex6")&&(s=this.toHexString()),n==="hex3"&&(s=this.toHexString(!0)),n==="hex4"&&(s=this.toHex8String(!0)),n==="hex8"&&(s=this.toHex8String()),n==="name"&&(s=this.toName()),n==="hsl"&&(s=this.toHslString()),n==="hsv"&&(s=this.toHsvString()),s||this.toHexString())},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(n){n===void 0&&(n=10);var o=this.toHsl();return o.l+=n/100,o.l=NE(o.l),new e(o)},e.prototype.brighten=function(n){n===void 0&&(n=10);var o=this.toRgb();return o.r=Math.max(0,Math.min(255,o.r-Math.round(255*-(n/100)))),o.g=Math.max(0,Math.min(255,o.g-Math.round(255*-(n/100)))),o.b=Math.max(0,Math.min(255,o.b-Math.round(255*-(n/100)))),new e(o)},e.prototype.darken=function(n){n===void 0&&(n=10);var o=this.toHsl();return o.l-=n/100,o.l=NE(o.l),new e(o)},e.prototype.tint=function(n){return n===void 0&&(n=10),this.mix("white",n)},e.prototype.shade=function(n){return n===void 0&&(n=10),this.mix("black",n)},e.prototype.desaturate=function(n){n===void 0&&(n=10);var o=this.toHsl();return o.s-=n/100,o.s=NE(o.s),new e(o)},e.prototype.saturate=function(n){n===void 0&&(n=10);var o=this.toHsl();return o.s+=n/100,o.s=NE(o.s),new e(o)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(n){var o=this.toHsl(),s=(o.h+n)%360;return o.h=s<0?360+s:s,new e(o)},e.prototype.mix=function(n,o){o===void 0&&(o=50);var s=this.toRgb(),c=new e(n).toRgb(),d=o/100,p={r:(c.r-s.r)*d+s.r,g:(c.g-s.g)*d+s.g,b:(c.b-s.b)*d+s.b,a:(c.a-s.a)*d+s.a};return new e(p)},e.prototype.analogous=function(n,o){n===void 0&&(n=6),o===void 0&&(o=30);var s=this.toHsl(),c=360/o,d=[this];for(s.h=(s.h-(c*n>>1)+720)%360;--n;)s.h=(s.h+c)%360,d.push(new e(s));return d},e.prototype.complement=function(){var n=this.toHsl();return n.h=(n.h+180)%360,new e(n)},e.prototype.monochromatic=function(n){n===void 0&&(n=6);for(var o=this.toHsv(),s=o.h,c=o.s,d=o.v,p=[],m=1/n;n--;)p.push(new e({h:s,s:c,v:d})),d=(d+m)%1;return p},e.prototype.splitcomplement=function(){var n=this.toHsl(),o=n.h;return[this,new e({h:(o+72)%360,s:n.s,l:n.l}),new e({h:(o+216)%360,s:n.s,l:n.l})]},e.prototype.onBackground=function(n){var o=this.toRgb(),s=new e(n).toRgb(),c=o.a+s.a*(1-o.a);return new e({r:(o.r*o.a+s.r*s.a*(1-o.a))/c,g:(o.g*o.a+s.g*s.a*(1-o.a))/c,b:(o.b*o.a+s.b*s.a*(1-o.a))/c,a:c})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(n){for(var o=this.toHsl(),s=o.h,c=[this],d=360/n,p=1;p<n;p++)c.push(new e({h:(s+p*d)%360,s:o.s,l:o.l}));return c},e.prototype.equals=function(n){return this.toRgbString()===new e(n).toRgbString()},e}(),DE=2,m3=.16,wce=.05,Ice=.05,Ace=.15,AV=5,OV=4,Oce=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function g3(e){var n=e.r,o=e.g,s=e.b,c=NI(n,o,s);return{h:c.h*360,s:c.s,v:c.v}}function kE(e){var n=e.r,o=e.g,s=e.b;return"#".concat(PI(n,o,s,!1))}function xce(e,n,o){var s=o/100,c={r:(n.r-e.r)*s+e.r,g:(n.g-e.g)*s+e.g,b:(n.b-e.b)*s+e.b};return c}function v3(e,n,o){var s;return Math.round(e.h)>=60&&Math.round(e.h)<=240?s=o?Math.round(e.h)-DE*n:Math.round(e.h)+DE*n:s=o?Math.round(e.h)+DE*n:Math.round(e.h)-DE*n,s<0?s+=360:s>=360&&(s-=360),s}function E3(e,n,o){if(e.h===0&&e.s===0)return e.s;var s;return o?s=e.s-m3*n:n===OV?s=e.s+m3:s=e.s+wce*n,s>1&&(s=1),o&&n===AV&&s>.1&&(s=.1),s<.06&&(s=.06),Number(s.toFixed(2))}function _3(e,n,o){var s;return o?s=e.v+Ice*n:s=e.v-Ace*n,s>1&&(s=1),Number(s.toFixed(2))}function gl(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=[],s=hp(e),c=AV;c>0;c-=1){var d=g3(s),p=kE(hp({h:v3(d,c,!0),s:E3(d,c,!0),v:_3(d,c,!0)}));o.push(p)}o.push(kE(s));for(var m=1;m<=OV;m+=1){var g=g3(s),_=kE(hp({h:v3(g,m),s:E3(g,m),v:_3(g,m)}));o.push(_)}return n.theme==="dark"?Oce.map(function(S){var T=S.index,R=S.opacity,N=kE(xce(hp(n.backgroundColor||"#141414"),hp(o[T]),R*100));return N}):o}var a1={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},nm={},s1={};Object.keys(a1).forEach(function(e){nm[e]=gl(a1[e]),nm[e].primary=nm[e][5],s1[e]=gl(a1[e],{theme:"dark",backgroundColor:"#141414"}),s1[e].primary=s1[e][5]});var Nce=nm.gold,Pce=nm.blue;const Dce=e=>{const{controlHeight:n}=e;return{controlHeightSM:n*.75,controlHeightXS:n*.5,controlHeightLG:n*1.25}},xV=Dce;function kce(e){const{sizeUnit:n,sizeStep:o}=e;return{sizeXXL:n*(o+8),sizeXL:n*(o+4),sizeLG:n*(o+2),sizeMD:n*(o+1),sizeMS:n*o,size:n*o,sizeSM:n*(o-1),sizeXS:n*(o-2),sizeXXS:n*(o-3)}}const DO={blue:"#1677ff",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#eb2f96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},Lce=Object.assign(Object.assign({},DO),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0}),Gm=Lce;function NV(e,n){let{generateColorPalettes:o,generateNeutralColorPalettes:s}=n;const{colorSuccess:c,colorWarning:d,colorError:p,colorInfo:m,colorPrimary:g,colorBgBase:_,colorTextBase:S}=e,T=o(g),R=o(c),N=o(d),O=o(p),A=o(m),M=s(_,S);return Object.assign(Object.assign({},M),{colorPrimaryBg:T[1],colorPrimaryBgHover:T[2],colorPrimaryBorder:T[3],colorPrimaryBorderHover:T[4],colorPrimaryHover:T[5],colorPrimary:T[6],colorPrimaryActive:T[7],colorPrimaryTextHover:T[8],colorPrimaryText:T[9],colorPrimaryTextActive:T[10],colorSuccessBg:R[1],colorSuccessBgHover:R[2],colorSuccessBorder:R[3],colorSuccessBorderHover:R[4],colorSuccessHover:R[4],colorSuccess:R[6],colorSuccessActive:R[7],colorSuccessTextHover:R[8],colorSuccessText:R[9],colorSuccessTextActive:R[10],colorErrorBg:O[1],colorErrorBgHover:O[2],colorErrorBorder:O[3],colorErrorBorderHover:O[4],colorErrorHover:O[5],colorError:O[6],colorErrorActive:O[7],colorErrorTextHover:O[8],colorErrorText:O[9],colorErrorTextActive:O[10],colorWarningBg:N[1],colorWarningBgHover:N[2],colorWarningBorder:N[3],colorWarningBorderHover:N[4],colorWarningHover:N[4],colorWarning:N[6],colorWarningActive:N[7],colorWarningTextHover:N[8],colorWarningText:N[9],colorWarningTextActive:N[10],colorInfoBg:A[1],colorInfoBgHover:A[2],colorInfoBorder:A[3],colorInfoBorderHover:A[4],colorInfoHover:A[4],colorInfo:A[6],colorInfoActive:A[7],colorInfoTextHover:A[8],colorInfoText:A[9],colorInfoTextActive:A[10],colorBgMask:new io("#000").setAlpha(.45).toRgbString(),colorWhite:"#fff"})}const Mce=e=>{let n=e,o=e,s=e,c=e;return e<6&&e>=5?n=e+1:e<16&&e>=6?n=e+2:e>=16&&(n=16),e<7&&e>=5?o=4:e<8&&e>=7?o=5:e<14&&e>=8?o=6:e<16&&e>=14?o=7:e>=16&&(o=8),e<6&&e>=2?s=1:e>=6&&(s=2),e>4&&e<8?c=4:e>=8&&(c=6),{borderRadius:e>16?16:e,borderRadiusXS:s,borderRadiusSM:o,borderRadiusLG:n,borderRadiusOuter:c}},Fce=Mce;function Uce(e){const{motionUnit:n,motionBase:o,borderRadius:s,lineWidth:c}=e;return Object.assign({motionDurationFast:`${(o+n).toFixed(1)}s`,motionDurationMid:`${(o+n*2).toFixed(1)}s`,motionDurationSlow:`${(o+n*3).toFixed(1)}s`,lineWidthBold:c+1},Fce(s))}const tl=(e,n)=>new io(e).setAlpha(n).toRgbString(),N0=(e,n)=>new io(e).darken(n).toHexString(),Bce=e=>{const n=gl(e);return{1:n[0],2:n[1],3:n[2],4:n[3],5:n[4],6:n[5],7:n[6],8:n[4],9:n[5],10:n[6]}},jce=(e,n)=>{const o=e||"#fff",s=n||"#000";return{colorBgBase:o,colorTextBase:s,colorText:tl(s,.88),colorTextSecondary:tl(s,.65),colorTextTertiary:tl(s,.45),colorTextQuaternary:tl(s,.25),colorFill:tl(s,.15),colorFillSecondary:tl(s,.06),colorFillTertiary:tl(s,.04),colorFillQuaternary:tl(s,.02),colorBgLayout:N0(o,4),colorBgContainer:N0(o,0),colorBgElevated:N0(o,0),colorBgSpotlight:tl(s,.85),colorBorder:N0(o,15),colorBorderSecondary:N0(o,6)}};function Vce(e){const n=new Array(10).fill(null).map((o,s)=>{const c=s-1,d=e*Math.pow(2.71828,c/5),p=s>1?Math.floor(d):Math.ceil(d);return Math.floor(p/2)*2});return n[1]=e,n.map(o=>{const s=o+8;return{size:o,lineHeight:s/o}})}const $ce=e=>{const n=Vce(e),o=n.map(c=>c.size),s=n.map(c=>c.lineHeight);return{fontSizeSM:o[0],fontSize:o[1],fontSizeLG:o[2],fontSizeXL:o[3],fontSizeHeading1:o[6],fontSizeHeading2:o[5],fontSizeHeading3:o[4],fontSizeHeading4:o[3],fontSizeHeading5:o[2],lineHeight:s[1],lineHeightLG:s[2],lineHeightSM:s[0],lineHeightHeading1:s[6],lineHeightHeading2:s[5],lineHeightHeading3:s[4],lineHeightHeading4:s[3],lineHeightHeading5:s[2]}},PV=$ce;function Km(e){const n=Object.keys(DO).map(o=>{const s=gl(e[o]);return new Array(10).fill(1).reduce((c,d,p)=>(c[`${o}-${p+1}`]=s[p],c[`${o}${p+1}`]=s[p],c),{})}).reduce((o,s)=>(o=Object.assign(Object.assign({},o),s),o),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),n),NV(e,{generateColorPalettes:Bce,generateNeutralColorPalettes:jce})),PV(e.fontSize)),kce(e)),xV(e)),Uce(e))}function c1(e){return e>=0&&e<=255}function LE(e,n){const{r:o,g:s,b:c,a:d}=new io(e).toRgb();if(d<1)return e;const{r:p,g:m,b:g}=new io(n).toRgb();for(let _=.01;_<=1;_+=.01){const S=Math.round((o-p*(1-_))/_),T=Math.round((s-m*(1-_))/_),R=Math.round((c-g*(1-_))/_);if(c1(S)&&c1(T)&&c1(R))return new io({r:S,g:T,b:R,a:Math.round(_*100)/100}).toRgbString()}return new io({r:o,g:s,b:c,a:1}).toRgbString()}var Hce=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function DV(e){const{override:n}=e,o=Hce(e,["override"]),s=Object.assign({},n);Object.keys(Gm).forEach(R=>{delete s[R]});const c=Object.assign(Object.assign({},o),s),d=480,p=576,m=768,g=992,_=1200,S=1600;if(c.motion===!1){const R="0s";c.motionDurationFast=R,c.motionDurationMid=R,c.motionDurationSlow=R}return Object.assign(Object.assign(Object.assign({},c),{colorLink:c.colorInfoText,colorLinkHover:c.colorInfoHover,colorLinkActive:c.colorInfoActive,colorFillContent:c.colorFillSecondary,colorFillContentHover:c.colorFill,colorFillAlter:c.colorFillQuaternary,colorBgContainerDisabled:c.colorFillTertiary,colorBorderBg:c.colorBgContainer,colorSplit:LE(c.colorBorderSecondary,c.colorBgContainer),colorTextPlaceholder:c.colorTextQuaternary,colorTextDisabled:c.colorTextQuaternary,colorTextHeading:c.colorText,colorTextLabel:c.colorTextSecondary,colorTextDescription:c.colorTextTertiary,colorTextLightSolid:c.colorWhite,colorHighlight:c.colorError,colorBgTextHover:c.colorFillSecondary,colorBgTextActive:c.colorFill,colorIcon:c.colorTextTertiary,colorIconHover:c.colorText,colorErrorOutline:LE(c.colorErrorBg,c.colorBgContainer),colorWarningOutline:LE(c.colorWarningBg,c.colorBgContainer),fontSizeIcon:c.fontSizeSM,lineWidthFocus:c.lineWidth*4,lineWidth:c.lineWidth,controlOutlineWidth:c.lineWidth*2,controlInteractiveSize:c.controlHeight/2,controlItemBgHover:c.colorFillTertiary,controlItemBgActive:c.colorPrimaryBg,controlItemBgActiveHover:c.colorPrimaryBgHover,controlItemBgActiveDisabled:c.colorFill,controlTmpOutline:c.colorFillQuaternary,controlOutline:LE(c.colorPrimaryBg,c.colorBgContainer),lineType:c.lineType,borderRadius:c.borderRadius,borderRadiusXS:c.borderRadiusXS,borderRadiusSM:c.borderRadiusSM,borderRadiusLG:c.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:c.sizeXXS,paddingXS:c.sizeXS,paddingSM:c.sizeSM,padding:c.size,paddingMD:c.sizeMD,paddingLG:c.sizeLG,paddingXL:c.sizeXL,paddingContentHorizontalLG:c.sizeLG,paddingContentVerticalLG:c.sizeMS,paddingContentHorizontal:c.sizeMS,paddingContentVertical:c.sizeSM,paddingContentHorizontalSM:c.size,paddingContentVerticalSM:c.sizeXS,marginXXS:c.sizeXXS,marginXS:c.sizeXS,marginSM:c.sizeSM,margin:c.size,marginMD:c.sizeMD,marginLG:c.sizeLG,marginXL:c.sizeXL,marginXXL:c.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:d,screenXSMin:d,screenXSMax:p-1,screenSM:p,screenSMMin:p,screenSMMax:m-1,screenMD:m,screenMDMin:m,screenMDMax:g-1,screenLG:g,screenLGMin:g,screenLGMax:_-1,screenXL:_,screenXLMin:_,screenXLMax:S-1,screenXXL:S,screenXXLMin:S,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new io("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new io("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new io("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),s)}function qs(e){var n=b.useRef();n.current=e;var o=b.useCallback(function(){for(var s,c=arguments.length,d=new Array(c),p=0;p<c;p++)d[p]=arguments[p];return(s=n.current)===null||s===void 0?void 0:s.call.apply(s,[n].concat(d))},[]);return o}function Ld(e){var n=b.useRef(!1),o=b.useState(e),s=We(o,2),c=s[0],d=s[1];b.useEffect(function(){return n.current=!1,function(){n.current=!0}},[]);function p(m,g){g&&n.current||d(m)}return[c,p]}function l1(e){return e!==void 0}function cl(e,n){var o=n||{},s=o.defaultValue,c=o.value,d=o.onChange,p=o.postState,m=Ld(function(){return l1(c)?c:l1(s)?typeof s=="function"?s():s:typeof e=="function"?e():e}),g=We(m,2),_=g[0],S=g[1],T=c!==void 0?c:_,R=p?p(T):T,N=qs(d),O=Ld([T]),A=We(O,2),M=A[0],x=A[1];r3(function(){var D=M[0];_!==D&&N(_,D)},[M]),r3(function(){l1(c)||S(c)},[c]);var P=qs(function(D,F){S(D,F),x([T],F)});return[R,P]}const kO="anticon",Wce=(e,n)=>n||(e?`ant-${e}`:"ant"),nr=b.createContext({getPrefixCls:Wce,iconPrefixCls:kO}),kV=e=>({color:e.colorLink,textDecoration:"none",outline:"none",cursor:"pointer",transition:`color ${e.motionDurationSlow}`,"&:focus, &:hover":{color:e.colorLinkHover},"&:active":{color:e.colorLinkActive}}),zce=(e,n,o,s,c)=>{const d=e/2,p=0,m=d,g=o*1/Math.sqrt(2),_=d-o*(1-1/Math.sqrt(2)),S=d-n*(1/Math.sqrt(2)),T=o*(Math.sqrt(2)-1)+n*(1/Math.sqrt(2)),R=2*d-S,N=T,O=2*d-g,A=_,M=2*d-p,x=m,P=d*Math.sqrt(2)+o*(Math.sqrt(2)-2),D=o*(Math.sqrt(2)-1);return{pointerEvents:"none",width:e,height:e,overflow:"hidden","&::before":{position:"absolute",bottom:0,insetInlineStart:0,width:e,height:e/2,background:s,clipPath:{_multi_value_:!0,value:[`polygon(${D}px 100%, 50% ${D}px, ${2*d-D}px 100%, ${D}px 100%)`,`path('M ${p} ${m} A ${o} ${o} 0 0 0 ${g} ${_} L ${S} ${T} A ${n} ${n} 0 0 1 ${R} ${N} L ${O} ${A} A ${o} ${o} 0 0 0 ${M} ${x} Z')`]},content:'""'},"&::after":{content:'""',position:"absolute",width:P,height:P,bottom:0,insetInline:0,margin:"auto",borderRadius:{_skip_check_:!0,value:`0 0 ${n}px 0`},transform:"translateY(50%) rotate(-135deg)",boxShadow:c,zIndex:0,background:"transparent"}}},Gce={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},Kd=e=>({boxSizing:"border-box",margin:0,padding:0,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight,listStyle:"none",fontFamily:e.fontFamily}),LV=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),kI=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}}),Kce=e=>({a:{color:e.colorLink,textDecoration:e.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${e.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:e.colorLinkHover},"&:active":{color:e.colorLinkActive},"&:active,\n  &:hover":{textDecoration:e.linkHoverDecoration,outline:0},"&:focus":{textDecoration:e.linkFocusDecoration,outline:0},"&[disabled]":{color:e.colorTextDisabled,cursor:"not-allowed"}}}),qce=(e,n)=>{const{fontFamily:o,fontSize:s}=e,c=`[class^="${n}"], [class*=" ${n}"]`;return{[c]:{fontFamily:o,fontSize:s,boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"},[c]:{boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}}}}},MV=e=>({outline:`${e.lineWidthFocus}px solid ${e.colorPrimaryBorder}`,outlineOffset:1,transition:"outline-offset 0s, outline 0s"}),Yce=e=>({"&:focus-visible":Object.assign({},MV(e))});function ic(e,n,o,s){return c=>{const[d,p,m]=of(),{getPrefixCls:g,iconPrefixCls:_,csp:S}=b.useContext(nr),T=g(),R={theme:d,token:p,hashId:m,nonce:()=>S==null?void 0:S.nonce};return xI(Object.assign(Object.assign({},R),{path:["Shared",T]}),()=>[{"&":Kce(p)}]),[xI(Object.assign(Object.assign({},R),{path:[e,c,_]}),()=>{const{token:N,flush:O}=Jce(p),A=Object.assign({},p[e]);if(s!=null&&s.deprecatedTokens){const{deprecatedTokens:j}=s;j.forEach(B=>{let[H,K]=B;var J;(A!=null&&A[H]||A!=null&&A[K])&&((J=A[K])!==null&&J!==void 0||(A[K]=A==null?void 0:A[H]))})}const M=typeof o=="function"?o(lo(N,A??{})):o,x=Object.assign(Object.assign({},M),A),P=`.${c}`,D=lo(N,{componentCls:P,prefixCls:c,iconCls:`.${_}`,antCls:`.${T}`},x),F=n(D,{hashId:m,prefixCls:c,rootPrefixCls:T,iconPrefixCls:_,overrideComponentToken:A});return O(e,x),[(s==null?void 0:s.resetStyle)===!1?null:qce(p,c),F]}),m]}}const FV=typeof CSSINJS_STATISTIC<"u";let LI=!0;function lo(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];if(!FV)return Object.assign.apply(Object,[{}].concat(n));LI=!1;const s={};return n.forEach(c=>{Object.keys(c).forEach(p=>{Object.defineProperty(s,p,{configurable:!0,enumerable:!0,get:()=>c[p]})})}),LI=!0,s}function Xce(){}function Jce(e){let n,o=e,s=Xce;return FV&&(n=new Set,o=new Proxy(e,{get(c,d){return LI&&n.add(d),c[d]}}),s=(c,d)=>{Array.from(n)}),{token:o,keys:n,flush:s}}function Qce(e,n){return iy.reduce((o,s)=>{const c=e[`${s}1`],d=e[`${s}3`],p=e[`${s}6`],m=e[`${s}7`];return Object.assign(Object.assign({},o),n(s,{lightColor:c,lightBorderColor:d,darkColor:p,textColor:m}))},{})}const Zce=ny(Km),oy={token:Gm,hashed:!0},UV=Et.createContext(oy);function of(){const{token:e,hashed:n,theme:o,components:s}=Et.useContext(UV),c=`${fce}-${n||""}`,d=o||Zce,[p,m]=wse(d,[Gm,e],{salt:c,override:Object.assign({override:e},s),formatToken:DV});return[d,p,n?m:""]}const ele=`-ant-${Date.now()}-${Math.random()}`;function tle(e,n){const o={},s=(p,m)=>{let g=p.clone();return g=(m==null?void 0:m(g))||g,g.toRgbString()},c=(p,m)=>{const g=new io(p),_=gl(g.toRgbString());o[`${m}-color`]=s(g),o[`${m}-color-disabled`]=_[1],o[`${m}-color-hover`]=_[4],o[`${m}-color-active`]=_[6],o[`${m}-color-outline`]=g.clone().setAlpha(.2).toRgbString(),o[`${m}-color-deprecated-bg`]=_[0],o[`${m}-color-deprecated-border`]=_[2]};if(n.primaryColor){c(n.primaryColor,"primary");const p=new io(n.primaryColor),m=gl(p.toRgbString());m.forEach((_,S)=>{o[`primary-${S+1}`]=_}),o["primary-color-deprecated-l-35"]=s(p,_=>_.lighten(35)),o["primary-color-deprecated-l-20"]=s(p,_=>_.lighten(20)),o["primary-color-deprecated-t-20"]=s(p,_=>_.tint(20)),o["primary-color-deprecated-t-50"]=s(p,_=>_.tint(50)),o["primary-color-deprecated-f-12"]=s(p,_=>_.setAlpha(_.getAlpha()*.12));const g=new io(m[0]);o["primary-color-active-deprecated-f-30"]=s(g,_=>_.setAlpha(_.getAlpha()*.3)),o["primary-color-active-deprecated-d-02"]=s(g,_=>_.darken(2))}return n.successColor&&c(n.successColor,"success"),n.warningColor&&c(n.warningColor,"warning"),n.errorColor&&c(n.errorColor,"error"),n.infoColor&&c(n.infoColor,"info"),`
  :root {
    ${Object.keys(o).map(p=>`--${e}-${p}: ${o[p]};`).join(`
`)}
  }
  `.trim()}function nle(e,n){const o=tle(e,n);xo()&&Om(o,`${ele}-dynamic-theme`)}const MI=b.createContext(!1),BV=e=>{let{children:n,disabled:o}=e;const s=b.useContext(MI);return b.createElement(MI.Provider,{value:o??s},n)},qm=MI,rle=e=>{const n=Et.useContext(cS);return Et.useMemo(()=>e?typeof e=="string"?e??n:e instanceof Function?e(n):n:n,[e,n])},af=rle,jV=b.createContext(void 0),VV=e=>{let{children:n,size:o}=e;const s=af(o);return b.createElement(jV.Provider,{value:s},n)},cS=jV;function ile(){const e=b.useContext(qm),n=b.useContext(cS);return{componentDisabled:e,componentSize:n}}function ole(e,n){const o=e||{},s=o.inherit===!1||!n?oy:n;return tS(()=>{if(!e)return n;const d=Object.assign({},s.components);return Object.keys(e.components||{}).forEach(p=>{d[p]=Object.assign(Object.assign({},d[p]),e.components[p])}),Object.assign(Object.assign(Object.assign({},s),o),{token:Object.assign(Object.assign({},s.token),o.token),components:d})},[o,s],(d,p)=>d.some((m,g)=>{const _=p[g];return!iS(m,_,!0)}))}var ale=["children"],$V=b.createContext({});function sle(e){var n=e.children,o=xn(e,ale);return b.createElement($V.Provider,{value:o},n)}var cle=function(e){ef(o,e);var n=tf(o);function o(){return bs(this,o),n.apply(this,arguments)}return Ts(o,[{key:"render",value:function(){return this.props.children}}]),o}(b.Component),Sd="none",ME="appear",FE="enter",UE="leave",y3="none",zs="prepare",Op="start",xp="active",LO="end",HV="prepared";function S3(e,n){var o={};return o[e.toLowerCase()]=n.toLowerCase(),o["Webkit".concat(e)]="webkit".concat(n),o["Moz".concat(e)]="moz".concat(n),o["ms".concat(e)]="MS".concat(n),o["O".concat(e)]="o".concat(n.toLowerCase()),o}function lle(e,n){var o={animationend:S3("Animation","AnimationEnd"),transitionend:S3("Transition","TransitionEnd")};return e&&("AnimationEvent"in n||delete o.animationend.animation,"TransitionEvent"in n||delete o.transitionend.transition),o}var ule=lle(xo(),typeof window<"u"?window:{}),WV={};if(xo()){var dle=document.createElement("div");WV=dle.style}var BE={};function zV(e){if(BE[e])return BE[e];var n=ule[e];if(n)for(var o=Object.keys(n),s=o.length,c=0;c<s;c+=1){var d=o[c];if(Object.prototype.hasOwnProperty.call(n,d)&&d in WV)return BE[e]=n[d],BE[e]}return""}var GV=zV("animationend"),KV=zV("transitionend"),qV=!!(GV&&KV),C3=GV||"animationend",b3=KV||"transitionend";function T3(e,n){if(!e)return null;if(jn(e)==="object"){var o=n.replace(/-\w/g,function(s){return s[1].toUpperCase()});return e[o]}return"".concat(e,"-").concat(n)}const hle=function(e){var n=b.useRef(),o=b.useRef(e);o.current=e;var s=b.useCallback(function(p){o.current(p)},[]);function c(p){p&&(p.removeEventListener(b3,s),p.removeEventListener(C3,s))}function d(p){n.current&&n.current!==p&&c(n.current),p&&p!==n.current&&(p.addEventListener(b3,s),p.addEventListener(C3,s),n.current=p)}return b.useEffect(function(){return function(){c(n.current)}},[]),[d,c]};var YV=xo()?b.useLayoutEffect:b.useEffect;const ple=function(){var e=b.useRef(null);function n(){ao.cancel(e.current)}function o(s){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;n();var d=ao(function(){c<=1?s({isCanceled:function(){return d!==e.current}}):o(s,c-1)});e.current=d}return b.useEffect(function(){return function(){n()}},[]),[o,n]};var fle=[zs,Op,xp,LO],mle=[zs,HV],XV=!1,gle=!0;function JV(e){return e===xp||e===LO}const vle=function(e,n,o){var s=Ld(y3),c=We(s,2),d=c[0],p=c[1],m=ple(),g=We(m,2),_=g[0],S=g[1];function T(){p(zs,!0)}var R=n?mle:fle;return YV(function(){if(d!==y3&&d!==LO){var N=R.indexOf(d),O=R[N+1],A=o(d);A===XV?p(O,!0):O&&_(function(M){function x(){M.isCanceled()||p(O,!0)}A===!0?x():Promise.resolve(A).then(x)})}},[e,d]),b.useEffect(function(){return function(){S()}},[]),[T,d]};function Ele(e,n,o,s){var c=s.motionEnter,d=c===void 0?!0:c,p=s.motionAppear,m=p===void 0?!0:p,g=s.motionLeave,_=g===void 0?!0:g,S=s.motionDeadline,T=s.motionLeaveImmediately,R=s.onAppearPrepare,N=s.onEnterPrepare,O=s.onLeavePrepare,A=s.onAppearStart,M=s.onEnterStart,x=s.onLeaveStart,P=s.onAppearActive,D=s.onEnterActive,F=s.onLeaveActive,j=s.onAppearEnd,B=s.onEnterEnd,H=s.onLeaveEnd,K=s.onVisibleChanged,J=Ld(),q=We(J,2),Q=q[0],ee=q[1],ne=Ld(Sd),he=We(ne,2),pe=he[0],ce=he[1],se=Ld(null),ae=We(se,2),Ee=ae[0],ve=ae[1],le=b.useRef(!1),de=b.useRef(null);function ye(){return o()}var fe=b.useRef(!1);function ke(){ce(Sd,!0),ve(null,!0)}function Me(ct){var et=ye();if(!(ct&&!ct.deadline&&ct.target!==et)){var tt=fe.current,mt;pe===ME&&tt?mt=j==null?void 0:j(et,ct):pe===FE&&tt?mt=B==null?void 0:B(et,ct):pe===UE&&tt&&(mt=H==null?void 0:H(et,ct)),pe!==Sd&&tt&&mt!==!1&&ke()}}var Ve=hle(Me),je=We(Ve,1),dt=je[0],ut=function(et){var tt,mt,Ot;switch(et){case ME:return tt={},st(tt,zs,R),st(tt,Op,A),st(tt,xp,P),tt;case FE:return mt={},st(mt,zs,N),st(mt,Op,M),st(mt,xp,D),mt;case UE:return Ot={},st(Ot,zs,O),st(Ot,Op,x),st(Ot,xp,F),Ot;default:return{}}},Ct=b.useMemo(function(){return ut(pe)},[pe]),_t=vle(pe,!e,function(ct){if(ct===zs){var et=Ct[zs];return et?et(ye()):XV}if(kt in Ct){var tt;ve(((tt=Ct[kt])===null||tt===void 0?void 0:tt.call(Ct,ye(),null))||null)}return kt===xp&&(dt(ye()),S>0&&(clearTimeout(de.current),de.current=setTimeout(function(){Me({deadline:!0})},S))),kt===HV&&ke(),gle}),Tt=We(_t,2),it=Tt[0],kt=Tt[1],qt=JV(kt);fe.current=qt,YV(function(){ee(n);var ct=le.current;le.current=!0;var et;!ct&&n&&m&&(et=ME),ct&&n&&d&&(et=FE),(ct&&!n&&_||!ct&&T&&!n&&_)&&(et=UE);var tt=ut(et);et&&(e||tt[zs])?(ce(et),it()):ce(Sd)},[n]),b.useEffect(function(){(pe===ME&&!m||pe===FE&&!d||pe===UE&&!_)&&ce(Sd)},[m,d,_]),b.useEffect(function(){return function(){le.current=!1,clearTimeout(de.current)}},[]);var xt=b.useRef(!1);b.useEffect(function(){Q&&(xt.current=!0),Q!==void 0&&pe===Sd&&((xt.current||Q)&&(K==null||K(Q)),xt.current=!0)},[Q,pe]);var ze=Ee;return Ct[zs]&&kt===Op&&(ze=Ae({transition:"none"},ze)),[pe,kt,ze,Q??n]}function _le(e){var n=e;jn(e)==="object"&&(n=e.transitionSupport);function o(c,d){return!!(c.motionName&&n&&d!==!1)}var s=b.forwardRef(function(c,d){var p=c.visible,m=p===void 0?!0:p,g=c.removeOnLeave,_=g===void 0?!0:g,S=c.forceRender,T=c.children,R=c.motionName,N=c.leavedClassName,O=c.eventProps,A=b.useContext($V),M=A.motion,x=o(c,M),P=b.useRef(),D=b.useRef();function F(){try{return P.current instanceof HTMLElement?P.current:h_(D.current)}catch{return null}}var j=Ele(x,m,F,c),B=We(j,4),H=B[0],K=B[1],J=B[2],q=B[3],Q=b.useRef(q);q&&(Q.current=!0);var ee=b.useCallback(function(ve){P.current=ve,bO(d,ve)},[d]),ne,he=Ae(Ae({},O),{},{visible:m});if(!T)ne=null;else if(H===Sd)q?ne=T(Ae({},he),ee):!_&&Q.current&&N?ne=T(Ae(Ae({},he),{},{className:N}),ee):S||!_&&!N?ne=T(Ae(Ae({},he),{},{style:{display:"none"}}),ee):ne=null;else{var pe,ce;K===zs?ce="prepare":JV(K)?ce="active":K===Op&&(ce="start");var se=T3(R,"".concat(H,"-").concat(ce));ne=T(Ae(Ae({},he),{},{className:Ye(T3(R,H),(pe={},st(pe,se,se&&ce),st(pe,R,typeof R=="string"),pe)),style:J}),ee)}if(b.isValidElement(ne)&&nf(ne)){var ae=ne,Ee=ae.ref;Ee||(ne=b.cloneElement(ne,{ref:ee}))}return b.createElement(cle,{ref:D},ne)});return s.displayName="CSSMotion",s}const qd=_le(qV);var FI="add",UI="keep",BI="remove",u1="removed";function yle(e){var n;return e&&jn(e)==="object"&&"key"in e?n=e:n={key:e},Ae(Ae({},n),{},{key:String(n.key)})}function jI(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return e.map(yle)}function Sle(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=[],s=0,c=n.length,d=jI(e),p=jI(n);d.forEach(function(_){for(var S=!1,T=s;T<c;T+=1){var R=p[T];if(R.key===_.key){s<T&&(o=o.concat(p.slice(s,T).map(function(N){return Ae(Ae({},N),{},{status:FI})})),s=T),o.push(Ae(Ae({},R),{},{status:UI})),s+=1,S=!0;break}}S||o.push(Ae(Ae({},_),{},{status:BI}))}),s<c&&(o=o.concat(p.slice(s).map(function(_){return Ae(Ae({},_),{},{status:FI})})));var m={};o.forEach(function(_){var S=_.key;m[S]=(m[S]||0)+1});var g=Object.keys(m).filter(function(_){return m[_]>1});return g.forEach(function(_){o=o.filter(function(S){var T=S.key,R=S.status;return T!==_||R!==BI}),o.forEach(function(S){S.key===_&&(S.status=UI)})}),o}var Cle=["component","children","onVisibleChanged","onAllRemoved"],ble=["status"],Tle=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function Rle(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qd,o=function(s){ef(d,s);var c=tf(d);function d(){var p;bs(this,d);for(var m=arguments.length,g=new Array(m),_=0;_<m;_++)g[_]=arguments[_];return p=c.call.apply(c,[this].concat(g)),st(J_(p),"state",{keyEntities:[]}),st(J_(p),"removeKey",function(S){var T=p.state.keyEntities,R=T.map(function(N){return N.key!==S?N:Ae(Ae({},N),{},{status:u1})});return p.setState({keyEntities:R}),R.filter(function(N){var O=N.status;return O!==u1}).length}),p}return Ts(d,[{key:"render",value:function(){var m=this,g=this.state.keyEntities,_=this.props,S=_.component,T=_.children,R=_.onVisibleChanged,N=_.onAllRemoved,O=xn(_,Cle),A=S||b.Fragment,M={};return Tle.forEach(function(x){M[x]=O[x],delete O[x]}),delete O.keys,b.createElement(A,O,g.map(function(x,P){var D=x.status,F=xn(x,ble),j=D===FI||D===UI;return b.createElement(n,Qe({},M,{key:F.key,visible:j,eventProps:F,onVisibleChanged:function(H){if(R==null||R(H,{key:F.key}),!H){var K=m.removeKey(F.key);K===0&&N&&N()}}}),function(B,H){return T(Ae(Ae({},B),{},{index:P}),H)})}))}}],[{key:"getDerivedStateFromProps",value:function(m,g){var _=m.keys,S=g.keyEntities,T=jI(_),R=Sle(S,T);return{keyEntities:R.filter(function(N){var O=S.find(function(A){var M=A.key;return N.key===M});return!(O&&O.status===u1&&N.status===BI)})}}}]),d}(b.Component);return st(o,"defaultProps",{component:"div"}),o}const QV=Rle(qV);function wle(e){const{children:n}=e,[,o]=of(),{motion:s}=o,c=b.useRef(!1);return c.current=c.current||s===!1,c.current?b.createElement(sle,{motion:s},n):n}const Ile=(e,n)=>{const[o,s]=of();return xI({theme:o,token:s,hashId:"",path:["ant-design-icons",e],nonce:()=>n==null?void 0:n.nonce},()=>[{[`.${e}`]:Object.assign(Object.assign({},LV()),{[`.${e} .${e}-icon`]:{display:"block"}})}])},Ale=Ile;var Ole=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const xle=["getTargetContainer","getPopupContainer","renderEmpty","pageHeader","input","pagination","form","select","button"],Nle="ant";let ay,ZV,e$;function g_(){return ay||Nle}function Ple(){return ZV||kO}function Dle(e){return Object.keys(e).some(n=>n.endsWith("Color"))}const kle=e=>{let{prefixCls:n,iconPrefixCls:o,theme:s}=e;n!==void 0&&(ay=n),o!==void 0&&(ZV=o),s&&(Dle(s)?nle(g_(),s):e$=s)},t$=()=>({getPrefixCls:(e,n)=>n||(e?`${g_()}-${e}`:g_()),getIconPrefixCls:Ple,getRootPrefixCls:()=>ay||g_(),getTheme:()=>e$}),Lle=e=>{const{children:n,csp:o,autoInsertSpaceInButton:s,form:c,locale:d,componentSize:p,direction:m,space:g,virtual:_,dropdownMatchSelectWidth:S,popupMatchSelectWidth:T,popupOverflow:R,legacyLocale:N,parentContext:O,iconPrefixCls:A,theme:M,componentDisabled:x}=e,P=b.useCallback((pe,ce)=>{const{prefixCls:se}=e;if(ce)return ce;const ae=se||O.getPrefixCls("");return pe?`${ae}-${pe}`:ae},[O.getPrefixCls,e.prefixCls]),D=A||O.iconPrefixCls||kO,F=D!==O.iconPrefixCls,j=o||O.csp,B=Ale(D,j),H=ole(M,O.theme),K={csp:j,autoInsertSpaceInButton:s,locale:d||N,direction:m,space:g,virtual:_,popupMatchSelectWidth:T??S,popupOverflow:R,getPrefixCls:P,iconPrefixCls:D,theme:H},J=Object.assign({},O);Object.keys(K).forEach(pe=>{K[pe]!==void 0&&(J[pe]=K[pe])}),xle.forEach(pe=>{const ce=e[pe];ce&&(J[pe]=ce)});const q=tS(()=>J,J,(pe,ce)=>{const se=Object.keys(pe),ae=Object.keys(ce);return se.length!==ae.length||se.some(Ee=>pe[Ee]!==ce[Ee])}),Q=b.useMemo(()=>({prefixCls:D,csp:j}),[D,j]);let ee=F?B(n):n;const ne=b.useMemo(()=>{var pe,ce,se;return Ap(((pe=Kp.Form)===null||pe===void 0?void 0:pe.defaultValidateMessages)||{},((se=(ce=q.locale)===null||ce===void 0?void 0:ce.Form)===null||se===void 0?void 0:se.defaultValidateMessages)||{},(c==null?void 0:c.validateMessages)||{})},[q,c==null?void 0:c.validateMessages]);Object.keys(ne).length>0&&(ee=b.createElement(TV.Provider,{value:ne},n)),d&&(ee=b.createElement(pce,{locale:d,_ANT_MARK__:dce},ee)),(D||j)&&(ee=b.createElement(NO.Provider,{value:Q},ee)),p&&(ee=b.createElement(VV,{size:p},ee)),ee=b.createElement(wle,null,ee);const he=b.useMemo(()=>{const pe=H||{},{algorithm:ce,token:se}=pe,ae=Ole(pe,["algorithm","token"]),Ee=ce&&(!Array.isArray(ce)||ce.length>0)?ny(ce):void 0;return Object.assign(Object.assign({},ae),{theme:Ee,token:Object.assign(Object.assign({},Gm),se)})},[H]);return M&&(ee=b.createElement(UV.Provider,{value:he},ee)),x!==void 0&&(ee=b.createElement(BV,{disabled:x},ee)),b.createElement(nr.Provider,{value:q},ee)},sf=e=>{const n=b.useContext(nr),o=b.useContext(PO);return b.createElement(Lle,Object.assign({parentContext:n,legacyLocale:o},e))};sf.ConfigContext=nr;sf.SizeContext=cS;sf.config=kle;sf.useConfig=ile;Object.defineProperty(sf,"SizeContext",{get:()=>cS});var n$={};Object.defineProperty(n$,"__esModule",{value:!0});var Mle={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"},Fle=n$.default=Mle,Ule=1/0,Ble="[object Symbol]",jle=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Vle=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,lS="\\ud800-\\udfff",r$="\\u0300-\\u036f\\ufe20-\\ufe23",i$="\\u20d0-\\u20f0",o$="\\u2700-\\u27bf",a$="a-z\\xdf-\\xf6\\xf8-\\xff",$le="\\xac\\xb1\\xd7\\xf7",Hle="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Wle="\\u2000-\\u206f",zle=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",s$="A-Z\\xc0-\\xd6\\xd8-\\xde",c$="\\ufe0e\\ufe0f",l$=$le+Hle+Wle+zle,MO="[']",Gle="["+lS+"]",R3="["+l$+"]",sy="["+r$+i$+"]",u$="\\d+",Kle="["+o$+"]",d$="["+a$+"]",h$="[^"+lS+l$+u$+o$+a$+s$+"]",VI="\\ud83c[\\udffb-\\udfff]",qle="(?:"+sy+"|"+VI+")",p$="[^"+lS+"]",FO="(?:\\ud83c[\\udde6-\\uddff]){2}",UO="[\\ud800-\\udbff][\\udc00-\\udfff]",pp="["+s$+"]",f$="\\u200d",w3="(?:"+d$+"|"+h$+")",Yle="(?:"+pp+"|"+h$+")",I3="(?:"+MO+"(?:d|ll|m|re|s|t|ve))?",A3="(?:"+MO+"(?:D|LL|M|RE|S|T|VE))?",m$=qle+"?",g$="["+c$+"]?",Xle="(?:"+f$+"(?:"+[p$,FO,UO].join("|")+")"+g$+m$+")*",v$=g$+m$+Xle,Jle="(?:"+[Kle,FO,UO].join("|")+")"+v$,Qle="(?:"+[p$+sy+"?",sy,FO,UO,Gle].join("|")+")",Zle=RegExp(MO,"g"),eue=RegExp(sy,"g"),tue=RegExp(VI+"(?="+VI+")|"+Qle+v$,"g"),nue=RegExp([pp+"?"+d$+"+"+I3+"(?="+[R3,pp,"$"].join("|")+")",Yle+"+"+A3+"(?="+[R3,pp+w3,"$"].join("|")+")",pp+"?"+w3+"+"+I3,pp+"+"+A3,u$,Jle].join("|"),"g"),rue=RegExp("["+f$+lS+r$+i$+c$+"]"),iue=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,oue={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"ss"},aue=typeof Dt=="object"&&Dt&&Dt.Object===Object&&Dt,sue=typeof self=="object"&&self&&self.Object===Object&&self,cue=aue||sue||Function("return this")();function lue(e,n,o,s){var c=-1,d=e?e.length:0;for(s&&d&&(o=e[++c]);++c<d;)o=n(o,e[c],c,e);return o}function uue(e){return e.split("")}function due(e){return e.match(jle)||[]}function hue(e){return function(n){return e==null?void 0:e[n]}}var pue=hue(oue);function E$(e){return rue.test(e)}function fue(e){return iue.test(e)}function mue(e){return E$(e)?gue(e):uue(e)}function gue(e){return e.match(tue)||[]}function vue(e){return e.match(nue)||[]}var Eue=Object.prototype,_ue=Eue.toString,O3=cue.Symbol,x3=O3?O3.prototype:void 0,N3=x3?x3.toString:void 0;function yue(e,n,o){var s=-1,c=e.length;n<0&&(n=-n>c?0:c+n),o=o>c?c:o,o<0&&(o+=c),c=n>o?0:o-n>>>0,n>>>=0;for(var d=Array(c);++s<c;)d[s]=e[s+n];return d}function Sue(e){if(typeof e=="string")return e;if(wue(e))return N3?N3.call(e):"";var n=e+"";return n=="0"&&1/e==-Ule?"-0":n}function Cue(e,n,o){var s=e.length;return o=o===void 0?s:o,!n&&o>=s?e:yue(e,n,o)}function bue(e){return function(n){n=uS(n);var o=E$(n)?mue(n):void 0,s=o?o[0]:n.charAt(0),c=o?Cue(o,1).join(""):n.slice(1);return s[e]()+c}}function Tue(e){return function(n){return lue(Nue(Oue(n).replace(Zle,"")),e,"")}}function Rue(e){return!!e&&typeof e=="object"}function wue(e){return typeof e=="symbol"||Rue(e)&&_ue.call(e)==Ble}function uS(e){return e==null?"":Sue(e)}var Iue=Tue(function(e,n,o){return n=n.toLowerCase(),e+(o?Aue(n):n)});function Aue(e){return xue(uS(e).toLowerCase())}function Oue(e){return e=uS(e),e&&e.replace(Vle,pue).replace(eue,"")}var xue=bue("toUpperCase");function Nue(e,n,o){return e=uS(e),n=o?void 0:n,n===void 0?fue(e)?vue(e):due(e):e.match(n)||[]}var Pue=Iue;const Due=yl(Pue);var Ym={},_$={exports:{}};(function(e){function n(o){return o&&o.__esModule?o:{default:o}}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(_$);var kue=_$.exports,BO={};Object.defineProperty(BO,"__esModule",{value:!0});BO.default=Lue;function Lue(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var jO={};Object.defineProperty(jO,"__esModule",{value:!0});jO.default=Mue;function Mue(e,n){if(!e)return!1;if(e.contains)return e.contains(n);for(var o=n;o;){if(o===e)return!0;o=o.parentNode}return!1}var y$=kue.default;Object.defineProperty(Ym,"__esModule",{value:!0});Ym.clearContainerCache=Wue;Ym.injectCSS=VO;Ym.removeCSS=$ue;var Fue=Ym.updateCSS=zue,Uue=y$(BO),Bue=y$(jO),P3="data-rc-order",D3="data-rc-priority",jue="rc-util-key",cy=new Map;function S$(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.mark;return n?n.startsWith("data-")?n:"data-".concat(n):jue}function dS(e){if(e.attachTo)return e.attachTo;var n=document.querySelector("head");return n||document.body}function Vue(e){return e==="queue"?"prependQueue":e?"prepend":"append"}function C$(e){return Array.from((cy.get(e)||e).children).filter(function(n){return n.tagName==="STYLE"})}function VO(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!(0,Uue.default)())return null;var o=n.csp,s=n.prepend,c=n.priority,d=c===void 0?0:c,p=Vue(s),m=p==="prependQueue",g=document.createElement("style");g.setAttribute(P3,p),m&&d&&g.setAttribute(D3,"".concat(d)),o!=null&&o.nonce&&(g.nonce=o==null?void 0:o.nonce),g.innerHTML=e;var _=dS(n),S=_.firstChild;if(s){if(m){var T=C$(_).filter(function(R){if(!["prepend","prependQueue"].includes(R.getAttribute(P3)))return!1;var N=Number(R.getAttribute(D3)||0);return d>=N});if(T.length)return _.insertBefore(g,T[T.length-1].nextSibling),g}_.insertBefore(g,S)}else _.appendChild(g);return g}function b$(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=dS(n);return C$(o).find(function(s){return s.getAttribute(S$(n))===e})}function $ue(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=b$(e,n);if(o){var s=dS(n);s.removeChild(o)}}function Hue(e,n){var o=cy.get(e);if(!o||!(0,Bue.default)(document,o)){var s=VO("",n),c=s.parentNode;cy.set(e,c),e.removeChild(s)}}function Wue(){cy.clear()}function zue(e,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=dS(o);Hue(s,o);var c=b$(n,o);if(c){var d,p;if((d=o.csp)!==null&&d!==void 0&&d.nonce&&c.nonce!==((p=o.csp)===null||p===void 0?void 0:p.nonce)){var m;c.nonce=(m=o.csp)===null||m===void 0?void 0:m.nonce}return c.innerHTML!==e&&(c.innerHTML=e),c}var g=VO(e,o);return g.setAttribute(S$(o),n),g}var $O={};Object.defineProperty($O,"__esModule",{value:!0});var Gue=$O.getShadowRoot=Kue;$O.inShadow=R$;function T$(e){var n;return e==null||(n=e.getRootNode)===null||n===void 0?void 0:n.call(e)}function R$(e){return T$(e)instanceof ShadowRoot}function Kue(e){return R$(e)?T$(e):null}var oc={};Object.defineProperty(oc,"__esModule",{value:!0});oc.call=HO;var w$=oc.default=void 0;oc.note=O$;oc.noteOnce=N$;oc.preMessage=void 0;oc.resetWarned=x$;oc.warning=A$;oc.warningOnce=Xm;var $I={},I$=function(n){};oc.preMessage=I$;function A$(e,n){}function O$(e,n){}function x$(){$I={}}function HO(e,n,o){!n&&!$I[o]&&(e(!1,o),$I[o]=!0)}function Xm(e,n){HO(A$,e,n)}function N$(e,n){HO(O$,e,n)}Xm.preMessage=I$;Xm.resetWarned=x$;Xm.noteOnce=N$;var que=Xm;w$=oc.default=que;function Yue(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function k3(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){Yue(e,c,o[c])})}return e}function Xue(e,n){w$(e,"[@ant-design/icons] ".concat(n))}function L3(e){return typeof e=="object"&&typeof e.name=="string"&&typeof e.theme=="string"&&(typeof e.icon=="object"||typeof e.icon=="function")}function M3(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(e).reduce(function(n,o){var s=e[o];switch(o){case"class":n.className=s,delete n.class;break;default:delete n[o],n[Due(o)]=s}return n},{})}function HI(e,n,o){return o?Et.createElement(e.tag,k3({key:n},M3(e.attrs),o),(e.children||[]).map(function(s,c){return HI(s,"".concat(n,"-").concat(e.tag,"-").concat(c))})):Et.createElement(e.tag,k3({key:n},M3(e.attrs)),(e.children||[]).map(function(s,c){return HI(s,"".concat(n,"-").concat(e.tag,"-").concat(c))}))}function P$(e){return gl(e)[0]}function D$(e){return e?Array.isArray(e)?e:[e]:[]}var Jue=`
.anticon {
  display: inline-block;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,Que=function(e){var n=b.useContext(NO),o=n.csp,s=n.prefixCls,c=Jue;s&&(c=c.replace(/anticon/g,s)),b.useEffect(function(){var d=e.current,p=Gue(d);Fue(c,"@ant-design-icons",{prepend:!0,csp:o,attachTo:p})},[])};function Zue(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function WI(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){Zue(e,c,o[c])})}return e}function ede(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function F3(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ede(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}function tde(e,n){if(e==null)return{};var o=nde(e,n),s,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)s=d[c],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(o[s]=e[s])}return o}function nde(e,n){if(e==null)return{};var o={},s=Object.keys(e),c,d;for(d=0;d<s.length;d++)c=s[d],!(n.indexOf(c)>=0)&&(o[c]=e[c]);return o}var rm={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function rde(e){var n=e.primaryColor,o=e.secondaryColor;rm.primaryColor=n,rm.secondaryColor=o||P$(n),rm.calculated=!!o}function ide(){return WI({},rm)}var hS=function(e){var n=e.icon,o=e.className,s=e.onClick,c=e.style,d=e.primaryColor,p=e.secondaryColor,m=tde(e,["icon","className","onClick","style","primaryColor","secondaryColor"]),g=b.useRef(),_=rm;if(d&&(_={primaryColor:d,secondaryColor:p||P$(d)}),Que(g),Xue(L3(n),"icon should be icon definiton, but got ".concat(n)),!L3(n))return null;var S=n;return S&&typeof S.icon=="function"&&(S=F3(WI({},S),{icon:S.icon(_.primaryColor,_.secondaryColor)})),HI(S.icon,"svg-".concat(S.name),F3(WI({className:o,onClick:s,style:c,"data-icon":S.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},m),{ref:g}))};hS.displayName="IconReact";hS.getTwoToneColors=ide;hS.setTwoToneColors=rde;const WO=hS;function U3(e,n){(n==null||n>e.length)&&(n=e.length);for(var o=0,s=new Array(n);o<n;o++)s[o]=e[o];return s}function ode(e){if(Array.isArray(e))return e}function ade(e,n){var o=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(o!=null){var s=[],c=!0,d=!1,p,m;try{for(o=o.call(e);!(c=(p=o.next()).done)&&(s.push(p.value),!(n&&s.length===n));c=!0);}catch(g){d=!0,m=g}finally{try{!c&&o.return!=null&&o.return()}finally{if(d)throw m}}return s}}function sde(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function cde(e,n){return ode(e)||ade(e,n)||lde(e,n)||sde()}function lde(e,n){if(e){if(typeof e=="string")return U3(e,n);var o=Object.prototype.toString.call(e).slice(8,-1);if(o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set")return Array.from(o);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return U3(e,n)}}function k$(e){var n=cde(D$(e),2),o=n[0],s=n[1];return WO.setTwoToneColors({primaryColor:o,secondaryColor:s})}function ude(){var e=WO.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor}function B3(e,n){(n==null||n>e.length)&&(n=e.length);for(var o=0,s=new Array(n);o<n;o++)s[o]=e[o];return s}function dde(e){if(Array.isArray(e))return e}function zI(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function hde(e,n){var o=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(o!=null){var s=[],c=!0,d=!1,p,m;try{for(o=o.call(e);!(c=(p=o.next()).done)&&(s.push(p.value),!(n&&s.length===n));c=!0);}catch(g){d=!0,m=g}finally{try{!c&&o.return!=null&&o.return()}finally{if(d)throw m}}return s}}function pde(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fde(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){zI(e,c,o[c])})}return e}function mde(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function gde(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mde(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}function vde(e,n){if(e==null)return{};var o=Ede(e,n),s,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)s=d[c],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(o[s]=e[s])}return o}function Ede(e,n){if(e==null)return{};var o={},s=Object.keys(e),c,d;for(d=0;d<s.length;d++)c=s[d],!(n.indexOf(c)>=0)&&(o[c]=e[c]);return o}function _de(e,n){return dde(e)||hde(e,n)||yde(e,n)||pde()}function yde(e,n){if(e){if(typeof e=="string")return B3(e,n);var o=Object.prototype.toString.call(e).slice(8,-1);if(o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set")return Array.from(o);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return B3(e,n)}}k$(Pce.primary);var pS=b.forwardRef(function(e,n){var o=e.className,s=e.icon,c=e.spin,d=e.rotate,p=e.tabIndex,m=e.onClick,g=e.twoToneColor,_=vde(e,["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"]),S=b.useContext(NO),T=S.prefixCls,R=T===void 0?"anticon":T,N=S.rootClassName,O,A=Ye(N,R,(O={},zI(O,"".concat(R,"-").concat(s.name),!!s.name),zI(O,"".concat(R,"-spin"),!!c||s.name==="loading"),O),o),M=p;M===void 0&&m&&(M=-1);var x=d?{msTransform:"rotate(".concat(d,"deg)"),transform:"rotate(".concat(d,"deg)")}:void 0,P=_de(D$(g),2),D=P[0],F=P[1];return b.createElement("span",gde(fde({role:"img","aria-label":s.name},_),{ref:n,tabIndex:M,onClick:m,className:A}),b.createElement(WO,{icon:s,primaryColor:D,secondaryColor:F,style:x}))});pS.displayName="AntdIcon";pS.getTwoToneColor=ude;pS.setTwoToneColor=k$;const qi=pS;function Sde(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function Cde(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){Sde(e,c,o[c])})}return e}function bde(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Tde(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bde(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var Rde=function(e,n){return b.createElement(qi,Tde(Cde({},e),{ref:n,icon:Fle}))};const L$=b.forwardRef(Rde);var M$={};Object.defineProperty(M$,"__esModule",{value:!0});var wde={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"},Ide=M$.default=wde;function Ade(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function Ode(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){Ade(e,c,o[c])})}return e}function xde(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Nde(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xde(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var Pde=function(e,n){return b.createElement(qi,Nde(Ode({},e),{ref:n,icon:Ide}))};const fS=b.forwardRef(Pde);var F$={};Object.defineProperty(F$,"__esModule",{value:!0});var Dde={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z"}}]},name:"close",theme:"outlined"},kde=F$.default=Dde;function Lde(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function Mde(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){Lde(e,c,o[c])})}return e}function Fde(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Ude(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fde(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var Bde=function(e,n){return b.createElement(qi,Ude(Mde({},e),{ref:n,icon:kde}))};const jde=b.forwardRef(Bde);var U$={};Object.defineProperty(U$,"__esModule",{value:!0});var Vde={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"},$de=U$.default=Vde;function Hde(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function Wde(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){Hde(e,c,o[c])})}return e}function zde(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Gde(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zde(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var Kde=function(e,n){return b.createElement(qi,Gde(Wde({},e),{ref:n,icon:$de}))};const B$=b.forwardRef(Kde);var j$={};Object.defineProperty(j$,"__esModule",{value:!0});var qde={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"info-circle",theme:"filled"},Yde=j$.default=qde;function Xde(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function Jde(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){Xde(e,c,o[c])})}return e}function Qde(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Zde(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qde(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var ehe=function(e,n){return b.createElement(qi,Zde(Jde({},e),{ref:n,icon:Yde}))};const the=b.forwardRef(ehe),{isValidElement:Au}=Md;function V$(e){return e&&Au(e)&&e.type===b.Fragment}function nhe(e,n,o){return Au(e)?b.cloneElement(e,typeof o=="function"?o(e.props||{}):o):n}function tc(e,n){return nhe(e,e,n)}const j3=e=>typeof e=="object"&&e!=null&&e.nodeType===1,V3=(e,n)=>(!n||e!=="hidden")&&e!=="visible"&&e!=="clip",d1=(e,n)=>{if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){const o=getComputedStyle(e,null);return V3(o.overflowY,n)||V3(o.overflowX,n)||(s=>{const c=(d=>{if(!d.ownerDocument||!d.ownerDocument.defaultView)return null;try{return d.ownerDocument.defaultView.frameElement}catch{return null}})(s);return!!c&&(c.clientHeight<s.scrollHeight||c.clientWidth<s.scrollWidth)})(e)}return!1},jE=(e,n,o,s,c,d,p,m)=>d<e&&p>n||d>e&&p<n?0:d<=e&&m<=o||p>=n&&m>=o?d-e-s:p>n&&m<o||d<e&&m>o?p-n+c:0,rhe=e=>{const n=e.parentElement;return n??(e.getRootNode().host||null)},$3=(e,n)=>{var o,s,c,d;if(typeof document>"u")return[];const{scrollMode:p,block:m,inline:g,boundary:_,skipOverflowHiddenElements:S}=n,T=typeof _=="function"?_:ce=>ce!==_;if(!j3(e))throw new TypeError("Invalid target");const R=document.scrollingElement||document.documentElement,N=[];let O=e;for(;j3(O)&&T(O);){if(O=rhe(O),O===R){N.push(O);break}O!=null&&O===document.body&&d1(O)&&!d1(document.documentElement)||O!=null&&d1(O,S)&&N.push(O)}const A=(s=(o=window.visualViewport)==null?void 0:o.width)!=null?s:innerWidth,M=(d=(c=window.visualViewport)==null?void 0:c.height)!=null?d:innerHeight,{scrollX:x,scrollY:P}=window,{height:D,width:F,top:j,right:B,bottom:H,left:K}=e.getBoundingClientRect(),{top:J,right:q,bottom:Q,left:ee}=(ce=>{const se=window.getComputedStyle(ce);return{top:parseFloat(se.scrollMarginTop)||0,right:parseFloat(se.scrollMarginRight)||0,bottom:parseFloat(se.scrollMarginBottom)||0,left:parseFloat(se.scrollMarginLeft)||0}})(e);let ne=m==="start"||m==="nearest"?j-J:m==="end"?H+Q:j+D/2-J+Q,he=g==="center"?K+F/2-ee+q:g==="end"?B+q:K-ee;const pe=[];for(let ce=0;ce<N.length;ce++){const se=N[ce],{height:ae,width:Ee,top:ve,right:le,bottom:de,left:ye}=se.getBoundingClientRect();if(p==="if-needed"&&j>=0&&K>=0&&H<=M&&B<=A&&j>=ve&&H<=de&&K>=ye&&B<=le)return pe;const fe=getComputedStyle(se),ke=parseInt(fe.borderLeftWidth,10),Me=parseInt(fe.borderTopWidth,10),Ve=parseInt(fe.borderRightWidth,10),je=parseInt(fe.borderBottomWidth,10);let dt=0,ut=0;const Ct="offsetWidth"in se?se.offsetWidth-se.clientWidth-ke-Ve:0,_t="offsetHeight"in se?se.offsetHeight-se.clientHeight-Me-je:0,Tt="offsetWidth"in se?se.offsetWidth===0?0:Ee/se.offsetWidth:0,it="offsetHeight"in se?se.offsetHeight===0?0:ae/se.offsetHeight:0;if(R===se)dt=m==="start"?ne:m==="end"?ne-M:m==="nearest"?jE(P,P+M,M,Me,je,P+ne,P+ne+D,D):ne-M/2,ut=g==="start"?he:g==="center"?he-A/2:g==="end"?he-A:jE(x,x+A,A,ke,Ve,x+he,x+he+F,F),dt=Math.max(0,dt+P),ut=Math.max(0,ut+x);else{dt=m==="start"?ne-ve-Me:m==="end"?ne-de+je+_t:m==="nearest"?jE(ve,de,ae,Me,je+_t,ne,ne+D,D):ne-(ve+ae/2)+_t/2,ut=g==="start"?he-ye-ke:g==="center"?he-(ye+Ee/2)+Ct/2:g==="end"?he-le+Ve+Ct:jE(ye,le,Ee,ke,Ve+Ct,he,he+F,F);const{scrollLeft:kt,scrollTop:qt}=se;dt=it===0?0:Math.max(0,Math.min(qt+dt/it,se.scrollHeight-ae/it+_t)),ut=Tt===0?0:Math.max(0,Math.min(kt+ut/Tt,se.scrollWidth-Ee/Tt+Ct)),ne+=qt-dt,he+=kt-ut}pe.push({el:se,top:dt,left:ut})}return pe},ihe=e=>e===!1?{block:"end",inline:"nearest"}:(n=>n===Object(n)&&Object.keys(n).length!==0)(e)?e:{block:"start",inline:"nearest"};function ohe(e,n){if(!e.isConnected||!(c=>{let d=c;for(;d&&d.parentNode;){if(d.parentNode===document)return!0;d=d.parentNode instanceof ShadowRoot?d.parentNode.host:d.parentNode}return!1})(e))return;const o=(c=>{const d=window.getComputedStyle(c);return{top:parseFloat(d.scrollMarginTop)||0,right:parseFloat(d.scrollMarginRight)||0,bottom:parseFloat(d.scrollMarginBottom)||0,left:parseFloat(d.scrollMarginLeft)||0}})(e);if((c=>typeof c=="object"&&typeof c.behavior=="function")(n))return n.behavior($3(e,n));const s=typeof n=="boolean"||n==null?void 0:n.behavior;for(const{el:c,top:d,left:p}of $3(e,ihe(n))){const m=d-o.top+o.bottom,g=p-o.left+o.right;c.scroll({top:m,left:g,behavior:s})}}var St={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(n){var o=n.keyCode;if(n.altKey&&!n.ctrlKey||n.metaKey||o>=St.F1&&o<=St.F12)return!1;switch(o){case St.ALT:case St.CAPS_LOCK:case St.CONTEXT_MENU:case St.CTRL:case St.DOWN:case St.END:case St.ESC:case St.HOME:case St.INSERT:case St.LEFT:case St.MAC_FF_META:case St.META:case St.NUMLOCK:case St.NUM_CENTER:case St.PAGE_DOWN:case St.PAGE_UP:case St.PAUSE:case St.PRINT_SCREEN:case St.RIGHT:case St.SHIFT:case St.UP:case St.WIN_KEY:case St.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(n){if(n>=St.ZERO&&n<=St.NINE||n>=St.NUM_ZERO&&n<=St.NUM_MULTIPLY||n>=St.A&&n<=St.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&n===0)return!0;switch(n){case St.SPACE:case St.QUESTION_MARK:case St.NUM_PLUS:case St.NUM_MINUS:case St.NUM_PERIOD:case St.NUM_DIVISION:case St.SEMICOLON:case St.DASH:case St.EQUALS:case St.COMMA:case St.PERIOD:case St.SLASH:case St.APOSTROPHE:case St.SINGLE_QUOTE:case St.OPEN_SQUARE_BRACKET:case St.BACKSLASH:case St.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},ahe=b.forwardRef(function(e,n){var o=e.prefixCls,s=e.style,c=e.className,d=e.duration,p=d===void 0?4.5:d,m=e.eventKey,g=e.content,_=e.closable,S=e.closeIcon,T=S===void 0?"x":S,R=e.props,N=e.onClick,O=e.onNoticeClose,A=e.times,M=b.useState(!1),x=We(M,2),P=x[0],D=x[1],F=function(){O(m)},j=function(K){(K.key==="Enter"||K.code==="Enter"||K.keyCode===St.ENTER)&&F()};b.useEffect(function(){if(!P&&p>0){var H=setTimeout(function(){F()},p*1e3);return function(){clearTimeout(H)}}},[p,P,A]);var B="".concat(o,"-notice");return b.createElement("div",Qe({},R,{ref:n,className:Ye(B,c,st({},"".concat(B,"-closable"),_)),style:s,onMouseEnter:function(){D(!0)},onMouseLeave:function(){D(!1)},onClick:N}),b.createElement("div",{className:"".concat(B,"-content")},g),_&&b.createElement("a",{tabIndex:0,className:"".concat(B,"-close"),onKeyDown:j,onClick:function(K){K.preventDefault(),K.stopPropagation(),F()}},T))});const $$=ahe;var she=b.forwardRef(function(e,n){var o=e.prefixCls,s=o===void 0?"rc-notification":o,c=e.container,d=e.motion,p=e.maxCount,m=e.className,g=e.style,_=e.onAllRemoved,S=b.useState([]),T=We(S,2),R=T[0],N=T[1],O=function(H){var K,J=R.find(function(q){return q.key===H});J==null||(K=J.onClose)===null||K===void 0||K.call(J),N(function(q){return q.filter(function(Q){return Q.key!==H})})};b.useImperativeHandle(n,function(){return{open:function(H){N(function(K){var J=ot(K),q=J.findIndex(function(ne){return ne.key===H.key}),Q=Ae({},H);if(q>=0){var ee;Q.times=(((ee=K[q])===null||ee===void 0?void 0:ee.times)||0)+1,J[q]=Q}else Q.times=0,J.push(Q);return p>0&&J.length>p&&(J=J.slice(-p)),J})},close:function(H){O(H)},destroy:function(){N([])}}});var A=b.useState({}),M=We(A,2),x=M[0],P=M[1];b.useEffect(function(){var B={};R.forEach(function(H){var K=H.placement,J=K===void 0?"topRight":K;J&&(B[J]=B[J]||[],B[J].push(H))}),Object.keys(x).forEach(function(H){B[H]=B[H]||[]}),P(B)},[R]);var D=function(H){P(function(K){var J=Ae({},K),q=J[H]||[];return q.length||delete J[H],J})},F=b.useRef(!1);if(b.useEffect(function(){Object.keys(x).length>0?F.current=!0:F.current&&(_==null||_(),F.current=!1)},[x]),!c)return null;var j=Object.keys(x);return Cl.createPortal(b.createElement(b.Fragment,null,j.map(function(B){var H=x[B],K=H.map(function(q){return{config:q,key:q.key}}),J=typeof d=="function"?d(B):d;return b.createElement(QV,Qe({key:B,className:Ye(s,"".concat(s,"-").concat(B),m==null?void 0:m(B)),style:g==null?void 0:g(B),keys:K,motionAppear:!0},J,{onAllRemoved:function(){D(B)}}),function(q,Q){var ee=q.config,ne=q.className,he=q.style,pe=ee.key,ce=ee.times,se=ee.className,ae=ee.style;return b.createElement($$,Qe({},ee,{ref:Q,prefixCls:s,className:Ye(ne,se),style:Ae(Ae({},he),ae),times:ce,key:pe,eventKey:pe,onNoticeClose:O}))})})),c)}),che=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved"],lhe=function(){return document.body},H3=0;function uhe(){for(var e={},n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return o.forEach(function(c){c&&Object.keys(c).forEach(function(d){var p=c[d];p!==void 0&&(e[d]=p)})}),e}function dhe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.getContainer,o=n===void 0?lhe:n,s=e.motion,c=e.prefixCls,d=e.maxCount,p=e.className,m=e.style,g=e.onAllRemoved,_=xn(e,che),S=b.useState(),T=We(S,2),R=T[0],N=T[1],O=b.useRef(),A=b.createElement(she,{container:R,ref:O,prefixCls:c,motion:s,maxCount:d,className:p,style:m,onAllRemoved:g}),M=b.useState([]),x=We(M,2),P=x[0],D=x[1],F=b.useMemo(function(){return{open:function(B){var H=uhe(_,B);(H.key===null||H.key===void 0)&&(H.key="rc-notification-".concat(H3),H3+=1),D(function(K){return[].concat(ot(K),[{type:"open",config:H}])})},close:function(B){D(function(H){return[].concat(ot(H),[{type:"close",key:B}])})},destroy:function(){D(function(B){return[].concat(ot(B),[{type:"destroy"}])})}}},[]);return b.useEffect(function(){N(o())}),b.useEffect(function(){O.current&&P.length&&(P.forEach(function(j){switch(j.type){case"open":O.current.open(j.config);break;case"close":O.current.close(j.key);break;case"destroy":O.current.destroy();break}}),D(function(j){return j.filter(function(B){return!P.includes(B)})}))},[P]),[F,A]}var H$={};Object.defineProperty(H$,"__esModule",{value:!0});var hhe={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"},phe=H$.default=hhe;function fhe(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function mhe(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){fhe(e,c,o[c])})}return e}function ghe(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function vhe(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ghe(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var Ehe=function(e,n){return b.createElement(qi,vhe(mhe({},e),{ref:n,icon:phe}))};const W$=b.forwardRef(Ehe);function Ga(){Ga=function(){return n};var e,n={},o=Object.prototype,s=o.hasOwnProperty,c=Object.defineProperty||function(ce,se,ae){ce[se]=ae.value},d=typeof Symbol=="function"?Symbol:{},p=d.iterator||"@@iterator",m=d.asyncIterator||"@@asyncIterator",g=d.toStringTag||"@@toStringTag";function _(ce,se,ae){return Object.defineProperty(ce,se,{value:ae,enumerable:!0,configurable:!0,writable:!0}),ce[se]}try{_({},"")}catch{_=function(ae,Ee,ve){return ae[Ee]=ve}}function S(ce,se,ae,Ee){var ve=se&&se.prototype instanceof x?se:x,le=Object.create(ve.prototype),de=new he(Ee||[]);return c(le,"_invoke",{value:q(ce,ae,de)}),le}function T(ce,se,ae){try{return{type:"normal",arg:ce.call(se,ae)}}catch(Ee){return{type:"throw",arg:Ee}}}n.wrap=S;var R="suspendedStart",N="suspendedYield",O="executing",A="completed",M={};function x(){}function P(){}function D(){}var F={};_(F,p,function(){return this});var j=Object.getPrototypeOf,B=j&&j(j(pe([])));B&&B!==o&&s.call(B,p)&&(F=B);var H=D.prototype=x.prototype=Object.create(F);function K(ce){["next","throw","return"].forEach(function(se){_(ce,se,function(ae){return this._invoke(se,ae)})})}function J(ce,se){function ae(ve,le,de,ye){var fe=T(ce[ve],ce,le);if(fe.type!=="throw"){var ke=fe.arg,Me=ke.value;return Me&&jn(Me)=="object"&&s.call(Me,"__await")?se.resolve(Me.__await).then(function(Ve){ae("next",Ve,de,ye)},function(Ve){ae("throw",Ve,de,ye)}):se.resolve(Me).then(function(Ve){ke.value=Ve,de(ke)},function(Ve){return ae("throw",Ve,de,ye)})}ye(fe.arg)}var Ee;c(this,"_invoke",{value:function(le,de){function ye(){return new se(function(fe,ke){ae(le,de,fe,ke)})}return Ee=Ee?Ee.then(ye,ye):ye()}})}function q(ce,se,ae){var Ee=R;return function(ve,le){if(Ee===O)throw new Error("Generator is already running");if(Ee===A){if(ve==="throw")throw le;return{value:e,done:!0}}for(ae.method=ve,ae.arg=le;;){var de=ae.delegate;if(de){var ye=Q(de,ae);if(ye){if(ye===M)continue;return ye}}if(ae.method==="next")ae.sent=ae._sent=ae.arg;else if(ae.method==="throw"){if(Ee===R)throw Ee=A,ae.arg;ae.dispatchException(ae.arg)}else ae.method==="return"&&ae.abrupt("return",ae.arg);Ee=O;var fe=T(ce,se,ae);if(fe.type==="normal"){if(Ee=ae.done?A:N,fe.arg===M)continue;return{value:fe.arg,done:ae.done}}fe.type==="throw"&&(Ee=A,ae.method="throw",ae.arg=fe.arg)}}}function Q(ce,se){var ae=se.method,Ee=ce.iterator[ae];if(Ee===e)return se.delegate=null,ae==="throw"&&ce.iterator.return&&(se.method="return",se.arg=e,Q(ce,se),se.method==="throw")||ae!=="return"&&(se.method="throw",se.arg=new TypeError("The iterator does not provide a '"+ae+"' method")),M;var ve=T(Ee,ce.iterator,se.arg);if(ve.type==="throw")return se.method="throw",se.arg=ve.arg,se.delegate=null,M;var le=ve.arg;return le?le.done?(se[ce.resultName]=le.value,se.next=ce.nextLoc,se.method!=="return"&&(se.method="next",se.arg=e),se.delegate=null,M):le:(se.method="throw",se.arg=new TypeError("iterator result is not an object"),se.delegate=null,M)}function ee(ce){var se={tryLoc:ce[0]};1 in ce&&(se.catchLoc=ce[1]),2 in ce&&(se.finallyLoc=ce[2],se.afterLoc=ce[3]),this.tryEntries.push(se)}function ne(ce){var se=ce.completion||{};se.type="normal",delete se.arg,ce.completion=se}function he(ce){this.tryEntries=[{tryLoc:"root"}],ce.forEach(ee,this),this.reset(!0)}function pe(ce){if(ce||ce===""){var se=ce[p];if(se)return se.call(ce);if(typeof ce.next=="function")return ce;if(!isNaN(ce.length)){var ae=-1,Ee=function ve(){for(;++ae<ce.length;)if(s.call(ce,ae))return ve.value=ce[ae],ve.done=!1,ve;return ve.value=e,ve.done=!0,ve};return Ee.next=Ee}}throw new TypeError(jn(ce)+" is not iterable")}return P.prototype=D,c(H,"constructor",{value:D,configurable:!0}),c(D,"constructor",{value:P,configurable:!0}),P.displayName=_(D,g,"GeneratorFunction"),n.isGeneratorFunction=function(ce){var se=typeof ce=="function"&&ce.constructor;return!!se&&(se===P||(se.displayName||se.name)==="GeneratorFunction")},n.mark=function(ce){return Object.setPrototypeOf?Object.setPrototypeOf(ce,D):(ce.__proto__=D,_(ce,g,"GeneratorFunction")),ce.prototype=Object.create(H),ce},n.awrap=function(ce){return{__await:ce}},K(J.prototype),_(J.prototype,m,function(){return this}),n.AsyncIterator=J,n.async=function(ce,se,ae,Ee,ve){ve===void 0&&(ve=Promise);var le=new J(S(ce,se,ae,Ee),ve);return n.isGeneratorFunction(se)?le:le.next().then(function(de){return de.done?de.value:le.next()})},K(H),_(H,g,"Generator"),_(H,p,function(){return this}),_(H,"toString",function(){return"[object Generator]"}),n.keys=function(ce){var se=Object(ce),ae=[];for(var Ee in se)ae.push(Ee);return ae.reverse(),function ve(){for(;ae.length;){var le=ae.pop();if(le in se)return ve.value=le,ve.done=!1,ve}return ve.done=!0,ve}},n.values=pe,he.prototype={constructor:he,reset:function(se){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(ne),!se)for(var ae in this)ae.charAt(0)==="t"&&s.call(this,ae)&&!isNaN(+ae.slice(1))&&(this[ae]=e)},stop:function(){this.done=!0;var se=this.tryEntries[0].completion;if(se.type==="throw")throw se.arg;return this.rval},dispatchException:function(se){if(this.done)throw se;var ae=this;function Ee(ke,Me){return de.type="throw",de.arg=se,ae.next=ke,Me&&(ae.method="next",ae.arg=e),!!Me}for(var ve=this.tryEntries.length-1;ve>=0;--ve){var le=this.tryEntries[ve],de=le.completion;if(le.tryLoc==="root")return Ee("end");if(le.tryLoc<=this.prev){var ye=s.call(le,"catchLoc"),fe=s.call(le,"finallyLoc");if(ye&&fe){if(this.prev<le.catchLoc)return Ee(le.catchLoc,!0);if(this.prev<le.finallyLoc)return Ee(le.finallyLoc)}else if(ye){if(this.prev<le.catchLoc)return Ee(le.catchLoc,!0)}else{if(!fe)throw new Error("try statement without catch or finally");if(this.prev<le.finallyLoc)return Ee(le.finallyLoc)}}}},abrupt:function(se,ae){for(var Ee=this.tryEntries.length-1;Ee>=0;--Ee){var ve=this.tryEntries[Ee];if(ve.tryLoc<=this.prev&&s.call(ve,"finallyLoc")&&this.prev<ve.finallyLoc){var le=ve;break}}le&&(se==="break"||se==="continue")&&le.tryLoc<=ae&&ae<=le.finallyLoc&&(le=null);var de=le?le.completion:{};return de.type=se,de.arg=ae,le?(this.method="next",this.next=le.finallyLoc,M):this.complete(de)},complete:function(se,ae){if(se.type==="throw")throw se.arg;return se.type==="break"||se.type==="continue"?this.next=se.arg:se.type==="return"?(this.rval=this.arg=se.arg,this.method="return",this.next="end"):se.type==="normal"&&ae&&(this.next=ae),M},finish:function(se){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var Ee=this.tryEntries[ae];if(Ee.finallyLoc===se)return this.complete(Ee.completion,Ee.afterLoc),ne(Ee),M}},catch:function(se){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var Ee=this.tryEntries[ae];if(Ee.tryLoc===se){var ve=Ee.completion;if(ve.type==="throw"){var le=ve.arg;ne(Ee)}return le}}throw new Error("illegal catch attempt")},delegateYield:function(se,ae,Ee){return this.delegate={iterator:pe(se),resultName:ae,nextLoc:Ee},this.method==="next"&&(this.arg=e),M}},n}function W3(e,n,o,s,c,d,p){try{var m=e[d](p),g=m.value}catch(_){o(_);return}m.done?n(g):Promise.resolve(g).then(s,c)}function cf(e){return function(){var n=this,o=arguments;return new Promise(function(s,c){var d=e.apply(n,o);function p(g){W3(d,s,c,p,m,"next",g)}function m(g){W3(d,s,c,p,m,"throw",g)}p(void 0)})}}var Jm=Ae({},goe),_he=Jm.version,yhe=Jm.render,She=Jm.unmountComponentAtNode,mS;try{var Che=Number((_he||"").split(".")[0]);Che>=18&&(mS=Jm.createRoot)}catch{}function z3(e){var n=Jm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;n&&jn(n)==="object"&&(n.usingClientEntryPoint=e)}var ly="__rc_react_root__";function bhe(e,n){z3(!0);var o=n[ly]||mS(n);z3(!1),o.render(e),n[ly]=o}function The(e,n){yhe(e,n)}function z$(e,n){if(mS){bhe(e,n);return}The(e,n)}function Rhe(e){return GI.apply(this,arguments)}function GI(){return GI=cf(Ga().mark(function e(n){return Ga().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",Promise.resolve().then(function(){var c;(c=n[ly])===null||c===void 0||c.unmount(),delete n[ly]}));case 1:case"end":return s.stop()}},e)})),GI.apply(this,arguments)}function whe(e){She(e)}function Ihe(e){return KI.apply(this,arguments)}function KI(){return KI=cf(Ga().mark(function e(n){return Ga().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(mS===void 0){s.next=2;break}return s.abrupt("return",Rhe(n));case 2:whe(n);case 3:case"end":return s.stop()}},e)})),KI.apply(this,arguments)}const gS=function(e){if(!e)return!1;if(e instanceof Element){if(e.offsetParent)return!0;if(e.getBBox){var n=e.getBBox(),o=n.width,s=n.height;if(o||s)return!0}if(e.getBoundingClientRect){var c=e.getBoundingClientRect(),d=c.width,p=c.height;if(d||p)return!0}}return!1},Ahe=e=>{const{componentCls:n,colorPrimary:o}=e;return{[n]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${o})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${e.motionEaseOutCirc}`,`opacity 2s ${e.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0}}}}},Ohe=ic("Wave",e=>[Ahe(e)]);function xhe(e){const n=(e||"").match(/rgba?\((\d*), (\d*), (\d*)(, [\d.]*)?\)/);return n&&n[1]&&n[2]&&n[3]?!(n[1]===n[2]&&n[2]===n[3]):!0}function h1(e){return e&&e!=="#fff"&&e!=="#ffffff"&&e!=="rgb(255, 255, 255)"&&e!=="rgba(255, 255, 255, 1)"&&xhe(e)&&!/rgba\((?:\d*, ){3}0\)/.test(e)&&e!=="transparent"}function Nhe(e){const{borderTopColor:n,borderColor:o,backgroundColor:s}=getComputedStyle(e);return h1(n)?n:h1(o)?o:h1(s)?s:null}function p1(e){return Number.isNaN(e)?0:e}const Phe=e=>{const{className:n,target:o}=e,s=b.useRef(null),[c,d]=b.useState(null),[p,m]=b.useState([]),[g,_]=b.useState(0),[S,T]=b.useState(0),[R,N]=b.useState(0),[O,A]=b.useState(0),[M,x]=b.useState(!1),P={left:g,top:S,width:R,height:O,borderRadius:p.map(F=>`${F}px`).join(" ")};c&&(P["--wave-color"]=c);function D(){const F=getComputedStyle(o);d(Nhe(o));const j=F.position==="static",{borderLeftWidth:B,borderTopWidth:H}=F;_(j?o.offsetLeft:p1(-parseFloat(B))),T(j?o.offsetTop:p1(-parseFloat(H))),N(o.offsetWidth),A(o.offsetHeight);const{borderTopLeftRadius:K,borderTopRightRadius:J,borderBottomLeftRadius:q,borderBottomRightRadius:Q}=F;m([K,J,Q,q].map(ee=>p1(parseFloat(ee))))}return b.useEffect(()=>{if(o){const F=ao(()=>{D(),x(!0)});let j;return typeof ResizeObserver<"u"&&(j=new ResizeObserver(D),j.observe(o)),()=>{ao.cancel(F),j==null||j.disconnect()}}},[]),M?b.createElement(qd,{visible:!0,motionAppear:!0,motionName:"wave-motion",motionDeadline:5e3,onAppearEnd:(F,j)=>{var B;if(j.deadline||j.propertyName==="opacity"){const H=(B=s.current)===null||B===void 0?void 0:B.parentElement;Ihe(H).then(()=>{H==null||H.remove()})}return!1}},F=>{let{className:j}=F;return b.createElement("div",{ref:s,className:Ye(n,j),style:P})}):null};function Dhe(e,n){const o=document.createElement("div");o.style.position="absolute",o.style.left="0px",o.style.top="0px",e==null||e.insertBefore(o,e==null?void 0:e.firstChild),z$(b.createElement(Phe,{target:e,className:n}),o)}function khe(e,n){function o(){const s=e.current;Dhe(s,n)}return o}const Lhe=e=>{const{children:n,disabled:o}=e,{getPrefixCls:s}=b.useContext(nr),c=b.useRef(null),d=s("wave"),[,p]=Ohe(d),m=khe(c,Ye(d,p));if(Et.useEffect(()=>{const _=c.current;if(!_||_.nodeType!==1||o)return;const S=T=>{T.target.tagName==="INPUT"||!gS(T.target)||!_.getAttribute||_.getAttribute("disabled")||_.disabled||_.className.includes("disabled")||_.className.includes("-leave")||m()};return _.addEventListener("click",S,!0),()=>{_.removeEventListener("click",S,!0)}},[o]),!Et.isValidElement(n))return n??null;const g=nf(n)?Uc(n.ref,c):c;return tc(n,{ref:g})},Mhe=Lhe;globalThis&&globalThis.__rest;const G$=b.createContext(null),zO=(e,n)=>{const o=b.useContext(G$),s=b.useMemo(()=>{if(!o)return"";const{compactDirection:c,isFirstItem:d,isLastItem:p}=o,m=c==="vertical"?"-vertical-":"-";return Ye({[`${e}-compact${m}item`]:!0,[`${e}-compact${m}first-item`]:d,[`${e}-compact${m}last-item`]:p,[`${e}-compact${m}item-rtl`]:n==="rtl"})},[e,n,o]);return{compactSize:o==null?void 0:o.compactSize,compactDirection:o==null?void 0:o.compactDirection,compactItemClassnames:s}},qI=e=>{let{children:n}=e;return b.createElement(G$.Provider,{value:null},n)},Fhe=b.forwardRef((e,n)=>{const{className:o,style:s,children:c,prefixCls:d}=e,p=Ye(`${d}-icon`,o);return Et.createElement("span",{ref:n,className:p,style:s},c)}),K$=Fhe,G3=b.forwardRef((e,n)=>{let{prefixCls:o,className:s,style:c,iconClassName:d}=e;const p=Ye(`${o}-loading-icon`,s);return Et.createElement(K$,{prefixCls:o,className:p,style:c,ref:n},Et.createElement(W$,{className:d}))}),f1=()=>({width:0,opacity:0,transform:"scale(0)"}),m1=e=>({width:e.scrollWidth,opacity:1,transform:"scale(1)"}),Uhe=e=>{let{prefixCls:n,loading:o,existIcon:s,className:c,style:d}=e;const p=!!o;return s?Et.createElement(G3,{prefixCls:n,className:c,style:d}):Et.createElement(qd,{visible:p,motionName:`${n}-loading-icon-motion`,removeOnLeave:!0,onAppearStart:f1,onAppearActive:m1,onEnterStart:f1,onEnterActive:m1,onLeaveStart:m1,onLeaveActive:f1},(m,g)=>{let{className:_,style:S}=m;return Et.createElement(G3,{prefixCls:n,className:c,style:Object.assign(Object.assign({},d),S),ref:g,iconClassName:_})})},Bhe=Uhe;var jhe=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const q$=b.createContext(void 0),Vhe=e=>{const{getPrefixCls:n,direction:o}=b.useContext(nr),{prefixCls:s,size:c,className:d}=e,p=jhe(e,["prefixCls","size","className"]),m=n("btn-group",s),[,,g]=of();let _="";switch(c){case"large":_="lg";break;case"small":_="sm";break}const S=Ye(m,{[`${m}-${_}`]:_,[`${m}-rtl`]:o==="rtl"},d,g);return b.createElement(q$.Provider,{value:c},b.createElement("div",Object.assign({},p,{className:S})))},$he=Vhe,K3=/^[\u4e00-\u9fa5]{2}$/,YI=K3.test.bind(K3);function Hhe(e){return typeof e=="string"}function g1(e){return e==="text"||e==="link"}function Whe(e,n){if(e==null)return;const o=n?" ":"";return typeof e!="string"&&typeof e!="number"&&Hhe(e.type)&&YI(e.props.children)?tc(e,{children:e.props.children.split("").join(o)}):typeof e=="string"?YI(e)?Et.createElement("span",null,e.split("").join(o)):Et.createElement("span",null,e):V$(e)?Et.createElement("span",null,e):e}function zhe(e,n){let o=!1;const s=[];return Et.Children.forEach(e,c=>{const d=typeof c,p=d==="string"||d==="number";if(o&&p){const m=s.length-1,g=s[m];s[m]=`${g}${c}`}else s.push(c);o=p}),Et.Children.map(s,c=>Whe(c,n))}function Ghe(e,n,o){const{focusElCls:s,focus:c,borderElCls:d}=o,p=d?"> *":"",m=["hover",c?"focus":null,"active"].filter(Boolean).map(g=>`&:${g} ${p}`).join(",");return{[`&-item:not(${n}-last-item)`]:{marginInlineEnd:-e.lineWidth},"&-item":Object.assign(Object.assign({[m]:{zIndex:2}},s?{[`&${s}`]:{zIndex:2}}:{}),{[`&[disabled] ${p}`]:{zIndex:0}})}}function Khe(e,n,o){const{borderElCls:s}=o,c=s?`> ${s}`:"";return{[`&-item:not(${n}-first-item):not(${n}-last-item) ${c}`]:{borderRadius:0},[`&-item:not(${n}-last-item)${n}-first-item`]:{[`& ${c}, &${e}-sm ${c}, &${e}-lg ${c}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${n}-first-item)${n}-last-item`]:{[`& ${c}, &${e}-sm ${c}, &${e}-lg ${c}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function Y$(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{focus:!0};const{componentCls:o}=e,s=`${o}-compact`;return{[s]:Object.assign(Object.assign({},Ghe(e,s,n)),Khe(o,s,n))}}function qhe(e,n){return{[`&-item:not(${n}-last-item)`]:{marginBottom:-e.lineWidth},"&-item":{"&:hover,&:focus,&:active":{zIndex:2},"&[disabled]":{zIndex:0}}}}function Yhe(e,n){return{[`&-item:not(${n}-first-item):not(${n}-last-item)`]:{borderRadius:0},[`&-item${n}-first-item:not(${n}-last-item)`]:{[`&, &${e}-sm, &${e}-lg`]:{borderEndEndRadius:0,borderEndStartRadius:0}},[`&-item${n}-last-item:not(${n}-first-item)`]:{[`&, &${e}-sm, &${e}-lg`]:{borderStartStartRadius:0,borderStartEndRadius:0}}}}function Xhe(e){const n=`${e.componentCls}-compact-vertical`;return{[n]:Object.assign(Object.assign({},qhe(e,n)),Yhe(e.componentCls,n))}}const q3=(e,n)=>({[`> span, > ${e}`]:{"&:not(:last-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineEndColor:n}}},"&:not(:first-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineStartColor:n}}}}}),Jhe=e=>{const{componentCls:n,fontSize:o,lineWidth:s,colorPrimaryHover:c,colorErrorHover:d}=e;return{[`${n}-group`]:[{position:"relative",display:"inline-flex",[`> span, > ${n}`]:{"&:not(:last-child)":{[`&, & > ${n}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},"&:not(:first-child)":{marginInlineStart:-s,[`&, & > ${n}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}},[n]:{position:"relative",zIndex:1,"&:hover,\n          &:focus,\n          &:active":{zIndex:2},"&[disabled]":{zIndex:0}},[`${n}-icon-only`]:{fontSize:o}},q3(`${n}-primary`,c),q3(`${n}-danger`,d)]}},Qhe=Jhe,Zhe=e=>{const{componentCls:n,iconCls:o,buttonFontWeight:s}=e;return{[n]:{outline:"none",position:"relative",display:"inline-block",fontWeight:s,whiteSpace:"nowrap",textAlign:"center",backgroundImage:"none",backgroundColor:"transparent",border:`${e.lineWidth}px ${e.lineType} transparent`,cursor:"pointer",transition:`all ${e.motionDurationMid} ${e.motionEaseInOut}`,userSelect:"none",touchAction:"manipulation",lineHeight:e.lineHeight,color:e.colorText,"&:disabled > *":{pointerEvents:"none"},"> span":{display:"inline-block"},[`${n}-icon`]:{lineHeight:0},[`> ${o} + span, > span + ${o}`]:{marginInlineStart:e.marginXS},[`&:not(${n}-icon-only) > ${n}-icon`]:{[`&${n}-loading-icon, &:not(:last-child)`]:{marginInlineEnd:e.marginXS}},"> a":{color:"currentColor"},"&:not(:disabled)":Object.assign({},Yce(e)),[`&-icon-only${n}-compact-item`]:{flex:"none"},[`&-compact-item${n}-primary`]:{[`&:not([disabled]) + ${n}-compact-item${n}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:-e.lineWidth,insetInlineStart:-e.lineWidth,display:"inline-block",width:e.lineWidth,height:`calc(100% + ${e.lineWidth*2}px)`,backgroundColor:e.colorPrimaryHover,content:'""'}}},"&-compact-vertical-item":{[`&${n}-primary`]:{[`&:not([disabled]) + ${n}-compact-vertical-item${n}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:-e.lineWidth,insetInlineStart:-e.lineWidth,display:"inline-block",width:`calc(100% + ${e.lineWidth*2}px)`,height:e.lineWidth,backgroundColor:e.colorPrimaryHover,content:'""'}}}}}}},vl=(e,n,o)=>({[`&:not(:disabled):not(${e}-disabled)`]:{"&:hover":n,"&:active":o}}),epe=e=>({minWidth:e.controlHeight,paddingInlineStart:0,paddingInlineEnd:0,borderRadius:"50%"}),tpe=e=>({borderRadius:e.controlHeight,paddingInlineStart:e.controlHeight/2,paddingInlineEnd:e.controlHeight/2}),npe=e=>({cursor:"not-allowed",borderColor:e.colorBorder,color:e.colorTextDisabled,backgroundColor:e.colorBgContainerDisabled,boxShadow:"none"}),uy=(e,n,o,s,c,d,p)=>({[`&${e}-background-ghost`]:Object.assign(Object.assign({color:n||void 0,backgroundColor:"transparent",borderColor:o||void 0,boxShadow:"none"},vl(e,Object.assign({backgroundColor:"transparent"},d),Object.assign({backgroundColor:"transparent"},p))),{"&:disabled":{cursor:"not-allowed",color:s||void 0,borderColor:c||void 0}})}),GO=e=>({[`&:disabled, &${e.componentCls}-disabled`]:Object.assign({},npe(e))}),X$=e=>Object.assign({},GO(e)),dy=e=>({[`&:disabled, &${e.componentCls}-disabled`]:{cursor:"not-allowed",color:e.colorTextDisabled}}),J$=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},X$(e)),{backgroundColor:e.colorBgContainer,borderColor:e.colorBorder,boxShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlTmpOutline}`}),vl(e.componentCls,{color:e.colorPrimaryHover,borderColor:e.colorPrimaryHover},{color:e.colorPrimaryActive,borderColor:e.colorPrimaryActive})),uy(e.componentCls,e.colorBgContainer,e.colorBgContainer,e.colorTextDisabled,e.colorBorder)),{[`&${e.componentCls}-dangerous`]:Object.assign(Object.assign(Object.assign({color:e.colorError,borderColor:e.colorError},vl(e.componentCls,{color:e.colorErrorHover,borderColor:e.colorErrorBorderHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),uy(e.componentCls,e.colorError,e.colorError,e.colorTextDisabled,e.colorBorder)),GO(e))}),rpe=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},X$(e)),{color:e.colorTextLightSolid,backgroundColor:e.colorPrimary,boxShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlOutline}`}),vl(e.componentCls,{color:e.colorTextLightSolid,backgroundColor:e.colorPrimaryHover},{color:e.colorTextLightSolid,backgroundColor:e.colorPrimaryActive})),uy(e.componentCls,e.colorPrimary,e.colorPrimary,e.colorTextDisabled,e.colorBorder,{color:e.colorPrimaryHover,borderColor:e.colorPrimaryHover},{color:e.colorPrimaryActive,borderColor:e.colorPrimaryActive})),{[`&${e.componentCls}-dangerous`]:Object.assign(Object.assign(Object.assign({backgroundColor:e.colorError,boxShadow:`0 ${e.controlOutlineWidth}px 0 ${e.colorErrorOutline}`},vl(e.componentCls,{backgroundColor:e.colorErrorHover},{backgroundColor:e.colorErrorActive})),uy(e.componentCls,e.colorError,e.colorError,e.colorTextDisabled,e.colorBorder,{color:e.colorErrorHover,borderColor:e.colorErrorHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),GO(e))}),ipe=e=>Object.assign(Object.assign({},J$(e)),{borderStyle:"dashed"}),ope=e=>Object.assign(Object.assign(Object.assign({color:e.colorLink},vl(e.componentCls,{color:e.colorLinkHover},{color:e.colorLinkActive})),dy(e)),{[`&${e.componentCls}-dangerous`]:Object.assign(Object.assign({color:e.colorError},vl(e.componentCls,{color:e.colorErrorHover},{color:e.colorErrorActive})),dy(e))}),ape=e=>Object.assign(Object.assign(Object.assign({},vl(e.componentCls,{color:e.colorText,backgroundColor:e.colorBgTextHover},{color:e.colorText,backgroundColor:e.colorBgTextActive})),dy(e)),{[`&${e.componentCls}-dangerous`]:Object.assign(Object.assign({color:e.colorError},dy(e)),vl(e.componentCls,{color:e.colorErrorHover,backgroundColor:e.colorErrorBg},{color:e.colorErrorHover,backgroundColor:e.colorErrorBg}))}),spe=e=>{const{componentCls:n}=e;return{[`${n}-default`]:J$(e),[`${n}-primary`]:rpe(e),[`${n}-dashed`]:ipe(e),[`${n}-link`]:ope(e),[`${n}-text`]:ape(e)}},KO=function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const{componentCls:o,controlHeight:s,fontSize:c,lineHeight:d,lineWidth:p,borderRadius:m,buttonPaddingHorizontal:g,iconCls:_}=e,S=Math.max(0,(s-c*d)/2-p),T=g-p,R=`${o}-icon-only`;return[{[`${o}${n}`]:{fontSize:c,height:s,padding:`${S}px ${T}px`,borderRadius:m,[`&${R}`]:{width:s,paddingInlineStart:0,paddingInlineEnd:0,[`&${o}-round`]:{width:"auto"},[_]:{fontSize:e.buttonIconOnlyFontSize}},[`&${o}-loading`]:{opacity:e.opacityLoading,cursor:"default"},[`${o}-loading-icon`]:{transition:`width ${e.motionDurationSlow} ${e.motionEaseInOut}, opacity ${e.motionDurationSlow} ${e.motionEaseInOut}`}}},{[`${o}${o}-circle${n}`]:epe(e)},{[`${o}${o}-round${n}`]:tpe(e)}]},cpe=e=>KO(e),lpe=e=>{const n=lo(e,{controlHeight:e.controlHeightSM,padding:e.paddingXS,buttonPaddingHorizontal:8,borderRadius:e.borderRadiusSM,buttonIconOnlyFontSize:e.fontSizeLG-2});return KO(n,`${e.componentCls}-sm`)},upe=e=>{const n=lo(e,{controlHeight:e.controlHeightLG,fontSize:e.fontSizeLG,borderRadius:e.borderRadiusLG,buttonIconOnlyFontSize:e.fontSizeLG+2});return KO(n,`${e.componentCls}-lg`)},dpe=e=>{const{componentCls:n}=e;return{[n]:{[`&${n}-block`]:{width:"100%"}}}},hpe=ic("Button",e=>{const{controlTmpOutline:n,paddingContentHorizontal:o}=e,s=lo(e,{colorOutlineDefault:n,buttonPaddingHorizontal:o,buttonIconOnlyFontSize:e.fontSizeLG,buttonFontWeight:400});return[Zhe(s),lpe(s),cpe(s),upe(s),dpe(s),spe(s),Qhe(s),Y$(e),Xhe(e)]});var ppe=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function fpe(e){if(typeof e=="object"&&e){const n=e==null?void 0:e.delay;return{loading:!1,delay:!Number.isNaN(n)&&typeof n=="number"?n:0}}return{loading:!!e,delay:0}}const mpe=(e,n)=>{var o,s;const{loading:c=!1,prefixCls:d,type:p="default",danger:m,shape:g="default",size:_,styles:S,disabled:T,className:R,rootClassName:N,children:O,icon:A,ghost:M=!1,block:x=!1,htmlType:P="button",classNames:D,style:F={}}=e,j=ppe(e,["loading","prefixCls","type","danger","shape","size","styles","disabled","className","rootClassName","children","icon","ghost","block","htmlType","classNames","style"]),{getPrefixCls:B,autoInsertSpaceInButton:H,direction:K,button:J}=b.useContext(nr),q=B("btn",d),[Q,ee]=hpe(q),ne=b.useContext(qm),he=T??ne,pe=b.useContext(q$),ce=b.useMemo(()=>fpe(c),[c]),[se,ae]=b.useState(ce.loading),[Ee,ve]=b.useState(!1),de=Uc(n,b.createRef()),ye=b.Children.count(O)===1&&!A&&!g1(p);b.useEffect(()=>{let et=null;ce.delay>0?et=setTimeout(()=>{et=null,ae(!0)},ce.delay):ae(ce.loading);function tt(){et&&(clearTimeout(et),et=null)}return tt},[ce]),b.useEffect(()=>{if(!de||!de.current||H===!1)return;const et=de.current.textContent;ye&&YI(et)?Ee||ve(!0):Ee&&ve(!1)},[de]);const fe=et=>{const{onClick:tt}=e;if(se||he){et.preventDefault();return}tt==null||tt(et)},ke=H!==!1,{compactSize:Me,compactItemClassnames:Ve}=zO(q,K),je={large:"lg",small:"sm",middle:void 0},dt=af(et=>{var tt,mt;return(mt=(tt=_??Me)!==null&&tt!==void 0?tt:pe)!==null&&mt!==void 0?mt:et}),ut=dt&&je[dt]||"",Ct=se?"loading":A,_t=Ea(j,["navigate"]),Tt=Ye(q,ee,{[`${q}-${g}`]:g!=="default"&&g,[`${q}-${p}`]:p,[`${q}-${ut}`]:ut,[`${q}-icon-only`]:!O&&O!==0&&!!Ct,[`${q}-background-ghost`]:M&&!g1(p),[`${q}-loading`]:se,[`${q}-two-chinese-chars`]:Ee&&ke&&!se,[`${q}-block`]:x,[`${q}-dangerous`]:!!m,[`${q}-rtl`]:K==="rtl"},Ve,R,N,J==null?void 0:J.className),it=Object.assign(Object.assign({},J==null?void 0:J.style),F),kt=Ye(D==null?void 0:D.icon,(o=J==null?void 0:J.classNames)===null||o===void 0?void 0:o.icon),qt=Object.assign(Object.assign({},(S==null?void 0:S.icon)||{}),((s=J==null?void 0:J.styles)===null||s===void 0?void 0:s.icon)||{}),xt=A&&!se?Et.createElement(K$,{prefixCls:q,className:kt,style:qt},A):Et.createElement(Bhe,{existIcon:!!A,prefixCls:q,loading:!!se}),ze=O||O===0?zhe(O,ye&&ke):null;if(_t.href!==void 0)return Q(Et.createElement("a",Object.assign({},_t,{className:Ye(Tt,{[`${q}-disabled`]:he}),style:it,onClick:fe,ref:de}),xt,ze));let ct=Et.createElement("button",Object.assign({},j,{type:P,className:Tt,style:it,onClick:fe,disabled:he,ref:de}),xt,ze);return g1(p)||(ct=Et.createElement(Mhe,{disabled:!!se},ct)),Q(ct)},qO=b.forwardRef(mpe);qO.Group=$he;qO.__ANT_BUTTON=!0;const Oi=qO,v1=()=>({height:0,opacity:0}),Y3=e=>{const{scrollHeight:n}=e;return{height:n,opacity:1}},gpe=e=>({height:e?e.offsetHeight:0}),E1=(e,n)=>(n==null?void 0:n.deadline)===!0||n.propertyName==="height",vpe=function(){return{motionName:`${arguments.length>0&&arguments[0]!==void 0?arguments[0]:"ant"}-motion-collapse`,onAppearStart:v1,onEnterStart:v1,onAppearActive:Y3,onEnterActive:Y3,onLeaveStart:gpe,onLeaveActive:v1,onAppearEnd:E1,onEnterEnd:E1,onLeaveEnd:E1,motionDeadline:500}},Epe=(e,n,o)=>o!==void 0?o:`${e}-${n}`,XI=vpe;var Q$=b.createContext(null),X3=[];function _pe(e,n){var o=b.useState(function(){if(!xo())return null;var O=document.createElement("div");return O}),s=We(o,1),c=s[0],d=b.useRef(!1),p=b.useContext(Q$),m=b.useState(X3),g=We(m,2),_=g[0],S=g[1],T=p||(d.current?void 0:function(O){S(function(A){var M=[O].concat(ot(A));return M})});function R(){c.parentElement||document.body.appendChild(c),d.current=!0}function N(){var O;(O=c.parentElement)===null||O===void 0||O.removeChild(c),d.current=!1}return qr(function(){return e?p?p(R):R():N(),N},[e]),qr(function(){_.length&&(_.forEach(function(O){return O()}),S(X3))},[_]),[c,T]}var _1;function ype(e){if(typeof document>"u")return 0;if(e||_1===void 0){var n=document.createElement("div");n.style.width="100%",n.style.height="200px";var o=document.createElement("div"),s=o.style;s.position="absolute",s.top="0",s.left="0",s.pointerEvents="none",s.visibility="hidden",s.width="200px",s.height="150px",s.overflow="hidden",o.appendChild(n),document.body.appendChild(o);var c=n.offsetWidth;o.style.overflow="scroll";var d=n.offsetWidth;c===d&&(d=o.clientWidth),document.body.removeChild(o),_1=c-d}return _1}function J3(e){var n=e.match(/^(.*)px$/),o=Number(n==null?void 0:n[1]);return Number.isNaN(o)?ype():o}function Spe(e){if(typeof document>"u"||!e||!(e instanceof Element))return{width:0,height:0};var n=getComputedStyle(e,"::-webkit-scrollbar"),o=n.width,s=n.height;return{width:J3(o),height:J3(s)}}function Cpe(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth}var bpe="rc-util-locker-".concat(Date.now()),Q3=0;function Tpe(e){var n=!!e,o=b.useState(function(){return Q3+=1,"".concat(bpe,"_").concat(Q3)}),s=We(o,1),c=s[0];qr(function(){if(n){var d=Spe(document.body).width,p=Cpe();Om(`
html body {
  overflow-y: hidden;
  `.concat(p?"width: calc(100% - ".concat(d,"px);"):"",`
}`),c)}else ty(c);return function(){ty(c)}},[n,c])}var Z3=!1;function Rpe(e){return typeof e=="boolean"&&(Z3=e),Z3}var e5=function(n){return n===!1?!1:!xo()||!n?null:typeof n=="string"?document.querySelector(n):typeof n=="function"?n():n},Z$=b.forwardRef(function(e,n){var o=e.open,s=e.autoLock,c=e.getContainer;e.debug;var d=e.autoDestroy,p=d===void 0?!0:d,m=e.children,g=b.useState(o),_=We(g,2),S=_[0],T=_[1],R=S||o;b.useEffect(function(){(p||o)&&T(o)},[o,p]);var N=b.useState(function(){return e5(c)}),O=We(N,2),A=O[0],M=O[1];b.useEffect(function(){var Q=e5(c);M(Q??null)});var x=_pe(R&&!A),P=We(x,2),D=P[0],F=P[1],j=A??D;Tpe(s&&o&&xo()&&(j===D||j===document.body));var B=null;if(m&&nf(m)&&n){var H=m;B=H.ref}var K=nS(B,n);if(!R||!xo()||A===void 0)return null;var J=j===!1||Rpe(),q=m;return n&&(q=b.cloneElement(m,{ref:K})),b.createElement(Q$.Provider,{value:F},J?q:Cl.createPortal(q,j))});function wpe(){var e=Ae({},Md);return e.useId}var t5=0,n5=wpe();const Ipe=n5?function(n){var o=n5();return n||o}:function(n){var o=b.useState("ssr-id"),s=We(o,2),c=s[0],d=s[1];return b.useEffect(function(){var p=t5;t5+=1,d("rc_unique_".concat(p))},[]),n||c};var e7=function(n){if(xo()&&window.document.documentElement){var o=Array.isArray(n)?n:[n],s=window.document.documentElement;return o.some(function(c){return c in s.style})}return!1},Ape=function(n,o){if(!e7(n))return!1;var s=document.createElement("div"),c=s.style[n];return s.style[n]=o,s.style[n]!==c};function r5(e,n){return!Array.isArray(e)&&n!==void 0?Ape(e,n):e7(e)}const Ope=()=>xo()&&window.document.documentElement;let VE;const xpe=()=>{if(!Ope())return!1;if(VE!==void 0)return VE;const e=document.createElement("div");return e.style.display="flex",e.style.flexDirection="column",e.style.rowGap="1px",e.appendChild(document.createElement("div")),e.appendChild(document.createElement("div")),document.body.appendChild(e),VE=e.scrollHeight===1,document.body.removeChild(e),VE};var Id="RC_FORM_INTERNAL_HOOKS",ur=function(){ma(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},$d=b.createContext({getFieldValue:ur,getFieldsValue:ur,getFieldError:ur,getFieldWarning:ur,getFieldsError:ur,isFieldsTouched:ur,isFieldTouched:ur,isFieldValidating:ur,isFieldsValidating:ur,resetFields:ur,setFields:ur,setFieldValue:ur,setFieldsValue:ur,validateFields:ur,submit:ur,getInternalHooks:function(){return ur(),{dispatch:ur,initEntityValue:ur,registerField:ur,useSubscribe:ur,setInitialValues:ur,destroyForm:ur,setCallbacks:ur,registerWatch:ur,getFields:ur,setValidateMessages:ur,setPreserve:ur,getInitialValue:ur}}}),Pm=b.createContext(null);function JI(e){return e==null?[]:Array.isArray(e)?e:[e]}function Npe(e){return e&&!!e._init}function Ad(){return Ad=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},Ad.apply(this,arguments)}function Ppe(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,Dm(e,n)}function QI(e){return QI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},QI(e)}function Dm(e,n){return Dm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,c){return s.__proto__=c,s},Dm(e,n)}function Dpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v_(e,n,o){return Dpe()?v_=Reflect.construct.bind():v_=function(c,d,p){var m=[null];m.push.apply(m,d);var g=Function.bind.apply(c,m),_=new g;return p&&Dm(_,p.prototype),_},v_.apply(null,arguments)}function kpe(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function ZI(e){var n=typeof Map=="function"?new Map:void 0;return ZI=function(s){if(s===null||!kpe(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof n<"u"){if(n.has(s))return n.get(s);n.set(s,c)}function c(){return v_(s,arguments,QI(this).constructor)}return c.prototype=Object.create(s.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),Dm(c,s)},ZI(e)}var Lpe=/%[sdj%]/g,Mpe=function(){};typeof process<"u"&&process.env;function eA(e){if(!e||!e.length)return null;var n={};return e.forEach(function(o){var s=o.field;n[s]=n[s]||[],n[s].push(o)}),n}function $a(e){for(var n=arguments.length,o=new Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];var c=0,d=o.length;if(typeof e=="function")return e.apply(null,o);if(typeof e=="string"){var p=e.replace(Lpe,function(m){if(m==="%%")return"%";if(c>=d)return m;switch(m){case"%s":return String(o[c++]);case"%d":return Number(o[c++]);case"%j":try{return JSON.stringify(o[c++])}catch{return"[Circular]"}break;default:return m}});return p}return e}function Fpe(e){return e==="string"||e==="url"||e==="hex"||e==="email"||e==="date"||e==="pattern"}function Bi(e,n){return!!(e==null||n==="array"&&Array.isArray(e)&&!e.length||Fpe(n)&&typeof e=="string"&&!e)}function Upe(e,n,o){var s=[],c=0,d=e.length;function p(m){s.push.apply(s,m||[]),c++,c===d&&o(s)}e.forEach(function(m){n(m,p)})}function i5(e,n,o){var s=0,c=e.length;function d(p){if(p&&p.length){o(p);return}var m=s;s=s+1,m<c?n(e[m],d):o([])}d([])}function Bpe(e){var n=[];return Object.keys(e).forEach(function(o){n.push.apply(n,e[o]||[])}),n}var o5=function(e){Ppe(n,e);function n(o,s){var c;return c=e.call(this,"Async Validation Error")||this,c.errors=o,c.fields=s,c}return n}(ZI(Error));function jpe(e,n,o,s,c){if(n.first){var d=new Promise(function(R,N){var O=function(x){return s(x),x.length?N(new o5(x,eA(x))):R(c)},A=Bpe(e);i5(A,o,O)});return d.catch(function(R){return R}),d}var p=n.firstFields===!0?Object.keys(e):n.firstFields||[],m=Object.keys(e),g=m.length,_=0,S=[],T=new Promise(function(R,N){var O=function(M){if(S.push.apply(S,M),_++,_===g)return s(S),S.length?N(new o5(S,eA(S))):R(c)};m.length||(s(S),R(c)),m.forEach(function(A){var M=e[A];p.indexOf(A)!==-1?i5(M,o,O):Upe(M,o,O)})});return T.catch(function(R){return R}),T}function Vpe(e){return!!(e&&e.message!==void 0)}function $pe(e,n){for(var o=e,s=0;s<n.length;s++){if(o==null)return o;o=o[n[s]]}return o}function a5(e,n){return function(o){var s;return e.fullFields?s=$pe(n,e.fullFields):s=n[o.field||e.fullField],Vpe(o)?(o.field=o.field||e.fullField,o.fieldValue=s,o):{message:typeof o=="function"?o():o,fieldValue:s,field:o.field||e.fullField}}}function s5(e,n){if(n){for(var o in n)if(n.hasOwnProperty(o)){var s=n[o];typeof s=="object"&&typeof e[o]=="object"?e[o]=Ad({},e[o],s):e[o]=s}}return e}var t7=function(n,o,s,c,d,p){n.required&&(!s.hasOwnProperty(n.field)||Bi(o,p||n.type))&&c.push($a(d.messages.required,n.fullField))},Hpe=function(n,o,s,c,d){(/^\s+$/.test(o)||o==="")&&c.push($a(d.messages.whitespace,n.fullField))},$E,Wpe=function(){if($E)return $E;var e="[a-fA-F\\d:]",n=function(F){return F&&F.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},o="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",s="[a-fA-F\\d]{1,4}",c=(`
(?:
(?:`+s+":){7}(?:"+s+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+s+":){6}(?:"+o+"|:"+s+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+s+":){5}(?::"+o+"|(?::"+s+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+s+":){4}(?:(?::"+s+"){0,1}:"+o+"|(?::"+s+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+s+":){3}(?:(?::"+s+"){0,2}:"+o+"|(?::"+s+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+s+":){2}(?:(?::"+s+"){0,3}:"+o+"|(?::"+s+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+s+":){1}(?:(?::"+s+"){0,4}:"+o+"|(?::"+s+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+s+"){0,5}:"+o+"|(?::"+s+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),d=new RegExp("(?:^"+o+"$)|(?:^"+c+"$)"),p=new RegExp("^"+o+"$"),m=new RegExp("^"+c+"$"),g=function(F){return F&&F.exact?d:new RegExp("(?:"+n(F)+o+n(F)+")|(?:"+n(F)+c+n(F)+")","g")};g.v4=function(D){return D&&D.exact?p:new RegExp(""+n(D)+o+n(D),"g")},g.v6=function(D){return D&&D.exact?m:new RegExp(""+n(D)+c+n(D),"g")};var _="(?:(?:[a-z]+:)?//)",S="(?:\\S+(?::\\S*)?@)?",T=g.v4().source,R=g.v6().source,N="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",O="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",A="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",M="(?::\\d{2,5})?",x='(?:[/?#][^\\s"]*)?',P="(?:"+_+"|www\\.)"+S+"(?:localhost|"+T+"|"+R+"|"+N+O+A+")"+M+x;return $E=new RegExp("(?:^"+P+"$)","i"),$E},c5={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},W0={integer:function(n){return W0.number(n)&&parseInt(n,10)===n},float:function(n){return W0.number(n)&&!W0.integer(n)},array:function(n){return Array.isArray(n)},regexp:function(n){if(n instanceof RegExp)return!0;try{return!!new RegExp(n)}catch{return!1}},date:function(n){return typeof n.getTime=="function"&&typeof n.getMonth=="function"&&typeof n.getYear=="function"&&!isNaN(n.getTime())},number:function(n){return isNaN(n)?!1:typeof n=="number"},object:function(n){return typeof n=="object"&&!W0.array(n)},method:function(n){return typeof n=="function"},email:function(n){return typeof n=="string"&&n.length<=320&&!!n.match(c5.email)},url:function(n){return typeof n=="string"&&n.length<=2048&&!!n.match(Wpe())},hex:function(n){return typeof n=="string"&&!!n.match(c5.hex)}},zpe=function(n,o,s,c,d){if(n.required&&o===void 0){t7(n,o,s,c,d);return}var p=["integer","float","array","regexp","object","method","email","number","date","url","hex"],m=n.type;p.indexOf(m)>-1?W0[m](o)||c.push($a(d.messages.types[m],n.fullField,n.type)):m&&typeof o!==n.type&&c.push($a(d.messages.types[m],n.fullField,n.type))},Gpe=function(n,o,s,c,d){var p=typeof n.len=="number",m=typeof n.min=="number",g=typeof n.max=="number",_=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,S=o,T=null,R=typeof o=="number",N=typeof o=="string",O=Array.isArray(o);if(R?T="number":N?T="string":O&&(T="array"),!T)return!1;O&&(S=o.length),N&&(S=o.replace(_,"_").length),p?S!==n.len&&c.push($a(d.messages[T].len,n.fullField,n.len)):m&&!g&&S<n.min?c.push($a(d.messages[T].min,n.fullField,n.min)):g&&!m&&S>n.max?c.push($a(d.messages[T].max,n.fullField,n.max)):m&&g&&(S<n.min||S>n.max)&&c.push($a(d.messages[T].range,n.fullField,n.min,n.max))},np="enum",Kpe=function(n,o,s,c,d){n[np]=Array.isArray(n[np])?n[np]:[],n[np].indexOf(o)===-1&&c.push($a(d.messages[np],n.fullField,n[np].join(", ")))},qpe=function(n,o,s,c,d){if(n.pattern){if(n.pattern instanceof RegExp)n.pattern.lastIndex=0,n.pattern.test(o)||c.push($a(d.messages.pattern.mismatch,n.fullField,o,n.pattern));else if(typeof n.pattern=="string"){var p=new RegExp(n.pattern);p.test(o)||c.push($a(d.messages.pattern.mismatch,n.fullField,o,n.pattern))}}},Rn={required:t7,whitespace:Hpe,type:zpe,range:Gpe,enum:Kpe,pattern:qpe},Ype=function(n,o,s,c,d){var p=[],m=n.required||!n.required&&c.hasOwnProperty(n.field);if(m){if(Bi(o,"string")&&!n.required)return s();Rn.required(n,o,c,p,d,"string"),Bi(o,"string")||(Rn.type(n,o,c,p,d),Rn.range(n,o,c,p,d),Rn.pattern(n,o,c,p,d),n.whitespace===!0&&Rn.whitespace(n,o,c,p,d))}s(p)},Xpe=function(n,o,s,c,d){var p=[],m=n.required||!n.required&&c.hasOwnProperty(n.field);if(m){if(Bi(o)&&!n.required)return s();Rn.required(n,o,c,p,d),o!==void 0&&Rn.type(n,o,c,p,d)}s(p)},Jpe=function(n,o,s,c,d){var p=[],m=n.required||!n.required&&c.hasOwnProperty(n.field);if(m){if(o===""&&(o=void 0),Bi(o)&&!n.required)return s();Rn.required(n,o,c,p,d),o!==void 0&&(Rn.type(n,o,c,p,d),Rn.range(n,o,c,p,d))}s(p)},Qpe=function(n,o,s,c,d){var p=[],m=n.required||!n.required&&c.hasOwnProperty(n.field);if(m){if(Bi(o)&&!n.required)return s();Rn.required(n,o,c,p,d),o!==void 0&&Rn.type(n,o,c,p,d)}s(p)},Zpe=function(n,o,s,c,d){var p=[],m=n.required||!n.required&&c.hasOwnProperty(n.field);if(m){if(Bi(o)&&!n.required)return s();Rn.required(n,o,c,p,d),Bi(o)||Rn.type(n,o,c,p,d)}s(p)},efe=function(n,o,s,c,d){var p=[],m=n.required||!n.required&&c.hasOwnProperty(n.field);if(m){if(Bi(o)&&!n.required)return s();Rn.required(n,o,c,p,d),o!==void 0&&(Rn.type(n,o,c,p,d),Rn.range(n,o,c,p,d))}s(p)},tfe=function(n,o,s,c,d){var p=[],m=n.required||!n.required&&c.hasOwnProperty(n.field);if(m){if(Bi(o)&&!n.required)return s();Rn.required(n,o,c,p,d),o!==void 0&&(Rn.type(n,o,c,p,d),Rn.range(n,o,c,p,d))}s(p)},nfe=function(n,o,s,c,d){var p=[],m=n.required||!n.required&&c.hasOwnProperty(n.field);if(m){if(o==null&&!n.required)return s();Rn.required(n,o,c,p,d,"array"),o!=null&&(Rn.type(n,o,c,p,d),Rn.range(n,o,c,p,d))}s(p)},rfe=function(n,o,s,c,d){var p=[],m=n.required||!n.required&&c.hasOwnProperty(n.field);if(m){if(Bi(o)&&!n.required)return s();Rn.required(n,o,c,p,d),o!==void 0&&Rn.type(n,o,c,p,d)}s(p)},ife="enum",ofe=function(n,o,s,c,d){var p=[],m=n.required||!n.required&&c.hasOwnProperty(n.field);if(m){if(Bi(o)&&!n.required)return s();Rn.required(n,o,c,p,d),o!==void 0&&Rn[ife](n,o,c,p,d)}s(p)},afe=function(n,o,s,c,d){var p=[],m=n.required||!n.required&&c.hasOwnProperty(n.field);if(m){if(Bi(o,"string")&&!n.required)return s();Rn.required(n,o,c,p,d),Bi(o,"string")||Rn.pattern(n,o,c,p,d)}s(p)},sfe=function(n,o,s,c,d){var p=[],m=n.required||!n.required&&c.hasOwnProperty(n.field);if(m){if(Bi(o,"date")&&!n.required)return s();if(Rn.required(n,o,c,p,d),!Bi(o,"date")){var g;o instanceof Date?g=o:g=new Date(o),Rn.type(n,g,c,p,d),g&&Rn.range(n,g.getTime(),c,p,d)}}s(p)},cfe=function(n,o,s,c,d){var p=[],m=Array.isArray(o)?"array":typeof o;Rn.required(n,o,c,p,d,m),s(p)},y1=function(n,o,s,c,d){var p=n.type,m=[],g=n.required||!n.required&&c.hasOwnProperty(n.field);if(g){if(Bi(o,p)&&!n.required)return s();Rn.required(n,o,c,m,d,p),Bi(o,p)||Rn.type(n,o,c,m,d)}s(m)},lfe=function(n,o,s,c,d){var p=[],m=n.required||!n.required&&c.hasOwnProperty(n.field);if(m){if(Bi(o)&&!n.required)return s();Rn.required(n,o,c,p,d)}s(p)},im={string:Ype,method:Xpe,number:Jpe,boolean:Qpe,regexp:Zpe,integer:efe,float:tfe,array:nfe,object:rfe,enum:ofe,pattern:afe,date:sfe,url:y1,hex:y1,email:y1,required:cfe,any:lfe};function tA(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var n=JSON.parse(JSON.stringify(this));return n.clone=this.clone,n}}}var nA=tA(),Qm=function(){function e(o){this.rules=null,this._messages=nA,this.define(o)}var n=e.prototype;return n.define=function(s){var c=this;if(!s)throw new Error("Cannot configure a schema with no rules");if(typeof s!="object"||Array.isArray(s))throw new Error("Rules must be an object");this.rules={},Object.keys(s).forEach(function(d){var p=s[d];c.rules[d]=Array.isArray(p)?p:[p]})},n.messages=function(s){return s&&(this._messages=s5(tA(),s)),this._messages},n.validate=function(s,c,d){var p=this;c===void 0&&(c={}),d===void 0&&(d=function(){});var m=s,g=c,_=d;if(typeof g=="function"&&(_=g,g={}),!this.rules||Object.keys(this.rules).length===0)return _&&_(null,m),Promise.resolve(m);function S(A){var M=[],x={};function P(F){if(Array.isArray(F)){var j;M=(j=M).concat.apply(j,F)}else M.push(F)}for(var D=0;D<A.length;D++)P(A[D]);M.length?(x=eA(M),_(M,x)):_(null,m)}if(g.messages){var T=this.messages();T===nA&&(T=tA()),s5(T,g.messages),g.messages=T}else g.messages=this.messages();var R={},N=g.keys||Object.keys(this.rules);N.forEach(function(A){var M=p.rules[A],x=m[A];M.forEach(function(P){var D=P;typeof D.transform=="function"&&(m===s&&(m=Ad({},m)),x=m[A]=D.transform(x)),typeof D=="function"?D={validator:D}:D=Ad({},D),D.validator=p.getValidationMethod(D),D.validator&&(D.field=A,D.fullField=D.fullField||A,D.type=p.getType(D),R[A]=R[A]||[],R[A].push({rule:D,value:x,source:m,field:A}))})});var O={};return jpe(R,g,function(A,M){var x=A.rule,P=(x.type==="object"||x.type==="array")&&(typeof x.fields=="object"||typeof x.defaultField=="object");P=P&&(x.required||!x.required&&A.value),x.field=A.field;function D(B,H){return Ad({},H,{fullField:x.fullField+"."+B,fullFields:x.fullFields?[].concat(x.fullFields,[B]):[B]})}function F(B){B===void 0&&(B=[]);var H=Array.isArray(B)?B:[B];!g.suppressWarning&&H.length&&e.warning("async-validator:",H),H.length&&x.message!==void 0&&(H=[].concat(x.message));var K=H.map(a5(x,m));if(g.first&&K.length)return O[x.field]=1,M(K);if(!P)M(K);else{if(x.required&&!A.value)return x.message!==void 0?K=[].concat(x.message).map(a5(x,m)):g.error&&(K=[g.error(x,$a(g.messages.required,x.field))]),M(K);var J={};x.defaultField&&Object.keys(A.value).map(function(ee){J[ee]=x.defaultField}),J=Ad({},J,A.rule.fields);var q={};Object.keys(J).forEach(function(ee){var ne=J[ee],he=Array.isArray(ne)?ne:[ne];q[ee]=he.map(D.bind(null,ee))});var Q=new e(q);Q.messages(g.messages),A.rule.options&&(A.rule.options.messages=g.messages,A.rule.options.error=g.error),Q.validate(A.value,A.rule.options||g,function(ee){var ne=[];K&&K.length&&ne.push.apply(ne,K),ee&&ee.length&&ne.push.apply(ne,ee),M(ne.length?ne:null)})}}var j;if(x.asyncValidator)j=x.asyncValidator(x,A.value,F,A.source,g);else if(x.validator){try{j=x.validator(x,A.value,F,A.source,g)}catch(B){console.error==null||console.error(B),g.suppressValidatorError||setTimeout(function(){throw B},0),F(B.message)}j===!0?F():j===!1?F(typeof x.message=="function"?x.message(x.fullField||x.field):x.message||(x.fullField||x.field)+" fails"):j instanceof Array?F(j):j instanceof Error&&F(j.message)}j&&j.then&&j.then(function(){return F()},function(B){return F(B)})},function(A){S(A)},m)},n.getType=function(s){if(s.type===void 0&&s.pattern instanceof RegExp&&(s.type="pattern"),typeof s.validator!="function"&&s.type&&!im.hasOwnProperty(s.type))throw new Error($a("Unknown rule type %s",s.type));return s.type||"string"},n.getValidationMethod=function(s){if(typeof s.validator=="function")return s.validator;var c=Object.keys(s),d=c.indexOf("message");return d!==-1&&c.splice(d,1),c.length===1&&c[0]==="required"?im.required:im[this.getType(s)]||void 0},e}();Qm.register=function(n,o){if(typeof o!="function")throw new Error("Cannot register a validator by type, validator is not a function");im[n]=o};Qm.warning=Mpe;Qm.messages=nA;Qm.validators=im;var Ua="'${name}' is not a valid ${type}",n7={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:Ua,method:Ua,array:Ua,object:Ua,number:Ua,date:Ua,boolean:Ua,integer:Ua,float:Ua,regexp:Ua,email:Ua,url:Ua,hex:Ua},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},l5=Qm;function ufe(e,n){return e.replace(/\$\{\w+\}/g,function(o){var s=o.slice(2,-1);return n[s]})}var u5="CODE_LOGIC_ERROR";function rA(e,n,o,s,c){return iA.apply(this,arguments)}function iA(){return iA=cf(Ga().mark(function e(n,o,s,c,d){var p,m,g,_,S,T,R,N,O;return Ga().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return p=Ae({},s),delete p.ruleIndex,l5.warning=function(){},p.validator&&(m=p.validator,p.validator=function(){try{return m.apply(void 0,arguments)}catch(x){return console.error(x),Promise.reject(u5)}}),g=null,p&&p.type==="array"&&p.defaultField&&(g=p.defaultField,delete p.defaultField),_=new l5(st({},n,[p])),S=Ap(n7,c.validateMessages),_.messages(S),T=[],M.prev=10,M.next=13,Promise.resolve(_.validate(st({},n,o),Ae({},c)));case 13:M.next=18;break;case 15:M.prev=15,M.t0=M.catch(10),M.t0.errors&&(T=M.t0.errors.map(function(x,P){var D=x.message,F=D===u5?S.default:D;return b.isValidElement(F)?b.cloneElement(F,{key:"error_".concat(P)}):F}));case 18:if(!(!T.length&&g)){M.next=23;break}return M.next=21,Promise.all(o.map(function(x,P){return rA("".concat(n,".").concat(P),x,g,c,d)}));case 21:return R=M.sent,M.abrupt("return",R.reduce(function(x,P){return[].concat(ot(x),ot(P))},[]));case 23:return N=Ae(Ae({},s),{},{name:n,enum:(s.enum||[]).join(", ")},d),O=T.map(function(x){return typeof x=="string"?ufe(x,N):x}),M.abrupt("return",O);case 26:case"end":return M.stop()}},e,null,[[10,15]])})),iA.apply(this,arguments)}function dfe(e,n,o,s,c,d){var p=e.join("."),m=o.map(function(S,T){var R=S.validator,N=Ae(Ae({},S),{},{ruleIndex:T});return R&&(N.validator=function(O,A,M){var x=!1,P=function(){for(var j=arguments.length,B=new Array(j),H=0;H<j;H++)B[H]=arguments[H];Promise.resolve().then(function(){ma(!x,"Your validator function has already return a promise. `callback` will be ignored."),x||M.apply(void 0,B)})},D=R(O,A,P);x=D&&typeof D.then=="function"&&typeof D.catch=="function",ma(x,"`callback` is deprecated. Please return a promise instead."),x&&D.then(function(){M()}).catch(function(F){M(F||" ")})}),N}).sort(function(S,T){var R=S.warningOnly,N=S.ruleIndex,O=T.warningOnly,A=T.ruleIndex;return!!R==!!O?N-A:R?1:-1}),g;if(c===!0)g=new Promise(function(){var S=cf(Ga().mark(function T(R,N){var O,A,M;return Ga().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:O=0;case 1:if(!(O<m.length)){P.next=12;break}return A=m[O],P.next=5,rA(p,n,A,s,d);case 5:if(M=P.sent,!M.length){P.next=9;break}return N([{errors:M,rule:A}]),P.abrupt("return");case 9:O+=1,P.next=1;break;case 12:R([]);case 13:case"end":return P.stop()}},T)}));return function(T,R){return S.apply(this,arguments)}}());else{var _=m.map(function(S){return rA(p,n,S,s,d).then(function(T){return{errors:T,rule:S}})});g=(c?pfe(_):hfe(_)).then(function(S){return Promise.reject(S)})}return g.catch(function(S){return S}),g}function hfe(e){return oA.apply(this,arguments)}function oA(){return oA=cf(Ga().mark(function e(n){return Ga().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",Promise.all(n).then(function(c){var d,p=(d=[]).concat.apply(d,ot(c));return p}));case 1:case"end":return s.stop()}},e)})),oA.apply(this,arguments)}function pfe(e){return aA.apply(this,arguments)}function aA(){return aA=cf(Ga().mark(function e(n){var o;return Ga().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o=0,c.abrupt("return",new Promise(function(d){n.forEach(function(p){p.then(function(m){m.errors.length&&d([m]),o+=1,o===n.length&&d([])})})}));case 2:case"end":return c.stop()}},e)})),aA.apply(this,arguments)}function Ei(e){return JI(e)}function d5(e,n){var o={};return n.forEach(function(s){var c=Ys(e,s);o=Ws(o,s,c)}),o}function om(e,n){return e&&e.some(function(o){return r7(o,n)})}function r7(e,n){return!e||!n||e.length!==n.length?!1:e.every(function(o,s){return n[s]===o})}function ffe(e,n){if(e===n)return!0;if(!e&&n||e&&!n||!e||!n||jn(e)!=="object"||jn(n)!=="object")return!1;var o=Object.keys(e),s=Object.keys(n),c=new Set([].concat(o,s));return ot(c).every(function(d){var p=e[d],m=n[d];return typeof p=="function"&&typeof m=="function"?!0:p===m})}function mfe(e){var n=arguments.length<=1?void 0:arguments[1];return n&&n.target&&jn(n.target)==="object"&&e in n.target?n.target[e]:n}function h5(e,n,o){var s=e.length;if(n<0||n>=s||o<0||o>=s)return e;var c=e[n],d=n-o;return d>0?[].concat(ot(e.slice(0,o)),[c],ot(e.slice(o,n)),ot(e.slice(n+1,s))):d<0?[].concat(ot(e.slice(0,n)),ot(e.slice(n+1,o+1)),[c],ot(e.slice(o+1,s))):e}var gfe=["name"],hs=[];function p5(e,n,o,s,c,d){return typeof e=="function"?e(n,o,"source"in d?{source:d.source}:{}):s!==c}var YO=function(e){ef(o,e);var n=tf(o);function o(s){var c;if(bs(this,o),c=n.call(this,s),c.state={resetCount:0},c.cancelRegisterFunc=null,c.mounted=!1,c.touched=!1,c.dirty=!1,c.validatePromise=void 0,c.prevValidating=void 0,c.errors=hs,c.warnings=hs,c.cancelRegister=function(){var g=c.props,_=g.preserve,S=g.isListField,T=g.name;c.cancelRegisterFunc&&c.cancelRegisterFunc(S,_,Ei(T)),c.cancelRegisterFunc=null},c.getNamePath=function(){var g=c.props,_=g.name,S=g.fieldContext,T=S.prefixName,R=T===void 0?[]:T;return _!==void 0?[].concat(ot(R),ot(_)):[]},c.getRules=function(){var g=c.props,_=g.rules,S=_===void 0?[]:_,T=g.fieldContext;return S.map(function(R){return typeof R=="function"?R(T):R})},c.refresh=function(){c.mounted&&c.setState(function(g){var _=g.resetCount;return{resetCount:_+1}})},c.metaCache=null,c.triggerMetaEvent=function(g){var _=c.props.onMetaChange;if(_){var S=Ae(Ae({},c.getMeta()),{},{destroy:g});iS(c.metaCache,S)||_(S),c.metaCache=S}else c.metaCache=null},c.onStoreChange=function(g,_,S){var T=c.props,R=T.shouldUpdate,N=T.dependencies,O=N===void 0?[]:N,A=T.onReset,M=S.store,x=c.getNamePath(),P=c.getValue(g),D=c.getValue(M),F=_&&om(_,x);switch(S.type==="valueUpdate"&&S.source==="external"&&P!==D&&(c.touched=!0,c.dirty=!0,c.validatePromise=null,c.errors=hs,c.warnings=hs,c.triggerMetaEvent()),S.type){case"reset":if(!_||F){c.touched=!1,c.dirty=!1,c.validatePromise=void 0,c.errors=hs,c.warnings=hs,c.triggerMetaEvent(),A==null||A(),c.refresh();return}break;case"remove":{if(R){c.reRender();return}break}case"setField":{if(F){var j=S.data;"touched"in j&&(c.touched=j.touched),"validating"in j&&!("originRCField"in j)&&(c.validatePromise=j.validating?Promise.resolve([]):null),"errors"in j&&(c.errors=j.errors||hs),"warnings"in j&&(c.warnings=j.warnings||hs),c.dirty=!0,c.triggerMetaEvent(),c.reRender();return}if(R&&!x.length&&p5(R,g,M,P,D,S)){c.reRender();return}break}case"dependenciesUpdate":{var B=O.map(Ei);if(B.some(function(H){return om(S.relatedFields,H)})){c.reRender();return}break}default:if(F||(!O.length||x.length||R)&&p5(R,g,M,P,D,S)){c.reRender();return}break}R===!0&&c.reRender()},c.validateRules=function(g){var _=c.getNamePath(),S=c.getValue(),T=g||{},R=T.triggerName,N=T.validateOnly,O=N===void 0?!1:N,A=Promise.resolve().then(function(){if(!c.mounted)return[];var M=c.props,x=M.validateFirst,P=x===void 0?!1:x,D=M.messageVariables,F=c.getRules();R&&(F=F.filter(function(B){return B}).filter(function(B){var H=B.validateTrigger;if(!H)return!0;var K=JI(H);return K.includes(R)}));var j=dfe(_,S,F,g,P,D);return j.catch(function(B){return B}).then(function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hs;if(c.validatePromise===A){var H;c.validatePromise=null;var K=[],J=[];(H=B.forEach)===null||H===void 0||H.call(B,function(q){var Q=q.rule.warningOnly,ee=q.errors,ne=ee===void 0?hs:ee;Q?J.push.apply(J,ot(ne)):K.push.apply(K,ot(ne))}),c.errors=K,c.warnings=J,c.triggerMetaEvent(),c.reRender()}}),j});return O||(c.validatePromise=A,c.dirty=!0,c.errors=hs,c.warnings=hs,c.triggerMetaEvent(),c.reRender()),A},c.isFieldValidating=function(){return!!c.validatePromise},c.isFieldTouched=function(){return c.touched},c.isFieldDirty=function(){if(c.dirty||c.props.initialValue!==void 0)return!0;var g=c.props.fieldContext,_=g.getInternalHooks(Id),S=_.getInitialValue;return S(c.getNamePath())!==void 0},c.getErrors=function(){return c.errors},c.getWarnings=function(){return c.warnings},c.isListField=function(){return c.props.isListField},c.isList=function(){return c.props.isList},c.isPreserve=function(){return c.props.preserve},c.getMeta=function(){c.prevValidating=c.isFieldValidating();var g={touched:c.isFieldTouched(),validating:c.prevValidating,errors:c.errors,warnings:c.warnings,name:c.getNamePath(),validated:c.validatePromise===null};return g},c.getOnlyChild=function(g){if(typeof g=="function"){var _=c.getMeta();return Ae(Ae({},c.getOnlyChild(g(c.getControlled(),_,c.props.fieldContext))),{},{isFunction:!0})}var S=ml(g);return S.length!==1||!b.isValidElement(S[0])?{child:S,isFunction:!1}:{child:S[0],isFunction:!1}},c.getValue=function(g){var _=c.props.fieldContext.getFieldsValue,S=c.getNamePath();return Ys(g||_(!0),S)},c.getControlled=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=c.props,S=_.trigger,T=_.validateTrigger,R=_.getValueFromEvent,N=_.normalize,O=_.valuePropName,A=_.getValueProps,M=_.fieldContext,x=T!==void 0?T:M.validateTrigger,P=c.getNamePath(),D=M.getInternalHooks,F=M.getFieldsValue,j=D(Id),B=j.dispatch,H=c.getValue(),K=A||function(ee){return st({},O,ee)},J=g[S],q=Ae(Ae({},g),K(H));q[S]=function(){c.touched=!0,c.dirty=!0,c.triggerMetaEvent();for(var ee,ne=arguments.length,he=new Array(ne),pe=0;pe<ne;pe++)he[pe]=arguments[pe];R?ee=R.apply(void 0,he):ee=mfe.apply(void 0,[O].concat(he)),N&&(ee=N(ee,H,F(!0))),B({type:"updateValue",namePath:P,value:ee}),J&&J.apply(void 0,he)};var Q=JI(x||[]);return Q.forEach(function(ee){var ne=q[ee];q[ee]=function(){ne&&ne.apply(void 0,arguments);var he=c.props.rules;he&&he.length&&B({type:"validateField",namePath:P,triggerName:ee})}}),q},s.fieldContext){var d=s.fieldContext.getInternalHooks,p=d(Id),m=p.initEntityValue;m(J_(c))}return c}return Ts(o,[{key:"componentDidMount",value:function(){var c=this.props,d=c.shouldUpdate,p=c.fieldContext;if(this.mounted=!0,p){var m=p.getInternalHooks,g=m(Id),_=g.registerField;this.cancelRegisterFunc=_(this)}d===!0&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.triggerMetaEvent(!0),this.mounted=!1}},{key:"reRender",value:function(){this.mounted&&this.forceUpdate()}},{key:"render",value:function(){var c=this.state.resetCount,d=this.props.children,p=this.getOnlyChild(d),m=p.child,g=p.isFunction,_;return g?_=m:b.isValidElement(m)?_=b.cloneElement(m,this.getControlled(m.props)):(ma(!m,"`children` of Field is not validate ReactElement."),_=m),b.createElement(b.Fragment,{key:c},_)}}]),o}(b.Component);YO.contextType=$d;YO.defaultProps={trigger:"onChange",valuePropName:"value"};function XO(e){var n=e.name,o=xn(e,gfe),s=b.useContext($d),c=b.useContext(Pm),d=n!==void 0?Ei(n):void 0,p="keep";return o.isListField||(p="_".concat((d||[]).join("_"))),b.createElement(YO,Qe({key:p,name:d,isListField:!!c},o,{fieldContext:s}))}var i7=function(n){var o=n.name,s=n.initialValue,c=n.children,d=n.rules,p=n.validateTrigger,m=n.isListField,g=b.useContext($d),_=b.useContext(Pm),S=b.useRef({keys:[],id:0}),T=S.current,R=b.useMemo(function(){var M=Ei(g.prefixName)||[];return[].concat(ot(M),ot(Ei(o)))},[g.prefixName,o]),N=b.useMemo(function(){return Ae(Ae({},g),{},{prefixName:R})},[g,R]),O=b.useMemo(function(){return{getKey:function(x){var P=R.length,D=x[P];return[T.keys[D],x.slice(P+1)]}}},[R]);if(typeof c!="function")return ma(!1,"Form.List only accepts function as children."),null;var A=function(x,P,D){var F=D.source;return F==="internal"?!1:x!==P};return b.createElement(Pm.Provider,{value:O},b.createElement($d.Provider,{value:N},b.createElement(XO,{name:[],shouldUpdate:A,rules:d,validateTrigger:p,initialValue:s,isList:!0,isListField:m??!!_},function(M,x){var P=M.value,D=P===void 0?[]:P,F=M.onChange,j=g.getFieldValue,B=function(){var q=j(R||[]);return q||[]},H={add:function(q,Q){var ee=B();Q>=0&&Q<=ee.length?(T.keys=[].concat(ot(T.keys.slice(0,Q)),[T.id],ot(T.keys.slice(Q))),F([].concat(ot(ee.slice(0,Q)),[q],ot(ee.slice(Q))))):(T.keys=[].concat(ot(T.keys),[T.id]),F([].concat(ot(ee),[q]))),T.id+=1},remove:function(q){var Q=B(),ee=new Set(Array.isArray(q)?q:[q]);ee.size<=0||(T.keys=T.keys.filter(function(ne,he){return!ee.has(he)}),F(Q.filter(function(ne,he){return!ee.has(he)})))},move:function(q,Q){if(q!==Q){var ee=B();q<0||q>=ee.length||Q<0||Q>=ee.length||(T.keys=h5(T.keys,q,Q),F(h5(ee,q,Q)))}}},K=D||[];return Array.isArray(K)||(K=[]),c(K.map(function(J,q){var Q=T.keys[q];return Q===void 0&&(T.keys[q]=T.id,Q=T.keys[q],T.id+=1),{name:q,key:Q,isListField:!0}}),H,x)})))};function vfe(e){var n=!1,o=e.length,s=[];return e.length?new Promise(function(c,d){e.forEach(function(p,m){p.catch(function(g){return n=!0,g}).then(function(g){o-=1,s[m]=g,!(o>0)&&(n&&d(s),c(s))})})}):Promise.resolve([])}var o7="__@field_split__";function S1(e){return e.map(function(n){return"".concat(jn(n),":").concat(n)}).join(o7)}var rp=function(){function e(){bs(this,e),this.kvs=new Map}return Ts(e,[{key:"set",value:function(o,s){this.kvs.set(S1(o),s)}},{key:"get",value:function(o){return this.kvs.get(S1(o))}},{key:"update",value:function(o,s){var c=this.get(o),d=s(c);d?this.set(o,d):this.delete(o)}},{key:"delete",value:function(o){this.kvs.delete(S1(o))}},{key:"map",value:function(o){return ot(this.kvs.entries()).map(function(s){var c=We(s,2),d=c[0],p=c[1],m=d.split(o7);return o({key:m.map(function(g){var _=g.match(/^([^:]*):(.*)$/),S=We(_,3),T=S[1],R=S[2];return T==="number"?Number(R):R}),value:p})})}},{key:"toJSON",value:function(){var o={};return this.map(function(s){var c=s.key,d=s.value;return o[c.join(".")]=d,null}),o}}]),e}(),Efe=["name"],_fe=Ts(function e(n){var o=this;bs(this,e),this.formHooked=!1,this.forceRootUpdate=void 0,this.subscribable=!0,this.store={},this.fieldEntities=[],this.initialValues={},this.callbacks={},this.validateMessages=null,this.preserve=null,this.lastValidatePromise=null,this.getForm=function(){return{getFieldValue:o.getFieldValue,getFieldsValue:o.getFieldsValue,getFieldError:o.getFieldError,getFieldWarning:o.getFieldWarning,getFieldsError:o.getFieldsError,isFieldsTouched:o.isFieldsTouched,isFieldTouched:o.isFieldTouched,isFieldValidating:o.isFieldValidating,isFieldsValidating:o.isFieldsValidating,resetFields:o.resetFields,setFields:o.setFields,setFieldValue:o.setFieldValue,setFieldsValue:o.setFieldsValue,validateFields:o.validateFields,submit:o.submit,_init:!0,getInternalHooks:o.getInternalHooks}},this.getInternalHooks=function(s){return s===Id?(o.formHooked=!0,{dispatch:o.dispatch,initEntityValue:o.initEntityValue,registerField:o.registerField,useSubscribe:o.useSubscribe,setInitialValues:o.setInitialValues,destroyForm:o.destroyForm,setCallbacks:o.setCallbacks,setValidateMessages:o.setValidateMessages,getFields:o.getFields,setPreserve:o.setPreserve,getInitialValue:o.getInitialValue,registerWatch:o.registerWatch}):(ma(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)},this.useSubscribe=function(s){o.subscribable=s},this.prevWithoutPreserves=null,this.setInitialValues=function(s,c){if(o.initialValues=s||{},c){var d,p=Ap(s,o.store);(d=o.prevWithoutPreserves)===null||d===void 0||d.map(function(m){var g=m.key;p=Ws(p,g,Ys(s,g))}),o.prevWithoutPreserves=null,o.updateStore(p)}},this.destroyForm=function(){var s=new rp;o.getFieldEntities(!0).forEach(function(c){o.isMergedPreserve(c.isPreserve())||s.set(c.getNamePath(),!0)}),o.prevWithoutPreserves=s},this.getInitialValue=function(s){var c=Ys(o.initialValues,s);return s.length?Ap(c):c},this.setCallbacks=function(s){o.callbacks=s},this.setValidateMessages=function(s){o.validateMessages=s},this.setPreserve=function(s){o.preserve=s},this.watchList=[],this.registerWatch=function(s){return o.watchList.push(s),function(){o.watchList=o.watchList.filter(function(c){return c!==s})}},this.notifyWatch=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(o.watchList.length){var c=o.getFieldsValue(),d=o.getFieldsValue(!0);o.watchList.forEach(function(p){p(c,d,s)})}},this.timeoutId=null,this.warningUnhooked=function(){},this.updateStore=function(s){o.store=s},this.getFieldEntities=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return s?o.fieldEntities.filter(function(c){return c.getNamePath().length}):o.fieldEntities},this.getFieldsMap=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,c=new rp;return o.getFieldEntities(s).forEach(function(d){var p=d.getNamePath();c.set(p,d)}),c},this.getFieldEntitiesForNamePathList=function(s){if(!s)return o.getFieldEntities(!0);var c=o.getFieldsMap(!0);return s.map(function(d){var p=Ei(d);return c.get(p)||{INVALIDATE_NAME_PATH:Ei(d)}})},this.getFieldsValue=function(s,c){if(o.warningUnhooked(),s===!0&&!c)return o.store;var d=o.getFieldEntitiesForNamePathList(Array.isArray(s)?s:null),p=[];return d.forEach(function(m){var g,_="INVALIDATE_NAME_PATH"in m?m.INVALIDATE_NAME_PATH:m.getNamePath();if(!(!s&&(!((g=m.isListField)===null||g===void 0)&&g.call(m))))if(!c)p.push(_);else{var S="getMeta"in m?m.getMeta():null;c(S)&&p.push(_)}}),d5(o.store,p.map(Ei))},this.getFieldValue=function(s){o.warningUnhooked();var c=Ei(s);return Ys(o.store,c)},this.getFieldsError=function(s){o.warningUnhooked();var c=o.getFieldEntitiesForNamePathList(s);return c.map(function(d,p){return d&&!("INVALIDATE_NAME_PATH"in d)?{name:d.getNamePath(),errors:d.getErrors(),warnings:d.getWarnings()}:{name:Ei(s[p]),errors:[],warnings:[]}})},this.getFieldError=function(s){o.warningUnhooked();var c=Ei(s),d=o.getFieldsError([c])[0];return d.errors},this.getFieldWarning=function(s){o.warningUnhooked();var c=Ei(s),d=o.getFieldsError([c])[0];return d.warnings},this.isFieldsTouched=function(){o.warningUnhooked();for(var s=arguments.length,c=new Array(s),d=0;d<s;d++)c[d]=arguments[d];var p=c[0],m=c[1],g,_=!1;c.length===0?g=null:c.length===1?Array.isArray(p)?(g=p.map(Ei),_=!1):(g=null,_=p):(g=p.map(Ei),_=m);var S=o.getFieldEntities(!0),T=function(M){return M.isFieldTouched()};if(!g)return _?S.every(T):S.some(T);var R=new rp;g.forEach(function(A){R.set(A,[])}),S.forEach(function(A){var M=A.getNamePath();g.forEach(function(x){x.every(function(P,D){return M[D]===P})&&R.update(x,function(P){return[].concat(ot(P),[A])})})});var N=function(M){return M.some(T)},O=R.map(function(A){var M=A.value;return M});return _?O.every(N):O.some(N)},this.isFieldTouched=function(s){return o.warningUnhooked(),o.isFieldsTouched([s])},this.isFieldsValidating=function(s){o.warningUnhooked();var c=o.getFieldEntities();if(!s)return c.some(function(p){return p.isFieldValidating()});var d=s.map(Ei);return c.some(function(p){var m=p.getNamePath();return om(d,m)&&p.isFieldValidating()})},this.isFieldValidating=function(s){return o.warningUnhooked(),o.isFieldsValidating([s])},this.resetWithFieldInitialValue=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=new rp,d=o.getFieldEntities(!0);d.forEach(function(g){var _=g.props.initialValue,S=g.getNamePath();if(_!==void 0){var T=c.get(S)||new Set;T.add({entity:g,value:_}),c.set(S,T)}});var p=function(_){_.forEach(function(S){var T=S.props.initialValue;if(T!==void 0){var R=S.getNamePath(),N=o.getInitialValue(R);if(N!==void 0)ma(!1,"Form already set 'initialValues' with path '".concat(R.join("."),"'. Field can not overwrite it."));else{var O=c.get(R);if(O&&O.size>1)ma(!1,"Multiple Field with path '".concat(R.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(O){var A=o.getFieldValue(R);(!s.skipExist||A===void 0)&&o.updateStore(Ws(o.store,R,ot(O)[0].value))}}}})},m;s.entities?m=s.entities:s.namePathList?(m=[],s.namePathList.forEach(function(g){var _=c.get(g);if(_){var S;(S=m).push.apply(S,ot(ot(_).map(function(T){return T.entity})))}})):m=d,p(m)},this.resetFields=function(s){o.warningUnhooked();var c=o.store;if(!s){o.updateStore(Ap(o.initialValues)),o.resetWithFieldInitialValue(),o.notifyObservers(c,null,{type:"reset"}),o.notifyWatch();return}var d=s.map(Ei);d.forEach(function(p){var m=o.getInitialValue(p);o.updateStore(Ws(o.store,p,m))}),o.resetWithFieldInitialValue({namePathList:d}),o.notifyObservers(c,d,{type:"reset"}),o.notifyWatch(d)},this.setFields=function(s){o.warningUnhooked();var c=o.store,d=[];s.forEach(function(p){var m=p.name,g=xn(p,Efe),_=Ei(m);d.push(_),"value"in g&&o.updateStore(Ws(o.store,_,g.value)),o.notifyObservers(c,[_],{type:"setField",data:p})}),o.notifyWatch(d)},this.getFields=function(){var s=o.getFieldEntities(!0),c=s.map(function(d){var p=d.getNamePath(),m=d.getMeta(),g=Ae(Ae({},m),{},{name:p,value:o.getFieldValue(p)});return Object.defineProperty(g,"originRCField",{value:!0}),g});return c},this.initEntityValue=function(s){var c=s.props.initialValue;if(c!==void 0){var d=s.getNamePath(),p=Ys(o.store,d);p===void 0&&o.updateStore(Ws(o.store,d,c))}},this.isMergedPreserve=function(s){var c=s!==void 0?s:o.preserve;return c??!0},this.registerField=function(s){o.fieldEntities.push(s);var c=s.getNamePath();if(o.notifyWatch([c]),s.props.initialValue!==void 0){var d=o.store;o.resetWithFieldInitialValue({entities:[s],skipExist:!0}),o.notifyObservers(d,[s.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(p,m){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(o.fieldEntities=o.fieldEntities.filter(function(T){return T!==s}),!o.isMergedPreserve(m)&&(!p||g.length>1)){var _=p?void 0:o.getInitialValue(c);if(c.length&&o.getFieldValue(c)!==_&&o.fieldEntities.every(function(T){return!r7(T.getNamePath(),c)})){var S=o.store;o.updateStore(Ws(S,c,_,!0)),o.notifyObservers(S,[c],{type:"remove"}),o.triggerDependenciesUpdate(S,c)}}o.notifyWatch([c])}},this.dispatch=function(s){switch(s.type){case"updateValue":{var c=s.namePath,d=s.value;o.updateValue(c,d);break}case"validateField":{var p=s.namePath,m=s.triggerName;o.validateFields([p],{triggerName:m});break}}},this.notifyObservers=function(s,c,d){if(o.subscribable){var p=Ae(Ae({},d),{},{store:o.getFieldsValue(!0)});o.getFieldEntities().forEach(function(m){var g=m.onStoreChange;g(s,c,p)})}else o.forceRootUpdate()},this.triggerDependenciesUpdate=function(s,c){var d=o.getDependencyChildrenFields(c);return d.length&&o.validateFields(d),o.notifyObservers(s,d,{type:"dependenciesUpdate",relatedFields:[c].concat(ot(d))}),d},this.updateValue=function(s,c){var d=Ei(s),p=o.store;o.updateStore(Ws(o.store,d,c)),o.notifyObservers(p,[d],{type:"valueUpdate",source:"internal"}),o.notifyWatch([d]);var m=o.triggerDependenciesUpdate(p,d),g=o.callbacks.onValuesChange;if(g){var _=d5(o.store,[d]);g(_,o.getFieldsValue())}o.triggerOnFieldsChange([d].concat(ot(m)))},this.setFieldsValue=function(s){o.warningUnhooked();var c=o.store;if(s){var d=Ap(o.store,s);o.updateStore(d)}o.notifyObservers(c,null,{type:"valueUpdate",source:"external"}),o.notifyWatch()},this.setFieldValue=function(s,c){o.setFields([{name:s,value:c}])},this.getDependencyChildrenFields=function(s){var c=new Set,d=[],p=new rp;o.getFieldEntities().forEach(function(g){var _=g.props.dependencies;(_||[]).forEach(function(S){var T=Ei(S);p.update(T,function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Set;return R.add(g),R})})});var m=function g(_){var S=p.get(_)||new Set;S.forEach(function(T){if(!c.has(T)){c.add(T);var R=T.getNamePath();T.isFieldDirty()&&R.length&&(d.push(R),g(R))}})};return m(s),d},this.triggerOnFieldsChange=function(s,c){var d=o.callbacks.onFieldsChange;if(d){var p=o.getFields();if(c){var m=new rp;c.forEach(function(_){var S=_.name,T=_.errors;m.set(S,T)}),p.forEach(function(_){_.errors=m.get(_.name)||_.errors})}var g=p.filter(function(_){var S=_.name;return om(s,S)});g.length&&d(g,p)}},this.validateFields=function(s,c){o.warningUnhooked();var d,p;Array.isArray(s)||typeof s=="string"||typeof c=="string"?(d=s,p=c):p=s;var m=!!d,g=m?d.map(Ei):[],_=[],S=String(Date.now()),T=new Set;o.getFieldEntities(!0).forEach(function(A){var M;if(m||g.push(A.getNamePath()),!((M=p)===null||M===void 0)&&M.recursive&&m){var x=A.getNamePath();x.every(function(F,j){return d[j]===F||d[j]===void 0})&&g.push(x)}if(!(!A.props.rules||!A.props.rules.length)){var P=A.getNamePath();if(T.add(P.join(S)),!m||om(g,P)){var D=A.validateRules(Ae({validateMessages:Ae(Ae({},n7),o.validateMessages)},p));_.push(D.then(function(){return{name:P,errors:[],warnings:[]}}).catch(function(F){var j,B=[],H=[];return(j=F.forEach)===null||j===void 0||j.call(F,function(K){var J=K.rule.warningOnly,q=K.errors;J?H.push.apply(H,ot(q)):B.push.apply(B,ot(q))}),B.length?Promise.reject({name:P,errors:B,warnings:H}):{name:P,errors:B,warnings:H}}))}}});var R=vfe(_);o.lastValidatePromise=R,R.catch(function(A){return A}).then(function(A){var M=A.map(function(x){var P=x.name;return P});o.notifyObservers(o.store,M,{type:"validateFinish"}),o.triggerOnFieldsChange(M,A)});var N=R.then(function(){return o.lastValidatePromise===R?Promise.resolve(o.getFieldsValue(g)):Promise.reject([])}).catch(function(A){var M=A.filter(function(x){return x&&x.errors.length});return Promise.reject({values:o.getFieldsValue(g),errorFields:M,outOfDate:o.lastValidatePromise!==R})});N.catch(function(A){return A});var O=g.filter(function(A){return T.has(A.join(S))});return o.triggerOnFieldsChange(O),N},this.submit=function(){o.warningUnhooked(),o.validateFields().then(function(s){var c=o.callbacks.onFinish;if(c)try{c(s)}catch(d){console.error(d)}}).catch(function(s){var c=o.callbacks.onFinishFailed;c&&c(s)})},this.forceRootUpdate=n});function JO(e){var n=b.useRef(),o=b.useState({}),s=We(o,2),c=s[1];if(!n.current)if(e)n.current=e;else{var d=function(){c({})},p=new _fe(d);n.current=p.getForm()}return[n.current]}var sA=b.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),a7=function(n){var o=n.validateMessages,s=n.onFormChange,c=n.onFormFinish,d=n.children,p=b.useContext(sA),m=b.useRef({});return b.createElement(sA.Provider,{value:Ae(Ae({},p),{},{validateMessages:Ae(Ae({},p.validateMessages),o),triggerFormChange:function(_,S){s&&s(_,{changedFields:S,forms:m.current}),p.triggerFormChange(_,S)},triggerFormFinish:function(_,S){c&&c(_,{values:S,forms:m.current}),p.triggerFormFinish(_,S)},registerForm:function(_,S){_&&(m.current=Ae(Ae({},m.current),{},st({},_,S))),p.registerForm(_,S)},unregisterForm:function(_){var S=Ae({},m.current);delete S[_],m.current=S,p.unregisterForm(_)}})},d)},yfe=["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed"],Sfe=function(n,o){var s=n.name,c=n.initialValues,d=n.fields,p=n.form,m=n.preserve,g=n.children,_=n.component,S=_===void 0?"form":_,T=n.validateMessages,R=n.validateTrigger,N=R===void 0?"onChange":R,O=n.onValuesChange,A=n.onFieldsChange,M=n.onFinish,x=n.onFinishFailed,P=xn(n,yfe),D=b.useContext(sA),F=JO(p),j=We(F,1),B=j[0],H=B.getInternalHooks(Id),K=H.useSubscribe,J=H.setInitialValues,q=H.setCallbacks,Q=H.setValidateMessages,ee=H.setPreserve,ne=H.destroyForm;b.useImperativeHandle(o,function(){return B}),b.useEffect(function(){return D.registerForm(s,B),function(){D.unregisterForm(s)}},[D,B,s]),Q(Ae(Ae({},D.validateMessages),T)),q({onValuesChange:O,onFieldsChange:function(de){if(D.triggerFormChange(s,de),A){for(var ye=arguments.length,fe=new Array(ye>1?ye-1:0),ke=1;ke<ye;ke++)fe[ke-1]=arguments[ke];A.apply(void 0,[de].concat(fe))}},onFinish:function(de){D.triggerFormFinish(s,de),M&&M(de)},onFinishFailed:x}),ee(m);var he=b.useRef(null);J(c,!he.current),he.current||(he.current=!0),b.useEffect(function(){return ne},[]);var pe,ce=typeof g=="function";if(ce){var se=B.getFieldsValue(!0);pe=g(se,B)}else pe=g;K(!ce);var ae=b.useRef();b.useEffect(function(){ffe(ae.current||[],d||[])||B.setFields(d||[]),ae.current=d},[d,B]);var Ee=b.useMemo(function(){return Ae(Ae({},B),{},{validateTrigger:N})},[B,N]),ve=b.createElement(Pm.Provider,{value:null},b.createElement($d.Provider,{value:Ee},pe));return S===!1?ve:b.createElement(S,Qe({},P,{onSubmit:function(de){de.preventDefault(),de.stopPropagation(),B.submit()},onReset:function(de){var ye;de.preventDefault(),B.resetFields(),(ye=P.onReset)===null||ye===void 0||ye.call(P,de)}}),ve)};function f5(e){try{return JSON.stringify(e)}catch{return Math.random()}}function s7(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];var s=n[0],c=s===void 0?[]:s,d=n[1],p=d===void 0?{}:d,m=Npe(p)?{form:p}:p,g=m.form,_=b.useState(),S=We(_,2),T=S[0],R=S[1],N=b.useMemo(function(){return f5(T)},[T]),O=b.useRef(N);O.current=N;var A=b.useContext($d),M=g||A,x=M&&M._init,P=Ei(c),D=b.useRef(P);return D.current=P,b.useEffect(function(){if(x){var F=M.getFieldsValue,j=M.getInternalHooks,B=j(Id),H=B.registerWatch,K=H(function(q,Q){var ee=Ys(m.preserve?Q:q,D.current),ne=f5(ee);O.current!==ne&&(O.current=ne,R(ee))}),J=Ys(m.preserve?F(!0):F(),D.current);return R(J),K}},[x]),T}var Cfe=b.forwardRef(Sfe),lf=Cfe;lf.FormProvider=a7;lf.Field=XO;lf.List=i7;lf.useForm=JO;lf.useWatch=s7;const Ou=b.createContext({labelAlign:"right",vertical:!1,itemRef:()=>{}}),c7=b.createContext(null),l7=e=>{const n=Ea(e,["prefixCls"]);return b.createElement(a7,Object.assign({},n))},QO=b.createContext({prefixCls:""}),El=b.createContext({}),m5=e=>{let{children:n,status:o,override:s}=e;const c=b.useContext(El),d=b.useMemo(()=>{const p=Object.assign({},c);return s&&delete p.isFormItemInput,o&&(delete p.status,delete p.hasFeedback,delete p.feedbackIcon),p},[o,s,c]);return b.createElement(El.Provider,{value:d},n)},bfe=e=>({animationDuration:e,animationFillMode:"both"}),Tfe=e=>({animationDuration:e,animationFillMode:"both"}),u7=function(e,n,o,s){const d=(arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1)?"&":"";return{[`
      ${d}${e}-enter,
      ${d}${e}-appear
    `]:Object.assign(Object.assign({},bfe(s)),{animationPlayState:"paused"}),[`${d}${e}-leave`]:Object.assign(Object.assign({},Tfe(s)),{animationPlayState:"paused"}),[`
      ${d}${e}-enter${e}-enter-active,
      ${d}${e}-appear${e}-appear-active
    `]:{animationName:n,animationPlayState:"running"},[`${d}${e}-leave${e}-leave-active`]:{animationName:o,animationPlayState:"running",pointerEvents:"none"}}},Rfe=new Pr("antSlideUpIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1}}),wfe=new Pr("antSlideUpOut",{"0%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0}}),Ife=new Pr("antSlideDownIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1}}),Afe=new Pr("antSlideDownOut",{"0%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0}}),Ofe=new Pr("antSlideLeftIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1}}),xfe=new Pr("antSlideLeftOut",{"0%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0}}),Nfe=new Pr("antSlideRightIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1}}),Pfe=new Pr("antSlideRightOut",{"0%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0}}),Dfe={"slide-up":{inKeyframes:Rfe,outKeyframes:wfe},"slide-down":{inKeyframes:Ife,outKeyframes:Afe},"slide-left":{inKeyframes:Ofe,outKeyframes:xfe},"slide-right":{inKeyframes:Nfe,outKeyframes:Pfe}},g5=(e,n)=>{const{antCls:o}=e,s=`${o}-${n}`,{inKeyframes:c,outKeyframes:d}=Dfe[n];return[u7(s,c,d,e.motionDurationMid),{[`
      ${s}-enter,
      ${s}-appear
    `]:{transform:"scale(0)",transformOrigin:"0% 0%",opacity:0,animationTimingFunction:e.motionEaseOutQuint,"&-prepare":{transform:"scale(1)"}},[`${s}-leave`]:{animationTimingFunction:e.motionEaseInQuint}}]},ZO=new Pr("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),kfe=new Pr("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),v5=new Pr("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),E5=new Pr("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),Lfe=new Pr("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),Mfe=new Pr("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),Ffe=new Pr("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),Ufe=new Pr("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}}),Bfe=new Pr("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),jfe=new Pr("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}}),Vfe=new Pr("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),$fe=new Pr("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}}),Hfe={zoom:{inKeyframes:ZO,outKeyframes:kfe},"zoom-big":{inKeyframes:v5,outKeyframes:E5},"zoom-big-fast":{inKeyframes:v5,outKeyframes:E5},"zoom-left":{inKeyframes:Ffe,outKeyframes:Ufe},"zoom-right":{inKeyframes:Bfe,outKeyframes:jfe},"zoom-up":{inKeyframes:Lfe,outKeyframes:Mfe},"zoom-down":{inKeyframes:Vfe,outKeyframes:$fe}},d7=(e,n)=>{const{antCls:o}=e,s=`${o}-${n}`,{inKeyframes:c,outKeyframes:d}=Hfe[n];return[u7(s,c,d,n==="zoom-big-fast"?e.motionDurationFast:e.motionDurationMid),{[`
        ${s}-enter,
        ${s}-appear
      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:e.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${s}-leave`]:{animationTimingFunction:e.motionEaseInOutCirc}}]},Wfe=e=>({[e.componentCls]:{[`${e.antCls}-motion-collapse-legacy`]:{overflow:"hidden","&-active":{transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},
        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}},[`${e.antCls}-motion-collapse`]:{overflow:"hidden",transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},
        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}}}),h7=Wfe,zfe=e=>{const{componentCls:n,width:o,notificationMarginEdge:s}=e,c=new Pr("antNotificationTopFadeIn",{"0%":{marginTop:"-100%",opacity:0},"100%":{marginTop:0,opacity:1}}),d=new Pr("antNotificationBottomFadeIn",{"0%":{marginBottom:"-100%",opacity:0},"100%":{marginBottom:0,opacity:1}}),p=new Pr("antNotificationLeftFadeIn",{"0%":{right:{_skip_check_:!0,value:o},opacity:0},"100%":{right:{_skip_check_:!0,value:0},opacity:1}});return{[`&${n}-top, &${n}-bottom`]:{marginInline:0},[`&${n}-top`]:{[`${n}-fade-enter${n}-fade-enter-active, ${n}-fade-appear${n}-fade-appear-active`]:{animationName:c}},[`&${n}-bottom`]:{[`${n}-fade-enter${n}-fade-enter-active, ${n}-fade-appear${n}-fade-appear-active`]:{animationName:d}},[`&${n}-topLeft, &${n}-bottomLeft`]:{marginInlineEnd:0,marginInlineStart:s,[`${n}-fade-enter${n}-fade-enter-active, ${n}-fade-appear${n}-fade-appear-active`]:{animationName:p}}}},Gfe=zfe,Kfe=e=>{const{iconCls:n,componentCls:o,boxShadow:s,fontSizeLG:c,notificationMarginBottom:d,borderRadiusLG:p,colorSuccess:m,colorInfo:g,colorWarning:_,colorError:S,colorTextHeading:T,notificationBg:R,notificationPadding:N,notificationMarginEdge:O,motionDurationMid:A,motionEaseInOut:M,fontSize:x,lineHeight:P,width:D,notificationIconSize:F,colorText:j}=e,B=`${o}-notice`,H=new Pr("antNotificationFadeIn",{"0%":{left:{_skip_check_:!0,value:D},opacity:0},"100%":{left:{_skip_check_:!0,value:0},opacity:1}}),K=new Pr("antNotificationFadeOut",{"0%":{maxHeight:e.animationMaxHeight,marginBottom:d,opacity:1},"100%":{maxHeight:0,marginBottom:0,paddingTop:0,paddingBottom:0,opacity:0}}),J={position:"relative",width:D,maxWidth:`calc(100vw - ${O*2}px)`,marginBottom:d,marginInlineStart:"auto",padding:N,overflow:"hidden",lineHeight:P,wordWrap:"break-word",background:R,borderRadius:p,boxShadow:s,[`${o}-close-icon`]:{fontSize:x,cursor:"pointer"},[`${B}-message`]:{marginBottom:e.marginXS,color:T,fontSize:c,lineHeight:e.lineHeightLG},[`${B}-description`]:{fontSize:x,color:j},[`&${B}-closable ${B}-message`]:{paddingInlineEnd:e.paddingLG},[`${B}-with-icon ${B}-message`]:{marginBottom:e.marginXS,marginInlineStart:e.marginSM+F,fontSize:c},[`${B}-with-icon ${B}-description`]:{marginInlineStart:e.marginSM+F,fontSize:x},[`${B}-icon`]:{position:"absolute",fontSize:F,lineHeight:0,[`&-success${n}`]:{color:m},[`&-info${n}`]:{color:g},[`&-warning${n}`]:{color:_},[`&-error${n}`]:{color:S}},[`${B}-close`]:{position:"absolute",top:e.notificationPaddingVertical,insetInlineEnd:e.notificationPaddingHorizontal,color:e.colorIcon,outline:"none",width:e.notificationCloseButtonSize,height:e.notificationCloseButtonSize,borderRadius:e.borderRadiusSM,transition:`background-color ${e.motionDurationMid}, color ${e.motionDurationMid}`,display:"flex",alignItems:"center",justifyContent:"center","&:hover":{color:e.colorIconHover,backgroundColor:e.wireframe?"transparent":e.colorFillContent}},[`${B}-btn`]:{float:"right",marginTop:e.marginSM}};return[{[o]:Object.assign(Object.assign(Object.assign(Object.assign({},Kd(e)),{position:"fixed",zIndex:e.zIndexPopup,marginInlineEnd:O,[`${o}-hook-holder`]:{position:"relative"},[`&${o}-top, &${o}-bottom`]:{[B]:{marginInline:"auto auto"}},[`&${o}-topLeft, &${o}-bottomLeft`]:{[B]:{marginInlineEnd:"auto",marginInlineStart:0}},[`${o}-fade-enter, ${o}-fade-appear`]:{animationDuration:e.motionDurationMid,animationTimingFunction:M,animationFillMode:"both",opacity:0,animationPlayState:"paused"},[`${o}-fade-leave`]:{animationTimingFunction:M,animationFillMode:"both",animationDuration:A,animationPlayState:"paused"},[`${o}-fade-enter${o}-fade-enter-active, ${o}-fade-appear${o}-fade-appear-active`]:{animationName:H,animationPlayState:"running"},[`${o}-fade-leave${o}-fade-leave-active`]:{animationName:K,animationPlayState:"running"}}),Gfe(e)),{"&-rtl":{direction:"rtl",[`${B}-btn`]:{float:"left"}}})},{[o]:{[B]:Object.assign({},J)}},{[`${B}-pure-panel`]:Object.assign(Object.assign({},J),{margin:0})}]},p7=ic("Notification",e=>{const n=e.paddingMD,o=e.paddingLG,s=lo(e,{notificationBg:e.colorBgElevated,notificationPaddingVertical:n,notificationPaddingHorizontal:o,notificationIconSize:e.fontSizeLG*e.lineHeightLG,notificationCloseButtonSize:e.controlHeightLG*.55,notificationMarginBottom:e.margin,notificationPadding:`${e.paddingMD}px ${e.paddingContentHorizontalLG}px`,notificationMarginEdge:e.marginLG,animationMaxHeight:150});return[Kfe(s)]},e=>({zIndexPopup:e.zIndexPopupBase+50,width:384}));var qfe=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function f7(e,n){return n||b.createElement("span",{className:`${e}-close-x`},b.createElement(jde,{className:`${e}-close-icon`}))}const Yfe={success:L$,info:the,error:fS,warning:B$};function m7(e){let{prefixCls:n,icon:o,type:s,message:c,description:d,btn:p,role:m="alert"}=e,g=null;return o?g=b.createElement("span",{className:`${n}-icon`},o):s&&(g=b.createElement(Yfe[s]||null,{className:Ye(`${n}-icon`,`${n}-icon-${s}`)})),b.createElement("div",{className:Ye({[`${n}-with-icon`]:g}),role:m},g,b.createElement("div",{className:`${n}-message`},c),b.createElement("div",{className:`${n}-description`},d),p&&b.createElement("div",{className:`${n}-btn`},p))}function Xfe(e){const{prefixCls:n,className:o,icon:s,type:c,message:d,description:p,btn:m,closable:g=!0,closeIcon:_}=e,S=qfe(e,["prefixCls","className","icon","type","message","description","btn","closable","closeIcon"]),{getPrefixCls:T}=b.useContext(nr),R=n||T("notification"),N=`${R}-notice`,[,O]=p7(R);return b.createElement($$,Object.assign({},S,{prefixCls:R,className:Ye(o,O,`${N}-pure-panel`),eventKey:"pure",duration:null,closable:g,closeIcon:f7(R,_),content:b.createElement(m7,{prefixCls:N,icon:s,type:c,message:d,description:p,btn:m})}))}function Jfe(e,n,o){let s;switch(e){case"top":s={left:"50%",transform:"translateX(-50%)",right:"auto",top:n,bottom:"auto"};break;case"topLeft":s={left:0,top:n,bottom:"auto"};break;case"topRight":s={right:0,top:n,bottom:"auto"};break;case"bottom":s={left:"50%",transform:"translateX(-50%)",right:"auto",top:"auto",bottom:o};break;case"bottomLeft":s={left:0,top:"auto",bottom:o};break;default:s={right:0,top:"auto",bottom:o};break}return s}function Qfe(e){return{motionName:`${e}-fade`}}var Zfe=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const _5=24,e0e=4.5,t0e=b.forwardRef((e,n)=>{const{top:o,bottom:s,prefixCls:c,getContainer:d,maxCount:p,rtl:m,onAllRemoved:g}=e,{getPrefixCls:_,getPopupContainer:S}=b.useContext(nr),T=c||_("notification"),R=P=>Jfe(P,o??_5,s??_5),[,N]=p7(T),O=()=>Ye(N,{[`${T}-rtl`]:m}),A=()=>Qfe(T),[M,x]=dhe({prefixCls:T,style:R,className:O,motion:A,closable:!0,closeIcon:f7(T),duration:e0e,getContainer:()=>(d==null?void 0:d())||(S==null?void 0:S())||document.body,maxCount:p,onAllRemoved:g});return b.useImperativeHandle(n,()=>Object.assign(Object.assign({},M),{prefixCls:T,hashId:N})),x});function g7(e){const n=b.useRef(null);return[b.useMemo(()=>{const s=m=>{if(!n.current)return;const{open:g,prefixCls:_,hashId:S}=n.current,T=`${_}-notice`,{message:R,description:N,icon:O,type:A,btn:M,className:x,role:P="alert"}=m,D=Zfe(m,["message","description","icon","type","btn","className","role"]);return g(Object.assign(Object.assign({placement:"topRight"},D),{content:b.createElement(m7,{prefixCls:T,icon:O,type:A,message:R,description:N,btn:M,role:P}),className:Ye(A&&`${T}-${A}`,S,x)}))},d={open:s,destroy:m=>{var g,_;m!==void 0?(g=n.current)===null||g===void 0||g.close(m):(_=n.current)===null||_===void 0||_.destroy()}};return["success","info","warning","error"].forEach(m=>{d[m]=g=>s(Object.assign(Object.assign({},g),{type:m}))}),d},[]),b.createElement(t0e,Object.assign({key:"notification-holder"},e,{ref:n}))]}function n0e(e){return g7(e)}const r0e=function(){if(typeof navigator>"u"||typeof window>"u")return!1;var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e==null?void 0:e.substr(0,4))};var i0e=["prefixCls","invalidate","item","renderItem","responsive","responsiveDisabled","registerSize","itemKey","className","style","children","display","order","component"],ip=void 0;function o0e(e,n){var o=e.prefixCls,s=e.invalidate,c=e.item,d=e.renderItem,p=e.responsive,m=e.responsiveDisabled,g=e.registerSize,_=e.itemKey,S=e.className,T=e.style,R=e.children,N=e.display,O=e.order,A=e.component,M=A===void 0?"div":A,x=xn(e,i0e),P=p&&!N;function D(K){g(_,K)}b.useEffect(function(){return function(){D(null)}},[]);var F=d&&c!==ip?d(c):R,j;s||(j={opacity:P?0:1,height:P?0:ip,overflowY:P?"hidden":ip,order:p?O:ip,pointerEvents:P?"none":ip,position:P?"absolute":ip});var B={};P&&(B["aria-hidden"]=!0);var H=b.createElement(M,Qe({className:Ye(!s&&o,S),style:Ae(Ae({},j),T)},B,x,{ref:n}),F);return p&&(H=b.createElement(Gd,{onResize:function(J){var q=J.offsetWidth;D(q)},disabled:m},H)),H}var am=b.forwardRef(o0e);am.displayName="Item";function a0e(e){if(typeof MessageChannel>"u")ao(e);else{var n=new MessageChannel;n.port1.onmessage=function(){return e()},n.port2.postMessage(void 0)}}function s0e(){var e=b.useRef(null),n=function(s){e.current||(e.current=[],a0e(function(){Cl.unstable_batchedUpdates(function(){e.current.forEach(function(c){c()}),e.current=null})})),e.current.push(s)};return n}function P0(e,n){var o=b.useState(n),s=We(o,2),c=s[0],d=s[1],p=qs(function(m){e(function(){d(m)})});return[c,p]}var hy=Et.createContext(null),c0e=["component"],l0e=["className"],u0e=["className"],d0e=function(n,o){var s=b.useContext(hy);if(!s){var c=n.component,d=c===void 0?"div":c,p=xn(n,c0e);return b.createElement(d,Qe({},p,{ref:o}))}var m=s.className,g=xn(s,l0e),_=n.className,S=xn(n,u0e);return b.createElement(hy.Provider,{value:null},b.createElement(am,Qe({ref:o,className:Ye(m,_)},g,S)))},v7=b.forwardRef(d0e);v7.displayName="RawItem";var h0e=["prefixCls","data","renderItem","renderRawItem","itemKey","itemWidth","ssr","style","className","maxCount","renderRest","renderRawRest","suffix","component","itemComponent","onVisibleChange"],E7="responsive",_7="invalidate";function p0e(e){return"+ ".concat(e.length," ...")}function f0e(e,n){var o=e.prefixCls,s=o===void 0?"rc-overflow":o,c=e.data,d=c===void 0?[]:c,p=e.renderItem,m=e.renderRawItem,g=e.itemKey,_=e.itemWidth,S=_===void 0?10:_,T=e.ssr,R=e.style,N=e.className,O=e.maxCount,A=e.renderRest,M=e.renderRawRest,x=e.suffix,P=e.component,D=P===void 0?"div":P,F=e.itemComponent,j=e.onVisibleChange,B=xn(e,h0e),H=T==="full",K=s0e(),J=P0(K,null),q=We(J,2),Q=q[0],ee=q[1],ne=Q||0,he=P0(K,new Map),pe=We(he,2),ce=pe[0],se=pe[1],ae=P0(K,0),Ee=We(ae,2),ve=Ee[0],le=Ee[1],de=P0(K,0),ye=We(de,2),fe=ye[0],ke=ye[1],Me=P0(K,0),Ve=We(Me,2),je=Ve[0],dt=Ve[1],ut=b.useState(null),Ct=We(ut,2),_t=Ct[0],Tt=Ct[1],it=b.useState(null),kt=We(it,2),qt=kt[0],xt=kt[1],ze=b.useMemo(function(){return qt===null&&H?Number.MAX_SAFE_INTEGER:qt||0},[qt,Q]),ct=b.useState(!1),et=We(ct,2),tt=et[0],mt=et[1],Ot="".concat(s,"-item"),Ht=Math.max(ve,fe),hn=O===E7,Lt=d.length&&hn,br=O===_7,Xt=Lt||typeof O=="number"&&d.length>O,In=b.useMemo(function(){var jt=d;return Lt?Q===null&&H?jt=d:jt=d.slice(0,Math.min(d.length,ne/S)):typeof O=="number"&&(jt=d.slice(0,O)),jt},[d,S,Q,O,Lt]),Hr=b.useMemo(function(){return Lt?d.slice(ze+1):d.slice(In.length)},[d,In,Lt,ze]),sn=b.useCallback(function(jt,pn){var Pn;return typeof g=="function"?g(jt):(Pn=g&&(jt==null?void 0:jt[g]))!==null&&Pn!==void 0?Pn:pn},[g]),Dr=b.useCallback(p||function(jt){return jt},[p]);function Qn(jt,pn,Pn){qt===jt&&(pn===void 0||pn===_t)||(xt(jt),Pn||(mt(jt<d.length-1),j==null||j(jt)),pn!==void 0&&Tt(pn))}function Ut(jt,pn){ee(pn.clientWidth)}function Jt(jt,pn){se(function(Pn){var Vn=new Map(Pn);return pn===null?Vn.delete(jt):Vn.set(jt,pn),Vn})}function ai(jt,pn){ke(pn),le(fe)}function Gn(jt,pn){dt(pn)}function kr(jt){return ce.get(sn(In[jt],jt))}qr(function(){if(ne&&typeof Ht=="number"&&In){var jt=je,pn=In.length,Pn=pn-1;if(!pn){Qn(0,null);return}for(var Vn=0;Vn<pn;Vn+=1){var Jr=kr(Vn);if(H&&(Jr=Jr||0),Jr===void 0){Qn(Vn-1,void 0,!0);break}if(jt+=Jr,Pn===0&&jt<=ne||Vn===Pn-1&&jt+kr(Pn)<=ne){Qn(Pn,null);break}else if(jt+Ht>ne){Qn(Vn-1,jt-Jr-je+fe);break}}x&&kr(0)+je>ne&&Tt(null)}},[ne,ce,fe,je,sn,In]);var Tr=tt&&!!Hr.length,nt={};_t!==null&&Lt&&(nt={position:"absolute",left:_t,top:0});var yt={prefixCls:Ot,responsive:Lt,component:F,invalidate:br},En=m?function(jt,pn){var Pn=sn(jt,pn);return b.createElement(hy.Provider,{key:Pn,value:Ae(Ae({},yt),{},{order:pn,item:jt,itemKey:Pn,registerSize:Jt,display:pn<=ze})},m(jt,pn))}:function(jt,pn){var Pn=sn(jt,pn);return b.createElement(am,Qe({},yt,{order:pn,key:Pn,item:jt,renderItem:Dr,itemKey:Pn,registerSize:Jt,display:pn<=ze}))},Qt,tn={order:Tr?ze:Number.MAX_SAFE_INTEGER,className:"".concat(Ot,"-rest"),registerSize:ai,display:Tr};if(M)M&&(Qt=b.createElement(hy.Provider,{value:Ae(Ae({},yt),tn)},M(Hr)));else{var Wr=A||p0e;Qt=b.createElement(am,Qe({},yt,tn),typeof Wr=="function"?Wr(Hr):Wr)}var _n=b.createElement(D,Qe({className:Ye(!br&&s,N),style:R,ref:n},B),In.map(En),Xt?Qt:null,x&&b.createElement(am,Qe({},yt,{responsive:hn,responsiveDisabled:!Lt,order:ze,className:"".concat(Ot,"-suffix"),registerSize:Gn,display:!0,style:nt}),x));return hn&&(_n=b.createElement(Gd,{onResize:Ut,disabled:!Lt},_n)),_n}var ll=b.forwardRef(f0e);ll.displayName="Overflow";ll.Item=v7;ll.RESPONSIVE=E7;ll.INVALIDATE=_7;function y7(e){var n;return e==null||(n=e.getRootNode)===null||n===void 0?void 0:n.call(e)}function m0e(e){return y7(e)instanceof ShadowRoot}function cA(e){return m0e(e)?y7(e):null}var y5=b.createContext(null);function S5(e){return e?Array.isArray(e)?e:[e]:[]}function g0e(e,n,o,s){return b.useMemo(function(){var c=S5(o??n),d=S5(s??n),p=new Set(c),m=new Set(d);return e&&(p.has("hover")&&(p.delete("hover"),p.add("click")),m.has("hover")&&(m.delete("hover"),m.add("click"))),[p,m]},[e,n,o,s])}function v0e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;return o?e[0]===n[0]:e[0]===n[0]&&e[1]===n[1]}function E0e(e,n,o,s){for(var c=o.points,d=Object.keys(e),p=0;p<d.length;p+=1){var m,g=d[p];if(v0e((m=e[g])===null||m===void 0?void 0:m.points,c,s))return"".concat(n,"-placement-").concat(g)}return""}function C5(e,n,o,s){return n||(o?{motionName:"".concat(e,"-").concat(o)}:s?{motionName:s}:null)}function Zm(e){return e.ownerDocument.defaultView}function lA(e){for(var n=[],o=e==null?void 0:e.parentElement,s=["hidden","scroll","clip","auto"];o;){var c=Zm(o).getComputedStyle(o),d=c.overflowX,p=c.overflowY,m=c.overflow;[d,p,m].some(function(g){return s.includes(g)})&&n.push(o),o=o.parentElement}return n}function km(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return Number.isNaN(e)?n:e}function D0(e){return km(parseFloat(e),0)}function b5(e,n){var o=Ae({},e);return(n||[]).forEach(function(s){if(!(s instanceof HTMLBodyElement||s instanceof HTMLHtmlElement)){var c=Zm(s).getComputedStyle(s),d=c.overflow,p=c.overflowClipMargin,m=c.borderTopWidth,g=c.borderBottomWidth,_=c.borderLeftWidth,S=c.borderRightWidth,T=s.getBoundingClientRect(),R=s.offsetHeight,N=s.clientHeight,O=s.offsetWidth,A=s.clientWidth,M=D0(m),x=D0(g),P=D0(_),D=D0(S),F=km(Math.round(T.width/O*1e3)/1e3),j=km(Math.round(T.height/R*1e3)/1e3),B=(O-A-P-D)*F,H=(R-N-M-x)*j,K=M*j,J=x*j,q=P*F,Q=D*F,ee=0,ne=0;if(d==="clip"){var he=D0(p);ee=he*F,ne=he*j}var pe=T.x+q-ee,ce=T.y+K-ne,se=pe+T.width+2*ee-q-Q-B,ae=ce+T.height+2*ne-K-J-H;o.left=Math.max(o.left,pe),o.top=Math.max(o.top,ce),o.right=Math.min(o.right,se),o.bottom=Math.min(o.bottom,ae)}}),o}function T5(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o="".concat(n),s=o.match(/^(.*)\%$/);return s?e*(parseFloat(s[1])/100):parseFloat(o)}function R5(e,n){var o=n||[],s=We(o,2),c=s[0],d=s[1];return[T5(e.width,c),T5(e.height,d)]}function w5(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return[e[0],e[1]]}function op(e,n){var o=n[0],s=n[1],c,d;return o==="t"?d=e.y:o==="b"?d=e.y+e.height:d=e.y+e.height/2,s==="l"?c=e.x:s==="r"?c=e.x+e.width:c=e.x+e.width/2,{x:c,y:d}}function su(e,n){var o={t:"b",b:"t",l:"r",r:"l"};return e.map(function(s,c){return c===n?o[s]||"c":s}).join("")}function _0e(e,n,o,s,c,d,p){var m=b.useState({ready:!1,offsetX:0,offsetY:0,offsetR:0,offsetB:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:c[s]||{}}),g=We(m,2),_=g[0],S=g[1],T=b.useRef(0),R=b.useMemo(function(){return n?lA(n):[]},[n]),N=b.useRef({}),O=function(){N.current={}};e||O();var A=qs(function(){if(n&&o&&e){let po=function(Al,cc){var lc=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ct,Ps=Ee.x+Al,th=Ee.y+cc,uc=Ps+je,_f=th+Ve,yf=Math.max(Ps,lc.left),gt=Math.max(th,lc.top),Nt=Math.min(uc,lc.right),gr=Math.min(_f,lc.bottom);return Math.max(0,(Nt-yf)*(gr-gt))},Uu=function(){Zr=Ee.y+tn,dr=Zr+Ve,Wo=Ee.x+Qt,Xa=Wo+je};var lg=po,qo=Uu,P,D,F=n,j=F.ownerDocument,B=Zm(F),H=B.getComputedStyle(F),K=H.width,J=H.height,q=H.position,Q=F.style.left,ee=F.style.top,ne=F.style.right,he=F.style.bottom,pe=Ae(Ae({},c[s]),d),ce=j.createElement("div");(P=F.parentElement)===null||P===void 0||P.appendChild(ce),ce.style.left="".concat(F.offsetLeft,"px"),ce.style.top="".concat(F.offsetTop,"px"),ce.style.position=q,ce.style.height="".concat(F.offsetHeight,"px"),ce.style.width="".concat(F.offsetWidth,"px"),F.style.left="0",F.style.top="0",F.style.right="auto",F.style.bottom="auto";var se;if(Array.isArray(o))se={x:o[0],y:o[1],width:0,height:0};else{var ae=o.getBoundingClientRect();se={x:ae.x,y:ae.y,width:ae.width,height:ae.height}}var Ee=F.getBoundingClientRect(),ve=j.documentElement,le=ve.clientWidth,de=ve.clientHeight,ye=ve.scrollWidth,fe=ve.scrollHeight,ke=ve.scrollTop,Me=ve.scrollLeft,Ve=Ee.height,je=Ee.width,dt=se.height,ut=se.width,Ct={left:0,top:0,right:le,bottom:de},_t={left:-Me,top:-ke,right:ye-Me,bottom:fe-ke},Tt=pe.htmlRegion,it="visible",kt="visibleFirst";Tt!=="scroll"&&Tt!==kt&&(Tt=it);var qt=Tt===kt,xt=b5(_t,R),ze=b5(Ct,R),ct=Tt===it?ze:xt,et=qt?ze:ct;F.style.left="auto",F.style.top="auto",F.style.right="0",F.style.bottom="0";var tt=F.getBoundingClientRect();F.style.left=Q,F.style.top=ee,F.style.right=ne,F.style.bottom=he,(D=F.parentElement)===null||D===void 0||D.removeChild(ce);var mt=km(Math.round(je/parseFloat(K)*1e3)/1e3),Ot=km(Math.round(Ve/parseFloat(J)*1e3)/1e3);if(mt===0||Ot===0||Q_(o)&&!gS(o))return;var Ht=pe.offset,hn=pe.targetOffset,Lt=R5(Ee,Ht),br=We(Lt,2),Xt=br[0],In=br[1],Hr=R5(se,hn),sn=We(Hr,2),Dr=sn[0],Qn=sn[1];se.x-=Dr,se.y-=Qn;var Ut=pe.points||[],Jt=We(Ut,2),ai=Jt[0],Gn=Jt[1],kr=w5(Gn),Tr=w5(ai),nt=op(se,kr),yt=op(Ee,Tr),En=Ae({},pe),Qt=nt.x-yt.x+Xt,tn=nt.y-yt.y+In,Wr=po(Qt,tn),_n=po(Qt,tn,ze),jt=op(se,["t","l"]),pn=op(Ee,["t","l"]),Pn=op(se,["b","r"]),Vn=op(Ee,["b","r"]),Jr=pe.overflow||{},Qr=Jr.adjustX,gn=Jr.adjustY,Ni=Jr.shiftX,Pi=Jr.shiftY,As=function(cc){return typeof cc=="boolean"?cc:cc>=0},Zr,dr,Wo,Xa;Uu();var Os=As(gn),Tl=Tr[0]===kr[0];if(Os&&Tr[0]==="t"&&(dr>et.bottom||N.current.bt)){var si=tn;Tl?si-=Ve-dt:si=jt.y-Vn.y-In;var xs=po(Qt,si),zr=po(Qt,si,ze);xs>Wr||xs===Wr&&(!qt||zr>=_n)?(N.current.bt=!0,tn=si,In=-In,En.points=[su(Tr,0),su(kr,0)]):N.current.bt=!1}if(Os&&Tr[0]==="b"&&(Zr<et.top||N.current.tb)){var Ns=tn;Tl?Ns+=Ve-dt:Ns=Pn.y-pn.y-In;var Rl=po(Qt,Ns),sc=po(Qt,Ns,ze);Rl>Wr||Rl===Wr&&(!qt||sc>=_n)?(N.current.tb=!0,tn=Ns,In=-In,En.points=[su(Tr,0),su(kr,0)]):N.current.tb=!1}var Ja=As(Qr),Qa=Tr[1]===kr[1];if(Ja&&Tr[1]==="l"&&(Xa>et.right||N.current.rl)){var zo=Qt;Qa?zo-=je-ut:zo=jt.x-Vn.x-Xt;var wl=po(zo,tn),Mu=po(zo,tn,ze);wl>Wr||wl===Wr&&(!qt||Mu>=_n)?(N.current.rl=!0,Qt=zo,Xt=-Xt,En.points=[su(Tr,1),su(kr,1)]):N.current.rl=!1}if(Ja&&Tr[1]==="r"&&(Wo<et.left||N.current.lr)){var uo=Qt;Qa?uo+=je-ut:uo=Pn.x-pn.x-Xt;var Go=po(uo,tn),Bc=po(uo,tn,ze);Go>Wr||Go===Wr&&(!qt||Bc>=_n)?(N.current.lr=!0,Qt=uo,Xt=-Xt,En.points=[su(Tr,1),su(kr,1)]):N.current.lr=!1}Uu();var Ji=Ni===!0?0:Ni;typeof Ji=="number"&&(Wo<ze.left&&(Qt-=Wo-ze.left-Xt,se.x+ut<ze.left+Ji&&(Qt+=se.x-ze.left+ut-Ji)),Xa>ze.right&&(Qt-=Xa-ze.right-Xt,se.x>ze.right-Ji&&(Qt+=se.x-ze.right+Ji)));var ya=Pi===!0?0:Pi;typeof ya=="number"&&(Zr<ze.top&&(tn-=Zr-ze.top-In,se.y+dt<ze.top+ya&&(tn+=se.y-ze.top+dt-ya)),dr>ze.bottom&&(tn-=dr-ze.bottom-In,se.y>ze.bottom-ya&&(tn+=se.y-ze.bottom+ya)));var Sa=Ee.x+Qt,ei=Sa+je,ho=Ee.y+tn,Za=ho+Ve,Po=se.x,Fu=Po+ut,Kn=se.y,Yt=Kn+dt,yn=Math.max(Sa,Po),ci=Math.min(ei,Fu),li=(yn+ci)/2,Ko=li-Sa,Ca=Math.max(ho,Kn),Il=Math.min(Za,Yt),Zd=(Ca+Il)/2,es=Zd-ho;p==null||p(n,En);var eh=tt.right-Ee.x-(Qt+Ee.width),Ef=tt.bottom-Ee.y-(tn+Ee.height);S({ready:!0,offsetX:Qt/mt,offsetY:tn/Ot,offsetR:eh/mt,offsetB:Ef/Ot,arrowX:Ko/mt,arrowY:es/Ot,scaleX:mt,scaleY:Ot,align:En})}}),M=function(){T.current+=1;var D=T.current;Promise.resolve().then(function(){T.current===D&&A()})},x=function(){S(function(D){return Ae(Ae({},D),{},{ready:!1})})};return qr(x,[s]),qr(function(){e||x()},[e]),[_.ready,_.offsetX,_.offsetY,_.offsetR,_.offsetB,_.arrowX,_.arrowY,_.scaleX,_.scaleY,_.align,M]}function y0e(e,n,o,s,c){qr(function(){if(e&&n&&o){let R=function(){s(),c()};var T=R,d=n,p=o,m=lA(d),g=lA(p),_=Zm(p),S=new Set([_].concat(ot(m),ot(g)));return S.forEach(function(N){N.addEventListener("scroll",R,{passive:!0})}),_.addEventListener("resize",R,{passive:!0}),s(),function(){S.forEach(function(N){N.removeEventListener("scroll",R),_.removeEventListener("resize",R)})}}},[e,n,o])}function S0e(e,n,o,s,c,d,p,m){var g=b.useRef(e),_=b.useRef(!1);g.current!==e&&(_.current=!0,g.current=e),b.useEffect(function(){var S=ao(function(){_.current=!1});return function(){ao.cancel(S)}},[e]),b.useEffect(function(){if(n&&s&&(!c||d)){var S=function(){var B=!1,H=function(q){var Q=q.target;B=p(Q)},K=function(q){var Q=q.target;!_.current&&g.current&&!B&&!p(Q)&&m(!1)};return[H,K]},T=S(),R=We(T,2),N=R[0],O=R[1],A=S(),M=We(A,2),x=M[0],P=M[1],D=Zm(s);D.addEventListener("mousedown",N,!0),D.addEventListener("click",O,!0),D.addEventListener("contextmenu",O,!0);var F=cA(o);return F&&(F.addEventListener("mousedown",x,!0),F.addEventListener("click",P,!0),F.addEventListener("contextmenu",P,!0)),function(){D.removeEventListener("mousedown",N,!0),D.removeEventListener("click",O,!0),D.removeEventListener("contextmenu",O,!0),F&&(F.removeEventListener("mousedown",x,!0),F.removeEventListener("click",P,!0),F.removeEventListener("contextmenu",P,!0))}}},[n,o,s,c,d])}function C0e(e){var n=e.prefixCls,o=e.align,s=e.arrow,c=e.arrowPos,d=s||{},p=d.className,m=d.content,g=c.x,_=g===void 0?0:g,S=c.y,T=S===void 0?0:S,R=b.useRef();if(!o||!o.points)return null;var N={position:"absolute"};if(o.autoArrow!==!1){var O=o.points[0],A=o.points[1],M=O[0],x=O[1],P=A[0],D=A[1];M===P||!["t","b"].includes(M)?N.top=T:M==="t"?N.top=0:N.bottom=0,x===D||!["l","r"].includes(x)?N.left=_:x==="l"?N.left=0:N.right=0}return b.createElement("div",{ref:R,className:Ye("".concat(n,"-arrow"),p),style:N},m)}function b0e(e){var n=e.prefixCls,o=e.open,s=e.zIndex,c=e.mask,d=e.motion;return c?b.createElement(qd,Qe({},d,{motionAppear:!0,visible:o,removeOnLeave:!0}),function(p){var m=p.className;return b.createElement("div",{style:{zIndex:s},className:Ye("".concat(n,"-mask"),m)})}):null}var T0e=b.memo(function(e){var n=e.children;return n},function(e,n){return n.cache}),R0e=b.forwardRef(function(e,n){var o=e.popup,s=e.className,c=e.prefixCls,d=e.style,p=e.target,m=e.onVisibleChanged,g=e.open,_=e.keepDom,S=e.fresh,T=e.onClick,R=e.mask,N=e.arrow,O=e.arrowPos,A=e.align,M=e.motion,x=e.maskMotion,P=e.forceRender,D=e.getPopupContainer,F=e.autoDestroy,j=e.portal,B=e.zIndex,H=e.onMouseEnter,K=e.onMouseLeave,J=e.onPointerEnter,q=e.ready,Q=e.offsetX,ee=e.offsetY,ne=e.offsetR,he=e.offsetB,pe=e.onAlign,ce=e.onPrepare,se=e.stretch,ae=e.targetWidth,Ee=e.targetHeight,ve=typeof o=="function"?o():o,le=g||_,de=(D==null?void 0:D.length)>0,ye=b.useState(!D||!de),fe=We(ye,2),ke=fe[0],Me=fe[1];if(qr(function(){!ke&&de&&p&&Me(!0)},[ke,de,p]),!ke)return null;var Ve="auto",je={left:"-1000vw",top:"-1000vh",right:Ve,bottom:Ve};if(q||!g){var dt,ut=A.points,Ct=A.dynamicInset||((dt=A._experimental)===null||dt===void 0?void 0:dt.dynamicInset),_t=Ct&&ut[0][1]==="r",Tt=Ct&&ut[0][0]==="b";_t?(je.right=ne,je.left=Ve):(je.left=Q,je.right=Ve),Tt?(je.bottom=he,je.top=Ve):(je.top=ee,je.bottom=Ve)}var it={};return se&&(se.includes("height")&&Ee?it.height=Ee:se.includes("minHeight")&&Ee&&(it.minHeight=Ee),se.includes("width")&&ae?it.width=ae:se.includes("minWidth")&&ae&&(it.minWidth=ae)),g||(it.pointerEvents="none"),b.createElement(j,{open:P||le,getContainer:D&&function(){return D(p)},autoDestroy:F},b.createElement(b0e,{prefixCls:c,open:g,zIndex:B,mask:R,motion:x}),b.createElement(Gd,{onResize:pe,disabled:!g},function(kt){return b.createElement(qd,Qe({motionAppear:!0,motionEnter:!0,motionLeave:!0,removeOnLeave:!1,forceRender:P,leavedClassName:"".concat(c,"-hidden")},M,{onAppearPrepare:ce,onEnterPrepare:ce,visible:g,onVisibleChanged:function(xt){var ze;M==null||(ze=M.onVisibleChanged)===null||ze===void 0||ze.call(M,xt),m(xt)}}),function(qt,xt){var ze=qt.className,ct=qt.style,et=Ye(c,ze,s);return b.createElement("div",{ref:Uc(kt,n,xt),className:et,style:Ae(Ae(Ae(Ae({"--arrow-x":"".concat(O.x||0,"px"),"--arrow-y":"".concat(O.y||0,"px")},je),it),ct),{},{boxSizing:"border-box",zIndex:B},d),onMouseEnter:H,onMouseLeave:K,onPointerEnter:J,onClick:T},N&&b.createElement(C0e,{prefixCls:c,arrow:N,arrowPos:O,align:A}),b.createElement(T0e,{cache:!g&&!S},ve))})}))}),w0e=b.forwardRef(function(e,n){var o=e.children,s=e.getTriggerDOMNode,c=nf(o),d=b.useCallback(function(m){bO(n,s?s(m):m)},[s]),p=nS(d,o.ref);return c?b.cloneElement(o,{ref:p}):o}),I0e=["prefixCls","children","action","showAction","hideAction","popupVisible","defaultPopupVisible","onPopupVisibleChange","afterPopupVisibleChange","mouseEnterDelay","mouseLeaveDelay","focusDelay","blurDelay","mask","maskClosable","getPopupContainer","forceRender","autoDestroy","destroyPopupOnHide","popup","popupClassName","popupStyle","popupPlacement","builtinPlacements","popupAlign","zIndex","stretch","getPopupClassNameFromAlign","fresh","alignPoint","onPopupClick","onPopupAlign","arrow","popupMotion","maskMotion","popupTransitionName","popupAnimation","maskTransitionName","maskAnimation","className","getTriggerDOMNode"];function A0e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Z$,n=b.forwardRef(function(o,s){var c=o.prefixCls,d=c===void 0?"rc-trigger-popup":c,p=o.children,m=o.action,g=m===void 0?"hover":m,_=o.showAction,S=o.hideAction,T=o.popupVisible,R=o.defaultPopupVisible,N=o.onPopupVisibleChange,O=o.afterPopupVisibleChange,A=o.mouseEnterDelay,M=o.mouseLeaveDelay,x=M===void 0?.1:M,P=o.focusDelay,D=o.blurDelay,F=o.mask,j=o.maskClosable,B=j===void 0?!0:j,H=o.getPopupContainer,K=o.forceRender,J=o.autoDestroy,q=o.destroyPopupOnHide,Q=o.popup,ee=o.popupClassName,ne=o.popupStyle,he=o.popupPlacement,pe=o.builtinPlacements,ce=pe===void 0?{}:pe,se=o.popupAlign,ae=o.zIndex,Ee=o.stretch,ve=o.getPopupClassNameFromAlign,le=o.fresh,de=o.alignPoint,ye=o.onPopupClick,fe=o.onPopupAlign,ke=o.arrow,Me=o.popupMotion,Ve=o.maskMotion,je=o.popupTransitionName,dt=o.popupAnimation,ut=o.maskTransitionName,Ct=o.maskAnimation,_t=o.className,Tt=o.getTriggerDOMNode,it=xn(o,I0e),kt=J||q||!1,qt=b.useState(!1),xt=We(qt,2),ze=xt[0],ct=xt[1];qr(function(){ct(r0e())},[]);var et=b.useRef({}),tt=b.useContext(y5),mt=b.useMemo(function(){return{registerSubPopup:function(Nt,gr){et.current[Nt]=gr,tt==null||tt.registerSubPopup(Nt,gr)}}},[tt]),Ot=Ipe(),Ht=b.useState(null),hn=We(Ht,2),Lt=hn[0],br=hn[1],Xt=qs(function(gt){Q_(gt)&&Lt!==gt&&br(gt),tt==null||tt.registerSubPopup(Ot,gt)}),In=b.useState(null),Hr=We(In,2),sn=Hr[0],Dr=Hr[1],Qn=qs(function(gt){Q_(gt)&&sn!==gt&&Dr(gt)}),Ut=b.Children.only(p),Jt=(Ut==null?void 0:Ut.props)||{},ai={},Gn=qs(function(gt){var Nt,gr,ui=sn;return(ui==null?void 0:ui.contains(gt))||((Nt=cA(ui))===null||Nt===void 0?void 0:Nt.host)===gt||gt===ui||(Lt==null?void 0:Lt.contains(gt))||((gr=cA(Lt))===null||gr===void 0?void 0:gr.host)===gt||gt===Lt||Object.values(et.current).some(function(vr){return(vr==null?void 0:vr.contains(gt))||gt===vr})}),kr=C5(d,Me,dt,je),Tr=C5(d,Ve,Ct,ut),nt=b.useState(R||!1),yt=We(nt,2),En=yt[0],Qt=yt[1],tn=T??En,Wr=qs(function(gt){T===void 0&&Qt(gt)});qr(function(){Qt(T||!1)},[T]);var _n=b.useRef(tn);_n.current=tn;var jt=qs(function(gt){Cl.flushSync(function(){tn!==gt&&(Wr(gt),N==null||N(gt))})}),pn=b.useRef(),Pn=function(){clearTimeout(pn.current)},Vn=function(Nt){var gr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;Pn(),gr===0?jt(Nt):pn.current=setTimeout(function(){jt(Nt)},gr*1e3)};b.useEffect(function(){return Pn},[]);var Jr=b.useState(!1),Qr=We(Jr,2),gn=Qr[0],Ni=Qr[1];qr(function(gt){(!gt||tn)&&Ni(!0)},[tn]);var Pi=b.useState(null),As=We(Pi,2),Zr=As[0],dr=As[1],Wo=b.useState([0,0]),Xa=We(Wo,2),Os=Xa[0],Tl=Xa[1],si=function(Nt){Tl([Nt.clientX,Nt.clientY])},xs=_0e(tn,Lt,de?Os:sn,he,ce,se,fe),zr=We(xs,11),Ns=zr[0],Rl=zr[1],sc=zr[2],Ja=zr[3],Qa=zr[4],zo=zr[5],wl=zr[6],Mu=zr[7],uo=zr[8],Go=zr[9],Bc=zr[10],Ji=g0e(ze,g,_,S),ya=We(Ji,2),Sa=ya[0],ei=ya[1],ho=Sa.has("click"),Za=ei.has("click")||ei.has("contextMenu"),Po=qs(function(){gn||Bc()}),Fu=function(){_n.current&&de&&Za&&Vn(!1)};y0e(tn,sn,Lt,Po,Fu),qr(function(){Po()},[Os,he]),qr(function(){tn&&!(ce!=null&&ce[he])&&Po()},[JSON.stringify(se)]);var Kn=b.useMemo(function(){var gt=E0e(ce,d,Go,de);return Ye(gt,ve==null?void 0:ve(Go))},[Go,ve,ce,d,de]);b.useImperativeHandle(s,function(){return{forceAlign:Po}});var Yt=b.useState(0),yn=We(Yt,2),ci=yn[0],li=yn[1],Ko=b.useState(0),Ca=We(Ko,2),Il=Ca[0],Zd=Ca[1],es=function(){if(Ee&&sn){var Nt=sn.getBoundingClientRect();li(Nt.width),Zd(Nt.height)}},eh=function(){es(),Po()},Ef=function(Nt){Ni(!1),Bc(),O==null||O(Nt)},lg=function(){return new Promise(function(Nt){es(),dr(function(){return Nt})})};qr(function(){Zr&&(Bc(),Zr(),dr(null))},[Zr]);function qo(gt,Nt,gr,ui){ai[gt]=function(vr){var Ol;ui==null||ui(vr),Vn(Nt,gr);for(var Bu=arguments.length,nh=new Array(Bu>1?Bu-1:0),rh=1;rh<Bu;rh++)nh[rh-1]=arguments[rh];(Ol=Jt[gt])===null||Ol===void 0||Ol.call.apply(Ol,[Jt,vr].concat(nh))}}(ho||Za)&&(ai.onClick=function(gt){var Nt;_n.current&&Za?Vn(!1):!_n.current&&ho&&(si(gt),Vn(!0));for(var gr=arguments.length,ui=new Array(gr>1?gr-1:0),vr=1;vr<gr;vr++)ui[vr-1]=arguments[vr];(Nt=Jt.onClick)===null||Nt===void 0||Nt.call.apply(Nt,[Jt,gt].concat(ui))}),S0e(tn,Za,sn,Lt,F,B,Gn,Vn);var po=Sa.has("hover"),Uu=ei.has("hover"),Al,cc;po&&(qo("onMouseEnter",!0,A,function(gt){si(gt)}),qo("onPointerEnter",!0,A,function(gt){si(gt)}),Al=function(){(tn||gn)&&Vn(!0,A)},de&&(ai.onMouseMove=function(gt){var Nt;(Nt=Jt.onMouseMove)===null||Nt===void 0||Nt.call(Jt,gt)})),Uu&&(qo("onMouseLeave",!1,x),qo("onPointerLeave",!1,x),cc=function(){Vn(!1,x)}),Sa.has("focus")&&qo("onFocus",!0,P),ei.has("focus")&&qo("onBlur",!1,D),Sa.has("contextMenu")&&(ai.onContextMenu=function(gt){var Nt;_n.current&&ei.has("contextMenu")?Vn(!1):(si(gt),Vn(!0)),gt.preventDefault();for(var gr=arguments.length,ui=new Array(gr>1?gr-1:0),vr=1;vr<gr;vr++)ui[vr-1]=arguments[vr];(Nt=Jt.onContextMenu)===null||Nt===void 0||Nt.call.apply(Nt,[Jt,gt].concat(ui))}),_t&&(ai.className=Ye(Jt.className,_t));var lc=Ae(Ae({},Jt),ai),Ps={},th=["onContextMenu","onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"];th.forEach(function(gt){it[gt]&&(Ps[gt]=function(){for(var Nt,gr=arguments.length,ui=new Array(gr),vr=0;vr<gr;vr++)ui[vr]=arguments[vr];(Nt=lc[gt])===null||Nt===void 0||Nt.call.apply(Nt,[lc].concat(ui)),it[gt].apply(it,ui)})});var uc=b.cloneElement(Ut,Ae(Ae({},lc),Ps)),_f={x:zo,y:wl},yf=ke?Ae({},ke!==!0?ke:{}):null;return b.createElement(b.Fragment,null,b.createElement(Gd,{disabled:!tn,ref:Qn,onResize:eh},b.createElement(w0e,{getTriggerDOMNode:Tt},uc)),b.createElement(y5.Provider,{value:mt},b.createElement(R0e,{portal:e,ref:Xt,prefixCls:d,popup:Q,className:Ye(ee,Kn),style:ne,target:sn,onMouseEnter:Al,onMouseLeave:cc,onPointerEnter:Al,zIndex:ae,open:tn,keepDom:gn,fresh:le,onClick:ye,mask:F,motion:kr,maskMotion:Tr,onVisibleChanged:Ef,onPrepare:lg,forceRender:K,autoDestroy:kt,getPopupContainer:H,align:Go,arrow:yf,arrowPos:_f,ready:Ns,offsetX:Rl,offsetY:sc,offsetR:Ja,offsetB:Qa,onAlign:Po,stretch:Ee,targetWidth:ci/Mu,targetHeight:Il/uo})))});return n}const S7=A0e(Z$);function sm(e,n,o){return Ye({[`${e}-status-success`]:n==="success",[`${e}-status-warning`]:n==="warning",[`${e}-status-error`]:n==="error",[`${e}-status-validating`]:n==="validating",[`${e}-has-feedback`]:o})}const C7=(e,n)=>n||e;var b7={};Object.defineProperty(b7,"__esModule",{value:!0});var O0e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"},x0e=b7.default=O0e;function N0e(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function P0e(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){N0e(e,c,o[c])})}return e}function D0e(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function k0e(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D0e(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var L0e=function(e,n){return b.createElement(qi,k0e(P0e({},e),{ref:n,icon:x0e}))};const M0e=b.forwardRef(L0e);var T7={};Object.defineProperty(T7,"__esModule",{value:!0});var F0e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"},U0e=T7.default=F0e;function B0e(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function j0e(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){B0e(e,c,o[c])})}return e}function V0e(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function $0e(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V0e(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var H0e=function(e,n){return b.createElement(qi,$0e(j0e({},e),{ref:n,icon:U0e}))};const W0e=b.forwardRef(H0e),Lm=["xxl","xl","lg","md","sm","xs"],z0e=e=>({xs:`(max-width: ${e.screenXSMax}px)`,sm:`(min-width: ${e.screenSM}px)`,md:`(min-width: ${e.screenMD}px)`,lg:`(min-width: ${e.screenLG}px)`,xl:`(min-width: ${e.screenXL}px)`,xxl:`(min-width: ${e.screenXXL}px)`}),G0e=e=>{const n=e,o=[].concat(Lm).reverse();return o.forEach((s,c)=>{const d=s.toUpperCase(),p=`screen${d}Min`,m=`screen${d}`;if(!(n[p]<=n[m]))throw new Error(`${p}<=${m} fails : !(${n[p]}<=${n[m]})`);if(c<o.length-1){const g=`screen${d}Max`;if(!(n[m]<=n[g]))throw new Error(`${m}<=${g} fails : !(${n[m]}<=${n[g]})`);const S=`screen${o[c+1].toUpperCase()}Min`;if(!(n[g]<=n[S]))throw new Error(`${g}<=${S} fails : !(${n[g]}<=${n[S]})`)}}),e};function K0e(){const[,e]=of(),n=z0e(G0e(e));return Et.useMemo(()=>{const o=new Map;let s=-1,c={};return{matchHandlers:{},dispatch(d){return c=d,o.forEach(p=>p(c)),o.size>=1},subscribe(d){return o.size||this.register(),s+=1,o.set(s,d),d(c),s},unsubscribe(d){o.delete(d),o.size||this.unregister()},unregister(){Object.keys(n).forEach(d=>{const p=n[d],m=this.matchHandlers[p];m==null||m.mql.removeListener(m==null?void 0:m.listener)}),o.clear()},register(){Object.keys(n).forEach(d=>{const p=n[d],m=_=>{let{matches:S}=_;this.dispatch(Object.assign(Object.assign({},c),{[d]:S}))},g=window.matchMedia(p);g.addListener(m),this.matchHandlers[p]={mql:g,listener:m},m(g)})},responsiveMap:n}},[e])}var ap={shiftX:64,adjustY:1},sp={adjustX:1,shiftY:!0},ps=[0,0],q0e={left:{points:["cr","cl"],overflow:sp,offset:[-4,0],targetOffset:ps},right:{points:["cl","cr"],overflow:sp,offset:[4,0],targetOffset:ps},top:{points:["bc","tc"],overflow:ap,offset:[0,-4],targetOffset:ps},bottom:{points:["tc","bc"],overflow:ap,offset:[0,4],targetOffset:ps},topLeft:{points:["bl","tl"],overflow:ap,offset:[0,-4],targetOffset:ps},leftTop:{points:["tr","tl"],overflow:sp,offset:[-4,0],targetOffset:ps},topRight:{points:["br","tr"],overflow:ap,offset:[0,-4],targetOffset:ps},rightTop:{points:["tl","tr"],overflow:sp,offset:[4,0],targetOffset:ps},bottomRight:{points:["tr","br"],overflow:ap,offset:[0,4],targetOffset:ps},rightBottom:{points:["bl","br"],overflow:sp,offset:[4,0],targetOffset:ps},bottomLeft:{points:["tl","bl"],overflow:ap,offset:[0,4],targetOffset:ps},leftBottom:{points:["br","bl"],overflow:sp,offset:[-4,0],targetOffset:ps}};function R7(e){var n=e.children,o=e.prefixCls,s=e.id,c=e.overlayInnerStyle,d=e.className,p=e.style;return b.createElement("div",{className:Ye("".concat(o,"-content"),d),style:p},b.createElement("div",{className:"".concat(o,"-inner"),id:s,role:"tooltip",style:c},typeof n=="function"?n():n))}var Y0e=["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","afterVisibleChange","transitionName","animation","motion","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer","overlayInnerStyle","arrowContent","overlay","id","showArrow"],X0e=function(n,o){var s=n.overlayClassName,c=n.trigger,d=c===void 0?["hover"]:c,p=n.mouseEnterDelay,m=p===void 0?0:p,g=n.mouseLeaveDelay,_=g===void 0?.1:g,S=n.overlayStyle,T=n.prefixCls,R=T===void 0?"rc-tooltip":T,N=n.children,O=n.onVisibleChange,A=n.afterVisibleChange,M=n.transitionName,x=n.animation,P=n.motion,D=n.placement,F=D===void 0?"right":D,j=n.align,B=j===void 0?{}:j,H=n.destroyTooltipOnHide,K=H===void 0?!1:H,J=n.defaultVisible,q=n.getTooltipContainer,Q=n.overlayInnerStyle;n.arrowContent;var ee=n.overlay,ne=n.id,he=n.showArrow,pe=he===void 0?!0:he,ce=xn(n,Y0e),se=b.useRef(null);b.useImperativeHandle(o,function(){return se.current});var ae=Ae({},ce);"visible"in n&&(ae.popupVisible=n.visible);var Ee=function(){return b.createElement(R7,{key:"content",prefixCls:R,id:ne,overlayInnerStyle:Q},ee)};return b.createElement(S7,Qe({popupClassName:s,prefixCls:R,popup:Ee,action:d,builtinPlacements:q0e,popupPlacement:F,ref:se,popupAlign:B,getPopupContainer:q,onPopupVisibleChange:O,afterPopupVisibleChange:A,popupTransitionName:M,popupAnimation:x,popupMotion:P,defaultPopupVisible:J,autoDestroy:K,mouseLeaveDelay:_,popupStyle:S,mouseEnterDelay:m,arrow:pe},ae),N)};const J0e=b.forwardRef(X0e),w7=8;function I7(e){const n=w7,{contentRadius:o,limitVerticalRadius:s}=e,c=o>12?o+2:12;return{dropdownArrowOffset:c,dropdownArrowOffsetVertical:s?n:c}}function HE(e,n){return e?n:{}}function Q0e(e,n){const{componentCls:o,sizePopupArrow:s,borderRadiusXS:c,borderRadiusOuter:d,boxShadowPopoverArrow:p}=e,{colorBg:m,contentRadius:g=e.borderRadiusLG,limitVerticalRadius:_,arrowDistance:S=0,arrowPlacement:T={left:!0,right:!0,top:!0,bottom:!0}}=n,{dropdownArrowOffsetVertical:R,dropdownArrowOffset:N}=I7({contentRadius:g,limitVerticalRadius:_});return{[o]:Object.assign(Object.assign(Object.assign(Object.assign({[`${o}-arrow`]:[Object.assign(Object.assign({position:"absolute",zIndex:1,display:"block"},zce(s,c,d,m,p)),{"&:before":{background:m}})]},HE(!!T.top,{[[`&-placement-top ${o}-arrow`,`&-placement-topLeft ${o}-arrow`,`&-placement-topRight ${o}-arrow`].join(",")]:{bottom:S,transform:"translateY(100%) rotate(180deg)"},[`&-placement-top ${o}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(100%) rotate(180deg)"},[`&-placement-topLeft ${o}-arrow`]:{left:{_skip_check_:!0,value:N}},[`&-placement-topRight ${o}-arrow`]:{right:{_skip_check_:!0,value:N}}})),HE(!!T.bottom,{[[`&-placement-bottom ${o}-arrow`,`&-placement-bottomLeft ${o}-arrow`,`&-placement-bottomRight ${o}-arrow`].join(",")]:{top:S,transform:"translateY(-100%)"},[`&-placement-bottom ${o}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(-100%)"},[`&-placement-bottomLeft ${o}-arrow`]:{left:{_skip_check_:!0,value:N}},[`&-placement-bottomRight ${o}-arrow`]:{right:{_skip_check_:!0,value:N}}})),HE(!!T.left,{[[`&-placement-left ${o}-arrow`,`&-placement-leftTop ${o}-arrow`,`&-placement-leftBottom ${o}-arrow`].join(",")]:{right:{_skip_check_:!0,value:S},transform:"translateX(100%) rotate(90deg)"},[`&-placement-left ${o}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(100%) rotate(90deg)"},[`&-placement-leftTop ${o}-arrow`]:{top:R},[`&-placement-leftBottom ${o}-arrow`]:{bottom:R}})),HE(!!T.right,{[[`&-placement-right ${o}-arrow`,`&-placement-rightTop ${o}-arrow`,`&-placement-rightBottom ${o}-arrow`].join(",")]:{left:{_skip_check_:!0,value:S},transform:"translateX(-100%) rotate(-90deg)"},[`&-placement-right ${o}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(-100%) rotate(-90deg)"},[`&-placement-rightTop ${o}-arrow`]:{top:R},[`&-placement-rightBottom ${o}-arrow`]:{bottom:R}}))}}function Z0e(e,n,o,s){if(s===!1)return{adjustX:!1,adjustY:!1};const c=s&&typeof s=="object"?s:{},d={};switch(e){case"top":case"bottom":d.shiftX=n.dropdownArrowOffset*2+o;break;case"left":case"right":d.shiftY=n.dropdownArrowOffsetVertical*2+o;break}const p=Object.assign(Object.assign({},d),c);return p.shiftX||(p.adjustX=!0),p.shiftY||(p.adjustY=!0),p}const I5={left:{points:["cr","cl"]},right:{points:["cl","cr"]},top:{points:["bc","tc"]},bottom:{points:["tc","bc"]},topLeft:{points:["bl","tl"]},leftTop:{points:["tr","tl"]},topRight:{points:["br","tr"]},rightTop:{points:["tl","tr"]},bottomRight:{points:["tr","br"]},rightBottom:{points:["bl","br"]},bottomLeft:{points:["tl","bl"]},leftBottom:{points:["br","bl"]}},eme={topLeft:{points:["bl","tc"]},leftTop:{points:["tr","cl"]},topRight:{points:["br","tc"]},rightTop:{points:["tl","cr"]},bottomRight:{points:["tr","bc"]},rightBottom:{points:["bl","cr"]},bottomLeft:{points:["tl","bc"]},leftBottom:{points:["br","cl"]}},tme=new Set(["topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"]);function nme(e){const{arrowWidth:n,autoAdjustOverflow:o,arrowPointAtCenter:s,offset:c,borderRadius:d,visibleFirst:p}=e,m=n/2,g={};return Object.keys(I5).forEach(_=>{const S=s&&eme[_]||I5[_],T=Object.assign(Object.assign({},S),{offset:[0,0]});switch(g[_]=T,tme.has(_)&&(T.autoArrow=!1),_){case"top":case"topLeft":case"topRight":T.offset[1]=-m-c;break;case"bottom":case"bottomLeft":case"bottomRight":T.offset[1]=m+c;break;case"left":case"leftTop":case"leftBottom":T.offset[0]=-m-c;break;case"right":case"rightTop":case"rightBottom":T.offset[0]=m+c;break}const R=I7({contentRadius:d,limitVerticalRadius:!0});if(s)switch(_){case"topLeft":case"bottomLeft":T.offset[0]=-R.dropdownArrowOffset-m;break;case"topRight":case"bottomRight":T.offset[0]=R.dropdownArrowOffset+m;break;case"leftTop":case"rightTop":T.offset[1]=-R.dropdownArrowOffset-m;break;case"leftBottom":case"rightBottom":T.offset[1]=R.dropdownArrowOffset+m;break}T.overflow=Z0e(_,R,n,o),p&&(T.htmlRegion="visibleFirst")}),g}const rme=e=>{const n=e!=null&&e.algorithm?ny(e.algorithm):ny(Km),o=Object.assign(Object.assign({},Gm),e==null?void 0:e.token);return fV(o,{override:e==null?void 0:e.token},n,DV)},ime=rme;function ome(e){const{sizeUnit:n,sizeStep:o}=e,s=o-2;return{sizeXXL:n*(s+10),sizeXL:n*(s+6),sizeLG:n*(s+2),sizeMD:n*(s+2),sizeMS:n*(s+1),size:n*s,sizeSM:n*s,sizeXS:n*(s-1),sizeXXS:n*(s-1)}}const ame=(e,n)=>{const o=n??Km(e),s=o.fontSizeSM,c=o.controlHeight-4;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o),ome(n??e)),PV(s)),{controlHeight:c}),xV(Object.assign(Object.assign({},o),{controlHeight:c})))},sme=ame,cu=(e,n)=>new io(e).setAlpha(n).toRgbString(),cp=(e,n)=>new io(e).lighten(n).toHexString(),cme=e=>{const n=gl(e,{theme:"dark"});return{1:n[0],2:n[1],3:n[2],4:n[3],5:n[6],6:n[5],7:n[4],8:n[6],9:n[5],10:n[4]}},lme=(e,n)=>{const o=e||"#000",s=n||"#fff";return{colorBgBase:o,colorTextBase:s,colorText:cu(s,.85),colorTextSecondary:cu(s,.65),colorTextTertiary:cu(s,.45),colorTextQuaternary:cu(s,.25),colorFill:cu(s,.18),colorFillSecondary:cu(s,.12),colorFillTertiary:cu(s,.08),colorFillQuaternary:cu(s,.04),colorBgElevated:cp(o,12),colorBgContainer:cp(o,8),colorBgLayout:cp(o,0),colorBgSpotlight:cp(o,26),colorBorder:cp(o,26),colorBorderSecondary:cp(o,19)}},ume=(e,n)=>{const o=Object.keys(DO).map(c=>{const d=gl(e[c],{theme:"dark"});return new Array(10).fill(1).reduce((p,m,g)=>(p[`${c}-${g+1}`]=d[g],p[`${c}${g+1}`]=d[g],p),{})}).reduce((c,d)=>(c=Object.assign(Object.assign({},c),d),c),{}),s=n??Km(e);return Object.assign(Object.assign(Object.assign({},s),o),NV(e,{generateColorPalettes:cme,generateNeutralColorPalettes:lme}))},dme=ume;function hme(){const[e,n,o]=of();return{theme:e,token:n,hashId:o}}const pme={defaultConfig:oy,defaultSeed:oy.token,useToken:hme,defaultAlgorithm:Km,darkAlgorithm:dme,compactAlgorithm:sme,getDesignToken:ime},fme=e=>{const{componentCls:n,tooltipMaxWidth:o,tooltipColor:s,tooltipBg:c,tooltipBorderRadius:d,zIndexPopup:p,controlHeight:m,boxShadowSecondary:g,paddingSM:_,paddingXS:S,tooltipRadiusOuter:T}=e;return[{[n]:Object.assign(Object.assign(Object.assign(Object.assign({},Kd(e)),{position:"absolute",zIndex:p,display:"block",width:"max-content",maxWidth:o,visibility:"visible",transformOrigin:"var(--arrow-x, 50%) var(--arrow-y, 50%)","&-hidden":{display:"none"},"--antd-arrow-background-color":c,[`${n}-inner`]:{minWidth:m,minHeight:m,padding:`${_/2}px ${S}px`,color:s,textAlign:"start",textDecoration:"none",wordWrap:"break-word",backgroundColor:c,borderRadius:d,boxShadow:g,boxSizing:"border-box"},[["&-placement-left","&-placement-leftTop","&-placement-leftBottom","&-placement-right","&-placement-rightTop","&-placement-rightBottom"].join(",")]:{[`${n}-inner`]:{borderRadius:Math.min(d,w7)}},[`${n}-content`]:{position:"relative"}}),Qce(e,(R,N)=>{let{darkColor:O}=N;return{[`&${n}-${R}`]:{[`${n}-inner`]:{backgroundColor:O},[`${n}-arrow`]:{"--antd-arrow-background-color":O}}}})),{"&-rtl":{direction:"rtl"}})},Q0e(lo(e,{borderRadiusOuter:T}),{colorBg:"var(--antd-arrow-background-color)",contentRadius:d,limitVerticalRadius:!0}),{[`${n}-pure`]:{position:"relative",maxWidth:"none",margin:e.sizePopupArrow}}]},A7=(e,n)=>ic("Tooltip",s=>{if(n===!1)return[];const{borderRadius:c,colorTextLightSolid:d,colorBgDefault:p,borderRadiusOuter:m}=s,g=lo(s,{tooltipMaxWidth:250,tooltipColor:d,tooltipBorderRadius:c,tooltipBg:p,tooltipRadiusOuter:m>4?4:m});return[fme(g),d7(s,"zoom-big-fast")]},s=>{let{zIndexPopupBase:c,colorBgSpotlight:d}=s;return{zIndexPopup:c+70,colorBgDefault:d}},{resetStyle:!1})(e),mme=iy.map(e=>`${e}-inverse`);function gme(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?[].concat(ot(mme),ot(iy)).includes(e):iy.includes(e)}function O7(e,n){const o=gme(n),s=Ye({[`${e}-${n}`]:n&&o}),c={},d={};return n&&!o&&(c.background=n,d["--antd-arrow-background-color"]=n),{className:s,overlayStyle:c,arrowStyle:d}}function vme(e){const{prefixCls:n,className:o,placement:s="top",title:c,color:d,overlayInnerStyle:p}=e,{getPrefixCls:m}=b.useContext(nr),g=m("tooltip",n),[_,S]=A7(g,!0),T=O7(g,d),R=Object.assign(Object.assign({},p),T.overlayStyle),N=T.arrowStyle;return _(b.createElement("div",{className:Ye(S,g,`${g}-pure`,`${g}-placement-${s}`,o,T.className),style:N},b.createElement("div",{className:`${g}-arrow`}),b.createElement(R7,Object.assign({},e,{className:S,prefixCls:g,overlayInnerStyle:R}),c)))}var Eme=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const{useToken:_me}=pme,yme=(e,n)=>{const o={},s=Object.assign({},e);return n.forEach(c=>{e&&c in e&&(o[c]=e[c],delete s[c])}),{picked:o,omitted:s}};function Sme(e,n){const o=e.type;if((o.__ANT_BUTTON===!0||e.type==="button")&&e.props.disabled||o.__ANT_SWITCH===!0&&(e.props.disabled||e.props.loading)||o.__ANT_RADIO===!0&&e.props.disabled){const{picked:s,omitted:c}=yme(e.props.style,["position","left","right","top","bottom","float","display","zIndex"]),d=Object.assign(Object.assign({display:"inline-block"},s),{cursor:"not-allowed",width:e.props.block?"100%":void 0}),p=Object.assign(Object.assign({},c),{pointerEvents:"none"}),m=tc(e,{style:p,className:null});return b.createElement("span",{style:d,className:Ye(e.props.className,`${n}-disabled-compatible-wrapper`)},m)}return e}const x7=b.forwardRef((e,n)=>{var o,s;const{prefixCls:c,openClassName:d,getTooltipContainer:p,overlayClassName:m,color:g,overlayInnerStyle:_,children:S,afterOpenChange:T,afterVisibleChange:R,destroyTooltipOnHide:N,arrow:O=!0,title:A,overlay:M,builtinPlacements:x,arrowPointAtCenter:P=!1,autoAdjustOverflow:D=!0}=e,F=!!O,{token:j}=_me(),{getPopupContainer:B,getPrefixCls:H,direction:K}=b.useContext(nr),J=b.useRef(null),q=()=>{var ze;(ze=J.current)===null||ze===void 0||ze.forceAlign()};b.useImperativeHandle(n,()=>({forceAlign:q,forcePopupAlign:()=>{q()}}));const[Q,ee]=cl(!1,{value:(o=e.open)!==null&&o!==void 0?o:e.visible,defaultValue:(s=e.defaultOpen)!==null&&s!==void 0?s:e.defaultVisible}),ne=!A&&!M&&A!==0,he=ze=>{var ct,et;ee(ne?!1:ze),ne||((ct=e.onOpenChange)===null||ct===void 0||ct.call(e,ze),(et=e.onVisibleChange)===null||et===void 0||et.call(e,ze))},pe=b.useMemo(()=>{var ze,ct;let et=P;return typeof O=="object"&&(et=(ct=(ze=O.pointAtCenter)!==null&&ze!==void 0?ze:O.arrowPointAtCenter)!==null&&ct!==void 0?ct:P),x||nme({arrowPointAtCenter:et,autoAdjustOverflow:D,arrowWidth:F?j.sizePopupArrow:0,borderRadius:j.borderRadius,offset:j.marginXXS,visibleFirst:!0})},[P,O,x,j]),ce=b.useMemo(()=>A===0?A:M||A||"",[M,A]),se=b.createElement(qI,null,typeof ce=="function"?ce():ce),{getPopupContainer:ae,placement:Ee="top",mouseEnterDelay:ve=.1,mouseLeaveDelay:le=.1,overlayStyle:de,rootClassName:ye}=e,fe=Eme(e,["getPopupContainer","placement","mouseEnterDelay","mouseLeaveDelay","overlayStyle","rootClassName"]),ke=H("tooltip",c),Me=H(),Ve=e["data-popover-inject"];let je=Q;!("open"in e)&&!("visible"in e)&&ne&&(je=!1);const dt=Sme(Au(S)&&!V$(S)?S:b.createElement("span",null,S),ke),ut=dt.props,Ct=!ut.className||typeof ut.className=="string"?Ye(ut.className,{[d||`${ke}-open`]:!0}):ut.className,[_t,Tt]=A7(ke,!Ve),it=O7(ke,g),kt=Object.assign(Object.assign({},_),it.overlayStyle),qt=it.arrowStyle,xt=Ye(m,{[`${ke}-rtl`]:K==="rtl"},it.className,ye,Tt);return _t(b.createElement(J0e,Object.assign({},fe,{showArrow:F,placement:Ee,mouseEnterDelay:ve,mouseLeaveDelay:le,prefixCls:ke,overlayClassName:xt,overlayStyle:Object.assign(Object.assign({},qt),de),getTooltipContainer:ae||p||B,ref:J,builtinPlacements:pe,overlay:se,visible:je,onVisibleChange:he,afterVisibleChange:T??R,overlayInnerStyle:kt,arrowContent:b.createElement("span",{className:`${ke}-arrow-content`}),motion:{motionName:Epe(Me,"zoom-big-fast",e.transitionName),motionDeadline:1e3},destroyTooltipOnHide:!!N}),je?tc(dt,{className:Ct}):dt))});x7._InternalPanelDoNotUseOrYouWillBeFired=vme;const Mm=x7;var N7={};Object.defineProperty(N7,"__esModule",{value:!0});var Cme={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"},bme=N7.default=Cme;function Tme(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function Rme(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){Tme(e,c,o[c])})}return e}function wme(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Ime(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wme(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var Ame=function(e,n){return b.createElement(qi,Ime(Rme({},e),{ref:n,icon:bme}))};const A5=b.forwardRef(Ame);var P7=b.createContext(null);function ex(e,n){return e===void 0?null:"".concat(e,"-").concat(n)}function D7(e){var n=b.useContext(P7);return ex(n,e)}var Ome=["children","locked"],nc=b.createContext(null);function xme(e,n){var o=Ae({},e);return Object.keys(n).forEach(function(s){var c=n[s];c!==void 0&&(o[s]=c)}),o}function Fm(e){var n=e.children,o=e.locked,s=xn(e,Ome),c=b.useContext(nc),d=tS(function(){return xme(c,s)},[c,s],function(p,m){return!o&&(p[0]!==m[0]||!iS(p[1],m[1],!0))});return b.createElement(nc.Provider,{value:d},n)}var Nme=[],k7=b.createContext(null);function vS(){return b.useContext(k7)}var L7=b.createContext(Nme);function uf(e){var n=b.useContext(L7);return b.useMemo(function(){return e!==void 0?[].concat(ot(n),[e]):n},[n,e])}var M7=b.createContext(null),tx=b.createContext({});function O5(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(gS(e)){var o=e.nodeName.toLowerCase(),s=["input","select","textarea","button"].includes(o)||e.isContentEditable||o==="a"&&!!e.getAttribute("href"),c=e.getAttribute("tabindex"),d=Number(c),p=null;return c&&!Number.isNaN(d)?p=d:s&&p===null&&(p=0),s&&e.disabled&&(p=null),p!==null&&(p>=0||n&&p<0)}return!1}function Pme(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=ot(e.querySelectorAll("*")).filter(function(s){return O5(s,n)});return O5(e,n)&&o.unshift(e),o}var uA=St.LEFT,dA=St.RIGHT,hA=St.UP,E_=St.DOWN,__=St.ENTER,F7=St.ESC,k0=St.HOME,L0=St.END,x5=[hA,E_,uA,dA];function Dme(e,n,o,s){var c,d,p,m,g="prev",_="next",S="children",T="parent";if(e==="inline"&&s===__)return{inlineTrigger:!0};var R=(c={},st(c,hA,g),st(c,E_,_),c),N=(d={},st(d,uA,o?_:g),st(d,dA,o?g:_),st(d,E_,S),st(d,__,S),d),O=(p={},st(p,hA,g),st(p,E_,_),st(p,__,S),st(p,F7,T),st(p,uA,o?S:T),st(p,dA,o?T:S),p),A={inline:R,horizontal:N,vertical:O,inlineSub:R,horizontalSub:O,verticalSub:O},M=(m=A["".concat(e).concat(n?"":"Sub")])===null||m===void 0?void 0:m[s];switch(M){case g:return{offset:-1,sibling:!0};case _:return{offset:1,sibling:!0};case T:return{offset:-1,sibling:!1};case S:return{offset:1,sibling:!1};default:return null}}function kme(e){for(var n=e;n;){if(n.getAttribute("data-menu-list"))return n;n=n.parentElement}return null}function Lme(e,n){for(var o=e||document.activeElement;o;){if(n.has(o))return o;o=o.parentElement}return null}function U7(e,n){var o=Pme(e,!0);return o.filter(function(s){return n.has(s)})}function N5(e,n,o){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;if(!e)return null;var c=U7(e,n),d=c.length,p=c.findIndex(function(m){return o===m});return s<0?p===-1?p=d-1:p-=1:s>0&&(p+=1),p=(p+d)%d,c[p]}function Mme(e,n,o,s,c,d,p,m,g,_){var S=b.useRef(),T=b.useRef();T.current=n;var R=function(){ao.cancel(S.current)};return b.useEffect(function(){return function(){R()}},[]),function(N){var O=N.which;if([].concat(x5,[__,F7,k0,L0]).includes(O)){var A,M,x,P=function(){A=new Set,M=new Map,x=new Map;var pe=d();return pe.forEach(function(ce){var se=document.querySelector("[data-menu-id='".concat(ex(s,ce),"']"));se&&(A.add(se),x.set(se,ce),M.set(ce,se))}),A};P();var D=M.get(n),F=Lme(D,A),j=x.get(F),B=Dme(e,p(j,!0).length===1,o,O);if(!B&&O!==k0&&O!==L0)return;(x5.includes(O)||[k0,L0].includes(O))&&N.preventDefault();var H=function(pe){if(pe){var ce=pe,se=pe.querySelector("a");se!=null&&se.getAttribute("href")&&(ce=se);var ae=x.get(pe);m(ae),R(),S.current=ao(function(){T.current===ae&&ce.focus()})}};if([k0,L0].includes(O)||B.sibling||!F){var K;!F||e==="inline"?K=c.current:K=kme(F);var J,q=U7(K,A);O===k0?J=q[0]:O===L0?J=q[q.length-1]:J=N5(K,A,F,B.offset),H(J)}else if(B.inlineTrigger)g(j);else if(B.offset>0)g(j,!0),R(),S.current=ao(function(){P();var he=F.getAttribute("aria-controls"),pe=document.getElementById(he),ce=N5(pe,A);H(ce)},5);else if(B.offset<0){var Q=p(j,!0),ee=Q[Q.length-2],ne=M.get(ee);g(ee,!1),H(ne)}}_==null||_(N)}}function Fme(e){Promise.resolve().then(e)}var nx="__RC_UTIL_PATH_SPLIT__",P5=function(n){return n.join(nx)},Ume=function(n){return n.split(nx)},pA="rc-menu-more";function Bme(){var e=b.useState({}),n=We(e,2),o=n[1],s=b.useRef(new Map),c=b.useRef(new Map),d=b.useState([]),p=We(d,2),m=p[0],g=p[1],_=b.useRef(0),S=b.useRef(!1),T=function(){S.current||o({})},R=b.useCallback(function(D,F){var j=P5(F);c.current.set(j,D),s.current.set(D,j),_.current+=1;var B=_.current;Fme(function(){B===_.current&&T()})},[]),N=b.useCallback(function(D,F){var j=P5(F);c.current.delete(j),s.current.delete(D)},[]),O=b.useCallback(function(D){g(D)},[]),A=b.useCallback(function(D,F){var j=s.current.get(D)||"",B=Ume(j);return F&&m.includes(B[0])&&B.unshift(pA),B},[m]),M=b.useCallback(function(D,F){return D.some(function(j){var B=A(j,!0);return B.includes(F)})},[A]),x=function(){var F=ot(s.current.keys());return m.length&&F.push(pA),F},P=b.useCallback(function(D){var F="".concat(s.current.get(D)).concat(nx),j=new Set;return ot(c.current.keys()).forEach(function(B){B.startsWith(F)&&j.add(c.current.get(B))}),j},[]);return b.useEffect(function(){return function(){S.current=!0}},[]),{registerPath:R,unregisterPath:N,refreshOverflowKeys:O,isSubPathKey:M,getKeyPath:A,getKeys:x,getSubPathKeys:P}}function z0(e){var n=b.useRef(e);n.current=e;var o=b.useCallback(function(){for(var s,c=arguments.length,d=new Array(c),p=0;p<c;p++)d[p]=arguments[p];return(s=n.current)===null||s===void 0?void 0:s.call.apply(s,[n].concat(d))},[]);return e?o:void 0}var jme=Math.random().toFixed(5).toString().slice(2),D5=0;function Vme(e){var n=cl(e,{value:e}),o=We(n,2),s=o[0],c=o[1];return b.useEffect(function(){D5+=1;var d="".concat(jme,"-").concat(D5);c("rc-menu-uuid-".concat(d))},[]),s}function B7(e,n,o,s){var c=b.useContext(nc),d=c.activeKey,p=c.onActive,m=c.onInactive,g={active:d===e};return n||(g.onMouseEnter=function(_){o==null||o({key:e,domEvent:_}),p(e)},g.onMouseLeave=function(_){s==null||s({key:e,domEvent:_}),m(e)}),g}function j7(e){var n=b.useContext(nc),o=n.mode,s=n.rtl,c=n.inlineIndent;if(o!=="inline")return null;var d=e;return s?{paddingRight:d*c}:{paddingLeft:d*c}}function V7(e){var n=e.icon,o=e.props,s=e.children,c;return typeof n=="function"?c=b.createElement(n,Ae({},o)):c=n,c||s||null}var $me=["item"];function py(e){var n=e.item,o=xn(e,$me);return Object.defineProperty(o,"item",{get:function(){return ma(!1,"`info.item` is deprecated since we will move to function component that not provides React Node instance in future."),n}}),o}var Hme=["title","attribute","elementRef"],Wme=["style","className","eventKey","warnKey","disabled","itemIcon","children","role","onMouseEnter","onMouseLeave","onClick","onKeyDown","onFocus"],zme=["active"],Gme=function(e){ef(o,e);var n=tf(o);function o(){return bs(this,o),n.apply(this,arguments)}return Ts(o,[{key:"render",value:function(){var c=this.props,d=c.title,p=c.attribute,m=c.elementRef,g=xn(c,Hme),_=Ea(g,["eventKey","popupClassName","popupOffset","onTitleClick"]);return ma(!p,"`attribute` of Menu.Item is deprecated. Please pass attribute directly."),b.createElement(ll.Item,Qe({},p,{title:typeof d=="string"?d:void 0},_,{ref:m}))}}]),o}(b.Component),Kme=b.forwardRef(function(e,n){var o,s=e.style,c=e.className,d=e.eventKey;e.warnKey;var p=e.disabled,m=e.itemIcon,g=e.children,_=e.role,S=e.onMouseEnter,T=e.onMouseLeave,R=e.onClick,N=e.onKeyDown,O=e.onFocus,A=xn(e,Wme),M=D7(d),x=b.useContext(nc),P=x.prefixCls,D=x.onItemClick,F=x.disabled,j=x.overflowDisabled,B=x.itemIcon,H=x.selectedKeys,K=x.onActive,J=b.useContext(tx),q=J._internalRenderMenuItem,Q="".concat(P,"-item"),ee=b.useRef(),ne=b.useRef(),he=F||p,pe=nS(n,ne),ce=uf(d),se=function(ut){return{key:d,keyPath:ot(ce).reverse(),item:ee.current,domEvent:ut}},ae=m||B,Ee=B7(d,he,S,T),ve=Ee.active,le=xn(Ee,zme),de=H.includes(d),ye=j7(ce.length),fe=function(ut){if(!he){var Ct=se(ut);R==null||R(py(Ct)),D(Ct)}},ke=function(ut){if(N==null||N(ut),ut.which===St.ENTER){var Ct=se(ut);R==null||R(py(Ct)),D(Ct)}},Me=function(ut){K(d),O==null||O(ut)},Ve={};e.role==="option"&&(Ve["aria-selected"]=de);var je=b.createElement(Gme,Qe({ref:ee,elementRef:pe,role:_===null?"none":_||"menuitem",tabIndex:p?null:-1,"data-menu-id":j&&M?null:M},A,le,Ve,{component:"li","aria-disabled":p,style:Ae(Ae({},ye),s),className:Ye(Q,(o={},st(o,"".concat(Q,"-active"),ve),st(o,"".concat(Q,"-selected"),de),st(o,"".concat(Q,"-disabled"),he),o),c),onClick:fe,onKeyDown:ke,onFocus:Me}),g,b.createElement(V7,{props:Ae(Ae({},e),{},{isSelected:de}),icon:ae}));return q&&(je=q(je,e,{selected:de})),je});function qme(e,n){var o=e.eventKey,s=vS(),c=uf(o);return b.useEffect(function(){if(s)return s.registerPath(o,c),function(){s.unregisterPath(o,c)}},[c]),s?null:b.createElement(Kme,Qe({},e,{ref:n}))}const ES=b.forwardRef(qme);var Yme=["className","children"],Xme=function(n,o){var s=n.className,c=n.children,d=xn(n,Yme),p=b.useContext(nc),m=p.prefixCls,g=p.mode,_=p.rtl;return b.createElement("ul",Qe({className:Ye(m,_&&"".concat(m,"-rtl"),"".concat(m,"-sub"),"".concat(m,"-").concat(g==="inline"?"inline":"vertical"),s),role:"menu"},d,{"data-menu-list":!0,ref:o}),c)},rx=b.forwardRef(Xme);rx.displayName="SubMenuList";var Jme=["label","children","key","type"];function ix(e,n){return ml(e).map(function(o,s){if(b.isValidElement(o)){var c,d,p=o.key,m=(c=(d=o.props)===null||d===void 0?void 0:d.eventKey)!==null&&c!==void 0?c:p,g=m==null;g&&(m="tmp_key-".concat([].concat(ot(n),[s]).join("-")));var _={key:m,eventKey:m};return b.cloneElement(o,_)}return o})}function fA(e){return(e||[]).map(function(n,o){if(n&&jn(n)==="object"){var s=n,c=s.label,d=s.children,p=s.key,m=s.type,g=xn(s,Jme),_=p??"tmp-".concat(o);return d||m==="group"?m==="group"?b.createElement(yS,Qe({key:_},g,{title:c}),fA(d)):b.createElement(_S,Qe({key:_},g,{title:c}),fA(d)):m==="divider"?b.createElement(ox,Qe({key:_},g)):b.createElement(ES,Qe({key:_},g),c)}return null}).filter(function(n){return n})}function Qme(e,n,o){var s=e;return n&&(s=fA(n)),ix(s,o)}var Io={adjustX:1,adjustY:1},Zme={topLeft:{points:["bl","tl"],overflow:Io},topRight:{points:["br","tr"],overflow:Io},bottomLeft:{points:["tl","bl"],overflow:Io},bottomRight:{points:["tr","br"],overflow:Io},leftTop:{points:["tr","tl"],overflow:Io},leftBottom:{points:["br","bl"],overflow:Io},rightTop:{points:["tl","tr"],overflow:Io},rightBottom:{points:["bl","br"],overflow:Io}},ege={topLeft:{points:["bl","tl"],overflow:Io},topRight:{points:["br","tr"],overflow:Io},bottomLeft:{points:["tl","bl"],overflow:Io},bottomRight:{points:["tr","br"],overflow:Io},rightTop:{points:["tr","tl"],overflow:Io},rightBottom:{points:["br","bl"],overflow:Io},leftTop:{points:["tl","tr"],overflow:Io},leftBottom:{points:["bl","br"],overflow:Io}};function $7(e,n,o){if(n)return n;if(o)return o[e]||o.other}var tge={horizontal:"bottomLeft",vertical:"rightTop","vertical-left":"rightTop","vertical-right":"leftTop"};function nge(e){var n=e.prefixCls,o=e.visible,s=e.children,c=e.popup,d=e.popupClassName,p=e.popupOffset,m=e.disabled,g=e.mode,_=e.onVisibleChange,S=b.useContext(nc),T=S.getPopupContainer,R=S.rtl,N=S.subMenuOpenDelay,O=S.subMenuCloseDelay,A=S.builtinPlacements,M=S.triggerSubMenuAction,x=S.forceSubMenuRender,P=S.rootClassName,D=S.motion,F=S.defaultMotions,j=b.useState(!1),B=We(j,2),H=B[0],K=B[1],J=Ae(R?Ae({},ege):Ae({},Zme),A),q=tge[g],Q=$7(g,D,F),ee=b.useRef(Q);g!=="inline"&&(ee.current=Q);var ne=Ae(Ae({},ee.current),{},{leavedClassName:"".concat(n,"-hidden"),removeOnLeave:!1,motionAppear:!0}),he=b.useRef();return b.useEffect(function(){return he.current=ao(function(){K(o)}),function(){ao.cancel(he.current)}},[o]),b.createElement(S7,{prefixCls:n,popupClassName:Ye("".concat(n,"-popup"),st({},"".concat(n,"-rtl"),R),d,P),stretch:g==="horizontal"?"minWidth":null,getPopupContainer:T,builtinPlacements:J,popupPlacement:q,popupVisible:H,popup:c,popupAlign:p&&{offset:p},action:m?[]:[M],mouseEnterDelay:N,mouseLeaveDelay:O,onPopupVisibleChange:_,forceRender:x,popupMotion:ne},s)}function rge(e){var n=e.id,o=e.open,s=e.keyPath,c=e.children,d="inline",p=b.useContext(nc),m=p.prefixCls,g=p.forceSubMenuRender,_=p.motion,S=p.defaultMotions,T=p.mode,R=b.useRef(!1);R.current=T===d;var N=b.useState(!R.current),O=We(N,2),A=O[0],M=O[1],x=R.current?o:!1;b.useEffect(function(){R.current&&M(!1)},[T]);var P=Ae({},$7(d,_,S));s.length>1&&(P.motionAppear=!1);var D=P.onVisibleChanged;return P.onVisibleChanged=function(F){return!R.current&&!F&&M(!0),D==null?void 0:D(F)},A?null:b.createElement(Fm,{mode:d,locked:!R.current},b.createElement(qd,Qe({visible:x},P,{forceRender:g,removeOnLeave:!1,leavedClassName:"".concat(m,"-hidden")}),function(F){var j=F.className,B=F.style;return b.createElement(rx,{id:n,className:j,style:B},c)}))}var ige=["style","className","title","eventKey","warnKey","disabled","internalPopupClose","children","itemIcon","expandIcon","popupClassName","popupOffset","onClick","onMouseEnter","onMouseLeave","onTitleClick","onTitleMouseEnter","onTitleMouseLeave"],oge=["active"],age=function(n){var o,s=n.style,c=n.className,d=n.title,p=n.eventKey;n.warnKey;var m=n.disabled,g=n.internalPopupClose,_=n.children,S=n.itemIcon,T=n.expandIcon,R=n.popupClassName,N=n.popupOffset,O=n.onClick,A=n.onMouseEnter,M=n.onMouseLeave,x=n.onTitleClick,P=n.onTitleMouseEnter,D=n.onTitleMouseLeave,F=xn(n,ige),j=D7(p),B=b.useContext(nc),H=B.prefixCls,K=B.mode,J=B.openKeys,q=B.disabled,Q=B.overflowDisabled,ee=B.activeKey,ne=B.selectedKeys,he=B.itemIcon,pe=B.expandIcon,ce=B.onItemClick,se=B.onOpenChange,ae=B.onActive,Ee=b.useContext(tx),ve=Ee._internalRenderSubMenuItem,le=b.useContext(M7),de=le.isSubPathKey,ye=uf(),fe="".concat(H,"-submenu"),ke=q||m,Me=b.useRef(),Ve=b.useRef(),je=S||he,dt=T||pe,ut=J.includes(p),Ct=!Q&&ut,_t=de(ne,p),Tt=B7(p,ke,P,D),it=Tt.active,kt=xn(Tt,oge),qt=b.useState(!1),xt=We(qt,2),ze=xt[0],ct=xt[1],et=function(Jt){ke||ct(Jt)},tt=function(Jt){et(!0),A==null||A({key:p,domEvent:Jt})},mt=function(Jt){et(!1),M==null||M({key:p,domEvent:Jt})},Ot=b.useMemo(function(){return it||(K!=="inline"?ze||de([ee],p):!1)},[K,it,ee,ze,p,de]),Ht=j7(ye.length),hn=function(Jt){ke||(x==null||x({key:p,domEvent:Jt}),K==="inline"&&se(p,!ut))},Lt=z0(function(Ut){O==null||O(py(Ut)),ce(Ut)}),br=function(Jt){K!=="inline"&&se(p,Jt)},Xt=function(){ae(p)},In=j&&"".concat(j,"-popup"),Hr=b.createElement("div",Qe({role:"menuitem",style:Ht,className:"".concat(fe,"-title"),tabIndex:ke?null:-1,ref:Me,title:typeof d=="string"?d:null,"data-menu-id":Q&&j?null:j,"aria-expanded":Ct,"aria-haspopup":!0,"aria-controls":In,"aria-disabled":ke,onClick:hn,onFocus:Xt},kt),d,b.createElement(V7,{icon:K!=="horizontal"?dt:null,props:Ae(Ae({},n),{},{isOpen:Ct,isSubMenu:!0})},b.createElement("i",{className:"".concat(fe,"-arrow")}))),sn=b.useRef(K);if(K!=="inline"&&ye.length>1?sn.current="vertical":sn.current=K,!Q){var Dr=sn.current;Hr=b.createElement(nge,{mode:Dr,prefixCls:fe,visible:!g&&Ct&&K!=="inline",popupClassName:R,popupOffset:N,popup:b.createElement(Fm,{mode:Dr==="horizontal"?"vertical":Dr},b.createElement(rx,{id:In,ref:Ve},_)),disabled:ke,onVisibleChange:br},Hr)}var Qn=b.createElement(ll.Item,Qe({role:"none"},F,{component:"li",style:s,className:Ye(fe,"".concat(fe,"-").concat(K),c,(o={},st(o,"".concat(fe,"-open"),Ct),st(o,"".concat(fe,"-active"),Ot),st(o,"".concat(fe,"-selected"),_t),st(o,"".concat(fe,"-disabled"),ke),o)),onMouseEnter:tt,onMouseLeave:mt}),Hr,!Q&&b.createElement(rge,{id:In,open:Ct,keyPath:ye},_));return ve&&(Qn=ve(Qn,n,{selected:_t,active:Ot,open:Ct,disabled:ke})),b.createElement(Fm,{onItemClick:Lt,mode:K==="horizontal"?"vertical":K,itemIcon:je,expandIcon:dt},Qn)};function _S(e){var n=e.eventKey,o=e.children,s=uf(n),c=ix(o,s),d=vS();b.useEffect(function(){if(d)return d.registerPath(n,s),function(){d.unregisterPath(n,s)}},[s]);var p;return d?p=c:p=b.createElement(age,e,c),b.createElement(L7.Provider,{value:s},p)}var sge=["prefixCls","rootClassName","style","className","tabIndex","items","children","direction","id","mode","inlineCollapsed","disabled","disabledOverflow","subMenuOpenDelay","subMenuCloseDelay","forceSubMenuRender","defaultOpenKeys","openKeys","activeKey","defaultActiveFirst","selectable","multiple","defaultSelectedKeys","selectedKeys","onSelect","onDeselect","inlineIndent","motion","defaultMotions","triggerSubMenuAction","builtinPlacements","itemIcon","expandIcon","overflowedIndicator","overflowedIndicatorPopupClassName","getPopupContainer","onClick","onOpenChange","onKeyDown","openAnimation","openTransitionName","_internalRenderMenuItem","_internalRenderSubMenuItem"],lp=[],cge=b.forwardRef(function(e,n){var o,s,c=e,d=c.prefixCls,p=d===void 0?"rc-menu":d,m=c.rootClassName,g=c.style,_=c.className,S=c.tabIndex,T=S===void 0?0:S,R=c.items,N=c.children,O=c.direction,A=c.id,M=c.mode,x=M===void 0?"vertical":M,P=c.inlineCollapsed,D=c.disabled,F=c.disabledOverflow,j=c.subMenuOpenDelay,B=j===void 0?.1:j,H=c.subMenuCloseDelay,K=H===void 0?.1:H,J=c.forceSubMenuRender,q=c.defaultOpenKeys,Q=c.openKeys,ee=c.activeKey,ne=c.defaultActiveFirst,he=c.selectable,pe=he===void 0?!0:he,ce=c.multiple,se=ce===void 0?!1:ce,ae=c.defaultSelectedKeys,Ee=c.selectedKeys,ve=c.onSelect,le=c.onDeselect,de=c.inlineIndent,ye=de===void 0?24:de,fe=c.motion,ke=c.defaultMotions,Me=c.triggerSubMenuAction,Ve=Me===void 0?"hover":Me,je=c.builtinPlacements,dt=c.itemIcon,ut=c.expandIcon,Ct=c.overflowedIndicator,_t=Ct===void 0?"...":Ct,Tt=c.overflowedIndicatorPopupClassName,it=c.getPopupContainer,kt=c.onClick,qt=c.onOpenChange,xt=c.onKeyDown;c.openAnimation,c.openTransitionName;var ze=c._internalRenderMenuItem,ct=c._internalRenderSubMenuItem,et=xn(c,sge),tt=b.useMemo(function(){return Qme(N,R,lp)},[N,R]),mt=b.useState(!1),Ot=We(mt,2),Ht=Ot[0],hn=Ot[1],Lt=b.useRef(),br=Vme(A),Xt=O==="rtl",In=cl(q,{value:Q,postState:function(Yt){return Yt||lp}}),Hr=We(In,2),sn=Hr[0],Dr=Hr[1],Qn=function(Yt){var yn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;function ci(){Dr(Yt),qt==null||qt(Yt)}yn?Cl.flushSync(ci):ci()},Ut=b.useState(sn),Jt=We(Ut,2),ai=Jt[0],Gn=Jt[1],kr=b.useRef(!1),Tr=b.useMemo(function(){return(x==="inline"||x==="vertical")&&P?["vertical",P]:[x,!1]},[x,P]),nt=We(Tr,2),yt=nt[0],En=nt[1],Qt=yt==="inline",tn=b.useState(yt),Wr=We(tn,2),_n=Wr[0],jt=Wr[1],pn=b.useState(En),Pn=We(pn,2),Vn=Pn[0],Jr=Pn[1];b.useEffect(function(){jt(yt),Jr(En),kr.current&&(Qt?Dr(ai):Qn(lp))},[yt,En]);var Qr=b.useState(0),gn=We(Qr,2),Ni=gn[0],Pi=gn[1],As=Ni>=tt.length-1||_n!=="horizontal"||F;b.useEffect(function(){Qt&&Gn(sn)},[sn]),b.useEffect(function(){return kr.current=!0,function(){kr.current=!1}},[]);var Zr=Bme(),dr=Zr.registerPath,Wo=Zr.unregisterPath,Xa=Zr.refreshOverflowKeys,Os=Zr.isSubPathKey,Tl=Zr.getKeyPath,si=Zr.getKeys,xs=Zr.getSubPathKeys,zr=b.useMemo(function(){return{registerPath:dr,unregisterPath:Wo}},[dr,Wo]),Ns=b.useMemo(function(){return{isSubPathKey:Os}},[Os]);b.useEffect(function(){Xa(As?lp:tt.slice(Ni+1).map(function(Kn){return Kn.key}))},[Ni,As]);var Rl=cl(ee||ne&&((o=tt[0])===null||o===void 0?void 0:o.key),{value:ee}),sc=We(Rl,2),Ja=sc[0],Qa=sc[1],zo=z0(function(Kn){Qa(Kn)}),wl=z0(function(){Qa(void 0)});b.useImperativeHandle(n,function(){return{list:Lt.current,focus:function(Yt){var yn,ci=Ja??((yn=tt.find(function(Il){return!Il.props.disabled}))===null||yn===void 0?void 0:yn.key);if(ci){var li,Ko,Ca;(li=Lt.current)===null||li===void 0||(Ko=li.querySelector("li[data-menu-id='".concat(ex(br,ci),"']")))===null||Ko===void 0||(Ca=Ko.focus)===null||Ca===void 0||Ca.call(Ko,Yt)}}}});var Mu=cl(ae||[],{value:Ee,postState:function(Yt){return Array.isArray(Yt)?Yt:Yt==null?lp:[Yt]}}),uo=We(Mu,2),Go=uo[0],Bc=uo[1],Ji=function(Yt){if(pe){var yn=Yt.key,ci=Go.includes(yn),li;se?ci?li=Go.filter(function(Ca){return Ca!==yn}):li=[].concat(ot(Go),[yn]):li=[yn],Bc(li);var Ko=Ae(Ae({},Yt),{},{selectedKeys:li});ci?le==null||le(Ko):ve==null||ve(Ko)}!se&&sn.length&&_n!=="inline"&&Qn(lp)},ya=z0(function(Kn){kt==null||kt(py(Kn)),Ji(Kn)}),Sa=z0(function(Kn,Yt){var yn=sn.filter(function(li){return li!==Kn});if(Yt)yn.push(Kn);else if(_n!=="inline"){var ci=xs(Kn);yn=yn.filter(function(li){return!ci.has(li)})}iS(sn,yn,!0)||Qn(yn,!0)}),ei=function(Yt,yn){var ci=yn??!sn.includes(Yt);Sa(Yt,ci)},ho=Mme(_n,Ja,Xt,br,Lt,si,Tl,Qa,ei,xt);b.useEffect(function(){hn(!0)},[]);var Za=b.useMemo(function(){return{_internalRenderMenuItem:ze,_internalRenderSubMenuItem:ct}},[ze,ct]),Po=_n!=="horizontal"||F?tt:tt.map(function(Kn,Yt){return b.createElement(Fm,{key:Kn.key,overflowDisabled:Yt>Ni},Kn)}),Fu=b.createElement(ll,Qe({id:A,ref:Lt,prefixCls:"".concat(p,"-overflow"),component:"ul",itemComponent:ES,className:Ye(p,"".concat(p,"-root"),"".concat(p,"-").concat(_n),_,(s={},st(s,"".concat(p,"-inline-collapsed"),Vn),st(s,"".concat(p,"-rtl"),Xt),s),m),dir:O,style:g,role:"menu",tabIndex:T,data:Po,renderRawItem:function(Yt){return Yt},renderRawRest:function(Yt){var yn=Yt.length,ci=yn?tt.slice(-yn):null;return b.createElement(_S,{eventKey:pA,title:_t,disabled:As,internalPopupClose:yn===0,popupClassName:Tt},ci)},maxCount:_n!=="horizontal"||F?ll.INVALIDATE:ll.RESPONSIVE,ssr:"full","data-menu-list":!0,onVisibleChange:function(Yt){Pi(Yt)},onKeyDown:ho},et));return b.createElement(tx.Provider,{value:Za},b.createElement(P7.Provider,{value:br},b.createElement(Fm,{prefixCls:p,rootClassName:m,mode:_n,openKeys:sn,rtl:Xt,disabled:D,motion:Ht?fe:null,defaultMotions:Ht?ke:null,activeKey:Ja,onActive:zo,onInactive:wl,selectedKeys:Go,inlineIndent:ye,subMenuOpenDelay:B,subMenuCloseDelay:K,forceSubMenuRender:J,builtinPlacements:je,triggerSubMenuAction:Ve,getPopupContainer:it,itemIcon:dt,expandIcon:ut,onItemClick:ya,onOpenChange:Sa},b.createElement(M7.Provider,{value:Ns},Fu),b.createElement("div",{style:{display:"none"},"aria-hidden":!0},b.createElement(k7.Provider,{value:zr},tt)))))}),lge=["className","title","eventKey","children"],uge=["children"],dge=function(n){var o=n.className,s=n.title;n.eventKey;var c=n.children,d=xn(n,lge),p=b.useContext(nc),m=p.prefixCls,g="".concat(m,"-item-group");return b.createElement("li",Qe({role:"presentation"},d,{onClick:function(S){return S.stopPropagation()},className:Ye(g,o)}),b.createElement("div",{role:"presentation",className:"".concat(g,"-title"),title:typeof s=="string"?s:void 0},s),b.createElement("ul",{role:"group",className:"".concat(g,"-list")},c))};function yS(e){var n=e.children,o=xn(e,uge),s=uf(o.eventKey),c=ix(n,s),d=vS();return d?c:b.createElement(dge,Ea(o,["warnKey"]),c)}function ox(e){var n=e.className,o=e.style,s=b.useContext(nc),c=s.prefixCls,d=vS();return d?null:b.createElement("li",{className:Ye("".concat(c,"-item-divider"),n),style:o})}var eg=cge;eg.Item=ES;eg.SubMenu=_S;eg.ItemGroup=yS;eg.Divider=ox;var H7={};Object.defineProperty(H7,"__esModule",{value:!0});var hge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"ellipsis",theme:"outlined"},pge=H7.default=hge;function fge(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function mge(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){fge(e,c,o[c])})}return e}function gge(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function vge(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gge(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var Ege=function(e,n){return b.createElement(qi,vge(mge({},e),{ref:n,icon:pge}))};const _ge=b.forwardRef(Ege),yge=b.createContext({prefixCls:"",firstLevel:!0,inlineCollapsed:!1}),fy=yge;globalThis&&globalThis.__rest;const Sge=b.createContext(null),k5=Sge;var Cge=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const bge=e=>{const{prefixCls:n,className:o,dashed:s}=e,c=Cge(e,["prefixCls","className","dashed"]),{getPrefixCls:d}=b.useContext(nr),p=d("menu",n),m=Ye({[`${p}-item-divider-dashed`]:!!s},o);return b.createElement(ox,Object.assign({className:m},c))},W7=bge;var z7={};Object.defineProperty(z7,"__esModule",{value:!0});var Tge={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"bars",theme:"outlined"},Rge=z7.default=Tge;function wge(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function Ige(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){wge(e,c,o[c])})}return e}function Age(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Oge(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Age(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var xge=function(e,n){return b.createElement(qi,Oge(Ige({},e),{ref:n,icon:Rge}))};const Nge=b.forwardRef(xge);var G7={};Object.defineProperty(G7,"__esModule",{value:!0});var Pge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}}]},name:"left",theme:"outlined"},Dge=G7.default=Pge;function kge(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function Lge(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){kge(e,c,o[c])})}return e}function Mge(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Fge(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mge(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var Uge=function(e,n){return b.createElement(qi,Fge(Lge({},e),{ref:n,icon:Dge}))};const L5=b.forwardRef(Uge),Bge=e=>!isNaN(parseFloat(e))&&isFinite(e),jge=Bge,Vge=e=>{const{componentCls:n,colorBgContainer:o,colorBgBody:s,colorText:c}=e;return{[`${n}-sider-light`]:{background:o,[`${n}-sider-trigger`]:{color:c,background:o},[`${n}-sider-zero-width-trigger`]:{color:c,background:o,border:`1px solid ${s}`,borderInlineStart:0}}}},$ge=Vge,Hge=e=>{const{antCls:n,componentCls:o,colorText:s,colorTextLightSolid:c,colorBgHeader:d,colorBgBody:p,colorBgTrigger:m,layoutHeaderHeight:g,layoutHeaderPaddingInline:_,layoutHeaderColor:S,layoutFooterPadding:T,layoutTriggerHeight:R,layoutZeroTriggerSize:N,motionDurationMid:O,motionDurationSlow:A,fontSize:M,borderRadius:x}=e;return{[o]:Object.assign(Object.assign({display:"flex",flex:"auto",flexDirection:"column",minHeight:0,background:p,"&, *":{boxSizing:"border-box"},[`&${o}-has-sider`]:{flexDirection:"row",[`> ${o}, > ${o}-content`]:{width:0}},[`${o}-header, &${o}-footer`]:{flex:"0 0 auto"},[`${o}-sider`]:{position:"relative",minWidth:0,background:d,transition:`all ${O}, background 0s`,"&-children":{height:"100%",marginTop:-.1,paddingTop:.1,[`${n}-menu${n}-menu-inline-collapsed`]:{width:"auto"}},"&-has-trigger":{paddingBottom:R},"&-right":{order:1},"&-trigger":{position:"fixed",bottom:0,zIndex:1,height:R,color:c,lineHeight:`${R}px`,textAlign:"center",background:m,cursor:"pointer",transition:`all ${O}`},"&-zero-width":{"> *":{overflow:"hidden"},"&-trigger":{position:"absolute",top:g,insetInlineEnd:-N,zIndex:1,width:N,height:N,color:c,fontSize:e.fontSizeXL,display:"flex",alignItems:"center",justifyContent:"center",background:d,borderStartStartRadius:0,borderStartEndRadius:x,borderEndEndRadius:x,borderEndStartRadius:0,cursor:"pointer",transition:`background ${A} ease`,"&::after":{position:"absolute",inset:0,background:"transparent",transition:`all ${A}`,content:'""'},"&:hover::after":{background:"rgba(255, 255, 255, 0.2)"},"&-right":{insetInlineStart:-N,borderStartStartRadius:x,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:x}}}}},$ge(e)),{"&-rtl":{direction:"rtl"}}),[`${o}-header`]:{height:g,paddingInline:_,color:S,lineHeight:`${g}px`,background:d,[`${n}-menu`]:{lineHeight:"inherit"}},[`${o}-footer`]:{padding:T,color:s,fontSize:M,background:p},[`${o}-content`]:{flex:"auto",minHeight:0}}},K7=ic("Layout",e=>{const{colorText:n,controlHeightSM:o,controlHeight:s,controlHeightLG:c,marginXXS:d}=e,p=c*1.25,m=lo(e,{layoutHeaderHeight:s*2,layoutHeaderPaddingInline:p,layoutHeaderColor:n,layoutFooterPadding:`${o}px ${p}px`,layoutTriggerHeight:c+d*2,layoutZeroTriggerSize:c});return[Hge(m)]},e=>{const{colorBgLayout:n}=e;return{colorBgHeader:"#001529",colorBgBody:n,colorBgTrigger:"#002140"}});var q7=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const Y7=b.createContext({siderHook:{addSider:()=>null,removeSider:()=>null}});function SS(e){let{suffixCls:n,tagName:o,displayName:s}=e;return c=>b.forwardRef((p,m)=>b.createElement(c,Object.assign({ref:m,suffixCls:n,tagName:o},p)))}const ax=b.forwardRef((e,n)=>{const{prefixCls:o,suffixCls:s,className:c,tagName:d}=e,p=q7(e,["prefixCls","suffixCls","className","tagName"]),{getPrefixCls:m}=b.useContext(nr),g=m("layout",o),[_,S]=K7(g),T=s?`${g}-${s}`:g;return _(b.createElement(d,Object.assign({className:Ye(o||T,c,S),ref:n},p)))}),Wge=b.forwardRef((e,n)=>{const{direction:o}=b.useContext(nr),[s,c]=b.useState([]),{prefixCls:d,className:p,rootClassName:m,children:g,hasSider:_,tagName:S}=e,T=q7(e,["prefixCls","className","rootClassName","children","hasSider","tagName"]),R=Ea(T,["suffixCls"]),{getPrefixCls:N}=b.useContext(nr),O=N("layout",d),[A,M]=K7(O),x=Ye(O,{[`${O}-has-sider`]:typeof _=="boolean"?_:s.length>0,[`${O}-rtl`]:o==="rtl"},p,m,M),P=b.useMemo(()=>({siderHook:{addSider:D=>{c(F=>[].concat(ot(F),[D]))},removeSider:D=>{c(F=>F.filter(j=>j!==D))}}}),[]);return A(b.createElement(Y7.Provider,{value:P},b.createElement(S,Object.assign({ref:n,className:x},R),g)))}),zge=SS({tagName:"section",displayName:"Layout"})(Wge),Gge=SS({suffixCls:"header",tagName:"header",displayName:"Header"})(ax),Kge=SS({suffixCls:"footer",tagName:"footer",displayName:"Footer"})(ax),qge=SS({suffixCls:"content",tagName:"main",displayName:"Content"})(ax),Yge=zge;var Xge=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const M5={xs:"479.98px",sm:"575.98px",md:"767.98px",lg:"991.98px",xl:"1199.98px",xxl:"1599.98px"},sx=b.createContext({}),Jge=(()=>{let e=0;return function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return e+=1,`${n}${e}`}})(),Qge=b.forwardRef((e,n)=>{var{prefixCls:o,className:s,trigger:c,children:d,defaultCollapsed:p=!1,theme:m="dark",style:g={},collapsible:_=!1,reverseArrow:S=!1,width:T=200,collapsedWidth:R=80,zeroWidthTriggerStyle:N,breakpoint:O,onCollapse:A,onBreakpoint:M}=e,x=Xge(e,["prefixCls","className","trigger","children","defaultCollapsed","theme","style","collapsible","reverseArrow","width","collapsedWidth","zeroWidthTriggerStyle","breakpoint","onCollapse","onBreakpoint"]);const{siderHook:P}=b.useContext(Y7),[D,F]=b.useState("collapsed"in x?x.collapsed:p),[j,B]=b.useState(!1);b.useEffect(()=>{"collapsed"in x&&F(x.collapsed)},[x.collapsed]);const H=(ne,he)=>{"collapsed"in x||F(ne),A==null||A(ne,he)},K=b.useRef();K.current=ne=>{B(ne.matches),M==null||M(ne.matches),D!==ne.matches&&H(ne.matches,"responsive")},b.useEffect(()=>{function ne(pe){return K.current(pe)}let he;if(typeof window<"u"){const{matchMedia:pe}=window;if(pe&&O&&O in M5){he=pe(`(max-width: ${M5[O]})`);try{he.addEventListener("change",ne)}catch{he.addListener(ne)}ne(he)}}return()=>{try{he==null||he.removeEventListener("change",ne)}catch{he==null||he.removeListener(ne)}}},[O]),b.useEffect(()=>{const ne=Jge("ant-sider-");return P.addSider(ne),()=>P.removeSider(ne)},[]);const J=()=>{H(!D,"clickTrigger")},{getPrefixCls:q}=b.useContext(nr),Q=()=>{const ne=q("layout-sider",o),he=Ea(x,["collapsed"]),pe=D?R:T,ce=jge(pe)?`${pe}px`:String(pe),se=parseFloat(String(R||0))===0?b.createElement("span",{onClick:J,className:Ye(`${ne}-zero-width-trigger`,`${ne}-zero-width-trigger-${S?"right":"left"}`),style:N},c||b.createElement(Nge,null)):null,ve={expanded:S?b.createElement(A5,null):b.createElement(L5,null),collapsed:S?b.createElement(L5,null):b.createElement(A5,null)}[D?"collapsed":"expanded"],le=c!==null?se||b.createElement("div",{className:`${ne}-trigger`,onClick:J,style:{width:ce}},c||ve):null,de=Object.assign(Object.assign({},g),{flex:`0 0 ${ce}`,maxWidth:ce,minWidth:ce,width:ce}),ye=Ye(ne,`${ne}-${m}`,{[`${ne}-collapsed`]:!!D,[`${ne}-has-trigger`]:_&&c!==null&&!se,[`${ne}-below`]:!!j,[`${ne}-zero-width`]:parseFloat(ce)===0},s);return b.createElement("aside",Object.assign({className:ye},he,{style:de,ref:n}),b.createElement("div",{className:`${ne}-children`},d),_||j&&se?le:null)},ee=b.useMemo(()=>({siderCollapsed:D}),[D]);return b.createElement(sx.Provider,{value:ee},Q())}),Zge=Qge,eve=e=>{var n;const{className:o,children:s,icon:c,title:d,danger:p}=e,{prefixCls:m,firstLevel:g,direction:_,disableMenuItemTitleTooltip:S,inlineCollapsed:T}=b.useContext(fy),R=P=>{const D=b.createElement("span",{className:`${m}-title-content`},s);return(!c||Au(s)&&s.type==="span")&&s&&P&&g&&typeof s=="string"?b.createElement("div",{className:`${m}-inline-collapsed-noicon`},s.charAt(0)):D},{siderCollapsed:N}=b.useContext(sx);let O=d;typeof d>"u"?O=g?s:"":d===!1&&(O="");const A={title:O};!N&&!T&&(A.title=null,A.open=!1);const M=ml(s).length;let x=b.createElement(ES,Object.assign({},Ea(e,["title","icon","danger"]),{className:Ye({[`${m}-item-danger`]:p,[`${m}-item-only-child`]:(c?M+1:M)===1},o),title:typeof d=="string"?d:void 0}),tc(c,{className:Ye(Au(c)?(n=c.props)===null||n===void 0?void 0:n.className:"",`${m}-item-icon`)}),R(T));return S||(x=b.createElement(Mm,Object.assign({},A,{placement:_==="rtl"?"left":"right",overlayClassName:`${m}-inline-collapsed-tooltip`}),x)),x},X7=eve,tve=e=>{var n;const{popupClassName:o,icon:s,title:c,theme:d}=e,p=b.useContext(fy),{prefixCls:m,inlineCollapsed:g,theme:_}=p,S=uf();let T;if(!s)T=g&&!S.length&&c&&typeof c=="string"?b.createElement("div",{className:`${m}-inline-collapsed-noicon`},c.charAt(0)):b.createElement("span",{className:`${m}-title-content`},c);else{const N=Au(c)&&c.type==="span";T=b.createElement(b.Fragment,null,tc(s,{className:Ye(Au(s)?(n=s.props)===null||n===void 0?void 0:n.className:"",`${m}-item-icon`)}),N?c:b.createElement("span",{className:`${m}-title-content`},c))}const R=b.useMemo(()=>Object.assign(Object.assign({},p),{firstLevel:!1}),[p]);return b.createElement(fy.Provider,{value:R},b.createElement(_S,Object.assign({},Ea(e,["icon"]),{title:T,popupClassName:Ye(m,o,`${m}-${d||_}`)})))},J7=tve;var nve=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function mA(e){return(e||[]).map((n,o)=>{if(n&&typeof n=="object"){const s=n,{label:c,children:d,key:p,type:m}=s,g=nve(s,["label","children","key","type"]),_=p??`tmp-${o}`;return d||m==="group"?m==="group"?b.createElement(yS,Object.assign({key:_},g,{title:c}),mA(d)):b.createElement(J7,Object.assign({key:_},g,{title:c}),mA(d)):m==="divider"?b.createElement(W7,Object.assign({key:_},g)):b.createElement(X7,Object.assign({key:_},g),c)}return null}).filter(n=>n)}function rve(e){return b.useMemo(()=>e&&mA(e),[e])}const ive=e=>{const{componentCls:n,motionDurationSlow:o,menuHorizontalHeight:s,colorSplit:c,lineWidth:d,lineType:p,menuItemPaddingInline:m}=e;return{[`${n}-horizontal`]:{lineHeight:`${s}px`,border:0,borderBottom:`${d}px ${p} ${c}`,boxShadow:"none","&::after":{display:"block",clear:"both",height:0,content:'"\\20"'},[`${n}-item, ${n}-submenu`]:{position:"relative",display:"inline-block",verticalAlign:"bottom",paddingInline:m},[`> ${n}-item:hover,
        > ${n}-item-active,
        > ${n}-submenu ${n}-submenu-title:hover`]:{backgroundColor:"transparent"},[`${n}-item, ${n}-submenu-title`]:{transition:[`border-color ${o}`,`background ${o}`].join(",")},[`${n}-submenu-arrow`]:{display:"none"}}}},ove=ive,ave=e=>{let{componentCls:n,menuArrowOffset:o}=e;return{[`${n}-rtl`]:{direction:"rtl"},[`${n}-submenu-rtl`]:{transformOrigin:"100% 0"},[`${n}-rtl${n}-vertical,
    ${n}-submenu-rtl ${n}-vertical`]:{[`${n}-submenu-arrow`]:{"&::before":{transform:`rotate(-45deg) translateY(-${o})`},"&::after":{transform:`rotate(45deg) translateY(${o})`}}}}},sve=ave,F5=e=>Object.assign({},MV(e)),cve=(e,n)=>{const{componentCls:o,itemColor:s,itemSelectedColor:c,groupTitleColor:d,itemBg:p,subMenuItemBg:m,itemSelectedBg:g,activeBarHeight:_,activeBarWidth:S,activeBarBorderWidth:T,motionDurationSlow:R,motionEaseInOut:N,motionEaseOut:O,menuItemPaddingInline:A,motionDurationMid:M,itemHoverColor:x,lineType:P,colorSplit:D,itemDisabledColor:F,dangerItemColor:j,dangerItemHoverColor:B,dangerItemSelectedColor:H,dangerItemActiveBg:K,dangerItemSelectedBg:J,itemHoverBg:q,menuSubMenuBg:Q,horizontalItemSelectedColor:ee,horizontalItemSelectedBg:ne,horizontalItemBorderRadius:he,horizontalItemHoverBg:pe}=e;return{[`${o}-${n}, ${o}-${n} > ${o}`]:{color:s,background:p,[`&${o}-root:focus-visible`]:Object.assign({},F5(e)),[`${o}-item-group-title`]:{color:d},[`${o}-submenu-selected`]:{[`> ${o}-submenu-title`]:{color:c}},[`${o}-item-disabled, ${o}-submenu-disabled`]:{color:`${F} !important`},[`${o}-item:hover, ${o}-submenu-title:hover`]:{[`&:not(${o}-item-selected):not(${o}-submenu-selected)`]:{color:x}},[`&:not(${o}-horizontal)`]:{[`${o}-item:not(${o}-item-selected)`]:{"&:hover":{backgroundColor:q},"&:active":{backgroundColor:g}},[`${o}-submenu-title`]:{"&:hover":{backgroundColor:q},"&:active":{backgroundColor:g}}},[`${o}-item-danger`]:{color:j,[`&${o}-item:hover`]:{[`&:not(${o}-item-selected):not(${o}-submenu-selected)`]:{color:B}},[`&${o}-item:active`]:{background:K}},[`${o}-item a`]:{"&, &:hover":{color:"inherit"}},[`${o}-item-selected`]:{color:c,[`&${o}-item-danger`]:{color:H},"a, a:hover":{color:"inherit"}},[`& ${o}-item-selected`]:{backgroundColor:g,[`&${o}-item-danger`]:{backgroundColor:J}},[`${o}-item, ${o}-submenu-title`]:{[`&:not(${o}-item-disabled):focus-visible`]:Object.assign({},F5(e))},[`&${o}-submenu > ${o}`]:{backgroundColor:Q},[`&${o}-popup > ${o}`]:{backgroundColor:p},[`&${o}-horizontal`]:Object.assign(Object.assign({},n==="dark"?{borderBottom:0}:{}),{[`> ${o}-item, > ${o}-submenu`]:{top:T,marginTop:-T,marginBottom:0,borderRadius:he,"&::after":{position:"absolute",insetInline:A,bottom:0,borderBottom:`${_}px solid transparent`,transition:`border-color ${R} ${N}`,content:'""'},"&:hover, &-active, &-open":{background:pe,"&::after":{borderBottomWidth:_,borderBottomColor:ee}},"&-selected":{color:ee,backgroundColor:ne,"&::after":{borderBottomWidth:_,borderBottomColor:ee}}}}),[`&${o}-root`]:{[`&${o}-inline, &${o}-vertical`]:{borderInlineEnd:`${T}px ${P} ${D}`}},[`&${o}-inline`]:{[`${o}-sub${o}-inline`]:{background:m},[`${o}-item, ${o}-submenu-title`]:T&&S?{width:`calc(100% + ${T}px)`}:{},[`${o}-item`]:{position:"relative","&::after":{position:"absolute",insetBlock:0,insetInlineEnd:0,borderInlineEnd:`${S}px solid ${c}`,transform:"scaleY(0.0001)",opacity:0,transition:[`transform ${M} ${O}`,`opacity ${M} ${O}`].join(","),content:'""'},[`&${o}-item-danger`]:{"&::after":{borderInlineEndColor:H}}},[`${o}-selected, ${o}-item-selected`]:{"&::after":{transform:"scaleY(1)",opacity:1,transition:[`transform ${M} ${N}`,`opacity ${M} ${N}`].join(",")}}}}}},U5=cve,B5=e=>{const{componentCls:n,menuItemHeight:o,itemMarginInline:s,padding:c,menuArrowSize:d,marginXS:p,marginXXS:m}=e,g=c+d+p;return{[`${n}-item`]:{position:"relative",overflow:"hidden"},[`${n}-item, ${n}-submenu-title`]:{height:o,lineHeight:`${o}px`,paddingInline:c,overflow:"hidden",textOverflow:"ellipsis",marginInline:s,marginBlock:m,width:`calc(100% - ${s*2}px)`},[`> ${n}-item,
            > ${n}-submenu > ${n}-submenu-title`]:{height:o,lineHeight:`${o}px`},[`${n}-item-group-list ${n}-submenu-title,
            ${n}-submenu-title`]:{paddingInlineEnd:g}}},lve=e=>{const{componentCls:n,iconCls:o,menuItemHeight:s,colorTextLightSolid:c,dropdownWidth:d,controlHeightLG:p,motionDurationMid:m,motionEaseOut:g,paddingXL:_,itemMarginInline:S,fontSizeLG:T,motionDurationSlow:R,paddingXS:N,boxShadowSecondary:O}=e,A={height:s,lineHeight:`${s}px`,listStylePosition:"inside",listStyleType:"disc"};return[{[n]:{"&-inline, &-vertical":Object.assign({[`&${n}-root`]:{boxShadow:"none"}},B5(e))},[`${n}-submenu-popup`]:{[`${n}-vertical`]:Object.assign(Object.assign({},B5(e)),{boxShadow:O})}},{[`${n}-submenu-popup ${n}-vertical${n}-sub`]:{minWidth:d,maxHeight:`calc(100vh - ${p*2.5}px)`,padding:"0",overflow:"hidden",borderInlineEnd:0,"&:not([class*='-active'])":{overflowX:"hidden",overflowY:"auto"}}},{[`${n}-inline`]:{width:"100%",[`&${n}-root`]:{[`${n}-item, ${n}-submenu-title`]:{display:"flex",alignItems:"center",transition:[`border-color ${R}`,`background ${R}`,`padding ${m} ${g}`].join(","),[`> ${n}-title-content`]:{flex:"auto",minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},"> *":{flex:"none"}}},[`${n}-sub${n}-inline`]:{padding:0,border:0,borderRadius:0,boxShadow:"none",[`& > ${n}-submenu > ${n}-submenu-title`]:A,[`& ${n}-item-group-title`]:{paddingInlineStart:_}},[`${n}-item`]:A}},{[`${n}-inline-collapsed`]:{width:s*2,[`&${n}-root`]:{[`${n}-item, ${n}-submenu ${n}-submenu-title`]:{[`> ${n}-inline-collapsed-noicon`]:{fontSize:T,textAlign:"center"}}},[`> ${n}-item,
          > ${n}-item-group > ${n}-item-group-list > ${n}-item,
          > ${n}-item-group > ${n}-item-group-list > ${n}-submenu > ${n}-submenu-title,
          > ${n}-submenu > ${n}-submenu-title`]:{insetInlineStart:0,paddingInline:`calc(50% - ${T/2}px - ${S}px)`,textOverflow:"clip",[`
            ${n}-submenu-arrow,
            ${n}-submenu-expand-icon
          `]:{opacity:0},[`${n}-item-icon, ${o}`]:{margin:0,fontSize:T,lineHeight:`${s}px`,"+ span":{display:"inline-block",opacity:0}}},[`${n}-item-icon, ${o}`]:{display:"inline-block"},"&-tooltip":{pointerEvents:"none",[`${n}-item-icon, ${o}`]:{display:"none"},"a, a:hover":{color:c}},[`${n}-item-group-title`]:Object.assign(Object.assign({},Gce),{paddingInline:N})}}]},uve=lve,j5=e=>{const{componentCls:n,fontSize:o,motionDurationSlow:s,motionDurationMid:c,motionEaseInOut:d,motionEaseOut:p,iconCls:m,controlHeightSM:g}=e;return{[`${n}-item, ${n}-submenu-title`]:{position:"relative",display:"block",margin:0,whiteSpace:"nowrap",cursor:"pointer",transition:[`border-color ${s}`,`background ${s}`,`padding ${s} ${d}`].join(","),[`${n}-item-icon, ${m}`]:{minWidth:o,fontSize:o,transition:[`font-size ${c} ${p}`,`margin ${s} ${d}`,`color ${s}`].join(","),"+ span":{marginInlineStart:g-o,opacity:1,transition:[`opacity ${s} ${d}`,`margin ${s}`,`color ${s}`].join(",")}},[`${n}-item-icon`]:Object.assign({},LV()),[`&${n}-item-only-child`]:{[`> ${m}, > ${n}-item-icon`]:{marginInlineEnd:0}}},[`${n}-item-disabled, ${n}-submenu-disabled`]:{background:"none !important",cursor:"not-allowed","&::after":{borderColor:"transparent !important"},a:{color:"inherit !important"},[`> ${n}-submenu-title`]:{color:"inherit !important",cursor:"not-allowed"}}}},V5=e=>{const{componentCls:n,motionDurationSlow:o,motionEaseInOut:s,borderRadius:c,menuArrowSize:d,menuArrowOffset:p}=e;return{[`${n}-submenu`]:{"&-expand-icon, &-arrow":{position:"absolute",top:"50%",insetInlineEnd:e.margin,width:d,color:"currentcolor",transform:"translateY(-50%)",transition:`transform ${o} ${s}, opacity ${o}`},"&-arrow":{"&::before, &::after":{position:"absolute",width:d*.6,height:d*.15,backgroundColor:"currentcolor",borderRadius:c,transition:[`background ${o} ${s}`,`transform ${o} ${s}`,`top ${o} ${s}`,`color ${o} ${s}`].join(","),content:'""'},"&::before":{transform:`rotate(45deg) translateY(-${p})`},"&::after":{transform:`rotate(-45deg) translateY(${p})`}}}}},dve=e=>{const{antCls:n,componentCls:o,fontSize:s,motionDurationSlow:c,motionDurationMid:d,motionEaseInOut:p,lineHeight:m,paddingXS:g,padding:_,colorSplit:S,lineWidth:T,zIndexPopup:R,borderRadiusLG:N,subMenuItemBorderRadius:O,menuArrowSize:A,menuArrowOffset:M,lineType:x,menuPanelMaskInset:P}=e;return[{"":{[`${o}`]:Object.assign(Object.assign({},kI()),{"&-hidden":{display:"none"}})},[`${o}-submenu-hidden`]:{display:"none"}},{[o]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Kd(e)),kI()),{marginBottom:0,paddingInlineStart:0,fontSize:s,lineHeight:0,listStyle:"none",outline:"none",transition:`width ${c} cubic-bezier(0.2, 0, 0, 1) 0s`,"ul, ol":{margin:0,padding:0,listStyle:"none"},"&-overflow":{display:"flex",[`${o}-item`]:{flex:"none"}},[`${o}-item, ${o}-submenu, ${o}-submenu-title`]:{borderRadius:e.itemBorderRadius},[`${o}-item-group-title`]:{padding:`${g}px ${_}px`,fontSize:s,lineHeight:m,transition:`all ${c}`},[`&-horizontal ${o}-submenu`]:{transition:[`border-color ${c} ${p}`,`background ${c} ${p}`].join(",")},[`${o}-submenu, ${o}-submenu-inline`]:{transition:[`border-color ${c} ${p}`,`background ${c} ${p}`,`padding ${d} ${p}`].join(",")},[`${o}-submenu ${o}-sub`]:{cursor:"initial",transition:[`background ${c} ${p}`,`padding ${c} ${p}`].join(",")},[`${o}-title-content`]:{transition:`color ${c}`},[`${o}-item a`]:{"&::before":{position:"absolute",inset:0,backgroundColor:"transparent",content:'""'}},[`${o}-item-divider`]:{overflow:"hidden",lineHeight:0,borderColor:S,borderStyle:x,borderWidth:0,borderTopWidth:T,marginBlock:T,padding:0,"&-dashed":{borderStyle:"dashed"}}}),j5(e)),{[`${o}-item-group`]:{[`${o}-item-group-list`]:{margin:0,padding:0,[`${o}-item, ${o}-submenu-title`]:{paddingInline:`${s*2}px ${_}px`}}},"&-submenu":{"&-popup":{position:"absolute",zIndex:R,borderRadius:N,boxShadow:"none",transformOrigin:"0 0",[`&${o}-submenu`]:{background:"transparent"},"&::before":{position:"absolute",inset:`${P}px 0 0`,zIndex:-1,width:"100%",height:"100%",opacity:0,content:'""'}},"&-placement-rightTop::before":{top:0,insetInlineStart:P},"\n          &-placement-leftTop,\n          &-placement-bottomRight,\n          ":{transformOrigin:"100% 0"},"\n          &-placement-leftBottom,\n          &-placement-topRight,\n          ":{transformOrigin:"100% 100%"},"\n          &-placement-rightBottom,\n          &-placement-topLeft,\n          ":{transformOrigin:"0 100%"},"\n          &-placement-bottomLeft,\n          &-placement-rightTop,\n          ":{transformOrigin:"0 0"},"\n          &-placement-leftTop,\n          &-placement-leftBottom\n          ":{paddingInlineEnd:e.paddingXS},"\n          &-placement-rightTop,\n          &-placement-rightBottom\n          ":{paddingInlineStart:e.paddingXS},"\n          &-placement-topRight,\n          &-placement-topLeft\n          ":{paddingBottom:e.paddingXS},"\n          &-placement-bottomRight,\n          &-placement-bottomLeft\n          ":{paddingTop:e.paddingXS},[`> ${o}`]:Object.assign(Object.assign(Object.assign({borderRadius:N},j5(e)),V5(e)),{[`${o}-item, ${o}-submenu > ${o}-submenu-title`]:{borderRadius:O},[`${o}-submenu-title::after`]:{transition:`transform ${c} ${p}`}})}}),V5(e)),{[`&-inline-collapsed ${o}-submenu-arrow,
        &-inline ${o}-submenu-arrow`]:{"&::before":{transform:`rotate(-45deg) translateX(${M})`},"&::after":{transform:`rotate(45deg) translateX(-${M})`}},[`${o}-submenu-open${o}-submenu-inline > ${o}-submenu-title > ${o}-submenu-arrow`]:{transform:`translateY(-${A*.2}px)`,"&::after":{transform:`rotate(-45deg) translateX(-${M})`},"&::before":{transform:`rotate(45deg) translateX(${M})`}}})},{[`${n}-layout-header`]:{[o]:{lineHeight:"inherit"}}}]},hve=(e,n)=>ic("Menu",(s,c)=>{let{overrideComponentToken:d}=c;if(n===!1)return[];const{colorBgElevated:p,colorPrimary:m,colorError:g,colorErrorHover:_,colorTextLightSolid:S,controlHeightLG:T,fontSize:R}=s,N=R/7*5,O=lo(s,{menuItemHeight:T,menuItemPaddingInline:s.margin,menuArrowSize:N,menuHorizontalHeight:T*1.15,menuArrowOffset:`${N*.25}px`,menuPanelMaskInset:-7,menuSubMenuBg:p}),A=new io(S).setAlpha(.65).toRgbString(),M=lo(O,{itemColor:A,itemHoverColor:S,groupTitleColor:A,itemSelectedColor:S,itemBg:"#001529",subMenuItemBg:"#000c17",itemActiveBg:"transparent",itemSelectedBg:m,activeBarWidth:0,activeBarHeight:0,activeBarBorderWidth:0,itemDisabledColor:new io(S).setAlpha(.25).toRgbString(),dangerItemColor:g,dangerItemHoverColor:_,dangerItemSelectedColor:S,dangerItemActiveBg:g,dangerItemSelectedBg:g,menuSubMenuBg:"#001529",horizontalItemSelectedColor:S,horizontalItemSelectedBg:m},Object.assign({},d));return[dve(O),ove(O),uve(O),U5(O,"light"),U5(M,"dark"),sve(O),h7(O),g5(O,"slide-up"),g5(O,"slide-down"),d7(O,"zoom-big")]},s=>{const{colorPrimary:c,colorError:d,colorTextDisabled:p,colorErrorBg:m,colorText:g,colorTextDescription:_,colorBgContainer:S,colorFillAlter:T,colorFillContent:R,lineWidth:N,lineWidthBold:O,controlItemBgActive:A,colorBgTextHover:M}=s;return{dropdownWidth:160,zIndexPopup:s.zIndexPopupBase+50,radiusItem:s.borderRadiusLG,itemBorderRadius:s.borderRadiusLG,radiusSubMenuItem:s.borderRadiusSM,subMenuItemBorderRadius:s.borderRadiusSM,colorItemText:g,itemColor:g,colorItemTextHover:g,itemHoverColor:g,colorItemTextHoverHorizontal:c,horizontalItemHoverColor:c,colorGroupTitle:_,groupTitleColor:_,colorItemTextSelected:c,itemSelectedColor:c,colorItemTextSelectedHorizontal:c,horizontalItemSelectedColor:c,colorItemBg:S,itemBg:S,colorItemBgHover:M,itemHoverBg:M,colorItemBgActive:R,itemActiveBg:R,colorSubItemBg:T,subMenuItemBg:T,colorItemBgSelected:A,itemSelectedBg:A,colorItemBgSelectedHorizontal:"transparent",horizontalItemSelectedBg:"transparent",colorActiveBarWidth:0,activeBarWidth:0,colorActiveBarHeight:O,activeBarHeight:O,colorActiveBarBorderSize:N,activeBarBorderWidth:N,colorItemTextDisabled:p,itemDisabledColor:p,colorDangerItemText:d,dangerItemColor:d,colorDangerItemTextHover:d,dangerItemHoverColor:d,colorDangerItemTextSelected:d,dangerItemSelectedColor:d,colorDangerItemBgActive:m,dangerItemActiveBg:m,colorDangerItemBgSelected:m,dangerItemSelectedBg:m,itemMarginInline:s.marginXXS,horizontalItemBorderRadius:0,horizontalItemHoverBg:"transparent"}},{deprecatedTokens:[["colorGroupTitle","groupTitleColor"],["radiusItem","itemBorderRadius"],["radiusSubMenuItem","subMenuItemBorderRadius"],["colorItemText","itemColor"],["colorItemTextHover","itemHoverColor"],["colorItemTextHoverHorizontal","horizontalItemHoverColor"],["colorItemTextSelected","itemSelectedColor"],["colorItemTextSelectedHorizontal","horizontalItemSelectedColor"],["colorItemTextDisabled","itemDisabledColor"],["colorDangerItemText","dangerItemColor"],["colorDangerItemTextHover","dangerItemHoverColor"],["colorDangerItemTextSelected","dangerItemSelectedColor"],["colorDangerItemBgActive","dangerItemActiveBg"],["colorDangerItemBgSelected","dangerItemSelectedBg"],["colorItemBg","itemBg"],["colorItemBgHover","itemHoverBg"],["colorSubItemBg","subMenuItemBg"],["colorItemBgActive","itemActiveBg"],["colorItemBgSelectedHorizontal","horizontalItemSelectedBg"],["colorActiveBarWidth","activeBarWidth"],["colorActiveBarHeight","activeBarHeight"],["colorActiveBarBorderSize","activeBarBorderWidth"]]})(e);var pve=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const fve=b.forwardRef((e,n)=>{var o,s;const c=b.useContext(k5),d=c||{},{getPrefixCls:p,getPopupContainer:m,direction:g}=b.useContext(nr),_=p(),{prefixCls:S,className:T,theme:R="light",expandIcon:N,_internalDisableMenuItemTitleTooltip:O,inlineCollapsed:A,siderCollapsed:M,items:x,children:P,rootClassName:D,mode:F,selectable:j,onClick:B,overflowedIndicatorPopupClassName:H}=e,K=pve(e,["prefixCls","className","theme","expandIcon","_internalDisableMenuItemTitleTooltip","inlineCollapsed","siderCollapsed","items","children","rootClassName","mode","selectable","onClick","overflowedIndicatorPopupClassName"]),J=Ea(K,["collapsedWidth"]),q=rve(x)||P;(o=d.validator)===null||o===void 0||o.call(d,{mode:F});const Q=qs(function(){var de;B==null||B.apply(void 0,arguments),(de=d.onClick)===null||de===void 0||de.call(d)}),ee=d.mode||F,ne=j??d.selectable,he=b.useMemo(()=>M!==void 0?M:A,[A,M]),pe={horizontal:{motionName:`${_}-slide-up`},inline:XI(_),other:{motionName:`${_}-zoom-big`}},ce=p("menu",S||d.prefixCls),[se,ae]=hve(ce,!c),Ee=Ye(`${ce}-${R}`,T);let ve;if(typeof N=="function")ve=N;else{const de=N||d.expandIcon;ve=tc(de,{className:Ye(`${ce}-submenu-expand-icon`,(s=de==null?void 0:de.props)===null||s===void 0?void 0:s.className)})}const le=b.useMemo(()=>({prefixCls:ce,inlineCollapsed:he||!1,direction:g,firstLevel:!0,theme:R,mode:ee,disableMenuItemTitleTooltip:O}),[ce,he,g,O,R]);return se(b.createElement(k5.Provider,{value:null},b.createElement(fy.Provider,{value:le},b.createElement(eg,Object.assign({getPopupContainer:m,overflowedIndicator:b.createElement(_ge,null),overflowedIndicatorPopupClassName:Ye(ce,`${ce}-${R}`,H),mode:ee,selectable:ne,onClick:Q},J,{inlineCollapsed:he,className:Ee,prefixCls:ce,direction:g,defaultMotions:pe,expandIcon:ve,ref:n,rootClassName:Ye(D,ae)}),q))))}),mve=fve,tg=b.forwardRef((e,n)=>{const o=b.useRef(null),s=b.useContext(sx);return b.useImperativeHandle(n,()=>({menu:o.current,focus:c=>{var d;(d=o.current)===null||d===void 0||d.focus(c)}})),b.createElement(mve,Object.assign({ref:o},e,s))});tg.Item=X7;tg.SubMenu=J7;tg.Divider=W7;tg.ItemGroup=yS;const gve=tg,vve=e=>({"&::-moz-placeholder":{opacity:1},"&::placeholder":{color:e,userSelect:"none"},"&:placeholder-shown":{textOverflow:"ellipsis"}}),cx=e=>({borderColor:e.inputBorderHoverColor,borderInlineEndWidth:e.lineWidth}),gA=e=>({borderColor:e.inputBorderHoverColor,boxShadow:`0 0 0 ${e.controlOutlineWidth}px ${e.controlOutline}`,borderInlineEndWidth:e.lineWidth,outline:0}),Q7=e=>({color:e.colorTextDisabled,backgroundColor:e.colorBgContainerDisabled,borderColor:e.colorBorder,boxShadow:"none",cursor:"not-allowed",opacity:1,"&:hover":Object.assign({},cx(lo(e,{inputBorderHoverColor:e.colorBorder})))}),Z7=e=>{const{inputPaddingVerticalLG:n,fontSizeLG:o,lineHeightLG:s,borderRadiusLG:c,inputPaddingHorizontalLG:d}=e;return{padding:`${n}px ${d}px`,fontSize:o,lineHeight:s,borderRadius:c}},e9=e=>({padding:`${e.inputPaddingVerticalSM}px ${e.controlPaddingHorizontalSM-1}px`,borderRadius:e.borderRadiusSM}),t9=(e,n)=>{const{componentCls:o,colorError:s,colorWarning:c,colorErrorOutline:d,colorWarningOutline:p,colorErrorBorderHover:m,colorWarningBorderHover:g}=e;return{[`&-status-error:not(${n}-disabled):not(${n}-borderless)${n}`]:{borderColor:s,"&:hover":{borderColor:m},"&:focus, &-focused":Object.assign({},gA(lo(e,{inputBorderActiveColor:s,inputBorderHoverColor:s,controlOutline:d}))),[`${o}-prefix, ${o}-suffix`]:{color:s}},[`&-status-warning:not(${n}-disabled):not(${n}-borderless)${n}`]:{borderColor:c,"&:hover":{borderColor:g},"&:focus, &-focused":Object.assign({},gA(lo(e,{inputBorderActiveColor:c,inputBorderHoverColor:c,controlOutline:p}))),[`${o}-prefix, ${o}-suffix`]:{color:c}}}},n9=e=>Object.assign(Object.assign({position:"relative",display:"inline-block",width:"100%",minWidth:0,padding:`${e.inputPaddingVertical}px ${e.inputPaddingHorizontal}px`,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight,backgroundColor:e.colorBgContainer,backgroundImage:"none",borderWidth:e.lineWidth,borderStyle:e.lineType,borderColor:e.colorBorder,borderRadius:e.borderRadius,transition:`all ${e.motionDurationMid}`},vve(e.colorTextPlaceholder)),{"&:hover":Object.assign({},cx(e)),"&:focus, &-focused":Object.assign({},gA(e)),"&-disabled, &[disabled]":Object.assign({},Q7(e)),"&-borderless":{"&, &:hover, &:focus, &-focused, &-disabled, &[disabled]":{backgroundColor:"transparent",border:"none",boxShadow:"none"}},"textarea&":{maxWidth:"100%",height:"auto",minHeight:e.controlHeight,lineHeight:e.lineHeight,verticalAlign:"bottom",transition:`all ${e.motionDurationSlow}, height 0s`,resize:"vertical"},"&-lg":Object.assign({},Z7(e)),"&-sm":Object.assign({},e9(e)),"&-rtl":{direction:"rtl"},"&-textarea-rtl":{direction:"rtl"}}),Eve=e=>{const{componentCls:n,antCls:o}=e;return{position:"relative",display:"table",width:"100%",borderCollapse:"separate",borderSpacing:0,"&[class*='col-']":{paddingInlineEnd:e.paddingXS,"&:last-child":{paddingInlineEnd:0}},[`&-lg ${n}, &-lg > ${n}-group-addon`]:Object.assign({},Z7(e)),[`&-sm ${n}, &-sm > ${n}-group-addon`]:Object.assign({},e9(e)),[`&-lg ${o}-select-single ${o}-select-selector`]:{height:e.controlHeightLG},[`&-sm ${o}-select-single ${o}-select-selector`]:{height:e.controlHeightSM},[`> ${n}`]:{display:"table-cell","&:not(:first-child):not(:last-child)":{borderRadius:0}},[`${n}-group`]:{"&-addon, &-wrap":{display:"table-cell",width:1,whiteSpace:"nowrap",verticalAlign:"middle","&:not(:first-child):not(:last-child)":{borderRadius:0}},"&-wrap > *":{display:"block !important"},"&-addon":{position:"relative",padding:`0 ${e.inputPaddingHorizontal}px`,color:e.colorText,fontWeight:"normal",fontSize:e.fontSize,textAlign:"center",backgroundColor:e.colorFillAlter,border:`${e.lineWidth}px ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadius,transition:`all ${e.motionDurationSlow}`,lineHeight:1,[`${o}-select`]:{margin:`-${e.inputPaddingVertical+1}px -${e.inputPaddingHorizontal}px`,[`&${o}-select-single:not(${o}-select-customize-input)`]:{[`${o}-select-selector`]:{backgroundColor:"inherit",border:`${e.lineWidth}px ${e.lineType} transparent`,boxShadow:"none"}},"&-open, &-focused":{[`${o}-select-selector`]:{color:e.colorPrimary}}},[`${o}-cascader-picker`]:{margin:`-9px -${e.inputPaddingHorizontal}px`,backgroundColor:"transparent",[`${o}-cascader-input`]:{textAlign:"start",border:0,boxShadow:"none"}}},"&-addon:first-child":{borderInlineEnd:0},"&-addon:last-child":{borderInlineStart:0}},[`${n}`]:{width:"100%",marginBottom:0,textAlign:"inherit","&:focus":{zIndex:1,borderInlineEndWidth:1},"&:hover":{zIndex:1,borderInlineEndWidth:1,[`${n}-search-with-button &`]:{zIndex:0}}},[`> ${n}:first-child, ${n}-group-addon:first-child`]:{borderStartEndRadius:0,borderEndEndRadius:0,[`${o}-select ${o}-select-selector`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${n}-affix-wrapper`]:{[`&:not(:first-child) ${n}`]:{borderStartStartRadius:0,borderEndStartRadius:0},[`&:not(:last-child) ${n}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${n}:last-child, ${n}-group-addon:last-child`]:{borderStartStartRadius:0,borderEndStartRadius:0,[`${o}-select ${o}-select-selector`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`${n}-affix-wrapper`]:{"&:not(:last-child)":{borderStartEndRadius:0,borderEndEndRadius:0,[`${n}-search &`]:{borderStartStartRadius:e.borderRadius,borderEndStartRadius:e.borderRadius}},[`&:not(:first-child), ${n}-search &:not(:first-child)`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&${n}-group-compact`]:Object.assign(Object.assign({display:"block"},kI()),{[`${n}-group-addon, ${n}-group-wrap, > ${n}`]:{"&:not(:first-child):not(:last-child)":{borderInlineEndWidth:e.lineWidth,"&:hover":{zIndex:1},"&:focus":{zIndex:1}}},"& > *":{display:"inline-block",float:"none",verticalAlign:"top",borderRadius:0},[`
        & > ${n}-affix-wrapper,
        & > ${n}-number-affix-wrapper,
        & > ${o}-picker-range
      `]:{display:"inline-flex"},"& > *:not(:last-child)":{marginInlineEnd:-e.lineWidth,borderInlineEndWidth:e.lineWidth},[`${n}`]:{float:"none"},[`& > ${o}-select > ${o}-select-selector,
      & > ${o}-select-auto-complete ${n},
      & > ${o}-cascader-picker ${n},
      & > ${n}-group-wrapper ${n}`]:{borderInlineEndWidth:e.lineWidth,borderRadius:0,"&:hover":{zIndex:1},"&:focus":{zIndex:1}},[`& > ${o}-select-focused`]:{zIndex:1},[`& > ${o}-select > ${o}-select-arrow`]:{zIndex:1},[`& > *:first-child,
      & > ${o}-select:first-child > ${o}-select-selector,
      & > ${o}-select-auto-complete:first-child ${n},
      & > ${o}-cascader-picker:first-child ${n}`]:{borderStartStartRadius:e.borderRadius,borderEndStartRadius:e.borderRadius},[`& > *:last-child,
      & > ${o}-select:last-child > ${o}-select-selector,
      & > ${o}-cascader-picker:last-child ${n},
      & > ${o}-cascader-picker-focused:last-child ${n}`]:{borderInlineEndWidth:e.lineWidth,borderStartEndRadius:e.borderRadius,borderEndEndRadius:e.borderRadius},[`& > ${o}-select-auto-complete ${n}`]:{verticalAlign:"top"},[`${n}-group-wrapper + ${n}-group-wrapper`]:{marginInlineStart:-e.lineWidth,[`${n}-affix-wrapper`]:{borderRadius:0}},[`${n}-group-wrapper:not(:last-child)`]:{[`&${n}-search > ${n}-group`]:{[`& > ${n}-group-addon > ${n}-search-button`]:{borderRadius:0},[`& > ${n}`]:{borderStartStartRadius:e.borderRadius,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:e.borderRadius}}}})}},_ve=e=>{const{componentCls:n,controlHeightSM:o,lineWidth:s}=e,c=16,d=(o-s*2-c)/2;return{[n]:Object.assign(Object.assign(Object.assign(Object.assign({},Kd(e)),n9(e)),t9(e,n)),{'&[type="color"]':{height:e.controlHeight,[`&${n}-lg`]:{height:e.controlHeightLG},[`&${n}-sm`]:{height:o,paddingTop:d,paddingBottom:d}},'&[type="search"]::-webkit-search-cancel-button, &[type="search"]::-webkit-search-decoration':{"-webkit-appearance":"none"}})}},yve=e=>{const{componentCls:n}=e;return{[`${n}-clear-icon`]:{margin:0,color:e.colorTextQuaternary,fontSize:e.fontSizeIcon,verticalAlign:-1,cursor:"pointer",transition:`color ${e.motionDurationSlow}`,"&:hover":{color:e.colorTextTertiary},"&:active":{color:e.colorText},"&-hidden":{visibility:"hidden"},"&-has-suffix":{margin:`0 ${e.inputAffixPadding}px`}}}},Sve=e=>{const{componentCls:n,inputAffixPadding:o,colorTextDescription:s,motionDurationSlow:c,colorIcon:d,colorIconHover:p,iconCls:m}=e;return{[`${n}-affix-wrapper`]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n9(e)),{display:"inline-flex",[`&:not(${n}-affix-wrapper-disabled):hover`]:Object.assign(Object.assign({},cx(e)),{zIndex:1,[`${n}-search-with-button &`]:{zIndex:0}}),"&-focused, &:focus":{zIndex:1},"&-disabled":{[`${n}[disabled]`]:{background:"transparent"}},[`> input${n}`]:{padding:0,fontSize:"inherit",border:"none",borderRadius:0,outline:"none","&::-ms-reveal":{display:"none"},"&:focus":{boxShadow:"none !important"}},"&::before":{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'},[`${n}`]:{"&-prefix, &-suffix":{display:"flex",flex:"none",alignItems:"center","> *:not(:last-child)":{marginInlineEnd:e.paddingXS}},"&-show-count-suffix":{color:s},"&-show-count-has-suffix":{marginInlineEnd:e.paddingXXS},"&-prefix":{marginInlineEnd:o},"&-suffix":{marginInlineStart:o}}}),yve(e)),{[`${m}${n}-password-icon`]:{color:d,cursor:"pointer",transition:`all ${c}`,"&:hover":{color:p}}}),t9(e,`${n}-affix-wrapper`))}},Cve=e=>{const{componentCls:n,colorError:o,colorWarning:s,borderRadiusLG:c,borderRadiusSM:d}=e;return{[`${n}-group`]:Object.assign(Object.assign(Object.assign({},Kd(e)),Eve(e)),{"&-rtl":{direction:"rtl"},"&-wrapper":{display:"inline-block",width:"100%",textAlign:"start",verticalAlign:"top","&-rtl":{direction:"rtl"},"&-lg":{[`${n}-group-addon`]:{borderRadius:c}},"&-sm":{[`${n}-group-addon`]:{borderRadius:d}},"&-status-error":{[`${n}-group-addon`]:{color:o,borderColor:o}},"&-status-warning":{[`${n}-group-addon`]:{color:s,borderColor:s}},"&-disabled":{[`${n}-group-addon`]:Object.assign({},Q7(e))},[`&:not(${n}-compact-first-item):not(${n}-compact-last-item)${n}-compact-item`]:{[`${n}, ${n}-group-addon`]:{borderRadius:0}},[`&:not(${n}-compact-last-item)${n}-compact-first-item`]:{[`${n}, ${n}-group-addon`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&:not(${n}-compact-first-item)${n}-compact-last-item`]:{[`${n}, ${n}-group-addon`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}})}},bve=e=>{const{componentCls:n,antCls:o}=e,s=`${n}-search`;return{[s]:{[`${n}`]:{"&:hover, &:focus":{borderColor:e.colorPrimaryHover,[`+ ${n}-group-addon ${s}-button:not(${o}-btn-primary)`]:{borderInlineStartColor:e.colorPrimaryHover}}},[`${n}-affix-wrapper`]:{borderRadius:0},[`${n}-lg`]:{lineHeight:e.lineHeightLG-2e-4},[`> ${n}-group`]:{[`> ${n}-group-addon:last-child`]:{insetInlineStart:-1,padding:0,border:0,[`${s}-button`]:{paddingTop:0,paddingBottom:0,borderStartStartRadius:0,borderStartEndRadius:e.borderRadius,borderEndEndRadius:e.borderRadius,borderEndStartRadius:0},[`${s}-button:not(${o}-btn-primary)`]:{color:e.colorTextDescription,"&:hover":{color:e.colorPrimaryHover},"&:active":{color:e.colorPrimaryActive},[`&${o}-btn-loading::before`]:{insetInlineStart:0,insetInlineEnd:0,insetBlockStart:0,insetBlockEnd:0}}}},[`${s}-button`]:{height:e.controlHeight,"&:hover, &:focus":{zIndex:1}},[`&-large ${s}-button`]:{height:e.controlHeightLG},[`&-small ${s}-button`]:{height:e.controlHeightSM},"&-rtl":{direction:"rtl"},[`&${n}-compact-item`]:{[`&:not(${n}-compact-last-item)`]:{[`${n}-group-addon`]:{[`${n}-search-button`]:{marginInlineEnd:-e.lineWidth,borderRadius:0}}},[`&:not(${n}-compact-first-item)`]:{[`${n},${n}-affix-wrapper`]:{borderRadius:0}},[`> ${n}-group-addon ${n}-search-button,
        > ${n},
        ${n}-affix-wrapper`]:{"&:hover,&:focus,&:active":{zIndex:2}},[`> ${n}-affix-wrapper-focused`]:{zIndex:2}}}}};function r9(e){return lo(e,{inputAffixPadding:e.paddingXXS,inputPaddingVertical:Math.max(Math.round((e.controlHeight-e.fontSize*e.lineHeight)/2*10)/10-e.lineWidth,3),inputPaddingVerticalLG:Math.ceil((e.controlHeightLG-e.fontSizeLG*e.lineHeightLG)/2*10)/10-e.lineWidth,inputPaddingVerticalSM:Math.max(Math.round((e.controlHeightSM-e.fontSize*e.lineHeight)/2*10)/10-e.lineWidth,0),inputPaddingHorizontal:e.paddingSM-e.lineWidth,inputPaddingHorizontalSM:e.paddingXS-e.lineWidth,inputPaddingHorizontalLG:e.controlPaddingHorizontal-e.lineWidth,inputBorderHoverColor:e.colorPrimaryHover,inputBorderActiveColor:e.colorPrimaryHover})}const Tve=e=>{const{componentCls:n,paddingLG:o}=e,s=`${n}-textarea`;return{[s]:{position:"relative","&-show-count":{[`> ${n}`]:{height:"100%"},[`${n}-data-count`]:{position:"absolute",bottom:-e.fontSize*e.lineHeight,insetInlineEnd:0,color:e.colorTextDescription,whiteSpace:"nowrap",pointerEvents:"none"}},"&-allow-clear":{[`> ${n}`]:{paddingInlineEnd:o}},[`&-affix-wrapper${s}-has-feedback`]:{[`${n}`]:{paddingInlineEnd:o}},[`&-affix-wrapper${n}-affix-wrapper`]:{padding:0,[`> textarea${n}`]:{fontSize:"inherit",border:"none",outline:"none","&:focus":{boxShadow:"none !important"}},[`${n}-suffix`]:{margin:0,"> *:not(:last-child)":{marginInline:0},[`${n}-clear-icon`]:{position:"absolute",insetInlineEnd:e.paddingXS,insetBlockStart:e.paddingXS},[`${s}-suffix`]:{position:"absolute",top:0,insetInlineEnd:e.inputPaddingHorizontal,bottom:0,zIndex:1,display:"inline-flex",alignItems:"center",margin:"auto",pointerEvents:"none"}}}}}},lx=ic("Input",e=>{const n=r9(e);return[_ve(n),Tve(n),Sve(n),Cve(n),bve(n),Y$(n)]}),Rve=b.createContext({}),i9=Rve,wve=e=>{const{componentCls:n}=e;return{[n]:{display:"flex",flexFlow:"row wrap",minWidth:0,"&::before, &::after":{display:"flex"},"&-no-wrap":{flexWrap:"nowrap"},"&-start":{justifyContent:"flex-start"},"&-center":{justifyContent:"center"},"&-end":{justifyContent:"flex-end"},"&-space-between":{justifyContent:"space-between"},"&-space-around":{justifyContent:"space-around"},"&-space-evenly":{justifyContent:"space-evenly"},"&-top":{alignItems:"flex-start"},"&-middle":{alignItems:"center"},"&-bottom":{alignItems:"flex-end"}}}},Ive=e=>{const{componentCls:n}=e;return{[n]:{position:"relative",maxWidth:"100%",minHeight:1}}},Ave=(e,n)=>{const{componentCls:o,gridColumns:s}=e,c={};for(let d=s;d>=0;d--)d===0?(c[`${o}${n}-${d}`]={display:"none"},c[`${o}-push-${d}`]={insetInlineStart:"auto"},c[`${o}-pull-${d}`]={insetInlineEnd:"auto"},c[`${o}${n}-push-${d}`]={insetInlineStart:"auto"},c[`${o}${n}-pull-${d}`]={insetInlineEnd:"auto"},c[`${o}${n}-offset-${d}`]={marginInlineStart:0},c[`${o}${n}-order-${d}`]={order:0}):(c[`${o}${n}-${d}`]={display:"block",flex:`0 0 ${d/s*100}%`,maxWidth:`${d/s*100}%`},c[`${o}${n}-push-${d}`]={insetInlineStart:`${d/s*100}%`},c[`${o}${n}-pull-${d}`]={insetInlineEnd:`${d/s*100}%`},c[`${o}${n}-offset-${d}`]={marginInlineStart:`${d/s*100}%`},c[`${o}${n}-order-${d}`]={order:d});return c},vA=(e,n)=>Ave(e,n),Ove=(e,n,o)=>({[`@media (min-width: ${n}px)`]:Object.assign({},vA(e,o))}),xve=ic("Grid",e=>[wve(e)]),Nve=ic("Grid",e=>{const n=lo(e,{gridColumns:24}),o={"-sm":n.screenSMMin,"-md":n.screenMDMin,"-lg":n.screenLGMin,"-xl":n.screenXLMin,"-xxl":n.screenXXLMin};return[Ive(n),vA(n,""),vA(n,"-xs"),Object.keys(o).map(s=>Ove(n,o[s],s)).reduce((s,c)=>Object.assign(Object.assign({},s),c),{})]});var Pve=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function Dve(e){return typeof e=="number"?`${e} ${e} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(e)?`0 0 ${e}`:e}const kve=["xs","sm","md","lg","xl","xxl"],Lve=b.forwardRef((e,n)=>{const{getPrefixCls:o,direction:s}=b.useContext(nr),{gutter:c,wrap:d,supportFlexGap:p}=b.useContext(i9),{prefixCls:m,span:g,order:_,offset:S,push:T,pull:R,className:N,children:O,flex:A,style:M}=e,x=Pve(e,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),P=o("col",m),[D,F]=Nve(P);let j={};kve.forEach(K=>{let J={};const q=e[K];typeof q=="number"?J.span=q:typeof q=="object"&&(J=q||{}),delete x[K],j=Object.assign(Object.assign({},j),{[`${P}-${K}-${J.span}`]:J.span!==void 0,[`${P}-${K}-order-${J.order}`]:J.order||J.order===0,[`${P}-${K}-offset-${J.offset}`]:J.offset||J.offset===0,[`${P}-${K}-push-${J.push}`]:J.push||J.push===0,[`${P}-${K}-pull-${J.pull}`]:J.pull||J.pull===0,[`${P}-${K}-flex-${J.flex}`]:J.flex||J.flex==="auto",[`${P}-rtl`]:s==="rtl"})});const B=Ye(P,{[`${P}-${g}`]:g!==void 0,[`${P}-order-${_}`]:_,[`${P}-offset-${S}`]:S,[`${P}-push-${T}`]:T,[`${P}-pull-${R}`]:R},N,j,F),H={};if(c&&c[0]>0){const K=c[0]/2;H.paddingLeft=K,H.paddingRight=K}if(c&&c[1]>0&&!p){const K=c[1]/2;H.paddingTop=K,H.paddingBottom=K}return A&&(H.flex=Dve(A),d===!1&&!H.minWidth&&(H.minWidth=0)),D(b.createElement("div",Object.assign({},x,{style:Object.assign(Object.assign({},H),M),className:B,ref:n}),O))}),o9=Lve,Mve=()=>{const[e,n]=b.useState(!1);return b.useEffect(()=>{n(xpe())},[]),e};var Fve=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function $5(e,n){const[o,s]=b.useState(typeof e=="string"?e:""),c=()=>{if(typeof e=="string"&&s(e),typeof e=="object")for(let d=0;d<Lm.length;d++){const p=Lm[d];if(!n[p])continue;const m=e[p];if(m!==void 0){s(m);return}}};return b.useEffect(()=>{c()},[JSON.stringify(e),n]),o}const Uve=b.forwardRef((e,n)=>{const{prefixCls:o,justify:s,align:c,className:d,style:p,children:m,gutter:g=0,wrap:_}=e,S=Fve(e,["prefixCls","justify","align","className","style","children","gutter","wrap"]),{getPrefixCls:T,direction:R}=b.useContext(nr),[N,O]=b.useState({xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0}),[A,M]=b.useState({xs:!1,sm:!1,md:!1,lg:!1,xl:!1,xxl:!1}),x=$5(c,A),P=$5(s,A),D=Mve(),F=b.useRef(g),j=K0e();b.useEffect(()=>{const ae=j.subscribe(Ee=>{M(Ee);const ve=F.current||0;(!Array.isArray(ve)&&typeof ve=="object"||Array.isArray(ve)&&(typeof ve[0]=="object"||typeof ve[1]=="object"))&&O(Ee)});return()=>j.unsubscribe(ae)},[]);const B=()=>{const ae=[void 0,void 0];return(Array.isArray(g)?g:[g,void 0]).forEach((ve,le)=>{if(typeof ve=="object")for(let de=0;de<Lm.length;de++){const ye=Lm[de];if(N[ye]&&ve[ye]!==void 0){ae[le]=ve[ye];break}}else ae[le]=ve}),ae},H=T("row",o),[K,J]=xve(H),q=B(),Q=Ye(H,{[`${H}-no-wrap`]:_===!1,[`${H}-${P}`]:P,[`${H}-${x}`]:x,[`${H}-rtl`]:R==="rtl"},d,J),ee={},ne=q[0]!=null&&q[0]>0?q[0]/-2:void 0,he=q[1]!=null&&q[1]>0?q[1]/-2:void 0;ne&&(ee.marginLeft=ne,ee.marginRight=ne),D?[,ee.rowGap]=q:he&&(ee.marginTop=he,ee.marginBottom=he);const[pe,ce]=q,se=b.useMemo(()=>({gutter:[pe,ce],wrap:_,supportFlexGap:D}),[pe,ce,_,D]);return K(b.createElement(i9.Provider,{value:se},b.createElement("div",Object.assign({},S,{className:Q,style:Object.assign(Object.assign({},ee),p),ref:n}),m)))}),Bve=Uve,jve=e=>{const{getPrefixCls:n,direction:o}=b.useContext(nr),{prefixCls:s,className:c=""}=e,d=n("input-group",s),p=n("input"),[m,g]=lx(p),_=Ye(d,{[`${d}-lg`]:e.size==="large",[`${d}-sm`]:e.size==="small",[`${d}-compact`]:e.compact,[`${d}-rtl`]:o==="rtl"},g,c),S=b.useContext(El),T=b.useMemo(()=>Object.assign(Object.assign({},S),{isFormItemInput:!1}),[S]);return m(b.createElement("span",{className:_,style:e.style,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onFocus:e.onFocus,onBlur:e.onBlur},b.createElement(El.Provider,{value:T},e.children)))},Vve=jve;function up(e){return!!(e.addonBefore||e.addonAfter)}function C1(e){return!!(e.prefix||e.suffix||e.allowClear)}function cm(e,n,o,s){if(o){var c=n;if(n.type==="click"){var d=e.cloneNode(!0);c=Object.create(n,{target:{value:d},currentTarget:{value:d}}),d.value="",o(c);return}if(s!==void 0){c=Object.create(n,{target:{value:e},currentTarget:{value:e}}),e.value=s,o(c);return}o(c)}}function $ve(e,n){if(e){e.focus(n);var o=n||{},s=o.cursor;if(s){var c=e.value.length;switch(s){case"start":e.setSelectionRange(0,0);break;case"end":e.setSelectionRange(c,c);break;default:e.setSelectionRange(0,c)}}}}function EA(e){return typeof e>"u"||e===null?"":String(e)}var a9=function(n){var o,s,c=n.inputElement,d=n.prefixCls,p=n.prefix,m=n.suffix,g=n.addonBefore,_=n.addonAfter,S=n.className,T=n.style,R=n.disabled,N=n.readOnly,O=n.focused,A=n.triggerFocus,M=n.allowClear,x=n.value,P=n.handleReset,D=n.hidden,F=n.classes,j=n.classNames,B=n.dataAttrs,H=n.styles,K=b.useRef(null),J=function(le){var de;(de=K.current)!==null&&de!==void 0&&de.contains(le.target)&&(A==null||A())},q=function(){var le;if(!M)return null;var de=!R&&!N&&x,ye="".concat(d,"-clear-icon"),fe=jn(M)==="object"&&M!==null&&M!==void 0&&M.clearIcon?M.clearIcon:"";return Et.createElement("span",{onClick:P,onMouseDown:function(Me){return Me.preventDefault()},className:Ye(ye,(le={},st(le,"".concat(ye,"-hidden"),!de),st(le,"".concat(ye,"-has-suffix"),!!m),le)),role:"button",tabIndex:-1},fe)},Q=b.cloneElement(c,{value:x,hidden:D,className:Ye((o=c.props)===null||o===void 0?void 0:o.className,!C1(n)&&!up(n)&&S)||null,style:Ae(Ae({},(s=c.props)===null||s===void 0?void 0:s.style),!C1(n)&&!up(n)?T:{})});if(C1(n)){var ee,ne="".concat(d,"-affix-wrapper"),he=Ye(ne,(ee={},st(ee,"".concat(ne,"-disabled"),R),st(ee,"".concat(ne,"-focused"),O),st(ee,"".concat(ne,"-readonly"),N),st(ee,"".concat(ne,"-input-with-clear-btn"),m&&M&&x),ee),!up(n)&&S,F==null?void 0:F.affixWrapper),pe=(m||M)&&Et.createElement("span",{className:Ye("".concat(d,"-suffix"),j==null?void 0:j.suffix),style:H==null?void 0:H.suffix},q(),m);Q=Et.createElement("span",Qe({className:he,style:up(n)?void 0:T,hidden:!up(n)&&D,onClick:J},B==null?void 0:B.affixWrapper,{ref:K}),p&&Et.createElement("span",{className:Ye("".concat(d,"-prefix"),j==null?void 0:j.prefix),style:H==null?void 0:H.prefix},p),b.cloneElement(c,{value:x,hidden:null}),pe)}if(up(n)){var ce="".concat(d,"-group"),se="".concat(ce,"-addon"),ae=Ye("".concat(d,"-wrapper"),ce,F==null?void 0:F.wrapper),Ee=Ye("".concat(d,"-group-wrapper"),S,F==null?void 0:F.group);return Et.createElement("span",{className:Ee,style:T,hidden:D},Et.createElement("span",{className:ae},g&&Et.createElement("span",{className:se},g),b.cloneElement(Q,{hidden:null}),_&&Et.createElement("span",{className:se},_)))}return Q},Hve=["autoComplete","onChange","onFocus","onBlur","onPressEnter","onKeyDown","prefixCls","disabled","htmlSize","className","maxLength","suffix","showCount","type","classes","classNames","styles"],Wve=b.forwardRef(function(e,n){var o=e.autoComplete,s=e.onChange,c=e.onFocus,d=e.onBlur,p=e.onPressEnter,m=e.onKeyDown,g=e.prefixCls,_=g===void 0?"rc-input":g,S=e.disabled,T=e.htmlSize,R=e.className,N=e.maxLength,O=e.suffix,A=e.showCount,M=e.type,x=M===void 0?"text":M,P=e.classes,D=e.classNames,F=e.styles,j=xn(e,Hve),B=cl(e.defaultValue,{value:e.value}),H=We(B,2),K=H[0],J=H[1],q=b.useState(!1),Q=We(q,2),ee=Q[0],ne=Q[1],he=b.useRef(null),pe=function(fe){he.current&&$ve(he.current,fe)};b.useImperativeHandle(n,function(){return{focus:pe,blur:function(){var fe;(fe=he.current)===null||fe===void 0||fe.blur()},setSelectionRange:function(fe,ke,Me){var Ve;(Ve=he.current)===null||Ve===void 0||Ve.setSelectionRange(fe,ke,Me)},select:function(){var fe;(fe=he.current)===null||fe===void 0||fe.select()},input:he.current}}),b.useEffect(function(){ne(function(ye){return ye&&S?!1:ye})},[S]);var ce=function(fe){e.value===void 0&&J(fe.target.value),he.current&&cm(he.current,fe,s)},se=function(fe){p&&fe.key==="Enter"&&p(fe),m==null||m(fe)},ae=function(fe){ne(!0),c==null||c(fe)},Ee=function(fe){ne(!1),d==null||d(fe)},ve=function(fe){J(""),pe(),he.current&&cm(he.current,fe,s)},le=function(){var fe=Ea(e,["prefixCls","onPressEnter","addonBefore","addonAfter","prefix","suffix","allowClear","defaultValue","showCount","classes","htmlSize","styles","classNames"]);return Et.createElement("input",Qe({autoComplete:o},fe,{onChange:ce,onFocus:ae,onBlur:Ee,onKeyDown:se,className:Ye(_,st({},"".concat(_,"-disabled"),S),D==null?void 0:D.input),style:F==null?void 0:F.input,ref:he,size:T,type:x}))},de=function(){var fe=Number(N)>0;if(O||A){var ke=EA(K),Me=ot(ke).length,Ve=jn(A)==="object"?A.formatter({value:ke,count:Me,maxLength:N}):"".concat(Me).concat(fe?" / ".concat(N):"");return Et.createElement(Et.Fragment,null,!!A&&Et.createElement("span",{className:Ye("".concat(_,"-show-count-suffix"),st({},"".concat(_,"-show-count-has-suffix"),!!O),D==null?void 0:D.count),style:Ae({},F==null?void 0:F.count)},Ve),O)}return null};return Et.createElement(a9,Qe({},j,{prefixCls:_,className:R,inputElement:le(),handleReset:ve,value:EA(K),focused:ee,triggerFocus:pe,suffix:de(),disabled:S,classes:P,classNames:D,styles:F}))});function s9(e,n){const o=b.useRef([]),s=()=>{o.current.push(setTimeout(()=>{var c,d,p,m;!((c=e.current)===null||c===void 0)&&c.input&&((d=e.current)===null||d===void 0?void 0:d.input.getAttribute("type"))==="password"&&(!((p=e.current)===null||p===void 0)&&p.input.hasAttribute("value"))&&((m=e.current)===null||m===void 0||m.input.removeAttribute("value"))}))};return b.useEffect(()=>(n&&s(),()=>o.current.forEach(c=>{c&&clearTimeout(c)})),[]),s}function zve(e){return!!(e.prefix||e.suffix||e.allowClear)}var Gve=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function Kve(e,n){if(!e)return;e.focus(n);const{cursor:o}=n||{};if(o){const s=e.value.length;switch(o){case"start":e.setSelectionRange(0,0);break;case"end":e.setSelectionRange(s,s);break;default:e.setSelectionRange(0,s);break}}}const qve=b.forwardRef((e,n)=>{const{prefixCls:o,bordered:s=!0,status:c,size:d,disabled:p,onBlur:m,onFocus:g,suffix:_,allowClear:S,addonAfter:T,addonBefore:R,className:N,rootClassName:O,onChange:A,classNames:M}=e,x=Gve(e,["prefixCls","bordered","status","size","disabled","onBlur","onFocus","suffix","allowClear","addonAfter","addonBefore","className","rootClassName","onChange","classNames"]),{getPrefixCls:P,direction:D,input:F}=Et.useContext(nr),j=P("input",o),B=b.useRef(null),[H,K]=lx(j),{compactSize:J,compactItemClassnames:q}=zO(j,D),Q=af(Me=>{var Ve;return(Ve=d??J)!==null&&Ve!==void 0?Ve:Me}),ee=Et.useContext(qm),ne=p??ee,{status:he,hasFeedback:pe,feedbackIcon:ce}=b.useContext(El),se=C7(he,c),ae=zve(e)||!!pe,Ee=b.useRef(ae);b.useEffect(()=>{ae&&Ee.current,Ee.current=ae},[ae]);const ve=s9(B,!0),le=Me=>{ve(),m==null||m(Me)},de=Me=>{ve(),g==null||g(Me)},ye=Me=>{ve(),A==null||A(Me)},fe=(pe||_)&&Et.createElement(Et.Fragment,null,_,pe&&ce);let ke;return typeof S=="object"&&(S!=null&&S.clearIcon)?ke=S:S&&(ke={clearIcon:Et.createElement(fS,null)}),H(Et.createElement(Wve,Object.assign({ref:Uc(n,B),prefixCls:j,autoComplete:F==null?void 0:F.autoComplete},x,{disabled:ne,onBlur:le,onFocus:de,suffix:fe,allowClear:ke,className:Ye(N,O,q),onChange:ye,addonAfter:T&&Et.createElement(qI,null,Et.createElement(m5,{override:!0,status:!0},T)),addonBefore:R&&Et.createElement(qI,null,Et.createElement(m5,{override:!0,status:!0},R)),classNames:Object.assign(Object.assign({},M),{input:Ye({[`${j}-sm`]:Q==="small",[`${j}-lg`]:Q==="large",[`${j}-rtl`]:D==="rtl",[`${j}-borderless`]:!s},!ae&&sm(j,se),M==null?void 0:M.input,K)}),classes:{affixWrapper:Ye({[`${j}-affix-wrapper-sm`]:Q==="small",[`${j}-affix-wrapper-lg`]:Q==="large",[`${j}-affix-wrapper-rtl`]:D==="rtl",[`${j}-affix-wrapper-borderless`]:!s},sm(`${j}-affix-wrapper`,se,pe),K),wrapper:Ye({[`${j}-group-rtl`]:D==="rtl"},K),group:Ye({[`${j}-group-wrapper-sm`]:Q==="small",[`${j}-group-wrapper-lg`]:Q==="large",[`${j}-group-wrapper-rtl`]:D==="rtl",[`${j}-group-wrapper-disabled`]:ne},sm(`${j}-group-wrapper`,se,pe),K)}})))}),ux=qve;var c9={};Object.defineProperty(c9,"__esModule",{value:!0});var Yve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}},{tag:"path",attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}}]},name:"eye-invisible",theme:"outlined"},Xve=c9.default=Yve;function Jve(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function Qve(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){Jve(e,c,o[c])})}return e}function Zve(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function eEe(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zve(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var tEe=function(e,n){return b.createElement(qi,eEe(Qve({},e),{ref:n,icon:Xve}))};const nEe=b.forwardRef(tEe);var l9={};Object.defineProperty(l9,"__esModule",{value:!0});var rEe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"},iEe=l9.default=rEe;function oEe(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function aEe(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){oEe(e,c,o[c])})}return e}function sEe(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function cEe(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sEe(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var lEe=function(e,n){return b.createElement(qi,cEe(aEe({},e),{ref:n,icon:iEe}))};const uEe=b.forwardRef(lEe);var dEe=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const hEe=e=>e?b.createElement(uEe,null):b.createElement(nEe,null),pEe={click:"onClick",hover:"onMouseOver"},fEe=b.forwardRef((e,n)=>{const{visibilityToggle:o=!0}=e,s=typeof o=="object"&&o.visible!==void 0,[c,d]=b.useState(()=>s?o.visible:!1),p=b.useRef(null);b.useEffect(()=>{s&&d(o.visible)},[s,o]);const m=s9(p),g=()=>{const{disabled:j}=e;j||(c&&m(),d(B=>{var H;const K=!B;return typeof o=="object"&&((H=o.onVisibleChange)===null||H===void 0||H.call(o,K)),K}))},_=j=>{const{action:B="click",iconRender:H=hEe}=e,K=pEe[B]||"",J=H(c),q={[K]:g,className:`${j}-icon`,key:"passwordIcon",onMouseDown:Q=>{Q.preventDefault()},onMouseUp:Q=>{Q.preventDefault()}};return b.cloneElement(b.isValidElement(J)?J:b.createElement("span",null,J),q)},{className:S,prefixCls:T,inputPrefixCls:R,size:N}=e,O=dEe(e,["className","prefixCls","inputPrefixCls","size"]),{getPrefixCls:A}=b.useContext(nr),M=A("input",R),x=A("input-password",T),P=o&&_(x),D=Ye(x,S,{[`${x}-${N}`]:!!N}),F=Object.assign(Object.assign({},Ea(O,["suffix","iconRender","visibilityToggle"])),{type:c?"text":"password",className:D,prefixCls:M,suffix:P});return N&&(F.size=N),b.createElement(ux,Object.assign({ref:Uc(n,p)},F))}),mEe=fEe;var gEe=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const vEe=b.forwardRef((e,n)=>{const{prefixCls:o,inputPrefixCls:s,className:c,size:d,suffix:p,enterButton:m=!1,addonAfter:g,loading:_,disabled:S,onSearch:T,onChange:R,onCompositionStart:N,onCompositionEnd:O}=e,A=gEe(e,["prefixCls","inputPrefixCls","className","size","suffix","enterButton","addonAfter","loading","disabled","onSearch","onChange","onCompositionStart","onCompositionEnd"]),{getPrefixCls:M,direction:x}=b.useContext(nr),P=b.useRef(!1),D=M("input-search",o),F=M("input",s),{compactSize:j}=zO(D,x),B=af(ve=>{var le;return(le=d??j)!==null&&le!==void 0?le:ve}),H=b.useRef(null),K=ve=>{ve&&ve.target&&ve.type==="click"&&T&&T(ve.target.value,ve),R&&R(ve)},J=ve=>{var le;document.activeElement===((le=H.current)===null||le===void 0?void 0:le.input)&&ve.preventDefault()},q=ve=>{var le,de;T&&T((de=(le=H.current)===null||le===void 0?void 0:le.input)===null||de===void 0?void 0:de.value,ve)},Q=ve=>{P.current||_||q(ve)},ee=typeof m=="boolean"?b.createElement(W0e,null):null,ne=`${D}-button`;let he;const pe=m||{},ce=pe.type&&pe.type.__ANT_BUTTON===!0;ce||pe.type==="button"?he=tc(pe,Object.assign({onMouseDown:J,onClick:ve=>{var le,de;(de=(le=pe==null?void 0:pe.props)===null||le===void 0?void 0:le.onClick)===null||de===void 0||de.call(le,ve),q(ve)},key:"enterButton"},ce?{className:ne,size:B}:{})):he=b.createElement(Oi,{className:ne,type:m?"primary":void 0,size:B,disabled:S,key:"enterButton",onMouseDown:J,onClick:q,loading:_,icon:ee},m),g&&(he=[he,tc(g,{key:"addonAfter"})]);const se=Ye(D,{[`${D}-rtl`]:x==="rtl",[`${D}-${B}`]:!!B,[`${D}-with-button`]:!!m},c),ae=ve=>{P.current=!0,N==null||N(ve)},Ee=ve=>{P.current=!1,O==null||O(ve)};return b.createElement(ux,Object.assign({ref:Uc(H,n),onPressEnter:Q},A,{size:B,onCompositionStart:ae,onCompositionEnd:Ee,prefixCls:F,addonAfter:he,suffix:p,onChange:K,className:se,disabled:S}))}),EEe=vEe;var _Ee=`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
  pointer-events: none !important;
`,yEe=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break","white-space"],b1={},fs;function SEe(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=e.getAttribute("id")||e.getAttribute("data-reactid")||e.getAttribute("name");if(n&&b1[o])return b1[o];var s=window.getComputedStyle(e),c=s.getPropertyValue("box-sizing")||s.getPropertyValue("-moz-box-sizing")||s.getPropertyValue("-webkit-box-sizing"),d=parseFloat(s.getPropertyValue("padding-bottom"))+parseFloat(s.getPropertyValue("padding-top")),p=parseFloat(s.getPropertyValue("border-bottom-width"))+parseFloat(s.getPropertyValue("border-top-width")),m=yEe.map(function(_){return"".concat(_,":").concat(s.getPropertyValue(_))}).join(";"),g={sizingStyle:m,paddingSize:d,borderSize:p,boxSizing:c};return n&&o&&(b1[o]=g),g}function CEe(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;fs||(fs=document.createElement("textarea"),fs.setAttribute("tab-index","-1"),fs.setAttribute("aria-hidden","true"),document.body.appendChild(fs)),e.getAttribute("wrap")?fs.setAttribute("wrap",e.getAttribute("wrap")):fs.removeAttribute("wrap");var c=SEe(e,n),d=c.paddingSize,p=c.borderSize,m=c.boxSizing,g=c.sizingStyle;fs.setAttribute("style","".concat(g,";").concat(_Ee)),fs.value=e.value||e.placeholder||"";var _=void 0,S=void 0,T,R=fs.scrollHeight;if(m==="border-box"?R+=p:m==="content-box"&&(R-=d),o!==null||s!==null){fs.value=" ";var N=fs.scrollHeight-d;o!==null&&(_=N*o,m==="border-box"&&(_=_+d+p),R=Math.max(_,R)),s!==null&&(S=N*s,m==="border-box"&&(S=S+d+p),T=R>S?"":"hidden",R=Math.min(S,R))}var O={height:R,overflowY:T,resize:"none"};return _&&(O.minHeight=_),S&&(O.maxHeight=S),O}var bEe=["prefixCls","onPressEnter","defaultValue","value","autoSize","onResize","className","style","disabled","onChange","onInternalAutoSize"],T1=0,R1=1,w1=2,TEe=b.forwardRef(function(e,n){var o=e,s=o.prefixCls;o.onPressEnter;var c=o.defaultValue,d=o.value,p=o.autoSize,m=o.onResize,g=o.className,_=o.style,S=o.disabled,T=o.onChange;o.onInternalAutoSize;var R=xn(o,bEe),N=cl(c,{value:d,postState:function(fe){return fe??""}}),O=We(N,2),A=O[0],M=O[1],x=function(fe){M(fe.target.value),T==null||T(fe)},P=b.useRef();b.useImperativeHandle(n,function(){return{textArea:P.current}});var D=b.useMemo(function(){return p&&jn(p)==="object"?[p.minRows,p.maxRows]:[]},[p]),F=We(D,2),j=F[0],B=F[1],H=!!p,K=function(){try{if(document.activeElement===P.current){var fe=P.current,ke=fe.selectionStart,Me=fe.selectionEnd,Ve=fe.scrollTop;P.current.setSelectionRange(ke,Me),P.current.scrollTop=Ve}}catch{}},J=b.useState(w1),q=We(J,2),Q=q[0],ee=q[1],ne=b.useState(),he=We(ne,2),pe=he[0],ce=he[1],se=function(){ee(T1)};qr(function(){H&&se()},[d,j,B,H]),qr(function(){if(Q===T1)ee(R1);else if(Q===R1){var ye=CEe(P.current,!1,j,B);ee(w1),ce(ye)}else K()},[Q]);var ae=b.useRef(),Ee=function(){ao.cancel(ae.current)},ve=function(fe){Q===w1&&(m==null||m(fe),p&&(Ee(),ae.current=ao(function(){se()})))};b.useEffect(function(){return Ee},[]);var le=H?pe:null,de=Ae(Ae({},_),le);return(Q===T1||Q===R1)&&(de.overflowY="hidden",de.overflowX="hidden"),b.createElement(Gd,{onResize:ve,disabled:!(p||m)},b.createElement("textarea",Qe({},R,{ref:P,style:de,className:Ye(s,g,st({},"".concat(s,"-disabled"),S)),disabled:S,value:A,onChange:x})))}),REe=["defaultValue","value","onFocus","onBlur","onChange","allowClear","maxLength","onCompositionStart","onCompositionEnd","suffix","prefixCls","classes","showCount","className","style","disabled","hidden","classNames","styles","onResize"];function u9(e,n){return ot(e||"").slice(0,n).join("")}function H5(e,n,o,s){var c=o;return e?c=u9(o,s):ot(n||"").length<o.length&&ot(o||"").length>s&&(c=n),c}var wEe=Et.forwardRef(function(e,n){var o,s=e.defaultValue,c=e.value,d=e.onFocus,p=e.onBlur,m=e.onChange,g=e.allowClear,_=e.maxLength,S=e.onCompositionStart,T=e.onCompositionEnd,R=e.suffix,N=e.prefixCls,O=N===void 0?"rc-textarea":N,A=e.classes,M=e.showCount,x=e.className,P=e.style,D=e.disabled,F=e.hidden,j=e.classNames,B=e.styles,H=e.onResize,K=xn(e,REe),J=cl(s,{value:c,defaultValue:s}),q=We(J,2),Q=q[0],ee=q[1],ne=b.useRef(null),he=Et.useState(!1),pe=We(he,2),ce=pe[0],se=pe[1],ae=Et.useState(!1),Ee=We(ae,2),ve=Ee[0],le=Ee[1],de=Et.useRef(),ye=Et.useRef(0),fe=Et.useState(null),ke=We(fe,2),Me=ke[0],Ve=ke[1],je=function(){ne.current.textArea.focus()};b.useImperativeHandle(n,function(){return{resizableTextArea:ne.current,focus:je,blur:function(){ne.current.textArea.blur()}}}),b.useEffect(function(){se(function(Ot){return!D&&Ot})},[D]);var dt=Number(_)>0,ut=function(Ht){le(!0),de.current=Q,ye.current=Ht.currentTarget.selectionStart,S==null||S(Ht)},Ct=function(Ht){le(!1);var hn=Ht.currentTarget.value;if(dt){var Lt,br=ye.current>=_+1||ye.current===((Lt=de.current)===null||Lt===void 0?void 0:Lt.length);hn=H5(br,de.current,hn,_)}hn!==Q&&(ee(hn),cm(Ht.currentTarget,Ht,m,hn)),T==null||T(Ht)},_t=function(Ht){var hn=Ht.target.value;if(!ve&&dt){var Lt=Ht.target.selectionStart>=_+1||Ht.target.selectionStart===hn.length||!Ht.target.selectionStart;hn=H5(Lt,Q,hn,_)}ee(hn),cm(Ht.currentTarget,Ht,m,hn)},Tt=function(Ht){var hn=K.onPressEnter,Lt=K.onKeyDown;Ht.key==="Enter"&&hn&&hn(Ht),Lt==null||Lt(Ht)},it=function(Ht){se(!0),d==null||d(Ht)},kt=function(Ht){se(!1),p==null||p(Ht)},qt=function(Ht){ee(""),je(),cm(ne.current.textArea,Ht,m)},xt=EA(Q);!ve&&dt&&c==null&&(xt=u9(xt,_));var ze=R,ct;if(M){var et=ot(xt).length;jn(M)==="object"?ct=M.formatter({value:xt,count:et,maxLength:_}):ct="".concat(et).concat(dt?" / ".concat(_):""),ze=Et.createElement(Et.Fragment,null,ze,Et.createElement("span",{className:Ye("".concat(O,"-data-count"),j==null?void 0:j.count),style:B==null?void 0:B.count},ct))}var tt=function(Ht){H==null||H(Ht),Me===null?Ve("mounted"):Me==="mounted"&&Ve("resized")},mt=Et.createElement(a9,{value:xt,allowClear:g,handleReset:qt,suffix:ze,prefixCls:O,classes:{affixWrapper:Ye(A==null?void 0:A.affixWrapper,(o={},st(o,"".concat(O,"-show-count"),M),st(o,"".concat(O,"-textarea-allow-clear"),g),o))},disabled:D,focused:ce,className:x,style:Ae(Ae({},P),Me==="resized"?{height:"auto"}:{}),dataAttrs:{affixWrapper:{"data-count":typeof ct=="string"?ct:void 0}},hidden:F,inputElement:Et.createElement(TEe,Qe({},K,{onKeyDown:Tt,onChange:_t,onFocus:it,onBlur:kt,onCompositionStart:ut,onCompositionEnd:Ct,className:j==null?void 0:j.textarea,style:Ae(Ae({},B==null?void 0:B.textarea),{},{resize:P==null?void 0:P.resize}),disabled:D,prefixCls:O,onResize:tt,ref:ne}))});return mt}),IEe=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const AEe=b.forwardRef((e,n)=>{var{prefixCls:o,bordered:s=!0,size:c,disabled:d,status:p,allowClear:m,showCount:g,classNames:_}=e,S=IEe(e,["prefixCls","bordered","size","disabled","status","allowClear","showCount","classNames"]);const{getPrefixCls:T,direction:R}=b.useContext(nr),N=af(c),O=b.useContext(qm),A=d??O,{status:M,hasFeedback:x,feedbackIcon:P}=b.useContext(El),D=C7(M,p),F=b.useRef(null);b.useImperativeHandle(n,()=>{var J;return{resizableTextArea:(J=F.current)===null||J===void 0?void 0:J.resizableTextArea,focus:q=>{var Q,ee;Kve((ee=(Q=F.current)===null||Q===void 0?void 0:Q.resizableTextArea)===null||ee===void 0?void 0:ee.textArea,q)},blur:()=>{var q;return(q=F.current)===null||q===void 0?void 0:q.blur()}}});const j=T("input",o);let B;typeof m=="object"&&(m!=null&&m.clearIcon)?B=m:m&&(B={clearIcon:b.createElement(fS,null)});const[H,K]=lx(j);return H(b.createElement(wEe,Object.assign({},S,{disabled:A,allowClear:B,classes:{affixWrapper:Ye(`${j}-textarea-affix-wrapper`,{[`${j}-affix-wrapper-rtl`]:R==="rtl",[`${j}-affix-wrapper-borderless`]:!s,[`${j}-affix-wrapper-sm`]:N==="small",[`${j}-affix-wrapper-lg`]:N==="large",[`${j}-textarea-show-count`]:g},sm(`${j}-affix-wrapper`,D),K)},classNames:Object.assign(Object.assign({},_),{textarea:Ye({[`${j}-borderless`]:!s,[`${j}-sm`]:N==="small",[`${j}-lg`]:N==="large"},sm(j,D),K,_==null?void 0:_.textarea)}),prefixCls:j,suffix:x&&b.createElement("span",{className:`${j}-textarea-suffix`},P),showCount:g,ref:F})))}),d9=AEe,ng=ux;ng.Group=Vve;ng.Search=EEe;ng.TextArea=d9;ng.Password=mEe;const OEe=ng;function my(e){const[n,o]=b.useState(e);return b.useEffect(()=>{const s=setTimeout(()=>{o(e)},e.length?0:10);return()=>{clearTimeout(s)}},[e]),n}const xEe=e=>{const{componentCls:n}=e,o=`${n}-show-help`,s=`${n}-show-help-item`;return{[o]:{transition:`opacity ${e.motionDurationSlow} ${e.motionEaseInOut}`,"&-appear, &-enter":{opacity:0,"&-active":{opacity:1}},"&-leave":{opacity:1,"&-active":{opacity:0}},[s]:{overflow:"hidden",transition:`height ${e.motionDurationSlow} ${e.motionEaseInOut},
                     opacity ${e.motionDurationSlow} ${e.motionEaseInOut},
                     transform ${e.motionDurationSlow} ${e.motionEaseInOut} !important`,[`&${s}-appear, &${s}-enter`]:{transform:"translateY(-5px)",opacity:0,"&-active":{transform:"translateY(0)",opacity:1}},[`&${s}-leave-active`]:{transform:"translateY(-5px)"}}}}},NEe=xEe,PEe=e=>({legend:{display:"block",width:"100%",marginBottom:e.marginLG,padding:0,color:e.colorTextDescription,fontSize:e.fontSizeLG,lineHeight:"inherit",border:0,borderBottom:`${e.lineWidth}px ${e.lineType} ${e.colorBorder}`},label:{fontSize:e.fontSize},'input[type="search"]':{boxSizing:"border-box"},'input[type="radio"], input[type="checkbox"]':{lineHeight:"normal"},'input[type="file"]':{display:"block"},'input[type="range"]':{display:"block",width:"100%"},"select[multiple], select[size]":{height:"auto"},"input[type='file']:focus,\n  input[type='radio']:focus,\n  input[type='checkbox']:focus":{outline:0,boxShadow:`0 0 0 ${e.controlOutlineWidth}px ${e.controlOutline}`},output:{display:"block",paddingTop:15,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight}}),W5=(e,n)=>{const{formItemCls:o}=e;return{[o]:{[`${o}-label > label`]:{height:n},[`${o}-control-input`]:{minHeight:n}}}},DEe=e=>{const{componentCls:n}=e;return{[e.componentCls]:Object.assign(Object.assign(Object.assign({},Kd(e)),PEe(e)),{[`${n}-text`]:{display:"inline-block",paddingInlineEnd:e.paddingSM},"&-small":Object.assign({},W5(e,e.controlHeightSM)),"&-large":Object.assign({},W5(e,e.controlHeightLG))})}},kEe=e=>{const{formItemCls:n,iconCls:o,componentCls:s,rootPrefixCls:c}=e;return{[n]:Object.assign(Object.assign({},Kd(e)),{marginBottom:e.marginLG,verticalAlign:"top","&-with-help":{transition:"none"},[`&-hidden,
        &-hidden.${c}-row`]:{display:"none"},"&-has-warning":{[`${n}-split`]:{color:e.colorError}},"&-has-error":{[`${n}-split`]:{color:e.colorWarning}},[`${n}-label`]:{display:"inline-block",flexGrow:0,overflow:"hidden",whiteSpace:"nowrap",textAlign:"end",verticalAlign:"middle","&-left":{textAlign:"start"},"&-wrap":{overflow:"unset",lineHeight:`${e.lineHeight} - 0.25em`,whiteSpace:"unset"},"> label":{position:"relative",display:"inline-flex",alignItems:"center",maxWidth:"100%",height:e.controlHeight,color:e.colorTextHeading,fontSize:e.fontSize,[`> ${o}`]:{fontSize:e.fontSize,verticalAlign:"top"},[`&${n}-required:not(${n}-required-mark-optional)::before`]:{display:"inline-block",marginInlineEnd:e.marginXXS,color:e.colorError,fontSize:e.fontSize,fontFamily:"SimSun, sans-serif",lineHeight:1,content:'"*"',[`${s}-hide-required-mark &`]:{display:"none"}},[`${n}-optional`]:{display:"inline-block",marginInlineStart:e.marginXXS,color:e.colorTextDescription,[`${s}-hide-required-mark &`]:{display:"none"}},[`${n}-tooltip`]:{color:e.colorTextDescription,cursor:"help",writingMode:"horizontal-tb",marginInlineStart:e.marginXXS},"&::after":{content:'":"',position:"relative",marginBlock:0,marginInlineStart:e.marginXXS/2,marginInlineEnd:e.marginXS},[`&${n}-no-colon::after`]:{content:'" "'}}},[`${n}-control`]:{display:"flex",flexDirection:"column",flexGrow:1,[`&:first-child:not([class^="'${c}-col-'"]):not([class*="' ${c}-col-'"])`]:{width:"100%"},"&-input":{position:"relative",display:"flex",alignItems:"center",minHeight:e.controlHeight,"&-content":{flex:"auto",maxWidth:"100%"}}},[n]:{"&-explain, &-extra":{clear:"both",color:e.colorTextDescription,fontSize:e.fontSize,lineHeight:e.lineHeight},"&-explain-connected":{width:"100%"},"&-extra":{minHeight:e.controlHeightSM,transition:`color ${e.motionDurationMid} ${e.motionEaseOut}`},"&-explain":{"&-error":{color:e.colorError},"&-warning":{color:e.colorWarning}}},[`&-with-help ${n}-explain`]:{height:"auto",opacity:1},[`${n}-feedback-icon`]:{fontSize:e.fontSize,textAlign:"center",visibility:"visible",animationName:ZO,animationDuration:e.motionDurationMid,animationTimingFunction:e.motionEaseOutBack,pointerEvents:"none","&-success":{color:e.colorSuccess},"&-error":{color:e.colorError},"&-warning":{color:e.colorWarning},"&-validating":{color:e.colorPrimary}}})}},LEe=e=>{const{componentCls:n,formItemCls:o,rootPrefixCls:s}=e;return{[`${n}-horizontal`]:{[`${o}-label`]:{flexGrow:0},[`${o}-control`]:{flex:"1 1 0",minWidth:0},[`${o}-label.${s}-col-24 + ${o}-control`]:{minWidth:"unset"}}}},MEe=e=>{const{componentCls:n,formItemCls:o}=e;return{[`${n}-inline`]:{display:"flex",flexWrap:"wrap",[o]:{flex:"none",marginInlineEnd:e.margin,marginBottom:0,"&-row":{flexWrap:"nowrap"},"&-with-help":{marginBottom:e.marginLG},[`> ${o}-label,
        > ${o}-control`]:{display:"inline-block",verticalAlign:"top"},[`> ${o}-label`]:{flex:"none"},[`${n}-text`]:{display:"inline-block"},[`${o}-has-feedback`]:{display:"inline-block"}}}}},fp=e=>({padding:`0 0 ${e.paddingXS}px`,whiteSpace:"initial",textAlign:"start","> label":{margin:0,"&::after":{display:"none"}}}),FEe=e=>{const{componentCls:n,formItemCls:o}=e;return{[`${o} ${o}-label`]:fp(e),[n]:{[o]:{flexWrap:"wrap",[`${o}-label,
          ${o}-control`]:{flex:"0 0 100%",maxWidth:"100%"}}}}},UEe=e=>{const{componentCls:n,formItemCls:o,rootPrefixCls:s}=e;return{[`${n}-vertical`]:{[o]:{"&-row":{flexDirection:"column"},"&-label > label":{height:"auto"},[`${n}-item-control`]:{width:"100%"}}},[`${n}-vertical ${o}-label,
      .${s}-col-24${o}-label,
      .${s}-col-xl-24${o}-label`]:fp(e),[`@media (max-width: ${e.screenXSMax}px)`]:[FEe(e),{[n]:{[`.${s}-col-xs-24${o}-label`]:fp(e)}}],[`@media (max-width: ${e.screenSMMax}px)`]:{[n]:{[`.${s}-col-sm-24${o}-label`]:fp(e)}},[`@media (max-width: ${e.screenMDMax}px)`]:{[n]:{[`.${s}-col-md-24${o}-label`]:fp(e)}},[`@media (max-width: ${e.screenLGMax}px)`]:{[n]:{[`.${s}-col-lg-24${o}-label`]:fp(e)}}}},dx=ic("Form",(e,n)=>{let{rootPrefixCls:o}=n;const s=lo(e,{formItemCls:`${e.componentCls}-item`,rootPrefixCls:o});return[DEe(s),kEe(s),NEe(s),LEe(s),MEe(s),UEe(s),h7(s),ZO]}),z5=[];function I1(e,n,o){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{key:typeof e=="string"?e:`${n}-${s}`,error:e,errorStatus:o}}function h9(e){let{help:n,helpStatus:o,errors:s=z5,warnings:c=z5,className:d,fieldId:p,onVisibleChanged:m}=e;const{prefixCls:g}=b.useContext(QO),_=`${g}-item-explain`,[,S]=dx(g),T=b.useMemo(()=>XI(g),[g]),R=my(s),N=my(c),O=b.useMemo(()=>n!=null?[I1(n,"help",o)]:[].concat(ot(R.map((M,x)=>I1(M,"error","error",x))),ot(N.map((M,x)=>I1(M,"warning","warning",x)))),[n,o,R,N]),A={};return p&&(A.id=`${p}_help`),b.createElement(qd,{motionDeadline:T.motionDeadline,motionName:`${g}-show-help`,visible:!!O.length,onVisibleChanged:m},M=>{const{className:x,style:P}=M;return b.createElement("div",Object.assign({},A,{className:Ye(_,x,d,S),style:P,role:"alert"}),b.createElement(QV,Object.assign({keys:O},XI(g),{motionName:`${g}-show-help-item`,component:!1}),D=>{const{key:F,error:j,errorStatus:B,className:H,style:K}=D;return b.createElement("div",{key:F,className:Ye(H,{[`${_}-${B}`]:B}),style:K},j)}))})}const BEe=["parentNode"],jEe="form_item";function lm(e){return e===void 0||e===!1?[]:Array.isArray(e)?e:[e]}function p9(e,n){if(!e.length)return;const o=e.join("_");return n?`${n}_${o}`:BEe.includes(o)?`${jEe}_${o}`:o}function G5(e){return lm(e).join("_")}function f9(e){const[n]=JO(),o=b.useRef({}),s=b.useMemo(()=>e??Object.assign(Object.assign({},n),{__INTERNAL__:{itemRef:c=>d=>{const p=G5(c);d?o.current[p]=d:delete o.current[p]}},scrollToField:function(c){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const p=lm(c),m=p9(p,s.__INTERNAL__.name),g=m?document.getElementById(m):null;g&&ohe(g,Object.assign({scrollMode:"if-needed",block:"nearest"},d))},getFieldInstance:c=>{const d=G5(c);return o.current[d]}}),[e,n]);return[s]}var VEe=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const $Ee=(e,n)=>{const o=b.useContext(qm),{getPrefixCls:s,direction:c,form:d}=b.useContext(nr),{prefixCls:p,className:m,rootClassName:g,size:_,disabled:S=o,form:T,colon:R,labelAlign:N,labelWrap:O,labelCol:A,wrapperCol:M,hideRequiredMark:x,layout:P="horizontal",scrollToFirstError:D,requiredMark:F,onFinishFailed:j,name:B}=e,H=VEe(e,["prefixCls","className","rootClassName","size","disabled","form","colon","labelAlign","labelWrap","labelCol","wrapperCol","hideRequiredMark","layout","scrollToFirstError","requiredMark","onFinishFailed","name"]),K=af(_),J=b.useContext(TV),q=b.useMemo(()=>F!==void 0?F:d&&d.requiredMark!==void 0?d.requiredMark:!x,[x,F,d]),Q=R??(d==null?void 0:d.colon),ee=s("form",p),[ne,he]=dx(ee),pe=Ye(ee,{[`${ee}-${P}`]:!0,[`${ee}-hide-required-mark`]:q===!1,[`${ee}-rtl`]:c==="rtl",[`${ee}-${K}`]:K},he,m,g),[ce]=f9(T),{__INTERNAL__:se}=ce;se.name=B;const ae=b.useMemo(()=>({name:B,labelAlign:N,labelCol:A,labelWrap:O,wrapperCol:M,vertical:P==="vertical",colon:Q,requiredMark:q,itemRef:se.itemRef,form:ce}),[B,N,A,M,P,Q,q,ce]);b.useImperativeHandle(n,()=>ce);const Ee=(le,de)=>{if(le){let ye={block:"nearest"};typeof le=="object"&&(ye=le),ce.scrollToField(de,ye)}},ve=le=>{if(j==null||j(le),le.errorFields.length){const de=le.errorFields[0].name;if(D!==void 0){Ee(D,de);return}d&&d.scrollToFirstError!==void 0&&Ee(d.scrollToFirstError,de)}};return ne(b.createElement(BV,{disabled:S},b.createElement(VV,{size:K},b.createElement(l7,{validateMessages:J},b.createElement(Ou.Provider,{value:ae},b.createElement(lf,Object.assign({id:B},H,{name:B,onFinishFailed:ve,form:ce,className:pe})))))))},HEe=b.forwardRef($Ee),WEe=HEe,m9=()=>{const{status:e,errors:n=[],warnings:o=[]}=b.useContext(El);return{status:e,errors:n,warnings:o}};m9.Context=El;const zEe=m9;function GEe(e){const[n,o]=b.useState(e),s=b.useRef(null),c=b.useRef([]),d=b.useRef(!1);b.useEffect(()=>(d.current=!1,()=>{d.current=!0,ao.cancel(s.current),s.current=null}),[]);function p(m){d.current||(s.current===null&&(c.current=[],s.current=ao(()=>{s.current=null,o(g=>{let _=g;return c.current.forEach(S=>{_=S(_)}),_})})),c.current.push(m))}return[n,p]}function KEe(){const{itemRef:e}=b.useContext(Ou),n=b.useRef({});function o(s,c){const d=c&&typeof c=="object"&&c.ref,p=s.join("_");return(n.current.name!==p||n.current.originRef!==d)&&(n.current.name=p,n.current.originRef=d,n.current.ref=Uc(e(s),d)),n.current.ref}return o}const qEe=e=>{const{prefixCls:n,status:o,wrapperCol:s,children:c,errors:d,warnings:p,_internalItemRender:m,extra:g,help:_,fieldId:S,marginBottom:T,onErrorVisibleChanged:R}=e,N=`${n}-item`,O=b.useContext(Ou),A=s||O.wrapperCol||{},M=Ye(`${N}-control`,A.className),x=b.useMemo(()=>Object.assign({},O),[O]);delete x.labelCol,delete x.wrapperCol;const P=b.createElement("div",{className:`${N}-control-input`},b.createElement("div",{className:`${N}-control-input-content`},c)),D=b.useMemo(()=>({prefixCls:n,status:o}),[n,o]),F=T!==null||d.length||p.length?b.createElement("div",{style:{display:"flex",flexWrap:"nowrap"}},b.createElement(QO.Provider,{value:D},b.createElement(h9,{fieldId:S,errors:d,warnings:p,help:_,helpStatus:o,className:`${N}-explain-connected`,onVisibleChanged:R})),!!T&&b.createElement("div",{style:{width:0,height:T}})):null,j={};S&&(j.id=`${S}_extra`);const B=g?b.createElement("div",Object.assign({},j,{className:`${N}-extra`}),g):null,H=m&&m.mark==="pro_table_render"&&m.render?m.render(e,{input:P,errorList:F,extra:B}):b.createElement(b.Fragment,null,P,F,B);return b.createElement(Ou.Provider,{value:x},b.createElement(o9,Object.assign({},A,{className:M}),H))},YEe=qEe;var g9={};Object.defineProperty(g9,"__esModule",{value:!0});var XEe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"question-circle",theme:"outlined"},JEe=g9.default=XEe;function QEe(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function ZEe(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){QEe(e,c,o[c])})}return e}function e_e(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function t_e(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e_e(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var n_e=function(e,n){return b.createElement(qi,t_e(ZEe({},e),{ref:n,icon:JEe}))};const r_e=b.forwardRef(n_e);var i_e=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function o_e(e){return e?typeof e=="object"&&!b.isValidElement(e)?e:{title:e}:null}const a_e=e=>{let{prefixCls:n,label:o,htmlFor:s,labelCol:c,labelAlign:d,colon:p,required:m,requiredMark:g,tooltip:_}=e;var S;const[T]=wV("Form"),{vertical:R,labelAlign:N,labelCol:O,labelWrap:A,colon:M}=b.useContext(Ou);if(!o)return null;const x=c||O||{},P=d||N,D=`${n}-item-label`,F=Ye(D,P==="left"&&`${D}-left`,x.className,{[`${D}-wrap`]:!!A});let j=o;const B=p===!0||M!==!1&&p!==!1;B&&!R&&typeof o=="string"&&o.trim()!==""&&(j=o.replace(/[:|]\s*$/,""));const K=o_e(_);if(K){const{icon:q=b.createElement(r_e,null)}=K,Q=i_e(K,["icon"]),ee=b.createElement(Mm,Object.assign({},Q),b.cloneElement(q,{className:`${n}-item-tooltip`,title:""}));j=b.createElement(b.Fragment,null,j,ee)}g==="optional"&&!m&&(j=b.createElement(b.Fragment,null,j,b.createElement("span",{className:`${n}-item-optional`,title:""},(T==null?void 0:T.optional)||((S=Kp.Form)===null||S===void 0?void 0:S.optional))));const J=Ye({[`${n}-item-required`]:m,[`${n}-item-required-mark-optional`]:g==="optional",[`${n}-item-no-colon`]:!B});return b.createElement(o9,Object.assign({},x,{className:F}),b.createElement("label",{htmlFor:s,className:J,title:typeof o=="string"?o:""},j))},s_e=a_e;var c_e=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const l_e={success:L$,warning:B$,error:fS,validating:W$};function u_e(e){const{prefixCls:n,className:o,rootClassName:s,style:c,help:d,errors:p,warnings:m,validateStatus:g,meta:_,hasFeedback:S,hidden:T,children:R,fieldId:N,required:O,isRequired:A,onSubItemMetaChange:M}=e,x=c_e(e,["prefixCls","className","rootClassName","style","help","errors","warnings","validateStatus","meta","hasFeedback","hidden","children","fieldId","required","isRequired","onSubItemMetaChange"]),P=`${n}-item`,{requiredMark:D}=b.useContext(Ou),F=b.useRef(null),j=my(p),B=my(m),H=d!=null,K=!!(H||p.length||m.length),J=!!F.current&&gS(F.current),[q,Q]=b.useState(null);qr(()=>{if(K&&F.current){const se=getComputedStyle(F.current);Q(parseInt(se.marginBottom,10))}},[K,J]);const ee=se=>{se||Q(null)},he=function(){let se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,ae="";const Ee=se?j:_.errors,ve=se?B:_.warnings;return g!==void 0?ae=g:_.validating?ae="validating":Ee.length?ae="error":ve.length?ae="warning":(_.touched||S&&_.validated)&&(ae="success"),ae}(),pe=b.useMemo(()=>{let se;if(S){const ae=he&&l_e[he];se=ae?b.createElement("span",{className:Ye(`${P}-feedback-icon`,`${P}-feedback-icon-${he}`)},b.createElement(ae,null)):null}return{status:he,errors:p,warnings:m,hasFeedback:S,feedbackIcon:se,isFormItemInput:!0}},[he,S]),ce=Ye(P,o,s,{[`${P}-with-help`]:H||j.length||B.length,[`${P}-has-feedback`]:he&&S,[`${P}-has-success`]:he==="success",[`${P}-has-warning`]:he==="warning",[`${P}-has-error`]:he==="error",[`${P}-is-validating`]:he==="validating",[`${P}-hidden`]:T});return b.createElement("div",{className:ce,style:c,ref:F},b.createElement(Bve,Object.assign({className:`${P}-row`},Ea(x,["_internalItemRender","colon","dependencies","extra","fieldKey","getValueFromEvent","getValueProps","htmlFor","id","initialValue","isListField","label","labelAlign","labelCol","labelWrap","messageVariables","name","normalize","noStyle","preserve","requiredMark","rules","shouldUpdate","trigger","tooltip","validateFirst","validateTrigger","valuePropName","wrapperCol"])),b.createElement(s_e,Object.assign({htmlFor:N},e,{requiredMark:D,required:O??A,prefixCls:n})),b.createElement(YEe,Object.assign({},e,_,{errors:j,warnings:B,prefixCls:n,status:he,help:d,marginBottom:q,onErrorVisibleChanged:ee}),b.createElement(c7.Provider,{value:M},b.createElement(El.Provider,{value:pe},R)))),!!q&&b.createElement("div",{className:`${P}-margin-offset`,style:{marginBottom:-q}}))}function d_e(e){if(typeof e=="function")return e;const n=ml(e);return n.length<=1?n[0]:n}const h_e="__SPLIT__",p_e=b.memo(e=>{let{children:n}=e;return n},(e,n)=>e.value===n.value&&e.update===n.update&&e.childProps.length===n.childProps.length&&e.childProps.every((o,s)=>o===n.childProps[s]));function f_e(e){return e!=null}function K5(){return{errors:[],warnings:[],touched:!1,validating:!1,name:[],validated:!1}}function m_e(e){const{name:n,noStyle:o,className:s,dependencies:c,prefixCls:d,shouldUpdate:p,rules:m,children:g,required:_,label:S,messageVariables:T,trigger:R="onChange",validateTrigger:N,hidden:O,help:A}=e,{getPrefixCls:M}=b.useContext(nr),{name:x}=b.useContext(Ou),P=d_e(g),D=typeof P=="function",F=b.useContext(c7),{validateTrigger:j}=b.useContext($d),B=N!==void 0?N:j,H=f_e(n),K=M("form",d),[J,q]=dx(K),Q=b.useContext(Pm),ee=b.useRef(),[ne,he]=GEe({}),[pe,ce]=Ld(()=>K5()),se=fe=>{const ke=Q==null?void 0:Q.getKey(fe.name);if(ce(fe.destroy?K5():fe,!0),o&&A!==!1&&F){let Me=fe.name;if(fe.destroy)Me=ee.current||Me;else if(ke!==void 0){const[Ve,je]=ke;Me=[Ve].concat(ot(je)),ee.current=Me}F(fe,Me)}},ae=(fe,ke)=>{he(Me=>{const Ve=Object.assign({},Me),dt=[].concat(ot(fe.name.slice(0,-1)),ot(ke)).join(h_e);return fe.destroy?delete Ve[dt]:Ve[dt]=fe,Ve})},[Ee,ve]=b.useMemo(()=>{const fe=ot(pe.errors),ke=ot(pe.warnings);return Object.values(ne).forEach(Me=>{fe.push.apply(fe,ot(Me.errors||[])),ke.push.apply(ke,ot(Me.warnings||[]))}),[fe,ke]},[ne,pe.errors,pe.warnings]),le=KEe();function de(fe,ke,Me){return o&&!O?fe:b.createElement(u_e,Object.assign({key:"row"},e,{className:Ye(s,q),prefixCls:K,fieldId:ke,isRequired:Me,errors:Ee,warnings:ve,meta:pe,onSubItemMetaChange:ae}),fe)}if(!H&&!D&&!c)return J(de(P));let ye={};return typeof S=="string"?ye.label=S:n&&(ye.label=String(n)),T&&(ye=Object.assign(Object.assign({},ye),T)),J(b.createElement(XO,Object.assign({},e,{messageVariables:ye,trigger:R,validateTrigger:B,onMetaChange:se}),(fe,ke,Me)=>{const Ve=lm(n).length&&ke?ke.name:[],je=p9(Ve,x),dt=_!==void 0?_:!!(m&&m.some(_t=>{if(_t&&typeof _t=="object"&&_t.required&&!_t.warningOnly)return!0;if(typeof _t=="function"){const Tt=_t(Me);return Tt&&Tt.required&&!Tt.warningOnly}return!1})),ut=Object.assign({},fe);let Ct=null;if(Array.isArray(P)&&H)Ct=P;else if(!(D&&(!(p||c)||H))){if(!(c&&!D&&!H))if(Au(P)){const _t=Object.assign(Object.assign({},P.props),ut);if(_t.id||(_t.id=je),A||Ee.length>0||ve.length>0||e.extra){const kt=[];(A||Ee.length>0)&&kt.push(`${je}_help`),e.extra&&kt.push(`${je}_extra`),_t["aria-describedby"]=kt.join(" ")}Ee.length>0&&(_t["aria-invalid"]="true"),dt&&(_t["aria-required"]="true"),nf(P)&&(_t.ref=le(Ve,P)),new Set([].concat(ot(lm(R)),ot(lm(B)))).forEach(kt=>{_t[kt]=function(){for(var qt,xt,ze,ct,et,tt=arguments.length,mt=new Array(tt),Ot=0;Ot<tt;Ot++)mt[Ot]=arguments[Ot];(ze=ut[kt])===null||ze===void 0||(qt=ze).call.apply(qt,[ut].concat(mt)),(et=(ct=P.props)[kt])===null||et===void 0||(xt=et).call.apply(xt,[ct].concat(mt))}});const it=[_t["aria-required"],_t["aria-invalid"],_t["aria-describedby"]];Ct=b.createElement(p_e,{value:ut[e.valuePropName||"value"],update:P,childProps:it},tc(P,_t))}else D&&(p||c)&&!H?Ct=P(Me):Ct=P}return de(Ct,je,dt)}))}const v9=m_e;v9.useStatus=zEe;const g_e=v9;var v_e=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const E_e=e=>{var{prefixCls:n,children:o}=e,s=v_e(e,["prefixCls","children"]);const{getPrefixCls:c}=b.useContext(nr),d=c("form",n),p=b.useMemo(()=>({prefixCls:d,status:"error"}),[d]);return b.createElement(i7,Object.assign({},s),(m,g,_)=>b.createElement(QO.Provider,{value:p},o(m.map(S=>Object.assign(Object.assign({},S),{fieldKey:S.key})),g,{errors:_.errors,warnings:_.warnings})))},__e=E_e;function y_e(){const{form:e}=b.useContext(Ou);return e}const bl=WEe;bl.Item=g_e;bl.List=__e;bl.ErrorList=h9;bl.useForm=f9;bl.useFormInstance=y_e;bl.useWatch=s7;bl.Provider=l7;bl.create=()=>{};const q5=bl,rg=Yge;rg.Header=Gge;rg.Footer=Kge;rg.Content=qge;rg.Sider=Zge;const _A=rg;let Gs=null,y_=e=>e(),gy=[],vy={};function S_e(){const{prefixCls:e,getContainer:n,rtl:o,maxCount:s,top:c,bottom:d}=vy,p=e??t$().getPrefixCls("notification"),m=(n==null?void 0:n())||document.body;return{prefixCls:p,container:m,rtl:o,maxCount:s,top:c,bottom:d}}const C_e=b.forwardRef((e,n)=>{const[o,s]=b.useState(),[c,d]=b.useState(),[p,m]=b.useState(),[g,_]=b.useState(),[S,T]=b.useState(),[R,N]=b.useState(),[O,A]=g7({prefixCls:o,getContainer:()=>c,maxCount:p,rtl:g,top:S,bottom:R}),M=t$(),x=M.getRootPrefixCls(),P=M.getIconPrefixCls(),D=M.getTheme(),F=()=>{const{prefixCls:j,container:B,maxCount:H,rtl:K,top:J,bottom:q}=S_e();s(j),d(B),m(H),_(K),T(J),N(q)};return b.useEffect(F,[]),b.useImperativeHandle(n,()=>{const j=Object.assign({},O);return Object.keys(j).forEach(B=>{j[B]=function(){return F(),O[B].apply(O,arguments)}}),{instance:j,sync:F}}),b.createElement(sf,{prefixCls:x,iconPrefixCls:P,theme:D},A)});function hx(){if(!Gs){const e=document.createDocumentFragment(),n={fragment:e};Gs=n,y_(()=>{z$(b.createElement(C_e,{ref:o=>{const{instance:s,sync:c}=o||{};Promise.resolve().then(()=>{!n.instance&&s&&(n.instance=s,n.sync=c,hx())})}}),e)});return}Gs.instance&&(gy.forEach(e=>{switch(e.type){case"open":{y_(()=>{Gs.instance.open(Object.assign(Object.assign({},vy),e.config))});break}case"destroy":y_(()=>{Gs==null||Gs.instance.destroy(e.key)});break}}),gy=[])}function b_e(e){vy=Object.assign(Object.assign({},vy),e),y_(()=>{var n;(n=Gs==null?void 0:Gs.sync)===null||n===void 0||n.call(Gs)})}function E9(e){gy.push({type:"open",config:e}),hx()}function T_e(e){gy.push({type:"destroy",key:e}),hx()}const R_e=["success","info","warning","error"],w_e={open:E9,destroy:T_e,config:b_e,useNotification:n0e,_InternalPanelDoNotUseOrYouWillBeFired:Xfe},_9=w_e;R_e.forEach(e=>{_9[e]=n=>E9(Object.assign(Object.assign({},n),{type:e}))});const I_e=_9;var y9={};Object.defineProperty(y9,"__esModule",{value:!0});var A_e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"},O_e=y9.default=A_e;function x_e(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function N_e(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){x_e(e,c,o[c])})}return e}function P_e(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function D_e(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P_e(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var k_e=function(e,n){return b.createElement(qi,D_e(N_e({},e),{ref:n,icon:O_e}))};const L_e=b.forwardRef(k_e);var S9={};Object.defineProperty(S9,"__esModule",{value:!0});var M_e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"},F_e=S9.default=M_e;function U_e(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function B_e(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){U_e(e,c,o[c])})}return e}function j_e(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function V_e(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j_e(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var $_e=function(e,n){return b.createElement(qi,V_e(B_e({},e),{ref:n,icon:F_e}))};const H_e=b.forwardRef($_e);var C9={};Object.defineProperty(C9,"__esModule",{value:!0});var W_e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 170h-60c-4.4 0-8 3.6-8 8v518H310v-73c0-6.7-7.8-10.5-13-6.3l-141.9 112a8 8 0 000 12.6l141.9 112c5.3 4.2 13 .4 13-6.3v-75h498c35.3 0 64-28.7 64-64V178c0-4.4-3.6-8-8-8z"}}]},name:"enter",theme:"outlined"},z_e=C9.default=W_e;function G_e(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function K_e(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{},s=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(o).filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable}))),s.forEach(function(c){G_e(e,c,o[c])})}return e}function q_e(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),o.push.apply(o,s)}return o}function Y_e(e,n){return n=n??{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q_e(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}),e}var X_e=function(e,n){return b.createElement(qi,Y_e(K_e({},e),{ref:n,icon:z_e}))};const J_e=b.forwardRef(X_e);var Q_e=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const Z_e={border:0,background:"transparent",padding:0,lineHeight:"inherit",display:"inline-block"},eye=b.forwardRef((e,n)=>{const o=_=>{const{keyCode:S}=_;S===St.ENTER&&_.preventDefault()},s=_=>{const{keyCode:S}=_,{onClick:T}=e;S===St.ENTER&&T&&T()},{style:c,noStyle:d,disabled:p}=e,m=Q_e(e,["style","noStyle","disabled"]);let g={};return d||(g=Object.assign({},Z_e)),p&&(g.pointerEvents="none"),g=Object.assign(Object.assign({},g),c),b.createElement("div",Object.assign({role:"button",tabIndex:0,ref:n},m,{onKeyDown:o,onKeyUp:s,style:g}))}),Y5=eye;var tye=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var n=document.activeElement,o=[],s=0;s<e.rangeCount;s++)o.push(e.getRangeAt(s));switch(n.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":n.blur();break;default:n=null;break}return e.removeAllRanges(),function(){e.type==="Caret"&&e.removeAllRanges(),e.rangeCount||o.forEach(function(c){e.addRange(c)}),n&&n.focus()}},nye=tye,X5={"text/plain":"Text","text/html":"Url",default:"Text"},rye="Copy to clipboard: #{key}, Enter";function iye(e){var n=(/mac os x/i.test(navigator.userAgent)?"":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,n)}function oye(e,n){var o,s,c,d,p,m,g=!1;n||(n={}),o=n.debug||!1;try{c=nye(),d=document.createRange(),p=document.getSelection(),m=document.createElement("span"),m.textContent=e,m.ariaHidden="true",m.style.all="unset",m.style.position="fixed",m.style.top=0,m.style.clip="rect(0, 0, 0, 0)",m.style.whiteSpace="pre",m.style.webkitUserSelect="text",m.style.MozUserSelect="text",m.style.msUserSelect="text",m.style.userSelect="text",m.addEventListener("copy",function(S){if(S.stopPropagation(),n.format)if(S.preventDefault(),typeof S.clipboardData>"u"){o&&console.warn("unable to use e.clipboardData"),o&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var T=X5[n.format]||X5.default;window.clipboardData.setData(T,e)}else S.clipboardData.clearData(),S.clipboardData.setData(n.format,e);n.onCopy&&(S.preventDefault(),n.onCopy(S.clipboardData))}),document.body.appendChild(m),d.selectNodeContents(m),p.addRange(d);var _=document.execCommand("copy");if(!_)throw new Error("copy command was unsuccessful");g=!0}catch(S){o&&console.error("unable to copy using execCommand: ",S),o&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(n.format||"text",e),n.onCopy&&n.onCopy(window.clipboardData),g=!0}catch(T){o&&console.error("unable to copy using clipboardData: ",T),o&&console.error("falling back to prompt"),s=iye("message"in n?n.message:rye),window.prompt(s,e)}}finally{p&&(typeof p.removeRange=="function"?p.removeRange(d):p.removeAllRanges()),m&&document.body.removeChild(m),c()}return g}var aye=oye;const sye=yl(aye),cye=(e,n,o,s)=>{const{titleMarginBottom:c,fontWeightStrong:d}=s;return{marginBottom:c,color:o,fontWeight:d,fontSize:e,lineHeight:n}},lye=e=>{const n=[1,2,3,4,5],o={};return n.forEach(s=>{o[`
      h${s}&,
      div&-h${s},
      div&-h${s} > textarea,
      h${s}
    `]=cye(e[`fontSizeHeading${s}`],e[`lineHeightHeading${s}`],e.colorTextHeading,e)}),o},uye=e=>{const{componentCls:n}=e;return{"a&, a":Object.assign(Object.assign({},kV(e)),{textDecoration:e.linkDecoration,"&:active, &:hover":{textDecoration:e.linkHoverDecoration},[`&[disabled], &${n}-disabled`]:{color:e.colorTextDisabled,cursor:"not-allowed","&:active, &:hover":{color:e.colorTextDisabled},"&:active":{pointerEvents:"none"}}})}},dye=e=>({code:{margin:"0 0.2em",paddingInline:"0.4em",paddingBlock:"0.2em 0.1em",fontSize:"85%",fontFamily:e.fontFamilyCode,background:"rgba(150, 150, 150, 0.1)",border:"1px solid rgba(100, 100, 100, 0.2)",borderRadius:3},kbd:{margin:"0 0.2em",paddingInline:"0.4em",paddingBlock:"0.15em 0.1em",fontSize:"90%",fontFamily:e.fontFamilyCode,background:"rgba(150, 150, 150, 0.06)",border:"1px solid rgba(100, 100, 100, 0.2)",borderBottomWidth:2,borderRadius:3},mark:{padding:0,backgroundColor:Nce[2]},"u, ins":{textDecoration:"underline",textDecorationSkipInk:"auto"},"s, del":{textDecoration:"line-through"},strong:{fontWeight:600},"ul, ol":{marginInline:0,marginBlock:"0 1em",padding:0,li:{marginInline:"20px 0",marginBlock:0,paddingInline:"4px 0",paddingBlock:0}},ul:{listStyleType:"circle",ul:{listStyleType:"disc"}},ol:{listStyleType:"decimal"},"pre, blockquote":{margin:"1em 0"},pre:{padding:"0.4em 0.6em",whiteSpace:"pre-wrap",wordWrap:"break-word",background:"rgba(150, 150, 150, 0.1)",border:"1px solid rgba(100, 100, 100, 0.2)",borderRadius:3,fontFamily:e.fontFamilyCode,code:{display:"inline",margin:0,padding:0,fontSize:"inherit",fontFamily:"inherit",background:"transparent",border:0}},blockquote:{paddingInline:"0.6em 0",paddingBlock:0,borderInlineStart:"4px solid rgba(100, 100, 100, 0.2)",opacity:.85}}),hye=e=>{const{componentCls:n}=e,s=r9(e).inputPaddingVertical+1;return{"&-edit-content":{position:"relative","div&":{insetInlineStart:-e.paddingSM,marginTop:-s,marginBottom:`calc(1em - ${s}px)`},[`${n}-edit-content-confirm`]:{position:"absolute",insetInlineEnd:e.marginXS+2,insetBlockEnd:e.marginXS,color:e.colorTextDescription,fontWeight:"normal",fontSize:e.fontSize,fontStyle:"normal",pointerEvents:"none"},textarea:{margin:"0!important",MozTransition:"none",height:"1em"}}}},pye=e=>({"&-copy-success":{"\n    &,\n    &:hover,\n    &:focus":{color:e.colorSuccess}}}),fye=()=>({"\n  a&-ellipsis,\n  span&-ellipsis\n  ":{display:"inline-block",maxWidth:"100%"},"&-single-line":{whiteSpace:"nowrap"},"&-ellipsis-single-line":{overflow:"hidden",textOverflow:"ellipsis","a&, span&":{verticalAlign:"bottom"}},"&-ellipsis-multiple-line":{display:"-webkit-box",overflow:"hidden",WebkitLineClamp:3,WebkitBoxOrient:"vertical"}}),mye=e=>{const{componentCls:n,titleMarginTop:o}=e;return{[n]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:e.colorText,wordBreak:"break-word",lineHeight:e.lineHeight,[`&${n}-secondary`]:{color:e.colorTextDescription},[`&${n}-success`]:{color:e.colorSuccess},[`&${n}-warning`]:{color:e.colorWarning},[`&${n}-danger`]:{color:e.colorError,"a&:active, a&:focus":{color:e.colorErrorActive},"a&:hover":{color:e.colorErrorHover}},[`&${n}-disabled`]:{color:e.colorTextDisabled,cursor:"not-allowed",userSelect:"none"},"\n        div&,\n        p\n      ":{marginBottom:"1em"}},lye(e)),{[`
      & + h1${n},
      & + h2${n},
      & + h3${n},
      & + h4${n},
      & + h5${n}
      `]:{marginTop:o},"\n      div,\n      ul,\n      li,\n      p,\n      h1,\n      h2,\n      h3,\n      h4,\n      h5":{"\n        + h1,\n        + h2,\n        + h3,\n        + h4,\n        + h5\n        ":{marginTop:o}}}),dye(e)),uye(e)),{[`
        ${n}-expand,
        ${n}-edit,
        ${n}-copy
      `]:Object.assign(Object.assign({},kV(e)),{marginInlineStart:e.marginXXS})}),hye(e)),pye(e)),fye()),{"&-rtl":{direction:"rtl"}})}},b9=ic("Typography",e=>[mye(e)],e=>({titleMarginTop:"1.2em",titleMarginBottom:"0.5em",fontWeightStrong:e.fontWeightStrong})),gye=e=>{let{prefixCls:n,"aria-label":o,className:s,style:c,direction:d,maxLength:p,autoSize:m=!0,value:g,onSave:_,onCancel:S,onEnd:T,component:R,enterIcon:N=b.createElement(J_e,null)}=e;const O=b.useRef(null),A=b.useRef(!1),M=b.useRef(),[x,P]=b.useState(g);b.useEffect(()=>{P(g)},[g]),b.useEffect(()=>{if(O.current&&O.current.resizableTextArea){const{textArea:he}=O.current.resizableTextArea;he.focus();const{length:pe}=he.value;he.setSelectionRange(pe,pe)}},[]);const D=he=>{let{target:pe}=he;P(pe.value.replace(/[\n\r]/g,""))},F=()=>{A.current=!0},j=()=>{A.current=!1},B=he=>{let{keyCode:pe}=he;A.current||(M.current=pe)},H=()=>{_(x.trim())},K=he=>{let{keyCode:pe,ctrlKey:ce,altKey:se,metaKey:ae,shiftKey:Ee}=he;M.current===pe&&!A.current&&!ce&&!se&&!ae&&!Ee&&(pe===St.ENTER?(H(),T==null||T()):pe===St.ESC&&S())},J=()=>{H()},q=R?`${n}-${R}`:"",[Q,ee]=b9(n),ne=Ye(n,`${n}-edit-content`,{[`${n}-rtl`]:d==="rtl"},s,q,ee);return Q(b.createElement("div",{className:ne,style:c},b.createElement(d9,{ref:O,maxLength:p,value:x,onChange:D,onKeyDown:B,onKeyUp:K,onCompositionStart:F,onCompositionEnd:j,onBlur:J,"aria-label":o,rows:1,autoSize:m}),N!==null?tc(N,{className:`${n}-edit-content-confirm`}):null))},vye=gye;var Eye=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const _ye=b.forwardRef((e,n)=>{var{prefixCls:o,component:s="article",className:c,rootClassName:d,setContentRef:p,children:m,direction:g}=e,_=Eye(e,["prefixCls","component","className","rootClassName","setContentRef","children","direction"]);const{getPrefixCls:S,direction:T}=b.useContext(nr),R=g??T;let N=n;p&&(N=Uc(n,p));const O=S("typography",o),[A,M]=b9(O),x=Ye(O,{[`${O}-rtl`]:R==="rtl"},c,d,M);return A(b.createElement(s,Object.assign({className:x,ref:N},_),m))}),T9=_ye;function A1(e,n){return b.useMemo(()=>{const o=!!e;return[o,Object.assign(Object.assign({},n),o&&typeof e=="object"?e:null)]},[e])}const yye=(e,n)=>{const o=b.useRef(!1);b.useEffect(()=>{o.current?e():o.current=!0},n)},Sye=yye;function R9(e){const n=typeof e;return n==="string"||n==="number"}function Cye(e){let n=0;return e.forEach(o=>{R9(o)?n+=String(o).length:n+=1}),n}function J5(e,n){let o=0;const s=[];for(let c=0;c<e.length;c+=1){if(o===n)return s;const d=e[c],m=R9(d)?String(d).length:1,g=o+m;if(g>n){const _=n-o;return s.push(String(d).slice(0,_)),s}s.push(d),o=g}return e}const bye=0,WE=1,Q5=2,O1=3,Z5=4,Tye=e=>{let{enabledMeasure:n,children:o,text:s,width:c,fontSize:d,rows:p,onEllipsis:m}=e;const[[g,_,S],T]=b.useState([0,0,0]),[R,N]=b.useState(bye),[O,A]=b.useState(0),M=b.useRef(null),x=b.useRef(null),P=b.useMemo(()=>ml(s),[s]),D=b.useMemo(()=>Cye(P),[P]),F=b.useMemo(()=>!n||R!==O1?o(P,!1):o(J5(P,_),_<D),[n,R,o,P,_,D]);qr(()=>{n&&c&&d&&D&&(N(WE),T([0,Math.ceil(D/2),D]))},[n,c,d,s,D,p]),qr(()=>{var K;R===WE&&A(((K=M.current)===null||K===void 0?void 0:K.offsetHeight)||0)},[R]),qr(()=>{var K,J;if(O){if(R===WE){const q=((K=x.current)===null||K===void 0?void 0:K.offsetHeight)||0,Q=p*O;q<=Q?(N(Z5),m(!1)):N(Q5)}else if(R===Q5)if(g!==S){const q=((J=x.current)===null||J===void 0?void 0:J.offsetHeight)||0,Q=p*O;let ee=g,ne=S;g===S-1?ne=g:q<=Q?ee=_:ne=_;const he=Math.ceil((ee+ne)/2);T([ee,he,ne])}else N(O1),m(!0)}},[R,g,S,p,O]);const j={width:c,whiteSpace:"normal",margin:0,padding:0},B=(K,J,q)=>b.createElement("span",{"aria-hidden":!0,ref:J,style:Object.assign({position:"fixed",display:"block",left:0,top:0,zIndex:-9999,visibility:"hidden",pointerEvents:"none",fontSize:Math.floor(d/2)*2},q)},K),H=(K,J)=>{const q=J5(P,K);return B(o(q,!0),J,j)};return b.createElement(b.Fragment,null,F,n&&R!==O1&&R!==Z5&&b.createElement(b.Fragment,null,B("lg",M,{wordBreak:"keep-all",whiteSpace:"nowrap"}),R===WE?B(o(P,!1),x,j):H(_,x)))},Rye=Tye,wye=e=>{let{enabledEllipsis:n,isEllipsis:o,children:s,tooltipProps:c}=e;return!(c!=null&&c.title)||!n?s:b.createElement(Mm,Object.assign({open:o?void 0:!1},c),s)},Iye=wye;var Aye=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};function Oye(e,n){let{mark:o,code:s,underline:c,delete:d,strong:p,keyboard:m,italic:g}=e,_=n;function S(T,R){R&&(_=b.createElement(T,{},_))}return S("strong",p),S("u",c),S("del",d),S("code",s),S("mark",o),S("kbd",m),S("i",g),_}function zE(e,n,o){return e===!0||e===void 0?n:e||o&&n}function eB(e){return e===!1?[!1,!1]:Array.isArray(e)?e:[e]}const xye="...",Nye=b.forwardRef((e,n)=>{var o,s,c;const{prefixCls:d,className:p,style:m,type:g,disabled:_,children:S,ellipsis:T,editable:R,copyable:N,component:O,title:A}=e,M=Aye(e,["prefixCls","className","style","type","disabled","children","ellipsis","editable","copyable","component","title"]),{getPrefixCls:x,direction:P}=b.useContext(nr),[D]=wV("Text"),F=b.useRef(null),j=b.useRef(null),B=x("typography",d),H=Ea(M,["mark","code","delete","underline","strong","keyboard","italic"]),[K,J]=A1(R),[q,Q]=cl(!1,{value:J.editing}),{triggerType:ee=["icon"]}=J,ne=nt=>{var yt;nt&&((yt=J.onStart)===null||yt===void 0||yt.call(J)),Q(nt)};Sye(()=>{var nt;q||(nt=j.current)===null||nt===void 0||nt.focus()},[q]);const he=nt=>{nt==null||nt.preventDefault(),ne(!0)},pe=nt=>{var yt;(yt=J.onChange)===null||yt===void 0||yt.call(J,nt),ne(!1)},ce=()=>{var nt;(nt=J.onCancel)===null||nt===void 0||nt.call(J),ne(!1)},[se,ae]=A1(N),[Ee,ve]=b.useState(!1),le=b.useRef(null),de={};ae.format&&(de.format=ae.format);const ye=()=>{le.current&&clearTimeout(le.current)},fe=nt=>{var yt;nt==null||nt.preventDefault(),nt==null||nt.stopPropagation(),sye(ae.text||String(S)||"",de),ve(!0),ye(),le.current=setTimeout(()=>{ve(!1)},3e3),(yt=ae.onCopy)===null||yt===void 0||yt.call(ae,nt)};b.useEffect(()=>ye,[]);const[ke,Me]=b.useState(!1),[Ve,je]=b.useState(!1),[dt,ut]=b.useState(!1),[Ct,_t]=b.useState(!1),[Tt,it]=b.useState(!1),[kt,qt]=b.useState(!0),[xt,ze]=A1(T,{expandable:!1}),ct=xt&&!dt,{rows:et=1}=ze,tt=b.useMemo(()=>!ct||ze.suffix!==void 0||ze.onEllipsis||ze.expandable||K||se,[ct,ze,K,se]);qr(()=>{xt&&!tt&&(Me(r5("webkitLineClamp")),je(r5("textOverflow")))},[tt,xt]);const mt=b.useMemo(()=>tt?!1:et===1?Ve:ke,[tt,Ve,ke]),Ot=ct&&(mt?Tt:Ct),Ht=ct&&et===1&&mt,hn=ct&&et>1&&mt,Lt=nt=>{var yt;ut(!0),(yt=ze.onExpand)===null||yt===void 0||yt.call(ze,nt)},[br,Xt]=b.useState(0),[In,Hr]=b.useState(0),sn=(nt,yt)=>{let{offsetWidth:En}=nt;var Qt;Xt(En),Hr(parseInt((Qt=window.getComputedStyle)===null||Qt===void 0?void 0:Qt.call(window,yt).fontSize,10)||0)},Dr=nt=>{var yt;_t(nt),Ct!==nt&&((yt=ze.onEllipsis)===null||yt===void 0||yt.call(ze,nt))};b.useEffect(()=>{const nt=F.current;if(xt&&mt&&nt){const yt=hn?nt.offsetHeight<nt.scrollHeight:nt.offsetWidth<nt.scrollWidth;Tt!==yt&&it(yt)}},[xt,mt,S,hn,kt]),b.useEffect(()=>{const nt=F.current;if(typeof IntersectionObserver>"u"||!nt||!mt||!ct)return;const yt=new IntersectionObserver(()=>{qt(!!nt.offsetParent)});return yt.observe(nt),()=>{yt.disconnect()}},[mt,ct]);let Qn={};ze.tooltip===!0?Qn={title:(o=J.text)!==null&&o!==void 0?o:S}:b.isValidElement(ze.tooltip)?Qn={title:ze.tooltip}:typeof ze.tooltip=="object"?Qn=Object.assign({title:(s=J.text)!==null&&s!==void 0?s:S},ze.tooltip):Qn={title:ze.tooltip};const Ut=b.useMemo(()=>{const nt=yt=>["string","number"].includes(typeof yt);if(!(!xt||mt)){if(nt(J.text))return J.text;if(nt(S))return S;if(nt(A))return A;if(nt(Qn.title))return Qn.title}},[xt,mt,A,Qn.title,Ot]);if(q)return b.createElement(vye,{value:(c=J.text)!==null&&c!==void 0?c:typeof S=="string"?S:"",onSave:pe,onCancel:ce,onEnd:J.onEnd,prefixCls:B,className:p,style:m,direction:P,component:O,maxLength:J.maxLength,autoSize:J.autoSize,enterIcon:J.enterIcon});const Jt=()=>{const{expandable:nt,symbol:yt}=ze;if(!nt)return null;let En;return yt?En=yt:En=D==null?void 0:D.expand,b.createElement("a",{key:"expand",className:`${B}-expand`,onClick:Lt,"aria-label":D==null?void 0:D.expand},En)},ai=()=>{if(!K)return;const{icon:nt,tooltip:yt}=J,En=ml(yt)[0]||(D==null?void 0:D.edit),Qt=typeof En=="string"?En:"";return ee.includes("icon")?b.createElement(Mm,{key:"edit",title:yt===!1?"":En},b.createElement(Y5,{ref:j,className:`${B}-edit`,onClick:he,"aria-label":Qt},nt||b.createElement(H_e,{role:"button"}))):null},Gn=()=>{if(!se)return;const{tooltips:nt,icon:yt}=ae,En=eB(nt),Qt=eB(yt),tn=Ee?zE(En[1],D==null?void 0:D.copied):zE(En[0],D==null?void 0:D.copy),Wr=Ee?D==null?void 0:D.copied:D==null?void 0:D.copy,_n=typeof tn=="string"?tn:Wr;return b.createElement(Mm,{key:"copy",title:tn},b.createElement(Y5,{className:Ye(`${B}-copy`,Ee&&`${B}-copy-success`),onClick:fe,"aria-label":_n},Ee?zE(Qt[1],b.createElement(M0e,null),!0):zE(Qt[0],b.createElement(L_e,null),!0)))},kr=nt=>[nt&&Jt(),ai(),Gn()],Tr=nt=>[nt&&b.createElement("span",{"aria-hidden":!0,key:"ellipsis"},xye),ze.suffix,kr(nt)];return b.createElement(Gd,{onResize:sn,disabled:!ct||mt},nt=>b.createElement(Iye,{tooltipProps:Qn,enabledEllipsis:ct,isEllipsis:Ot},b.createElement(T9,Object.assign({className:Ye({[`${B}-${g}`]:g,[`${B}-disabled`]:_,[`${B}-ellipsis`]:xt,[`${B}-single-line`]:ct&&et===1,[`${B}-ellipsis-single-line`]:Ht,[`${B}-ellipsis-multiple-line`]:hn},p),prefixCls:d,style:Object.assign(Object.assign({},m),{WebkitLineClamp:hn?et:void 0}),component:O,ref:Uc(nt,F,n),direction:P,onClick:ee.includes("text")?he:void 0,"aria-label":Ut==null?void 0:Ut.toString(),title:A},H),b.createElement(Rye,{enabledMeasure:ct&&!mt,text:S,rows:et,width:br,fontSize:In,onEllipsis:Dr},(yt,En)=>{let Qt=yt;return yt.length&&En&&Ut&&(Qt=b.createElement("span",{key:"show-content","aria-hidden":!0},Qt)),Oye(e,b.createElement(b.Fragment,null,Qt,Tr(En)))}))))}),CS=Nye;var Pye=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const Dye=b.forwardRef((e,n)=>{var{ellipsis:o,rel:s}=e,c=Pye(e,["ellipsis","rel"]);const d=Object.assign(Object.assign({},c),{rel:s===void 0&&c.target==="_blank"?"noopener noreferrer":s});return delete d.navigate,b.createElement(CS,Object.assign({},d,{ref:n,ellipsis:!!o,component:"a"}))}),kye=Dye,Lye=b.forwardRef((e,n)=>b.createElement(CS,Object.assign({ref:n},e,{component:"div"}))),Mye=Lye;var Fye=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const Uye=(e,n)=>{var{ellipsis:o}=e,s=Fye(e,["ellipsis"]);const c=b.useMemo(()=>o&&typeof o=="object"?Ea(o,["expandable","rows"]):o,[o]);return b.createElement(CS,Object.assign({ref:n},s,{ellipsis:c,component:"span"}))},Bye=b.forwardRef(Uye);var jye=globalThis&&globalThis.__rest||function(e,n){var o={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(e);c<s.length;c++)n.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(e,s[c])&&(o[s[c]]=e[s[c]]);return o};const Vye=[1,2,3,4,5],$ye=b.forwardRef((e,n)=>{const{level:o=1}=e,s=jye(e,["level"]);let c;return Vye.includes(o)?c=`h${o}`:c="h1",b.createElement(CS,Object.assign({ref:n},s,{component:c}))}),Hye=$ye,ig=T9;ig.Text=Bye;ig.Link=kye;ig.Title=Hye;ig.Paragraph=Mye;const No=ig;function w9(e){var n,o,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e))for(n=0;n<e.length;n++)e[n]&&(o=w9(e[n]))&&(s&&(s+=" "),s+=o);else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function px(){for(var e,n,o=0,s="";o<arguments.length;)(e=arguments[o++])&&(n=w9(e))&&(s&&(s+=" "),s+=n);return s}const Wye=b.forwardRef(({className:e,children:n},o)=>te.jsx("div",{className:px(e,"b-1 b-solid b-coolgray-6 rd of-hidden relative"),ref:o,style:{width:288,height:216},children:n})),_s=Object.assign(b.forwardRef(({className:e,children:n},o)=>te.jsx("div",{className:px(e,"flex-1 p-10 p-t-4 flex gap-5"),ref:o,children:n})),{Item:Wye}),oi=({children:e})=>te.jsx("div",{className:"h-screen flex flex-col",children:e}),_l=({children:e})=>te.jsx("samp",{className:"z-2 inline-flex items-center gap-1 absolute bottom-0 bg-black c-white px-1 text-sm",children:e}),GE=14,KE=8,x1=8,N1=4;function zye({volumeLevel:e=0,noise:n=.075,...o}){const[s,c]=b.useState(0);return b.useEffect(()=>{if(e&&n){const d=Math.max(0,Math.min(1,n)),p=setInterval(()=>{c(e+Math.random()*d*(Math.random()>.5?1:-1))},50);return()=>clearInterval(p)}},[e,n]),te.jsxs("svg",{fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...o,children:[te.jsx("defs",{children:te.jsx("clipPath",{id:"icon-mic-v-clip",children:te.jsx("rect",{height:GE,rx:KE/2,width:KE,x:x1,y:N1})})}),te.jsx("path",{d:"M0 0h24v24H0z",fill:"#999CA3",opacity:".01"}),te.jsx("rect",{clipPath:"url(#icon-mic-v-clip)",fill:"#fff",height:GE,width:KE,x:x1,y:N1}),te.jsx("path",{d:"M4 16.625h2v-1.25H4v1.25Zm6 4h4v-1.25h-4v1.25Zm8-4h2v-1.25h-2v1.25Zm-4 4A4.625 4.625 0 0 0 18.625 16h-1.25A3.375 3.375 0 0 1 14 19.375v1.25ZM5.375 16A4.625 4.625 0 0 0 10 20.625v-1.25A3.375 3.375 0 0 1 6.625 16h-1.25Z",fill:"#fff"}),te.jsx("g",{clipPath:"url(#icon-mic-v-clip)",children:te.jsx("rect",{fill:"#44AD00",height:GE*2,style:{transform:`translateY(${(1-s)*GE}px)`,transition:"transform .1s"},width:KE,x:x1,y:N1})})]})}const Gye=b.memo(function(n){return te.jsxs("svg",{fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...n,children:[te.jsx("path",{d:"m5 5 14 14",stroke:"rgb(225, 225, 225, 0.35)",strokeLinejoin:"round",strokeWidth:"1.25"}),te.jsx("path",{clipRule:"evenodd",d:"M19.277 16.625H20v-1.25h-1.973l1.25 1.25Zm-3.239 2.065.89.89a4.602 4.602 0 0 1-2.716 1.04l-.212.005h-4a4.626 4.626 0 0 1-4.55-3.787l-.033-.213H4v-1.25h2c.345 0 .625.28.625.625a3.375 3.375 0 0 0 3.19 3.37l.185.005h4a3.36 3.36 0 0 0 2.038-.685Zm.587-4.717V8a4.625 4.625 0 0 0-8.5-2.526l.911.91a3.374 3.374 0 0 1 6.281.991H14v1.25h1.375v.75H14v1.25h1.375v.75h-1.348l1.25 1.25h.098v.098l1.25 1.25Zm-2.587 2.717.89.89A4.625 4.625 0 0 1 7.375 14v-3.973l1.25 1.25v.098h.098l1.25 1.25H8.625V14a3.375 3.375 0 0 0 5.413 2.69Z",fill:"rgb(225, 225, 225, 0.35)",fillRule:"evenodd"})]})}),Kye=b.memo(function(n){return te.jsxs("svg",{fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...n,children:[te.jsx("circle",{cx:"12",cy:"11",r:"7",stroke:"#fff",strokeLinejoin:"round",strokeWidth:"1.25"}),te.jsx("circle",{cx:"12",cy:"11",r:"3",stroke:"#fff",strokeLinejoin:"round",strokeWidth:"1.25"}),te.jsx("circle",{cx:"14.625",cy:"6.625",fill:"#fff",r:".625"}),te.jsx("path",{d:"M7 18.25a8.004 8.004 0 0 0 10 0",stroke:"#fff",strokeLinejoin:"round",strokeWidth:"1.25"})]})}),qye=b.memo(function(n){return te.jsxs("svg",{fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...n,children:[te.jsx("path",{d:"m5 5 14 14",stroke:"rgb(225, 225, 225, 0.35)",strokeLinejoin:"round",strokeWidth:"1.25"}),te.jsx("path",{clipRule:"evenodd",d:"m15.72 18.373.91.909a8.63 8.63 0 0 1-9.788-.364l-.232-.18.78-.976a7.38 7.38 0 0 0 8.33.61Zm2.434-2.87A7.625 7.625 0 0 0 7.497 4.846l.897.896a6.375 6.375 0 0 1 8.864 8.864l.896.897Zm-3.857 1.446.952.951A7.625 7.625 0 0 1 5.1 7.751l.951.952a6.375 6.375 0 0 0 8.246 8.246Zm.956-4.348a3.625 3.625 0 0 0-4.854-4.854l.964.964a2.378 2.378 0 0 1 2.926 2.926l.964.964Zm-.628-5.351a.625.625 0 1 0 0-1.25.625.625 0 0 0 0 1.25Z",fill:"rgb(225, 225, 225, 0.35)",fillRule:"evenodd"})]})});function jo(e,n,o){return e.on(n,o),()=>e.off(n,o)}function Yye(e){try{return e()}catch(n){console.error(n)}}function df(e){return()=>e.forEach(Yye)}function fx(e,n){const o=setTimeout(e,n);return()=>clearTimeout(o)}function I9(){let e,n,o;function s(){if(n){const _=n;n=void 0,_()}}async function c(){if(o){const _=o;o=void 0;try{await _()}catch(S){console.error(S)}}}async function d(_){e=!0,await c();try{o=await _()}catch(S){console.error(S)}e=!1,s()}async function p(){e=!0,await c(),e=!1,s()}function m(_){e?n=()=>d(_):d(_)}function g(){e?n=p:p()}return{run:m,dispose:g}}const mx=typeof document<"u"?b.useLayoutEffect:b.useEffect;function Xye(e){return e!=null&&typeof e.then=="function"}function Du(){const e=b.useRef(!1);return b.useEffect(()=>(e.current=!1,()=>{e.current=!0}),[]),e}function Jye(){const e=Du();function n(o,s){return new Promise(async(c,d)=>{try{const p=await o;e.current||c(p)}catch(p){e.current?s&&s(p):d(p)}})}return b.useCallback(n,[e])}function bS(e){const n=Jye(),[o,s]=b.useState();return mx(()=>{Xye(e)?n(e).then(s):s(e)},[e,n]),o}function Yd(e,n){const o=b.useRef();b.useEffect(()=>{const{run:s,dispose:c}=o.current||(o.current=I9());return s(e),c},n)}function Qye(e,n){const o=e.split("."),s=n.split("."),c=Math.max(o.length,s.length);for(let d=0;d<c;d++){const p=parseInt(o[d]||"0"),m=parseInt(s[d]||"0");if(p>m)return 1;if(p<m)return-1}return 0}function A9(e,n,o){const s=b.useRef(o);mx(()=>{s.current=o},[o]),b.useEffect(()=>{if(e)return jo(e,n,(...c)=>{s.current&&s.current(...c)})},[n,e])}const O9=b.createContext(null);function x9({client:e,children:n}){return te.jsx(O9.Provider,{value:e,children:n})}function Zye(e){const n=b.useContext(O9);return e||n}function ws(e){const n=Zye(e);if(!n)throw new Error("Agora RTC client not found. Should be wrapped in <AgoraRTCProvider value={client} />");return n}const eSe=b.createContext(null);function tSe({client:e,children:n}){return te.jsx(eSe.Provider,{value:e,children:n})}function nSe(e){const n=ws(e),[o,s]=b.useState(n?n.connectionState:"DISCONNECTED");return b.useEffect(()=>{if(n){s(n.connectionState);let c;return df([jo(n,"connection-state-change",d=>{c==null||c(),d==="CONNECTED"?c=fx(()=>s(d),0):s(d)}),()=>c==null?void 0:c()])}else s("DISCONNECTED")},[n]),o}function Is(e){const n=ws(e),[o,s]=b.useState(n?n.connectionState==="CONNECTED":!1);return b.useEffect(()=>{if(n){s(n.connectionState==="CONNECTED");let c;return df([jo(n,"connection-state-change",d=>{c==null||c(),c=fx(()=>s(d==="CONNECTED"),0)}),()=>c==null?void 0:c()])}else s(!1)},[n]),o}function TS(e){const n=ws(e),[o,s]=b.useState(n==null?void 0:n.uid);return b.useEffect(()=>{if(n)return jo(n,"connection-state-change",c=>{if(c==="CONNECTED")return fx(()=>s(n.uid),0);c==="DISCONNECTED"&&s(void 0)})},[n]),o}class ga extends Error{constructor(o,s){var n=(...args)=>{super(...args);hE(this,"rtcMethod");hE(this,"rtcError");hE(this,"name","AgoraRTCReactException")};n(typeof s=="string"?s:s.message),this.rtcMethod=o,this.rtcError=s}log(o){console[o](this)}}function xi(e,n=!0,o){const s=ws(o),c=Is(o),[d,p]=b.useState(!1),[m,g]=b.useState(0),[_,S]=b.useState(null),T=Du();return Yd(async()=>{if(T.current||(S(null),g(0),p(!1)),n&&s){try{T.current||p(!0);const{appid:R,channel:N,token:O,uid:A}=typeof e=="function"?await e():e,M=await s.join(R,N,O,A);T.current||g(M)}catch(R){console.error(R),T.current||S(new ga("IAgoraRTCClient.join",R))}return T.current||p(!1),()=>{for(const R of s.localTracks)R.isPlaying&&R.stop(),R.close();return s.leave()}}},[n,o]),{data:m,isLoading:d,isConnected:c,error:_}}const tB=()=>({uplink:0,downlink:0,delay:0});function rSe(e){const n=ws(e),[o,s]=b.useState(tB);return b.useEffect(()=>{if(n)return jo(n,"network-quality",c=>s({uplink:c.uplinkNetworkQuality,downlink:c.downlinkNetworkQuality,delay:n.getRTCStats().RTT??0}));s(tB())},[n]),o}function ku(e,n=!0,o){const s=ws(o),c=Is(o),d=b.useRef([]),[p,m]=b.useState(!1),[g,_]=b.useState(null),S=Du();return Yd(async()=>{if(S.current||(m(!1),_(null)),!s||!c||!n)return;const T=e.filter(Boolean),R=A=>{const M=Qye(ul.VERSION,"4.18.2")>=0;return M||new ga("usePublish","please check your agora-rtc-sdk-ng version in package.json, it's recommend upgrade to >= 4.18.2").log("warn"),M?s.mode!=="live"||s.role!=="audience":!0},N=A=>d.current.some(M=>M&&M.getTrackId()===A.getTrackId()),O=A=>R()&&A.enabled&&n&&!N(A);for(let A=0;A<T.length;A++){const M=T[A];if(M&&O(M)){try{S.current||m(!0),await s.publish(M)}catch(x){console.error(x),S.current||_(new ga("IAgoraRTCClient.publish",x))}S.current||m(!1)}}d.current=T},[c,n,s,e]),{isLoading:p,error:g}}function hf(e=!0,n={ANS:!0,AEC:!0},o){const s=Is(o),[c,d]=b.useState(null),[p,m]=b.useState(!1),[g,_]=b.useState(null),S=Du();return Yd(async()=>{if(S.current||(m(!1),_(null)),s&&e&&!c){try{S.current||m(!0);const T=await ul.createMicrophoneAudioTrack(n);S.current||d(T)}catch(T){console.error(T),S.current||_(new ga("IAgoraRTC.createMicrophoneAudioTrack",T))}S.current||m(!1)}!s&&!S.current&&d(null)},[s,e]),{localMicrophoneTrack:c,isLoading:p,error:g}}function pf(e=!0,n,o){const s=Is(o),[c,d]=b.useState(null),[p,m]=b.useState(!1),[g,_]=b.useState(null),S=Du();return Yd(async()=>{if(S.current||(m(!1),_(null)),s&&e&&!c){try{S.current||m(!0);const T=await ul.createCameraVideoTrack(n);S.current||d(T)}catch(T){console.error(T),S.current||_(new ga("IAgoraRTC.createCameraVideoTrack",T))}S.current||m(!1)}!s&&!S.current&&d(null)},[s,e]),{localCameraTrack:c,isLoading:p,error:g}}function ff(e,n){const o=ws(n),[s,c]=b.useState([]),d=Is(),p=b.useRef([]),[m,g]=b.useState(!1),[_,S]=b.useState(null),T=Du();return Yd(async()=>{if(T.current||S(null),!Array.isArray(e)||!d)return;const R=async A=>{if(!A.audioTrack&&e.some(({uid:M})=>A.uid===M)){try{T.current||g(!0),await o.subscribe(A,"audio")}catch(M){console.error(M),T.current||S(new ga("IAgoraRTCClient.subscribe",M))}A.audioTrack&&!p.current.some(M=>M.getUserId()===A.uid)&&p.current.push(A.audioTrack),p.current=p.current.map(M=>A.audioTrack&&M.getUserId()===A.uid&&M.getTrackId()!==A.audioTrack.getTrackId()?A.audioTrack:M),T.current||(c(p.current),g(!1))}},N=async A=>{if(e.some(({uid:M})=>A.uid===M)){T.current||(p.current=p.current.filter(M=>M.getUserId()!==A.uid),c(p.current));try{T.current||g(!0),await o.unsubscribe(A,"audio")}catch(M){console.error(M),T.current||S(new ga("IAgoraRTCClient.unsubscribe",M))}T.current||g(!1)}};e.map(A=>{!A.audioTrack&&A.hasAudio&&R(A)});const O=[];for(let A=0;A<p.current.length;A++){const M=p.current[A];if(!e.some(x=>x.uid===M.getUserId())){const x=o.remoteUsers.find(P=>P.uid===M.getUserId());x&&(O.push({user:x,mediaType:"audio"}),p.current.splice(A,1),A--)}}if(O.length>0){try{T.current||g(!0),await o.massUnsubscribe(O)}catch(A){console.error(A),T.current||S(new ga("IAgoraRTCClient.massUnsubscribe",A))}T.current||(c(p.current.slice()),g(!1))}return df([jo(o,"user-published",(A,M)=>{e.find(x=>x.uid===A.uid)&&M==="audio"&&R(A)}),jo(o,"user-unpublished",(A,M)=>{e.find(x=>x.uid===A.uid)&&M==="audio"&&N(A)})])},[d,o,e]),{audioTracks:s,isLoading:m,error:_}}function mf(e,n){const o=ws(n),[s,c]=b.useState([]),d=Is(),p=b.useRef([]),[m,g]=b.useState(!1),[_,S]=b.useState(null),T=Du();return Yd(async()=>{if(T.current||S(null),!Array.isArray(e)||!d)return;const R=async A=>{if(!A.videoTrack&&e.some(({uid:M})=>A.uid===M)){try{T.current||g(!0),await o.subscribe(A,"video")}catch(M){console.error(M),T.current||S(new ga("IAgoraRTCClient.subscribe",M))}A.videoTrack&&!p.current.some(M=>M.getUserId()===A.uid)&&p.current.push(A.videoTrack),p.current=p.current.map(M=>A.videoTrack&&M.getUserId()===A.uid&&M.getTrackId()!==A.videoTrack.getTrackId()?A.videoTrack:M),T.current||(c(p.current),g(!1))}},N=async A=>{if(e.some(({uid:M})=>A.uid===M)){T.current||(p.current=p.current.filter(M=>M.getUserId()!==A.uid),c(p.current));try{T.current||g(!0),await o.unsubscribe(A,"video")}catch(M){console.error(M),T.current||S(new ga("IAgoraRTCClient.unsubscribe",M))}T.current||g(!1)}};e.map(A=>{!A.videoTrack&&A.hasVideo&&R(A)});const O=[];for(let A=0;A<p.current.length;A++){const M=p.current[A];if(!e.some(x=>x.uid===M.getUserId())){const x=o.remoteUsers.find(P=>P.uid===M.getUserId());x&&(O.push({user:x,mediaType:"video"}),p.current.splice(A,1),A--)}}if(O.length>0){try{T.current||g(!0),await o.massUnsubscribe(O)}catch(A){console.error(A),T.current||S(new ga("IAgoraRTCClient.massUnsubscribe",A))}T.current||(c(p.current.slice()),g(!1))}return df([jo(o,"user-published",(A,M)=>{e.find(x=>x.uid===A.uid)&&M==="video"&&R(A)}),jo(o,"user-unpublished",(A,M)=>{e.find(x=>x.uid===A.uid)&&M==="video"&&N(A)})])},[d,o,e]),{videoTracks:s,isLoading:m,error:_}}function nB(e,n,o){const s=ws(o),c=n==="audio"?"audioTrack":"videoTrack",[d,p]=b.useState(e&&e[c]),m=Is(),g=b.useRef(),[_,S]=b.useState(!1),[T,R]=b.useState(null);return b.useEffect(()=>{if(!e||!m)return;let N=!1;N||R(null);const O=n==="audio"?"hasAudio":"hasVideo",A=e.uid,M=async(D,F)=>{if(D[c]&&s.remoteUsers.some(({uid:j})=>D.uid===j))try{N||S(!0),await s.unsubscribe(D,F)}catch(j){N||R(new ga("IAgoraRTCClient.unsubscribe",j)),console.error(j)}N||(p(void 0),S(!1))},x=async(D,F)=>{try{!D[c]&&s.remoteUsers.some(({uid:j})=>D.uid===j)&&(N||S(!0),await s.subscribe(D,F)),N||p(D[c])}catch(j){N||R(new ga("IAgoraRTCClient.subscribe",j)),console.error(j)}N||S(!1)},P=g.current||(g.current=I9());return!e[c]&&e[O]?P.run(()=>x(e,n)):p(e[c]),df([()=>{N=!0,P.dispose()},jo(s,"user-published",(D,F)=>{D.uid===A&&F===n&&P.run(()=>x(D,n))}),jo(s,"user-unpublished",(D,F)=>{D.uid===A&&F===n&&P.run(()=>M(D,n))})])},[m,s,e,n,c]),{track:d,isLoading:_,error:T}}function ac(e){const n=ws(e),[o,s]=b.useState(n?n.remoteUsers:[]);return b.useEffect(()=>{if(n){const c=()=>s(n.remoteUsers.slice());return df([jo(n,"user-joined",c),jo(n,"user-left",c),jo(n,"user-published",c),jo(n,"user-unpublished",c)])}},[n]),o}function N9(e=!0,n,o,s){const c=Is(s),[d,p]=b.useState(null),[m,g]=b.useState(!1),[_,S]=b.useState(null),T=Du();return Yd(async()=>{if(T.current||(g(!1),S(null)),c&&e&&!d){try{T.current||g(!0);const R=await ul.createScreenVideoTrack(n,o);T.current||p(R)}catch(R){console.error(R),T.current||S(new ga("IAgoraRTC.createScreenVideoTrack",R))}T.current||g(!1)}(!c||!e)&&!T.current&&p(null)},[c,e]),{screenTrack:d,isLoading:m,error:_}}const P9=b.createContext(void 0);function gx(e,n,o){const s=b.useContext(P9);b.useEffect(()=>{if(e)return o&&n?e.play(o):e.stop(),s?(s.onMount(e),()=>s.onUnmount(e)):()=>{e.isPlaying&&e.stop()}},[e,o,n,s])}function vx(e,n){const o=b.useContext(P9);mx(()=>{if(e)return n?e.play():e.stop(),o?(o.onMount(e),()=>o.onUnmount(e)):()=>{e.isPlaying&&e.stop()}},[e,n,o])}function RS({track:e,play:n=!1,volume:o,disabled:s,muted:c,children:d}){const p=bS(e);return vx(p,n),b.useEffect(()=>{p&&o!=null&&p.setVolume(o)},[p,o]),b.useEffect(()=>{p&&s!=null&&p.setEnabled(!s).catch(console.warn)},[s,p]),b.useEffect(()=>{p&&c!=null&&p.setMuted(c).catch(console.warn)},[c,p]),d?te.jsx(te.Fragment,{children:d}):null}const wS={position:"relative",width:"100%",height:"100%",overflow:"hidden",background:"#000"},D9={width:"100%",height:"100%"},og={position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",zIndex:2},gf=(e,n)=>b.useMemo(()=>({...e,...n}),[e,n]);function ag({track:e,play:n,disabled:o,muted:s,style:c,...d}){const p=gf(D9,c),[m,g]=b.useState(null),_=bS(e);return gx(_,n,m),b.useEffect(()=>{_&&o!=null&&_.setEnabled(!o).catch(console.warn)},[o,_]),b.useEffect(()=>{_&&s!=null&&_.setMuted(s).catch(console.warn)},[s,_]),te.jsx("div",{...d,ref:g,style:p})}const iSe={width:"100%",height:"100%",background:"#1a1e21 center/cover no-repeat",filter:"blur(16px) brightness(0.4)"},oSe={position:"absolute",top:"50%",left:"50%",maxWidth:"50%",maxHeight:"50%",aspectRatio:"1",transform:"translate(-50%, -50%)",borderRadius:"50%",overflow:"hidden",objectFit:"cover"};function IS({cover:e}){return te.jsx("div",{style:og,children:typeof e=="string"?te.jsxs(te.Fragment,{children:[te.jsx("div",{style:{...iSe,backgroundImage:`url(${e})`}}),te.jsx("img",{src:e,style:oSe})]}):e()})}function k9({micOn:e,cameraOn:n,audioTrack:o,videoTrack:s,playAudio:c,playVideo:d,volume:p,cover:m,children:g,style:_,...S}){const T=gf(wS,_);return d=d??!!n,c=c??!!e,te.jsxs("div",{...S,style:T,children:[te.jsx(ag,{disabled:!n,play:d,track:s}),te.jsx(RS,{disabled:!e,play:c,track:o,volume:p}),m&&!n&&te.jsx(IS,{cover:m}),te.jsx("div",{style:og,children:g})]})}function L9({track:e,play:n=!1,playbackDeviceId:o,volume:s,children:c}){return vx(e,n),b.useEffect(()=>{e&&o!=null&&e.setPlaybackDevice(o).catch(console.warn)},[e,o]),b.useEffect(()=>{e&&s!=null&&e.setVolume(s)},[e,s]),c?te.jsx(te.Fragment,{children:c}):null}function Ex({track:e,play:n,style:o,...s}){const c=gf(D9,o),[d,p]=b.useState(null);return gx(e,n,d),te.jsx("div",{...s,ref:p,style:c})}function _x({user:e,playVideo:n,playAudio:o,playbackDeviceId:s,volume:c,cover:d,style:p,children:m,...g}){const _=gf(wS,p),{track:S}=nB(e,"video"),{track:T}=nB(e,"audio");return n=n??(e==null?void 0:e.hasVideo),o=o??(e==null?void 0:e.hasAudio),te.jsxs("div",{...g,style:_,children:[te.jsx(Ex,{play:n,track:S}),te.jsx(L9,{play:o,playbackDeviceId:s,track:T,volume:c}),d&&!n&&te.jsx(IS,{cover:d}),te.jsx("div",{style:og,children:m})]})}function aSe({track:e,deviceId:n,...o}){const s=bS(e);return b.useEffect(()=>{s&&n!=null&&s.setDevice(n).catch(console.warn)},[n,s]),te.jsx(RS,{track:e,...o})}function sSe({track:e,deviceId:n,...o}){const s=bS(e);return b.useEffect(()=>{s&&n!=null&&s.setDevice(n).catch(console.warn)},[n,s]),te.jsx(ag,{track:e,...o})}function yx({micOn:e,cameraOn:n,audioTrack:o,videoTrack:s,playAudio:c=!1,playVideo:d,micDeviceId:p,cameraDeviceId:m,volume:g,cover:_,children:S,style:T,...R}){const N=gf(wS,T);return d=d??!!n,c=c??!!e,te.jsxs("div",{...R,style:N,children:[te.jsx(sSe,{deviceId:m,disabled:!n,play:d,track:s}),te.jsx(aSe,{deviceId:p,disabled:!e,play:c,track:o,volume:g}),_&&!n&&te.jsx(IS,{cover:_}),te.jsx("div",{style:og,children:S})]})}function sg({track:e,playVideo:n,cover:o,client:s,style:c,children:d,...p}){var S,T;const m=gf(wS,c),_=(T=(S=ws(s).remoteUsers)==null?void 0:S.find(R=>R.uid===(e==null?void 0:e.getUserId())))==null?void 0:T.hasVideo;return n=n??_,te.jsxs("div",{...p,style:m,children:[te.jsx(Ex,{play:n,track:e}),o&&!n&&te.jsx(IS,{cover:o}),te.jsx("div",{style:og,children:d})]})}const Sx=({published:e,total:n})=>te.jsx("div",{className:"p-4 text-xl",children:te.jsxs("span",{className:"inline-flex items-center gap-1 py-2 px-3 rd b-1 b-solid",children:[te.jsx("i",{className:"i-lucide-users"}),te.jsxs("samp",{className:"text-base",children:[e,"/",n]})]})});var Cx={exports:{}};Cx.exports;(function(e){(function(n,o,s){function c(g){var _=this,S=m();_.next=function(){var T=2091639*_.s0+_.c*23283064365386963e-26;return _.s0=_.s1,_.s1=_.s2,_.s2=T-(_.c=T|0)},_.c=1,_.s0=S(" "),_.s1=S(" "),_.s2=S(" "),_.s0-=S(g),_.s0<0&&(_.s0+=1),_.s1-=S(g),_.s1<0&&(_.s1+=1),_.s2-=S(g),_.s2<0&&(_.s2+=1),S=null}function d(g,_){return _.c=g.c,_.s0=g.s0,_.s1=g.s1,_.s2=g.s2,_}function p(g,_){var S=new c(g),T=_&&_.state,R=S.next;return R.int32=function(){return S.next()*4294967296|0},R.double=function(){return R()+(R()*2097152|0)*11102230246251565e-32},R.quick=R,T&&(typeof T=="object"&&d(T,S),R.state=function(){return d(S,{})}),R}function m(){var g=4022871197,_=function(S){S=String(S);for(var T=0;T<S.length;T++){g+=S.charCodeAt(T);var R=.02519603282416938*g;g=R>>>0,R-=g,R*=g,g=R>>>0,R-=g,g+=R*4294967296}return(g>>>0)*23283064365386963e-26};return _}o&&o.exports?o.exports=p:s&&s.amd?s(function(){return p}):this.alea=p})(Dt,e,!1)})(Cx);var cSe=Cx.exports,bx={exports:{}};bx.exports;(function(e){(function(n,o,s){function c(m){var g=this,_="";g.x=0,g.y=0,g.z=0,g.w=0,g.next=function(){var T=g.x^g.x<<11;return g.x=g.y,g.y=g.z,g.z=g.w,g.w^=g.w>>>19^T^T>>>8},m===(m|0)?g.x=m:_+=m;for(var S=0;S<_.length+64;S++)g.x^=_.charCodeAt(S)|0,g.next()}function d(m,g){return g.x=m.x,g.y=m.y,g.z=m.z,g.w=m.w,g}function p(m,g){var _=new c(m),S=g&&g.state,T=function(){return(_.next()>>>0)/4294967296};return T.double=function(){do var R=_.next()>>>11,N=(_.next()>>>0)/4294967296,O=(R+N)/(1<<21);while(O===0);return O},T.int32=_.next,T.quick=T,S&&(typeof S=="object"&&d(S,_),T.state=function(){return d(_,{})}),T}o&&o.exports?o.exports=p:s&&s.amd?s(function(){return p}):this.xor128=p})(Dt,e,!1)})(bx);var lSe=bx.exports,Tx={exports:{}};Tx.exports;(function(e){(function(n,o,s){function c(m){var g=this,_="";g.next=function(){var T=g.x^g.x>>>2;return g.x=g.y,g.y=g.z,g.z=g.w,g.w=g.v,(g.d=g.d+362437|0)+(g.v=g.v^g.v<<4^(T^T<<1))|0},g.x=0,g.y=0,g.z=0,g.w=0,g.v=0,m===(m|0)?g.x=m:_+=m;for(var S=0;S<_.length+64;S++)g.x^=_.charCodeAt(S)|0,S==_.length&&(g.d=g.x<<10^g.x>>>4),g.next()}function d(m,g){return g.x=m.x,g.y=m.y,g.z=m.z,g.w=m.w,g.v=m.v,g.d=m.d,g}function p(m,g){var _=new c(m),S=g&&g.state,T=function(){return(_.next()>>>0)/4294967296};return T.double=function(){do var R=_.next()>>>11,N=(_.next()>>>0)/4294967296,O=(R+N)/(1<<21);while(O===0);return O},T.int32=_.next,T.quick=T,S&&(typeof S=="object"&&d(S,_),T.state=function(){return d(_,{})}),T}o&&o.exports?o.exports=p:s&&s.amd?s(function(){return p}):this.xorwow=p})(Dt,e,!1)})(Tx);var uSe=Tx.exports,Rx={exports:{}};Rx.exports;(function(e){(function(n,o,s){function c(m){var g=this;g.next=function(){var S=g.x,T=g.i,R,N;return R=S[T],R^=R>>>7,N=R^R<<24,R=S[T+1&7],N^=R^R>>>10,R=S[T+3&7],N^=R^R>>>3,R=S[T+4&7],N^=R^R<<7,R=S[T+7&7],R=R^R<<13,N^=R^R<<9,S[T]=N,g.i=T+1&7,N};function _(S,T){var R,N=[];if(T===(T|0))N[0]=T;else for(T=""+T,R=0;R<T.length;++R)N[R&7]=N[R&7]<<15^T.charCodeAt(R)+N[R+1&7]<<13;for(;N.length<8;)N.push(0);for(R=0;R<8&&N[R]===0;++R);for(R==8?N[7]=-1:N[R],S.x=N,S.i=0,R=256;R>0;--R)S.next()}_(g,m)}function d(m,g){return g.x=m.x.slice(),g.i=m.i,g}function p(m,g){m==null&&(m=+new Date);var _=new c(m),S=g&&g.state,T=function(){return(_.next()>>>0)/4294967296};return T.double=function(){do var R=_.next()>>>11,N=(_.next()>>>0)/4294967296,O=(R+N)/(1<<21);while(O===0);return O},T.int32=_.next,T.quick=T,S&&(S.x&&d(S,_),T.state=function(){return d(_,{})}),T}o&&o.exports?o.exports=p:s&&s.amd?s(function(){return p}):this.xorshift7=p})(Dt,e,!1)})(Rx);var dSe=Rx.exports,wx={exports:{}};wx.exports;(function(e){(function(n,o,s){function c(m){var g=this;g.next=function(){var S=g.w,T=g.X,R=g.i,N,O;return g.w=S=S+1640531527|0,O=T[R+34&127],N=T[R=R+1&127],O^=O<<13,N^=N<<17,O^=O>>>15,N^=N>>>12,O=T[R]=O^N,g.i=R,O+(S^S>>>16)|0};function _(S,T){var R,N,O,A,M,x=[],P=128;for(T===(T|0)?(N=T,T=null):(T=T+"\0",N=0,P=Math.max(P,T.length)),O=0,A=-32;A<P;++A)T&&(N^=T.charCodeAt((A+32)%T.length)),A===0&&(M=N),N^=N<<10,N^=N>>>15,N^=N<<4,N^=N>>>13,A>=0&&(M=M+1640531527|0,R=x[A&127]^=N+M,O=R==0?O+1:0);for(O>=128&&(x[(T&&T.length||0)&127]=-1),O=127,A=4*128;A>0;--A)N=x[O+34&127],R=x[O=O+1&127],N^=N<<13,R^=R<<17,N^=N>>>15,R^=R>>>12,x[O]=N^R;S.w=M,S.X=x,S.i=O}_(g,m)}function d(m,g){return g.i=m.i,g.w=m.w,g.X=m.X.slice(),g}function p(m,g){m==null&&(m=+new Date);var _=new c(m),S=g&&g.state,T=function(){return(_.next()>>>0)/4294967296};return T.double=function(){do var R=_.next()>>>11,N=(_.next()>>>0)/4294967296,O=(R+N)/(1<<21);while(O===0);return O},T.int32=_.next,T.quick=T,S&&(S.X&&d(S,_),T.state=function(){return d(_,{})}),T}o&&o.exports?o.exports=p:s&&s.amd?s(function(){return p}):this.xor4096=p})(Dt,e,!1)})(wx);var hSe=wx.exports,Ix={exports:{}};Ix.exports;(function(e){(function(n,o,s){function c(m){var g=this,_="";g.next=function(){var T=g.b,R=g.c,N=g.d,O=g.a;return T=T<<25^T>>>7^R,R=R-N|0,N=N<<24^N>>>8^O,O=O-T|0,g.b=T=T<<20^T>>>12^R,g.c=R=R-N|0,g.d=N<<16^R>>>16^O,g.a=O-T|0},g.a=0,g.b=0,g.c=-1640531527,g.d=1367130551,m===Math.floor(m)?(g.a=m/4294967296|0,g.b=m|0):_+=m;for(var S=0;S<_.length+20;S++)g.b^=_.charCodeAt(S)|0,g.next()}function d(m,g){return g.a=m.a,g.b=m.b,g.c=m.c,g.d=m.d,g}function p(m,g){var _=new c(m),S=g&&g.state,T=function(){return(_.next()>>>0)/4294967296};return T.double=function(){do var R=_.next()>>>11,N=(_.next()>>>0)/4294967296,O=(R+N)/(1<<21);while(O===0);return O},T.int32=_.next,T.quick=T,S&&(typeof S=="object"&&d(S,_),T.state=function(){return d(_,{})}),T}o&&o.exports?o.exports=p:s&&s.amd?s(function(){return p}):this.tychei=p})(Dt,e,!1)})(Ix);var pSe=Ix.exports,M9={exports:{}};(function(e){(function(n,o,s){var c=256,d=6,p=52,m="random",g=s.pow(c,d),_=s.pow(2,p),S=_*2,T=c-1,R;function N(F,j,B){var H=[];j=j==!0?{entropy:!0}:j||{};var K=x(M(j.entropy?[F,D(o)]:F??P(),3),H),J=new O(H),q=function(){for(var Q=J.g(d),ee=g,ne=0;Q<_;)Q=(Q+ne)*c,ee*=c,ne=J.g(1);for(;Q>=S;)Q/=2,ee/=2,ne>>>=1;return(Q+ne)/ee};return q.int32=function(){return J.g(4)|0},q.quick=function(){return J.g(4)/4294967296},q.double=q,x(D(J.S),o),(j.pass||B||function(Q,ee,ne,he){return he&&(he.S&&A(he,J),Q.state=function(){return A(J,{})}),ne?(s[m]=Q,ee):Q})(q,K,"global"in j?j.global:this==s,j.state)}function O(F){var j,B=F.length,H=this,K=0,J=H.i=H.j=0,q=H.S=[];for(B||(F=[B++]);K<c;)q[K]=K++;for(K=0;K<c;K++)q[K]=q[J=T&J+F[K%B]+(j=q[K])],q[J]=j;(H.g=function(Q){for(var ee,ne=0,he=H.i,pe=H.j,ce=H.S;Q--;)ee=ce[he=T&he+1],ne=ne*c+ce[T&(ce[he]=ce[pe=T&pe+ee])+(ce[pe]=ee)];return H.i=he,H.j=pe,ne})(c)}function A(F,j){return j.i=F.i,j.j=F.j,j.S=F.S.slice(),j}function M(F,j){var B=[],H=typeof F,K;if(j&&H=="object")for(K in F)try{B.push(M(F[K],j-1))}catch{}return B.length?B:H=="string"?F:F+"\0"}function x(F,j){for(var B=F+"",H,K=0;K<B.length;)j[T&K]=T&(H^=j[T&K]*19)+B.charCodeAt(K++);return D(j)}function P(){try{var F;return R&&(F=R.randomBytes)||(F=new Uint8Array(c),(n.crypto||n.msCrypto).getRandomValues(F)),D(F)}catch{var j=n.navigator,B=j&&j.plugins;return[+new Date,n,B,n.screen,D(o)]}}function D(F){return String.fromCharCode.apply(0,F)}x(s.random(),o),e.exports?e.exports=N:s["seed"+m]=N})(typeof self<"u"?self:Dt,[],Math)})(M9);var fSe=M9.exports,mSe=cSe,gSe=lSe,vSe=uSe,ESe=dSe,_Se=hSe,ySe=pSe,Xd=fSe;Xd.alea=mSe;Xd.xor128=gSe;Xd.xorwow=vSe;Xd.xorshift7=ESe;Xd.xor4096=_Se;Xd.tychei=ySe;var SSe=Xd;const F9=yl(SSe);let U9=F9();function CSe(){return U9()}function rB(e){U9=F9(e)}function B9(e,n){const o=Array.isArray(e)?()=>bSe(e):e;return(n==null?void 0:n.length)===void 0?o(0):Array.from({length:n.length},(s,c)=>o(c))}function bSe(e){return e[Math.floor(CSe()*e.length)]}function TSe(e,n){return B9(e,n)}var iB={withAccents:{male:["Adrin","gir","lvaro","Andr","Andrs","rni","Asbjrn","Bjrn","Csar","Danel","Dav","Emlio","Fach","Franois","Frantiek","Gsli","Gtz","Gujn","Gumundur","Gnter","Halldr","Hans-Jrg","Hans-Jrgen","Hseyin","Iaki","Jnos","Jess","Ji","Jhann","Jhannes","Jokbas","Jn","Jos","Jrn","Julio","Jrgen","Kristjn","Mal","Magns","Matho","Mtys","Micha","Nol","Nuez","lafur","scar","yvind","Pll","Pawe","Ptur","Ramn","Ral","Ren","Ruair","Rubn","Sen","Srgio","Sigurur","Snke","Stefn","Tom","orsteinn"],female:["del","Agns","Alcia","nne","Antnia","sta","Auur","Ccilia","Chlo","Cladia","Drte","Eln","Elsabet","Elika","Frantika","Glria","Grayna","Gubjrg","Gun","Gurn","Henritte","Ingibjrg","ris","Jhanna","Jna","Jlia","Kte","Katrn","Kolbrn","Kristn","Kthe","Letcia","Ldia","Lcia","Magorzata","Margrt","Mara","Mnica","Natlia","lf","Patrcia","Ragnheiur","Rene","Ruena","Sin","Sigrur","Sigrn","Slvia","Srina","Vra","Virgnia","Zo","ra","runn"]},withoutAccents:{male:["Abdul","Abdullahi","Abubakar","Adam","Adamu","Adiy","Ahmad","Ajay","Akira","Alan","Alberto","Alejandro","Aleksander","Aleksandr","Aleksey","Alex","Alexander","Alexey","Ali","Aliyu","Aminu","Amit","Amiyr","Amiyt","Amnuai","Amphon","Anah","Anan","Andreas","Andrew","Andrey","Andri","Andries","Andrzej","Anil","Anthony","Anton","Antonio","Arnar","Artur","Artyom","Arun","Ashok","Atli","Avraham","Bartosz","Bello","Bernd","Bin","Birgir","Bjarni","Blessing","Bongani","Brian","Bunmi","Carlos","Carol","Chan","Chao","Charles","Charoen","Chen","Cheng","Christian","Christopher","Colin","Daniel","Daniyel","Dariusz","David","Denis","Dennis","Diego","Dieter","Dilip","Dinesh","Dmitriy","Dmitry","Einar","Eliyahu","Emmanuel","Evgeniy","Fernando","Fran","Francis","Francisco","Francisco-Javier","Frank","Franz","Gang","Gareth","Gary","George","Gerhard","Graham","Grzegorz","Gunnar","Guy","Haim","Haiyan","Hans","Hans-Ulrich","Haruna","Hassan","Heike","Heinz","Helgi","Helmut","Hendrik","Herbert","Hideo","Hiromi","Hiroshi","Hong","Horst","Hui","Ian","Ibrahim","Idris","Igor","Ilya","Isa","Isaac","Isah","Ivan","Jabulani","Jacek","Jacobus","Jakub","James","Jan","Janusz","Javier","Jean","Jerzy","Jesus","Jason","Jianguo","Jianhua","Jianjun","Jianping","Jin","Joan","Johan","Johannes","John","Jonathan","Jorge","Jose","Jose-Antonio","Jose-Luis","Jose-Manuel","Jose-Maria","Josef","Joseph","Joyce","Juan","Kabiru","Kai","Kamil","Karen","Karl","Karl-Heinz","Katsumi","Kazuo","Kelvin","Kenji","Kenneth","Kevin","Kiran","Kirill","Kiyoshi","Kjartan","Klaus","Ko","Koichi","Koji","Konstantin","Koshi","Krishna","Kristinn","Krzysztof","Kun","Lakshmi","Lan","Laxmi","Lei","Li","Lihua","Lijun","Lilian","Lin","Ling","Liping","Liyor","Luis","Lukasz","Maciej","Mahmood","Maksim","Manfred","Manoj","Manuel","Marcin","Mardkhay","Marek","Mariusz","Mark","Martin","Masami","Masao","Mateusz","Matt","Matthew","Meiyr","Michael","Michal","Miguel","Miguel-Angel","Mikhail","Min","Ming","Mitsuo","Miykhael","Miykhal","Mo","Mohamed","Mohammad","Mohammed","Mohan","Moses","Moshe","Mpho","Muhammad","Muhammed","Mukesh","Musa","Narong","Nathan","Nicola","Nikita","Nikolay","Ning","Nkosinathi","Noam","Oleg","Omer","Otieno","Pablo","Patrick","Paul","Pavel","Pawel","Pedro","Peng","Peter","Petrus","Philip","Pieter","Ping","Piotr","Prasit","Prasoet","Pricha","Pushpa","Qiang","Qing","Radha","Rafael","Ragnar","Raj","Rajendra","Rajesh","Raju","Rakesh","Ram","Ramesh","Raphael","Rattana","Ravi","Richard","Robert","Roman","Rong","Roy","Ryan","Salisu","Saman","Samran","Samuel","Sani","Sanjay","Santosh","Sam","Sammy","Sawat","Sebastian","Sergey","Sergio","Shankar","Shay","Shigeru","Shimon","Shlomo","Shoji","Sibusiso","Simon","Sipho","Sombat","Sombun","Somchai","Somchit","Somkhit","Somkiat","Sommai","Somnuek","Somphon","Somphong","Somsak","Sri","Stefan","Stephen","Steve","Steven","Suman","Sunday","Sunil","Sunthon","Suresh","Sushila","Suwit","Sveinn","Tadashi","Takashi","Takeshi","Tal","Tebogo","Thabo","Thawi","Themba","Thomas","Thulani","Tomasz","Toshio","Udom","Umar","Uriy","Usman","Uwe","Victor","Vijay","Viktor","Vincent","Vinod","Vladimir","Walter","Wanchai","Waraphon","Wei","Werner","Wichai","Wichian","Willem","William","Winai","Wirat","Wirot","Wojciech","Wolfgang","Xiang","Xiaohong","Xiaoli","Xiaoping","Xiaoyan","Xin","Xolani","Yaakv","Yahaya","Yakubu","Yan","Yasuo","Yhudah","Ying","Yisrael","Yong","Yosef","Yoshie","Yoshimi","Yoshio","Yu","Yue","Yukio","Yun","Yuriy","Yusuf","Yuval","Zbigniew","Zhen","Zhiqiang"],female:["Agata","Agnieszka","Aisha","Akira","Aleksandra","Alina","Alyona","Amina","Amnuai","Ana","Ana-Maria","Anah","Anan","Anastasiya","Andrea","Angela","Anita","Ann","Anna","Anong","Antonia","Asha","Barbara","Beata","Berglind","Bin","Birgit","Birna","Blessing","Brigitte","Bunmi","Busisiwe","Carmen","Carol","Caroline","Catherine","Chan","Chanah","Chao","Charoen","Chayah","Chen","Cheng","Christa","Christine","Claire","Claudia","Cristina","Darya","Dolores","Dorota","Edda","Ekaterina","Elena","Elisabeth","Elizabeth","Elke","Emiko","Emma","Erika","Erla","Erna","Ester","Esther","Eunice","Eva","Eugenia","Ewa","Faith","Fatima","Fiona","Fran","Francisca","Fumiko","Galina","Gabra","Gisela","Gita","Grace","Hadiza","Haiyan","Hanna","Haruna","Hauwa","Heike","Helen","Helga","Hildur","Hiroko","Hiromi","Hisako","Hong","Hui","Hulda","Inga","Ingrid","Irina","Isa","Isabel","Isah","Iwona","Jackline","Jan","Jane","Janet","Jean","Jennifer","Jianhua","Jianping","Jin","Joan","Joanna","Johanna","Josefa","Joy","Joyce","Juan","Julie","Justyna","Kai","Kanchana","Karen","Karin","Karolina","Kasia","Katarzyna","Katsumi","Keiko","Kiran","Kiyoko","Kristina","Kseniya","Kun","Lakshmi","Lalita","Lan","Latda","Laura","Laxmi","Leah","Lei","Li","Lihua","Lijun","Lilian","Lilja","Lin","Linda","Lindiwe","Ling","Liping","Lisa","Lucia","Lucy","Lyubov","Lyudmila","Magda","Magdalena","Mali","Manju","Margaret","Maria","Maria-Isabel","Maria-Jose","Maria-Pilar","Marina","Mariya","Marta","Martha","Mary","Maryam","Masako","Masami","Mei","Mercy","Michal","Michiko","Mieko","Min","Mina","Ming","Miriam","Miyoko","Mo","Monika","Mpho","Na","Nadezhda","Nan","Nancy","Natalya","Ngozi","Nicola","Ning","Nittaya","Noam","Nobuko","Nokuthula","Nonhlanhla","Noriko","Nushi","Olga","Omer","Patricia","Paula","Paulina","Peng","Petra","Phonthip","Pilar","Ping","Prani","Purity","Pushpa","Qing","Rachel","Radha","Rattana","Rebecca","Reiko","Rekha","Renate","Rita","Rong","Rosa","Rose","Rut","Ruth","Ryoko","Sabine","Sachiko","Samran","Santosh","Sara","Sarah","Sam","Sammy","Sawat","Shanti","Sharon","Shay","Shizuko","Shoshanah","Sibongile","Sita","Sombat","Sombun","Somchit","Somkhit","Sommai","Somnuek","Somphon","Somphong","Sri","Steinunn","Sukanya","Suman","Sunday","Sunita","Suphaphon","Susan","Susanne","Sushila","Svetlana","Takako","Tamar","Tatyana","Tal","Tebogo","Teruko","Thawi","Tomiko","Toshiko","Unnur","Urai","Urmila","Ursula","Usha","Valentina","Victoria","Wanjiru","Wanphen","Watsana","Wei","Wilai","Xiang","Xiaohong","Xiaoli","Xiaoping","Xiaoyan","Xin","Yael","Yan","Yasuko","Yelena","Yhudiyt","Ying","Yoko","Yong","Yoshie","Yoshiko","Yoshimi","Yu","Yue","Yuko","Yuliya","Yun","Yuval","Zainab","Zandile","Zanele","Zhen"]}};function RSe(e){var n,o;const s=(n=e==null?void 0:e.withAccents)!=null&&n,c=(o=e==null?void 0:e.gender)!=null?o:TSe(["male","female"]),d=e==null?void 0:e.locale;return B9(s?d?d==null?void 0:d.withAccents[c]:iB.withAccents[c]:d?d==null?void 0:d.withoutAccents[c]:iB.withoutAccents[c],e)}var wSe={china:["Peking roasted duck","Kung pao chicken","Sweet and sour pork","Hot pot","Dim sum","Dumplings","Ma po tofu","Char siu","Chicken chow mein","Beef chow mein","vegetable chow mein","Chicken fried rice","Beef fried rice","Vegetable fried Rice","Special fried Rice","Sichuan pork","Xiaolongbao","Zhajiangmian","Wonton soup","Sweet and sour pork","Duck spring Rolls","Vegetable spring Rolls","Wonton","Peking duck","Lamb hot pot","Spicy crayfish","Guilin rice noodles","Lanzhou hand-pulled noodles","Steamed crab","Shredded pork with garlic sauce","Red braised pork","Sweet and sour Ribs","Xinjiang","Braised pork with vermicelli"],italy:["Butternut squash risotto","Mushroom risotto","Beetroot risotto","Courgette risotto","Pizza","Gnocchi","Spaghetti bolognese","Spaghetti carbonara","Pesto alla Genovese","Beef lasagne","Vegetable lasagne","Gelato","Prosciutto di Parma","Ribollita","Bagna cauda","Polenta","Tortelli and ravioli","Focaccia","Garlic bread","Arancini","Il tartufo","Panzerotto fritto","Fiorentina","Minestrone","Frico","Arrosticini","Olive ascolante","Fritto misto piemontes","Tiramis"],india:["Biryani","Dosa","Tandoori chicken","Samosas","Chaat","Plain naan","Garlic naan","Pilau rice","Steamed rice","Chicken madras","Vegetable madras","Chicken vindaloo","Chicken jalfrezi","Chicken roghan josh","Lamb roghan josh","Beef roghan josh","Butter chicken","Dosa","Gulab jamun","Chicken korma","Mutter paneer","Papadum","Paratha","Raita","Saag paneer","Tandoori chicken","Chicken tikka masala","Pakora","Dal","Chapati","Pasanda","Aloo gobi","Kofta","Chicken makhani","Paneer naan","Chana Aloo Curry"],mexico:["Chilaquiles","Pozole","Tacos al pastor","Tostadas","Chiles en nogada","Elote","Enchiladas","Mole","Guacamole","Tamales","Huevos rancheros","Machaca","Discada","Beef Burrito","Chicken Burrito","Pozole de pollo o duajolote","Menudo","Cochinita pibil","Tamale","Quesadilla","Frijoles puercos","Chile en nogada","Esquites","Alegria de amaranto","Pipin","Aguachile","Ceviche","Pescado zarandeado","Camarones a la diabla","Birria de chivo","Tlayuda","Guacamole con chapulines","Flautas","Torta Ahogada","Carnitas","Caldo Azteca","Gorditas de Nata"],japan:["Sushi","Udon","Tofu","Tempura","Yakitori","Sashimi","Ramen","Donburi","Natto","Oden","Tamagoyaki","Soba","Tonkatsu","Kashipan","Sukiyaki","Miso soup","Okonomiyaki","Mentaiko","Nikujaga","Unagi no kabayaki","Shabu Shabu","Onigiri","Gyoza","Takoyaki","aiseki ryori","Edamame","Yakisoba","Chawanmushi","Wagashi"],france:["Foie gras","Hutres","Cassoulet","Poulet basquaise","Escargots au beurre persill","Mouclade charentaise","Galettes bretonnes","Flemish carbonnade","Quiche lorraine","Raclette","Cheese fondue","Beef fondue","Gratin dauphinois","Tartiflette","Bouillabaisse","Ratatouille","Boeuf bourguignon","Blanquette de veau","Pot-au-feu","Coq-au-vin","Hachis parmentier","Steak tartare","Choucroute","Souffl au fromage","Cuisses de grenouilles","Soupe  loignon","Baguette","Croissant","French cheeses","Fondant au chocolat","Tarte tatin","Macarons","Crme brle","le flottante","Profiteroles","Pain au chocolat"],lebanon:["Kibbeh","Kafta","Kanafeh","Hummus","Rice pilaf","Fattoush","Manakish","Tabbouleh","Sfeeha","Fattoush","Labneh","Muhammara","Lahm bi ajin","Kaak","Chanklich","Mssabaha","Shawarma","Kebbe","Falafel","Halewit el jeben","Namoura","Maamoul","Foul mdammas","Balila","Kawarma","Fattouch"],thailand:["Pad kra pao moo","Tom kha gai","Khao Pad","Chicken pad Thai","Vegetable pad Thai","Moo satay","Tom yum goong","Khao niew mamuang","Kai yad sai","Khao soi","Pad see ew","Laab moo","Gaeng panang","Gai pad med ma muang","Som tam","Poh pia tod","Gaeng massaman","Pla kapung nueng manao","Tod mun pla","Gaeng ped","Gaeng garee","Gaeng keow wan","Moo ping","Durian","Sai ooah","Hoy tod","Kuay teow reua","Mu kratha","Kao ka moo","Yam nua"],greece:["Moussaka","Papoutsakia","Pastitsio","Souvlaki","Soutzoukakia","Stifado","Tomatokeftedes","Tzatziki","Kolokithokeftedes","Giouvetsi","Choriatiki","Kleftiko","Gemista","Fasolada","Bougatsa","Tiropita","Spanakopita","Feta Cheese with Honey","Horta","Tirokroketes","Briam","Saganaki","Gigantes","Dolmades","Fasolatha","Koulouri","Loukoumades","Gyros","Galaktoboureko","Baklava"],turkey:["i kebap","Dner","Kfte","Pide","Kumpir","Meze","Mant","Lahmacun","Menemen","i kebap","skender kebab","Corba","Kuzu tandir","i Kfte","Pilav","Yaprak sarma","Dolma","mam bayld","Borek","Durum","Kumpir","Balik ekmek","Simit","Kunefe","Baklava","Lokum","Halva","Mozzaik pasta","Glla","Mercimek Kftesi","Haydari","Tursu suyu","Kahvalti","Kazan dibi","Hunkar begendi","Islak burgers","Salep","Yogurtlu kebab"],spain:["Tortilla de patatas","Fabada asturiana","Calots","Boquerones al vinagre","Empanada gallega","Paella","Gazpacho","Gachas","Migas","Bocadillo de calamares","Pulpo a feira","Caldo gallego","Lentejas con chorizo","Cocido madrileo","Cachopo","Caracoles"],venezuela:["Pabelln criollo","Arepa","Mondongo","Empanadas","Quesillo","Chicha andina","Tequeos","Cachapa","Hallaca","Perico","Pasticho","Mandocas","Caraotas negras","Patacones","Dulce de leche","Pan de Jamn"],chile:["Humitas","Empanadas","Porotos con riendas","Completos","Manjar","Cordero al palo","Pastel de choclo","Mote con huesillos","Sopaipillas","Curanto"],argentina:["Milanesas","Empanadas","Pizza fugazeta","Asado","Choripan","Bondiola","Bife de chorizo"],colombia:["Bandeja paisa","Chuleta valluna","Sancocho trifsico","Empanada valluna","Salpicon de frutas","Pastel de garbanzo","Ajiaco","Arepas","Arroz de lisa","Sancocho","Pan de bono","Cuchuco","Oblea","Cazuela de mariscos","Pan de yuca","Bollo Limpio","Almojbana","Empanadas","Arroz con Coco","Sopa de mondongo","Cazuela de Mariscos","Arroz con Pollo","Arepa de Huevo","Mote de Queso"],ecuador:["Encebollado","Ceviche","Tigrillo","Bolon de verde","Llapingacho","Mote pillo","Locro de papa","Churrasco"],peru:["Ceviche","Arroz con pollo","Aji de gallina","Llunca de gallina"],"el salvador":["Pupusa","Sopa de patas","Rigua","Flor de izote con huevo","Gallo en chicha"],romania:["Sarmale","Mici","Pomana porcului","Ciorb de fasole cu ciolan","Ciorb de burt","Ciorb rduean","Plcint cu brnz","Ciorb de potroace","Mmlig cu brnz i smntn","Tochitur","Piftie","Iahnie de fasole","Slnin afumat","Crnai afumai","Varz a la Cluj","Gula de cartofi cu afumtur","Cozonac de cas","Ciorb ardeleneasc de porc","Mucenici moldoveneti","Salat de boeuf","Dovleac copt","Papanai cu brnz de vac i afine","Drob de miel","Prjoale moldoveneti","Zacusc de vinete","Zacusc de fasole","Turt dulce","Cltitele cu gem","Cltitele cu brnza de vac","Balmo","Cozonac","Chiftele"]},oB;(oB=Object.keys(wSe))==null||oB.length;var aB,ISe={olympic:["Archery","Artistic Gymnastics","Artistic Swimming","Athletics","Badminton","Baseball Softball","Basketball","Beach Volleyball","BMX Freestyle","BMX Racing","Boxing","Kayak Flatwater","Kayak Slalom","Diving","Equestrian","Fencing","Football","Golf","Handball","Hockey","Judo","Karate","Marathon Swimming","Modern Pentathlon","Mountain Bike","Rhythmic Gymnastics","Road Cycling","Rowing","Rugby","Sailing","Shooting","Skateboarding","Sport Climbing","Surfing","Swimming","Table Tennis","Taekwondo","Tennis","Track Cycling","Trampoline","Triathlon","Volleyball","Water Polo","Weightlifting","Wrestling"],winterOlympic:["Alpine Skiing","Biathlon","Bobsleigh","Cross-Country Skiing","Curling","Figure Skating","Freestyle Skiing","Ice Hockey","Luge","Nordic Combined","Short Track Speed Skating","Skeleton","Ski Jumping","Snowboard","Speed Skating"],outdoor:["Archery","Athletics","Badminton","Baseball","Basketball","Bowling","Boxing","Camping","Canoeing","Climbing","Cricket","Curling","Cycling","Equestrian","Fencing","Football","Golf","Gymnastics","Handball","Hang Gliding","High Jumping","Hockey","Ice Hockey","Judo","Karate","Kite Flying","Monkey Bars","Motorsports","Netball","Rowing","Rugby","Running","Sailing","Skateboarding","Slide","Snow Skiing","Soccer","Street Hockey","Surfing","Swimming","Table Tennis","Tennis","Trekking","Triathlon","Volleyball","Weightlifting","Wrestling"]};(aB=Object.keys(ISe))==null||aB.length;var j9={exports:{}};function ASe(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var P1={exports:{}};const OSe={},xSe=Object.freeze(Object.defineProperty({__proto__:null,default:OSe},Symbol.toStringTag,{value:"Module"})),NSe=Wne(xSe);var sB;function Nn(){return sB||(sB=1,function(e,n){(function(o,s){e.exports=s()})(Dt,function(){var o=o||function(s,c){var d;if(typeof window<"u"&&window.crypto&&(d=window.crypto),typeof self<"u"&&self.crypto&&(d=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(d=globalThis.crypto),!d&&typeof window<"u"&&window.msCrypto&&(d=window.msCrypto),!d&&typeof Dt<"u"&&Dt.crypto&&(d=Dt.crypto),!d&&typeof ASe=="function")try{d=NSe}catch{}var p=function(){if(d){if(typeof d.getRandomValues=="function")try{return d.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof d.randomBytes=="function")try{return d.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},m=Object.create||function(){function P(){}return function(D){var F;return P.prototype=D,F=new P,P.prototype=null,F}}(),g={},_=g.lib={},S=_.Base=function(){return{extend:function(P){var D=m(this);return P&&D.mixIn(P),(!D.hasOwnProperty("init")||this.init===D.init)&&(D.init=function(){D.$super.init.apply(this,arguments)}),D.init.prototype=D,D.$super=this,D},create:function(){var P=this.extend();return P.init.apply(P,arguments),P},init:function(){},mixIn:function(P){for(var D in P)P.hasOwnProperty(D)&&(this[D]=P[D]);P.hasOwnProperty("toString")&&(this.toString=P.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),T=_.WordArray=S.extend({init:function(P,D){P=this.words=P||[],D!=c?this.sigBytes=D:this.sigBytes=P.length*4},toString:function(P){return(P||N).stringify(this)},concat:function(P){var D=this.words,F=P.words,j=this.sigBytes,B=P.sigBytes;if(this.clamp(),j%4)for(var H=0;H<B;H++){var K=F[H>>>2]>>>24-H%4*8&255;D[j+H>>>2]|=K<<24-(j+H)%4*8}else for(var J=0;J<B;J+=4)D[j+J>>>2]=F[J>>>2];return this.sigBytes+=B,this},clamp:function(){var P=this.words,D=this.sigBytes;P[D>>>2]&=4294967295<<32-D%4*8,P.length=s.ceil(D/4)},clone:function(){var P=S.clone.call(this);return P.words=this.words.slice(0),P},random:function(P){for(var D=[],F=0;F<P;F+=4)D.push(p());return new T.init(D,P)}}),R=g.enc={},N=R.Hex={stringify:function(P){for(var D=P.words,F=P.sigBytes,j=[],B=0;B<F;B++){var H=D[B>>>2]>>>24-B%4*8&255;j.push((H>>>4).toString(16)),j.push((H&15).toString(16))}return j.join("")},parse:function(P){for(var D=P.length,F=[],j=0;j<D;j+=2)F[j>>>3]|=parseInt(P.substr(j,2),16)<<24-j%8*4;return new T.init(F,D/2)}},O=R.Latin1={stringify:function(P){for(var D=P.words,F=P.sigBytes,j=[],B=0;B<F;B++){var H=D[B>>>2]>>>24-B%4*8&255;j.push(String.fromCharCode(H))}return j.join("")},parse:function(P){for(var D=P.length,F=[],j=0;j<D;j++)F[j>>>2]|=(P.charCodeAt(j)&255)<<24-j%4*8;return new T.init(F,D)}},A=R.Utf8={stringify:function(P){try{return decodeURIComponent(escape(O.stringify(P)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(P){return O.parse(unescape(encodeURIComponent(P)))}},M=_.BufferedBlockAlgorithm=S.extend({reset:function(){this._data=new T.init,this._nDataBytes=0},_append:function(P){typeof P=="string"&&(P=A.parse(P)),this._data.concat(P),this._nDataBytes+=P.sigBytes},_process:function(P){var D,F=this._data,j=F.words,B=F.sigBytes,H=this.blockSize,K=H*4,J=B/K;P?J=s.ceil(J):J=s.max((J|0)-this._minBufferSize,0);var q=J*H,Q=s.min(q*4,B);if(q){for(var ee=0;ee<q;ee+=H)this._doProcessBlock(j,ee);D=j.splice(0,q),F.sigBytes-=Q}return new T.init(D,Q)},clone:function(){var P=S.clone.call(this);return P._data=this._data.clone(),P},_minBufferSize:0});_.Hasher=M.extend({cfg:S.extend(),init:function(P){this.cfg=this.cfg.extend(P),this.reset()},reset:function(){M.reset.call(this),this._doReset()},update:function(P){return this._append(P),this._process(),this},finalize:function(P){P&&this._append(P);var D=this._doFinalize();return D},blockSize:16,_createHelper:function(P){return function(D,F){return new P.init(F).finalize(D)}},_createHmacHelper:function(P){return function(D,F){return new x.HMAC.init(P,F).finalize(D)}}});var x=g.algo={};return g}(Math);return o})}(P1)),P1.exports}var D1={exports:{}},cB;function AS(){return cB||(cB=1,function(e,n){(function(o,s){e.exports=s(Nn())})(Dt,function(o){return function(s){var c=o,d=c.lib,p=d.Base,m=d.WordArray,g=c.x64={};g.Word=p.extend({init:function(_,S){this.high=_,this.low=S}}),g.WordArray=p.extend({init:function(_,S){_=this.words=_||[],S!=s?this.sigBytes=S:this.sigBytes=_.length*8},toX32:function(){for(var _=this.words,S=_.length,T=[],R=0;R<S;R++){var N=_[R];T.push(N.high),T.push(N.low)}return m.create(T,this.sigBytes)},clone:function(){for(var _=p.clone.call(this),S=_.words=this.words.slice(0),T=S.length,R=0;R<T;R++)S[R]=S[R].clone();return _}})}(),o})}(D1)),D1.exports}var k1={exports:{}},lB;function PSe(){return lB||(lB=1,function(e,n){(function(o,s){e.exports=s(Nn())})(Dt,function(o){return function(){if(typeof ArrayBuffer=="function"){var s=o,c=s.lib,d=c.WordArray,p=d.init,m=d.init=function(g){if(g instanceof ArrayBuffer&&(g=new Uint8Array(g)),(g instanceof Int8Array||typeof Uint8ClampedArray<"u"&&g instanceof Uint8ClampedArray||g instanceof Int16Array||g instanceof Uint16Array||g instanceof Int32Array||g instanceof Uint32Array||g instanceof Float32Array||g instanceof Float64Array)&&(g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength)),g instanceof Uint8Array){for(var _=g.byteLength,S=[],T=0;T<_;T++)S[T>>>2]|=g[T]<<24-T%4*8;p.call(this,S,_)}else p.apply(this,arguments)};m.prototype=d}}(),o.lib.WordArray})}(k1)),k1.exports}var L1={exports:{}},uB;function DSe(){return uB||(uB=1,function(e,n){(function(o,s){e.exports=s(Nn())})(Dt,function(o){return function(){var s=o,c=s.lib,d=c.WordArray,p=s.enc;p.Utf16=p.Utf16BE={stringify:function(g){for(var _=g.words,S=g.sigBytes,T=[],R=0;R<S;R+=2){var N=_[R>>>2]>>>16-R%4*8&65535;T.push(String.fromCharCode(N))}return T.join("")},parse:function(g){for(var _=g.length,S=[],T=0;T<_;T++)S[T>>>1]|=g.charCodeAt(T)<<16-T%2*16;return d.create(S,_*2)}},p.Utf16LE={stringify:function(g){for(var _=g.words,S=g.sigBytes,T=[],R=0;R<S;R+=2){var N=m(_[R>>>2]>>>16-R%4*8&65535);T.push(String.fromCharCode(N))}return T.join("")},parse:function(g){for(var _=g.length,S=[],T=0;T<_;T++)S[T>>>1]|=m(g.charCodeAt(T)<<16-T%2*16);return d.create(S,_*2)}};function m(g){return g<<8&4278255360|g>>>8&16711935}}(),o.enc.Utf16})}(L1)),L1.exports}var M1={exports:{}},dB;function Jd(){return dB||(dB=1,function(e,n){(function(o,s){e.exports=s(Nn())})(Dt,function(o){return function(){var s=o,c=s.lib,d=c.WordArray,p=s.enc;p.Base64={stringify:function(g){var _=g.words,S=g.sigBytes,T=this._map;g.clamp();for(var R=[],N=0;N<S;N+=3)for(var O=_[N>>>2]>>>24-N%4*8&255,A=_[N+1>>>2]>>>24-(N+1)%4*8&255,M=_[N+2>>>2]>>>24-(N+2)%4*8&255,x=O<<16|A<<8|M,P=0;P<4&&N+P*.75<S;P++)R.push(T.charAt(x>>>6*(3-P)&63));var D=T.charAt(64);if(D)for(;R.length%4;)R.push(D);return R.join("")},parse:function(g){var _=g.length,S=this._map,T=this._reverseMap;if(!T){T=this._reverseMap=[];for(var R=0;R<S.length;R++)T[S.charCodeAt(R)]=R}var N=S.charAt(64);if(N){var O=g.indexOf(N);O!==-1&&(_=O)}return m(g,_,T)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function m(g,_,S){for(var T=[],R=0,N=0;N<_;N++)if(N%4){var O=S[g.charCodeAt(N-1)]<<N%4*2,A=S[g.charCodeAt(N)]>>>6-N%4*2,M=O|A;T[R>>>2]|=M<<24-R%4*8,R++}return d.create(T,R)}}(),o.enc.Base64})}(M1)),M1.exports}var F1={exports:{}},hB;function kSe(){return hB||(hB=1,function(e,n){(function(o,s){e.exports=s(Nn())})(Dt,function(o){return function(){var s=o,c=s.lib,d=c.WordArray,p=s.enc;p.Base64url={stringify:function(g,_){_===void 0&&(_=!0);var S=g.words,T=g.sigBytes,R=_?this._safe_map:this._map;g.clamp();for(var N=[],O=0;O<T;O+=3)for(var A=S[O>>>2]>>>24-O%4*8&255,M=S[O+1>>>2]>>>24-(O+1)%4*8&255,x=S[O+2>>>2]>>>24-(O+2)%4*8&255,P=A<<16|M<<8|x,D=0;D<4&&O+D*.75<T;D++)N.push(R.charAt(P>>>6*(3-D)&63));var F=R.charAt(64);if(F)for(;N.length%4;)N.push(F);return N.join("")},parse:function(g,_){_===void 0&&(_=!0);var S=g.length,T=_?this._safe_map:this._map,R=this._reverseMap;if(!R){R=this._reverseMap=[];for(var N=0;N<T.length;N++)R[T.charCodeAt(N)]=N}var O=T.charAt(64);if(O){var A=g.indexOf(O);A!==-1&&(S=A)}return m(g,S,R)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function m(g,_,S){for(var T=[],R=0,N=0;N<_;N++)if(N%4){var O=S[g.charCodeAt(N-1)]<<N%4*2,A=S[g.charCodeAt(N)]>>>6-N%4*2,M=O|A;T[R>>>2]|=M<<24-R%4*8,R++}return d.create(T,R)}}(),o.enc.Base64url})}(F1)),F1.exports}var U1={exports:{}},pB;function Qd(){return pB||(pB=1,function(e,n){(function(o,s){e.exports=s(Nn())})(Dt,function(o){return function(s){var c=o,d=c.lib,p=d.WordArray,m=d.Hasher,g=c.algo,_=[];(function(){for(var A=0;A<64;A++)_[A]=s.abs(s.sin(A+1))*4294967296|0})();var S=g.MD5=m.extend({_doReset:function(){this._hash=new p.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(A,M){for(var x=0;x<16;x++){var P=M+x,D=A[P];A[P]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360}var F=this._hash.words,j=A[M+0],B=A[M+1],H=A[M+2],K=A[M+3],J=A[M+4],q=A[M+5],Q=A[M+6],ee=A[M+7],ne=A[M+8],he=A[M+9],pe=A[M+10],ce=A[M+11],se=A[M+12],ae=A[M+13],Ee=A[M+14],ve=A[M+15],le=F[0],de=F[1],ye=F[2],fe=F[3];le=T(le,de,ye,fe,j,7,_[0]),fe=T(fe,le,de,ye,B,12,_[1]),ye=T(ye,fe,le,de,H,17,_[2]),de=T(de,ye,fe,le,K,22,_[3]),le=T(le,de,ye,fe,J,7,_[4]),fe=T(fe,le,de,ye,q,12,_[5]),ye=T(ye,fe,le,de,Q,17,_[6]),de=T(de,ye,fe,le,ee,22,_[7]),le=T(le,de,ye,fe,ne,7,_[8]),fe=T(fe,le,de,ye,he,12,_[9]),ye=T(ye,fe,le,de,pe,17,_[10]),de=T(de,ye,fe,le,ce,22,_[11]),le=T(le,de,ye,fe,se,7,_[12]),fe=T(fe,le,de,ye,ae,12,_[13]),ye=T(ye,fe,le,de,Ee,17,_[14]),de=T(de,ye,fe,le,ve,22,_[15]),le=R(le,de,ye,fe,B,5,_[16]),fe=R(fe,le,de,ye,Q,9,_[17]),ye=R(ye,fe,le,de,ce,14,_[18]),de=R(de,ye,fe,le,j,20,_[19]),le=R(le,de,ye,fe,q,5,_[20]),fe=R(fe,le,de,ye,pe,9,_[21]),ye=R(ye,fe,le,de,ve,14,_[22]),de=R(de,ye,fe,le,J,20,_[23]),le=R(le,de,ye,fe,he,5,_[24]),fe=R(fe,le,de,ye,Ee,9,_[25]),ye=R(ye,fe,le,de,K,14,_[26]),de=R(de,ye,fe,le,ne,20,_[27]),le=R(le,de,ye,fe,ae,5,_[28]),fe=R(fe,le,de,ye,H,9,_[29]),ye=R(ye,fe,le,de,ee,14,_[30]),de=R(de,ye,fe,le,se,20,_[31]),le=N(le,de,ye,fe,q,4,_[32]),fe=N(fe,le,de,ye,ne,11,_[33]),ye=N(ye,fe,le,de,ce,16,_[34]),de=N(de,ye,fe,le,Ee,23,_[35]),le=N(le,de,ye,fe,B,4,_[36]),fe=N(fe,le,de,ye,J,11,_[37]),ye=N(ye,fe,le,de,ee,16,_[38]),de=N(de,ye,fe,le,pe,23,_[39]),le=N(le,de,ye,fe,ae,4,_[40]),fe=N(fe,le,de,ye,j,11,_[41]),ye=N(ye,fe,le,de,K,16,_[42]),de=N(de,ye,fe,le,Q,23,_[43]),le=N(le,de,ye,fe,he,4,_[44]),fe=N(fe,le,de,ye,se,11,_[45]),ye=N(ye,fe,le,de,ve,16,_[46]),de=N(de,ye,fe,le,H,23,_[47]),le=O(le,de,ye,fe,j,6,_[48]),fe=O(fe,le,de,ye,ee,10,_[49]),ye=O(ye,fe,le,de,Ee,15,_[50]),de=O(de,ye,fe,le,q,21,_[51]),le=O(le,de,ye,fe,se,6,_[52]),fe=O(fe,le,de,ye,K,10,_[53]),ye=O(ye,fe,le,de,pe,15,_[54]),de=O(de,ye,fe,le,B,21,_[55]),le=O(le,de,ye,fe,ne,6,_[56]),fe=O(fe,le,de,ye,ve,10,_[57]),ye=O(ye,fe,le,de,Q,15,_[58]),de=O(de,ye,fe,le,ae,21,_[59]),le=O(le,de,ye,fe,J,6,_[60]),fe=O(fe,le,de,ye,ce,10,_[61]),ye=O(ye,fe,le,de,H,15,_[62]),de=O(de,ye,fe,le,he,21,_[63]),F[0]=F[0]+le|0,F[1]=F[1]+de|0,F[2]=F[2]+ye|0,F[3]=F[3]+fe|0},_doFinalize:function(){var A=this._data,M=A.words,x=this._nDataBytes*8,P=A.sigBytes*8;M[P>>>5]|=128<<24-P%32;var D=s.floor(x/4294967296),F=x;M[(P+64>>>9<<4)+15]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,M[(P+64>>>9<<4)+14]=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360,A.sigBytes=(M.length+1)*4,this._process();for(var j=this._hash,B=j.words,H=0;H<4;H++){var K=B[H];B[H]=(K<<8|K>>>24)&16711935|(K<<24|K>>>8)&4278255360}return j},clone:function(){var A=m.clone.call(this);return A._hash=this._hash.clone(),A}});function T(A,M,x,P,D,F,j){var B=A+(M&x|~M&P)+D+j;return(B<<F|B>>>32-F)+M}function R(A,M,x,P,D,F,j){var B=A+(M&P|x&~P)+D+j;return(B<<F|B>>>32-F)+M}function N(A,M,x,P,D,F,j){var B=A+(M^x^P)+D+j;return(B<<F|B>>>32-F)+M}function O(A,M,x,P,D,F,j){var B=A+(x^(M|~P))+D+j;return(B<<F|B>>>32-F)+M}c.MD5=m._createHelper(S),c.HmacMD5=m._createHmacHelper(S)}(Math),o.MD5})}(U1)),U1.exports}var B1={exports:{}},fB;function V9(){return fB||(fB=1,function(e,n){(function(o,s){e.exports=s(Nn())})(Dt,function(o){return function(){var s=o,c=s.lib,d=c.WordArray,p=c.Hasher,m=s.algo,g=[],_=m.SHA1=p.extend({_doReset:function(){this._hash=new d.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(S,T){for(var R=this._hash.words,N=R[0],O=R[1],A=R[2],M=R[3],x=R[4],P=0;P<80;P++){if(P<16)g[P]=S[T+P]|0;else{var D=g[P-3]^g[P-8]^g[P-14]^g[P-16];g[P]=D<<1|D>>>31}var F=(N<<5|N>>>27)+x+g[P];P<20?F+=(O&A|~O&M)+1518500249:P<40?F+=(O^A^M)+1859775393:P<60?F+=(O&A|O&M|A&M)-1894007588:F+=(O^A^M)-899497514,x=M,M=A,A=O<<30|O>>>2,O=N,N=F}R[0]=R[0]+N|0,R[1]=R[1]+O|0,R[2]=R[2]+A|0,R[3]=R[3]+M|0,R[4]=R[4]+x|0},_doFinalize:function(){var S=this._data,T=S.words,R=this._nDataBytes*8,N=S.sigBytes*8;return T[N>>>5]|=128<<24-N%32,T[(N+64>>>9<<4)+14]=Math.floor(R/4294967296),T[(N+64>>>9<<4)+15]=R,S.sigBytes=T.length*4,this._process(),this._hash},clone:function(){var S=p.clone.call(this);return S._hash=this._hash.clone(),S}});s.SHA1=p._createHelper(_),s.HmacSHA1=p._createHmacHelper(_)}(),o.SHA1})}(B1)),B1.exports}var j1={exports:{}},mB;function Ax(){return mB||(mB=1,function(e,n){(function(o,s){e.exports=s(Nn())})(Dt,function(o){return function(s){var c=o,d=c.lib,p=d.WordArray,m=d.Hasher,g=c.algo,_=[],S=[];(function(){function N(x){for(var P=s.sqrt(x),D=2;D<=P;D++)if(!(x%D))return!1;return!0}function O(x){return(x-(x|0))*4294967296|0}for(var A=2,M=0;M<64;)N(A)&&(M<8&&(_[M]=O(s.pow(A,1/2))),S[M]=O(s.pow(A,1/3)),M++),A++})();var T=[],R=g.SHA256=m.extend({_doReset:function(){this._hash=new p.init(_.slice(0))},_doProcessBlock:function(N,O){for(var A=this._hash.words,M=A[0],x=A[1],P=A[2],D=A[3],F=A[4],j=A[5],B=A[6],H=A[7],K=0;K<64;K++){if(K<16)T[K]=N[O+K]|0;else{var J=T[K-15],q=(J<<25|J>>>7)^(J<<14|J>>>18)^J>>>3,Q=T[K-2],ee=(Q<<15|Q>>>17)^(Q<<13|Q>>>19)^Q>>>10;T[K]=q+T[K-7]+ee+T[K-16]}var ne=F&j^~F&B,he=M&x^M&P^x&P,pe=(M<<30|M>>>2)^(M<<19|M>>>13)^(M<<10|M>>>22),ce=(F<<26|F>>>6)^(F<<21|F>>>11)^(F<<7|F>>>25),se=H+ce+ne+S[K]+T[K],ae=pe+he;H=B,B=j,j=F,F=D+se|0,D=P,P=x,x=M,M=se+ae|0}A[0]=A[0]+M|0,A[1]=A[1]+x|0,A[2]=A[2]+P|0,A[3]=A[3]+D|0,A[4]=A[4]+F|0,A[5]=A[5]+j|0,A[6]=A[6]+B|0,A[7]=A[7]+H|0},_doFinalize:function(){var N=this._data,O=N.words,A=this._nDataBytes*8,M=N.sigBytes*8;return O[M>>>5]|=128<<24-M%32,O[(M+64>>>9<<4)+14]=s.floor(A/4294967296),O[(M+64>>>9<<4)+15]=A,N.sigBytes=O.length*4,this._process(),this._hash},clone:function(){var N=m.clone.call(this);return N._hash=this._hash.clone(),N}});c.SHA256=m._createHelper(R),c.HmacSHA256=m._createHmacHelper(R)}(Math),o.SHA256})}(j1)),j1.exports}var V1={exports:{}},gB;function LSe(){return gB||(gB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Ax())})(Dt,function(o){return function(){var s=o,c=s.lib,d=c.WordArray,p=s.algo,m=p.SHA256,g=p.SHA224=m.extend({_doReset:function(){this._hash=new d.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var _=m._doFinalize.call(this);return _.sigBytes-=4,_}});s.SHA224=m._createHelper(g),s.HmacSHA224=m._createHmacHelper(g)}(),o.SHA224})}(V1)),V1.exports}var $1={exports:{}},vB;function $9(){return vB||(vB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),AS())})(Dt,function(o){return function(){var s=o,c=s.lib,d=c.Hasher,p=s.x64,m=p.Word,g=p.WordArray,_=s.algo;function S(){return m.create.apply(m,arguments)}var T=[S(1116352408,3609767458),S(1899447441,602891725),S(3049323471,3964484399),S(3921009573,2173295548),S(961987163,4081628472),S(1508970993,3053834265),S(2453635748,2937671579),S(2870763221,3664609560),S(3624381080,2734883394),S(310598401,1164996542),S(607225278,1323610764),S(1426881987,3590304994),S(1925078388,4068182383),S(2162078206,991336113),S(2614888103,633803317),S(3248222580,3479774868),S(3835390401,2666613458),S(4022224774,944711139),S(264347078,2341262773),S(604807628,2007800933),S(770255983,1495990901),S(1249150122,1856431235),S(1555081692,3175218132),S(1996064986,2198950837),S(2554220882,3999719339),S(2821834349,766784016),S(2952996808,2566594879),S(3210313671,3203337956),S(3336571891,1034457026),S(3584528711,2466948901),S(113926993,3758326383),S(338241895,168717936),S(666307205,1188179964),S(773529912,1546045734),S(1294757372,1522805485),S(1396182291,2643833823),S(1695183700,2343527390),S(1986661051,1014477480),S(2177026350,1206759142),S(2456956037,344077627),S(2730485921,1290863460),S(2820302411,3158454273),S(3259730800,3505952657),S(3345764771,106217008),S(3516065817,3606008344),S(3600352804,1432725776),S(4094571909,1467031594),S(275423344,851169720),S(430227734,3100823752),S(506948616,1363258195),S(659060556,3750685593),S(883997877,3785050280),S(958139571,3318307427),S(1322822218,3812723403),S(1537002063,2003034995),S(1747873779,3602036899),S(1955562222,1575990012),S(2024104815,1125592928),S(2227730452,2716904306),S(2361852424,442776044),S(2428436474,593698344),S(2756734187,3733110249),S(3204031479,2999351573),S(3329325298,3815920427),S(3391569614,3928383900),S(3515267271,566280711),S(3940187606,3454069534),S(4118630271,4000239992),S(116418474,1914138554),S(174292421,2731055270),S(289380356,3203993006),S(460393269,320620315),S(685471733,587496836),S(852142971,1086792851),S(1017036298,365543100),S(1126000580,2618297676),S(1288033470,3409855158),S(1501505948,4234509866),S(1607167915,987167468),S(1816402316,1246189591)],R=[];(function(){for(var O=0;O<80;O++)R[O]=S()})();var N=_.SHA512=d.extend({_doReset:function(){this._hash=new g.init([new m.init(1779033703,4089235720),new m.init(3144134277,2227873595),new m.init(1013904242,4271175723),new m.init(2773480762,1595750129),new m.init(1359893119,2917565137),new m.init(2600822924,725511199),new m.init(528734635,4215389547),new m.init(1541459225,327033209)])},_doProcessBlock:function(O,A){for(var M=this._hash.words,x=M[0],P=M[1],D=M[2],F=M[3],j=M[4],B=M[5],H=M[6],K=M[7],J=x.high,q=x.low,Q=P.high,ee=P.low,ne=D.high,he=D.low,pe=F.high,ce=F.low,se=j.high,ae=j.low,Ee=B.high,ve=B.low,le=H.high,de=H.low,ye=K.high,fe=K.low,ke=J,Me=q,Ve=Q,je=ee,dt=ne,ut=he,Ct=pe,_t=ce,Tt=se,it=ae,kt=Ee,qt=ve,xt=le,ze=de,ct=ye,et=fe,tt=0;tt<80;tt++){var mt,Ot,Ht=R[tt];if(tt<16)Ot=Ht.high=O[A+tt*2]|0,mt=Ht.low=O[A+tt*2+1]|0;else{var hn=R[tt-15],Lt=hn.high,br=hn.low,Xt=(Lt>>>1|br<<31)^(Lt>>>8|br<<24)^Lt>>>7,In=(br>>>1|Lt<<31)^(br>>>8|Lt<<24)^(br>>>7|Lt<<25),Hr=R[tt-2],sn=Hr.high,Dr=Hr.low,Qn=(sn>>>19|Dr<<13)^(sn<<3|Dr>>>29)^sn>>>6,Ut=(Dr>>>19|sn<<13)^(Dr<<3|sn>>>29)^(Dr>>>6|sn<<26),Jt=R[tt-7],ai=Jt.high,Gn=Jt.low,kr=R[tt-16],Tr=kr.high,nt=kr.low;mt=In+Gn,Ot=Xt+ai+(mt>>>0<In>>>0?1:0),mt=mt+Ut,Ot=Ot+Qn+(mt>>>0<Ut>>>0?1:0),mt=mt+nt,Ot=Ot+Tr+(mt>>>0<nt>>>0?1:0),Ht.high=Ot,Ht.low=mt}var yt=Tt&kt^~Tt&xt,En=it&qt^~it&ze,Qt=ke&Ve^ke&dt^Ve&dt,tn=Me&je^Me&ut^je&ut,Wr=(ke>>>28|Me<<4)^(ke<<30|Me>>>2)^(ke<<25|Me>>>7),_n=(Me>>>28|ke<<4)^(Me<<30|ke>>>2)^(Me<<25|ke>>>7),jt=(Tt>>>14|it<<18)^(Tt>>>18|it<<14)^(Tt<<23|it>>>9),pn=(it>>>14|Tt<<18)^(it>>>18|Tt<<14)^(it<<23|Tt>>>9),Pn=T[tt],Vn=Pn.high,Jr=Pn.low,Qr=et+pn,gn=ct+jt+(Qr>>>0<et>>>0?1:0),Qr=Qr+En,gn=gn+yt+(Qr>>>0<En>>>0?1:0),Qr=Qr+Jr,gn=gn+Vn+(Qr>>>0<Jr>>>0?1:0),Qr=Qr+mt,gn=gn+Ot+(Qr>>>0<mt>>>0?1:0),Ni=_n+tn,Pi=Wr+Qt+(Ni>>>0<_n>>>0?1:0);ct=xt,et=ze,xt=kt,ze=qt,kt=Tt,qt=it,it=_t+Qr|0,Tt=Ct+gn+(it>>>0<_t>>>0?1:0)|0,Ct=dt,_t=ut,dt=Ve,ut=je,Ve=ke,je=Me,Me=Qr+Ni|0,ke=gn+Pi+(Me>>>0<Qr>>>0?1:0)|0}q=x.low=q+Me,x.high=J+ke+(q>>>0<Me>>>0?1:0),ee=P.low=ee+je,P.high=Q+Ve+(ee>>>0<je>>>0?1:0),he=D.low=he+ut,D.high=ne+dt+(he>>>0<ut>>>0?1:0),ce=F.low=ce+_t,F.high=pe+Ct+(ce>>>0<_t>>>0?1:0),ae=j.low=ae+it,j.high=se+Tt+(ae>>>0<it>>>0?1:0),ve=B.low=ve+qt,B.high=Ee+kt+(ve>>>0<qt>>>0?1:0),de=H.low=de+ze,H.high=le+xt+(de>>>0<ze>>>0?1:0),fe=K.low=fe+et,K.high=ye+ct+(fe>>>0<et>>>0?1:0)},_doFinalize:function(){var O=this._data,A=O.words,M=this._nDataBytes*8,x=O.sigBytes*8;A[x>>>5]|=128<<24-x%32,A[(x+128>>>10<<5)+30]=Math.floor(M/4294967296),A[(x+128>>>10<<5)+31]=M,O.sigBytes=A.length*4,this._process();var P=this._hash.toX32();return P},clone:function(){var O=d.clone.call(this);return O._hash=this._hash.clone(),O},blockSize:1024/32});s.SHA512=d._createHelper(N),s.HmacSHA512=d._createHmacHelper(N)}(),o.SHA512})}($1)),$1.exports}var H1={exports:{}},EB;function MSe(){return EB||(EB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),AS(),$9())})(Dt,function(o){return function(){var s=o,c=s.x64,d=c.Word,p=c.WordArray,m=s.algo,g=m.SHA512,_=m.SHA384=g.extend({_doReset:function(){this._hash=new p.init([new d.init(3418070365,3238371032),new d.init(1654270250,914150663),new d.init(2438529370,812702999),new d.init(355462360,4144912697),new d.init(1731405415,4290775857),new d.init(2394180231,1750603025),new d.init(3675008525,1694076839),new d.init(1203062813,3204075428)])},_doFinalize:function(){var S=g._doFinalize.call(this);return S.sigBytes-=16,S}});s.SHA384=g._createHelper(_),s.HmacSHA384=g._createHmacHelper(_)}(),o.SHA384})}(H1)),H1.exports}var W1={exports:{}},_B;function FSe(){return _B||(_B=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),AS())})(Dt,function(o){return function(s){var c=o,d=c.lib,p=d.WordArray,m=d.Hasher,g=c.x64,_=g.Word,S=c.algo,T=[],R=[],N=[];(function(){for(var M=1,x=0,P=0;P<24;P++){T[M+5*x]=(P+1)*(P+2)/2%64;var D=x%5,F=(2*M+3*x)%5;M=D,x=F}for(var M=0;M<5;M++)for(var x=0;x<5;x++)R[M+5*x]=x+(2*M+3*x)%5*5;for(var j=1,B=0;B<24;B++){for(var H=0,K=0,J=0;J<7;J++){if(j&1){var q=(1<<J)-1;q<32?K^=1<<q:H^=1<<q-32}j&128?j=j<<1^113:j<<=1}N[B]=_.create(H,K)}})();var O=[];(function(){for(var M=0;M<25;M++)O[M]=_.create()})();var A=S.SHA3=m.extend({cfg:m.cfg.extend({outputLength:512}),_doReset:function(){for(var M=this._state=[],x=0;x<25;x++)M[x]=new _.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(M,x){for(var P=this._state,D=this.blockSize/2,F=0;F<D;F++){var j=M[x+2*F],B=M[x+2*F+1];j=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360,B=(B<<8|B>>>24)&16711935|(B<<24|B>>>8)&4278255360;var H=P[F];H.high^=B,H.low^=j}for(var K=0;K<24;K++){for(var J=0;J<5;J++){for(var q=0,Q=0,ee=0;ee<5;ee++){var H=P[J+5*ee];q^=H.high,Q^=H.low}var ne=O[J];ne.high=q,ne.low=Q}for(var J=0;J<5;J++)for(var he=O[(J+4)%5],pe=O[(J+1)%5],ce=pe.high,se=pe.low,q=he.high^(ce<<1|se>>>31),Q=he.low^(se<<1|ce>>>31),ee=0;ee<5;ee++){var H=P[J+5*ee];H.high^=q,H.low^=Q}for(var ae=1;ae<25;ae++){var q,Q,H=P[ae],Ee=H.high,ve=H.low,le=T[ae];le<32?(q=Ee<<le|ve>>>32-le,Q=ve<<le|Ee>>>32-le):(q=ve<<le-32|Ee>>>64-le,Q=Ee<<le-32|ve>>>64-le);var de=O[R[ae]];de.high=q,de.low=Q}var ye=O[0],fe=P[0];ye.high=fe.high,ye.low=fe.low;for(var J=0;J<5;J++)for(var ee=0;ee<5;ee++){var ae=J+5*ee,H=P[ae],ke=O[ae],Me=O[(J+1)%5+5*ee],Ve=O[(J+2)%5+5*ee];H.high=ke.high^~Me.high&Ve.high,H.low=ke.low^~Me.low&Ve.low}var H=P[0],je=N[K];H.high^=je.high,H.low^=je.low}},_doFinalize:function(){var M=this._data,x=M.words;this._nDataBytes*8;var P=M.sigBytes*8,D=this.blockSize*32;x[P>>>5]|=1<<24-P%32,x[(s.ceil((P+1)/D)*D>>>5)-1]|=128,M.sigBytes=x.length*4,this._process();for(var F=this._state,j=this.cfg.outputLength/8,B=j/8,H=[],K=0;K<B;K++){var J=F[K],q=J.high,Q=J.low;q=(q<<8|q>>>24)&16711935|(q<<24|q>>>8)&4278255360,Q=(Q<<8|Q>>>24)&16711935|(Q<<24|Q>>>8)&4278255360,H.push(Q),H.push(q)}return new p.init(H,j)},clone:function(){for(var M=m.clone.call(this),x=M._state=this._state.slice(0),P=0;P<25;P++)x[P]=x[P].clone();return M}});c.SHA3=m._createHelper(A),c.HmacSHA3=m._createHmacHelper(A)}(Math),o.SHA3})}(W1)),W1.exports}var z1={exports:{}},yB;function USe(){return yB||(yB=1,function(e,n){(function(o,s){e.exports=s(Nn())})(Dt,function(o){/** @preserve
			(c) 2012 by Cdric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(s){var c=o,d=c.lib,p=d.WordArray,m=d.Hasher,g=c.algo,_=p.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),S=p.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),T=p.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),R=p.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),N=p.create([0,1518500249,1859775393,2400959708,2840853838]),O=p.create([1352829926,1548603684,1836072691,2053994217,0]),A=g.RIPEMD160=m.extend({_doReset:function(){this._hash=p.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(B,H){for(var K=0;K<16;K++){var J=H+K,q=B[J];B[J]=(q<<8|q>>>24)&16711935|(q<<24|q>>>8)&4278255360}var Q=this._hash.words,ee=N.words,ne=O.words,he=_.words,pe=S.words,ce=T.words,se=R.words,ae,Ee,ve,le,de,ye,fe,ke,Me,Ve;ye=ae=Q[0],fe=Ee=Q[1],ke=ve=Q[2],Me=le=Q[3],Ve=de=Q[4];for(var je,K=0;K<80;K+=1)je=ae+B[H+he[K]]|0,K<16?je+=M(Ee,ve,le)+ee[0]:K<32?je+=x(Ee,ve,le)+ee[1]:K<48?je+=P(Ee,ve,le)+ee[2]:K<64?je+=D(Ee,ve,le)+ee[3]:je+=F(Ee,ve,le)+ee[4],je=je|0,je=j(je,ce[K]),je=je+de|0,ae=de,de=le,le=j(ve,10),ve=Ee,Ee=je,je=ye+B[H+pe[K]]|0,K<16?je+=F(fe,ke,Me)+ne[0]:K<32?je+=D(fe,ke,Me)+ne[1]:K<48?je+=P(fe,ke,Me)+ne[2]:K<64?je+=x(fe,ke,Me)+ne[3]:je+=M(fe,ke,Me)+ne[4],je=je|0,je=j(je,se[K]),je=je+Ve|0,ye=Ve,Ve=Me,Me=j(ke,10),ke=fe,fe=je;je=Q[1]+ve+Me|0,Q[1]=Q[2]+le+Ve|0,Q[2]=Q[3]+de+ye|0,Q[3]=Q[4]+ae+fe|0,Q[4]=Q[0]+Ee+ke|0,Q[0]=je},_doFinalize:function(){var B=this._data,H=B.words,K=this._nDataBytes*8,J=B.sigBytes*8;H[J>>>5]|=128<<24-J%32,H[(J+64>>>9<<4)+14]=(K<<8|K>>>24)&16711935|(K<<24|K>>>8)&4278255360,B.sigBytes=(H.length+1)*4,this._process();for(var q=this._hash,Q=q.words,ee=0;ee<5;ee++){var ne=Q[ee];Q[ee]=(ne<<8|ne>>>24)&16711935|(ne<<24|ne>>>8)&4278255360}return q},clone:function(){var B=m.clone.call(this);return B._hash=this._hash.clone(),B}});function M(B,H,K){return B^H^K}function x(B,H,K){return B&H|~B&K}function P(B,H,K){return(B|~H)^K}function D(B,H,K){return B&K|H&~K}function F(B,H,K){return B^(H|~K)}function j(B,H){return B<<H|B>>>32-H}c.RIPEMD160=m._createHelper(A),c.HmacRIPEMD160=m._createHmacHelper(A)}(),o.RIPEMD160})}(z1)),z1.exports}var G1={exports:{}},SB;function Ox(){return SB||(SB=1,function(e,n){(function(o,s){e.exports=s(Nn())})(Dt,function(o){(function(){var s=o,c=s.lib,d=c.Base,p=s.enc,m=p.Utf8,g=s.algo;g.HMAC=d.extend({init:function(_,S){_=this._hasher=new _.init,typeof S=="string"&&(S=m.parse(S));var T=_.blockSize,R=T*4;S.sigBytes>R&&(S=_.finalize(S)),S.clamp();for(var N=this._oKey=S.clone(),O=this._iKey=S.clone(),A=N.words,M=O.words,x=0;x<T;x++)A[x]^=1549556828,M[x]^=909522486;N.sigBytes=O.sigBytes=R,this.reset()},reset:function(){var _=this._hasher;_.reset(),_.update(this._iKey)},update:function(_){return this._hasher.update(_),this},finalize:function(_){var S=this._hasher,T=S.finalize(_);S.reset();var R=S.finalize(this._oKey.clone().concat(T));return R}})})()})}(G1)),G1.exports}var K1={exports:{}},CB;function BSe(){return CB||(CB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Ax(),Ox())})(Dt,function(o){return function(){var s=o,c=s.lib,d=c.Base,p=c.WordArray,m=s.algo,g=m.SHA256,_=m.HMAC,S=m.PBKDF2=d.extend({cfg:d.extend({keySize:128/32,hasher:g,iterations:25e4}),init:function(T){this.cfg=this.cfg.extend(T)},compute:function(T,R){for(var N=this.cfg,O=_.create(N.hasher,T),A=p.create(),M=p.create([1]),x=A.words,P=M.words,D=N.keySize,F=N.iterations;x.length<D;){var j=O.update(R).finalize(M);O.reset();for(var B=j.words,H=B.length,K=j,J=1;J<F;J++){K=O.finalize(K),O.reset();for(var q=K.words,Q=0;Q<H;Q++)B[Q]^=q[Q]}A.concat(j),P[0]++}return A.sigBytes=D*4,A}});s.PBKDF2=function(T,R,N){return S.create(N).compute(T,R)}}(),o.PBKDF2})}(K1)),K1.exports}var q1={exports:{}},bB;function Lu(){return bB||(bB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),V9(),Ox())})(Dt,function(o){return function(){var s=o,c=s.lib,d=c.Base,p=c.WordArray,m=s.algo,g=m.MD5,_=m.EvpKDF=d.extend({cfg:d.extend({keySize:128/32,hasher:g,iterations:1}),init:function(S){this.cfg=this.cfg.extend(S)},compute:function(S,T){for(var R,N=this.cfg,O=N.hasher.create(),A=p.create(),M=A.words,x=N.keySize,P=N.iterations;M.length<x;){R&&O.update(R),R=O.update(S).finalize(T),O.reset();for(var D=1;D<P;D++)R=O.finalize(R),O.reset();A.concat(R)}return A.sigBytes=x*4,A}});s.EvpKDF=function(S,T,R){return _.create(R).compute(S,T)}}(),o.EvpKDF})}(q1)),q1.exports}var Y1={exports:{}},TB;function Yi(){return TB||(TB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Lu())})(Dt,function(o){o.lib.Cipher||function(s){var c=o,d=c.lib,p=d.Base,m=d.WordArray,g=d.BufferedBlockAlgorithm,_=c.enc;_.Utf8;var S=_.Base64,T=c.algo,R=T.EvpKDF,N=d.Cipher=g.extend({cfg:p.extend(),createEncryptor:function(q,Q){return this.create(this._ENC_XFORM_MODE,q,Q)},createDecryptor:function(q,Q){return this.create(this._DEC_XFORM_MODE,q,Q)},init:function(q,Q,ee){this.cfg=this.cfg.extend(ee),this._xformMode=q,this._key=Q,this.reset()},reset:function(){g.reset.call(this),this._doReset()},process:function(q){return this._append(q),this._process()},finalize:function(q){q&&this._append(q);var Q=this._doFinalize();return Q},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function q(Q){return typeof Q=="string"?J:B}return function(Q){return{encrypt:function(ee,ne,he){return q(ne).encrypt(Q,ee,ne,he)},decrypt:function(ee,ne,he){return q(ne).decrypt(Q,ee,ne,he)}}}}()});d.StreamCipher=N.extend({_doFinalize:function(){var q=this._process(!0);return q},blockSize:1});var O=c.mode={},A=d.BlockCipherMode=p.extend({createEncryptor:function(q,Q){return this.Encryptor.create(q,Q)},createDecryptor:function(q,Q){return this.Decryptor.create(q,Q)},init:function(q,Q){this._cipher=q,this._iv=Q}}),M=O.CBC=function(){var q=A.extend();q.Encryptor=q.extend({processBlock:function(ee,ne){var he=this._cipher,pe=he.blockSize;Q.call(this,ee,ne,pe),he.encryptBlock(ee,ne),this._prevBlock=ee.slice(ne,ne+pe)}}),q.Decryptor=q.extend({processBlock:function(ee,ne){var he=this._cipher,pe=he.blockSize,ce=ee.slice(ne,ne+pe);he.decryptBlock(ee,ne),Q.call(this,ee,ne,pe),this._prevBlock=ce}});function Q(ee,ne,he){var pe,ce=this._iv;ce?(pe=ce,this._iv=s):pe=this._prevBlock;for(var se=0;se<he;se++)ee[ne+se]^=pe[se]}return q}(),x=c.pad={},P=x.Pkcs7={pad:function(q,Q){for(var ee=Q*4,ne=ee-q.sigBytes%ee,he=ne<<24|ne<<16|ne<<8|ne,pe=[],ce=0;ce<ne;ce+=4)pe.push(he);var se=m.create(pe,ne);q.concat(se)},unpad:function(q){var Q=q.words[q.sigBytes-1>>>2]&255;q.sigBytes-=Q}};d.BlockCipher=N.extend({cfg:N.cfg.extend({mode:M,padding:P}),reset:function(){var q;N.reset.call(this);var Q=this.cfg,ee=Q.iv,ne=Q.mode;this._xformMode==this._ENC_XFORM_MODE?q=ne.createEncryptor:(q=ne.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==q?this._mode.init(this,ee&&ee.words):(this._mode=q.call(ne,this,ee&&ee.words),this._mode.__creator=q)},_doProcessBlock:function(q,Q){this._mode.processBlock(q,Q)},_doFinalize:function(){var q,Q=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(Q.pad(this._data,this.blockSize),q=this._process(!0)):(q=this._process(!0),Q.unpad(q)),q},blockSize:128/32});var D=d.CipherParams=p.extend({init:function(q){this.mixIn(q)},toString:function(q){return(q||this.formatter).stringify(this)}}),F=c.format={},j=F.OpenSSL={stringify:function(q){var Q,ee=q.ciphertext,ne=q.salt;return ne?Q=m.create([1398893684,1701076831]).concat(ne).concat(ee):Q=ee,Q.toString(S)},parse:function(q){var Q,ee=S.parse(q),ne=ee.words;return ne[0]==1398893684&&ne[1]==1701076831&&(Q=m.create(ne.slice(2,4)),ne.splice(0,4),ee.sigBytes-=16),D.create({ciphertext:ee,salt:Q})}},B=d.SerializableCipher=p.extend({cfg:p.extend({format:j}),encrypt:function(q,Q,ee,ne){ne=this.cfg.extend(ne);var he=q.createEncryptor(ee,ne),pe=he.finalize(Q),ce=he.cfg;return D.create({ciphertext:pe,key:ee,iv:ce.iv,algorithm:q,mode:ce.mode,padding:ce.padding,blockSize:q.blockSize,formatter:ne.format})},decrypt:function(q,Q,ee,ne){ne=this.cfg.extend(ne),Q=this._parse(Q,ne.format);var he=q.createDecryptor(ee,ne).finalize(Q.ciphertext);return he},_parse:function(q,Q){return typeof q=="string"?Q.parse(q,this):q}}),H=c.kdf={},K=H.OpenSSL={execute:function(q,Q,ee,ne,he){if(ne||(ne=m.random(64/8)),he)var pe=R.create({keySize:Q+ee,hasher:he}).compute(q,ne);else var pe=R.create({keySize:Q+ee}).compute(q,ne);var ce=m.create(pe.words.slice(Q),ee*4);return pe.sigBytes=Q*4,D.create({key:pe,iv:ce,salt:ne})}},J=d.PasswordBasedCipher=B.extend({cfg:B.cfg.extend({kdf:K}),encrypt:function(q,Q,ee,ne){ne=this.cfg.extend(ne);var he=ne.kdf.execute(ee,q.keySize,q.ivSize,ne.salt,ne.hasher);ne.iv=he.iv;var pe=B.encrypt.call(this,q,Q,he.key,ne);return pe.mixIn(he),pe},decrypt:function(q,Q,ee,ne){ne=this.cfg.extend(ne),Q=this._parse(Q,ne.format);var he=ne.kdf.execute(ee,q.keySize,q.ivSize,Q.salt,ne.hasher);ne.iv=he.iv;var pe=B.decrypt.call(this,q,Q,he.key,ne);return pe}})}()})}(Y1)),Y1.exports}var X1={exports:{}},RB;function jSe(){return RB||(RB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Yi())})(Dt,function(o){return o.mode.CFB=function(){var s=o.lib.BlockCipherMode.extend();s.Encryptor=s.extend({processBlock:function(d,p){var m=this._cipher,g=m.blockSize;c.call(this,d,p,g,m),this._prevBlock=d.slice(p,p+g)}}),s.Decryptor=s.extend({processBlock:function(d,p){var m=this._cipher,g=m.blockSize,_=d.slice(p,p+g);c.call(this,d,p,g,m),this._prevBlock=_}});function c(d,p,m,g){var _,S=this._iv;S?(_=S.slice(0),this._iv=void 0):_=this._prevBlock,g.encryptBlock(_,0);for(var T=0;T<m;T++)d[p+T]^=_[T]}return s}(),o.mode.CFB})}(X1)),X1.exports}var J1={exports:{}},wB;function VSe(){return wB||(wB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Yi())})(Dt,function(o){return o.mode.CTR=function(){var s=o.lib.BlockCipherMode.extend(),c=s.Encryptor=s.extend({processBlock:function(d,p){var m=this._cipher,g=m.blockSize,_=this._iv,S=this._counter;_&&(S=this._counter=_.slice(0),this._iv=void 0);var T=S.slice(0);m.encryptBlock(T,0),S[g-1]=S[g-1]+1|0;for(var R=0;R<g;R++)d[p+R]^=T[R]}});return s.Decryptor=c,s}(),o.mode.CTR})}(J1)),J1.exports}var Q1={exports:{}},IB;function $Se(){return IB||(IB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Yi())})(Dt,function(o){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return o.mode.CTRGladman=function(){var s=o.lib.BlockCipherMode.extend();function c(m){if((m>>24&255)===255){var g=m>>16&255,_=m>>8&255,S=m&255;g===255?(g=0,_===255?(_=0,S===255?S=0:++S):++_):++g,m=0,m+=g<<16,m+=_<<8,m+=S}else m+=1<<24;return m}function d(m){return(m[0]=c(m[0]))===0&&(m[1]=c(m[1])),m}var p=s.Encryptor=s.extend({processBlock:function(m,g){var _=this._cipher,S=_.blockSize,T=this._iv,R=this._counter;T&&(R=this._counter=T.slice(0),this._iv=void 0),d(R);var N=R.slice(0);_.encryptBlock(N,0);for(var O=0;O<S;O++)m[g+O]^=N[O]}});return s.Decryptor=p,s}(),o.mode.CTRGladman})}(Q1)),Q1.exports}var Z1={exports:{}},AB;function HSe(){return AB||(AB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Yi())})(Dt,function(o){return o.mode.OFB=function(){var s=o.lib.BlockCipherMode.extend(),c=s.Encryptor=s.extend({processBlock:function(d,p){var m=this._cipher,g=m.blockSize,_=this._iv,S=this._keystream;_&&(S=this._keystream=_.slice(0),this._iv=void 0),m.encryptBlock(S,0);for(var T=0;T<g;T++)d[p+T]^=S[T]}});return s.Decryptor=c,s}(),o.mode.OFB})}(Z1)),Z1.exports}var ew={exports:{}},OB;function WSe(){return OB||(OB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Yi())})(Dt,function(o){return o.mode.ECB=function(){var s=o.lib.BlockCipherMode.extend();return s.Encryptor=s.extend({processBlock:function(c,d){this._cipher.encryptBlock(c,d)}}),s.Decryptor=s.extend({processBlock:function(c,d){this._cipher.decryptBlock(c,d)}}),s}(),o.mode.ECB})}(ew)),ew.exports}var tw={exports:{}},xB;function zSe(){return xB||(xB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Yi())})(Dt,function(o){return o.pad.AnsiX923={pad:function(s,c){var d=s.sigBytes,p=c*4,m=p-d%p,g=d+m-1;s.clamp(),s.words[g>>>2]|=m<<24-g%4*8,s.sigBytes+=m},unpad:function(s){var c=s.words[s.sigBytes-1>>>2]&255;s.sigBytes-=c}},o.pad.Ansix923})}(tw)),tw.exports}var nw={exports:{}},NB;function GSe(){return NB||(NB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Yi())})(Dt,function(o){return o.pad.Iso10126={pad:function(s,c){var d=c*4,p=d-s.sigBytes%d;s.concat(o.lib.WordArray.random(p-1)).concat(o.lib.WordArray.create([p<<24],1))},unpad:function(s){var c=s.words[s.sigBytes-1>>>2]&255;s.sigBytes-=c}},o.pad.Iso10126})}(nw)),nw.exports}var rw={exports:{}},PB;function KSe(){return PB||(PB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Yi())})(Dt,function(o){return o.pad.Iso97971={pad:function(s,c){s.concat(o.lib.WordArray.create([2147483648],1)),o.pad.ZeroPadding.pad(s,c)},unpad:function(s){o.pad.ZeroPadding.unpad(s),s.sigBytes--}},o.pad.Iso97971})}(rw)),rw.exports}var iw={exports:{}},DB;function qSe(){return DB||(DB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Yi())})(Dt,function(o){return o.pad.ZeroPadding={pad:function(s,c){var d=c*4;s.clamp(),s.sigBytes+=d-(s.sigBytes%d||d)},unpad:function(s){for(var c=s.words,d=s.sigBytes-1,d=s.sigBytes-1;d>=0;d--)if(c[d>>>2]>>>24-d%4*8&255){s.sigBytes=d+1;break}}},o.pad.ZeroPadding})}(iw)),iw.exports}var ow={exports:{}},kB;function YSe(){return kB||(kB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Yi())})(Dt,function(o){return o.pad.NoPadding={pad:function(){},unpad:function(){}},o.pad.NoPadding})}(ow)),ow.exports}var aw={exports:{}},LB;function XSe(){return LB||(LB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Yi())})(Dt,function(o){return function(s){var c=o,d=c.lib,p=d.CipherParams,m=c.enc,g=m.Hex,_=c.format;_.Hex={stringify:function(S){return S.ciphertext.toString(g)},parse:function(S){var T=g.parse(S);return p.create({ciphertext:T})}}}(),o.format.Hex})}(aw)),aw.exports}var sw={exports:{}},MB;function JSe(){return MB||(MB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Jd(),Qd(),Lu(),Yi())})(Dt,function(o){return function(){var s=o,c=s.lib,d=c.BlockCipher,p=s.algo,m=[],g=[],_=[],S=[],T=[],R=[],N=[],O=[],A=[],M=[];(function(){for(var D=[],F=0;F<256;F++)F<128?D[F]=F<<1:D[F]=F<<1^283;for(var j=0,B=0,F=0;F<256;F++){var H=B^B<<1^B<<2^B<<3^B<<4;H=H>>>8^H&255^99,m[j]=H,g[H]=j;var K=D[j],J=D[K],q=D[J],Q=D[H]*257^H*16843008;_[j]=Q<<24|Q>>>8,S[j]=Q<<16|Q>>>16,T[j]=Q<<8|Q>>>24,R[j]=Q;var Q=q*16843009^J*65537^K*257^j*16843008;N[H]=Q<<24|Q>>>8,O[H]=Q<<16|Q>>>16,A[H]=Q<<8|Q>>>24,M[H]=Q,j?(j=K^D[D[D[q^K]]],B^=D[D[B]]):j=B=1}})();var x=[0,1,2,4,8,16,32,64,128,27,54],P=p.AES=d.extend({_doReset:function(){var D;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var F=this._keyPriorReset=this._key,j=F.words,B=F.sigBytes/4,H=this._nRounds=B+6,K=(H+1)*4,J=this._keySchedule=[],q=0;q<K;q++)q<B?J[q]=j[q]:(D=J[q-1],q%B?B>6&&q%B==4&&(D=m[D>>>24]<<24|m[D>>>16&255]<<16|m[D>>>8&255]<<8|m[D&255]):(D=D<<8|D>>>24,D=m[D>>>24]<<24|m[D>>>16&255]<<16|m[D>>>8&255]<<8|m[D&255],D^=x[q/B|0]<<24),J[q]=J[q-B]^D);for(var Q=this._invKeySchedule=[],ee=0;ee<K;ee++){var q=K-ee;if(ee%4)var D=J[q];else var D=J[q-4];ee<4||q<=4?Q[ee]=D:Q[ee]=N[m[D>>>24]]^O[m[D>>>16&255]]^A[m[D>>>8&255]]^M[m[D&255]]}}},encryptBlock:function(D,F){this._doCryptBlock(D,F,this._keySchedule,_,S,T,R,m)},decryptBlock:function(D,F){var j=D[F+1];D[F+1]=D[F+3],D[F+3]=j,this._doCryptBlock(D,F,this._invKeySchedule,N,O,A,M,g);var j=D[F+1];D[F+1]=D[F+3],D[F+3]=j},_doCryptBlock:function(D,F,j,B,H,K,J,q){for(var Q=this._nRounds,ee=D[F]^j[0],ne=D[F+1]^j[1],he=D[F+2]^j[2],pe=D[F+3]^j[3],ce=4,se=1;se<Q;se++){var ae=B[ee>>>24]^H[ne>>>16&255]^K[he>>>8&255]^J[pe&255]^j[ce++],Ee=B[ne>>>24]^H[he>>>16&255]^K[pe>>>8&255]^J[ee&255]^j[ce++],ve=B[he>>>24]^H[pe>>>16&255]^K[ee>>>8&255]^J[ne&255]^j[ce++],le=B[pe>>>24]^H[ee>>>16&255]^K[ne>>>8&255]^J[he&255]^j[ce++];ee=ae,ne=Ee,he=ve,pe=le}var ae=(q[ee>>>24]<<24|q[ne>>>16&255]<<16|q[he>>>8&255]<<8|q[pe&255])^j[ce++],Ee=(q[ne>>>24]<<24|q[he>>>16&255]<<16|q[pe>>>8&255]<<8|q[ee&255])^j[ce++],ve=(q[he>>>24]<<24|q[pe>>>16&255]<<16|q[ee>>>8&255]<<8|q[ne&255])^j[ce++],le=(q[pe>>>24]<<24|q[ee>>>16&255]<<16|q[ne>>>8&255]<<8|q[he&255])^j[ce++];D[F]=ae,D[F+1]=Ee,D[F+2]=ve,D[F+3]=le},keySize:256/32});s.AES=d._createHelper(P)}(),o.AES})}(sw)),sw.exports}var cw={exports:{}},FB;function QSe(){return FB||(FB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Jd(),Qd(),Lu(),Yi())})(Dt,function(o){return function(){var s=o,c=s.lib,d=c.WordArray,p=c.BlockCipher,m=s.algo,g=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],_=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],S=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],T=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],R=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],N=m.DES=p.extend({_doReset:function(){for(var x=this._key,P=x.words,D=[],F=0;F<56;F++){var j=g[F]-1;D[F]=P[j>>>5]>>>31-j%32&1}for(var B=this._subKeys=[],H=0;H<16;H++){for(var K=B[H]=[],J=S[H],F=0;F<24;F++)K[F/6|0]|=D[(_[F]-1+J)%28]<<31-F%6,K[4+(F/6|0)]|=D[28+(_[F+24]-1+J)%28]<<31-F%6;K[0]=K[0]<<1|K[0]>>>31;for(var F=1;F<7;F++)K[F]=K[F]>>>(F-1)*4+3;K[7]=K[7]<<5|K[7]>>>27}for(var q=this._invSubKeys=[],F=0;F<16;F++)q[F]=B[15-F]},encryptBlock:function(x,P){this._doCryptBlock(x,P,this._subKeys)},decryptBlock:function(x,P){this._doCryptBlock(x,P,this._invSubKeys)},_doCryptBlock:function(x,P,D){this._lBlock=x[P],this._rBlock=x[P+1],O.call(this,4,252645135),O.call(this,16,65535),A.call(this,2,858993459),A.call(this,8,16711935),O.call(this,1,1431655765);for(var F=0;F<16;F++){for(var j=D[F],B=this._lBlock,H=this._rBlock,K=0,J=0;J<8;J++)K|=T[J][((H^j[J])&R[J])>>>0];this._lBlock=H,this._rBlock=B^K}var q=this._lBlock;this._lBlock=this._rBlock,this._rBlock=q,O.call(this,1,1431655765),A.call(this,8,16711935),A.call(this,2,858993459),O.call(this,16,65535),O.call(this,4,252645135),x[P]=this._lBlock,x[P+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function O(x,P){var D=(this._lBlock>>>x^this._rBlock)&P;this._rBlock^=D,this._lBlock^=D<<x}function A(x,P){var D=(this._rBlock>>>x^this._lBlock)&P;this._lBlock^=D,this._rBlock^=D<<x}s.DES=p._createHelper(N);var M=m.TripleDES=p.extend({_doReset:function(){var x=this._key,P=x.words;if(P.length!==2&&P.length!==4&&P.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var D=P.slice(0,2),F=P.length<4?P.slice(0,2):P.slice(2,4),j=P.length<6?P.slice(0,2):P.slice(4,6);this._des1=N.createEncryptor(d.create(D)),this._des2=N.createEncryptor(d.create(F)),this._des3=N.createEncryptor(d.create(j))},encryptBlock:function(x,P){this._des1.encryptBlock(x,P),this._des2.decryptBlock(x,P),this._des3.encryptBlock(x,P)},decryptBlock:function(x,P){this._des3.decryptBlock(x,P),this._des2.encryptBlock(x,P),this._des1.decryptBlock(x,P)},keySize:192/32,ivSize:64/32,blockSize:64/32});s.TripleDES=p._createHelper(M)}(),o.TripleDES})}(cw)),cw.exports}var lw={exports:{}},UB;function ZSe(){return UB||(UB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Jd(),Qd(),Lu(),Yi())})(Dt,function(o){return function(){var s=o,c=s.lib,d=c.StreamCipher,p=s.algo,m=p.RC4=d.extend({_doReset:function(){for(var S=this._key,T=S.words,R=S.sigBytes,N=this._S=[],O=0;O<256;O++)N[O]=O;for(var O=0,A=0;O<256;O++){var M=O%R,x=T[M>>>2]>>>24-M%4*8&255;A=(A+N[O]+x)%256;var P=N[O];N[O]=N[A],N[A]=P}this._i=this._j=0},_doProcessBlock:function(S,T){S[T]^=g.call(this)},keySize:256/32,ivSize:0});function g(){for(var S=this._S,T=this._i,R=this._j,N=0,O=0;O<4;O++){T=(T+1)%256,R=(R+S[T])%256;var A=S[T];S[T]=S[R],S[R]=A,N|=S[(S[T]+S[R])%256]<<24-O*8}return this._i=T,this._j=R,N}s.RC4=d._createHelper(m);var _=p.RC4Drop=m.extend({cfg:m.cfg.extend({drop:192}),_doReset:function(){m._doReset.call(this);for(var S=this.cfg.drop;S>0;S--)g.call(this)}});s.RC4Drop=d._createHelper(_)}(),o.RC4})}(lw)),lw.exports}var uw={exports:{}},BB;function eCe(){return BB||(BB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Jd(),Qd(),Lu(),Yi())})(Dt,function(o){return function(){var s=o,c=s.lib,d=c.StreamCipher,p=s.algo,m=[],g=[],_=[],S=p.Rabbit=d.extend({_doReset:function(){for(var R=this._key.words,N=this.cfg.iv,O=0;O<4;O++)R[O]=(R[O]<<8|R[O]>>>24)&16711935|(R[O]<<24|R[O]>>>8)&4278255360;var A=this._X=[R[0],R[3]<<16|R[2]>>>16,R[1],R[0]<<16|R[3]>>>16,R[2],R[1]<<16|R[0]>>>16,R[3],R[2]<<16|R[1]>>>16],M=this._C=[R[2]<<16|R[2]>>>16,R[0]&4294901760|R[1]&65535,R[3]<<16|R[3]>>>16,R[1]&4294901760|R[2]&65535,R[0]<<16|R[0]>>>16,R[2]&4294901760|R[3]&65535,R[1]<<16|R[1]>>>16,R[3]&4294901760|R[0]&65535];this._b=0;for(var O=0;O<4;O++)T.call(this);for(var O=0;O<8;O++)M[O]^=A[O+4&7];if(N){var x=N.words,P=x[0],D=x[1],F=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360,j=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,B=F>>>16|j&4294901760,H=j<<16|F&65535;M[0]^=F,M[1]^=B,M[2]^=j,M[3]^=H,M[4]^=F,M[5]^=B,M[6]^=j,M[7]^=H;for(var O=0;O<4;O++)T.call(this)}},_doProcessBlock:function(R,N){var O=this._X;T.call(this),m[0]=O[0]^O[5]>>>16^O[3]<<16,m[1]=O[2]^O[7]>>>16^O[5]<<16,m[2]=O[4]^O[1]>>>16^O[7]<<16,m[3]=O[6]^O[3]>>>16^O[1]<<16;for(var A=0;A<4;A++)m[A]=(m[A]<<8|m[A]>>>24)&16711935|(m[A]<<24|m[A]>>>8)&4278255360,R[N+A]^=m[A]},blockSize:128/32,ivSize:64/32});function T(){for(var R=this._X,N=this._C,O=0;O<8;O++)g[O]=N[O];N[0]=N[0]+1295307597+this._b|0,N[1]=N[1]+3545052371+(N[0]>>>0<g[0]>>>0?1:0)|0,N[2]=N[2]+886263092+(N[1]>>>0<g[1]>>>0?1:0)|0,N[3]=N[3]+1295307597+(N[2]>>>0<g[2]>>>0?1:0)|0,N[4]=N[4]+3545052371+(N[3]>>>0<g[3]>>>0?1:0)|0,N[5]=N[5]+886263092+(N[4]>>>0<g[4]>>>0?1:0)|0,N[6]=N[6]+1295307597+(N[5]>>>0<g[5]>>>0?1:0)|0,N[7]=N[7]+3545052371+(N[6]>>>0<g[6]>>>0?1:0)|0,this._b=N[7]>>>0<g[7]>>>0?1:0;for(var O=0;O<8;O++){var A=R[O]+N[O],M=A&65535,x=A>>>16,P=((M*M>>>17)+M*x>>>15)+x*x,D=((A&4294901760)*A|0)+((A&65535)*A|0);_[O]=P^D}R[0]=_[0]+(_[7]<<16|_[7]>>>16)+(_[6]<<16|_[6]>>>16)|0,R[1]=_[1]+(_[0]<<8|_[0]>>>24)+_[7]|0,R[2]=_[2]+(_[1]<<16|_[1]>>>16)+(_[0]<<16|_[0]>>>16)|0,R[3]=_[3]+(_[2]<<8|_[2]>>>24)+_[1]|0,R[4]=_[4]+(_[3]<<16|_[3]>>>16)+(_[2]<<16|_[2]>>>16)|0,R[5]=_[5]+(_[4]<<8|_[4]>>>24)+_[3]|0,R[6]=_[6]+(_[5]<<16|_[5]>>>16)+(_[4]<<16|_[4]>>>16)|0,R[7]=_[7]+(_[6]<<8|_[6]>>>24)+_[5]|0}s.Rabbit=d._createHelper(S)}(),o.Rabbit})}(uw)),uw.exports}var dw={exports:{}},jB;function tCe(){return jB||(jB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Jd(),Qd(),Lu(),Yi())})(Dt,function(o){return function(){var s=o,c=s.lib,d=c.StreamCipher,p=s.algo,m=[],g=[],_=[],S=p.RabbitLegacy=d.extend({_doReset:function(){var R=this._key.words,N=this.cfg.iv,O=this._X=[R[0],R[3]<<16|R[2]>>>16,R[1],R[0]<<16|R[3]>>>16,R[2],R[1]<<16|R[0]>>>16,R[3],R[2]<<16|R[1]>>>16],A=this._C=[R[2]<<16|R[2]>>>16,R[0]&4294901760|R[1]&65535,R[3]<<16|R[3]>>>16,R[1]&4294901760|R[2]&65535,R[0]<<16|R[0]>>>16,R[2]&4294901760|R[3]&65535,R[1]<<16|R[1]>>>16,R[3]&4294901760|R[0]&65535];this._b=0;for(var M=0;M<4;M++)T.call(this);for(var M=0;M<8;M++)A[M]^=O[M+4&7];if(N){var x=N.words,P=x[0],D=x[1],F=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360,j=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,B=F>>>16|j&4294901760,H=j<<16|F&65535;A[0]^=F,A[1]^=B,A[2]^=j,A[3]^=H,A[4]^=F,A[5]^=B,A[6]^=j,A[7]^=H;for(var M=0;M<4;M++)T.call(this)}},_doProcessBlock:function(R,N){var O=this._X;T.call(this),m[0]=O[0]^O[5]>>>16^O[3]<<16,m[1]=O[2]^O[7]>>>16^O[5]<<16,m[2]=O[4]^O[1]>>>16^O[7]<<16,m[3]=O[6]^O[3]>>>16^O[1]<<16;for(var A=0;A<4;A++)m[A]=(m[A]<<8|m[A]>>>24)&16711935|(m[A]<<24|m[A]>>>8)&4278255360,R[N+A]^=m[A]},blockSize:128/32,ivSize:64/32});function T(){for(var R=this._X,N=this._C,O=0;O<8;O++)g[O]=N[O];N[0]=N[0]+1295307597+this._b|0,N[1]=N[1]+3545052371+(N[0]>>>0<g[0]>>>0?1:0)|0,N[2]=N[2]+886263092+(N[1]>>>0<g[1]>>>0?1:0)|0,N[3]=N[3]+1295307597+(N[2]>>>0<g[2]>>>0?1:0)|0,N[4]=N[4]+3545052371+(N[3]>>>0<g[3]>>>0?1:0)|0,N[5]=N[5]+886263092+(N[4]>>>0<g[4]>>>0?1:0)|0,N[6]=N[6]+1295307597+(N[5]>>>0<g[5]>>>0?1:0)|0,N[7]=N[7]+3545052371+(N[6]>>>0<g[6]>>>0?1:0)|0,this._b=N[7]>>>0<g[7]>>>0?1:0;for(var O=0;O<8;O++){var A=R[O]+N[O],M=A&65535,x=A>>>16,P=((M*M>>>17)+M*x>>>15)+x*x,D=((A&4294901760)*A|0)+((A&65535)*A|0);_[O]=P^D}R[0]=_[0]+(_[7]<<16|_[7]>>>16)+(_[6]<<16|_[6]>>>16)|0,R[1]=_[1]+(_[0]<<8|_[0]>>>24)+_[7]|0,R[2]=_[2]+(_[1]<<16|_[1]>>>16)+(_[0]<<16|_[0]>>>16)|0,R[3]=_[3]+(_[2]<<8|_[2]>>>24)+_[1]|0,R[4]=_[4]+(_[3]<<16|_[3]>>>16)+(_[2]<<16|_[2]>>>16)|0,R[5]=_[5]+(_[4]<<8|_[4]>>>24)+_[3]|0,R[6]=_[6]+(_[5]<<16|_[5]>>>16)+(_[4]<<16|_[4]>>>16)|0,R[7]=_[7]+(_[6]<<8|_[6]>>>24)+_[5]|0}s.RabbitLegacy=d._createHelper(S)}(),o.RabbitLegacy})}(dw)),dw.exports}var hw={exports:{}},VB;function nCe(){return VB||(VB=1,function(e,n){(function(o,s,c){e.exports=s(Nn(),Jd(),Qd(),Lu(),Yi())})(Dt,function(o){return function(){var s=o,c=s.lib,d=c.BlockCipher,p=s.algo;const m=16,g=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],_=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var S={pbox:[],sbox:[]};function T(M,x){let P=x>>24&255,D=x>>16&255,F=x>>8&255,j=x&255,B=M.sbox[0][P]+M.sbox[1][D];return B=B^M.sbox[2][F],B=B+M.sbox[3][j],B}function R(M,x,P){let D=x,F=P,j;for(let B=0;B<m;++B)D=D^M.pbox[B],F=T(M,D)^F,j=D,D=F,F=j;return j=D,D=F,F=j,F=F^M.pbox[m],D=D^M.pbox[m+1],{left:D,right:F}}function N(M,x,P){let D=x,F=P,j;for(let B=m+1;B>1;--B)D=D^M.pbox[B],F=T(M,D)^F,j=D,D=F,F=j;return j=D,D=F,F=j,F=F^M.pbox[1],D=D^M.pbox[0],{left:D,right:F}}function O(M,x,P){for(let H=0;H<4;H++){M.sbox[H]=[];for(let K=0;K<256;K++)M.sbox[H][K]=_[H][K]}let D=0;for(let H=0;H<m+2;H++)M.pbox[H]=g[H]^x[D],D++,D>=P&&(D=0);let F=0,j=0,B=0;for(let H=0;H<m+2;H+=2)B=R(M,F,j),F=B.left,j=B.right,M.pbox[H]=F,M.pbox[H+1]=j;for(let H=0;H<4;H++)for(let K=0;K<256;K+=2)B=R(M,F,j),F=B.left,j=B.right,M.sbox[H][K]=F,M.sbox[H][K+1]=j;return!0}var A=p.Blowfish=d.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var M=this._keyPriorReset=this._key,x=M.words,P=M.sigBytes/4;O(S,x,P)}},encryptBlock:function(M,x){var P=R(S,M[x],M[x+1]);M[x]=P.left,M[x+1]=P.right},decryptBlock:function(M,x){var P=N(S,M[x],M[x+1]);M[x]=P.left,M[x+1]=P.right},blockSize:64/32,keySize:128/32,ivSize:64/32});s.Blowfish=d._createHelper(A)}(),o.Blowfish})}(hw)),hw.exports}(function(e,n){(function(o,s,c){e.exports=s(Nn(),AS(),PSe(),DSe(),Jd(),kSe(),Qd(),V9(),Ax(),LSe(),$9(),MSe(),FSe(),USe(),Ox(),BSe(),Lu(),Yi(),jSe(),VSe(),$Se(),HSe(),WSe(),zSe(),GSe(),KSe(),qSe(),YSe(),XSe(),JSe(),QSe(),ZSe(),eCe(),tCe(),nCe())})(Dt,function(o){return o})})(j9);var rCe=j9.exports;const $B=yl(rCe);let H9="U2FsdGVkX1/nIO3//tPu/+LNS4S4tsxT3MzmKKuvXDxFFYxlol+eYrZkKcLoUBHMNoDedcuF62hF/qfPSSy59Q==";const iCe=10;{const e=$B.AES.decrypt("U2FsdGVkX1/nIO3//tPu/+LNS4S4tsxT3MzmKKuvXDxFFYxlol+eYrZkKcLoUBHMNoDedcuF62hF/qfPSSy59Q==","U2FsdGVkX1/fp5K6GAphzVxz");H9=JSON.parse(e.toString($B.enc.Utf8))}const ht={appId:H9,channel:{}.AGORA_CHANNEL||"test",token:{}.AGORA_TOKEN?{}.AGORA_TOKEN:null,ShareScreenUID:iCe};function oCe(){return[{channel:{}.AGORA_CHANNEL_0||"test0",token:{}.AGORA_TOKEN_0},{channel:{}.AGORA_CHANNEL_1||"test1",token:{}.AGORA_TOKEN_1},{channel:{}.AGORA_CHANNEL_2||"test2",token:{}.AGORA_TOKEN_2},{channel:{}.AGORA_CHANNEL_3||"test3",token:{}.AGORA_TOKEN_3},{channel:{}.AGORA_CHANNEL_4||"test4",token:{}.AGORA_TOKEN_4},{channel:{}.AGORA_CHANNEL_5||"test5",token:{}.AGORA_TOKEN_5},{channel:{}.AGORA_CHANNEL_6||"test6",token:{}.AGORA_TOKEN_6},{channel:{}.AGORA_CHANNEL_7||"test7",token:{}.AGORA_TOKEN_7},{channel:{}.AGORA_CHANNEL_8||"test8",token:{}.AGORA_TOKEN_8},{channel:{}.AGORA_CHANNEL_9||"test9",token:{}.AGORA_TOKEN_9}]}const rc=e=>{rB(String(e));const n=RSe();return rB(),n},Fc=()=>"https://www.agora.io/en/wp-content/uploads/2022/10/3d-spatial-audio-icon.svg";function OS({micOn:e,cameraOn:n,renderAction:o,renderLocalUser:s,renderRemoteUsers:c}){const d=Is(),p=TS()||0,m=b.useMemo(()=>rc(p),[p]),g=b.useMemo(()=>Fc(),[]),_=ac(),S=_.filter(O=>O.hasAudio||O.hasVideo),T=e||n,{localMicrophoneTrack:R}=hf(e),{localCameraTrack:N}=pf(n);return ku([R,N]),te.jsxs(te.Fragment,{children:[o?o():void 0,te.jsx(Sx,{published:S.length+(T?1:0),total:_.length+1}),te.jsxs(_s,{children:[d&&(s?s():te.jsx(_s.Item,{children:te.jsx(yx,{audioTrack:R,cameraOn:n,cover:g,micOn:e,videoTrack:N,children:te.jsx(_l,{children:`${m}{${p}}`})})})),c?c():void 0]})]})}const qE=({children:e,clientConfig:n={mode:"rtc",codec:"vp8"}})=>{const[o]=b.useState(()=>ul.createClient(n));return te.jsx(x9,{client:o,children:e})},_a=({calling:e,micOn:n,cameraOn:o,setMic:s,setCamera:c,setCalling:d})=>te.jsx(te.Fragment,{children:te.jsxs("div",{className:"inset-0 top-a flex justify-center items-center gap-3 px-6 py-3 bg-#21242c c-coolgray-3",children:[te.jsxs("div",{className:"flex-1 flex top-0 left-0 h-full items-center gap-3 px-6 py-3",children:[s&&te.jsx("button",{className:"btn",onClick:()=>s(),children:n?te.jsx(zye,{}):te.jsx(Gye,{})}),c&&te.jsx("button",{className:"btn",onClick:()=>c(),children:o?te.jsx(Kye,{}):te.jsx(qye,{})})]}),d&&te.jsx("button",{className:px("btn btn-phone",{"btn-phone-active":e}),onClick:()=>d(),children:e?te.jsx("i",{className:"i-mdi-phone-hangup"}):te.jsx("i",{className:"i-mdi-phone"})})]})}),aCe=({screenShareOn:e,screenTrack:n,onCloseScreenShare:o})=>{const[s]=b.useState(()=>ul.createClient({mode:"rtc",codec:"vp8"})),[c,d]=b.useState(null),[p,m]=b.useState(null);return xi({appid:ht.appId,channel:ht.channel,token:ht.token,uid:ht.ShareScreenUID},e,s),b.useEffect(()=>{n?Array.isArray(n)?(d(n.filter(g=>g.trackMediaType==="video")[0]),m(n.filter(g=>g.trackMediaType==="audio")[0])):d(n):(m(null),d(null))},[n]),ku([c,p],e,s),A9(c,"track-ended",()=>{console.log("screen sharing ended"),o&&o()}),te.jsxs(tSe,{client:s,children:[e&&c&&te.jsx(ag,{disabled:!e,play:e,style:{width:"300px",height:"300px"},track:c}),p&&te.jsx(RS,{disabled:!e,track:p})]})},HB=e=>{let n;const o=new Set,s=(g,_)=>{const S=typeof g=="function"?g(n):g;if(!Object.is(S,n)){const T=n;n=_??typeof S!="object"?S:Object.assign({},n,S),o.forEach(R=>R(n,T))}},c=()=>n,m={setState:s,getState:c,subscribe:g=>(o.add(g),()=>o.delete(g)),destroy:()=>{o.clear()}};return n=e(s,c,m),m},sCe=e=>e?HB(e):HB;var W9={exports:{}},z9={},G9={exports:{}},K9={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qp=b;function cCe(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var lCe=typeof Object.is=="function"?Object.is:cCe,uCe=qp.useState,dCe=qp.useEffect,hCe=qp.useLayoutEffect,pCe=qp.useDebugValue;function fCe(e,n){var o=n(),s=uCe({inst:{value:o,getSnapshot:n}}),c=s[0].inst,d=s[1];return hCe(function(){c.value=o,c.getSnapshot=n,pw(c)&&d({inst:c})},[e,o,n]),dCe(function(){return pw(c)&&d({inst:c}),e(function(){pw(c)&&d({inst:c})})},[e]),pCe(o),o}function pw(e){var n=e.getSnapshot;e=e.value;try{var o=n();return!lCe(e,o)}catch{return!0}}function mCe(e,n){return n()}var gCe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?mCe:fCe;K9.useSyncExternalStore=qp.useSyncExternalStore!==void 0?qp.useSyncExternalStore:gCe;G9.exports=K9;var vCe=G9.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xS=b,ECe=vCe;function _Ce(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var yCe=typeof Object.is=="function"?Object.is:_Ce,SCe=ECe.useSyncExternalStore,CCe=xS.useRef,bCe=xS.useEffect,TCe=xS.useMemo,RCe=xS.useDebugValue;z9.useSyncExternalStoreWithSelector=function(e,n,o,s,c){var d=CCe(null);if(d.current===null){var p={hasValue:!1,value:null};d.current=p}else p=d.current;d=TCe(function(){function g(N){if(!_){if(_=!0,S=N,N=s(N),c!==void 0&&p.hasValue){var O=p.value;if(c(O,N))return T=O}return T=N}if(O=T,yCe(S,N))return O;var A=s(N);return c!==void 0&&c(O,A)?O:(S=N,T=A)}var _=!1,S,T,R=o===void 0?null:o;return[function(){return g(n())},R===null?void 0:function(){return g(R())}]},[n,o,s,c]);var m=SCe(e,d[0],d[1]);return bCe(function(){p.hasValue=!0,p.value=m},[m]),RCe(m),m};W9.exports=z9;var wCe=W9.exports;const ICe=yl(wCe),{useSyncExternalStoreWithSelector:ACe}=ICe;function OCe(e,n=e.getState,o){const s=ACe(e.subscribe,e.getState,e.getServerState||e.getState,n,o);return b.useDebugValue(s),s}const WB=e=>{const n=typeof e=="function"?sCe(e):e,o=(s,c)=>OCe(n,s,c);return Object.assign(o,n),o},xCe=e=>e?WB(e):WB,NCe=ht.appId,PCe=oCe(),um=xCe((e,n)=>({getRooms:()=>{let{rooms:o}=n();o=PCe.map(({token:s,channel:c})=>{const d=ul.createClient({mode:"live",codec:"vp8"});return d.join(NCe,c,s||null,null),{channel:c,token:s,client:d}}),e({rooms:o})},selectChannel:async o=>{let{hostRoom:s,localTracks:c}=n();const{rooms:d}=n();if(!o){s&&(c&&s.client.localTracks.length>0&&await s.client.unpublish(c),s.client.setClientRole("audience"),s=null,e({hostRoom:s,localTracks:c}));return}if(s){if(s.client.channelName===o)return;c&&await s.client.unpublish(c),await s.client.setClientRole("audience")}s=d==null?void 0:d.find(p=>p.client.channelName===o),s&&(await s.client.setClientRole("host"),c||(c=await ul.createMicrophoneAndCameraTracks()),await s.client.publish(c)),e({localTracks:c,hostRoom:s})},dispose:()=>{const{rooms:o,hostRoom:s}=n();if(s==null||s.client.leave(),o)for(const c of o)c.client.leave()}}));var DCe=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function kCe(e){var n=e.defaultInputValue,o=n===void 0?"":n,s=e.defaultMenuIsOpen,c=s===void 0?!1:s,d=e.defaultValue,p=d===void 0?null:d,m=e.inputValue,g=e.menuIsOpen,_=e.onChange,S=e.onInputChange,T=e.onMenuClose,R=e.onMenuOpen,N=e.value,O=xn(e,DCe),A=b.useState(m!==void 0?m:o),M=We(A,2),x=M[0],P=M[1],D=b.useState(g!==void 0?g:c),F=We(D,2),j=F[0],B=F[1],H=b.useState(N!==void 0?N:p),K=We(H,2),J=K[0],q=K[1],Q=b.useCallback(function(ae,Ee){typeof _=="function"&&_(ae,Ee),q(ae)},[_]),ee=b.useCallback(function(ae,Ee){var ve;typeof S=="function"&&(ve=S(ae,Ee)),P(ve!==void 0?ve:ae)},[S]),ne=b.useCallback(function(){typeof R=="function"&&R(),B(!0)},[R]),he=b.useCallback(function(){typeof T=="function"&&T(),B(!1)},[T]),pe=m!==void 0?m:x,ce=g!==void 0?g:j,se=N!==void 0?N:J;return Ae(Ae({},O),{},{inputValue:pe,menuIsOpen:ce,onChange:Q,onInputChange:ee,onMenuClose:he,onMenuOpen:ne,value:se})}function LCe(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function MCe(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var FCe=function(){function e(o){var s=this;this._insertTag=function(c){var d;s.tags.length===0?s.insertionPoint?d=s.insertionPoint.nextSibling:s.prepend?d=s.container.firstChild:d=s.before:d=s.tags[s.tags.length-1].nextSibling,s.container.insertBefore(c,d),s.tags.push(c)},this.isSpeedy=o.speedy===void 0?!0:o.speedy,this.tags=[],this.ctr=0,this.nonce=o.nonce,this.key=o.key,this.container=o.container,this.prepend=o.prepend,this.insertionPoint=o.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(s){s.forEach(this._insertTag)},n.insert=function(s){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(MCe(this));var c=this.tags[this.tags.length-1];if(this.isSpeedy){var d=LCe(c);try{d.insertRule(s,d.cssRules.length)}catch{}}else c.appendChild(document.createTextNode(s));this.ctr++},n.flush=function(){this.tags.forEach(function(s){return s.parentNode&&s.parentNode.removeChild(s)}),this.tags=[],this.ctr=0},e}(),wo="-ms-",Ey="-moz-",Wn="-webkit-",q9="comm",xx="rule",Nx="decl",UCe="@import",Y9="@keyframes",BCe="@layer",jCe=Math.abs,NS=String.fromCharCode,VCe=Object.assign;function $Ce(e,n){return ro(e,0)^45?(((n<<2^ro(e,0))<<2^ro(e,1))<<2^ro(e,2))<<2^ro(e,3):0}function X9(e){return e.trim()}function HCe(e,n){return(e=n.exec(e))?e[0]:e}function zn(e,n,o){return e.replace(n,o)}function yA(e,n){return e.indexOf(n)}function ro(e,n){return e.charCodeAt(n)|0}function Um(e,n,o){return e.slice(n,o)}function Nc(e){return e.length}function Px(e){return e.length}function YE(e,n){return n.push(e),e}function WCe(e,n){return e.map(n).join("")}var PS=1,Yp=1,J9=0,va=0,Ii=0,vf="";function DS(e,n,o,s,c,d,p){return{value:e,root:n,parent:o,type:s,props:c,children:d,line:PS,column:Yp,length:p,return:""}}function M0(e,n){return VCe(DS("",null,null,"",null,null,0),e,{length:-e.length},n)}function zCe(){return Ii}function GCe(){return Ii=va>0?ro(vf,--va):0,Yp--,Ii===10&&(Yp=1,PS--),Ii}function Wa(){return Ii=va<J9?ro(vf,va++):0,Yp++,Ii===10&&(Yp=1,PS++),Ii}function Mc(){return ro(vf,va)}function S_(){return va}function cg(e,n){return Um(vf,e,n)}function Bm(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Q9(e){return PS=Yp=1,J9=Nc(vf=e),va=0,[]}function Z9(e){return vf="",e}function C_(e){return X9(cg(va-1,SA(e===91?e+2:e===40?e+1:e)))}function KCe(e){for(;(Ii=Mc())&&Ii<33;)Wa();return Bm(e)>2||Bm(Ii)>3?"":" "}function qCe(e,n){for(;--n&&Wa()&&!(Ii<48||Ii>102||Ii>57&&Ii<65||Ii>70&&Ii<97););return cg(e,S_()+(n<6&&Mc()==32&&Wa()==32))}function SA(e){for(;Wa();)switch(Ii){case e:return va;case 34:case 39:e!==34&&e!==39&&SA(Ii);break;case 40:e===41&&SA(e);break;case 92:Wa();break}return va}function YCe(e,n){for(;Wa()&&e+Ii!==47+10;)if(e+Ii===42+42&&Mc()===47)break;return"/*"+cg(n,va-1)+"*"+NS(e===47?e:Wa())}function XCe(e){for(;!Bm(Mc());)Wa();return cg(e,va)}function JCe(e){return Z9(b_("",null,null,null,[""],e=Q9(e),0,[0],e))}function b_(e,n,o,s,c,d,p,m,g){for(var _=0,S=0,T=p,R=0,N=0,O=0,A=1,M=1,x=1,P=0,D="",F=c,j=d,B=s,H=D;M;)switch(O=P,P=Wa()){case 40:if(O!=108&&ro(H,T-1)==58){yA(H+=zn(C_(P),"&","&\f"),"&\f")!=-1&&(x=-1);break}case 34:case 39:case 91:H+=C_(P);break;case 9:case 10:case 13:case 32:H+=KCe(O);break;case 92:H+=qCe(S_()-1,7);continue;case 47:switch(Mc()){case 42:case 47:YE(QCe(YCe(Wa(),S_()),n,o),g);break;default:H+="/"}break;case 123*A:m[_++]=Nc(H)*x;case 125*A:case 59:case 0:switch(P){case 0:case 125:M=0;case 59+S:x==-1&&(H=zn(H,/\f/g,"")),N>0&&Nc(H)-T&&YE(N>32?GB(H+";",s,o,T-1):GB(zn(H," ","")+";",s,o,T-2),g);break;case 59:H+=";";default:if(YE(B=zB(H,n,o,_,S,c,m,D,F=[],j=[],T),d),P===123)if(S===0)b_(H,n,B,B,F,d,T,m,j);else switch(R===99&&ro(H,3)===110?100:R){case 100:case 108:case 109:case 115:b_(e,B,B,s&&YE(zB(e,B,B,0,0,c,m,D,c,F=[],T),j),c,j,T,m,s?F:j);break;default:b_(H,B,B,B,[""],j,0,m,j)}}_=S=N=0,A=x=1,D=H="",T=p;break;case 58:T=1+Nc(H),N=O;default:if(A<1){if(P==123)--A;else if(P==125&&A++==0&&GCe()==125)continue}switch(H+=NS(P),P*A){case 38:x=S>0?1:(H+="\f",-1);break;case 44:m[_++]=(Nc(H)-1)*x,x=1;break;case 64:Mc()===45&&(H+=C_(Wa())),R=Mc(),S=T=Nc(D=H+=XCe(S_())),P++;break;case 45:O===45&&Nc(H)==2&&(A=0)}}return d}function zB(e,n,o,s,c,d,p,m,g,_,S){for(var T=c-1,R=c===0?d:[""],N=Px(R),O=0,A=0,M=0;O<s;++O)for(var x=0,P=Um(e,T+1,T=jCe(A=p[O])),D=e;x<N;++x)(D=X9(A>0?R[x]+" "+P:zn(P,/&\f/g,R[x])))&&(g[M++]=D);return DS(e,n,o,c===0?xx:m,g,_,S)}function QCe(e,n,o){return DS(e,n,o,q9,NS(zCe()),Um(e,2,-2),0)}function GB(e,n,o,s){return DS(e,n,o,Nx,Um(e,0,s),Um(e,s+1,-1),s)}function Fp(e,n){for(var o="",s=Px(e),c=0;c<s;c++)o+=n(e[c],c,e,n)||"";return o}function ZCe(e,n,o,s){switch(e.type){case BCe:if(e.children.length)break;case UCe:case Nx:return e.return=e.return||e.value;case q9:return"";case Y9:return e.return=e.value+"{"+Fp(e.children,s)+"}";case xx:e.value=e.props.join(",")}return Nc(o=Fp(e.children,s))?e.return=e.value+"{"+o+"}":""}function ebe(e){var n=Px(e);return function(o,s,c,d){for(var p="",m=0;m<n;m++)p+=e[m](o,s,c,d)||"";return p}}function tbe(e){return function(n){n.root||(n=n.return)&&e(n)}}function nbe(e){var n=Object.create(null);return function(o){return n[o]===void 0&&(n[o]=e(o)),n[o]}}var rbe=function(n,o,s){for(var c=0,d=0;c=d,d=Mc(),c===38&&d===12&&(o[s]=1),!Bm(d);)Wa();return cg(n,va)},ibe=function(n,o){var s=-1,c=44;do switch(Bm(c)){case 0:c===38&&Mc()===12&&(o[s]=1),n[s]+=rbe(va-1,o,s);break;case 2:n[s]+=C_(c);break;case 4:if(c===44){n[++s]=Mc()===58?"&\f":"",o[s]=n[s].length;break}default:n[s]+=NS(c)}while(c=Wa());return n},obe=function(n,o){return Z9(ibe(Q9(n),o))},KB=new WeakMap,abe=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var o=n.value,s=n.parent,c=n.column===s.column&&n.line===s.line;s.type!=="rule";)if(s=s.parent,!s)return;if(!(n.props.length===1&&o.charCodeAt(0)!==58&&!KB.get(s))&&!c){KB.set(n,!0);for(var d=[],p=obe(o,d),m=s.props,g=0,_=0;g<p.length;g++)for(var S=0;S<m.length;S++,_++)n.props[_]=d[g]?p[g].replace(/&\f/g,m[S]):m[S]+" "+p[g]}}},sbe=function(n){if(n.type==="decl"){var o=n.value;o.charCodeAt(0)===108&&o.charCodeAt(2)===98&&(n.return="",n.value="")}};function eH(e,n){switch($Ce(e,n)){case 5103:return Wn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Wn+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Wn+e+Ey+e+wo+e+e;case 6828:case 4268:return Wn+e+wo+e+e;case 6165:return Wn+e+wo+"flex-"+e+e;case 5187:return Wn+e+zn(e,/(\w+).+(:[^]+)/,Wn+"box-$1$2"+wo+"flex-$1$2")+e;case 5443:return Wn+e+wo+"flex-item-"+zn(e,/flex-|-self/,"")+e;case 4675:return Wn+e+wo+"flex-line-pack"+zn(e,/align-content|flex-|-self/,"")+e;case 5548:return Wn+e+wo+zn(e,"shrink","negative")+e;case 5292:return Wn+e+wo+zn(e,"basis","preferred-size")+e;case 6060:return Wn+"box-"+zn(e,"-grow","")+Wn+e+wo+zn(e,"grow","positive")+e;case 4554:return Wn+zn(e,/([^-])(transform)/g,"$1"+Wn+"$2")+e;case 6187:return zn(zn(zn(e,/(zoom-|grab)/,Wn+"$1"),/(image-set)/,Wn+"$1"),e,"")+e;case 5495:case 3959:return zn(e,/(image-set\([^]*)/,Wn+"$1$`$1");case 4968:return zn(zn(e,/(.+:)(flex-)?(.*)/,Wn+"box-pack:$3"+wo+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Wn+e+e;case 4095:case 3583:case 4068:case 2532:return zn(e,/(.+)-inline(.+)/,Wn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Nc(e)-1-n>6)switch(ro(e,n+1)){case 109:if(ro(e,n+4)!==45)break;case 102:return zn(e,/(.+:)(.+)-([^]+)/,"$1"+Wn+"$2-$3$1"+Ey+(ro(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~yA(e,"stretch")?eH(zn(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(ro(e,n+1)!==115)break;case 6444:switch(ro(e,Nc(e)-3-(~yA(e,"!important")&&10))){case 107:return zn(e,":",":"+Wn)+e;case 101:return zn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Wn+(ro(e,14)===45?"inline-":"")+"box$3$1"+Wn+"$2$3$1"+wo+"$2box$3")+e}break;case 5936:switch(ro(e,n+11)){case 114:return Wn+e+wo+zn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Wn+e+wo+zn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Wn+e+wo+zn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Wn+e+wo+e+e}return e}var cbe=function(n,o,s,c){if(n.length>-1&&!n.return)switch(n.type){case Nx:n.return=eH(n.value,n.length);break;case Y9:return Fp([M0(n,{value:zn(n.value,"@","@"+Wn)})],c);case xx:if(n.length)return WCe(n.props,function(d){switch(HCe(d,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Fp([M0(n,{props:[zn(d,/:(read-\w+)/,":"+Ey+"$1")]})],c);case"::placeholder":return Fp([M0(n,{props:[zn(d,/:(plac\w+)/,":"+Wn+"input-$1")]}),M0(n,{props:[zn(d,/:(plac\w+)/,":"+Ey+"$1")]}),M0(n,{props:[zn(d,/:(plac\w+)/,wo+"input-$1")]})],c)}return""})}},lbe=[cbe],ube=function(n){var o=n.key;if(o==="css"){var s=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(s,function(A){var M=A.getAttribute("data-emotion");M.indexOf(" ")!==-1&&(document.head.appendChild(A),A.setAttribute("data-s",""))})}var c=n.stylisPlugins||lbe,d={},p,m=[];p=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+o+' "]'),function(A){for(var M=A.getAttribute("data-emotion").split(" "),x=1;x<M.length;x++)d[M[x]]=!0;m.push(A)});var g,_=[abe,sbe];{var S,T=[ZCe,tbe(function(A){S.insert(A)})],R=ebe(_.concat(c,T)),N=function(M){return Fp(JCe(M),R)};g=function(M,x,P,D){S=P,N(M?M+"{"+x.styles+"}":x.styles),D&&(O.inserted[x.name]=!0)}}var O={key:o,sheet:new FCe({key:o,container:p,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:d,registered:{},insert:g};return O.sheet.hydrate(m),O},tH={exports:{}},ir={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xi=typeof Symbol=="function"&&Symbol.for,Dx=Xi?Symbol.for("react.element"):60103,kx=Xi?Symbol.for("react.portal"):60106,kS=Xi?Symbol.for("react.fragment"):60107,LS=Xi?Symbol.for("react.strict_mode"):60108,MS=Xi?Symbol.for("react.profiler"):60114,FS=Xi?Symbol.for("react.provider"):60109,US=Xi?Symbol.for("react.context"):60110,Lx=Xi?Symbol.for("react.async_mode"):60111,BS=Xi?Symbol.for("react.concurrent_mode"):60111,jS=Xi?Symbol.for("react.forward_ref"):60112,VS=Xi?Symbol.for("react.suspense"):60113,dbe=Xi?Symbol.for("react.suspense_list"):60120,$S=Xi?Symbol.for("react.memo"):60115,HS=Xi?Symbol.for("react.lazy"):60116,hbe=Xi?Symbol.for("react.block"):60121,pbe=Xi?Symbol.for("react.fundamental"):60117,fbe=Xi?Symbol.for("react.responder"):60118,mbe=Xi?Symbol.for("react.scope"):60119;function Ya(e){if(typeof e=="object"&&e!==null){var n=e.$$typeof;switch(n){case Dx:switch(e=e.type,e){case Lx:case BS:case kS:case MS:case LS:case VS:return e;default:switch(e=e&&e.$$typeof,e){case US:case jS:case HS:case $S:case FS:return e;default:return n}}case kx:return n}}}function nH(e){return Ya(e)===BS}ir.AsyncMode=Lx;ir.ConcurrentMode=BS;ir.ContextConsumer=US;ir.ContextProvider=FS;ir.Element=Dx;ir.ForwardRef=jS;ir.Fragment=kS;ir.Lazy=HS;ir.Memo=$S;ir.Portal=kx;ir.Profiler=MS;ir.StrictMode=LS;ir.Suspense=VS;ir.isAsyncMode=function(e){return nH(e)||Ya(e)===Lx};ir.isConcurrentMode=nH;ir.isContextConsumer=function(e){return Ya(e)===US};ir.isContextProvider=function(e){return Ya(e)===FS};ir.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Dx};ir.isForwardRef=function(e){return Ya(e)===jS};ir.isFragment=function(e){return Ya(e)===kS};ir.isLazy=function(e){return Ya(e)===HS};ir.isMemo=function(e){return Ya(e)===$S};ir.isPortal=function(e){return Ya(e)===kx};ir.isProfiler=function(e){return Ya(e)===MS};ir.isStrictMode=function(e){return Ya(e)===LS};ir.isSuspense=function(e){return Ya(e)===VS};ir.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===kS||e===BS||e===MS||e===LS||e===VS||e===dbe||typeof e=="object"&&e!==null&&(e.$$typeof===HS||e.$$typeof===$S||e.$$typeof===FS||e.$$typeof===US||e.$$typeof===jS||e.$$typeof===pbe||e.$$typeof===fbe||e.$$typeof===mbe||e.$$typeof===hbe)};ir.typeOf=Ya;tH.exports=ir;var gbe=tH.exports,rH=gbe,vbe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Ebe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},iH={};iH[rH.ForwardRef]=vbe;iH[rH.Memo]=Ebe;var _be=!0;function ybe(e,n,o){var s="";return o.split(" ").forEach(function(c){e[c]!==void 0?n.push(e[c]+";"):s+=c+" "}),s}var oH=function(n,o,s){var c=n.key+"-"+o.name;(s===!1||_be===!1)&&n.registered[c]===void 0&&(n.registered[c]=o.styles)},Sbe=function(n,o,s){oH(n,o,s);var c=n.key+"-"+o.name;if(n.inserted[o.name]===void 0){var d=o;do n.insert(o===d?"."+c:"",d,n.sheet,!0),d=d.next;while(d!==void 0)}};function Cbe(e){for(var n=0,o,s=0,c=e.length;c>=4;++s,c-=4)o=e.charCodeAt(s)&255|(e.charCodeAt(++s)&255)<<8|(e.charCodeAt(++s)&255)<<16|(e.charCodeAt(++s)&255)<<24,o=(o&65535)*1540483477+((o>>>16)*59797<<16),o^=o>>>24,n=(o&65535)*1540483477+((o>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(c){case 3:n^=(e.charCodeAt(s+2)&255)<<16;case 2:n^=(e.charCodeAt(s+1)&255)<<8;case 1:n^=e.charCodeAt(s)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var bbe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Tbe=/[A-Z]|^ms/g,Rbe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,aH=function(n){return n.charCodeAt(1)===45},qB=function(n){return n!=null&&typeof n!="boolean"},fw=nbe(function(e){return aH(e)?e:e.replace(Tbe,"-$&").toLowerCase()}),YB=function(n,o){switch(n){case"animation":case"animationName":if(typeof o=="string")return o.replace(Rbe,function(s,c,d){return Pc={name:c,styles:d,next:Pc},c})}return bbe[n]!==1&&!aH(n)&&typeof o=="number"&&o!==0?o+"px":o};function jm(e,n,o){if(o==null)return"";if(o.__emotion_styles!==void 0)return o;switch(typeof o){case"boolean":return"";case"object":{if(o.anim===1)return Pc={name:o.name,styles:o.styles,next:Pc},o.name;if(o.styles!==void 0){var s=o.next;if(s!==void 0)for(;s!==void 0;)Pc={name:s.name,styles:s.styles,next:Pc},s=s.next;var c=o.styles+";";return c}return wbe(e,n,o)}case"function":{if(e!==void 0){var d=Pc,p=o(e);return Pc=d,jm(e,n,p)}break}}if(n==null)return o;var m=n[o];return m!==void 0?m:o}function wbe(e,n,o){var s="";if(Array.isArray(o))for(var c=0;c<o.length;c++)s+=jm(e,n,o[c])+";";else for(var d in o){var p=o[d];if(typeof p!="object")n!=null&&n[p]!==void 0?s+=d+"{"+n[p]+"}":qB(p)&&(s+=fw(d)+":"+YB(d,p)+";");else if(Array.isArray(p)&&typeof p[0]=="string"&&(n==null||n[p[0]]===void 0))for(var m=0;m<p.length;m++)qB(p[m])&&(s+=fw(d)+":"+YB(d,p[m])+";");else{var g=jm(e,n,p);switch(d){case"animation":case"animationName":{s+=fw(d)+":"+g+";";break}default:s+=d+"{"+g+"}"}}}return s}var XB=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Pc,sH=function(n,o,s){if(n.length===1&&typeof n[0]=="object"&&n[0]!==null&&n[0].styles!==void 0)return n[0];var c=!0,d="";Pc=void 0;var p=n[0];p==null||p.raw===void 0?(c=!1,d+=jm(s,o,p)):d+=p[0];for(var m=1;m<n.length;m++)d+=jm(s,o,n[m]),c&&(d+=p[m]);XB.lastIndex=0;for(var g="",_;(_=XB.exec(d))!==null;)g+="-"+_[1];var S=Cbe(d)+g;return{name:S,styles:d,next:Pc}},Ibe=function(n){return n()},Abe=Md["useInsertionEffect"]?Md["useInsertionEffect"]:!1,Obe=Abe||Ibe,Mx={}.hasOwnProperty,cH=b.createContext(typeof HTMLElement<"u"?ube({key:"css"}):null);cH.Provider;var xbe=function(n){return b.forwardRef(function(o,s){var c=b.useContext(cH);return n(o,c,s)})},Nbe=b.createContext({}),CA="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",Pbe=function(n,o){var s={};for(var c in o)Mx.call(o,c)&&(s[c]=o[c]);return s[CA]=n,s},Dbe=function(n){var o=n.cache,s=n.serialized,c=n.isStringTag;return oH(o,s,c),Obe(function(){return Sbe(o,s,c)}),null},kbe=xbe(function(e,n,o){var s=e.css;typeof s=="string"&&n.registered[s]!==void 0&&(s=n.registered[s]);var c=e[CA],d=[s],p="";typeof e.className=="string"?p=ybe(n.registered,d,e.className):e.className!=null&&(p=e.className+" ");var m=sH(d,void 0,b.useContext(Nbe));p+=n.key+"-"+m.name;var g={};for(var _ in e)Mx.call(e,_)&&_!=="css"&&_!==CA&&(g[_]=e[_]);return g.ref=o,g.className=p,b.createElement(b.Fragment,null,b.createElement(Dbe,{cache:n,serialized:m,isStringTag:typeof c=="string"}),b.createElement(c,g))}),Lbe=kbe,Bt=function(n,o){var s=arguments;if(o==null||!Mx.call(o,"css"))return b.createElement.apply(void 0,s);var c=s.length,d=new Array(c);d[0]=Lbe,d[1]=Pbe(n,o);for(var p=2;p<c;p++)d[p]=s[p];return b.createElement.apply(null,d)};function Fx(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return sH(n)}var Mbe=function(){var n=Fx.apply(void 0,arguments),o="animation-"+n.name;return{name:o,styles:"@keyframes "+o+"{"+n.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}};function Fbe(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}const Ube=Math.min,Bbe=Math.max,_y=Math.round,XE=Math.floor,yy=e=>({x:e,y:e});function jbe(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function lH(e){return dH(e)?(e.nodeName||"").toLowerCase():"#document"}function Zs(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function uH(e){var n;return(n=(dH(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function dH(e){return e instanceof Node||e instanceof Zs(e).Node}function bA(e){return e instanceof Element||e instanceof Zs(e).Element}function Ux(e){return e instanceof HTMLElement||e instanceof Zs(e).HTMLElement}function JB(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Zs(e).ShadowRoot}function hH(e){const{overflow:n,overflowX:o,overflowY:s,display:c}=Bx(e);return/auto|scroll|overlay|hidden|clip/.test(n+s+o)&&!["inline","contents"].includes(c)}function Vbe(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function $be(e){return["html","body","#document"].includes(lH(e))}function Bx(e){return Zs(e).getComputedStyle(e)}function Hbe(e){if(lH(e)==="html")return e;const n=e.assignedSlot||e.parentNode||JB(e)&&e.host||uH(e);return JB(n)?n.host:n}function pH(e){const n=Hbe(e);return $be(n)?e.ownerDocument?e.ownerDocument.body:e.body:Ux(n)&&hH(n)?n:pH(n)}function Sy(e,n,o){var s;n===void 0&&(n=[]),o===void 0&&(o=!0);const c=pH(e),d=c===((s=e.ownerDocument)==null?void 0:s.body),p=Zs(c);return d?n.concat(p,p.visualViewport||[],hH(c)?c:[],p.frameElement&&o?Sy(p.frameElement):[]):n.concat(c,Sy(c,[],o))}function Wbe(e){const n=Bx(e);let o=parseFloat(n.width)||0,s=parseFloat(n.height)||0;const c=Ux(e),d=c?e.offsetWidth:o,p=c?e.offsetHeight:s,m=_y(o)!==d||_y(s)!==p;return m&&(o=d,s=p),{width:o,height:s,$:m}}function jx(e){return bA(e)?e:e.contextElement}function mw(e){const n=jx(e);if(!Ux(n))return yy(1);const o=n.getBoundingClientRect(),{width:s,height:c,$:d}=Wbe(n);let p=(d?_y(o.width):o.width)/s,m=(d?_y(o.height):o.height)/c;return(!p||!Number.isFinite(p))&&(p=1),(!m||!Number.isFinite(m))&&(m=1),{x:p,y:m}}const zbe=yy(0);function Gbe(e){const n=Zs(e);return!Vbe()||!n.visualViewport?zbe:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function Kbe(e,n,o){return n===void 0&&(n=!1),!o||n&&o!==Zs(e)?!1:n}function QB(e,n,o,s){n===void 0&&(n=!1),o===void 0&&(o=!1);const c=e.getBoundingClientRect(),d=jx(e);let p=yy(1);n&&(s?bA(s)&&(p=mw(s)):p=mw(e));const m=Kbe(d,o,s)?Gbe(d):yy(0);let g=(c.left+m.x)/p.x,_=(c.top+m.y)/p.y,S=c.width/p.x,T=c.height/p.y;if(d){const R=Zs(d),N=s&&bA(s)?Zs(s):s;let O=R.frameElement;for(;O&&s&&N!==R;){const A=mw(O),M=O.getBoundingClientRect(),x=Bx(O),P=M.left+(O.clientLeft+parseFloat(x.paddingLeft))*A.x,D=M.top+(O.clientTop+parseFloat(x.paddingTop))*A.y;g*=A.x,_*=A.y,S*=A.x,T*=A.y,g+=P,_+=D,O=Zs(O).frameElement}}return jbe({width:S,height:T,x:g,y:_})}function qbe(e,n){let o=null,s;const c=uH(e);function d(){clearTimeout(s),o&&o.disconnect(),o=null}function p(m,g){m===void 0&&(m=!1),g===void 0&&(g=1),d();const{left:_,top:S,width:T,height:R}=e.getBoundingClientRect();if(m||n(),!T||!R)return;const N=XE(S),O=XE(c.clientWidth-(_+T)),A=XE(c.clientHeight-(S+R)),M=XE(_),P={rootMargin:-N+"px "+-O+"px "+-A+"px "+-M+"px",threshold:Bbe(0,Ube(1,g))||1};let D=!0;function F(j){const B=j[0].intersectionRatio;if(B!==g){if(!D)return p();B?p(!1,B):s=setTimeout(()=>{p(!1,1e-7)},100)}D=!1}try{o=new IntersectionObserver(F,{...P,root:c.ownerDocument})}catch{o=new IntersectionObserver(F,P)}o.observe(e)}return p(!0),d}function Ybe(e,n,o,s){s===void 0&&(s={});const{ancestorScroll:c=!0,ancestorResize:d=!0,elementResize:p=typeof ResizeObserver=="function",layoutShift:m=typeof IntersectionObserver=="function",animationFrame:g=!1}=s,_=jx(e),S=c||d?[..._?Sy(_):[],...Sy(n)]:[];S.forEach(x=>{c&&x.addEventListener("scroll",o,{passive:!0}),d&&x.addEventListener("resize",o)});const T=_&&m?qbe(_,o):null;let R=-1,N=null;p&&(N=new ResizeObserver(x=>{let[P]=x;P&&P.target===_&&N&&(N.unobserve(n),cancelAnimationFrame(R),R=requestAnimationFrame(()=>{N&&N.observe(n)})),o()}),_&&!g&&N.observe(_),N.observe(n));let O,A=g?QB(e):null;g&&M();function M(){const x=QB(e);A&&(x.x!==A.x||x.y!==A.y||x.width!==A.width||x.height!==A.height)&&o(),A=x,O=requestAnimationFrame(M)}return o(),()=>{S.forEach(x=>{c&&x.removeEventListener("scroll",o),d&&x.removeEventListener("resize",o)}),T&&T(),N&&N.disconnect(),N=null,g&&cancelAnimationFrame(O)}}var TA=b.useLayoutEffect,Xbe=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],Cy=function(){};function Jbe(e,n){return n?n[0]==="-"?e+n:e+"__"+n:e}function Qbe(e,n){for(var o=arguments.length,s=new Array(o>2?o-2:0),c=2;c<o;c++)s[c-2]=arguments[c];var d=[].concat(s);if(n&&e)for(var p in n)n.hasOwnProperty(p)&&n[p]&&d.push("".concat(Jbe(e,p)));return d.filter(function(m){return m}).map(function(m){return String(m).trim()}).join(" ")}var ZB=function(n){return sTe(n)?n.filter(Boolean):jn(n)==="object"&&n!==null?[n]:[]},fH=function(n){n.className,n.clearValue,n.cx,n.getStyles,n.getClassNames,n.getValue,n.hasValue,n.isMulti,n.isRtl,n.options,n.selectOption,n.selectProps,n.setValue,n.theme;var o=xn(n,Xbe);return Ae({},o)},ii=function(n,o,s){var c=n.cx,d=n.getStyles,p=n.getClassNames,m=n.className;return{css:d(o,n),className:c(s??{},p(o,n),m)}};function WS(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function Zbe(e){return WS(e)?window.innerHeight:e.clientHeight}function mH(e){return WS(e)?window.pageYOffset:e.scrollTop}function by(e,n){if(WS(e)){window.scrollTo(0,n);return}e.scrollTop=n}function eTe(e){var n=getComputedStyle(e),o=n.position==="absolute",s=/(auto|scroll)/;if(n.position==="fixed")return document.documentElement;for(var c=e;c=c.parentElement;)if(n=getComputedStyle(c),!(o&&n.position==="static")&&s.test(n.overflow+n.overflowY+n.overflowX))return c;return document.documentElement}function tTe(e,n,o,s){return o*((e=e/s-1)*e*e+1)+n}function JE(e,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Cy,c=mH(e),d=n-c,p=10,m=0;function g(){m+=p;var _=tTe(m,c,d,o);by(e,_),m<o?window.requestAnimationFrame(g):s(e)}g()}function e6(e,n){var o=e.getBoundingClientRect(),s=n.getBoundingClientRect(),c=n.offsetHeight/3;s.bottom+c>o.bottom?by(e,Math.min(n.offsetTop+n.clientHeight-e.offsetHeight+c,e.scrollHeight)):s.top-c<o.top&&by(e,Math.max(n.offsetTop-c,0))}function nTe(e){var n=e.getBoundingClientRect();return{bottom:n.bottom,height:n.height,left:n.left,right:n.right,top:n.top,width:n.width}}function t6(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function rTe(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var gH=!1,iTe={get passive(){return gH=!0}},QE=typeof window<"u"?window:{};QE.addEventListener&&QE.removeEventListener&&(QE.addEventListener("p",Cy,iTe),QE.removeEventListener("p",Cy,!1));var oTe=gH;function aTe(e){return e!=null}function sTe(e){return Array.isArray(e)}function ZE(e,n,o){return e?n:o}var cTe=function(n){for(var o=arguments.length,s=new Array(o>1?o-1:0),c=1;c<o;c++)s[c-1]=arguments[c];var d=Object.entries(n).filter(function(p){var m=We(p,1),g=m[0];return!s.includes(g)});return d.reduce(function(p,m){var g=We(m,2),_=g[0],S=g[1];return p[_]=S,p},{})};function lTe(e){var n=e.maxHeight,o=e.menuEl,s=e.minHeight,c=e.placement,d=e.shouldScroll,p=e.isFixedPosition,m=e.controlHeight,g=eTe(o),_={placement:"bottom",maxHeight:n};if(!o||!o.offsetParent)return _;var S=g.getBoundingClientRect(),T=S.height,R=o.getBoundingClientRect(),N=R.bottom,O=R.height,A=R.top,M=o.offsetParent.getBoundingClientRect(),x=M.top,P=p?window.innerHeight:Zbe(g),D=mH(g),F=parseInt(getComputedStyle(o).marginBottom,10),j=parseInt(getComputedStyle(o).marginTop,10),B=x-j,H=P-A,K=B+D,J=T-D-A,q=N-P+D+F,Q=D+A-j,ee=160;switch(c){case"auto":case"bottom":if(H>=O)return{placement:"bottom",maxHeight:n};if(J>=O&&!p)return d&&JE(g,q,ee),{placement:"bottom",maxHeight:n};if(!p&&J>=s||p&&H>=s){d&&JE(g,q,ee);var ne=p?H-F:J-F;return{placement:"bottom",maxHeight:ne}}if(c==="auto"||p){var he=n,pe=p?B:K;return pe>=s&&(he=Math.min(pe-F-m,n)),{placement:"top",maxHeight:he}}if(c==="bottom")return d&&by(g,q),{placement:"bottom",maxHeight:n};break;case"top":if(B>=O)return{placement:"top",maxHeight:n};if(K>=O&&!p)return d&&JE(g,Q,ee),{placement:"top",maxHeight:n};if(!p&&K>=s||p&&B>=s){var ce=n;return(!p&&K>=s||p&&B>=s)&&(ce=p?B-j:K-j),d&&JE(g,Q,ee),{placement:"top",maxHeight:ce}}return{placement:"bottom",maxHeight:n};default:throw new Error('Invalid placement provided "'.concat(c,'".'))}return _}function uTe(e){var n={bottom:"top",top:"bottom"};return e?n[e]:"bottom"}var vH=function(n){return n==="auto"?"bottom":n},dTe=function(n,o){var s,c=n.placement,d=n.theme,p=d.borderRadius,m=d.spacing,g=d.colors;return Ae((s={label:"menu"},st(s,uTe(c),"100%"),st(s,"position","absolute"),st(s,"width","100%"),st(s,"zIndex",1),s),o?{}:{backgroundColor:g.neutral0,borderRadius:p,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:m.menuGutter,marginTop:m.menuGutter})},EH=b.createContext(null),hTe=function(n){var o=n.children,s=n.minMenuHeight,c=n.maxMenuHeight,d=n.menuPlacement,p=n.menuPosition,m=n.menuShouldScrollIntoView,g=n.theme,_=b.useContext(EH)||{},S=_.setPortalPlacement,T=b.useRef(null),R=b.useState(c),N=We(R,2),O=N[0],A=N[1],M=b.useState(null),x=We(M,2),P=x[0],D=x[1],F=g.spacing.controlHeight;return TA(function(){var j=T.current;if(j){var B=p==="fixed",H=m&&!B,K=lTe({maxHeight:c,menuEl:j,minHeight:s,placement:d,shouldScroll:H,isFixedPosition:B,controlHeight:F});A(K.maxHeight),D(K.placement),S==null||S(K.placement)}},[c,d,p,m,s,S,F]),o({ref:T,placerProps:Ae(Ae({},n),{},{placement:P||vH(d),maxHeight:O})})},pTe=function(n){var o=n.children,s=n.innerRef,c=n.innerProps;return Bt("div",Qe({},ii(n,"menu",{menu:!0}),{ref:s},c),o)},fTe=pTe,mTe=function(n,o){var s=n.maxHeight,c=n.theme.spacing.baseUnit;return Ae({maxHeight:s,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},o?{}:{paddingBottom:c,paddingTop:c})},gTe=function(n){var o=n.children,s=n.innerProps,c=n.innerRef,d=n.isMulti;return Bt("div",Qe({},ii(n,"menuList",{"menu-list":!0,"menu-list--is-multi":d}),{ref:c},s),o)},_H=function(n,o){var s=n.theme,c=s.spacing.baseUnit,d=s.colors;return Ae({textAlign:"center"},o?{}:{color:d.neutral40,padding:"".concat(c*2,"px ").concat(c*3,"px")})},vTe=_H,ETe=_H,yH=function(n){var o=n.children,s=n.innerProps;return Bt("div",Qe({},ii(n,"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),s),o)};yH.defaultProps={children:"No options"};var SH=function(n){var o=n.children,s=n.innerProps;return Bt("div",Qe({},ii(n,"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),s),o)};SH.defaultProps={children:"Loading..."};var _Te=function(n){var o=n.rect,s=n.offset,c=n.position;return{left:o.left,position:c,top:s,width:o.width,zIndex:1}},yTe=function(n){var o=n.appendTo,s=n.children,c=n.controlElement,d=n.innerProps,p=n.menuPlacement,m=n.menuPosition,g=b.useRef(null),_=b.useRef(null),S=b.useState(vH(p)),T=We(S,2),R=T[0],N=T[1],O=b.useMemo(function(){return{setPortalPlacement:N}},[]),A=b.useState(null),M=We(A,2),x=M[0],P=M[1],D=b.useCallback(function(){if(c){var H=nTe(c),K=m==="fixed"?0:window.pageYOffset,J=H[R]+K;(J!==(x==null?void 0:x.offset)||H.left!==(x==null?void 0:x.rect.left)||H.width!==(x==null?void 0:x.rect.width))&&P({offset:J,rect:H})}},[c,m,R,x==null?void 0:x.offset,x==null?void 0:x.rect.left,x==null?void 0:x.rect.width]);TA(function(){D()},[D]);var F=b.useCallback(function(){typeof _.current=="function"&&(_.current(),_.current=null),c&&g.current&&(_.current=Ybe(c,g.current,D,{elementResize:"ResizeObserver"in window}))},[c,D]);TA(function(){F()},[F]);var j=b.useCallback(function(H){g.current=H,F()},[F]);if(!o&&m!=="fixed"||!x)return null;var B=Bt("div",Qe({ref:j},ii(Ae(Ae({},n),{},{offset:x.offset,position:m,rect:x.rect}),"menuPortal",{"menu-portal":!0}),d),s);return Bt(EH.Provider,{value:O},o?Cl.createPortal(B,o):B)},STe=function(n){var o=n.isDisabled,s=n.isRtl;return{label:"container",direction:s?"rtl":void 0,pointerEvents:o?"none":void 0,position:"relative"}},CTe=function(n){var o=n.children,s=n.innerProps,c=n.isDisabled,d=n.isRtl;return Bt("div",Qe({},ii(n,"container",{"--is-disabled":c,"--is-rtl":d}),s),o)},bTe=function(n,o){var s=n.theme.spacing,c=n.isMulti,d=n.hasValue,p=n.selectProps.controlShouldRenderValue;return Ae({alignItems:"center",display:c&&d&&p?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},o?{}:{padding:"".concat(s.baseUnit/2,"px ").concat(s.baseUnit*2,"px")})},TTe=function(n){var o=n.children,s=n.innerProps,c=n.isMulti,d=n.hasValue;return Bt("div",Qe({},ii(n,"valueContainer",{"value-container":!0,"value-container--is-multi":c,"value-container--has-value":d}),s),o)},RTe=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},wTe=function(n){var o=n.children,s=n.innerProps;return Bt("div",Qe({},ii(n,"indicatorsContainer",{indicators:!0}),s),o)},n6,ITe=["size"],ATe={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},CH=function(n){var o=n.size,s=xn(n,ITe);return Bt("svg",Qe({height:o,width:o,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:ATe},s))},Vx=function(n){return Bt(CH,Qe({size:20},n),Bt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},bH=function(n){return Bt(CH,Qe({size:20},n),Bt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},TH=function(n,o){var s=n.isFocused,c=n.theme,d=c.spacing.baseUnit,p=c.colors;return Ae({label:"indicatorContainer",display:"flex",transition:"color 150ms"},o?{}:{color:s?p.neutral60:p.neutral20,padding:d*2,":hover":{color:s?p.neutral80:p.neutral40}})},OTe=TH,xTe=function(n){var o=n.children,s=n.innerProps;return Bt("div",Qe({},ii(n,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),s),o||Bt(bH,null))},NTe=TH,PTe=function(n){var o=n.children,s=n.innerProps;return Bt("div",Qe({},ii(n,"clearIndicator",{indicator:!0,"clear-indicator":!0}),s),o||Bt(Vx,null))},DTe=function(n,o){var s=n.isDisabled,c=n.theme,d=c.spacing.baseUnit,p=c.colors;return Ae({label:"indicatorSeparator",alignSelf:"stretch",width:1},o?{}:{backgroundColor:s?p.neutral10:p.neutral20,marginBottom:d*2,marginTop:d*2})},kTe=function(n){var o=n.innerProps;return Bt("span",Qe({},o,ii(n,"indicatorSeparator",{"indicator-separator":!0})))},LTe=Mbe(n6||(n6=Fbe([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),MTe=function(n,o){var s=n.isFocused,c=n.size,d=n.theme,p=d.colors,m=d.spacing.baseUnit;return Ae({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:c,lineHeight:1,marginRight:c,textAlign:"center",verticalAlign:"middle"},o?{}:{color:s?p.neutral60:p.neutral20,padding:m*2})},gw=function(n){var o=n.delay,s=n.offset;return Bt("span",{css:Fx({animation:"".concat(LTe," 1s ease-in-out ").concat(o,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:s?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},RH=function(n){var o=n.innerProps,s=n.isRtl;return Bt("div",Qe({},ii(n,"loadingIndicator",{indicator:!0,"loading-indicator":!0}),o),Bt(gw,{delay:0,offset:s}),Bt(gw,{delay:160,offset:!0}),Bt(gw,{delay:320,offset:!s}))};RH.defaultProps={size:4};var FTe=function(n,o){var s=n.isDisabled,c=n.isFocused,d=n.theme,p=d.colors,m=d.borderRadius,g=d.spacing;return Ae({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:g.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},o?{}:{backgroundColor:s?p.neutral5:p.neutral0,borderColor:s?p.neutral10:c?p.primary:p.neutral20,borderRadius:m,borderStyle:"solid",borderWidth:1,boxShadow:c?"0 0 0 1px ".concat(p.primary):void 0,"&:hover":{borderColor:c?p.primary:p.neutral30}})},UTe=function(n){var o=n.children,s=n.isDisabled,c=n.isFocused,d=n.innerRef,p=n.innerProps,m=n.menuIsOpen;return Bt("div",Qe({ref:d},ii(n,"control",{control:!0,"control--is-disabled":s,"control--is-focused":c,"control--menu-is-open":m}),p),o)},BTe=UTe,jTe=["data"],VTe=function(n,o){var s=n.theme.spacing;return o?{}:{paddingBottom:s.baseUnit*2,paddingTop:s.baseUnit*2}},$Te=function(n){var o=n.children,s=n.cx,c=n.getStyles,d=n.getClassNames,p=n.Heading,m=n.headingProps,g=n.innerProps,_=n.label,S=n.theme,T=n.selectProps;return Bt("div",Qe({},ii(n,"group",{group:!0}),g),Bt(p,Qe({},m,{selectProps:T,theme:S,getStyles:c,getClassNames:d,cx:s}),_),Bt("div",null,o))},HTe=function(n,o){var s=n.theme,c=s.colors,d=s.spacing;return Ae({label:"group",cursor:"default",display:"block"},o?{}:{color:c.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:d.baseUnit*3,paddingRight:d.baseUnit*3,textTransform:"uppercase"})},WTe=function(n){var o=fH(n);o.data;var s=xn(o,jTe);return Bt("div",Qe({},ii(n,"groupHeading",{"group-heading":!0}),s))},zTe=$Te,GTe=["innerRef","isDisabled","isHidden","inputClassName"],KTe=function(n,o){var s=n.isDisabled,c=n.value,d=n.theme,p=d.spacing,m=d.colors;return Ae(Ae({visibility:s?"hidden":"visible",transform:c?"translateZ(0)":""},qTe),o?{}:{margin:p.baseUnit/2,paddingBottom:p.baseUnit/2,paddingTop:p.baseUnit/2,color:m.neutral80})},wH={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},qTe={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Ae({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},wH)},YTe=function(n){return Ae({label:"input",color:"inherit",background:0,opacity:n?0:1,width:"100%"},wH)},XTe=function(n){var o=n.cx,s=n.value,c=fH(n),d=c.innerRef,p=c.isDisabled,m=c.isHidden,g=c.inputClassName,_=xn(c,GTe);return Bt("div",Qe({},ii(n,"input",{"input-container":!0}),{"data-value":s||""}),Bt("input",Qe({className:o({input:!0},g),ref:d,style:YTe(m),disabled:p},_)))},JTe=XTe,QTe=function(n,o){var s=n.theme,c=s.spacing,d=s.borderRadius,p=s.colors;return Ae({label:"multiValue",display:"flex",minWidth:0},o?{}:{backgroundColor:p.neutral10,borderRadius:d/2,margin:c.baseUnit/2})},ZTe=function(n,o){var s=n.theme,c=s.borderRadius,d=s.colors,p=n.cropWithEllipsis;return Ae({overflow:"hidden",textOverflow:p||p===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},o?{}:{borderRadius:c/2,color:d.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},eRe=function(n,o){var s=n.theme,c=s.spacing,d=s.borderRadius,p=s.colors,m=n.isFocused;return Ae({alignItems:"center",display:"flex"},o?{}:{borderRadius:d/2,backgroundColor:m?p.dangerLight:void 0,paddingLeft:c.baseUnit,paddingRight:c.baseUnit,":hover":{backgroundColor:p.dangerLight,color:p.danger}})},IH=function(n){var o=n.children,s=n.innerProps;return Bt("div",s,o)},tRe=IH,nRe=IH;function rRe(e){var n=e.children,o=e.innerProps;return Bt("div",Qe({role:"button"},o),n||Bt(Vx,{size:14}))}var iRe=function(n){var o=n.children,s=n.components,c=n.data,d=n.innerProps,p=n.isDisabled,m=n.removeProps,g=n.selectProps,_=s.Container,S=s.Label,T=s.Remove;return Bt(_,{data:c,innerProps:Ae(Ae({},ii(n,"multiValue",{"multi-value":!0,"multi-value--is-disabled":p})),d),selectProps:g},Bt(S,{data:c,innerProps:Ae({},ii(n,"multiValueLabel",{"multi-value__label":!0})),selectProps:g},o),Bt(T,{data:c,innerProps:Ae(Ae({},ii(n,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(o||"option")},m),selectProps:g}))},oRe=iRe,aRe=function(n,o){var s=n.isDisabled,c=n.isFocused,d=n.isSelected,p=n.theme,m=p.spacing,g=p.colors;return Ae({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},o?{}:{backgroundColor:d?g.primary:c?g.primary25:"transparent",color:s?g.neutral20:d?g.neutral0:"inherit",padding:"".concat(m.baseUnit*2,"px ").concat(m.baseUnit*3,"px"),":active":{backgroundColor:s?void 0:d?g.primary:g.primary50}})},sRe=function(n){var o=n.children,s=n.isDisabled,c=n.isFocused,d=n.isSelected,p=n.innerRef,m=n.innerProps;return Bt("div",Qe({},ii(n,"option",{option:!0,"option--is-disabled":s,"option--is-focused":c,"option--is-selected":d}),{ref:p,"aria-disabled":s},m),o)},cRe=sRe,lRe=function(n,o){var s=n.theme,c=s.spacing,d=s.colors;return Ae({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},o?{}:{color:d.neutral50,marginLeft:c.baseUnit/2,marginRight:c.baseUnit/2})},uRe=function(n){var o=n.children,s=n.innerProps;return Bt("div",Qe({},ii(n,"placeholder",{placeholder:!0}),s),o)},dRe=uRe,hRe=function(n,o){var s=n.isDisabled,c=n.theme,d=c.spacing,p=c.colors;return Ae({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},o?{}:{color:s?p.neutral40:p.neutral80,marginLeft:d.baseUnit/2,marginRight:d.baseUnit/2})},pRe=function(n){var o=n.children,s=n.isDisabled,c=n.innerProps;return Bt("div",Qe({},ii(n,"singleValue",{"single-value":!0,"single-value--is-disabled":s}),c),o)},fRe=pRe,mRe={ClearIndicator:PTe,Control:BTe,DropdownIndicator:xTe,DownChevron:bH,CrossIcon:Vx,Group:zTe,GroupHeading:WTe,IndicatorsContainer:wTe,IndicatorSeparator:kTe,Input:JTe,LoadingIndicator:RH,Menu:fTe,MenuList:gTe,MenuPortal:yTe,LoadingMessage:SH,NoOptionsMessage:yH,MultiValue:oRe,MultiValueContainer:tRe,MultiValueLabel:nRe,MultiValueRemove:rRe,Option:cRe,Placeholder:dRe,SelectContainer:CTe,SingleValue:fRe,ValueContainer:TTe},gRe=function(n){return Ae(Ae({},mRe),n.components)},r6=Number.isNaN||function(n){return typeof n=="number"&&n!==n};function vRe(e,n){return!!(e===n||r6(e)&&r6(n))}function ERe(e,n){if(e.length!==n.length)return!1;for(var o=0;o<e.length;o++)if(!vRe(e[o],n[o]))return!1;return!0}function _Re(e,n){n===void 0&&(n=ERe);var o=null;function s(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];if(o&&o.lastThis===this&&n(c,o.lastArgs))return o.lastResult;var p=e.apply(this,c);return o={lastResult:p,lastArgs:c,lastThis:this},p}return s.clear=function(){o=null},s}var yRe={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},SRe=function(n){return Bt("span",Qe({css:yRe},n))},i6=SRe,CRe={guidance:function(n){var o=n.isSearchable,s=n.isMulti,c=n.isDisabled,d=n.tabSelectsValue,p=n.context;switch(p){case"menu":return"Use Up and Down to choose options".concat(c?"":", press Enter to select the currently focused option",", press Escape to exit the menu").concat(d?", press Tab to select the option and exit the menu":"",".");case"input":return"".concat(n["aria-label"]||"Select"," is focused ").concat(o?",type to refine list":"",", press Down to open the menu, ").concat(s?" press left to focus selected values":"");case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(n){var o=n.action,s=n.label,c=s===void 0?"":s,d=n.labels,p=n.isDisabled;switch(o){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(c,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(d.length>1?"s":""," ").concat(d.join(","),", selected.");case"select-option":return p?"option ".concat(c," is disabled. Select another option."):"option ".concat(c,", selected.");default:return""}},onFocus:function(n){var o=n.context,s=n.focused,c=n.options,d=n.label,p=d===void 0?"":d,m=n.selectValue,g=n.isDisabled,_=n.isSelected,S=function(O,A){return O&&O.length?"".concat(O.indexOf(A)+1," of ").concat(O.length):""};if(o==="value"&&m)return"value ".concat(p," focused, ").concat(S(m,s),".");if(o==="menu"){var T=g?" disabled":"",R="".concat(_?"selected":"focused").concat(T);return"option ".concat(p," ").concat(R,", ").concat(S(c,s),".")}return""},onFilter:function(n){var o=n.inputValue,s=n.resultsMessage;return"".concat(s).concat(o?" for search term "+o:"",".")}},bRe=function(n){var o=n.ariaSelection,s=n.focusedOption,c=n.focusedValue,d=n.focusableOptions,p=n.isFocused,m=n.selectValue,g=n.selectProps,_=n.id,S=g.ariaLiveMessages,T=g.getOptionLabel,R=g.inputValue,N=g.isMulti,O=g.isOptionDisabled,A=g.isSearchable,M=g.menuIsOpen,x=g.options,P=g.screenReaderStatus,D=g.tabSelectsValue,F=g["aria-label"],j=g["aria-live"],B=b.useMemo(function(){return Ae(Ae({},CRe),S||{})},[S]),H=b.useMemo(function(){var he="";if(o&&B.onChange){var pe=o.option,ce=o.options,se=o.removedValue,ae=o.removedValues,Ee=o.value,ve=function(Ve){return Array.isArray(Ve)?null:Ve},le=se||pe||ve(Ee),de=le?T(le):"",ye=ce||ae||void 0,fe=ye?ye.map(T):[],ke=Ae({isDisabled:le&&O(le,m),label:de,labels:fe},o);he=B.onChange(ke)}return he},[o,B,O,m,T]),K=b.useMemo(function(){var he="",pe=s||c,ce=!!(s&&m&&m.includes(s));if(pe&&B.onFocus){var se={focused:pe,label:T(pe),isDisabled:O(pe,m),isSelected:ce,options:d,context:pe===s?"menu":"value",selectValue:m};he=B.onFocus(se)}return he},[s,c,T,O,B,d,m]),J=b.useMemo(function(){var he="";if(M&&x.length&&B.onFilter){var pe=P({count:d.length});he=B.onFilter({inputValue:R,resultsMessage:pe})}return he},[d,R,M,B,x,P]),q=b.useMemo(function(){var he="";if(B.guidance){var pe=c?"value":M?"menu":"input";he=B.guidance({"aria-label":F,context:pe,isDisabled:s&&O(s,m),isMulti:N,isSearchable:A,tabSelectsValue:D})}return he},[F,s,c,N,O,A,M,B,m,D]),Q="".concat(K," ").concat(J," ").concat(q),ee=Bt(b.Fragment,null,Bt("span",{id:"aria-selection"},H),Bt("span",{id:"aria-context"},Q)),ne=(o==null?void 0:o.action)==="initial-input-focus";return Bt(b.Fragment,null,Bt(i6,{id:_},ne&&ee),Bt(i6,{"aria-live":j,"aria-atomic":"false","aria-relevant":"additions text"},p&&!ne&&ee))},TRe=bRe,RA=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],RRe=new RegExp("["+RA.map(function(e){return e.letters}).join("")+"]","g"),AH={};for(var vw=0;vw<RA.length;vw++)for(var Ew=RA[vw],_w=0;_w<Ew.letters.length;_w++)AH[Ew.letters[_w]]=Ew.base;var OH=function(n){return n.replace(RRe,function(o){return AH[o]})},wRe=_Re(OH),o6=function(n){return n.replace(/^\s+|\s+$/g,"")},IRe=function(n){return"".concat(n.label," ").concat(n.value)},ARe=function(n){return function(o,s){if(o.data.__isNew__)return!0;var c=Ae({ignoreCase:!0,ignoreAccents:!0,stringify:IRe,trim:!0,matchFrom:"any"},n),d=c.ignoreCase,p=c.ignoreAccents,m=c.stringify,g=c.trim,_=c.matchFrom,S=g?o6(s):s,T=g?o6(m(o)):m(o);return d&&(S=S.toLowerCase(),T=T.toLowerCase()),p&&(S=wRe(S),T=OH(T)),_==="start"?T.substr(0,S.length)===S:T.indexOf(S)>-1}},ORe=["innerRef"];function xRe(e){var n=e.innerRef,o=xn(e,ORe),s=cTe(o,"onExited","in","enter","exit","appear");return Bt("input",Qe({ref:n},s,{css:Fx({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var NRe=function(n){n.preventDefault(),n.stopPropagation()};function PRe(e){var n=e.isEnabled,o=e.onBottomArrive,s=e.onBottomLeave,c=e.onTopArrive,d=e.onTopLeave,p=b.useRef(!1),m=b.useRef(!1),g=b.useRef(0),_=b.useRef(null),S=b.useCallback(function(M,x){if(_.current!==null){var P=_.current,D=P.scrollTop,F=P.scrollHeight,j=P.clientHeight,B=_.current,H=x>0,K=F-j-D,J=!1;K>x&&p.current&&(s&&s(M),p.current=!1),H&&m.current&&(d&&d(M),m.current=!1),H&&x>K?(o&&!p.current&&o(M),B.scrollTop=F,J=!0,p.current=!0):!H&&-x>D&&(c&&!m.current&&c(M),B.scrollTop=0,J=!0,m.current=!0),J&&NRe(M)}},[o,s,c,d]),T=b.useCallback(function(M){S(M,M.deltaY)},[S]),R=b.useCallback(function(M){g.current=M.changedTouches[0].clientY},[]),N=b.useCallback(function(M){var x=g.current-M.changedTouches[0].clientY;S(M,x)},[S]),O=b.useCallback(function(M){if(M){var x=oTe?{passive:!1}:!1;M.addEventListener("wheel",T,x),M.addEventListener("touchstart",R,x),M.addEventListener("touchmove",N,x)}},[N,R,T]),A=b.useCallback(function(M){M&&(M.removeEventListener("wheel",T,!1),M.removeEventListener("touchstart",R,!1),M.removeEventListener("touchmove",N,!1))},[N,R,T]);return b.useEffect(function(){if(n){var M=_.current;return O(M),function(){A(M)}}},[n,O,A]),function(M){_.current=M}}var a6=["boxSizing","height","overflow","paddingRight","position"],s6={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function c6(e){e.preventDefault()}function l6(e){e.stopPropagation()}function u6(){var e=this.scrollTop,n=this.scrollHeight,o=e+this.offsetHeight;e===0?this.scrollTop=1:o===n&&(this.scrollTop=e-1)}function d6(){return"ontouchstart"in window||navigator.maxTouchPoints}var h6=!!(typeof window<"u"&&window.document&&window.document.createElement),F0=0,dp={capture:!1,passive:!1};function DRe(e){var n=e.isEnabled,o=e.accountForScrollbars,s=o===void 0?!0:o,c=b.useRef({}),d=b.useRef(null),p=b.useCallback(function(g){if(h6){var _=document.body,S=_&&_.style;if(s&&a6.forEach(function(O){var A=S&&S[O];c.current[O]=A}),s&&F0<1){var T=parseInt(c.current.paddingRight,10)||0,R=document.body?document.body.clientWidth:0,N=window.innerWidth-R+T||0;Object.keys(s6).forEach(function(O){var A=s6[O];S&&(S[O]=A)}),S&&(S.paddingRight="".concat(N,"px"))}_&&d6()&&(_.addEventListener("touchmove",c6,dp),g&&(g.addEventListener("touchstart",u6,dp),g.addEventListener("touchmove",l6,dp))),F0+=1}},[s]),m=b.useCallback(function(g){if(h6){var _=document.body,S=_&&_.style;F0=Math.max(F0-1,0),s&&F0<1&&a6.forEach(function(T){var R=c.current[T];S&&(S[T]=R)}),_&&d6()&&(_.removeEventListener("touchmove",c6,dp),g&&(g.removeEventListener("touchstart",u6,dp),g.removeEventListener("touchmove",l6,dp)))}},[s]);return b.useEffect(function(){if(n){var g=d.current;return p(g),function(){m(g)}}},[n,p,m]),function(g){d.current=g}}var kRe=function(){return document.activeElement&&document.activeElement.blur()},LRe={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function MRe(e){var n=e.children,o=e.lockEnabled,s=e.captureEnabled,c=s===void 0?!0:s,d=e.onBottomArrive,p=e.onBottomLeave,m=e.onTopArrive,g=e.onTopLeave,_=PRe({isEnabled:c,onBottomArrive:d,onBottomLeave:p,onTopArrive:m,onTopLeave:g}),S=DRe({isEnabled:o}),T=function(N){_(N),S(N)};return Bt(b.Fragment,null,o&&Bt("div",{onClick:kRe,css:LRe}),n(T))}var FRe={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},URe=function(n){var o=n.name,s=n.onFocus;return Bt("input",{required:!0,name:o,tabIndex:-1,"aria-hidden":"true",onFocus:s,css:FRe,value:"",onChange:function(){}})},BRe=URe,jRe=function(n){return n.label},VRe=function(n){return n.label},$Re=function(n){return n.value},HRe=function(n){return!!n.isDisabled},WRe={clearIndicator:NTe,container:STe,control:FTe,dropdownIndicator:OTe,group:VTe,groupHeading:HTe,indicatorsContainer:RTe,indicatorSeparator:DTe,input:KTe,loadingIndicator:MTe,loadingMessage:ETe,menu:dTe,menuList:mTe,menuPortal:_Te,multiValue:QTe,multiValueLabel:ZTe,multiValueRemove:eRe,noOptionsMessage:vTe,option:aRe,placeholder:lRe,singleValue:hRe,valueContainer:bTe},zRe={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},GRe=4,xH=4,KRe=38,qRe=xH*2,YRe={baseUnit:xH,controlHeight:KRe,menuGutter:qRe},yw={borderRadius:GRe,colors:zRe,spacing:YRe},XRe={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:t6(),captureMenuScroll:!t6(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:ARe(),formatGroupLabel:jRe,getOptionLabel:VRe,getOptionValue:$Re,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:HRe,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!rTe(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(n){var o=n.count;return"".concat(o," result").concat(o!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function p6(e,n,o,s){var c=kH(e,n,o),d=LH(e,n,o),p=DH(e,n),m=Ty(e,n);return{type:"option",data:n,isDisabled:c,isSelected:d,label:p,value:m,index:s}}function NH(e,n){return e.options.map(function(o,s){if("options"in o){var c=o.options.map(function(p,m){return p6(e,p,n,m)}).filter(function(p){return f6(e,p)});return c.length>0?{type:"group",data:o,options:c,index:s}:void 0}var d=p6(e,o,n,s);return f6(e,d)?d:void 0}).filter(aTe)}function PH(e){return e.reduce(function(n,o){return o.type==="group"?n.push.apply(n,ot(o.options.map(function(s){return s.data}))):n.push(o.data),n},[])}function JRe(e,n){return PH(NH(e,n))}function f6(e,n){var o=e.inputValue,s=o===void 0?"":o,c=n.data,d=n.isSelected,p=n.label,m=n.value;return(!FH(e)||!d)&&MH(e,{label:p,value:m,data:c},s)}function QRe(e,n){var o=e.focusedValue,s=e.selectValue,c=s.indexOf(o);if(c>-1){var d=n.indexOf(o);if(d>-1)return o;if(c<n.length)return n[c]}return null}function ZRe(e,n){var o=e.focusedOption;return o&&n.indexOf(o)>-1?o:n[0]}var DH=function(n,o){return n.getOptionLabel(o)},Ty=function(n,o){return n.getOptionValue(o)};function kH(e,n,o){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(n,o):!1}function LH(e,n,o){if(o.indexOf(n)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(n,o);var s=Ty(e,n);return o.some(function(c){return Ty(e,c)===s})}function MH(e,n,o){return e.filterOption?e.filterOption(n,o):!0}var FH=function(n){var o=n.hideSelectedOptions,s=n.isMulti;return o===void 0?s:o},e1e=1,UH=function(e){ef(o,e);var n=tf(o);function o(s){var c;if(bs(this,o),c=n.call(this,s),c.state={ariaSelection:null,focusedOption:null,focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0},c.blockOptionHover=!1,c.isComposing=!1,c.commonProps=void 0,c.initialTouchX=0,c.initialTouchY=0,c.instancePrefix="",c.openAfterFocus=!1,c.scrollToFocusedOptionOnUpdate=!1,c.userIsDragging=void 0,c.controlRef=null,c.getControlRef=function(m){c.controlRef=m},c.focusedOptionRef=null,c.getFocusedOptionRef=function(m){c.focusedOptionRef=m},c.menuListRef=null,c.getMenuListRef=function(m){c.menuListRef=m},c.inputRef=null,c.getInputRef=function(m){c.inputRef=m},c.focus=c.focusInput,c.blur=c.blurInput,c.onChange=function(m,g){var _=c.props,S=_.onChange,T=_.name;g.name=T,c.ariaOnChange(m,g),S(m,g)},c.setValue=function(m,g,_){var S=c.props,T=S.closeMenuOnSelect,R=S.isMulti,N=S.inputValue;c.onInputChange("",{action:"set-value",prevInputValue:N}),T&&(c.setState({inputIsHiddenAfterUpdate:!R}),c.onMenuClose()),c.setState({clearFocusValueOnUpdate:!0}),c.onChange(m,{action:g,option:_})},c.selectOption=function(m){var g=c.props,_=g.blurInputOnSelect,S=g.isMulti,T=g.name,R=c.state.selectValue,N=S&&c.isOptionSelected(m,R),O=c.isOptionDisabled(m,R);if(N){var A=c.getOptionValue(m);c.setValue(R.filter(function(M){return c.getOptionValue(M)!==A}),"deselect-option",m)}else if(!O)S?c.setValue([].concat(ot(R),[m]),"select-option",m):c.setValue(m,"select-option");else{c.ariaOnChange(m,{action:"select-option",option:m,name:T});return}_&&c.blurInput()},c.removeValue=function(m){var g=c.props.isMulti,_=c.state.selectValue,S=c.getOptionValue(m),T=_.filter(function(N){return c.getOptionValue(N)!==S}),R=ZE(g,T,T[0]||null);c.onChange(R,{action:"remove-value",removedValue:m}),c.focusInput()},c.clearValue=function(){var m=c.state.selectValue;c.onChange(ZE(c.props.isMulti,[],null),{action:"clear",removedValues:m})},c.popValue=function(){var m=c.props.isMulti,g=c.state.selectValue,_=g[g.length-1],S=g.slice(0,g.length-1),T=ZE(m,S,S[0]||null);c.onChange(T,{action:"pop-value",removedValue:_})},c.getValue=function(){return c.state.selectValue},c.cx=function(){for(var m=arguments.length,g=new Array(m),_=0;_<m;_++)g[_]=arguments[_];return Qbe.apply(void 0,[c.props.classNamePrefix].concat(g))},c.getOptionLabel=function(m){return DH(c.props,m)},c.getOptionValue=function(m){return Ty(c.props,m)},c.getStyles=function(m,g){var _=c.props.unstyled,S=WRe[m](g,_);S.boxSizing="border-box";var T=c.props.styles[m];return T?T(S,g):S},c.getClassNames=function(m,g){var _,S;return(_=(S=c.props.classNames)[m])===null||_===void 0?void 0:_.call(S,g)},c.getElementId=function(m){return"".concat(c.instancePrefix,"-").concat(m)},c.getComponents=function(){return gRe(c.props)},c.buildCategorizedOptions=function(){return NH(c.props,c.state.selectValue)},c.getCategorizedOptions=function(){return c.props.menuIsOpen?c.buildCategorizedOptions():[]},c.buildFocusableOptions=function(){return PH(c.buildCategorizedOptions())},c.getFocusableOptions=function(){return c.props.menuIsOpen?c.buildFocusableOptions():[]},c.ariaOnChange=function(m,g){c.setState({ariaSelection:Ae({value:m},g)})},c.onMenuMouseDown=function(m){m.button===0&&(m.stopPropagation(),m.preventDefault(),c.focusInput())},c.onMenuMouseMove=function(m){c.blockOptionHover=!1},c.onControlMouseDown=function(m){if(!m.defaultPrevented){var g=c.props.openMenuOnClick;c.state.isFocused?c.props.menuIsOpen?m.target.tagName!=="INPUT"&&m.target.tagName!=="TEXTAREA"&&c.onMenuClose():g&&c.openMenu("first"):(g&&(c.openAfterFocus=!0),c.focusInput()),m.target.tagName!=="INPUT"&&m.target.tagName!=="TEXTAREA"&&m.preventDefault()}},c.onDropdownIndicatorMouseDown=function(m){if(!(m&&m.type==="mousedown"&&m.button!==0)&&!c.props.isDisabled){var g=c.props,_=g.isMulti,S=g.menuIsOpen;c.focusInput(),S?(c.setState({inputIsHiddenAfterUpdate:!_}),c.onMenuClose()):c.openMenu("first"),m.preventDefault()}},c.onClearIndicatorMouseDown=function(m){m&&m.type==="mousedown"&&m.button!==0||(c.clearValue(),m.preventDefault(),c.openAfterFocus=!1,m.type==="touchend"?c.focusInput():setTimeout(function(){return c.focusInput()}))},c.onScroll=function(m){typeof c.props.closeMenuOnScroll=="boolean"?m.target instanceof HTMLElement&&WS(m.target)&&c.props.onMenuClose():typeof c.props.closeMenuOnScroll=="function"&&c.props.closeMenuOnScroll(m)&&c.props.onMenuClose()},c.onCompositionStart=function(){c.isComposing=!0},c.onCompositionEnd=function(){c.isComposing=!1},c.onTouchStart=function(m){var g=m.touches,_=g&&g.item(0);_&&(c.initialTouchX=_.clientX,c.initialTouchY=_.clientY,c.userIsDragging=!1)},c.onTouchMove=function(m){var g=m.touches,_=g&&g.item(0);if(_){var S=Math.abs(_.clientX-c.initialTouchX),T=Math.abs(_.clientY-c.initialTouchY),R=5;c.userIsDragging=S>R||T>R}},c.onTouchEnd=function(m){c.userIsDragging||(c.controlRef&&!c.controlRef.contains(m.target)&&c.menuListRef&&!c.menuListRef.contains(m.target)&&c.blurInput(),c.initialTouchX=0,c.initialTouchY=0)},c.onControlTouchEnd=function(m){c.userIsDragging||c.onControlMouseDown(m)},c.onClearIndicatorTouchEnd=function(m){c.userIsDragging||c.onClearIndicatorMouseDown(m)},c.onDropdownIndicatorTouchEnd=function(m){c.userIsDragging||c.onDropdownIndicatorMouseDown(m)},c.handleInputChange=function(m){var g=c.props.inputValue,_=m.currentTarget.value;c.setState({inputIsHiddenAfterUpdate:!1}),c.onInputChange(_,{action:"input-change",prevInputValue:g}),c.props.menuIsOpen||c.onMenuOpen()},c.onInputFocus=function(m){c.props.onFocus&&c.props.onFocus(m),c.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(c.openAfterFocus||c.props.openMenuOnFocus)&&c.openMenu("first"),c.openAfterFocus=!1},c.onInputBlur=function(m){var g=c.props.inputValue;if(c.menuListRef&&c.menuListRef.contains(document.activeElement)){c.inputRef.focus();return}c.props.onBlur&&c.props.onBlur(m),c.onInputChange("",{action:"input-blur",prevInputValue:g}),c.onMenuClose(),c.setState({focusedValue:null,isFocused:!1})},c.onOptionHover=function(m){c.blockOptionHover||c.state.focusedOption===m||c.setState({focusedOption:m})},c.shouldHideSelectedOptions=function(){return FH(c.props)},c.onValueInputFocus=function(m){m.preventDefault(),m.stopPropagation(),c.focus()},c.onKeyDown=function(m){var g=c.props,_=g.isMulti,S=g.backspaceRemovesValue,T=g.escapeClearsValue,R=g.inputValue,N=g.isClearable,O=g.isDisabled,A=g.menuIsOpen,M=g.onKeyDown,x=g.tabSelectsValue,P=g.openMenuOnFocus,D=c.state,F=D.focusedOption,j=D.focusedValue,B=D.selectValue;if(!O&&!(typeof M=="function"&&(M(m),m.defaultPrevented))){switch(c.blockOptionHover=!0,m.key){case"ArrowLeft":if(!_||R)return;c.focusValue("previous");break;case"ArrowRight":if(!_||R)return;c.focusValue("next");break;case"Delete":case"Backspace":if(R)return;if(j)c.removeValue(j);else{if(!S)return;_?c.popValue():N&&c.clearValue()}break;case"Tab":if(c.isComposing||m.shiftKey||!A||!x||!F||P&&c.isOptionSelected(F,B))return;c.selectOption(F);break;case"Enter":if(m.keyCode===229)break;if(A){if(!F||c.isComposing)return;c.selectOption(F);break}return;case"Escape":A?(c.setState({inputIsHiddenAfterUpdate:!1}),c.onInputChange("",{action:"menu-close",prevInputValue:R}),c.onMenuClose()):N&&T&&c.clearValue();break;case" ":if(R)return;if(!A){c.openMenu("first");break}if(!F)return;c.selectOption(F);break;case"ArrowUp":A?c.focusOption("up"):c.openMenu("last");break;case"ArrowDown":A?c.focusOption("down"):c.openMenu("first");break;case"PageUp":if(!A)return;c.focusOption("pageup");break;case"PageDown":if(!A)return;c.focusOption("pagedown");break;case"Home":if(!A)return;c.focusOption("first");break;case"End":if(!A)return;c.focusOption("last");break;default:return}m.preventDefault()}},c.instancePrefix="react-select-"+(c.props.instanceId||++e1e),c.state.selectValue=ZB(s.value),s.menuIsOpen&&c.state.selectValue.length){var d=c.buildFocusableOptions(),p=d.indexOf(c.state.selectValue[0]);c.state.focusedOption=d[p]}return c}return Ts(o,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&e6(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(c){var d=this.props,p=d.isDisabled,m=d.menuIsOpen,g=this.state.isFocused;(g&&!p&&c.isDisabled||g&&m&&!c.menuIsOpen)&&this.focusInput(),g&&p&&!c.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!g&&!p&&c.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(e6(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(c,d){this.props.onInputChange(c,d)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(c){var d=this,p=this.state,m=p.selectValue,g=p.isFocused,_=this.buildFocusableOptions(),S=c==="first"?0:_.length-1;if(!this.props.isMulti){var T=_.indexOf(m[0]);T>-1&&(S=T)}this.scrollToFocusedOptionOnUpdate=!(g&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:_[S]},function(){return d.onMenuOpen()})}},{key:"focusValue",value:function(c){var d=this.state,p=d.selectValue,m=d.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var g=p.indexOf(m);m||(g=-1);var _=p.length-1,S=-1;if(p.length){switch(c){case"previous":g===0?S=0:g===-1?S=_:S=g-1;break;case"next":g>-1&&g<_&&(S=g+1);break}this.setState({inputIsHidden:S!==-1,focusedValue:p[S]})}}}},{key:"focusOption",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",d=this.props.pageSize,p=this.state.focusedOption,m=this.getFocusableOptions();if(m.length){var g=0,_=m.indexOf(p);p||(_=-1),c==="up"?g=_>0?_-1:m.length-1:c==="down"?g=(_+1)%m.length:c==="pageup"?(g=_-d,g<0&&(g=0)):c==="pagedown"?(g=_+d,g>m.length-1&&(g=m.length-1)):c==="last"&&(g=m.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:m[g],focusedValue:null})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(yw):Ae(Ae({},yw),this.props.theme):yw}},{key:"getCommonProps",value:function(){var c=this.clearValue,d=this.cx,p=this.getStyles,m=this.getClassNames,g=this.getValue,_=this.selectOption,S=this.setValue,T=this.props,R=T.isMulti,N=T.isRtl,O=T.options,A=this.hasValue();return{clearValue:c,cx:d,getStyles:p,getClassNames:m,getValue:g,hasValue:A,isMulti:R,isRtl:N,options:O,selectOption:_,selectProps:T,setValue:S,theme:this.getTheme()}}},{key:"hasValue",value:function(){var c=this.state.selectValue;return c.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var c=this.props,d=c.isClearable,p=c.isMulti;return d===void 0?p:d}},{key:"isOptionDisabled",value:function(c,d){return kH(this.props,c,d)}},{key:"isOptionSelected",value:function(c,d){return LH(this.props,c,d)}},{key:"filterOption",value:function(c,d){return MH(this.props,c,d)}},{key:"formatOptionLabel",value:function(c,d){if(typeof this.props.formatOptionLabel=="function"){var p=this.props.inputValue,m=this.state.selectValue;return this.props.formatOptionLabel(c,{context:d,inputValue:p,selectValue:m})}else return this.getOptionLabel(c)}},{key:"formatGroupLabel",value:function(c){return this.props.formatGroupLabel(c)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var c=this.props,d=c.isDisabled,p=c.isSearchable,m=c.inputId,g=c.inputValue,_=c.tabIndex,S=c.form,T=c.menuIsOpen,R=c.required,N=this.getComponents(),O=N.Input,A=this.state,M=A.inputIsHidden,x=A.ariaSelection,P=this.commonProps,D=m||this.getElementId("input"),F=Ae(Ae(Ae({"aria-autocomplete":"list","aria-expanded":T,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":R,role:"combobox"},T&&{"aria-controls":this.getElementId("listbox"),"aria-owns":this.getElementId("listbox")}),!p&&{"aria-readonly":!0}),this.hasValue()?(x==null?void 0:x.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return p?b.createElement(O,Qe({},P,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:D,innerRef:this.getInputRef,isDisabled:d,isHidden:M,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:_,form:S,type:"text",value:g},F)):b.createElement(xRe,Qe({id:D,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:Cy,onFocus:this.onInputFocus,disabled:d,tabIndex:_,inputMode:"none",form:S,value:""},F))}},{key:"renderPlaceholderOrValue",value:function(){var c=this,d=this.getComponents(),p=d.MultiValue,m=d.MultiValueContainer,g=d.MultiValueLabel,_=d.MultiValueRemove,S=d.SingleValue,T=d.Placeholder,R=this.commonProps,N=this.props,O=N.controlShouldRenderValue,A=N.isDisabled,M=N.isMulti,x=N.inputValue,P=N.placeholder,D=this.state,F=D.selectValue,j=D.focusedValue,B=D.isFocused;if(!this.hasValue()||!O)return x?null:b.createElement(T,Qe({},R,{key:"placeholder",isDisabled:A,isFocused:B,innerProps:{id:this.getElementId("placeholder")}}),P);if(M)return F.map(function(K,J){var q=K===j,Q="".concat(c.getOptionLabel(K),"-").concat(c.getOptionValue(K));return b.createElement(p,Qe({},R,{components:{Container:m,Label:g,Remove:_},isFocused:q,isDisabled:A,key:Q,index:J,removeProps:{onClick:function(){return c.removeValue(K)},onTouchEnd:function(){return c.removeValue(K)},onMouseDown:function(ne){ne.preventDefault()}},data:K}),c.formatOptionLabel(K,"value"))});if(x)return null;var H=F[0];return b.createElement(S,Qe({},R,{data:H,isDisabled:A}),this.formatOptionLabel(H,"value"))}},{key:"renderClearIndicator",value:function(){var c=this.getComponents(),d=c.ClearIndicator,p=this.commonProps,m=this.props,g=m.isDisabled,_=m.isLoading,S=this.state.isFocused;if(!this.isClearable()||!d||g||!this.hasValue()||_)return null;var T={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return b.createElement(d,Qe({},p,{innerProps:T,isFocused:S}))}},{key:"renderLoadingIndicator",value:function(){var c=this.getComponents(),d=c.LoadingIndicator,p=this.commonProps,m=this.props,g=m.isDisabled,_=m.isLoading,S=this.state.isFocused;if(!d||!_)return null;var T={"aria-hidden":"true"};return b.createElement(d,Qe({},p,{innerProps:T,isDisabled:g,isFocused:S}))}},{key:"renderIndicatorSeparator",value:function(){var c=this.getComponents(),d=c.DropdownIndicator,p=c.IndicatorSeparator;if(!d||!p)return null;var m=this.commonProps,g=this.props.isDisabled,_=this.state.isFocused;return b.createElement(p,Qe({},m,{isDisabled:g,isFocused:_}))}},{key:"renderDropdownIndicator",value:function(){var c=this.getComponents(),d=c.DropdownIndicator;if(!d)return null;var p=this.commonProps,m=this.props.isDisabled,g=this.state.isFocused,_={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return b.createElement(d,Qe({},p,{innerProps:_,isDisabled:m,isFocused:g}))}},{key:"renderMenu",value:function(){var c=this,d=this.getComponents(),p=d.Group,m=d.GroupHeading,g=d.Menu,_=d.MenuList,S=d.MenuPortal,T=d.LoadingMessage,R=d.NoOptionsMessage,N=d.Option,O=this.commonProps,A=this.state.focusedOption,M=this.props,x=M.captureMenuScroll,P=M.inputValue,D=M.isLoading,F=M.loadingMessage,j=M.minMenuHeight,B=M.maxMenuHeight,H=M.menuIsOpen,K=M.menuPlacement,J=M.menuPosition,q=M.menuPortalTarget,Q=M.menuShouldBlockScroll,ee=M.menuShouldScrollIntoView,ne=M.noOptionsMessage,he=M.onMenuScrollToTop,pe=M.onMenuScrollToBottom;if(!H)return null;var ce=function(ye,fe){var ke=ye.type,Me=ye.data,Ve=ye.isDisabled,je=ye.isSelected,dt=ye.label,ut=ye.value,Ct=A===Me,_t=Ve?void 0:function(){return c.onOptionHover(Me)},Tt=Ve?void 0:function(){return c.selectOption(Me)},it="".concat(c.getElementId("option"),"-").concat(fe),kt={id:it,onClick:Tt,onMouseMove:_t,onMouseOver:_t,tabIndex:-1};return b.createElement(N,Qe({},O,{innerProps:kt,data:Me,isDisabled:Ve,isSelected:je,key:it,label:dt,type:ke,value:ut,isFocused:Ct,innerRef:Ct?c.getFocusedOptionRef:void 0}),c.formatOptionLabel(ye.data,"menu"))},se;if(this.hasOptions())se=this.getCategorizedOptions().map(function(de){if(de.type==="group"){var ye=de.data,fe=de.options,ke=de.index,Me="".concat(c.getElementId("group"),"-").concat(ke),Ve="".concat(Me,"-heading");return b.createElement(p,Qe({},O,{key:Me,data:ye,options:fe,Heading:m,headingProps:{id:Ve,data:de.data},label:c.formatGroupLabel(de.data)}),de.options.map(function(je){return ce(je,"".concat(ke,"-").concat(je.index))}))}else if(de.type==="option")return ce(de,"".concat(de.index))});else if(D){var ae=F({inputValue:P});if(ae===null)return null;se=b.createElement(T,O,ae)}else{var Ee=ne({inputValue:P});if(Ee===null)return null;se=b.createElement(R,O,Ee)}var ve={minMenuHeight:j,maxMenuHeight:B,menuPlacement:K,menuPosition:J,menuShouldScrollIntoView:ee},le=b.createElement(hTe,Qe({},O,ve),function(de){var ye=de.ref,fe=de.placerProps,ke=fe.placement,Me=fe.maxHeight;return b.createElement(g,Qe({},O,ve,{innerRef:ye,innerProps:{onMouseDown:c.onMenuMouseDown,onMouseMove:c.onMenuMouseMove,id:c.getElementId("listbox")},isLoading:D,placement:ke}),b.createElement(MRe,{captureEnabled:x,onTopArrive:he,onBottomArrive:pe,lockEnabled:Q},function(Ve){return b.createElement(_,Qe({},O,{innerRef:function(dt){c.getMenuListRef(dt),Ve(dt)},isLoading:D,maxHeight:Me,focusedOption:A}),se)}))});return q||J==="fixed"?b.createElement(S,Qe({},O,{appendTo:q,controlElement:this.controlRef,menuPlacement:K,menuPosition:J}),le):le}},{key:"renderFormField",value:function(){var c=this,d=this.props,p=d.delimiter,m=d.isDisabled,g=d.isMulti,_=d.name,S=d.required,T=this.state.selectValue;if(S&&!this.hasValue()&&!m)return b.createElement(BRe,{name:_,onFocus:this.onValueInputFocus});if(!(!_||m))if(g)if(p){var R=T.map(function(A){return c.getOptionValue(A)}).join(p);return b.createElement("input",{name:_,type:"hidden",value:R})}else{var N=T.length>0?T.map(function(A,M){return b.createElement("input",{key:"i-".concat(M),name:_,type:"hidden",value:c.getOptionValue(A)})}):b.createElement("input",{name:_,type:"hidden",value:""});return b.createElement("div",null,N)}else{var O=T[0]?this.getOptionValue(T[0]):"";return b.createElement("input",{name:_,type:"hidden",value:O})}}},{key:"renderLiveRegion",value:function(){var c=this.commonProps,d=this.state,p=d.ariaSelection,m=d.focusedOption,g=d.focusedValue,_=d.isFocused,S=d.selectValue,T=this.getFocusableOptions();return b.createElement(TRe,Qe({},c,{id:this.getElementId("live-region"),ariaSelection:p,focusedOption:m,focusedValue:g,isFocused:_,selectValue:S,focusableOptions:T}))}},{key:"render",value:function(){var c=this.getComponents(),d=c.Control,p=c.IndicatorsContainer,m=c.SelectContainer,g=c.ValueContainer,_=this.props,S=_.className,T=_.id,R=_.isDisabled,N=_.menuIsOpen,O=this.state.isFocused,A=this.commonProps=this.getCommonProps();return b.createElement(m,Qe({},A,{className:S,innerProps:{id:T,onKeyDown:this.onKeyDown},isDisabled:R,isFocused:O}),this.renderLiveRegion(),b.createElement(d,Qe({},A,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:R,isFocused:O,menuIsOpen:N}),b.createElement(g,Qe({},A,{isDisabled:R}),this.renderPlaceholderOrValue(),this.renderInput()),b.createElement(p,Qe({},A,{isDisabled:R}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(c,d){var p=d.prevProps,m=d.clearFocusValueOnUpdate,g=d.inputIsHiddenAfterUpdate,_=d.ariaSelection,S=d.isFocused,T=d.prevWasFocused,R=c.options,N=c.value,O=c.menuIsOpen,A=c.inputValue,M=c.isMulti,x=ZB(N),P={};if(p&&(N!==p.value||R!==p.options||O!==p.menuIsOpen||A!==p.inputValue)){var D=O?JRe(c,x):[],F=m?QRe(d,x):null,j=ZRe(d,D);P={selectValue:x,focusedOption:j,focusedValue:F,clearFocusValueOnUpdate:!1}}var B=g!=null&&c!==p?{inputIsHidden:g,inputIsHiddenAfterUpdate:void 0}:{},H=_,K=S&&T;return S&&!K&&(H={value:ZE(M,x,x[0]||null),options:x,action:"initial-input-focus"},K=!T),(_==null?void 0:_.action)==="initial-input-focus"&&(H=null),Ae(Ae(Ae({},P),B),{},{prevProps:c,ariaSelection:H,prevWasFocused:K})}}]),o}(b.Component);UH.defaultProps=XRe;var t1e=b.forwardRef(function(e,n){var o=kCe(e);return b.createElement(UH,Qe({ref:n},o))}),n1e=t1e;const{Title:r1e,Paragraph:i1e}=No,o1e=b.memo(function({label:n}){const s=ac().filter(g=>g.hasAudio||g.hasVideo),c=um(g=>g.localTracks),d=um(g=>g.hostRoom),p=Is(),m=ws();return te.jsxs("div",{className:"room-selector-item",children:[te.jsx("i",{className:"i-mdi-chat-processing-outline text-5 color-zinc"}),te.jsx("code",{className:"bg-rose color-white px-2 rounded",children:n}),p&&c&&m.uid&&(d==null?void 0:d.client.channelName)===m.channelName&&te.jsxs("div",{className:"user",children:[te.jsx(k9,{audioTrack:c[0],cameraOn:!0,micOn:!0,videoTrack:c[1]}),te.jsx("div",{className:"mask"}),te.jsx("label",{className:"label",children:rc(m.uid)})]},m.uid),te.jsx(te.Fragment,{children:s.map(g=>te.jsxs("div",{className:"user",children:[te.jsx(_x,{user:g}),te.jsx("div",{className:"mask"}),te.jsx("label",{className:"label",children:rc(g.uid)})]},g.uid))})]})}),a1e=({innerProps:e,isDisabled:n,label:o,data:s})=>{const{client:c}=s.value;return n?null:te.jsx("div",{...e,children:te.jsx(x9,{client:c,children:te.jsx(o1e,{label:o})})})},s1e=()=>{const e=um(p=>p.getRooms),[n,o]=b.useState(!1);b.useEffect(()=>{e()},[]);const s=um(p=>p.rooms),c=um(p=>p.selectChannel),d=b.useMemo(()=>s==null?void 0:s.map(p=>({label:p.channel.replace(/[^0-9]*/,"Room"),value:p})),[s]);return te.jsx(oi,{children:n?te.jsx("div",{className:"max-w-lg p-10",children:te.jsx(n1e,{components:{Option:a1e},isMulti:!1,menuIsOpen:!0,onChange:p=>{var m;return c((m=p==null?void 0:p.value)==null?void 0:m.channel)},options:d})}):te.jsxs("div",{className:"h-screen p-3",children:[te.jsx(r1e,{children:"multi-channel"}),te.jsx(i1e,{children:"This is multi-channel example. By create multi Agora Client. You can join multi-channel"}),te.jsx("div",{className:"text-xl",children:te.jsx(Oi,{onClick:()=>o(!0),type:"primary",children:"show demo"})})]})})};function BH({videoTracks:e}){return te.jsx(te.Fragment,{children:e.map(n=>te.jsxs(_s.Item,{children:[te.jsx(sg,{cover:Fc(),track:n},n.getUserId()),te.jsx(_l,{children:`${rc(n.getUserId())}{${n.getUserId()}}`})]},n.getUserId()))})}const c1e=()=>{const[e,n]=b.useState(!1);xi({appid:ht.appId,channel:ht.channel,token:ht.token},e);const[o,s]=b.useState(!1),[c,d]=b.useState(!1),[p,m]=b.useState(!1),{screenTrack:g,error:_}=N9(p,{},"auto");b.useEffect(()=>{m(!1)},[_]);const S=ac(),{videoTracks:T}=mf(S.filter(N=>N.uid!==ht.ShareScreenUID)),{audioTracks:R}=ff(S.filter(N=>N.uid!==ht.ShareScreenUID));return R.map(N=>N.play()),te.jsxs(oi,{children:[te.jsx("div",{className:"h-screen p-3",children:e&&te.jsxs(te.Fragment,{children:[te.jsx(Oi,{onClick:()=>m(N=>!N),type:"primary",children:p?"stop share screen":"start share screen"}),p&&te.jsx(aCe,{onCloseScreenShare:()=>{m(!1)},screenShareOn:p,screenTrack:g}),te.jsx(OS,{cameraOn:c,micOn:o,renderRemoteUsers:()=>te.jsx(BH,{videoTracks:T})})]})}),te.jsx(_a,{calling:e,cameraOn:c,micOn:o,setCalling:()=>{n(N=>!N),m(!1)},setCamera:()=>{d(N=>!N)},setMic:()=>{s(N=>!N)}})]})};const{Title:l1e,Paragraph:u1e,Text:d1e}=No,h1e=()=>{const[e,n]=b.useState(!1);xi({appid:ht.appId,channel:ht.channel,token:ht.token},e);const[o,s]=b.useState(!1),[c,d]=b.useState(!1),p=ac(),[m,g]=b.useState(!0),{videoTracks:_}=mf(m?p:p.filter((N,O)=>O==0)),{audioTracks:S}=ff(p);S.map(N=>N.play());const T=()=>te.jsx("div",{className:"p-4 text-xl",children:te.jsx(Oi,{onClick:()=>g(N=>!N),type:"primary",children:`switch to layout ${m?2:1}`})}),R=()=>te.jsx(te.Fragment,{children:m?te.jsx(p1e,{videoTracks:_}):te.jsx(f1e,{videoTracks:_})});return te.jsxs(oi,{children:[e?te.jsx(OS,{cameraOn:c,micOn:o,renderAction:T,renderRemoteUsers:R}):te.jsxs("div",{className:"h-screen p-3",children:[te.jsx(l1e,{children:"SwitchLayout"}),te.jsxs(u1e,{children:["By using ",te.jsx(d1e,{keyboard:!0,children:"useRemoteVideoTracks"})," hook to dynamically switch the camera track, this will not generate a new track, but only dynamically subscribe and unsubscribe the track according to your needs."]})]}),te.jsx(_a,{calling:e,cameraOn:c,micOn:o,setCalling:()=>{n(N=>!N)},setCamera:()=>{d(N=>!N)},setMic:()=>{s(N=>!N)}})]})};function p1e({videoTracks:e}){return te.jsx(te.Fragment,{children:e.map(n=>te.jsxs(_s.Item,{children:[te.jsx(sg,{cover:Fc(),track:n},n.getUserId()),te.jsx(_l,{children:`Layout1 ${rc(n.getUserId())}{${n.getUserId()}}`})]},n.getUserId()))})}function f1e({videoTracks:e}){return te.jsx(te.Fragment,{children:e.map(n=>te.jsxs(_s.Item,{children:[te.jsx(sg,{cover:Fc(),track:n},n.getUserId()),te.jsx(_l,{children:`Layout2 ${rc(n.getUserId())}{${n.getUserId()}}`})]},n.getUserId()))})}const jH=[{label:"switch-layout",component:h1e},{label:"multi-channel",component:s1e},{label:"share-screen",component:c1e}],m1e=()=>{const[e,n]=b.useState(!1);xi({appid:ht.appId,channel:ht.channel,token:ht.token},e);const[o,s]=b.useState(!1),[c,d]=b.useState(!1),p=ac(),{videoTracks:m}=mf(p),{audioTracks:g}=ff(p);return g.map(_=>_.play()),te.jsxs(oi,{children:[e?te.jsx(OS,{cameraOn:c,micOn:o,renderRemoteUsers:()=>te.jsx(BH,{videoTracks:m})}):te.jsx(oi,{}),te.jsx(_a,{calling:e,cameraOn:c,micOn:o,setCalling:()=>{n(_=>!_)},setCamera:()=>{d(_=>!_)},setMic:()=>{s(_=>!_)}})]})},VH=[{label:"overview",component:m1e}],{Title:g1e,Paragraph:Sw}=No,v1e=()=>{xi({appid:ht.appId,channel:ht.channel,token:ht.token},!0);const[e,n]=b.useState(!1),[o,s]=b.useState(),{localMicrophoneTrack:c}=hf(e);return ku([c]),b.useEffect(()=>{c&&s({muted:c.muted,isPlaying:c.isPlaying,enabled:c.enabled})},[e,c]),te.jsxs(oi,{children:[te.jsxs("div",{className:"h-screen p-3",children:[te.jsx(g1e,{children:"local audio track status"}),o&&te.jsxs(te.Fragment,{children:[te.jsx(Sw,{children:`muted: ${o==null?void 0:o.muted}`}),te.jsx(Sw,{children:`isPlaying: ${o.isPlaying}`}),te.jsx(Sw,{children:`enabled: ${o==null?void 0:o.enabled}`})]}),te.jsx(RS,{disabled:!e,track:c})]}),te.jsx(_a,{micOn:e,setMic:()=>{n(d=>!d)}})]})},{Title:E1e}=No,_1e=()=>{xi({appid:ht.appId,channel:ht.channel,token:ht.token},!0);const[e,n]=b.useState(!1),[o,s]=b.useState(!1),[c,d]=b.useState(!1),[p,m]=b.useState(!1),{localMicrophoneTrack:g}=hf(e),{localCameraTrack:_}=pf(o);return ku([g,_]),te.jsxs(oi,{children:[te.jsxs("div",{className:"h-screen p-3 overflow-auto",children:[te.jsx(E1e,{children:"local user status"}),te.jsxs(Oi,{className:"m-2",onClick:()=>{m(S=>!S)},type:p?"primary":"default",children:["playAudio : ",JSON.stringify(p)]}),te.jsxs(Oi,{className:"m-2",onClick:()=>{d(S=>!S)},type:c?"primary":"default",children:["playVideo : ",JSON.stringify(c)]}),te.jsx(Oi,{className:"m-2",onClick:()=>{d(!0),s(!1)},type:"primary",children:"cameraOn=false playVideo=true"}),te.jsx(Oi,{className:"m-2",onClick:()=>{d(!1),s(!0)},type:"primary",children:"cameraOn=true playVideo=false"}),te.jsx(k9,{audioTrack:g,cameraOn:o,className:"m-2",micOn:e,playAudio:p,playVideo:c,style:{width:"300px",height:"300px"},videoTrack:_})]}),te.jsx(_a,{cameraOn:o,micOn:e,setCamera:()=>{s(S=>!S)},setMic:()=>{n(S=>!S)}})]})},{Title:y1e}=No,S1e=()=>{xi({appid:ht.appId,channel:ht.channel,token:ht.token},!0);const[e,n]=b.useState(!1),{localCameraTrack:o}=pf();return ku([o]),te.jsxs(oi,{children:[te.jsxs("div",{className:"h-screen p-3",children:[te.jsx(y1e,{children:"local video track"}),te.jsx(ag,{disabled:!e,play:e,style:{width:"300px",height:"300px"},track:o})]}),te.jsx(_a,{cameraOn:e,setCamera:()=>{n(s=>!s)}})]})},{Title:C1e}=No,b1e=()=>{const[e,n]=b.useState(!1);xi({appid:ht.appId,channel:ht.channel,token:ht.token},e);const[o,s]=b.useState(),c=ac(),{audioTracks:d}=ff(c);return b.useEffect(()=>{if(d&&d.length>0){const p=[];d.map(m=>{p.push({isPlay:m.isPlaying,id:m.getTrackId(),track:m})}),s(p)}else s([])},[d]),b.useEffect(()=>{e||s([])},[e]),te.jsxs(oi,{children:[te.jsxs("div",{className:"h-screen p-3",children:[te.jsx(C1e,{children:"remote audio track status"}),o&&o.length>0&&o.map(p=>te.jsxs("div",{children:[te.jsx("div",{className:"p-4 text-xl",children:te.jsx(Oi,{onClick:()=>{p.isPlay=!p.isPlay,s([...o])},type:"primary",children:"switch this remote audio track play status"})}),p.isPlay,te.jsx(L9,{play:p.isPlay,track:p.track})]},p.id))]}),te.jsx(_a,{calling:e,setCalling:()=>{n(p=>!p)}})]})},{Title:T1e}=No,R1e=()=>{const[e,n]=b.useState(!1),o=b.useMemo(()=>Fc(),[]);xi({appid:ht.appId,channel:ht.channel,token:ht.token},e);const[s,c]=b.useState(),d=ac();return b.useEffect(()=>{if(d.length>0){const p=[];d.map(m=>{p.push({playVideo:!0,playAudio:!0,id:m.uid,user:m})}),c(p)}else c([])},[d]),b.useEffect(()=>{e||c([])},[e]),te.jsxs(oi,{children:[te.jsxs("div",{className:"h-screen p-3",children:[te.jsx(T1e,{children:"RemoteUser"}),s&&s.length>0&&s.map(p=>te.jsxs("div",{children:[te.jsxs("div",{className:"text-xl",children:[te.jsx(Oi,{className:"m-2",onClick:()=>{p.playVideo=!p.playVideo,c([...s])},type:p.playVideo?"default":"primary",children:`${p.playVideo?"stop":"play"} RemoteUser Video`}),te.jsx(Oi,{className:"m-2",onClick:()=>{p.playAudio=!p.playAudio,c([...s])},type:p.playAudio?"default":"primary",children:`${p.playAudio?"stop":"play"} RemoteUser Audio`})]}),te.jsx("div",{className:"p-4 text-xl",children:te.jsx(_x,{cover:o,playAudio:p.playAudio,playVideo:p.playVideo,style:{width:"150px",height:"100px"},user:p.user})})]},p.id))]}),te.jsx(_a,{calling:e,setCalling:()=>{n(p=>!p)}})]})},{Title:w1e}=No,I1e=()=>{const[e,n]=b.useState(!1);xi({appid:ht.appId,channel:ht.channel,token:ht.token},e);const[o,s]=b.useState(),c=ac(),{videoTracks:d}=mf(c);return b.useEffect(()=>{if(d&&d.length>0){const p=[];d.map(m=>{p.push({isPlay:!0,id:m.getTrackId(),track:m})}),s(p)}else s([])},[d]),b.useEffect(()=>{e||s([])},[e]),te.jsxs(oi,{children:[te.jsxs("div",{className:"h-screen p-3",children:[te.jsx(w1e,{children:"remote video track status"}),o&&o.length>0&&o.map(p=>te.jsxs("div",{children:[te.jsx("div",{className:"p-4 text-xl",children:te.jsx(Oi,{onClick:()=>{p.isPlay=!p.isPlay,s([...o])},type:"primary",children:"switch this remote video track play status"})}),te.jsx("div",{className:"p-4 text-xl",children:te.jsx(Ex,{play:p.isPlay,style:{width:"150px",height:"100px"},track:p.track})})]},p.id))]}),te.jsx(_a,{calling:e,setCalling:()=>{n(p=>!p)}})]})},$H=[{label:"LocalAudioTrack",component:v1e},{label:"RemoteAudioTrack",component:b1e},{label:"LocalVideoTrack",component:S1e},{label:"RemoteVideoTrack",component:I1e},{label:"LocalUser",component:_1e},{label:"RemoteUser",component:R1e}],{Title:A1e}=No,O1e=()=>{xi({appid:ht.appId,channel:ht.channel,token:ht.token},!0);const[e,n]=b.useState(!1),{localMicrophoneTrack:o}=hf();return vx(o,e),te.jsxs(oi,{children:[te.jsx("div",{className:"h-screen p-3",children:te.jsx(A1e,{children:"useAutoPlayAudioTrack"})}),te.jsx(_a,{micOn:e,setMic:()=>{n(s=>!s)}})]})},{Title:x1e}=No,N1e=()=>{xi({appid:ht.appId,channel:ht.channel,token:ht.token},!0);const[e,n]=b.useState(!1),o=b.useRef(null),{localCameraTrack:s}=pf();return gx(s,e,o.current),te.jsxs(oi,{children:[te.jsxs("div",{className:"h-screen p-3",children:[te.jsx(x1e,{children:"useAutoPlayVideoTrack"}),te.jsx("div",{className:"p-4 text-xl",children:te.jsx("div",{ref:c=>o.current=c,style:{width:"150px",height:"100px"}})})]}),te.jsx(_a,{cameraOn:e,setCamera:()=>{n(c=>!c)}})]})},{Title:P1e,Paragraph:Cw,Text:D1e}=No,k1e=()=>{const[e,n]=b.useState(!1),o=nSe();return xi({appid:ht.appId,channel:ht.channel,token:ht.token},e),te.jsx(oi,{children:te.jsxs("div",{className:"h-screen p-3",children:[te.jsx(P1e,{children:"useConnectionState"}),te.jsxs(Cw,{children:["By using ",te.jsx(D1e,{keyboard:!0,children:"useConnectionState"})," hook to get the current connection state of the client."]}),te.jsx(Cw,{children:`result: ${o}`}),te.jsxs(Cw,{children:[te.jsx(Oi,{className:"m-1",onClick:()=>n(!0),type:"primary",children:"Join"}),te.jsx(Oi,{className:"m-1",onClick:()=>n(!1),type:"default",children:"Leave"})]})]})})},{Title:L1e,Paragraph:bw,Text:M1e}=No,F1e=()=>{const[e,n]=b.useState(!1),o=TS();return xi({appid:ht.appId,channel:ht.channel,token:ht.token},e),te.jsx(oi,{children:te.jsxs("div",{className:"h-screen p-3",children:[te.jsx(L1e,{children:"useCurrentUID"}),te.jsxs(bw,{children:["By using ",te.jsx(M1e,{keyboard:!0,children:"useCurrentUID"})," hook to get the UID of the current user."]}),te.jsx(bw,{children:`result: ${o}`}),te.jsxs(bw,{children:[te.jsx(Oi,{className:"m-1",onClick:()=>n(!0),type:"primary",children:"Join"}),te.jsx(Oi,{className:"m-1",onClick:()=>n(!1),type:"default",children:"Leave"})]})]})})},{Title:U1e,Paragraph:Tw,Text:B1e}=No,j1e=()=>{const[e,n]=b.useState(!1),o=Is();return xi({appid:ht.appId,channel:ht.channel,token:ht.token},e),te.jsx(oi,{children:te.jsxs("div",{className:"h-screen p-3",children:[te.jsx(U1e,{children:"useIsConnected"}),te.jsxs(Tw,{children:["By using ",te.jsx(B1e,{keyboard:!0,children:"useIsConnected"})," hook to determines whether the client is successfully connected to Agora server."]}),te.jsx(Tw,{children:`result: ${o}`}),te.jsxs(Tw,{children:[te.jsx(Oi,{className:"m-1",onClick:()=>n(!0),type:"primary",children:"Join"}),te.jsx(Oi,{className:"m-1",onClick:()=>n(!1),type:"default",children:"Leave"})]})]})})},{Title:V1e,Paragraph:m6,Text:U0}=No,$1e=()=>{const[e,n]=b.useState(!1),{data:o,isLoading:s,isConnected:c,error:d}=xi({appid:ht.appId,channel:ht.channel,token:ht.token},e),[p,m]=b.useState(!1),[g,_]=b.useState(!1),S=ac(),{videoTracks:T}=mf(S),{audioTracks:R}=ff(S);R.map(O=>O.play());const N=()=>te.jsx(te.Fragment,{children:T.map(O=>te.jsxs(_s.Item,{children:[te.jsx(sg,{cover:Fc(),track:O},O.getUserId()),te.jsx(_l,{children:`${rc(O.getUserId())}{${O.getUserId()}}`})]},O.getUserId()))});return te.jsxs(oi,{children:[te.jsxs("div",{className:"h-screen p-3",children:[te.jsx(V1e,{children:"UseJoin"}),te.jsxs(m6,{children:["By using ",te.jsx(U0,{keyboard:!0,children:"UseJoin"})," hook to join room."]}),te.jsxs(m6,{children:["You can do some actions like fetching token before calling join.",te.jsx("br",{}),"Below is the returned data."]}),te.jsxs(U0,{children:["data: ",o]}),te.jsxs(U0,{className:"pl-3",children:["isLoading: ",`${s}`]}),te.jsxs(U0,{className:"pl-3",children:["isConnected: ",`${c}`]}),te.jsxs(U0,{className:"pl-3",children:["error: ",`${JSON.stringify(d)}`]})]}),e&&te.jsx(OS,{cameraOn:g,micOn:p,renderRemoteUsers:N}),te.jsx(_a,{calling:e,cameraOn:g,micOn:p,setCalling:()=>{n(O=>!O)},setCamera:()=>{_(O=>!O)},setMic:()=>{m(O=>!O)}})]})},{Title:H1e}=No,W1e=()=>{const[e,n]=b.useState(!1),[o,s]=b.useState(null),[c,d]=b.useState(null);xi({appid:ht.appId,channel:ht.channel,token:ht.token,uid:ht.ShareScreenUID},e);const{screenTrack:p,error:m}=N9(e,{},"auto");return b.useEffect(()=>{p?Array.isArray(p)?(s(p.filter(g=>g.trackMediaType==="video")[0]),d(p.filter(g=>g.trackMediaType==="audio")[0])):s(p):(d(null),s(null))},[p]),ku([o,c],e),b.useEffect(()=>{n(!1)},[m]),A9(o,"track-ended",()=>{console.log("screen sharing ended"),n(!1)}),te.jsx(oi,{children:te.jsxs("div",{className:"h-screen p-3",children:[te.jsx(H1e,{children:"useLocalScreenTrack"}),te.jsx(Oi,{onClick:()=>n(g=>!g),type:"primary",children:e?"stop share screen":"start share screen"}),e&&o&&te.jsx(ag,{disabled:!e,play:e,style:{width:"600px",height:"400px"},track:o})]})})},{Title:z1e,Paragraph:G1e}=No,K1e=()=>{const e=rSe();return xi({appid:ht.appId,channel:ht.channel,token:ht.token},!0),te.jsx(oi,{children:te.jsxs("div",{className:"h-screen p-3",children:[te.jsx(z1e,{children:"useNetworkQuality"}),te.jsx(G1e,{children:`result: ${JSON.stringify(e)}`})]})})},q1e=()=>{const[e,n]=b.useState(!1),o=TS()||0,s=b.useMemo(()=>rc(o),[o]),c=b.useMemo(()=>Fc(),[]),{isConnected:d}=xi({appid:ht.appId,channel:ht.channel,token:ht.token},e),[p,m]=b.useState(!1),[g,_]=b.useState(!1),{localMicrophoneTrack:S}=hf(p),{localCameraTrack:T}=pf(g);ku([S,T]);const R=ac(),N=R.filter(x=>x.hasAudio||x.hasVideo),{videoTracks:O}=mf(R),{audioTracks:A}=ff(R);A.map(x=>x.play());const M=()=>te.jsx(te.Fragment,{children:O.map(x=>te.jsxs(_s.Item,{children:[te.jsx(sg,{cover:Fc(),track:x},x.getUserId()),te.jsx(_l,{children:`Layout1 ${rc(x.getUserId())}{${x.getUserId()}}`})]},x.getUserId()))});return te.jsxs(oi,{children:[te.jsxs(te.Fragment,{children:[te.jsx(Sx,{published:N.length+(p||g?1:0),total:R.length+1}),te.jsxs(_s,{children:[d&&te.jsx(_s.Item,{children:te.jsx(yx,{audioTrack:S,cameraOn:g,cover:c,micOn:p,videoTrack:T,children:te.jsx(_l,{children:`${s}{${o}}`})})}),M?M():void 0]})]}),te.jsx(_a,{calling:e,cameraOn:g,micOn:p,setCalling:()=>n(x=>!x),setCamera:()=>{_(x=>!x)},setMic:()=>{m(x=>!x)}})]})},Y1e=()=>{const[e,n]=b.useState(!1),o=Is(),s=TS()||0,c=b.useMemo(()=>rc(s),[s]),d=b.useMemo(()=>Fc(),[]);xi({appid:ht.appId,channel:ht.channel,token:ht.token},e);const[p,m]=b.useState(!1),[g,_]=b.useState(!1),{localMicrophoneTrack:S}=hf(p),{localCameraTrack:T}=pf(g);ku([S,T]);const R=ac(),N=R.filter(O=>O.hasAudio||O.hasVideo);return te.jsxs(oi,{children:[te.jsxs(te.Fragment,{children:[te.jsx(Sx,{published:N.length+(p||g?1:0),total:R.length+1}),te.jsxs(_s,{children:[o&&te.jsx(_s.Item,{children:te.jsx(yx,{audioTrack:S,cameraOn:g,cover:d,micOn:p,videoTrack:T,children:te.jsx(_l,{children:`${c}{${s}}`})})}),R.map(O=>te.jsxs(_s.Item,{children:[te.jsx(_x,{cover:Fc(),user:O}),te.jsx(_l,{children:`${rc(O.uid)}{${O.uid}}`})]},O.uid))]})]}),te.jsx(_a,{calling:e,cameraOn:g,micOn:p,setCalling:()=>n(O=>!O),setCamera:()=>{_(O=>!O)},setMic:()=>{m(O=>!O)}})]})},HH=[{label:"useJoin",component:$1e},{label:"usePublish",component:q1e},{label:"useRemoteUsers",component:Y1e},{label:"useConnectionState",component:k1e},{label:"useIsConnected",component:j1e},{label:"useCurrentUID",component:F1e},{label:"useAutoPlayAudioTrack",component:O1e},{label:"useAutoPlayVideoTrack",component:N1e},{label:"useNetworkQuality",component:K1e},{label:"useLocalScreenTrack",component:W1e}],g6=()=>{const[e,n]=b.useState(ht.channel),o=g=>{n(g.target.value)},[s,c]=I_e.useNotification(),d=g=>{s[g]({message:"Configuration Saved",description:"Go to other pages and try it now!"})},p=()=>{ht.channel=e,d("success")},m={wrapperCol:{span:14,offset:4}};return te.jsxs(oi,{children:[c,te.jsx("div",{className:"p-4",children:te.jsx(q5.Item,{label:"Channel Name",children:te.jsx(OEe,{onChange:o,style:{width:"200px"},value:e})})}),te.jsx(q5.Item,{...m,children:te.jsx(Oi,{onClick:p,type:"primary",children:"Save configuration"})})]})},{Content:X1e,Sider:J1e}=_A,no=["Basic","Hooks","Components","Advanced","Setting"],Q1e=[{label:no[0],key:no[0],children:VH.map(e=>({key:`/${no[0]}/${e.label}`,label:e.label}))},{label:no[1],key:no[1],children:HH.map(e=>({key:`/${no[1]}/${e.label}`,label:e.label}))},{label:no[2],key:no[2],children:$H.map(e=>({key:`/${no[2]}/${e.label}`,label:e.label}))},{label:no[3],key:no[3],children:jH.map(e=>({key:`/${no[3]}/${e.label}`,label:e.label}))},{label:"settings",key:"/setting"}];function Z1e(){const[e,n]=b.useState(!1),[o,s]=b.useState([window.location.hash.slice(1).split("/")[1]]),c=p=>{const m=p.find(g=>o.indexOf(g)===-1);m&&no.indexOf(m)===-1?s(p):s(m?[m]:[])},d=zoe();return te.jsx(te.Fragment,{children:te.jsxs(_A,{children:[te.jsx(J1e,{collapsed:e,collapsible:!0,onCollapse:p=>n(p),style:{overflow:"auto",height:"100vh",position:"fixed",left:0,top:0,bottom:0},children:te.jsx(gve,{items:Q1e,mode:"inline",onClick:p=>{d(p.key)},onOpenChange:c,openKeys:o,selectedKeys:[window.location.hash.slice(1)],theme:"dark"})}),te.jsx(_A,{style:{marginLeft:e?80:200},children:te.jsxs(X1e,{children:[te.jsxs(aae,{children:[te.jsx(yd,{Component:()=>te.jsx(g6,{}),path:"/*"}),te.jsx(yd,{Component:()=>te.jsx(g6,{}),path:"/setting"}),VH.map(({label:p,component:m})=>{const g=m;return te.jsx(yd,{Component:()=>te.jsx(qE,{children:te.jsx(g,{})}),path:`/${no[0]}/${p}`},p)}),HH.map(({label:p,component:m})=>{const g=m;return te.jsx(yd,{Component:()=>te.jsx(qE,{children:te.jsx(g,{})}),path:`/${no[1]}/${p}`},p)}),$H.map(({label:p,component:m})=>{const g=m;return te.jsx(yd,{Component:()=>te.jsx(qE,{children:te.jsx(g,{})}),path:`/${no[2]}/${p}`},p)}),jH.map(({label:p,component:m})=>{const g=m;return te.jsx(yd,{Component:()=>te.jsx(qE,{children:te.jsx(g,{})}),path:`/${no[3]}/${p}`},p)})]}),te.jsx("a",{"aria-label":"View source on GitHub",className:"github-corner",href:"https://github.com/AgoraIO-Extensions/agora-rtc-react",rel:"noreferrer",target:"_blank",children:te.jsxs("svg",{"aria-hidden":"true",className:"github-corner-svg",height:"80",viewBox:"0 0 250 250",width:"80",children:[te.jsx("path",{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"}),te.jsx("path",{className:"github-corner-svg-arm",d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor"}),te.jsx("path",{className:"github-corner-svg-body",d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor"})]})})]})})]})})}ul.setLogLevel(0);Rw.createRoot(document.getElementById("root")).render(te.jsx(b.StrictMode,{children:te.jsx(cae,{children:te.jsx(Z1e,{})})}));
